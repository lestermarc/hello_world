
  CREATE OR REPLACE FORCE VIEW "C_ITX"."EV_DOC_ESTIMATE" ("DOC_ESTIMATE_ID", "DOC_GAUGE_OFFER_ID", "DOC_GAUGE_ORDER_ID", "PAC_CUSTOM_PARTNER_ID", "PC_LANG_ID", "ACS_FINANCIAL_CURRENCY_ID", "GAL_PROJECT_ID", "C_DOC_ESTIMATE_STATUS", "C_DOC_ESTIMATE_CODE", "DES_NUMBER", "DES_HEADING_TEXT", "DES_FOOT_TEXT", "DES_RECALC_AMOUNTS", "DOC_ESTIMATE_ELEMENT_COST_ID", "DOC_ESTIMATE_FOOT_ID", "DOC_ESTIMATE_POS_ID", "DOC_ESTIMATE_ELEMENT_ID", "DEC_COST_PRICE", "DEC_UNIT_SALE_PRICE_TH", "DEC_UNIT_SALE_PRICE", "DEC_UNIT_MARGIN_AMOUNT", "DEC_UNIT_MARGIN_RATE", "DEC_QUANTITY", "DEC_REF_QTY", "DEC_CONVERSION_FACTOR", "DEC_SALE_PRICE_TH", "DEC_SALE_PRICE", "DEC_SALE_PRICE_CORR", "DEC_MARGIN_AMOUNT", "DEC_MARGIN_AMOUNT_CORR", "DEC_MARGIN_RATE", "DEC_MARGIN_RATE_CORR", "DEC_GLOBAL_MARGIN_AMOUNT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM") AS
  select DES.DOC_ESTIMATE_ID
       , DES.DOC_GAUGE_OFFER_ID
       , DES.DOC_GAUGE_ORDER_ID
       , DES.PAC_CUSTOM_PARTNER_ID
       , DES.PC_LANG_ID
       , DES.ACS_FINANCIAL_CURRENCY_ID
       , DES.GAL_PROJECT_ID
       , DES.C_DOC_ESTIMATE_STATUS
       , DES.C_DOC_ESTIMATE_CODE
       , DES.DES_NUMBER
       , DES.DES_HEADING_TEXT
       , DES.DES_FOOT_TEXT
       , DES.DES_RECALC_AMOUNTS
       , dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DOC_ESTIMATE_POS_ID
       , dec.DOC_ESTIMATE_ELEMENT_ID
       , dec.DEC_COST_PRICE
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_QUANTITY
       , dec.DEC_REF_QTY
       , dec.DEC_CONVERSION_FACTOR
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       , DES.A_DATECRE
       , DES.A_DATEMOD
       , DES.A_IDCRE
       , DES.A_IDMOD
       , DES.A_RECLEVEL
       , DES.A_RECSTATUS
       , DES.A_CONFIRM
    from DOC_ESTIMATE DES
       , DOC_ESTIMATE_ELEMENT_COST dec
   where dec.DOC_ESTIMATE_FOOT_ID = DES.DOC_ESTIMATE_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."EV_DOC_ESTIMATE_COMP" ("DOC_ESTIMATE_COMP_ID", "DOC_ESTIMATE_POS_ID", "DOC_ESTIMATE_ELEMENT_ID", "ECP_REFERENCE", "DED_NUMBER", "C_DOC_ESTIMATE_ELEMENT_TYPE", "GCO_GOOD_ID", "GCO_GOOD_CATEGORY_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "C_SUPPLY_MODE", "C_SUPPLY_TYPE", "ECP_SHORT_DESCRIPTION", "ECP_LONG_DESCRIPTION", "ECP_SECONDARY_REFERENCE", "DIC_UNIT_OF_MEASURE_ID", "C_MANAGEMENT_MODE", "C_DOC_ESTIMATE_CREATE_MODE", "ECP_FREE_DESCRIPTION", "GCO_NEW_GOOD_ID", "DOC_ESTIMATE_ID", "DOC_ESTIMATE_FOOT_ID", "DOC_ESTIMATE_ELEMENT_COST_ID", "DEC_UNIT_SALE_PRICE_TH", "DEC_UNIT_SALE_PRICE", "DEC_UNIT_MARGIN_RATE", "DEC_UNIT_MARGIN_AMOUNT", "DEC_SALE_PRICE_TH", "DEC_SALE_PRICE_CORR", "DEC_SALE_PRICE", "DEC_QUANTITY", "DEC_REF_QTY", "DEC_CONVERSION_FACTOR", "DEC_MARGIN_RATE_CORR", "DEC_MARGIN_RATE", "DEC_MARGIN_AMOUNT_CORR", "DEC_MARGIN_AMOUNT", "DEC_GLOBAL_MARGIN_AMOUNT", "DEC_COST_PRICE", "A_RECSTATUS", "A_RECLEVEL", "A_IDMOD", "A_IDCRE", "A_DATEMOD", "A_DATECRE", "A_CONFIRM") AS
  select ECP.DOC_ESTIMATE_COMP_ID
       , DED.DOC_ESTIMATE_POS_ID
       , DED.DOC_ESTIMATE_ELEMENT_ID
       , ECP.ECP_REFERENCE
       , DED.DED_NUMBER
       , DED.C_DOC_ESTIMATE_ELEMENT_TYPE
       , ECP.GCO_GOOD_ID
       , ECP.GCO_GOOD_CATEGORY_ID
       , ECP.STM_STOCK_ID
       , ECP.STM_LOCATION_ID
       , ECP.C_SUPPLY_MODE
       , ECP.C_SUPPLY_TYPE
       , ECP.ECP_SHORT_DESCRIPTION
       , ECP.ECP_LONG_DESCRIPTION
       , ECP.ECP_SECONDARY_REFERENCE
       , ECP.DIC_UNIT_OF_MEASURE_ID
       , ECP.C_MANAGEMENT_MODE
       , ECP.C_DOC_ESTIMATE_CREATE_MODE
       , ECP.ECP_FREE_DESCRIPTION
       , ECP.GCO_NEW_GOOD_ID
       , dec.DOC_ESTIMATE_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_SALE_PRICE
       , dec.DEC_QUANTITY
       , dec.DEC_REF_QTY
       , dec.DEC_CONVERSION_FACTOR
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       , dec.DEC_COST_PRICE
       , DED.A_RECSTATUS
       , DED.A_RECLEVEL
       , DED.A_IDMOD
       , DED.A_IDCRE
       , DED.A_DATEMOD
       , DED.A_DATECRE
       , DED.A_CONFIRM
    from DOC_ESTIMATE_ELEMENT DED
       , DOC_ESTIMATE_COMP ECP
       , DOC_ESTIMATE_ELEMENT_COST dec
   where DED.DOC_ESTIMATE_ELEMENT_ID = ECP.DOC_ESTIMATE_COMP_ID
     and DED.DOC_ESTIMATE_ELEMENT_ID = dec.DOC_ESTIMATE_ELEMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."EV_DOC_ESTIMATE_POS" ("DOC_ESTIMATE_POS_ID", "DOC_ESTIMATE_ID", "GCO_GOOD_ID", "GCO_GOOD_CATEGORY_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "PPS_NOMENCLATURE_ID", "GAL_TASK_ID", "GAL_BUDGET_ID", "C_MANAGEMENT_MODE", "C_DOC_ESTIMATE_CREATE_MODE", "C_SUPPLY_MODE", "C_SUPPLY_TYPE", "DIC_UNIT_OF_MEASURE_ID", "DEP_NUMBER", "DEP_REFERENCE", "DEP_SECONDARY_REFERENCE", "DEP_SHORT_DESCRIPTION", "DEP_LONG_DESCRIPTION", "DEP_DELIVERY_DATE", "DEP_OPTION", "DEP_RECALC_AMOUNTS", "DEP_COMMENT", "DEP_FREE_DESCRIPTION", "C_SCHEDULE_PLANNING", "GCO_NEW_GOOD_ID", "DOC_ESTIMATE_ELEMENT_COST_ID", "DOC_ESTIMATE_FOOT_ID", "DOC_ESTIMATE_ELEMENT_ID", "DEC_COST_PRICE", "DEC_UNIT_SALE_PRICE_TH", "DEC_UNIT_SALE_PRICE", "DEC_UNIT_MARGIN_AMOUNT", "DEC_UNIT_MARGIN_RATE", "DEC_QUANTITY", "DEC_REF_QTY", "DEC_CONVERSION_FACTOR", "DEC_SALE_PRICE_TH", "DEC_SALE_PRICE", "DEC_SALE_PRICE_CORR", "DEC_MARGIN_AMOUNT", "DEC_MARGIN_AMOUNT_CORR", "DEC_MARGIN_RATE", "DEC_MARGIN_RATE_CORR", "DEC_GLOBAL_MARGIN_AMOUNT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM") AS
  select DEP.DOC_ESTIMATE_POS_ID
       , DEP.DOC_ESTIMATE_ID
       , DEP.GCO_GOOD_ID
       , DEP.GCO_GOOD_CATEGORY_ID
       , DEP.STM_STOCK_ID
       , DEP.STM_LOCATION_ID
       , DEP.PPS_NOMENCLATURE_ID
       , DEP.GAL_TASK_ID
       , DEP.GAL_BUDGET_ID
       , DEP.C_MANAGEMENT_MODE
       , DEP.C_DOC_ESTIMATE_CREATE_MODE
       , DEP.C_SUPPLY_MODE
       , DEP.C_SUPPLY_TYPE
       , DEP.DIC_UNIT_OF_MEASURE_ID
       , DEP.DEP_NUMBER
       , DEP.DEP_REFERENCE
       , DEP.DEP_SECONDARY_REFERENCE
       , DEP.DEP_SHORT_DESCRIPTION
       , DEP.DEP_LONG_DESCRIPTION
       , DEP.DEP_DELIVERY_DATE
       , DEP.DEP_OPTION
       , DEP.DEP_RECALC_AMOUNTS
       , DEP.DEP_COMMENT
       , DEP.DEP_FREE_DESCRIPTION
       , DEP.C_SCHEDULE_PLANNING
       , DEP.GCO_NEW_GOOD_ID
       , dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DOC_ESTIMATE_ELEMENT_ID
       , dec.DEC_COST_PRICE
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_QUANTITY
       , dec.DEC_REF_QTY
       , dec.DEC_CONVERSION_FACTOR
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       , DEP.A_DATECRE
       , DEP.A_DATEMOD
       , DEP.A_IDCRE
       , DEP.A_IDMOD
       , DEP.A_RECLEVEL
       , DEP.A_RECSTATUS
       , DEP.A_CONFIRM
    from DOC_ESTIMATE_POS DEP
       , DOC_ESTIMATE_ELEMENT_COST dec
   where DEP.DOC_ESTIMATE_POS_ID = dec.DOC_ESTIMATE_POS_ID
     and dec.DOC_ESTIMATE_ELEMENT_ID is null


  CREATE OR REPLACE FORCE VIEW "C_ITX"."EV_DOC_ESTIMATE_TASK" ("DOC_ESTIMATE_TASK_ID", "DOC_ESTIMATE_POS_ID", "DOC_ESTIMATE_ELEMENT_ID", "DTK_REFERENCE", "DED_NUMBER", "DTK_DESCRIPTION", "C_DOC_ESTIMATE_ELEMENT_TYPE", "FAL_TASK_ID", "FAL_LIST_STEP_LINK_ID", "C_TASK_TYPE", "C_DOC_ESTIMATE_CREATE_MODE", "DTK_ADJUSTING_TIME", "DTK_WORK_TIME", "DTK_QTY_FIX_ADJUSTING", "DTK_QTY_REF_WORK", "DTK_RATE1", "DTK_RATE2", "DTK_AMOUNT", "DTK_QTY_REF_AMOUNT", "DTK_DIVISOR_AMOUNT", "DOC_ESTIMATE_ID", "DOC_ESTIMATE_FOOT_ID", "DOC_ESTIMATE_ELEMENT_COST_ID", "DEC_UNIT_SALE_PRICE_TH", "DEC_UNIT_SALE_PRICE", "DEC_UNIT_MARGIN_RATE", "DEC_UNIT_MARGIN_AMOUNT", "DEC_SALE_PRICE_TH", "DEC_SALE_PRICE_CORR", "DEC_SALE_PRICE", "DEC_QUANTITY", "DEC_REF_QTY", "DEC_CONVERSION_FACTOR", "DEC_MARGIN_RATE_CORR", "DEC_MARGIN_RATE", "DEC_MARGIN_AMOUNT_CORR", "DEC_MARGIN_AMOUNT", "DEC_GLOBAL_MARGIN_AMOUNT", "DEC_COST_PRICE", "A_RECSTATUS", "A_RECLEVEL", "A_IDMOD", "A_IDCRE", "A_DATEMOD", "A_DATECRE", "A_CONFIRM") AS
  select DTK.DOC_ESTIMATE_TASK_ID
       , DED.DOC_ESTIMATE_POS_ID
       , DED.DOC_ESTIMATE_ELEMENT_ID
       , DTK.DTK_REFERENCE
       , DED.DED_NUMBER
       , DTK.DTK_DESCRIPTION
       , DED.C_DOC_ESTIMATE_ELEMENT_TYPE
       , DTK.FAL_TASK_ID
       , DTK.FAL_LIST_STEP_LINK_ID
       , DTK.C_TASK_TYPE
       , DTK.C_DOC_ESTIMATE_CREATE_MODE
       , DTK.DTK_ADJUSTING_TIME
       , DTK.DTK_WORK_TIME
       , DTK.DTK_QTY_FIX_ADJUSTING
       , DTK.DTK_QTY_REF_WORK
       , DTK.DTK_RATE1
       , DTK.DTK_RATE2
       , DTK.DTK_AMOUNT
       , DTK.DTK_QTY_REF_AMOUNT
       , DTK.DTK_DIVISOR_AMOUNT
       , dec.DOC_ESTIMATE_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_SALE_PRICE
       , dec.DEC_QUANTITY
       , dec.DEC_REF_QTY
       , dec.DEC_CONVERSION_FACTOR
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       , dec.DEC_COST_PRICE
       , DED.A_RECSTATUS
       , DED.A_RECLEVEL
       , DED.A_IDMOD
       , DED.A_IDCRE
       , DED.A_DATEMOD
       , DED.A_DATECRE
       , DED.A_CONFIRM
    from DOC_ESTIMATE_ELEMENT DED
       , DOC_ESTIMATE_TASK DTK
       , DOC_ESTIMATE_ELEMENT_COST dec
   where DED.DOC_ESTIMATE_ELEMENT_ID = DTK.DOC_ESTIMATE_TASK_ID
     and DED.DOC_ESTIMATE_ELEMENT_ID = dec.DOC_ESTIMATE_ELEMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_ADDRESS" ("PAC_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PER_SHORT_NAME", "PER_CONTACT", "C_PARTNER_STATUS", "DCO_PHONE", "DCO_MOBILEPHONE", "DCO_EMAIL", "ADD_PRIORITY", "ADD_CARE_OF", "ADD_PO_BOX", "ADD_PO_BOX_NBR", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "ADD_COUNTY", "PC_CNTRY_ID", "PC_LANG_ID", "ADD_COMMENT", "ADD_SINCE", "ADD_FORMAT", "ADD_STATUS", "ADD_PRIORITY2", "ADD_CARE_OF2", "ADD_PO_BOX2", "ADD_PO_BOX_NBR2", "ADD_ADDRESS2", "ADD_ZIPCODE2", "ADD_CITY2", "ADD_STATE2", "ADD_COUNTY2", "PC_CNTRY_ID2", "PC_LANG_ID2", "ADD_COMMENT2", "ADD_SINCE2", "ADD_FORMAT2", "ADD_STATUS2") AS
  select p.PAC_PERSON_ID,
          DIC_PERSON_POLITNESS_ID,
          PER_NAME,
          PER_FORENAME,
          PER_ACTIVITY,
          PER_COMMENT,
          PER_KEY1,
          PER_KEY2,
          DIC_FREE_CODE1_ID,
          DIC_FREE_CODE2_ID,
          DIC_FREE_CODE3_ID,
          DIC_FREE_CODE4_ID,
          DIC_FREE_CODE5_ID,
          DIC_FREE_CODE6_ID,
          DIC_FREE_CODE7_ID,
          DIC_FREE_CODE8_ID,
          DIC_FREE_CODE9_ID,
          DIC_FREE_CODE10_ID,
          PER_SHORT_NAME,
          PER_CONTACT,
          p.C_PARTNER_STATUS,
          (SELECT com_ext_number
             FROM (  SELECT com_ext_number, pac_communication_id, pac_person_id
                       FROM pac_communication c, dic_communication_type d
                      WHERE D.DIC_COMMUNICATION_TYPE_ID =
                               C.DIC_COMMUNICATION_TYPE_ID
                            AND dco_phone = 1
                   ORDER BY pac_person_id, pac_communication_id ASC)
            WHERE pac_person_id = p.pac_person_id AND ROWNUM = 1)
             dco_phone,
          (SELECT com_ext_number
             FROM (  SELECT com_ext_number, pac_communication_id, pac_person_id
                       FROM pac_communication c, dic_communication_type d
                      WHERE D.DIC_COMMUNICATION_TYPE_ID =
                               C.DIC_COMMUNICATION_TYPE_ID
                            AND dco_mobilephone = 1
                   ORDER BY pac_person_id, pac_communication_id ASC)
            WHERE pac_person_id = p.pac_person_id AND ROWNUM = 1)
             dco_mobilephone,
          (SELECT com_ext_number
             FROM (  SELECT com_ext_number, pac_communication_id, pac_person_id
                       FROM pac_communication c, dic_communication_type d
                      WHERE D.DIC_COMMUNICATION_TYPE_ID =
                               C.DIC_COMMUNICATION_TYPE_ID
                            AND dco_email = 1
                   ORDER BY pac_person_id, pac_communication_id ASC)
            WHERE pac_person_id = p.pac_person_id AND ROWNUM = 1)
             dco_email,
          a.ADD_PRIORITY,
          a.ADD_CARE_OF,
          a.ADD_PO_BOX,
          a.ADD_PO_BOX_NBR,
          a.ADD_ADDRESS1,
          a.ADD_ZIPCODE,
          a.ADD_CITY,
          a.ADD_STATE,
          a.ADD_COUNTY,
          a.pc_CNTRY_ID,
          a.pc_LANG_ID,
          a.ADD_COMMENT,
          a.ADD_SINCE,
          a.ADD_FORMAT,
          a.C_PARTNER_STATUS ADD_STATUS,
          b.ADD_PRIORITY add_priority2,
          b.ADD_CARE_OF add_care_of2,
          b.ADD_PO_BOX add_po_box2,
          b.ADD_PO_BOX_NBR add_po_box_nbr2,
          b.ADD_ADDRESS1 add_address2,
          b.ADD_ZIPCODE add_zipcode2,
          b.ADD_CITY add_city2,
          b.ADD_STATE add_state2,
          b.ADD_COUNTY add_county2,
          b.pc_CNTRY_ID pc_cntry_id2,
          b.pc_LANG_ID pc_lang_id2,
          b.ADD_COMMENT add_comment2,
          b.ADD_SINCE add_since2,
          b.ADD_FORMAT add_format2,
          b.C_PARTNER_STATUS ADD_STATUS2
     FROM pac_person p,
          (SELECT pac_person_id,
                  ADD_PRIORITY,
                  DIC_ADDRESS_TYPE_ID,
                  ADD_CARE_OF,
                  ADD_PO_BOX,
                  ADD_PO_BOX_NBR,
                  ADD_ADDRESS1,
                  ADD_ZIPCODE,
                  ADD_CITY,
                  ADD_STATE,
                  ADD_COUNTY,
                  pc_CNTRY_ID,
                  pc_LANG_ID,
                  ADD_COMMENT,
                  ADD_SINCE,
                  ADD_FORMAT,
                  C_PARTNER_STATUS
             FROM pac_address a
            WHERE add_principal = 1) a,
          (SELECT pac_person_id,
                  ADD_PRIORITY,
                  DIC_ADDRESS_TYPE_ID,
                  ADD_CARE_OF,
                  ADD_PO_BOX,
                  ADD_PO_BOX_NBR,
                  ADD_ADDRESS1,
                  ADD_ZIPCODE,
                  ADD_CITY,
                  ADD_STATE,
                  ADD_COUNTY,
                  pc_CNTRY_ID,
                  pc_LANG_ID,
                  ADD_COMMENT,
                  ADD_SINCE,
                  ADD_FORMAT,
                  C_PARTNER_STATUS
             FROM pac_address a
            WHERE add_principal = 0
                  AND pac_address_id =
                         (SELECT MIN (pac_address_id)
                            FROM pac_address a2
                           WHERE a.pac_person_id = a2.pac_person_id
                                 AND add_principal = 0)) B
    WHERE p.pac_person_id = a.pac_person_id(+)
          AND p.pac_person_id = b.pac_person_id(+)
          AND LPM_ADDRESS_FUNCTIONS.CheckAddress(p.pac_person_id) = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_ALLOCATION" ("HRM_PERSON_JOB_ID", "HRM_JOB_ID", "PEJ_FROM", "PEJ_AFFECT_RATE", "PEJ_TO", "C_HRM_PERSON_JOB_STATUS", "HRM_TENURED_ID", "HRM_PERSON_ID", "EXT_ASSIGNMENT") AS
  select HRM_PERSON_JOB_ID
       , HRM_JOB_ID
       , PEJ_FROM
       , PEJ_AFFECT_RATE
       , PEJ_TO
       , C_HRM_PERSON_JOB_STATUS
       , HRM_TENURED_ID
       , HRM_PERSON_ID
       , EXT_ASSIGNMENT
    from table(lpm_lib_view_hrm.allocations)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_BENEFICIARY" ("SCH_STUDENT_ID", "SCH_HOUSE_ID", "SCH_TUTOR_ID", "SCH_EDUCATION_DEGREE_ID", "SCH_STUDENT_STATUS_ID", "DIC_SCH_LANGUAGE_ID", "DIC_SCH_PLANNED_DURATION_ID", "DIC_SCH_RELIGION_ID", "DIC_NATIONALITY1_ID", "DIC_NATIONALITY2_ID", "DIC_NATIONALITY3_ID", "PAC_CUSTOM_PARTNER1_ID", "PAC_CUSTOM_PARTNER2_ID", "ACS_PAYMENT_METHOD_ID", "STU_ACCOUNT_NUMBER", "STU_NUMBER", "STU_NAME", "STU_FORENAME", "STU_PASSPORT_NAME", "STU_BIRTH_DATE", "STU_BIRTHPLACE", "STU_SEX_MALE", "STU_ENTRY_DATE", "STU_EXIT_DATE", "STU_BILLING_ECOLAGE_COMMENT", "STU_BILLING_DEBOURS_COMMENT", "STU_TEACHER_CHILD", "STU_SCHOOL_YEAR", "STU_CLASS", "STU_OLD_STUDENT", "STU_COUNT_BALANCED", "STU_COMMENT", "STU_INSCRIPTION_DATE", "STU_REGISTRATION_PAID", "STU_REGISTRATION_BILLED", "STU_PAYMENT_DATE", "STU_DISCOUNT_RELATION", "STU_GUARANTEE_PAID", "STU_GUARANTEE_AMOUNT", "STU_SCOLARSHIP_AMOUNT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM", "SCH_YEAR_PERIOD1_ID", "SCH_YEAR_PERIOD2_ID", "STU_GUARANTEE_BILLED", "STU_SCOLARSHIP_RATE", "STU_PRORATE_PAYMENT", "STU_NEW_STUDENT", "STU_DEGREE_DATEMOD", "STU_BEGIN_TERM_AGE", "STU_BEGIN_YEAR_AGE", "HRM_PERSON_ID", "HRM_PERSON2_ID", "HRM_PERSON3_ID", "ACS_CDA_ACCOUNT_ID", "DIC_AI_CASE_ID", "SCH_SCH_HOUSE_ID", "STU_AVS_NUM", "STU_AI_NUM", "STU_CM_NUM", "STU_ECO_MIXED_BILLING", "STU_OUT_MIXED_BILLING", "STU_ECO_OTHER_ADDRESS", "STU_OUT_OTHER_ADDRESS", "STU_WORKER", "STU_STUDENT", "STU_RESIDENT", "STU_ORIGIN", "STU_CNTY_ENTRY_DATE", "DIC_LPM_MARITAL_STATUS_ID") AS
  SELECT "SCH_STUDENT_ID",
          "SCH_HOUSE_ID",
          "SCH_TUTOR_ID",
          "SCH_EDUCATION_DEGREE_ID",
          "SCH_STUDENT_STATUS_ID",
          "DIC_SCH_LANGUAGE_ID",
          "DIC_SCH_PLANNED_DURATION_ID",
          "DIC_SCH_RELIGION_ID",
          "DIC_NATIONALITY1_ID",
          "DIC_NATIONALITY2_ID",
          "DIC_NATIONALITY3_ID",
          "PAC_CUSTOM_PARTNER1_ID",
          "PAC_CUSTOM_PARTNER2_ID",
          "ACS_PAYMENT_METHOD_ID",
          "STU_ACCOUNT_NUMBER",
          "STU_NUMBER",
          "STU_NAME",
          "STU_FORENAME",
          "STU_PASSPORT_NAME",
          "STU_BIRTH_DATE",
          "STU_BIRTHPLACE",
          "STU_SEX_MALE",
          "STU_ENTRY_DATE",
          "STU_EXIT_DATE",
          "STU_BILLING_ECOLAGE_COMMENT",
          "STU_BILLING_DEBOURS_COMMENT",
          "STU_TEACHER_CHILD",
          "STU_SCHOOL_YEAR",
          "STU_CLASS",
          "STU_OLD_STUDENT",
          "STU_COUNT_BALANCED",
          "STU_COMMENT",
          "STU_INSCRIPTION_DATE",
          "STU_REGISTRATION_PAID",
          "STU_REGISTRATION_BILLED",
          "STU_PAYMENT_DATE",
          "STU_DISCOUNT_RELATION",
          "STU_GUARANTEE_PAID",
          "STU_GUARANTEE_AMOUNT",
          "STU_SCOLARSHIP_AMOUNT",
          "A_DATECRE",
          "A_DATEMOD",
          "A_IDCRE",
          "A_IDMOD",
          "A_RECLEVEL",
          "A_RECSTATUS",
          "A_CONFIRM",
          "SCH_YEAR_PERIOD1_ID",
          "SCH_YEAR_PERIOD2_ID",
          "STU_GUARANTEE_BILLED",
          "STU_SCOLARSHIP_RATE",
          "STU_PRORATE_PAYMENT",
          "STU_NEW_STUDENT",
          "STU_DEGREE_DATEMOD",
          "STU_BEGIN_TERM_AGE",
          "STU_BEGIN_YEAR_AGE",
          "HRM_PERSON_ID",
          "HRM_PERSON2_ID",
          "HRM_PERSON3_ID",
          "ACS_CDA_ACCOUNT_ID",
          "DIC_AI_CASE_ID",
          "SCH_SCH_HOUSE_ID",
          "STU_AVS_NUM",
          "STU_AI_NUM",
          "STU_CM_NUM",
          "STU_ECO_MIXED_BILLING",
          "STU_OUT_MIXED_BILLING",
          "STU_ECO_OTHER_ADDRESS",
          "STU_OUT_OTHER_ADDRESS",
          "STU_WORKER",
          "STU_STUDENT",
          "STU_RESIDENT",
          "STU_ORIGIN",
          "STU_CNTY_ENTRY_DATE",
          "DIC_LPM_MARITAL_STATUS_ID"
     FROM SCH_STUDENT
     WHERE stu_entry_date is not null


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_BENEFICIARY_ADDRESS" ("SCH_STUDENT_ADDRESS_ID", "SCH_STUDENT_ID", "PC_LANG_ID", "PC_CNTRY_ID", "DIC_PERSON_POLITNESS_ID", "ADD_ZIPCODE", "ADD_STATE", "ADD_PHONE", "ADD_NAME", "ADD_MAIL", "ADD_FORENAME", "ADD_FAX", "ADD_CITY", "ADD_ADDRESS", "LANNAME", "CNTNAME", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select STA.SCH_STUDENT_ADDRESS_ID
       , STA.SCH_STUDENT_ID
       , STA.PC_LANG_ID
       , STA.PC_CNTRY_ID
       , STA.DIC_PERSON_POLITNESS_ID
       , STA.ADD_ZIPCODE
       , STA.ADD_STATE
       , STA.ADD_PHONE
       , STA.ADD_NAME
       , STA.ADD_MAIL
       , STA.ADD_FORENAME
       , STA.ADD_FAX
       , STA.ADD_CITY
       , STA.ADD_ADDRESS
       , LAN.LANNAME
       , CNT.CNTNAME
       , STA.A_DATECRE
       , STA.A_IDCRE
       , STA.A_DATEMOD
       , STA.A_IDMOD
    from SCH_STUDENT_ADDRESS STA
       , PCS.PC_lANG LAN
       , PCS.PC_CNTRY CNT
   where STA.PC_LANG_ID = LAN.PC_LANG_ID
     and STA.PC_CNTRY_ID = CNT.PC_CNTRY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_DIVISION" ("HRM_DIVISION_ID", "DIC_DEPARTMENT_ID", "DIV_DESCR", "HRM_IN_CHARGE_ID", "HRM_DIV_SUPERIOR_ID", "DIC_DIVISION_TYPE_ID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select HRM_DIVISION_ID
       , DIC_DEPARTMENT_ID
       , DIV_DESCR
       , HRM_IN_CHARGE_ID
       , HRM_DIV_SUPERIOR_ID
       , DIC_DIVISION_TYPE_ID
       , A_DATECRE
       , A_IDCRE
       , A_DATEMOD
       , A_IDMOD
    from table(lpm_lib_view_hrm.divisions)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_DIVISION_ATTENDANCE" ("HRM_DIVISION_ID", "DIV_DESCR", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select HRM_DIVISION_ID
       , DIV_DESCR
       , A_DATECRE
       , A_IDCRE
       , A_DATEMOD
       , A_IDMOD
    from table(lpm_lib_view_hrm.div_attendances)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_EMPLOYEE" ("HRM_PERSON_ID", "PER_LAST_NAME", "PER_GENDER", "EMP_STATUS", "PER_TITLE", "PER_FIRST_NAME", "PER_BIRTH_DATE", "PER_BUSINESS_PHONE", "PER_HOME_PHONE", "PER_MOBILE_PHONE", "PER_EMAIL", "PER_BUSINESSSTREET", "PER_BUSINESSCITY", "PER_BUSINESSSTATE", "PER_BUSINESSPOSTALCODE", "PER_BUSINESSCOUNTRY", "PER_HOMESTREET", "PER_HOMECITY", "PER_HOMESTATE", "PER_HOMEPOSTALCODE", "PER_HOMECOUNTRY", "EMP_NUMBER", "EMP_SECONDARY_KEY", "EMP_SOCIAL_SECURITYNO2", "C_CIVIL_STATUS", "PER_ACTIVITY_RATE", "PC_LANG_ID", "DIC_WORKPLACE_ID", "DIC_DEPARTMENT_ID", "EMP_GROUP_ENTRY", "A_DATECRE", "A_IDCRE", "COM_BITMAP_ID") AS
  select PER.HRM_PERSON_ID
       , PER.PER_LAST_NAME
       , PER.PER_GENDER
       , PER.EMP_STATUS
       , PER.PER_TITLE
       , PER.PER_FIRST_NAME
       , PER.PER_BIRTH_DATE
       , PER.PER_BUSINESS_PHONE
       , PER.PER_HOME_PHONE
       , PER.PER_MOBILE_PHONE
       , PER.PER_EMAIL
       , PER.PER_BUSINESSSTREET
       , PER.PER_BUSINESSCITY
       , PER.PER_BUSINESSSTATE
       , PER.PER_BUSINESSPOSTALCODE
       , PER.PER_BUSINESSCOUNTRY
       , PER.PER_HOMESTREET
       , PER.PER_HOMECITY
       , PER.PER_HOMESTATE
       , PER.PER_HOMEPOSTALCODE
       , PER.PER_HOMECOUNTRY
       , PER.EMP_NUMBER
       , PER.EMP_SECONDARY_KEY
       , PER.EMP_SOCIAL_SECURITYNO2
       , PER.C_CIVIL_STATUS
       , PER.PER_ACTIVITY_RATE
       , PER.PC_LANG_ID
       , PER.DIC_WORKPLACE_ID
       , PER.DIC_DEPARTMENT_ID
       , PER.EMP_GROUP_ENTRY
       , PER.A_DATECRE
       , PER.A_IDCRE
       , PER.COM_BITMAP_ID
    from HRM_PERSON PER
   where not exists(select 1
                      from sch_student s
                     where per.hrm_person_id = s.hrm_person2_id)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_FREE_FIELD" ("PC_FLDSC_ID", "FLDNAME", "FLDDESCR", "FLDTYPE", "FLDLENGTH", "FLDVISIBLE", "FDILABEL", "TABNAME", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD") AS
  select FLD.PC_FLDSC_ID
       , FLDNAME
       , FLDDESCR
       , FLDTYPE
       , FLDLENGTH
       , FLDVISIBLE
       , FDILABEL
       , TAB.TABNAME
       , FLD.A_DATECRE
       , FLD.A_DATEMOD
       , FLD.A_IDCRE
       , FLD.A_IDMOD
    from PCS.PC_FLDSC FLD
       , PCS.PC_FDICO DIC
       , PCS.PC_LANG LAN
       , PCS.PC_TABLE TAB
   where DIC.PC_FLDSC_ID = FLD.PC_FLDSC_ID
     and DIC.PC_LANG_ID = LAN.PC_LANG_ID
     and TAB.PC_TABLE_ID = FLD.PC_TABLE_ID
     and TAB.TABNAME like '%LPM%'
     and LAN.LANID = 'FR'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_JOB" ("HRM_JOB_ID", "JOB_CODE", "HRM_IN_CHARGE_ID", "DIC_DEPARTMENT_ID", "DIC_JOB_TYPE_ID", "C_JOB_STATUS", "JOB_TITLE", "JOB_DESCR", "JOB_ACTIVITY", "JOB_HOME", "DIC_RESPONSABILITY_ID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select HRM_JOB_ID
       , JOB_CODE
       , HRM_IN_CHARGE_ID
       , DIC_DEPARTMENT_ID
       , DIC_JOB_TYPE_ID
       , C_JOB_STATUS
       , JOB_TITLE
       , JOB_DESCR
       , JOB_ACTIVITY
       , JOB_HOME
       , DIC_RESPONSABILITY_ID
       , A_DATECRE
       , A_IDCRE
       , A_DATEMOD
       , A_IDMOD
    from table(lpm_lib_view_hrm.jobs)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_NOTIFICATION_MAILS" ("HRM_PERSON_ID", "PAC_PERSON_ID", "SCH_STUDENT_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "EMAIL", "TYPEMAIL") AS
  select HRM_PERSON_ID
       , PAC_PERSON_ID
       , SCH_STUDENT_ID
       , PER_LAST_NAME
       , PER_FIRST_NAME
       , EMAIL
       , TYPEMAIL
    from table(lpm_lib_view_hrm.emails)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_OUTLAY_CATEGORY" ("SCH_OUTLAY_CATEGORY_ID", "OUT_MAJOR_REFERENCE", "OUT_SECONDARY_REFERENCE", "OUT_SHORT_DESCR", "OUT_LONG_DESCR", "OUT_FREE_DESCR", "DIC_OUTLAY_TYPE_ID", "COU_MAJOR_REFERENCE", "COU_SECONDARY_REFERENCE", "COU_SHORT_DESCR", "COU_LONG_DESCR", "COU_FREE_DESCR", "COU_PER_HOUR", "COU_HOUR_QTY", "GOO_MAJOR_REFERENCE", "OUT_ACTIVE", "C_ENTRY_MODE", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD") AS
  select SC.SCH_OUTLAY_CATEGORY_ID,
          OUT_MAJOR_REFERENCE,
          OUT_SECONDARY_REFERENCE,
          OUT_SHORT_DESCR,
          OUT_LONG_DESCR,
          OUT_FREE_DESCR,
          DIC_OUTLAY_TYPE_ID,
          COU_MAJOR_REFERENCE,
          COU_SECONDARY_REFERENCE,
          COU_SHORT_DESCR,
          COU_LONG_DESCR,
          COU_FREE_DESCR,
          COU_PER_HOUR,
          COU_HOUR_QTY,
          GOO_MAJOR_REFERENCE, OUT_ACTIVE, C_ENTRY_MODE,
          Sc.a_datecre, sc.a_datemod, sc.a_idcre, sc.a_idmod
     from SCH_OUTLAY S, SCH_OUTLAY_CATEGORY SC, GCO_GOOD G
    where S.SCH_OUTLAY_ID = SC.SCH_OUTLAY_ID
      and SC.GCO_GOOD_ID = G.GCO_GOOD_ID (+)
      and COU_LPM_CATEGORY = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_REFERENTS_VFIELDS_VIEW" ("LPM_REFERENTS_ID", "FATHER_ITEM_ID", "FATHER_ITEM_VALUE", "ITEM_ID", "ITEM_VALUE", "FIELD_VALUE") AS
  SELECT DISTINCT LPM_REFERENTS_ID,
                   FATHER_ITEM_ID,
                   FATHER_ITEM_VALUE,
                   ITEM_ID,
                   ITEM_VALUE,
                   FIELD_VALUE
     FROM (  SELECT DISTINCT
                    LRE.LPM_REFERENTS_ID,
                    NVL (VFLD.FLDVIRTUALGROUP,
                         PCS.PC_FUNCTIONS.TranslateWord ('Divers'))
                       AS FATHER_ITEM_ID,
                    NVL (VFLD.FLDVIRTUALGROUP,
                         PCS.PC_FUNCTIONS.TranslateWord ('Divers'))
                       AS FATHER_ITEM_VALUE,
                    VFLD.PC_FLDSC_ID ITEM_ID,
                    LPM_LIB_VFLD_BENEFICIARY.GetFieldLabel (VFLD.FLDNAME)
                       ITEM_VALUE,
                    LPM_LIB_VFLD_BENEFICIARY.GetVFieldValue (
                       'LPM_REFERENTS',
                       LRE.LPM_REFERENTS_ID,
                       VFLD.FLDNAME,
                       VFLD.PC_VFIELD_VALUE_ID,
                       VFLD.FLDTYPE)
                       FIELD_VALUE,
                    VFLD.FLDVIRTUALSEQ,
                    VFLD.FLDVIRTUALGROUP
               FROM LPM_REFERENTS LRE, PCS.PC_FLDSC VFLD, PCS.PC_TABLE TBL
              WHERE     TBL.TABNAME = 'LPM_REFERENTS'
                    AND VFLD.PC_TABLE_ID = TBL.PC_TABLE_ID
                    AND VFLD.FLDVIRTUALFIELD = 1
                    AND VFLD.FLDVISIBLE = 1
                    AND (   PC_OBJECT_ID IS NOT NULL
                         OR     VFLD.PC_OBJECT_ID IS NULL
                            AND NOT EXISTS
                                       (SELECT 1
                                          FROM PCS.PC_FLDSC VFLD2,
                                               PCS.PC_TABLE TBL2
                                         WHERE     TBL2.TABNAME =
                                                      'LPM_REFERENTS'
                                               AND VFLD2.PC_TABLE_ID =
                                                      TBL2.PC_TABLE_ID
                                               AND VFLD2.FLDVIRTUALFIELD = 1
                                               AND VFLD2.FLDVISIBLE = 1
                                               AND VFLD2.PC_OBJECT_ID
                                                      IS NOT NULL
                                               AND VFLD2.FLDNAME = VFLD.FLDNAME))
           ORDER BY LPM_REFERENTS_ID,
                    FLDVIRTUALGROUP ASC NULLS LAST,
                    FLDVIRTUALSEQ ASC NULLS LAST)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_SERVICES" ("SCH_CUSTOMERS_ASSOCIATION_ID", "OUT_MAJOR_REFERENCE", "OUT_SECONDARY_REFERENCE", "OUT_SHORT_DESCR", "OUT_LONG_DESCR", "OUT_FREE_DESCR", "COU_MAJOR_REFERENCE", "COU_SECONDARY_REFERENCE", "COU_SHORT_DESCR", "COU_LONG_DESCR", "COU_FREE_DESCR", "CAS_VALIDITY_DATE", "CAS_VALIDITY_DATE_TO", "CAS_DECISION", "SCH_STUDENT_ID") AS
  SELECT SAC.SCH_CUSTOMERS_ASSOCIATION_ID,
       S.OUT_MAJOR_REFERENCE,
       S.OUT_SECONDARY_REFERENCE,
       S.OUT_SHORT_DESCR,
       S.OUT_LONG_DESCR,
       S.OUT_FREE_DESCR,
       SC.COU_MAJOR_REFERENCE,
       SC.COU_SECONDARY_REFERENCE,
       SC.COU_SHORT_DESCR,
       SC.COU_LONG_DESCR,
       SC.COU_FREE_DESCR,
       SAC.CAS_VALIDITY_DATE,
       SAC.CAS_VALIDITY_DATE_TO,
       SAC.CAS_DECISION,
       SAC.SCH_STUDENT_ID
  FROM SCH_OUTLAY S,
       SCH_OUTLAY_CATEGORY SC,
       SCH_CUSTOMERS_ASSOCIATION SAC
 WHERE SAC.SCH_OUTLAY_ID = S.SCH_OUTLAY_ID (+)
   AND SAC.SCH_OUTLAY_CATEGORY_ID = SC.SCH_OUTLAY_CATEGORY_ID (+)
   AND (SAC.SCH_OUTLAY_ID is not null or SAC.SCH_OUTLAY_CATEGORY_ID is not null)
   AND S.OUT_ACTIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."LPM_VFIELDS_VIEW" ("SCH_STUDENT_ID", "FATHER_ITEM_ID", "FATHER_ITEM_VALUE", "ITEM_ID", "ITEM_VALUE", "FIELD_VALUE", "FLDNAME", "PC_VFIELD_VALUE_ID", "FLDTYPE") AS
  select distinct SCH_STUDENT_ID
                , FATHER_ITEM_ID
                , FATHER_ITEM_VALUE
                , ITEM_ID
                , ITEM_VALUE
                , FIELD_VALUE
                , FLDNAME
                , PC_VFIELD_VALUE_ID
                , FLDTYPE
             from table(LPM_LIB_VFLD_BENEFICIARY.vfields)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_ADDRESS" ("PAC_ADDRESS_ID", "PAC_PERSON_ID", "CNTID", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "LANID", "DIC_ADDRESS_TYPE_ID", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select PAC_ADDRESS_ID
       , PAC_PERSON_ID
       , (select CNTID
            from PCS.PC_CNTRY C
           where A.PC_CNTRY_ID = C.PC_CNTRY_ID) CNTID
       , ADD_ADDRESS1
       , ADD_ZIPCODE
       , ADD_CITY
       , ADD_STATE
       , (select LANID
            from PCS.PC_LANG L
           where A.PC_LANG_ID = L.PC_LANG_ID) LANID
       , DIC_ADDRESS_TYPE_ID
       , 0 A_DELETED
       , nvl(A_DATEMOD, A_DATECRE) A_DATEMOD
       , nvl(A_IDMOD, A_IDCRE) A_IDMOD
    from PAC_ADDRESS A


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_ADDRESS_TYPE" ("DIC_ADDRESS_TYPE_ID", "DIT_DESCR", "DAD_DEFAULT", "PC_LANG_ID") AS
  SELECT DIC_ADDRESS_TYPE_ID, DIT_DESCR, DAD_DEFAULT, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_ADDRESS_TYPE
    WHERE DIC_ADDRESS_TYPE_ID = DIT_CODE AND DIT_TABLE = 'DIC_ADDRESS_TYPE'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_ASSOCIATION_TYPE" ("DIC_ASSOCIATION_TYPE_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_ASSOCIATION_TYPE_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_ASSOCIATION_TYPE
    WHERE DIC_ASSOCIATION_TYPE_ID = DIT_CODE AND DIT_TABLE = 'DIC_ASSOCIATION_TYPE'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_CNTRY" ("CNTID", "CNTNAME") AS
  SELECT cntid, cntname FROM pcs.pc_cntry


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_COMMUNICATION" ("PAC_COMMUNICATION_ID", "PAC_PERSON_ID", "DIC_COMMUNICATION_TYPE_ID", "COM_EXT_NUMBER", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select pac_communication_id
       , PAC_PERSON_ID
       , DIC_COMMUNICATION_TYPE_ID
       , COM_EXT_NUMBER
       , 0 A_DELETED
       , nvl(a_datemod, a_datecre) A_DATEMOD
       , nvl(a_idmod, a_idcre) A_IDMOD
    from PAC_COMMUNICATION


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_COMMUNICATION_TYPE" ("DIC_COMMUNICATION_TYPE_ID", "DIT_DESCR", "PC_LANG_ID", "DCO_DEFAULT_RANK", "DCO_TYPE") AS
  SELECT DIC_COMMUNICATION_TYPE_ID, DIT_DESCR, PC_LANG_ID,
        CASE WHEN DCO_DEFAULT1 = 1 THEN '1'
             WHEN DCO_DEFAULT2 = 1 THEN '2'
             WHEN DCO_DEFAULT3 = 1 THEN '3'
             ELSE null
        END DCO_DEFAULT_RANK,
        CASE WHEN DCO_EMAIL = 1 THEN 'E'
             WHEN DCO_FAX = 1 THEN 'F'
             WHEN DCO_PHONE = 1 THEN 'P'
             WHEN DCO_MOBILEPHONE = 1 THEN 'P'
             WHEN DCO_PRIVATE = 1 THEN 'P'
             WHEN DCO_HOMEPAGE = 1 THEN 'W'
             ELSE null
        END DCO_TYPE
     FROM DICO_DESCRIPTION, DIC_COMMUNICATION_TYPE
    WHERE DIC_COMMUNICATION_TYPE_ID = DIT_CODE AND DIT_TABLE = 'DIC_COMMUNICATION_TYPE'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_CONTACT" ("PAC_PERSON_ASSOCIATION_ID", "PAC_PERSON_ID", "PAS_MAIN_CONTACT", "PAC_PAC_PERSON_ID", "PAS_FUNCTION", "DIC_ASSOCIATION_TYPE_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PER_SHORT_NAME", "PER_CONTACT", "C_PARTNER_STATUS", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select PAC_PERSON_ASSOCIATION_ID
       , a.pac_person_id pac_company_id
       , A.PAS_MAIN_CONTACT
       , p.PAC_PERSON_ID
       , pas_function
       , dic_association_type_id
       , DIC_PERSON_POLITNESS_ID
       , PER_NAME
       , PER_FORENAME
       , PER_COMMENT
       , PER_KEY1
       , PER_KEY2
       , DIC_FREE_CODE1_ID
       , DIC_FREE_CODE2_ID
       , DIC_FREE_CODE3_ID
       , DIC_FREE_CODE4_ID
       , DIC_FREE_CODE5_ID
       , DIC_FREE_CODE6_ID
       , DIC_FREE_CODE7_ID
       , DIC_FREE_CODE8_ID
       , DIC_FREE_CODE9_ID
       , DIC_FREE_CODE10_ID
       , PER_SHORT_NAME
       , PER_CONTACT
       , a.C_PARTNER_STATUS
       , 0 a_deleted
       , nvl(a.a_datemod, a.a_datecre) a_datemod
       , nvl(a.a_idmod, a.a_idcre) a_idmod
    from pac_person p
       , pac_person_association a
   where per_contact = 1
     and p.pac_person_id = a.pac_pac_person_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_CURRENCY" ("CURRENCY") AS
  SELECT currency FROM pcs.pc_curr


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_EVENTS" ("PAC_EVENT_ID", "PAC_PERSON_ID", "PAC_LEAD_ID", "PAC_EVENT_TYPE_ID", "EVE_SUBJECT", "EVE_TEXT", "EVE_DATE", "EVE_ENDDATE", "PAC_PAC_PERSON_ID", "EVE_USER_ID", "EVE_ENDED", "EVE_DATE_COMPLETED", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select pac_event_id
       , nvl(l.pac_person_id, e.pac_person_id) pac_COMPANY_id
       , E.PAC_LEAD_ID
       , pac_event_type_id
       , eve_subject
       , eve_text
       , eve_date
       , eve_enddate
       , pac_pac_person_id PAC_PERSON_ID
       , eve_user_id
       , eve_ended
       , eve_date_completed
       , 0 A_DELETED
       , nvl(E.a_datemod, E.a_datecre) A_DATEMOD
       , nvl(E.a_idmod, E.a_idcre) A_IDMOD
    from pac_event e
       , pac_lead l
       , pac_person_association ass
   where e.pac_lead_id = l.pac_lead_id(+)
     and e.pac_association_id = ass.pac_person_association_id(+)
     and MOB_I_LIB_VIEW_PAC.EventFilter(e.pac_event_id) = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_EVENT_TYPE" ("PAC_EVENT_TYPE_ID", "TYP_DESCRIPTION", "C_EVENT_TYPE", "TYP_PAC_PERSON_LINK", "TYP_LEAD_MANAGEMENT") AS
  select pac_event_type_id
       , typ_description
       , C_EVENT_TYPE
       , TYP_PAC_PERSON_LINK
       , TYP_LEAD_MANAGEMENT
    from pac_event_type
   where TYP_EVENT_AVAILABLE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_EVENT_TYPE_DESCR" ("PAC_EVENT_TYPE_ID", "PC_LANG_ID", "TYP_SHORT_DESCRIPTION", "TYP_LONG_DESCRIPTION", "TYP_DEFAULT_SUBJECT", "TYP_DEFAULT_TEXT") AS
  select pac_event_type_id
       , pc_lang_id
       , typ_short_description
       , typ_long_description
       , typ_default_subject
       , typ_default_text
    from pac_event_type_descr


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE1" ("DIC_FREE_CODE1_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE1_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE1
    WHERE DIC_FREE_CODE1_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE1'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE10" ("DIC_FREE_CODE10_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE10_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE10
    WHERE DIC_FREE_CODE10_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE10'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE2" ("DIC_FREE_CODE2_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE2_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE2
    WHERE DIC_FREE_CODE2_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE2'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE3" ("DIC_FREE_CODE3_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE3_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE3
    WHERE DIC_FREE_CODE3_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE3'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE4" ("DIC_FREE_CODE4_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE4_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE4
    WHERE DIC_FREE_CODE4_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE4'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE5" ("DIC_FREE_CODE5_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE5_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE5
    WHERE DIC_FREE_CODE5_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE5'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE6" ("DIC_FREE_CODE6_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE6_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE6
    WHERE DIC_FREE_CODE6_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE6'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE7" ("DIC_FREE_CODE7_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE7_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE7
    WHERE DIC_FREE_CODE7_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE7'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE8" ("DIC_FREE_CODE8_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE8_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE8
    WHERE DIC_FREE_CODE8_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE8'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_FREE_CODE9" ("DIC_FREE_CODE9_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_FREE_CODE9_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_FREE_CODE9
    WHERE DIC_FREE_CODE9_ID = DIT_CODE AND DIT_TABLE = 'DIC_FREE_CODE9'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_GCO_GOOD" ("GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "DES_SHORT_DESCRIPTION", "GCO_GOOD_CATEGORY_ID", "PC_LANG_ID") AS
  select g.gco_good_id
       , goo_major_reference
       , goo_secondary_reference
       , des_short_description
       , g.gco_good_category_id
       , pc_lang_id
    from gco_good g
       , gco_description d
   where g.gco_good_id = d.gco_good_id
     and C_DESCRIPTION_TYPE = '01'
     and C_GOOD_STATUS = '2'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_GCO_GOOD_CATEGORY" ("GCD_WORDING", "GCO_GOOD_CATEGORY_ID", "PC_LANG_ID") AS
  select gcd_wording
       , g.gco_good_category_id
       , pc_lang_id
    from gco_good_category g
       , gco_good_category_descr d
   where g.gco_good_category_id = d.gco_good_category_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LANG" ("PC_LANG_ID", "LANID") AS
  SELECT pc_lang_id, lanid FROM pcs.pc_lang


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEAD" ("PAC_LEAD_ID", "PAC_PERSON_ID", "C_LEAD_STATUS", "LEA_LABEL", "LEA_COMMENT", "DIC_LEA_SOURCE_ID", "LEA_SOURCE_COMMENT", "LEA_SOURCE_NR", "DIC_LEA_CLASSIFICATION_ID", "PAC_REPRESENTATIVE_ID", "LEA_USER_ID", "C_OPPORTUNITY_STATUS", "LEA_RESULT_COMMENT", "DIC_LEA_NEXT_STEP_ID", "DIC_LEA_RATING_ID", "CURRENCY", "LEA_BUDGET_AMOUNT", "LEA_OFFER_DEADLINE", "LEA_PROJECT_BEGIN_DATE", "LEA_PROJECT_END_DATE", "LEA_DATE", "LEA_CONTACT_PERSON_ID", "LEA_NEXT_STEP_DEADLINE", "LEA_COMPANY_NAME", "LEA_COMP_ADDRESS", "LEA_COMP_ZIPCODE", "LEA_COMP_CITY", "CNTID", "LANID", "DIC_PERSON_POLITNESS_ID", "LEA_CONTACT_NAME", "LEA_CONTACT_FORENAME", "LEA_CONTACT_LANG_ID", "LEA_CONTACT_FUNCTION", "DIC_ASSOCIATION_TYPE_ID", "LEA_CONTACT_PHONE", "LEA_CONTACT_FAX", "LEA_CONTACT_MOBILE", "LEA_CONTACT_EMAIL", "LEA_NUMBER", "DIC_LEA_PROJ_STEP_ID", "DIC_LEA_REASON_ID", "DIC_LEA_REASON_2_ID", "LEA_REASON_COMMENT", "DIC_LEA_REASON_CUST_ID", "DIC_LEA_REASON_CUST_2_ID", "LEA_REASON_COMMENT_CUST", "DIC_LEA_CATEGORY_ID", "DIC_LEA_SUBCATEGORY_ID", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select PAC_LEAD_ID
       , PAC_PERSON_ID
       , C_LEAD_STATUS
       , LEA_LABEL
       , LEA_COMMENT
       , DIC_LEA_SOURCE_ID
       , LEA_SOURCE_COMMENT
       , LEA_SOURCE_NR
       , DIC_LEA_CLASSIFICATION_ID
       , PAC_REPRESENTATIVE_ID
       , LEA_USER_ID
       , C_OPPORTUNITY_STATUS
       , LEA_RESULT_COMMENT
       , DIC_LEA_NEXT_STEP_ID
       , DIC_LEA_RATING_ID
       , currency
       , LEA_BUDGET_AMOUNT
       , LEA_OFFER_DEADLINE
       , LEA_PROJECT_BEGIN_DATE
       , LEA_PROJECT_END_DATE
       , LEA_DATE
       , LEA_CONTACT_PERSON_ID
       , LEA_NEXT_STEP_DEADLINE
       , LEA_COMPANY_NAME
       , LEA_COMP_ADDRESS
       , LEA_COMP_ZIPCODE
       , LEA_COMP_CITY
       , cntid
       , lanid
       , DIC_PERSON_POLITNESS_ID
       , LEA_CONTACT_NAME
       , LEA_CONTACT_FORENAME
       , LEA_CONTACT_LANG_ID
       , LEA_CONTACT_FUNCTION
       , DIC_ASSOCIATION_TYPE_ID
       , LEA_CONTACT_PHONE
       , LEA_CONTACT_FAX
       , LEA_CONTACT_MOBILE
       , LEA_CONTACT_EMAIL
       , LEA_NUMBER
       , DIC_LEA_PROJ_STEP_ID
       , DIC_LEA_REASON_ID
       , DIC_LEA_REASON_2_ID
       , LEA_REASON_COMMENT
       , DIC_LEA_REASON_CUST_ID
       , DIC_LEA_REASON_CUST_2_ID
       , LEA_REASON_COMMENT_CUST
       , DIC_LEA_CATEGORY_ID
       , DIC_LEA_SUBCATEGORY_ID
       , 0 A_DELETED
       , nvl(l.a_DATEMOD, l.a_datecre) a_datemod
       , nvl(l.A_IDMOD, l.a_idcre) a_idmod
    from pac_lead l
       , pcs.pc_cntry c
       , pcs.pc_lang lg
       , pcs.pc_curr cu
   where l.pc_lang_id = lg.pc_lang_id(+)
     and l.pc_cntry_id = c.pc_cntry_id(+)
     and l.pc_curr_id = cu.pc_curr_id(+)
     and MOB_I_LIB_VIEW_PAC.LeadFilter(l.pac_lead_id) = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEAD_OFFER" ("PAC_LEAD_OFFER_ID", "LEO_NUMBER", "PAC_LEAD_ID", "LEO_DATE", "LEO_COMMENT", "LEO_PRICE", "CURRENCY", "DOC_DOCUMENT_ID", "C_LEO_STATUS", "DIC_LEO_QUALIF_ID", "DIC_PAC_LEAD_OFFER_FREE01_ID", "DIC_PAC_LEAD_OFFER_FREE02_ID", "DIC_PAC_LEAD_OFFER_FREE03_ID", "DIC_PAC_LEAD_OFFER_FREE04_ID", "DIC_PAC_LEAD_OFFER_FREE05_ID", "DIC_PAC_LEAD_OFFER_FREE06_ID", "DIC_PAC_LEAD_OFFER_FREE07_ID", "DIC_PAC_LEAD_OFFER_FREE08_ID", "DIC_PAC_LEAD_OFFER_FREE09_ID", "DIC_PAC_LEAD_OFFER_FREE10_ID", "DIC_QUOTE_TYPE_ID", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select PAC_LEAD_OFFER_ID
       , LEO_NUMBER
       , PAC_LEAD_ID
       , LEO_DATE
       , LEO_COMMENT
       , LEO_PRICE
       , CURRENCY
       , DOC_DOCUMENT_ID
       , C_LEO_STATUS
       , DIC_LEO_QUALIF_ID
       , DIC_PAC_LEAD_OFFER_FREE01_ID
       , DIC_PAC_LEAD_OFFER_FREE02_ID
       , DIC_PAC_LEAD_OFFER_FREE03_ID
       , DIC_PAC_LEAD_OFFER_FREE04_ID
       , DIC_PAC_LEAD_OFFER_FREE05_ID
       , DIC_PAC_LEAD_OFFER_FREE06_ID
       , DIC_PAC_LEAD_OFFER_FREE07_ID
       , DIC_PAC_LEAD_OFFER_FREE08_ID
       , DIC_PAC_LEAD_OFFER_FREE09_ID
       , DIC_PAC_LEAD_OFFER_FREE10_ID
       , DIC_QUOTE_TYPE_ID
       , 0 A_DELETED
       , nvl(l.a_DATEMOD, l.a_datecre) a_datemod
       , nvl(l.A_IDMOD, l.a_idcre) a_idmod
    from PAC_LEAD_OFFER l
       , pcs.pc_curr c
   where l.pc_curr_id = c.pc_curr_id(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEAD_OFFER_GOOD" ("PAC_LEAD_OFFER_GOOD_ID", "PAC_LEAD_OFFER_ID", "GCO_GOOD_ID", "LEO_GOOD_DESCR", "LEO_GOOD_COMMENT", "LEO_GOOD_PRICE", "DOC_POSITION_ID", "LEO_GOOD_QTY", "LEO_GOOD_UNIT_PRICE", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select PAC_LEAD_OFFER_GOOD_ID
       , PAC_LEAD_OFFER_ID
       , GCO_GOOD_ID
       , LEO_GOOD_DESCR
       , LEO_GOOD_COMMENT
       , LEO_GOOD_PRICE
       , DOC_POSITION_ID
       , LEO_GOOD_QTY
       , LEO_GOOD_UNIT_PRICE
       , 0 A_DELETED
       , nvl(a_DATEMOD, a_datecre) a_datemod
       , nvl(A_IDMOD, a_idcre) a_idmod
    from PAC_LEAD_OFFER_GOOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_CATEGORY" ("DIC_LEA_CATEGORY_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_CATEGORY_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_CATEGORY
    WHERE DIC_LEA_CATEGORY_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_CATEGORY'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_CLASSIFICATION" ("DIC_LEA_CLASSIFICATION_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_CLASSIFICATION_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_CLASSIFICATION
    WHERE DIC_LEA_CLASSIFICATION_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_CLASSIFICATION'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_NEXT_STEP" ("DIC_LEA_NEXT_STEP_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_NEXT_STEP_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_NEXT_STEP
    WHERE DIC_LEA_NEXT_STEP_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_NEXT_STEP'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_OPP_STATUS" ("C_OPPORTUNITY_STATUS", "GCDTEXT1", "PC_LANG_ID") AS
  SELECT GCLCODE, GCDTEXT1, PC_LANG_ID
     FROM PCS.PC_GCODES
    WHERE GCGNAME = 'C_OPPORTUNITY_STATUS'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_PROJ_STEP" ("DIC_LEA_PROJ_STEP_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_PROJ_STEP_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_PROJ_STEP
    WHERE DIC_LEA_PROJ_STEP_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_PROJ_STEP'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_RATING" ("DIC_LEA_RATING_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_RATING_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_RATING
    WHERE DIC_LEA_RATING_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_RATING'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_REASON" ("DIC_LEA_REASON_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_REASON_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_REASON
    WHERE DIC_LEA_REASON_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_REASON'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_REASON_CUST" ("DIC_LEA_REASON_CUST_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_REASON_CUST_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_REASON_CUST
    WHERE DIC_LEA_REASON_CUST_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_REASON_CUST'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_SOURCE" ("DIC_LEA_SOURCE_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_SOURCE_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_SOURCE
    WHERE DIC_LEA_SOURCE_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_SOURCE'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_STATUS" ("C_LEAD_STATUS", "GCDTEXT1", "PC_LANG_ID") AS
  SELECT GCLCODE, GCDTEXT1, PC_LANG_ID
     FROM PCS.PC_GCODES
    WHERE GCGNAME = 'C_LEAD_STATUS'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEA_SUBCATEGORY" ("DIC_LEA_SUBCATEGORY_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEA_SUBCATEGORY_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEA_SUBCATEGORY
    WHERE DIC_LEA_SUBCATEGORY_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEA_SUBCATEGORY'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEO_QUALIF" ("DIC_LEO_QUALIF_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_LEO_QUALIF_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_LEO_QUALIF
    WHERE DIC_LEO_QUALIF_ID = DIT_CODE AND DIT_TABLE = 'DIC_LEO_QUALIF'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_LEO_STATUS" ("C_LEO_STATUS", "GCDTEXT1", "PC_LANG_ID") AS
  SELECT GCLCODE, GCDTEXT1, PC_LANG_ID
     FROM PCS.PC_GCODES
    WHERE GCGNAME = 'C_LEO_STATUS'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_PARTNER_STATUS" ("C_PARTNER_STATUS", "GCDTEXT1", "PC_LANG_ID") AS
  SELECT GCLCODE, GCDTEXT1, PC_LANG_ID
     FROM PCS.PC_GCODES
    WHERE GCGNAME = 'C_PARTNER_STATUS'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_PAYMENT_CONDITION" ("PCO_DESCR", "APT_LABEL", "PC_LANG_ID") AS
  SELECT pco_descr, apt_label, pc_lang_id
     FROM pac_payment_condition PC, pcs.pc_appltxt_traduction ad
    WHERE pc.pc_appltxt_id = ad.pc_appltxt_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_PERSON" ("PAC_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PER_SHORT_NAME", "PER_CONTACT", "C_PARTNER_STATUS", "PCO_DESCR", "REP_DESCR", "DIC_TARIFF_ID", "A_DELETED", "A_DATEMOD", "A_IDMOD") AS
  select p.PAC_PERSON_ID
       , DIC_PERSON_POLITNESS_ID
       , PER_NAME
       , PER_FORENAME
       , PER_ACTIVITY
       , PER_COMMENT
       , PER_KEY1
       , PER_KEY2
       , DIC_FREE_CODE1_ID
       , DIC_FREE_CODE2_ID
       , DIC_FREE_CODE3_ID
       , DIC_FREE_CODE4_ID
       , DIC_FREE_CODE5_ID
       , DIC_FREE_CODE6_ID
       , DIC_FREE_CODE7_ID
       , DIC_FREE_CODE8_ID
       , DIC_FREE_CODE9_ID
       , DIC_FREE_CODE10_ID
       , PER_SHORT_NAME
       , PER_CONTACT
       , p.C_PARTNER_STATUS
       , pco_descr
       , rep_descr
       , dic_tariff_id
       , 0 A_DELETED
       , nvl(p.a_datemod, p.a_datecre) A_DATEMOD
       , nvl(p.a_idmod, p.a_idcre) A_IDMOD
    from pac_person p
       , pac_custom_partner c
       , pac_payment_condition pc
       , pac_representative r
   where p.pac_person_id = pac_custom_partner_id(+)
     and c.pac_payment_condition_id = pc.pac_payment_condition_id(+)
     and c.pac_representative_id = r.pac_representative_id(+)
     and NVL(PER_CONTACT,0)=0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_PERSON_FREE1" ("DIC_FREE_CODE1_ID") AS
  SELECT DIC_FREE_CODE1_ID FROM DIC_FREE_CODE1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_PERSON_POLITNESS" ("DIC_PERSON_POLITNESS_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_PERSON_POLITNESS_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_PERSON_POLITNESS
    WHERE DIC_PERSON_POLITNESS_ID = DIT_CODE AND DIT_TABLE = 'DIC_PERSON_POLITNESS'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_POLITNESS_TYPE" ("DIC_PERSON_POLITNESS_ID") AS
  SELECT DIC_PERSON_POLITNESS_ID FROM DIC_PERSON_POLITNESS


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_QUOTE_TYPE" ("DIC_QUOTE_TYPE_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_QUOTE_TYPE_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_QUOTE_TYPE
    WHERE DIC_QUOTE_TYPE_ID = DIT_CODE AND DIT_TABLE = 'DIC_QUOTE_TYPE'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_RATING_TYPE" ("DIC_LEA_RATING_ID") AS
  SELECT dic_lea_rating_id FROM dic_lea_rating


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_REPRESENTATIVE" ("PAC_REPRESENTATIVE_ID", "REP_DESCR") AS
  SELECT pac_representative_id, rep_descr FROM pac_representative


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_TARIFF" ("DIC_TARIFF_ID", "DIT_DESCR", "PC_LANG_ID") AS
  SELECT DIC_TARIFF_ID, DIT_DESCR, PC_LANG_ID
     FROM DICO_DESCRIPTION, DIC_TARIFF
    WHERE DIC_TARIFF_ID = DIT_CODE AND DIT_TABLE = 'DIC_TARIFF'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_TARIFF_TYPE" ("DIC_TARIFF_ID") AS
  SELECT dic_tariff_id FROM dic_tariff


  CREATE OR REPLACE FORCE VIEW "C_ITX"."MOB_USER" ("PC_USER_ID", "USE_INI", "USE_NAME", "USE_EMAIL") AS
  SELECT pc_user_id,
          use_ini,
          use_name,
          use_email
     FROM pcs.pc_user


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACB_REP_BUDGET" ("ACB_BUDGET_ID", "ACS_FINANCIAL_YEAR_ID", "BUD_DESCR", "ACB_BUDGET_VERSION_ID", "C_BUDGET_STATUS", "VER_NUMBER", "VER_DEFAULT", "VER_CASH_FLOW", "VER_MULTI_CURRENCY", "ACB_GLOBAL_BUDGET_ID", "C_BUDGET_TYPE", "C_BUDGET_KIND", "DIC_UPDATE_REASON_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_BUDGET_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "GLO_DESCR", "GLO_AMOUNT_D", "GLO_AMOUNT_C", "GLO_QTY_D", "GLO_QTY_C", "GLO_RATE", "GLO_ROUNDED_AMOUNT", "GCO_GOOD_ID", "PAC_PERSON_ID", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "DOC_RECORD_ID", "ACB_PERIOD_AMOUNT_ID", "ACS_PERIOD_ID", "PER_AMOUNT_D", "PER_AMOUNT_C", "PER_AMOUNT_FC_D", "PER_AMOUNT_FC_C", "PER_QTY_D", "PER_QTY_C") AS
  select BUD.ACB_BUDGET_ID
       , BUD.ACS_FINANCIAL_YEAR_ID
       , BUD.BUD_DESCR
       , VER.ACB_BUDGET_VERSION_ID
       , VER.C_BUDGET_STATUS
       , VER.VER_NUMBER
       , VER.VER_DEFAULT
       , VER.VER_CASH_FLOW
       , VER.VER_MULTI_CURRENCY
       , GLO.ACB_GLOBAL_BUDGET_ID
       , GLO.C_BUDGET_TYPE
       , GLO.C_BUDGET_KIND
       , GLO.DIC_UPDATE_REASON_ID
       , GLO.ACS_FINANCIAL_CURRENCY_ID
       , GLO.ACS_ACS_FINANCIAL_CURRENCY_ID
       , GLO.ACS_BUDGET_ACCOUNT_ID
       , GLO.ACS_FINANCIAL_ACCOUNT_ID
       , GLO.ACS_DIVISION_ACCOUNT_ID
       , GLO.ACS_CPN_ACCOUNT_ID
       , GLO.ACS_PF_ACCOUNT_ID
       , GLO.ACS_CDA_ACCOUNT_ID
       , GLO.ACS_PJ_ACCOUNT_ID
       , GLO.ACS_QTY_UNIT_ID
       , GLO.GLO_DESCR
       , GLO.GLO_AMOUNT_D
       , GLO.GLO_AMOUNT_C
       , GLO.GLO_QTY_D
       , GLO.GLO_QTY_C
       , GLO.GLO_RATE
       , GLO.GLO_ROUNDED_AMOUNT
       , GLO.GCO_GOOD_ID
       , GLO.PAC_PERSON_ID
       , GLO.HRM_PERSON_ID
       , GLO.FAM_FIXED_ASSETS_ID
       , GLO.DOC_RECORD_ID
       , PER.ACB_PERIOD_AMOUNT_ID
       , PER.ACS_PERIOD_ID
       , PER.PER_AMOUNT_D
       , PER.PER_AMOUNT_C
       , PER.PER_AMOUNT_FC_D
       , PER.PER_AMOUNT_FC_C
       , PER.PER_QTY_D
       , PER.PER_QTY_C
    from ACB_PERIOD_AMOUNT PER
       , ACB_GLOBAL_BUDGET GLO
       , ACB_BUDGET_VERSION VER
       , ACB_BUDGET BUD
   where BUD.ACB_BUDGET_ID = VER.ACB_BUDGET_ID
     and VER.ACB_BUDGET_VERSION_ID = GLO.ACB_BUDGET_VERSION_ID
     and GLO.ACB_GLOBAL_BUDGET_ID = PER.ACB_GLOBAL_BUDGET_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_ADDRESS" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "PC_CNTRY_ID", "PC_LANG_ID", "DIC_ADDRESS_TYPE_ID") AS
  select CNV.ACI_CONVERSION_ID,
         CSO.ACI_CONVERSION_SOURCE_ID,
         CSO.CSO_JOIN_KEY,
         CSO.C_ASCII_FAIL_REASON,
         CSO.CSO_TRANSFERT_DATE,
         rtrim(substr(CSO.CSO_DATA1,2,1 )) UPDATE_MODE,
         rtrim(substr(CSO.CSO_DATA1,3,20)) PER_KEY1,
         decode(rtrim(substr(CSO.CSO_DATA1,734,60)),
                null,decode(rtrim(substr(CSO.CSO_DATA1,674,60)),
                            null,decode(rtrim(substr(CSO.CSO_DATA1,288,60)),
                                        null,decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                                    null, '',
                                                    rtrim(substr(CSO.CSO_DATA1,228,60))),
                                             decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                                    null,rtrim(substr(CSO.CSO_DATA1,288,60)),
                                                    rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                                    rtrim(substr(CSO.CSO_DATA1,288,60))
                                                  )
                                       ),
                              decode(rtrim(substr(CSO.CSO_DATA1,288,60)),
                                     null,decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                                 null,rtrim(substr(CSO.CSO_DATA1,674,60)),
                                                 rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                                 rtrim(substr(CSO.CSO_DATA1,674,60))
                                                  ),
                                     decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                            null,rtrim(substr(CSO.CSO_DATA1,288,60))||chr(13)||chr(10)||
                                                 rtrim(substr(CSO.CSO_DATA1,674,60)),
                                            rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                            rtrim(substr(CSO.CSO_DATA1,288,60))||chr(13)||chr(10)||
                                            rtrim(substr(CSO.CSO_DATA1,674,60))
                                           )
                                    )
                           ),
                decode(rtrim(substr(CSO.CSO_DATA1,674,60)),
                       null,decode(rtrim(substr(CSO.CSO_DATA1,288,60)),
                                   null,decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                               null, rtrim(substr(CSO.CSO_DATA1,734,60)) ,
                                               rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                               rtrim(substr(CSO.CSO_DATA1,734,60))
                                              ),
                                   decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                          null,rtrim(substr(CSO.CSO_DATA1,288,60))||chr(13)||chr(10)||
                                               rtrim(substr(CSO.CSO_DATA1,734,60)),
                                          rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                          rtrim(substr(CSO.CSO_DATA1,288,60))||chr(13)||chr(10)||
                                          rtrim(substr(CSO.CSO_DATA1,734,60))
                                          )
                                   ),
                       decode(rtrim(substr(CSO.CSO_DATA1,288,60)),
                              null,decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                          null,rtrim(substr(CSO.CSO_DATA1,674,60))||chr(13)||chr(10)||
                                               rtrim(substr(CSO.CSO_DATA1,734,60)),
                                          rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                          rtrim(substr(CSO.CSO_DATA1,674,60))||chr(13)||chr(10)||
                                          rtrim(substr(CSO.CSO_DATA1,734,60))
                                          ),
                              decode(rtrim(substr(CSO.CSO_DATA1,228,60)),
                                     null,rtrim(substr(CSO.CSO_DATA1,288,60))||chr(13)||chr(10)||
                                          rtrim(substr(CSO.CSO_DATA1,674,60))||chr(13)||chr(10)||
                                          rtrim(substr(CSO.CSO_DATA1,734,60)),
                                     rtrim(substr(CSO.CSO_DATA1,228,60))||chr(13)||chr(10)||
                                     rtrim(substr(CSO.CSO_DATA1,288,60))||chr(13)||chr(10)||
                                     rtrim(substr(CSO.CSO_DATA1,674,60))||chr(13)||chr(10)||
                                     rtrim(substr(CSO.CSO_DATA1,734,60)))
                             )
                       )
              ) ADD_ADDRESS1,
         rtrim(substr(CSO.CSO_DATA1,348,10)) ADD_ZIPCODE,
         rtrim(substr(CSO.CSO_DATA1,358,30)) ADD_CITY,
         rtrim(substr(CSO.CSO_DATA1,388,30)) ADD_STATE,
         CNT.PC_CNTRY_ID,
         LAN.PC_LANG_ID,
         NVL(trim(substr(CSO.CSO_DATA1,664,10)), DIC.DIC_ADDRESS_TYPE_ID) DIC_ADDRESS_TYPE_ID
  from ACI_CONVERSION_SOURCE CSO,
       ACI_CONVERSION CNV,
       ACI_CONVERSION_TYPE CTY,
       PCS.PC_CNTRY CNT,
       PCS.PC_LANG LAN,
       DIC_ADDRESS_TYPE DIC
  where  CSO.ACI_CONVERSION_ID      = CNV.ACI_CONVERSION_ID
     and CTY.ACI_CONVERSION_TYPE_ID = CNV.ACI_CONVERSION_TYPE_ID
     and rtrim(substr(CSO.CSO_DATA1,1,1)) = '1'
     and CTY.C_SOURCE_TYPE          = '80'
     and CNT.CNTID(+)               = rtrim(substr(CSO.CSO_DATA1,418,3))
     and LAN.LANID(+)               = NVL(rtrim(substr(CSO.CSO_DATA1,421,3  )),PCS.PC_I_LIB_SESSION.GetCompLangId)
     and DIC.DAD_DEFAULT            = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_COMMUNICATION" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "DIC_COMMUNICATION_TYPE_ID1", "COM_AREA_CODE1", "COM_EXT_NUMBER1", "COM_INT_NUMBER1", "DIC_COMMUNICATION_TYPE_ID2", "COM_AREA_CODE2", "COM_EXT_NUMBER2", "COM_INT_NUMBER2", "DIC_COMMUNICATION_TYPE_ID3", "COM_AREA_CODE3", "COM_EXT_NUMBER3", "COM_INT_NUMBER3") AS
  SELECT
  b.aci_conversion_id,
  a.aci_conversion_source_id,
  a.cso_join_key,
  a.c_ascii_fail_reason,
  a.cso_transfert_date,
  rtrim(substr(cso_data1,2,1)) UPDATE_MODE,
  rtrim(substr(cso_data1,3,20)) PER_KEY1,
  (select DIC_COMMUNICATION_TYPE_ID from DIC_COMMUNICATION_TYPE where DCO_DEFAULT1 = 1)  DIC_COMMUNICATION_TYPE_ID1,
  rtrim(substr(cso_data1,424,10)) COM_AREA_CODE1,
  rtrim(substr(cso_data1,434,60)) COM_EXT_NUMBER1,
  rtrim(substr(cso_data1,494,10)) COM_INT_NUMBER1,
  (select DIC_COMMUNICATION_TYPE_ID from DIC_COMMUNICATION_TYPE where DCO_DEFAULT2 = 1) DIC_COMMUNICATION_TYPE_ID2,
  rtrim(substr(cso_data1,504,10)) COM_AREA_CODE2,
  rtrim(substr(cso_data1,514,60)) COM_EXT_NUMBER2,
  rtrim(substr(cso_data1,574,10)) COM_INT_NUMBER2,
  (select DIC_COMMUNICATION_TYPE_ID from DIC_COMMUNICATION_TYPE where DCO_DEFAULT3 = 1) DIC_COMMUNICATION_TYPE_ID3,
  rtrim(substr(cso_data1,584,10)) COM_AREA_CODE3,
  rtrim(substr(cso_data1,594,60)) COM_EXT_NUMBER3,
  rtrim(substr(cso_data1,654,10)) COM_INT_NUMBER3
FROM
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c
WHERE
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  rtrim(substr(cso_data1,1,1)) = '1' and
  c.c_source_type = '80'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_CUSTOMER" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "C_PARTNER_CATEGORY", "C_STATUS_SETTLEMENT", "C_REMAINDER_LAUNCHING", "C_PARTNER_STATUS", "C_TYPE_EDI", "ACS_VAT_DET_ACCOUNT_ID", "PAC_PAYMENT_CONDITION_ID", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_REPRESENTATIVE_ID", "ACS_INVOICE_COLL_ID", "ACS_PREP_COLL_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_SUB_SET_ID", "PAC_REMAINDER_CATEGORY_ID", "DIC_TYPE_SUBMISSION_ID") AS
  SELECT
  b.aci_conversion_id,
  a.aci_conversion_source_id,
  a.cso_join_key,
  a.c_ascii_fail_reason,
  a.cso_transfert_date,
  rtrim(substr(cso_data1,2,1)) UPDATE_MODE,
  rtrim(substr(cso_data1,3,20)) PER_KEY1,
  rtrim(substr(cso_data1,24,1)) C_PARTNER_CATEGORY,
  rtrim(substr(cso_data1,85,10)) C_STATUS_SETTLEMENT,
  'AUTO' C_REMAINDER_LAUNCHING,
  '1' C_PARTNER_STATUS,
  '0' C_TYPE_EDI,
  NVL(f.acs_vat_det_account_id, g.acs_vat_det_account_id) ACS_VAT_DET_ACCOUNT_ID,
  NVL(h.pac_payment_condition_id, i.pac_payment_condition_id) PAC_PAYMENT_CONDITION_ID,
  e.ACS_AUXILIARY_ACCOUNT_ID,
  j.PAC_REPRESENTATIVE_ID,
  l.ACS_FINANCIAL_ACCOUNT_ID ACS_INVOICE_COLL_ID,
  n.ACS_FINANCIAL_ACCOUNT_ID ACS_PREP_COLL_ID,
  q.ACS_FINANCIAL_CURRENCY_ID,
  TO_NUMBER(rtrim(substr(cso_data1,422,12))) acs_sub_set_id,
--  r.pac_remainder_category_id,
  (select max(pac_remainder_category_id) from pac_remainder_category where rca_default = 1) pac_remainder_category_id,
  rtrim(substr(cso_data1,434,10)) DIC_TYPE_SUBMISSION_ID
FROM
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c,
  acs_account d,
  acs_auxiliary_account e,
  acs_vat_det_account f,
  acs_vat_det_account g,
  pac_payment_condition h,
  pac_payment_condition i,
  pac_representative j,
  acs_description k,
  acs_financial_account l,
  acs_account m,
  acs_financial_account n,
  acs_account o,
  pcs.pc_curr p,
  acs_financial_currency q
--  pac_remainder_category r
WHERE
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '80' and
  rtrim(substr(cso_data1,1,1)) = '2' and
  rtrim(substr(cso_data1,23,1)) = '1' and -- dbiteur
  d.acc_number (+) = rtrim(substr(cso_data1,232,30)) and
  e.acs_auxiliary_account_id (+) = d.acs_account_id and
  k.des_description_summary (+) = rtrim(substr(cso_data1,95,50)) and
  k.pc_lang_id (+) = PCS.PC_I_LIB_SESSION.GetCompLangId and
  f.acs_vat_det_account_id (+) = k.acs_vat_det_account_id and
  g.vde_default (+) = DECODE(rtrim(substr(cso_data1,95,50)),null,1,2) and
  h.pco_descr (+) = rtrim(substr(cso_data1,25,50)) and
  i.pco_default (+) = DECODE(rtrim(substr(cso_data1,25,50)),null,1,2) and
  j.rep_descr (+) = rtrim(substr(cso_data1,322,98)) and
  m.acc_number (+) = rtrim(substr(cso_data1,262,30)) and
  l.acs_financial_account_id (+) = m.acs_account_id and
  o.acc_number (+) = rtrim(substr(cso_data1,292,30)) and
  n.acs_financial_account_id (+) = o.acs_account_id and
  p.currency (+) = rtrim(substr(cso_data1,229,3)) and
  q.pc_curr_id (+) = p.pc_curr_id
--  r.rca_default (+) = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_DET_PMT" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "PAR_DOCUMENT", "DET_SEQ_NUMBER", "ACT_EXPIRY_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_DISCOUNT_LC", "DET_DISCOUNT_FC", "DET_DEDUCTION_LC", "DET_DEDUCTION_FC", "DET_DIFF_EXCHANGE", "CAT_KEY_DET") AS
  select distinct CSO.ACI_CONVERSION_ID
                , CSO.ACI_CONVERSION_SOURCE_ID
                , CSO.CSO_JOIN_KEY
                , rtrim(substr(CSO.CSO_DATA1, 33, 30) ) PAR_DOCUMENT
                , decode(rtrim(substr(CSO.CSO_DATA1, 33, 30) )
                       , '', ''
                       , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 63, 9) ), '0') )
                        ) DET_SEQ_NUMBER
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 72, 12) ), null) ) ACT_EXPIRY_ID
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 84, 18) ), '0') ) / 100 DET_PAIED_LC
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 102, 18) ), '0') ) / 100 DET_PAIED_FC
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 120, 18) ), '0') ) / 100 DET_DISCOUNT_LC
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 138, 18) ), '0') ) / 100 DET_DISCOUNT_FC
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 156, 18) ), '0') ) / 100 DET_DEDUCTION_LC
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 174, 18) ), '0') ) / 100 DET_DEDUCTION_FC
                , to_number(nvl(rtrim(substr(CSO.CSO_DATA1, 192, 18) ), '0') ) / 100 DET_DIFF_EXCHANGE
                , rtrim(substr(CSO.CSO_DATA1, 211, 30) ) CAT_KEY_DET
             from ACI_CONVERSION_SOURCE CS1
                , ACI_CONVERSION_SOURCE CSO
                , ACI_CONVERSION CVS
                , ACI_CONVERSION_TYPE CTY
                , ACJ_JOB_TYPE_S_CATALOGUE JTC
                , ACJ_CATALOGUE_DOCUMENT DOC
                , ACJ_SUB_SET_CAT SUB
                , ACJ_JOB_TYPE TYP
            where CVS.ACI_CONVERSION_ID = CSO.ACI_CONVERSION_ID
              and CTY.ACI_CONVERSION_TYPE_ID = CVS.ACI_CONVERSION_TYPE_ID
              and CTY.C_SOURCE_TYPE = '50'
              and CSO.CSO_DATA1 like '04%'
              and CSO.aci_conversion_id = CS1.aci_conversion_id
              and CS1.cso_data1 like '01%'
              and CSO.cso_join_key = CS1.cso_join_key
              and DOC.CAT_KEY = rtrim(substr(CS1.CSO_DATA1, 33, 10) )
              and JTC.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
              and SUB.ACJ_CATALOGUE_DOCUMENT_ID = JTC.ACJ_CATALOGUE_DOCUMENT_ID
              and SUB.C_SUB_SET in('REC', 'PAY')
              and TYP.ACJ_JOB_TYPE_ID = JTC.ACJ_JOB_TYPE_ID
              and TYP.C_ACI_FINANCIAL_LINK <> '1'
              and CSO.CSO_TRANSFERT_DATE is null


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_DOCUMENT" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_INTERFACE_ORIGIN", "C_INTERFACE_CONTROL", "ACJ_JOB_TYPE_S_CATALOGUE_ID", "CSO_TRANSFERT_DATE", "CTY_DOC_NUMBER", "DOC_NUMBER", "CAT_KEY", "DOC_DOCUMENT_DATE", "CURRENCY", "DOC_TOTAL_AMOUNT_DC", "FYE_NO_EXERCICE", "DOC_TRANSACTION_DATE", "DOC_VALUE_DATE", "DOC_GRP_KEY", "DOC_COMMENT", "CAT_KEY_PMT", "DOC_PAID_AMOUNT_LC", "DOC_PAID_AMOUNT_FC", "TYP_KEY") AS
  select distinct
  CSO.ACI_CONVERSION_ID,
  CSO.ACI_CONVERSION_SOURCE_ID,
  CSO.CSO_JOIN_KEY,
  '3' C_INTERFACE_ORIGIN,
  '3' C_INTERFACE_CONTROL,
  JTC.ACJ_JOB_TYPE_S_CATALOGUE_ID,
  CSO.CSO_TRANSFERT_DATE,
  CTY.CTY_DOC_NUMBER,
  rtrim(substr(CSO.CSO_DATA1,3,30)) DOC_NUMBER,
  rtrim(substr(CSO.CSO_DATA1,33,10)) CAT_KEY,
  to_date(substr(CSO.CSO_DATA1,43,8),'YYYYMMDD') DOC_DOCUMENT_DATE,
  rtrim(substr(CSO.CSO_DATA1,51,3)) CURRENCY,
  to_number(NVL(rtrim(substr(CSO.CSO_DATA1,54,18)),'0'))/100 DOC_TOTAL_AMOUNT_DC,
  rtrim(substr(CSO.CSO_DATA1,72,5)) FYE_NO_EXERCICE,
  to_date(substr(CSO.CSO_DATA1,215,8),'YYYYMMDD') DOC_TRANSACTION_DATE,
  to_date(substr(CSO.CSO_DATA1,223,8),'YYYYMMDD') DOC_VALUE_DATE,
  rtrim(substr(CSO.CSO_DATA1,337,30)) DOC_GRP_KEY,
  CSO.CSO_DATA3 DOC_COMMENT,
  rtrim(substr(CSO.CSO_DATA1,231,10)) CAT_KEY_PMT,
  to_number(NVL(rtrim(substr(CSO.CSO_DATA1,241,18)),'0'))/100 DOC_PAID_AMOUNT_LC,
  to_number(NVL(rtrim(substr(CSO.CSO_DATA1,259,18)),'0'))/100 DOC_PAID_AMOUNT_FC,
  TYP.TYP_KEY
from
  ACJ_JOB_TYPE_S_CATALOGUE JTC,
  ACJ_CATALOGUE_DOCUMENT DOC,
  ACJ_SUB_SET_CAT SUB,
  ACJ_JOB_TYPE TYP,
  ACI_CONVERSION CVS,
  ACI_CONVERSION_TYPE CTY,
  ACI_CONVERSION_SOURCE CSO
where CVS.ACI_CONVERSION_ID = CSO.ACI_CONVERSION_ID
  and CTY.ACI_CONVERSION_TYPE_ID = CVS.ACI_CONVERSION_TYPE_ID
  and CTY.C_SOURCE_TYPE = '50'
  and CSO.CSO_DATA1 LIKE '01%'
  and DOC.CAT_KEY  = rtrim(substr(CSO.CSO_DATA1,33,10))
  and JTC.ACJ_CATALOGUE_DOCUMENT_ID  = DOC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUB.ACJ_CATALOGUE_DOCUMENT_ID  = JTC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUB.C_SUB_SET in ('REC','PAY','ACC','CPN')
  and TYP.ACJ_JOB_TYPE_ID = JTC.ACJ_JOB_TYPE_ID
  and TYP.C_ACI_FINANCIAL_LINK <> '1'
  and CSO.CSO_TRANSFERT_DATE is null




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_EXPIRY" ("ACI_CONVERSION_ID", "CSO_JOIN_KEY", "C_STATUS_EXPIRY", "DOC_NUMBER", "EXP_SLICE", "EXP_DATE_PMT_TOT", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_CALC_NET", "EXP_REF_BVR") AS
  select
  a. aci_conversion_id,
  a.cso_join_key,
  decode(to_number(nvl(rtrim(substr(cso_data1,43,18)),'0'))+to_number(nvl(rtrim(substr(cso_data1,61,18)),'0')),0,'1','0') C_STATUS_EXPIRY,
  rtrim(substr(cso_data1,3,30)) DOC_NUMBER,
  to_number(NVL(rtrim(substr(cso_data1,33,2)),'0')) EXP_SLICE,
  decode(to_number(nvl(rtrim(substr(cso_data1,43,18)),'0'))+to_number(nvl(rtrim(substr(cso_data1,61,18)),'0')),0,to_date(substr(cso_data1,35,8),'YYYYMMDD'),null) EXP_DATE_PMT_TOT,
  to_date(substr(cso_data1,35,8),'YYYYMMDD') EXP_ADAPTED,
  to_date(substr(cso_data1,35,8),'YYYYMMDD') EXP_CALCULATED,
  to_number(NVL(rtrim(substr(cso_data1,43,18)),'0'))/100 EXP_AMOUNT_LC,
  to_number(NVL(rtrim(substr(cso_data1,61,18)),'0'))/100 EXP_AMOUNT_FC,
  to_number(NVL(rtrim(substr(cso_data1,79,18)),'0'))/100 EXP_DISCOUNT_LC,
  to_number(NVL(rtrim(substr(cso_data1,97,18)),'0'))/100 EXP_DISCOUNT_FC,
  1 - sign(abs(to_number(NVL(rtrim(substr(cso_data1,79,18)),'0')))) EXP_CALC_NET,
  DECODE(to_number(NVL(rtrim(substr(cso_data1,115,27)),'0')),0,'',rtrim(substr(cso_data1,115,27))) EXP_REF_BVR
from
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c
where
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '50' and
  cso_data1||'' like '02%' and
  CSO_TRANSFERT_DATE is null




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_FIN_IMPUTATION" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "CSO_LINE_NUMBER", "DOC_NUMBER", "IMF_PRIMARY", "ACC_NUMBER", "DIV_NUMBER", "TAX_NUMBER", "IMF_DESCRIPTION", "CURRENCY1", "CURRENCY2", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_EXCHANGE_RATE", "IMF_BASE_PRICE", "TAX_INCLUDED_EXCLUDED", "TAX_LIABLED_AMOUNT", "TAX_LIABLED_RATE", "TAX_RATE", "TAX_VAT_AMOUNT_LC", "TAX_VAT_AMOUNT_FC", "PER_KEY1", "EMP_NUMBER", "RCO_TITLE", "GOO_MAJOR_REFERENCE", "FIX_NUMBER", "C_FAM_TRANSACTION_TYP", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "CDA_NUMBER", "CPN_NUMBER", "PF_NUMBER", "PJ_NUMBER", "QTY_NUMBER", "IMM_DESCRIPTION", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "MGM_PER_KEY1", "MGM_EMP_NUMBER", "MGM_RCO_TITLE", "MGM_GOO_MAJOR_REFERENCE", "MGM_FIX_NUMBER", "MGM_C_FAM_TRANSACTION_TYP", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "MGM_DIC_IMP_FREE1_ID", "MGM_DIC_IMP_FREE2_ID", "MGM_DIC_IMP_FREE3_ID", "MGM_DIC_IMP_FREE4_ID", "MGM_DIC_IMP_FREE5_ID") AS
  select
  a. aci_conversion_id,
  a. aci_conversion_source_id,
  a.cso_join_key,
  a.cso_line_number,
  rtrim(substr(a.cso_data1,3,30)) DOC_NUMBER,
  decode(substr(a.cso_data1,33,1),'1',1,0)  IMF_PRIMARY,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,851,20)), rtrim(substr(a.cso_data1,34,10))) ACC_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,871,20)), rtrim(substr(a.cso_data1,44,10))) DIV_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,891,20)), rtrim(substr(a.cso_data1,54,10))) TAX_NUMBER,
  rtrim(substr(a.cso_data1,114,100)) IMF_DESCRIPTION,
  NVL(rtrim(substr(a.cso_data1,214,3)),(select ACS_FUNCTION.GetLocalCurrencyName from dual)) CURRENCY1,
  (select ACS_FUNCTION.GetLocalCurrencyName from dual) CURRENCY2,
  to_number(NVL(rtrim(substr(a.cso_data1,217,18)),'0'))/100 IMF_AMOUNT_LC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,235,18)),'0'))/100 IMF_AMOUNT_LC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,253,18)),'0'))/100 IMF_AMOUNT_FC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,271,18)),'0'))/100 IMF_AMOUNT_FC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,325,12)),'0'))/1000000 IMF_EXCHANGE_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,337,5)),'0')) IMF_BASE_PRICE,
  DECODE(substr(a.cso_data1,342,1),
         '0','E',
         '1','I') TAX_INCLUDED_EXCLUDED,
  to_number(NVL(rtrim(substr(a.cso_data1,343,18)),'0'))/100 TAX_LIABLED_AMOUNT,
  to_number(NVL(rtrim(substr(a.cso_data1,361,3)),'0')) TAX_LIABLED_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,364,6)),'0'))/100 TAX_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,370,18)),'0'))/100 TAX_VAT_AMOUNT_LC,
  to_number(NVL(rtrim(substr(a.cso_data1,388,18)),'0'))/100 TAX_VAT_AMOUNT_FC,
  rtrim(substr(a.cso_data1,406,20)) PER_KEY1,
  rtrim(substr(a.cso_data1,426,20)) EMP_NUMBER,
  rtrim(substr(a.cso_data1,446,30)) RCO_TITLE,
  rtrim(substr(a.cso_data1,476,30)) GOO_MAJOR_REFERENCE,
  rtrim(substr(a.cso_data1,506,30)) FIX_NUMBER,
  rtrim(substr(a.cso_data1,536,10)) C_FAM_TRANSACTION_TYP,
  to_number(NVL(rtrim(substr(a.cso_data1,546,21)),'0')) IMF_NUMBER,
  to_number(NVL(rtrim(substr(a.cso_data1,567,21)),'0')) IMF_NUMBER2,
  to_number(NVL(rtrim(substr(a.cso_data1,588,21)),'0')) IMF_NUMBER3,
  to_number(NVL(rtrim(substr(a.cso_data1,609,21)),'0')) IMF_NUMBER4,
  to_number(NVL(rtrim(substr(a.cso_data1,630,21)),'0')) IMF_NUMBER5,
  rtrim(substr(a.cso_data1,651,30)) IMF_TEXT1,
  rtrim(substr(a.cso_data1,681,30)) IMF_TEXT2,
  rtrim(substr(a.cso_data1,711,30)) IMF_TEXT3,
  rtrim(substr(a.cso_data1,741,30)) IMF_TEXT4,
  rtrim(substr(a.cso_data1,771,30)) IMF_TEXT5,
  rtrim(substr(a.cso_data1,801,10)) DIC_IMP_FREE1_ID,
  rtrim(substr(a.cso_data1,811,10)) DIC_IMP_FREE2_ID,
  rtrim(substr(a.cso_data1,821,10)) DIC_IMP_FREE3_ID,
  rtrim(substr(a.cso_data1,831,10)) DIC_IMP_FREE4_ID,
  rtrim(substr(a.cso_data1,841,10)) DIC_IMP_FREE5_ID,
  to_number(NVL(rtrim(substr(a.cso_data1,289,18)),'0'))/100 IMM_QUANTITY_D,
  to_number(NVL(rtrim(substr(a.cso_data1,307,18)),'0'))/100 IMM_QUANTITY_C,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,931,20)), rtrim(substr(a.cso_data1,74,10))) CDA_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,911,20)), rtrim(substr(a.cso_data1,64,10))) CPN_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,951,20)), rtrim(substr(a.cso_data1,84,10))) PF_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,971,20)), rtrim(substr(a.cso_data1,94,10))) PJ_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,991,20)), rtrim(substr(a.cso_data1,104,10))) QTY_NUMBER,
  rtrim(substr(a.cso_data1,114,100)) IMM_DESCRIPTION,
  to_number(NVL(rtrim(substr(a.cso_data1,217,18)),'0'))/100 IMM_AMOUNT_LC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,235,18)),'0'))/100 IMM_AMOUNT_LC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,253,18)),'0'))/100 IMM_AMOUNT_FC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,271,18)),'0'))/100 IMM_AMOUNT_FC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,325,12)),'0'))/1000000 IMM_EXCHANGE_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,337,5)),'0')) IMM_BASE_PRICE,
  rtrim(substr(a.cso_data1,406,20)) MGM_PER_KEY1,
  rtrim(substr(a.cso_data1,426,20)) MGM_EMP_NUMBER,
  rtrim(substr(a.cso_data1,446,30)) MGM_RCO_TITLE,
  rtrim(substr(a.cso_data1,476,30)) MGM_GOO_MAJOR_REFERENCE,
  rtrim(substr(a.cso_data1,506,30)) MGM_FIX_NUMBER,
  rtrim(substr(a.cso_data1,536,10)) MGM_C_FAM_TRANSACTION_TYP,
  to_number(NVL(rtrim(substr(a.cso_data1,546,21)),'0')) IMM_NUMBER,
  to_number(NVL(rtrim(substr(a.cso_data1,567,21)),'0')) IMM_NUMBER2,
  to_number(NVL(rtrim(substr(a.cso_data1,588,21)),'0')) IMM_NUMBER3,
  to_number(NVL(rtrim(substr(a.cso_data1,609,21)),'0')) IMM_NUMBER4,
  to_number(NVL(rtrim(substr(a.cso_data1,630,21)),'0')) IMM_NUMBER5,
  rtrim(substr(a.cso_data1,651,30)) IMM_TEXT1,
  rtrim(substr(a.cso_data1,681,30)) IMM_TEXT2,
  rtrim(substr(a.cso_data1,711,30)) IMM_TEXT3,
  rtrim(substr(a.cso_data1,741,30)) IMM_TEXT4,
  rtrim(substr(a.cso_data1,771,30)) IMM_TEXT5,
  rtrim(substr(a.cso_data1,801,10)) MGM_DIC_IMP_FREE1_ID,
  rtrim(substr(a.cso_data1,811,10)) MGM_DIC_IMP_FREE2_ID,
  rtrim(substr(a.cso_data1,821,10)) MGM_DIC_IMP_FREE3_ID,
  rtrim(substr(a.cso_data1,831,10)) MGM_DIC_IMP_FREE4_ID,
  rtrim(substr(a.cso_data1,841,10)) MGM_DIC_IMP_FREE5_ID
from
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c
where
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '50' and
  A.ACI_CONVERSION_ID = B.ACI_CONVERSION_ID AND
  A.cso_data1||'' like '03%' AND
  a.CSO_TRANSFERT_DATE is null and
  substr(a.cso_data1,33,1) = '0' and
  ( decode(a.cso_version, '02', rtrim(substr(a.cso_data1,851,20)), rtrim(substr(a.cso_data1,34,10))) is not null or
    decode(a.cso_version, '02', rtrim(substr(a.cso_data1,871,20)), rtrim(substr(a.cso_data1,44,10))) is not null)
union all
select
  a. aci_conversion_id,
  a. aci_conversion_source_id,
  a.cso_join_key,
  a.cso_line_number,
  rtrim(substr(a.cso_data1,3,30)) DOC_NUMBER,
  decode(substr(a.cso_data1,33,1),'1',1,0)  IMF_PRIMARY,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,851,20)), rtrim(substr(a.cso_data1,34,10))) ACC_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,871,20)), rtrim(substr(a.cso_data1,44,10))) DIV_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,891,20)), rtrim(substr(a.cso_data1,54,10))) TAX_NUMBER,
  rtrim(substr(a.cso_data1,114,100)) IMF_DESCRIPTION,
  NVL(rtrim(substr(a.cso_data1,214,3)),(select ACS_FUNCTION.GetLocalCurrencyName from dual)) CURRENCY1,
  (select ACS_FUNCTION.GetLocalCurrencyName from dual) CURRENCY2,
  to_number(NVL(rtrim(substr(a.cso_data1,217,18)),'0'))/100 IMF_AMOUNT_LC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,235,18)),'0'))/100 IMF_AMOUNT_LC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,253,18)),'0'))/100 IMF_AMOUNT_FC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,271,18)),'0'))/100 IMF_AMOUNT_FC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,325,12)),'0'))/1000000 IMF_EXCHANGE_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,337,5)),'0')) IMF_BASE_PRICE,
  DECODE(substr(a.cso_data1,342,1),
         '0','E',
         '1','I') TAX_INCLUDED_EXCLUDED,
  to_number(NVL(rtrim(substr(a.cso_data1,343,18)),'0'))/100 TAX_LIABLED_AMOUNT,
  to_number(NVL(rtrim(substr(a.cso_data1,361,3)),'0')) TAX_LIABLED_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,364,6)),'0'))/100 TAX_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,370,18)),'0'))/100 TAX_VAT_AMOUNT_LC,
  to_number(NVL(rtrim(substr(a.cso_data1,388,18)),'0'))/100 TAX_VAT_AMOUNT_FC,
  rtrim(substr(a.cso_data1,406,20)) PER_KEY1,
  rtrim(substr(a.cso_data1,426,20)) EMP_NUMBER,
  rtrim(substr(a.cso_data1,446,30)) RCO_TITLE,
  rtrim(substr(a.cso_data1,476,30)) GOO_MAJOR_REFERENCE,
  rtrim(substr(a.cso_data1,506,30)) FIX_NUMBER,
  rtrim(substr(a.cso_data1,536,10)) C_FAM_TRANSACTION_TYP,
  to_number(NVL(rtrim(substr(a.cso_data1,546,21)),'0')) IMF_NUMBER,
  to_number(NVL(rtrim(substr(a.cso_data1,567,21)),'0')) IMF_NUMBER2,
  to_number(NVL(rtrim(substr(a.cso_data1,588,21)),'0')) IMF_NUMBER3,
  to_number(NVL(rtrim(substr(a.cso_data1,609,21)),'0')) IMF_NUMBER4,
  to_number(NVL(rtrim(substr(a.cso_data1,630,21)),'0')) IMF_NUMBER5,
  rtrim(substr(a.cso_data1,651,30)) IMF_TEXT1,
  rtrim(substr(a.cso_data1,681,30)) IMF_TEXT2,
  rtrim(substr(a.cso_data1,711,30)) IMF_TEXT3,
  rtrim(substr(a.cso_data1,741,30)) IMF_TEXT4,
  rtrim(substr(a.cso_data1,771,30)) IMF_TEXT5,
  rtrim(substr(a.cso_data1,801,10)) DIC_IMP_FREE1_ID,
  rtrim(substr(a.cso_data1,811,10)) DIC_IMP_FREE2_ID,
  rtrim(substr(a.cso_data1,821,10)) DIC_IMP_FREE3_ID,
  rtrim(substr(a.cso_data1,831,10)) DIC_IMP_FREE4_ID,
  rtrim(substr(a.cso_data1,841,10)) DIC_IMP_FREE5_ID,
  to_number(NVL(rtrim(substr(a.cso_data1,289,18)),'0'))/100 IMM_QUANTITY_D,
  to_number(NVL(rtrim(substr(a.cso_data1,307,18)),'0'))/100 IMM_QUANTITY_C,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,931,20)), rtrim(substr(a.cso_data1,74,10))) CDA_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,911,20)), rtrim(substr(a.cso_data1,64,10))) CPN_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,951,20)), rtrim(substr(a.cso_data1,84,10))) PF_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,971,20)), rtrim(substr(a.cso_data1,94,10))) PJ_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,991,20)), rtrim(substr(a.cso_data1,104,10))) QTY_NUMBER,
  rtrim(substr(a.cso_data1,114,100)) IMM_DESCRIPTION,
  to_number(NVL(rtrim(substr(a.cso_data1,217,18)),'0'))/100 IMM_AMOUNT_LC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,235,18)),'0'))/100 IMM_AMOUNT_LC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,253,18)),'0'))/100 IMM_AMOUNT_FC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,271,18)),'0'))/100 IMM_AMOUNT_FC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,325,12)),'0'))/1000000 IMM_EXCHANGE_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,337,5)),'0')) IMM_BASE_PRICE,
  rtrim(substr(a.cso_data1,406,20)) MGM_PER_KEY1,
  rtrim(substr(a.cso_data1,426,20)) MGM_EMP_NUMBER,
  rtrim(substr(a.cso_data1,446,30)) MGM_RCO_TITLE,
  rtrim(substr(a.cso_data1,476,30)) MGM_GOO_MAJOR_REFERENCE,
  rtrim(substr(a.cso_data1,506,30)) MGM_FIX_NUMBER,
  rtrim(substr(a.cso_data1,536,10)) MGM_C_FAM_TRANSACTION_TYP,
  to_number(NVL(rtrim(substr(a.cso_data1,546,21)),'0')) IMM_NUMBER,
  to_number(NVL(rtrim(substr(a.cso_data1,567,21)),'0')) IMM_NUMBER2,
  to_number(NVL(rtrim(substr(a.cso_data1,588,21)),'0')) IMM_NUMBER3,
  to_number(NVL(rtrim(substr(a.cso_data1,609,21)),'0')) IMM_NUMBER4,
  to_number(NVL(rtrim(substr(a.cso_data1,630,21)),'0')) IMM_NUMBER5,
  rtrim(substr(a.cso_data1,651,30)) IMM_TEXT1,
  rtrim(substr(a.cso_data1,681,30)) IMM_TEXT2,
  rtrim(substr(a.cso_data1,711,30)) IMM_TEXT3,
  rtrim(substr(a.cso_data1,741,30)) IMM_TEXT4,
  rtrim(substr(a.cso_data1,771,30)) IMM_TEXT5,
  rtrim(substr(a.cso_data1,801,10)) MGM_DIC_IMP_FREE1_ID,
  rtrim(substr(a.cso_data1,811,10)) MGM_DIC_IMP_FREE2_ID,
  rtrim(substr(a.cso_data1,821,10)) MGM_DIC_IMP_FREE3_ID,
  rtrim(substr(a.cso_data1,831,10)) MGM_DIC_IMP_FREE4_ID,
  rtrim(substr(a.cso_data1,841,10)) MGM_DIC_IMP_FREE5_ID
from
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c
where
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '50' and
  A.ACI_CONVERSION_ID = B.ACI_CONVERSION_ID AND
  A.cso_data1||'' like '03%' AND
  a.CSO_TRANSFERT_DATE is null and
  substr(a.cso_data1,33,1) = '1'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_FIN_REFERENCE" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "C_TYPE_PARTNER", "FRE_ACCOUNT_NUMBER", "FRE_ACCOUNT_CONTROL", "C_TYPE_REFERENCE", "FRE_DEFAULT", "FRE_DOM_NAME", "FRE_DOM_CITY", "BAN_CLEAR", "BAN_BLZ", "BAN_ETAB", "BAN_GUICH", "PC_CNTRY_ID", "PC_BANK_ID") AS
  SELECT
  b.aci_conversion_id,
  a.aci_conversion_source_id,
  a.cso_join_key,
  a.c_ascii_fail_reason,
  a.cso_transfert_date,
  rtrim(substr(cso_data1,2,1)) UPDATE_MODE,
  rtrim(substr(cso_data1,3,20)) PER_KEY1,
  rtrim(substr(cso_data1,23,1)) C_TYPE_PARTNER,
  rtrim(substr(cso_data1,24,32)) FRE_ACCOUNT_NUMBER,
  rtrim(substr(cso_data1,80,2)) FRE_ACCOUNT_CONTROL,
  rtrim(substr(cso_data1,56,10)) C_TYPE_REFERENCE,
  rtrim(substr(cso_data1,69,1)) FRE_DEFAULT,
  rtrim(substr(cso_data1,82,24)) FRE_DOM_NAME,
  rtrim(substr(cso_data1,106,24)) FRE_DOM_CITY,
  DECODE(rtrim(substr(cso_data1,56,10)),'1',DECODE(SIGN(PC_BANK1.PC_BANK_ID),1,rtrim(substr(cso_data1,70,10)))) BAN_CLEAR,
  DECODE(rtrim(substr(cso_data1,56,10)),'1',DECODE(SIGN(PC_BANK2.PC_BANK_ID),1,TO_NUMBER(rtrim(substr(cso_data1,70,10))))) BAN_BLZ,
  DECODE(rtrim(substr(cso_data1,56,10)),'4',DECODE(PC_BANK1.PC_BANK_ID,NULL,DECODE(PC_BANK2.PC_BANK_ID,NULL,rtrim(substr(cso_data1,70,5))))) BAN_ETAB,
  DECODE(rtrim(substr(cso_data1,56,10)),'4',DECODE(PC_BANK1.PC_BANK_ID,NULL,DECODE(PC_BANK2.PC_BANK_ID,NULL,rtrim(substr(cso_data1,75,5))))) BAN_GUICH,
  PC_CNTRY.PC_CNTRY_ID,
  NVL(NVL(PC_BANK1.PC_BANK_ID, PC_BANK2.PC_BANK_ID),PC_BANK3.PC_BANK_ID) PC_BANK_ID
FROM
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c,
  PCS.PC_CNTRY,
  PCS.PC_BANK PC_BANK1,
  PCS.PC_BANK PC_BANK2,
  PCS.PC_BANK PC_BANK3
WHERE
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '80' and
  PC_CNTRY.CNTID (+) = rtrim(substr(cso_data1,389,30)) and
  PC_BANK1.BAN_CLEAR (+) = rtrim(substr(cso_data1,70,10)) and
  PC_BANK1.BAN_ZIP (+) = rtrim(substr(cso_data1,106,24)) and
  PC_BANK2.BAN_BLZ (+) = TO_NUMBER(rtrim(substr(cso_data1,70,10))) and
  PC_BANK3.BAN_ETAB (+) = rtrim(substr(cso_data1,70,5)) and
  PC_BANK3.BAN_GUICH (+) = rtrim(substr(cso_data1,75,5)) and
  rtrim(substr(cso_data1,56,10)) in ('1','2','3','4','5') and
  rtrim(substr(cso_data1,1,1)) = '3'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_MGM_IMPUTATION" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "CSO_LINE_NUMBER", "IMM_PRIMARY", "DOC_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "QTY_NUMBER", "IMM_DESCRIPTION", "CURRENCY1", "CURRENCY2", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "TAX_INCLUDED_EXCLUDED", "TAX_VAT_AMOUNT_LC", "TAX_VAT_AMOUNT_FC", "PER_KEY1", "EMP_NUMBER", "RCO_TITLE", "GOO_MAJOR_REFERENCE", "FIX_NUMBER", "C_FAM_TRANSACTION_TYP", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID") AS
  select
  a. aci_conversion_id,
  a. aci_conversion_source_id,
  a.cso_join_key,
  a.cso_line_number,
  decode(substr(a.cso_data1,33,1),'1',1,0)  IMM_PRIMARY,
  rtrim(substr(a.cso_data1,3,30)) DOC_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,911,20)), rtrim(substr(a.cso_data1,64,10))) CPN_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,931,20)), rtrim(substr(a.cso_data1,74,10))) CDA_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,951,20)), rtrim(substr(a.cso_data1,84,10))) PF_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,971,20)), rtrim(substr(a.cso_data1,94,10))) PJ_NUMBER,
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,991,20)), rtrim(substr(a.cso_data1,104,10))) QTY_NUMBER,
  rtrim(substr(a.cso_data1,114,100)) IMM_DESCRIPTION,
  rtrim(substr(a.cso_data1,214,3)) CURRENCY1,
  (select ACS_FUNCTION.GetLocalCurrencyName from dual) CURRENCY2,
  to_number(NVL(rtrim(substr(a.cso_data1,217,18)),'0'))/100 IMM_AMOUNT_LC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,235,18)),'0'))/100 IMM_AMOUNT_LC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,253,18)),'0'))/100 IMM_AMOUNT_FC_D,
  to_number(NVL(rtrim(substr(a.cso_data1,271,18)),'0'))/100 IMM_AMOUNT_FC_C,
  to_number(NVL(rtrim(substr(a.cso_data1,289,18)),'0'))/100 IMM_QUANTITY_D,
  to_number(NVL(rtrim(substr(a.cso_data1,307,18)),'0'))/100 IMM_QUANTITY_C,
  to_number(NVL(rtrim(substr(a.cso_data1,325,12)),'0'))/1000000 IMM_EXCHANGE_RATE,
  to_number(NVL(rtrim(substr(a.cso_data1,337,5)),'0')) IMM_BASE_PRICE,
  DECODE(substr(a.cso_data1,342,1),
         '0','E',
         '1','I') TAX_INCLUDED_EXCLUDED,
  to_number(NVL(rtrim(substr(a.cso_data1,370,18)),'0'))/100 TAX_VAT_AMOUNT_LC,
  to_number(NVL(rtrim(substr(a.cso_data1,388,18)),'0'))/100 TAX_VAT_AMOUNT_FC,
  rtrim(substr(a.cso_data1,406,20)) PER_KEY1,
  rtrim(substr(a.cso_data1,426,20)) EMP_NUMBER,
  rtrim(substr(a.cso_data1,446,30)) RCO_TITLE,
  rtrim(substr(a.cso_data1,476,30)) GOO_MAJOR_REFERENCE,
  rtrim(substr(a.cso_data1,506,30)) FIX_NUMBER,
  rtrim(substr(a.cso_data1,536,10)) C_FAM_TRANSACTION_TYP,
  to_number(NVL(rtrim(substr(a.cso_data1,546,21)),'0')) IMM_NUMBER,
  to_number(NVL(rtrim(substr(a.cso_data1,567,21)),'0')) IMM_NUMBER2,
  to_number(NVL(rtrim(substr(a.cso_data1,588,21)),'0')) IMM_NUMBER3,
  to_number(NVL(rtrim(substr(a.cso_data1,609,21)),'0')) IMM_NUMBER4,
  to_number(NVL(rtrim(substr(a.cso_data1,630,21)),'0')) IMM_NUMBER5,
  rtrim(substr(a.cso_data1,651,30)) IMM_TEXT1,
  rtrim(substr(a.cso_data1,681,30)) IMM_TEXT2,
  rtrim(substr(a.cso_data1,711,30)) IMM_TEXT3,
  rtrim(substr(a.cso_data1,741,30)) IMM_TEXT4,
  rtrim(substr(a.cso_data1,771,30)) IMM_TEXT5,
  rtrim(substr(a.cso_data1,801,10)) DIC_IMP_FREE1_ID,
  rtrim(substr(a.cso_data1,811,10)) DIC_IMP_FREE2_ID,
  rtrim(substr(a.cso_data1,821,10)) DIC_IMP_FREE3_ID,
  rtrim(substr(a.cso_data1,831,10)) DIC_IMP_FREE4_ID,
  rtrim(substr(a.cso_data1,841,10)) DIC_IMP_FREE5_ID
from
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c
where
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '50' and
  a.cso_data1||'' like '03%' and
  a.CSO_TRANSFERT_DATE is null and
  ( decode(a.cso_version, '02', rtrim(substr(a.cso_data1,911,20)), rtrim(substr(a.cso_data1,64,10))) is not null or
    decode(a.cso_version, '02', rtrim(substr(a.cso_data1,931,20)), rtrim(substr(a.cso_data1,74,10))) is not null or
    decode(a.cso_version, '02', rtrim(substr(a.cso_data1,951,20)), rtrim(substr(a.cso_data1,84,10))) is not null or
    decode(a.cso_version, '02', rtrim(substr(a.cso_data1,971,20)), rtrim(substr(a.cso_data1,94,10))) is not null ) and
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,851,20)), rtrim(substr(a.cso_data1,34,10))) is null and
  decode(a.cso_version, '02', rtrim(substr(a.cso_data1,871,20)), rtrim(substr(a.cso_data1,44,10))) is null


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_PART_IMPUTATION" ("ACI_CONVERSION_ID", "CSO_JOIN_KEY", "DOC_NUMBER", "PAR_DOCUMENT", "CAT_KEY", "PER_SUPP_KEY1", "PER_SUPP_KEY2", "PER_CUST_KEY1", "PER_CUST_KEY2", "CURRENCY1", "CURRENCY2", "PCO_DESCR", "PAR_BLOCKED_DOCUMENT", "FRE_ACCOUNT_NUMBER", "PAR_REF_BVR", "DES_DESCRIPTION_SUMMARY", "IMF_EXCHANGE_RATE", "IMF_BASE_PRICE") AS
  select distinct
  CSO. ACI_CONVERSION_ID,
  CSO.CSO_JOIN_KEY,
  rtrim(substr(CSO.CSO_DATA1,3,30)) DOC_NUMBER,
  rtrim(substr(CSO.CSO_DATA1,97,30)) PAR_DOCUMENT,
  rtrim(substr(CSO.CSO_DATA1,33,10)) CAT_KEY,
  decode(C_SUB_SET,
         'PAY',rtrim(substr(CSO.CSO_DATA1,77,20))
         ) PER_SUPP_KEY1,
  '' PER_SUPP_KEY2,
  decode(C_SUB_SET,
         'REC',rtrim(substr(CSO.CSO_DATA1,77,20))
         ) PER_CUST_KEY1,
  '' PER_CUST_KEY2,
  rtrim(substr(CSO.CSO_DATA1,51,3)) CURRENCY1,
  (select ACS_FUNCTION.GetLocalCurrencyName from dual) CURRENCY2,
  rtrim(substr(CSO.CSO_DATA1,127,30)) PCO_DESCR,
  decode(rtrim(substr(CSO.CSO_DATA1,187,1)),
         '0',to_number(NVL(rtrim(substr(CSO.CSO_DATA1,187,1)),'0')),
         '1',to_number(NVL(rtrim(substr(CSO.CSO_DATA1,187,1)),'0')),
         null) PAR_BLOCKED_DOCUMENT,
  rtrim(substr(CSO.CSO_DATA1,157,30)) FRE_ACCOUNT_NUMBER,
  rtrim(substr(CSO.CSO_DATA1,188,27)) PAR_REF_BVR,
  rtrim(substr(CSO.CSO_DATA1,277,60)) DES_DESCRIPTION_SUMMARY,
  (select to_number(NVL(rtrim(substr(cs1.cso_data1,325,12)),'0'))/1000000 from aci_conversion_source cs1 where
   cs1.aci_conversion_id  = cso.aci_conversion_id and cs1.CSO_JOIN_KEY = cso.cso_join_key and cs1.cso_data1||'' like '03%'
   and substr(cs1.cso_data1,33,1)= '1') IMF_EXCHANGE_RATE,
     (select to_number(NVL(rtrim(substr(cs1.cso_data1,337,5)),'0')) from aci_conversion_source cs1 where
   cs1.aci_conversion_id  = cso.aci_conversion_id and cs1.CSO_JOIN_KEY = cso.cso_join_key and cs1.cso_data1||'' like '03%'
   and substr(cs1.cso_data1,33,1)= '1') IMF_BASE_PRICE
from
  ACI_CONVERSION_TYPE CTY,
  ACJ_JOB_TYPE_S_CATALOGUE JTC,
  ACJ_CATALOGUE_DOCUMENT DOC,
  ACJ_SUB_SET_CAT SUB,
  ACJ_JOB_TYPE TYP,
  ACI_CONVERSION_SOURCE CSO,
  ACI_CONVERSION CSV
where CSV.ACI_CONVERSION_ID = CSO.ACI_CONVERSION_ID
  and CTY.ACI_CONVERSION_TYPE_ID = CSV.ACI_CONVERSION_TYPE_ID
  and CTY.C_SOURCE_TYPE = '50'
  and CSO.CSO_DATA1 LIKE '01%'
  and DOC.CAT_KEY  = rtrim(substr(CSO.CSO_DATA1,33,10))
  and JTC.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUB.ACJ_CATALOGUE_DOCUMENT_ID     = JTC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUB.C_SUB_SET in ('REC','PAY')
  and TYP.ACJ_JOB_TYPE_ID = JTC.ACJ_JOB_TYPE_ID
  and TYP.C_ACI_FINANCIAL_LINK <> '1'
  and CSO.CSO_TRANSFERT_DATE is null




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_PERSON" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "DIC_PERSON_POLITNESS_ID", "PER_SHORT_NAME", "PER_NAME", "PER_ACTIVITY", "PER_FORENAME") AS
  SELECT
  b.aci_conversion_id,
  a.aci_conversion_source_id,
  a.cso_join_key,
  a.c_ascii_fail_reason,
  a.cso_transfert_date,
  rtrim(substr(cso_data1,2,1)) UPDATE_MODE,
  rtrim(substr(cso_data1,3,20)) PER_KEY1,
  d.DIC_PERSON_POLITNESS_ID,
  rtrim(substr(cso_data1,33,15)) PER_SHORT_NAME,
  rtrim(substr(cso_data1,48,60)) PER_NAME,
  rtrim(substr(cso_data1,168,60)) PER_ACTIVITY,
  rtrim(substr(cso_data1,108,60)) PER_FORENAME
FROM
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c,
  dic_person_politness d
WHERE
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  d.DIC_PERSON_POLITNESS_ID (+) = rtrim(substr(cso_data1,23,10)) and
  c.c_source_type = '80' and
  rtrim(substr(cso_data1,1,1)) = '1'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_SUPPLIER" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "C_PARTNER_CATEGORY", "C_STATUS_SETTLEMENT", "C_REMAINDER_LAUNCHING", "C_PARTNER_STATUS", "C_TYPE_EDI", "ACS_VAT_DET_ACCOUNT_ID", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PAYMENT_CONDITION_ID", "ACS_INVOICE_COLL_ID", "ACS_PREP_COLL_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_SUB_SET_ID", "PAC_REMAINDER_CATEGORY_ID", "DIC_TYPE_SUBMISSION_ID") AS
  SELECT
  b.aci_conversion_id,
  a.aci_conversion_source_id,
  a.cso_join_key,
  a.c_ascii_fail_reason,
  a.cso_transfert_date,
  rtrim(substr(cso_data1,2,1)) UPDATE_MODE,
  rtrim(substr(cso_data1,3,20)) PER_KEY1,
  rtrim(substr(cso_data1,24,1)) C_PARTNER_CATEGORY,
  rtrim(substr(cso_data1,85,10)) C_STATUS_SETTLEMENT,
  'AUTO' C_REMAINDER_LAUNCHING,
  '1' C_PARTNER_STATUS,
  '0' C_TYPE_EDI,
  NVL(f.acs_vat_det_account_id, g.acs_vat_det_account_id) ACS_VAT_DET_ACCOUNT_ID,
  e.ACS_AUXILIARY_ACCOUNT_ID,
  NVL(h.pac_payment_condition_id, i.pac_payment_condition_id) PAC_PAYMENT_CONDITION_ID,
  l.ACS_FINANCIAL_ACCOUNT_ID ACS_INVOICE_COLL_ID,
  n.ACS_FINANCIAL_ACCOUNT_ID ACS_PREP_COLL_ID,
  q.ACS_FINANCIAL_CURRENCY_ID,
  TO_NUMBER(rtrim(substr(cso_data1,422,12))) acs_sub_set_id,
  (select max(pac_remainder_category_id) from pac_remainder_category where rca_default = 1) pac_remainder_category_id,
  rtrim(substr(cso_data1,434,10)) DIC_TYPE_SUBMISSION_ID
FROM
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c,
  acs_account d,
  acs_auxiliary_account e,
  acs_vat_det_account f,
  acs_vat_det_account g,
  pac_payment_condition h,
  pac_payment_condition i,
  acs_description k,
  acs_financial_account l,
  acs_account m,
  acs_financial_account n,
  acs_account o,
  pcs.pc_curr p,
  acs_financial_currency q
WHERE
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '80' and
  rtrim(substr(cso_data1,1,1)) = '2' and
  rtrim(substr(cso_data1,23,1)) = '2' and -- crancier
  d.acc_number (+) = rtrim(substr(cso_data1,232,30)) and
  e.acs_auxiliary_account_id (+) = d.acs_account_id and
  k.des_description_summary (+) = rtrim(substr(cso_data1,95,50)) and
  k.pc_lang_id (+) = PCS.PC_I_LIB_SESSION.GetCompLangId and
  f.acs_vat_det_account_id (+) = k.acs_vat_det_account_id and
  g.vde_default (+) = DECODE(rtrim(substr(cso_data1,95,50)),null,1,2) and
  h.pco_descr (+) = rtrim(substr(cso_data1,25,50)) and
  i.pco_default_pay (+) = DECODE(rtrim(substr(cso_data1,25,50)),null,1,2) and
  m.acc_number (+) = rtrim(substr(cso_data1,262,30)) and
  l.acs_financial_account_id (+) = m.acs_account_id and
  o.acc_number (+) = rtrim(substr(cso_data1,292,30)) and
  n.acs_financial_account_id (+) = o.acs_account_id and
  p.currency (+) = rtrim(substr(cso_data1,229,3)) and
  q.pc_curr_id (+) = p.pc_curr_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_ASCII_THIRD" ("ACI_CONVERSION_ID", "ACI_CONVERSION_SOURCE_ID", "CSO_JOIN_KEY", "C_ASCII_FAIL_REASON", "CSO_TRANSFERT_DATE", "UPDATE_MODE", "PER_KEY1", "THI_NO_TVA", "THI_NO_INTRA", "THI_NO_SIREN", "THI_NO_SIRET") AS
  SELECT
  b.aci_conversion_id,
  a.aci_conversion_source_id,
  a.cso_join_key,
  a.c_ascii_fail_reason,
  a.cso_transfert_date,
  rtrim(substr(cso_data1,2,1)) UPDATE_MODE,
  rtrim(substr(cso_data1,3,20)) PER_KEY1,
  rtrim(substr(cso_data1,155,30)) THI_NO_TVA,
  rtrim(substr(cso_data1,185,30)) THI_NO_INTRA,
  rtrim(substr(cso_data1,215,9)) THI_NO_SIREN,
  rtrim(substr(cso_data1,224,5)) THI_NO_SIRET
FROM
  aci_conversion_source a,
  aci_conversion b,
  aci_conversion_type c
WHERE
  a.aci_conversion_id = b.aci_conversion_id and
  b.aci_conversion_type_id = c.aci_conversion_type_id and
  c.c_source_type = '80' and
  rtrim(substr(cso_data1,1,1)) = '2'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_CONVERSION_SOURCE" ("ACI_CONVERSION_SOURCE_ID", "ACI_CONVERSION_ID", "CSO_DATA1", "CSO_DATA2", "CSO_KEY", "CNV_SOURCE_FILE1", "CNV_SOURCE_FILE2", "CNV_TARGET_FILE", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD", "C_SOURCE_TYPE", "CTY_DESCR") AS
  select
  cso.aci_conversion_source_id,
  cso.aci_conversion_id,
  substr(cso.cso_data1,1,200) cso_data1,
  cso.cso_data2,
  cso.cso_key,
  cnv.CNV_SOURCE_FILE1,
  cnv.CNV_SOURCE_FILE2,
  cnv.CNV_TARGET_FILE,
  cnv.A_DATECRE,
  cnv.A_idcre,
  cnv.A_DATEmod,
  cnv.A_idmod,
  cty.c_source_type,
  cty.cty_descr
from
  aci_conversion_source cso,
  aci_conversion cnv,
  aci_conversion_type cty
where
  cso.aci_conversion_id = cnv.aci_conversion_id and
  cnv.aci_conversion_type_id = cty.aci_conversion_type_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_CONVERSION_SOURCE_PB" ("ACI_CONVERSION_SOURCE_ID", "ACI_CONVERSION_ID", "CSO_DATA1", "CSO_DATA2", "CSO_KEY", "PAC_CUSTOM_PARTNER_ID", "CNV_SOURCE_FILE1", "CNV_SOURCE_FILE2", "CNV_TARGET_FILE", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD", "C_SOURCE_TYPE", "CTY_DESCR") AS
  select
  cso.aci_conversion_source_id,
  cso.aci_conversion_id,
  substr(cso.cso_data1,1,200) cso_data1,
  cso.cso_data2,
  cso.cso_key,
  substr(cso.cso_data1,152,8) pac_custom_partner_id,
  cnv.CNV_SOURCE_FILE1,
  cnv.CNV_SOURCE_FILE2,
  cnv.CNV_TARGET_FILE,
  cnv.A_DATECRE,
  cnv.A_idcre,
  cnv.A_DATEmod,
  cnv.A_idmod,
  cty.c_source_type,
  cty.cty_descr
from
  aci_conversion_source cso,
  aci_conversion cnv,
  aci_conversion_type cty
where
  cso.aci_conversion_id = cnv.aci_conversion_id and
  cnv.aci_conversion_type_id = cty.aci_conversion_type_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_JOB_ISAG" ("ACI_DOCUMENT_ID", "ACI_CONVERSION_ID", "ACT_DOCUMENT_ID", "PAR_DOCUMENT", "C_INTERFACE_CONTROL", "C_FAIL_REASON", "GCDTEXT1", "LANID", "PAC_CUSTOM_PARTNER_ID", "DOC_NUMBER", "C_TYPE_CATALOGUE", "CURRENCY2", "EXP_AMOUNT_LC", "CURRENCY1", "EXP_AMOUNT_FC", "EXP_ADAPTED", "ACS_FIN_ACC_S_PAYMENT_ID", "ACC_NUMBER", "PME_SBVR", "EXP_REF_BVR", "EXP_BVR_CODE", "DET_PAIED_LC", "DET_PAIED_FC", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
DOC.ACI_DOCUMENT_ID,
NVL (CSO.CNV_ISAG_JOB_NUMBER, DOC.ACI_CONVERSION_ID) ACI_CONVERSION_ID,
DOC.ACT_DOCUMENT_ID,
PAR.PAR_DOCUMENT,
DOC.C_INTERFACE_CONTROL,
DOC.C_FAIL_REASON,
GCD.GCDTEXT1,
DECODE(GCD.LANID,null,LAN.LANID,GCD.LANID) LANID,
PAF.PAC_CUSTOM_PARTNER_ID,
DOT.DOC_NUMBER,
NVL(CAT.C_TYPE_CATALOGUE,' ') C_TYPE_CATALOGUE,
(SELECT CUR.CURRENCY FROM PCS.PC_CURR CUR, ACS_FINANCIAL_CURRENCY AFC WHERE AFC.PC_CURR_ID = CUR.PC_CURR_ID AND AFC.ACS_FINANCIAL_CURRENCY_ID = PAF.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY2,
EXP.EXP_AMOUNT_LC,
(SELECT CUR.CURRENCY FROM PCS.PC_CURR CUR, ACS_FINANCIAL_CURRENCY AFC WHERE AFC.PC_CURR_ID = CUR.PC_CURR_ID AND AFC.ACS_FINANCIAL_CURRENCY_ID = PAF.ACS_FINANCIAL_CURRENCY_ID) CURRENCY1,
EXP.EXP_AMOUNT_FC,
EXP.EXP_ADAPTED,
EXP.ACS_FIN_ACC_S_PAYMENT_ID,
ACC.ACC_NUMBER,
PME.PME_SBVR,
EXP.EXP_REF_BVR,
EXP.EXP_BVR_CODE,
ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
NVL(DOT.A_DATECRE,DOC.A_DATECRE) A_DATECRE,
NVL(DOT.A_IDCRE,DOC.A_IDCRE) A_IDCRE,
NVL(DOT.A_DATEMOD,DOC.A_DATEMOD) A_DATEMOD,
NVL(DOT.A_IDMOD,DOC.A_IDMOD) A_IDMOD
FROM
PCS.PC_LANG LAN,
PCS.V_PC_DESCODES GCD,
ACS_PAYMENT_METHOD PME,
ACS_ACCOUNT ACC,
ACS_FIN_ACC_S_PAYMENT PMM,
ACJ_CATALOGUE_DOCUMENT CAT,
ACT_PART_IMPUTATION PAF,
ACT_EXPIRY EXP,
ACT_DOCUMENT DOT,
ACI_PART_IMPUTATION PAR,
ACI_DOCUMENT DOC,
ACI_CONVERSION CSO
WHERE
    DOC.ACI_DOCUMENT_ID = PAR.ACI_DOCUMENT_ID(+)
AND DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID(+)
AND DOC.ACI_CONVERSION_ID = CSO.ACI_CONVERSION_ID
AND NVL(EXP.EXP_CALC_NET,1)+0 = 1
AND NVL(EXP.EXP_SLICE,1)+0 = 1
AND DOC.ACT_DOCUMENT_ID = PAF.ACT_DOCUMENT_ID(+)
AND DOC.ACT_DOCUMENT_ID = DOT.ACT_DOCUMENT_ID(+)
AND (DOT.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID  OR
    DOC.CAT_KEY = CAT.CAT_KEY)
AND EXP.ACS_FIN_ACC_S_PAYMENT_ID = PMM.ACS_FIN_ACC_S_PAYMENT_ID(+)
AND PMM.ACS_FINANCIAL_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID(+)
AND PMM.ACS_PAYMENT_METHOD_ID = PME.ACS_PAYMENT_METHOD_ID(+)
AND DOC.C_FAIL_REASON = GCD.GCLCODE(+)
AND 'C_FAIL_REASON' = GCD.GCGNAME(+)
AND DECODE(GCD.LANID,null,LAN.LANID,GCD.LANID)=LAN.LANID
AND LAN.LANUSED = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACI_JOB_STATUS_ISAG" ("ACI_CONVERSION_ID", "C_INTERFACE_CONTROL", "COUNT") AS
  SELECT
NVL (CNV.CNV_ISAG_JOB_NUMBER, DOC.ACI_CONVERSION_ID) ACI_CONVERSION_ID,
DOC.C_INTERFACE_CONTROL,
COUNT(*) COUNT
FROM
ACI_DOCUMENT DOC,
ACI_CONVERSION CNV
WHERE DOC.ACI_CONVERSION_ID = CNV.ACI_CONVERSION_ID
GROUP BY
NVL (CNV.CNV_ISAG_JOB_NUMBER, DOC.ACI_CONVERSION_ID),
DOC.C_INTERFACE_CONTROL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACJ_CAT_DOC_ISAG" ("ACJ_JOB_TYPE_S_CATALOGUE_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "ACJ_JOB_TYPE_ID", "CAT_KEY", "CAT_DESCRIPTION", "C_TYPE_CATALOGUE", "TYP_DESCRIPTION", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
ACJ_JOB_TYPE_S_CATALOGUE_ID,
CAT.ACJ_CATALOGUE_DOCUMENT_ID,
JOB.ACJ_JOB_TYPE_ID,
CAT.CAT_KEY,
CAT.CAT_DESCRIPTION,
CAT.C_TYPE_CATALOGUE,
JOB.TYP_DESCRIPTION,
CAT.A_DATECRE,
CAT.A_IDCRE,
CAT.A_DATEMOD,
CAT.A_IDMOD
FROM
ACJ_CATALOGUE_DOCUMENT   CAT,
ACJ_JOB_TYPE_S_CATALOGUE JCA,
ACJ_JOB_TYPE             JOB
WHERE
    JCA.ACJ_JOB_TYPE_ID = JOB.ACJ_JOB_TYPE_ID
AND JCA.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID
AND CAT.C_TYPE_CATALOGUE IN ('2','5','6','9')
AND JOB.C_ACI_FINANCIAL_LINK <> '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACJ_CAT_PMT_ISAG" ("ACJ_JOB_TYPE_S_CATALOGUE_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "ACJ_JOB_TYPE_ID", "CAT_KEY", "CAT_DESCRIPTION", "TYP_DESCRIPTION", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
ACJ_JOB_TYPE_S_CATALOGUE_ID,
CAT.ACJ_CATALOGUE_DOCUMENT_ID,
JOB.ACJ_JOB_TYPE_ID,
CAT.CAT_KEY,
CAT.CAT_DESCRIPTION,
JOB.TYP_DESCRIPTION,
ACC.ACC_NUMBER,
DES.DES_DESCRIPTION_SUMMARY,
LAN.LANID,
CAT.A_DATECRE,
CAT.A_IDCRE,
CAT.A_DATEMOD,
CAT.A_IDMOD
FROM
PCS.PC_LANG LAN,
ACS_ACCOUNT              ACC,
ACS_DESCRIPTION          DES,
ACJ_CATALOGUE_DOCUMENT   CAT,
ACJ_JOB_TYPE_S_CATALOGUE JCA,
ACJ_JOB_TYPE             JOB
WHERE
    JCA.ACJ_JOB_TYPE_ID = JOB.ACJ_JOB_TYPE_ID
AND JCA.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID
AND CAT.C_TYPE_CATALOGUE = '3'
AND JOB.C_ACI_FINANCIAL_LINK <> '1'
AND ACC.ACS_ACCOUNT_ID = CAT.ACS_FINANCIAL_ACCOUNT_ID
AND ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACJ_REP_CATALOGUE_TYPE" ("ACJ_CATALOGUE_TYPE_ID", "MOD_KEY", "MOD_DESCR", "C_TYPE_CATALOGUE", "C_MODEL_TYP", "ACS_FINANCIAL_CURRENCY_ID", "PC_CURR_ID", "C_ROUND_TYPE", "MOD_ROUNDED_AMOUNT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD") AS
  SELECT
  MOD.ACJ_CATALOGUE_TYPE_ID,
  MOD.MOD_KEY,
  MOD.MOD_DESCR,
  MOD.C_TYPE_CATALOGUE,
  MOD.C_MODEL_TYP,
  MOD.ACS_FINANCIAL_CURRENCY_ID,
  CUR.PC_CURR_ID,
  MOD.C_ROUND_TYPE,
  MOD.MOD_ROUNDED_AMOUNT,
  MOD.A_DATECRE,
  MOD.A_DATEMOD,
  MOD.A_IDCRE,
  MOD.A_IDMOD
FROM
  ACS_FINANCIAL_CURRENCY CUR,
  ACJ_CATALOGUE_TYPE MOD
WHERE
  MOD.ACS_FINANCIAL_CURRENCY_ID = CUR.ACS_FINANCIAL_CURRENCY_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACJ_REP_IMPUTATION_TYPE" ("ACJ_CATALOGUE_TYPE_ID", "ACJ_IMPUTATION_TYPE_ID", "PAC_CUSTOM_PARTNER_ID", "CUS_PER_NAME", "PAC_SUPPLIER_PARTNER_ID", "SUP_PER_NAME", "IMT_BVR_REF", "IMT_PRIMARY", "IMT_SEQUENCE", "IMT_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "FIN_ACCOUNT", "ACS_DIVISION_ACCOUNT_ID", "DIV_ACCOUNT", "ACS_TAX_CODE_ID", "TAX_CODE", "ACS_CPN_ACCOUNT_ID", "CPN_ACCOUNT", "ACS_CDA_ACCOUNT_ID", "CDA_ACCOUNT", "ACS_PF_ACCOUNT_ID", "PF_ACCOUNT", "ACS_PJ_ACCOUNT_ID", "PJ_ACCOUNT", "IMT_VALUE_D", "IMT_VALUE_C") AS
  SELECT
  IMT.ACJ_CATALOGUE_TYPE_ID,
  IMT.ACJ_IMPUTATION_TYPE_ID,
  IMT.PAC_CUSTOM_PARTNER_ID,
  PAC_FUNCTIONS.GetNamesAndCity(IMT.PAC_CUSTOM_PARTNER_ID) CUS_PER_NAME,
  IMT.PAC_SUPPLIER_PARTNER_ID,
  PAC_FUNCTIONS.GetNamesAndCity(IMT.PAC_SUPPLIER_PARTNER_ID) SUP_PER_NAME,
  IMT.IMT_BVR_REF,
  IMT.IMT_PRIMARY,
  IMT.IMT_SEQUENCE,
  IMT.IMT_DESCRIPTION,
  IMT.ACS_FINANCIAL_ACCOUNT_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_FINANCIAL_ACCOUNT_ID) FIN_ACCOUNT,
  IMT.ACS_DIVISION_ACCOUNT_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_DIVISION_ACCOUNT_ID) DIV_ACCOUNT,
  IMT.ACS_TAX_CODE_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_TAX_CODE_ID) TAX_CODE,
  IMT.ACS_CPN_ACCOUNT_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_CPN_ACCOUNT_ID) CPN_ACCOUNT,
  IMT.ACS_CDA_ACCOUNT_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_CDA_ACCOUNT_ID) CDA_ACCOUNT,
  IMT.ACS_PF_ACCOUNT_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_PF_ACCOUNT_ID) PF_ACCOUNT,
  IMT.ACS_PJ_ACCOUNT_ID,
  ACS_FUNCTION.GetAccountNumber(IMT.ACS_PJ_ACCOUNT_ID) PJ_ACCOUNT,
  IMT.IMT_VALUE_D,
  IMT.IMT_VALUE_C
FROM
  ACJ_IMPUTATION_TYPE IMT




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_ACC_BALANCE_DATE" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "C_TYPE_CUMUL", "C_ETAT_JOURNAL", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR") AS
  select
       V.ACS_FINANCIAL_ACCOUNT_ID,
       V.ACS_DIVISION_ACCOUNT_ID,
       PER.ACS_PERIOD_ID,
       PER.C_TYPE_PERIOD,
       V.C_TYPE_CUMUL,
       V.C_ETAT_JOURNAL,
       ACS_FINANCIAL_CURRENCY_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       sum(nvl(IMF_AMOUNT_LC_D,0))  TOT_DEBIT_LC,
       sum(nvl(IMF_AMOUNT_LC_C,0))  TOT_CREDIT_LC,
       sum(nvl(IMF_AMOUNT_FC_D,0))  TOT_DEBIT_FC,
       sum(nvl(IMF_AMOUNT_FC_C,0))  TOT_CREDIT_FC,
       sum(nvl(IMF_AMOUNT_EUR_D,0)) TOT_DEBIT_EUR,
       sum(nvl(IMF_AMOUNT_EUR_C,0)) TOT_CREDIT_EUR
  from
       ACS_PERIOD PER,
       V_ACT_ACC_IMP_REPORT V
  where
        V.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
    and V.IMF_TRANSACTION_DATE between ACR_FUNCTIONS.GetCumulDateFrom and ACR_FUNCTIONS.GetCumulDate
  group by
           V.ACS_FINANCIAL_ACCOUNT_ID,
           V.ACS_DIVISION_ACCOUNT_ID,
           PER.ACS_PERIOD_ID,
           PER.C_TYPE_PERIOD,
           V.C_TYPE_CUMUL,
           V.C_ETAT_JOURNAL,
           ACS_FINANCIAL_CURRENCY_ID,
           ACS_ACS_FINANCIAL_CURRENCY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_ACC_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "FINANCIAL_IMPUTATION_ID", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD", "PER_NO_PERIOD") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID
       , IMP.ACS_PERIOD_ID
       , IMP.ACT_DOCUMENT_ID
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_TYPE
       , IMP.IMF_PRIMARY
       , IMP.IMF_DESCRIPTION
       , IMP.IMF_AMOUNT_LC_D
       , IMP.IMF_AMOUNT_LC_C
       , IMP.IMF_EXCHANGE_RATE
       , IMP.IMF_AMOUNT_FC_D
       , IMP.IMF_AMOUNT_FC_C
       , IMP.IMF_AMOUNT_EUR_D
       , IMP.IMF_AMOUNT_EUR_C
       , IMP.IMF_VALUE_DATE
       , IMP.ACS_TAX_CODE_ID
       , IMP.IMF_TRANSACTION_DATE
       , IMP.ACS_FINANCIAL_CURRENCY_ID
       , IMP.C_GENRE_TRANSACTION
       , IMP.A_CONFIRM
       , IMP.A_DATECRE
       , IMP.A_DATEMOD
       , IMP.A_IDCRE
       , IMP.A_IDMOD
       , IMP.A_RECLEVEL
       , IMP.A_RECSTATUS
       , (select nvl(IMF_ACS_AUX_ACCOUNT_CUST_ID, IMF_ACS_AUX_ACCOUNT_SUPP_ID)
            from ACT_FINANCIAL_IMPUTATION
           where ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID
       , IMP.ACT_DET_PAYMENT_ID
       , IMP.ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMP.IMF_GENRE
       , IMP.IMF_BASE_PRICE
       , IMP.ACT_PART_IMPUTATION_ID
       , (select COV.COV_NUMBER
            from ACT_COVER_INFORMATION COV
           where COV.ACT_COVER_INFORMATION_ID = (select DOC.ACT_COVER_INFORMATION_ID
                                                   from ACT_DOCUMENT DOC
                                                  where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ) COV_NUMBER
       , (select PAR.PAR_DOCUMENT
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT
       , (select PAR.DOC_DATE_DELIVERY
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY
       , FIN.ACC_NUMBER
       , (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID
            from ACT_FINANCIAL_DISTRIBUTION DIS
           where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , (select DOC.DOC_NUMBER
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) DOC_NUMBER
       , (select DOC.DOC_COMMENT
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) DOC_COMMENT
       , (select DOC.ACJ_CATALOGUE_DOCUMENT_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACJ_CATALOGUE_DOCUMENT_ID
       , (select DOC.ACT_JOURNAL_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACT_JOURNAL_ID
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = (select DOC.ACT_JOURNAL_ID
                                         from ACT_DOCUMENT DOC
                                        where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ) JOU_NUMBER
       , (select JOU.JOU_DESCRIPTION
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = (select DOC.ACT_JOURNAL_ID
                                         from ACT_DOCUMENT DOC
                                        where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ) JOU_DESCRIPTION
       , ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
       , IMP.IMF_COMPARE_DATE
       , IMP.IMF_COMPARE_TEXT
       , IMP.IMF_COMPARE_USE_INI
       , IMP.IMF_TEXT1
       , IMP.IMF_TEXT2
       , IMP.IMF_TEXT3
       , IMP.IMF_TEXT4
       , IMP.IMF_TEXT5
       , IMP.IMF_NUMBER
       , IMP.IMF_NUMBER2
       , IMP.IMF_NUMBER3
       , IMP.IMF_NUMBER4
       , IMP.IMF_NUMBER5
       , IMP.DIC_IMP_FREE1_ID
       , IMP.DIC_IMP_FREE2_ID
       , IMP.DIC_IMP_FREE3_ID
       , IMP.DIC_IMP_FREE4_ID
       , IMP.DIC_IMP_FREE5_ID
       , IMP.GCO_GOOD_ID
       , IMP.HRM_PERSON_ID
       , IMP.DOC_RECORD_ID
       , IMP.FAM_FIXED_ASSETS_ID
       , IMP.C_FAM_TRANSACTION_TYP
       , IMP.PAC_PERSON_ID
       , (select DOC.ACT_ACT_JOURNAL_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACT_ACT_JOURNAL_ID
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = (select DOC.ACT_JOURNAL_ID
                                         from ACT_DOCUMENT DOC
                                        where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)
             and ETA.C_SUB_SET = 'ACC') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = (select DOC.ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)
             and SCA.C_SUB_SET = 'ACC') C_TYPE_CUMUL
       , PER.C_TYPE_PERIOD
       , PER.PER_NO_PERIOD
    from ACS_PERIOD PER
       , ACT_FINANCIAL_IMPUTATION IMP
       , ACS_ACCOUNT FIN
       , (select LID_FREE_NUMBER_1 ACS_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
       , (select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
            from COM_LIST_ID_TEMP
           where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') YEA
   where FIN.ACS_ACCOUNT_ID = TMP.ACS_ACCOUNT_ID
     and FIN.ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID
     and IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and PER.ACS_FINANCIAL_YEAR_ID = YEA.ACS_FINANCIAL_YEAR_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_ACC_IMPUTATION_DET_RPT" ("INFO", "IMF_TRANSACTION_DATE", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_TAX_CODE_ID", "FYE_NO_EXERCICE", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  SELECT
  'REEL' INFO,
  IMP.IMF_TRANSACTION_DATE IMF_TRANSACTION_DATE,
  IMP.IMF_AMOUNT_LC_D IMF_AMOUNT_LC_D,
  IMP.IMF_AMOUNT_LC_C IMF_AMOUNT_LC_C,
  IMP.IMF_AMOUNT_FC_D IMF_AMOUNT_FC_D,
  IMP.IMF_AMOUNT_FC_C IMF_AMOUNT_FC_C,
  IMP.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(IMP.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  IMP.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(IMP.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  IMP.ACS_FINANCIAL_ACCOUNT_ID ACS_FINANCIAL_ACCOUNT_ID,
  IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
  IMP.ACS_TAX_CODE_ID ACS_TAX_CODE_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE,
  (SELECT ETA.C_ETAT_JOURNAL
   FROM ACT_ETAT_JOURNAL ETA
   WHERE ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID AND
         ETA.C_SUB_SET      = 'ACC') C_ETAT_JOURNAL,
  (SELECT SCA.C_TYPE_CUMUL
   FROM ACJ_SUB_SET_CAT SCA
   WHERE SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID AND
         SCA.C_SUB_SET                 = 'ACC') C_TYPE_CUMUL
FROM
  ACT_JOURNAL                 JOU,
  ACT_DOCUMENT                DOC,
  ACS_PERIOD                  PER,
  ACS_FINANCIAL_YEAR          FYE,
  ACT_FINANCIAL_IMPUTATION    IMP
WHERE
  IMP.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  IMP.ACT_DOCUMENT_ID       = DOC.ACT_DOCUMENT_ID AND
  DOC.ACT_JOURNAL_ID        = JOU.ACT_JOURNAL_ID
UNION ALL
SELECT
  'REPORT' INFO,
  FYE.FYE_START_DATE IMF_TRANSACTION_DATE,
  TOT.TOT_DEBIT_LC IMF_AMOUNT_LC_D,
  TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C,
  TOT.TOT_DEBIT_FC IMF_AMOUNT_FC_D,
  TOT.TOT_CREDIT_FC IMF_AMOUNT_FC_C,
  TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  TOT.ACS_FINANCIAL_ACCOUNT_ID ACS_FINANCIAL_ACCOUNT_ID,
  TOT.ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
  0 ACS_TAX_CODE_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE,
  'PROV' C_ETAT_JOURNAL,
  TOT.C_TYPE_CUMUL C_TYPE_CUMUL
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_TOTAL_BY_PERIOD   TOT
WHERE
  TOT.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  ACS_FUNCTION.GetStatePreviousFinancialYear(FYE.ACS_FINANCIAL_YEAR_ID) = 'ACT' AND
  TOT.ACS_AUXILIARY_ACCOUNT_ID is null AND
  ((TOT.ACS_DIVISION_ACCOUNT_ID is not null) or (TOT.ACS_DIVISION_ACCOUNT_ID is null and ACR_FUNCTIONS.ExistDivision = 0)) AND
  PER.C_TYPE_PERIOD         = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_ACC_IMP_REPORT" ("C_TYPE_PERIOD", "PER_NO_PERIOD", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID") AS
  select C_TYPE_PERIOD
       , PER_NO_PERIOD
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , ACT_DOCUMENT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , IMF_TYPE
       , IMF_PRIMARY
       , IMF_DESCRIPTION
       , IMF_AMOUNT_LC_D
       , IMF_AMOUNT_LC_C
       , IMF_EXCHANGE_RATE
       , IMF_AMOUNT_FC_D
       , IMF_AMOUNT_FC_C
       , IMF_AMOUNT_EUR_D
       , IMF_AMOUNT_EUR_C
       , IMF_VALUE_DATE
       , ACS_TAX_CODE_ID
       , IMF_TRANSACTION_DATE
       , ACS_FINANCIAL_CURRENCY_ID
       , C_GENRE_TRANSACTION
       , ACS_AUXILIARY_ACCOUNT_ID
       , ACT_DET_PAYMENT_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMF_BASE_PRICE
       , ACT_PART_IMPUTATION_ID
       , COV_NUMBER
       , PAR_DOCUMENT
       , DOC_DATE_DELIVERY
       , ACC_NUMBER
       , ACT_FINANCIAL_DISTRIBUTION_ID
       , ACS_DIVISION_ACCOUNT_ID
       , DIV_NUMBER
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , JOU_DESCRIPTION
       , FINANCIAL_IMPUTATION_ID
       , ACT_ACT_JOURNAL_ID
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
       , IMF_COMPARE_DATE
       , IMF_COMPARE_TEXT
       , IMF_COMPARE_USE_INI
       , IMF_TEXT1
       , IMF_TEXT2
       , IMF_TEXT3
       , IMF_TEXT4
       , IMF_TEXT5
       , IMF_NUMBER
       , IMF_NUMBER2
       , IMF_NUMBER3
       , IMF_NUMBER4
       , IMF_NUMBER5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , GCO_GOOD_ID
       , HRM_PERSON_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
    from V_ACR_ACC_IMPUTATION
   where (C_TYPE_PERIOD <> '1')
      or (    C_TYPE_PERIOD = '1'
          and nvl( (select A.C_STATE_FINANCIAL_YEAR
                      from ACS_FINANCIAL_YEAR A
                         , ACS_FINANCIAL_YEAR B
                     where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                       and B.FYE_START_DATE = A.FYE_END_DATE + 1
                       and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                        from COM_LIST_ID_TEMP
                                                       where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
                , 'CLO'
                 ) = 'CLO'
         )
  union all
  select TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , TOT.ACS_PERIOD_ID
       , 0 ACT_DOCUMENT_ID
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , 'MAN' IMF_TYPE
       , 0 IMF_PRIMARY
       , 'Report' IMF_DESCRIPTION
       , TOT.TOT_DEBIT_LC IMF_AMOUNT_LC_D
       , TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C
       , 0 IMF_EXCHANGE_RATE
       , TOT.TOT_DEBIT_FC IMF_AMOUNT_FC_D
       , TOT.TOT_CREDIT_FC IMF_AMOUNT_FC_C
       , TOT.TOT_DEBIT_EUR IMF_AMOUNT_EUR_D
       , TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C
       , TOT.PER_START_DATE IMF_VALUE_DATE
       , 0 ACS_TAX_CODE_ID
       , TOT.PER_START_DATE IMF_TRANSACTION_DATE
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID
       , '1' C_GENRE_TRANSACTION
       , 0 ACS_AUXILIARY_ACCOUNT_ID
       , 0 ACT_DET_PAYMENT_ID
       , TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMF_BASE_PRICE
       , 0 ACT_PART_IMPUTATION_ID
       , '' COV_NUMBER
       , '' PAR_DOCUMENT
       , to_date(null) DOC_DATE_DELIVERY
       , TOT.ACC_NUMBER
       , 0 ACT_FINANCIAL_DISTRIBUTION_ID
       , TOT.ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = TOT.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , '' JOU_DESCRIPTION
       , 0 FINANCIAL_IMPUTATION_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
       , TOT.PER_START_DATE IMF_COMPARE_DATE
       , '' IMF_COMPARE_TEXT
       , '' IMF_COMPARE_USE_INI
       , '' IMF_TEXT1
       , '' IMF_TEXT2
       , '' IMF_TEXT3
       , '' IMF_TEXT4
       , '' IMF_TEXT5
       , 0 IMF_NUMBER
       , 0 IMF_NUMBER2
       , 0 IMF_NUMBER3
       , 0 IMF_NUMBER4
       , 0 IMF_NUMBER5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_MIP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 GCO_GOOD_ID
       , 0 HRM_PERSON_ID
       , 0 DOC_RECORD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 PAC_PERSON_ID
    from V_ACR_ACC_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_ACC_PREV_YEAR_TOTAL" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE", "PER_NO_PERIOD", "C_TYPE_PERIOD") AS
  select   TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_DEBIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_CREDIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_DEBIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_CREDIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_DEBIT_EUR
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_CREDIT_EUR
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.PER_NO_PERIOD
         , PER.C_TYPE_PERIOD
      from ACS_ACCOUNT ACC
         , ACT_TOTAL_BY_PERIOD TOT
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where ACC.ACS_ACCOUNT_ID = TMP.LID_FREE_NUMBER_1
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
--       and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.C_TYPE_PERIOD = '1'
       and TOT.ACS_FINANCIAL_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
       and TOT.ACS_AUXILIARY_ACCOUNT_ID + 0 is null
       and (    (TOT.ACS_DIVISION_ACCOUNT_ID is not null)
            or (    TOT.ACS_DIVISION_ACCOUNT_ID is null
                and ACR_FUNCTIONS.ExistDivision = 0)
           )
  group by TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.PER_NO_PERIOD
         , PER.C_TYPE_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_AUX_ACCOUNT_STAT" ("GCDTEXT1", "DES_DESCR_SUM_SUB_SET", "DES_DESCR_SUM_AUX", "ACC_NUMBER", "FYE_NO_EXERCICE", "AVERAGEPAYMENT", "MEANCREDITINDAY", "ACS_ACCOUNT_ID", "ACS_SUB_SET_ID", "ACS_FINANCIAL_YEAR_ID", "PC_LANG_ID", "LANID") AS
  select
   DEC.GCDTEXT1,
   DES.DES_DESCRIPTION_SUMMARY DES_DESCR_SUM_SUB_SET,
   DAC.DES_DESCRIPTION_SUMMARY DES_DESCR_SUM_AUX,
   ACC.ACC_NUMBER,
   FYE.FYE_NO_EXERCICE,
   nvl(ACR_FUNCTIONS.AveragePaymentByExercice(ACC.ACS_ACCOUNT_ID,FYE.ACS_FINANCIAL_YEAR_ID),0) AVERAGEPAYMENT,
   nvl(ACR_FUNCTIONS.MeanCreditInDay(ACC.ACS_ACCOUNT_ID,FYE.ACS_FINANCIAL_YEAR_ID),0) MEANCREDITINDAY,
   ACC.ACS_ACCOUNT_ID,
   SUB.ACS_SUB_SET_ID,
   FYE.ACS_FINANCIAL_YEAR_ID,
   LAN.PC_LANG_ID,
   LAN.LANID
from
   ACS_DESCRIPTION DES,
   ACS_DESCRIPTION DAC,
   ACS_ACCOUNT ACC,
   ACS_FINANCIAL_YEAR FYE,
   ACS_SUB_SET SUB,
   PCS.V_PC_DESCODES DEC,
   PCS.PC_LANG LAN
where
   ACC.ACS_SUB_SET_ID = SUB.ACS_SUB_SET_ID AND
   SUB.ACS_SUB_SET_ID = DES.ACS_SUB_SET_ID AND
   DES.PC_LANG_ID = LAN.PC_LANG_ID AND
   SUB.C_TYPE_SUB_SET = 'AUX' AND
   ACC.ACS_ACCOUNT_ID = DAC.ACS_ACCOUNT_ID AND
   DAC.PC_LANG_ID =  LAN.PC_LANG_ID AND
   SUB.C_SUB_SET = DEC.GCLCODE AND
   DEC.GCGNAME='C_SUB_SET' AND
   DEC.PC_LANG_ID = DAC.PC_LANG_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_BALANCE" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ID", "TYP", "ACS_FINANCIAL_YEAR_ID", "ACB_BUDGET_VERSION_ID") AS
  select
       ACC.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACT_TOTAL_BY_PERIOD_ID ID,
       'TOT' TYP,
       PER.ACS_FINANCIAL_YEAR_ID,
       0 ACB_BUDGET_VERSION_ID
from
     ACS_FINANCIAL_ACCOUNT ACC,
     ACT_TOTAL_BY_PERIOD   TOT,
     ACS_PERIOD            PER
where
      ACC.ACS_FINANCIAL_ACCOUNT_ID = TOT.ACS_FINANCIAL_ACCOUNT_ID
  and TOT.ACS_PERIOD_ID            = PER.ACS_PERIOD_ID
  and TOT.ACS_AUXILIARY_ACCOUNT_ID is null
union all
select
       ACC.ACS_FINANCIAL_ACCOUNT_ID,
       GLO.ACS_DIVISION_ACCOUNT_ID,
       AMO.ACB_PERIOD_AMOUNT_ID ID,
       'BUD' TYP,
       PER.ACS_FINANCIAL_YEAR_ID,
       GLO.ACB_BUDGET_VERSION_ID
from
     ACS_FINANCIAL_ACCOUNT  ACC,
     ACB_PERIOD_AMOUNT      AMO,
     ACB_GLOBAL_BUDGET      GLO,
     ACS_PERIOD             PER,
     ACS_FINANCIAL_CURRENCY CUR
where
      ACC.ACS_FINANCIAL_ACCOUNT_ID  = GLO.ACS_FINANCIAL_ACCOUNT_ID
  and GLO.ACB_GLOBAL_BUDGET_ID      = AMO.ACB_GLOBAL_BUDGET_ID
  and GLO.ACS_FINANCIAL_CURRENCY_ID = CUR.ACS_FINANCIAL_CURRENCY_ID
  and CUR.FIN_LOCAL_CURRENCY        = 1
  and AMO.ACS_PERIOD_ID = PER.ACS_PERIOD_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_BALANCE_CDA" ("ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ID", "TYP", "ACS_FINANCIAL_YEAR_ID", "ACB_BUDGET_VERSION_ID") AS
  SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   CDA.ACS_CDA_ACCOUNT_ID,
   TOT.ACT_MGM_TOT_BY_PERIOD_ID ID,
   'TOT' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   0 ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACS_CDA_ACCOUNT CDA,
   ACT_MGM_TOT_BY_PERIOD TOT,
   ACS_PERIOD PER
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = TOT.ACS_CPN_ACCOUNT_ID AND
   CDA.ACS_CDA_ACCOUNT_ID = TOT.ACS_CDA_ACCOUNT_ID AND
   TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
UNION ALL
SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   CDA.ACS_CDA_ACCOUNT_ID,
   AMO.ACB_PERIOD_AMOUNT_ID ID,
   'BUD' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   GLO.ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACS_CDA_ACCOUNT CDA,
   ACB_PERIOD_AMOUNT AMO,
   ACB_GLOBAL_BUDGET GLO,
   ACS_PERIOD PER,
   ACS_FINANCIAL_CURRENCY CUR
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = GLO.ACS_CPN_ACCOUNT_ID AND
   CDA.ACS_CDA_ACCOUNT_ID = GLO.ACS_CDA_ACCOUNT_ID AND
   GLO.ACB_GLOBAL_BUDGET_ID = AMO.ACB_GLOBAL_BUDGET_ID AND
   GLO.ACS_FINANCIAL_CURRENCY_ID = CUR.ACS_FINANCIAL_CURRENCY_ID AND
   CUR.FIN_LOCAL_CURRENCY = 1 AND
   AMO.ACS_PERIOD_ID = PER.ACS_PERIOD_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_BALANCE_CPN" ("ACS_CPN_ACCOUNT_ID", "ID", "TYP", "ACS_FINANCIAL_YEAR_ID", "ACB_BUDGET_VERSION_ID") AS
  SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   TOT.ACT_MGM_TOT_BY_PERIOD_ID ID,
   'TOT' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   0 ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACT_MGM_TOT_BY_PERIOD TOT,
   ACS_PERIOD PER
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = TOT.ACS_CPN_ACCOUNT_ID AND
   TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
UNION ALL
SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   AMO.ACB_PERIOD_AMOUNT_ID ID,
   'BUD' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   GLO.ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACB_PERIOD_AMOUNT AMO,
   ACB_GLOBAL_BUDGET GLO,
   ACS_PERIOD PER,
   ACS_FINANCIAL_CURRENCY CUR
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = GLO.ACS_CPN_ACCOUNT_ID AND
   GLO.ACB_GLOBAL_BUDGET_ID = AMO.ACB_GLOBAL_BUDGET_ID AND
   GLO.ACS_FINANCIAL_CURRENCY_ID = CUR.ACS_FINANCIAL_CURRENCY_ID AND
   CUR.FIN_LOCAL_CURRENCY = 1 AND
   AMO.ACS_PERIOD_ID = PER.ACS_PERIOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_BALANCE_PF" ("ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ID", "TYP", "ACS_FINANCIAL_YEAR_ID", "ACB_BUDGET_VERSION_ID") AS
  SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   POF.ACS_PF_ACCOUNT_ID,
   TOT.ACT_MGM_TOT_BY_PERIOD_ID ID,
   'TOT' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   0 ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACS_PF_ACCOUNT POF,
   ACT_MGM_TOT_BY_PERIOD TOT,
   ACS_PERIOD PER
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = TOT.ACS_CPN_ACCOUNT_ID AND
   POF.ACS_PF_ACCOUNT_ID = TOT.ACS_PF_ACCOUNT_ID AND
   TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
UNION ALL
SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   POF.ACS_PF_ACCOUNT_ID,
   AMO.ACB_PERIOD_AMOUNT_ID ID,
   'BUD' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   GLO.ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACS_PF_ACCOUNT POF,
   ACB_PERIOD_AMOUNT AMO,
   ACB_GLOBAL_BUDGET GLO,
   ACS_PERIOD PER,
   ACS_FINANCIAL_CURRENCY CUR
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = GLO.ACS_CPN_ACCOUNT_ID AND
   POF.ACS_PF_ACCOUNT_ID = GLO.ACS_PF_ACCOUNT_ID AND
   GLO.ACB_GLOBAL_BUDGET_ID = AMO.ACB_GLOBAL_BUDGET_ID AND
   GLO.ACS_FINANCIAL_CURRENCY_ID = CUR.ACS_FINANCIAL_CURRENCY_ID AND
   CUR.FIN_LOCAL_CURRENCY = 1 AND
   AMO.ACS_PERIOD_ID = PER.ACS_PERIOD_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_BALANCE_PJ" ("ACS_CPN_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ID", "TYP", "ACS_FINANCIAL_YEAR_ID", "ACB_BUDGET_VERSION_ID") AS
  SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   PRJ.ACS_PJ_ACCOUNT_ID,
   TOT.ACT_MGM_TOT_BY_PERIOD_ID ID,
   'TOT' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   0 ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACS_PJ_ACCOUNT PRJ,
   ACT_MGM_TOT_BY_PERIOD TOT,
   ACS_PERIOD PER
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = TOT.ACS_CPN_ACCOUNT_ID AND
   PRJ.ACS_PJ_ACCOUNT_ID = TOT.ACS_PJ_ACCOUNT_ID AND
   TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
UNION ALL
SELECT
   CPN.ACS_CPN_ACCOUNT_ID,
   PRJ.ACS_PJ_ACCOUNT_ID,
   AMO.ACB_PERIOD_AMOUNT_ID ID,
   'BUD' TYP,
   PER.ACS_FINANCIAL_YEAR_ID,
   GLO.ACB_BUDGET_VERSION_ID
FROM
   ACS_CPN_ACCOUNT CPN,
   ACS_PJ_ACCOUNT PRJ,
   ACB_PERIOD_AMOUNT AMO,
   ACB_GLOBAL_BUDGET GLO,
   ACS_PERIOD PER,
   ACS_FINANCIAL_CURRENCY CUR
WHERE
   CPN.ACS_CPN_ACCOUNT_ID = GLO.ACS_CPN_ACCOUNT_ID AND
   PRJ.ACS_PJ_ACCOUNT_ID = GLO.ACS_PJ_ACCOUNT_ID AND
   GLO.ACB_GLOBAL_BUDGET_ID = AMO.ACB_GLOBAL_BUDGET_ID AND
   GLO.ACS_FINANCIAL_CURRENCY_ID = CUR.ACS_FINANCIAL_CURRENCY_ID AND
   CUR.FIN_LOCAL_CURRENCY = 1 AND
   AMO.ACS_PERIOD_ID = PER.ACS_PERIOD_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CASH_FLOW_DOC" ("DOC_SOURCE", "PDE_FINAL_DELAY", "DMT_DATE_VALUE", "FINAL_DELAY_VALUE", "PAC_PAYMENT_CONDITION_ID", "SIGN", "DMT_RATE_FACTOR", "POS_FINAL_QUANTITY", "PDE_FINAL_QUANTITY", "POS_BALANCE_QUANTITY", "PDE_BALANCE_QUANTITY", "POS_NET_VALUE_EXCL_B", "POS_VAT_AMOUNT", "DOCCURRENCYID", "DOCCURRENCYNAME", "COMPCURRENCYID", "COMPCURRENCYNAME", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER_FIN", "ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER_DIV", "ACS_TAX_CODE_ID", "ACC_NUMBER_TAX", "QUANTITY", "POS_NET_UNIT_VALUE_LC", "POS_NET_UNIT_VALUE_INCL_LC", "POS_NET_UNIT_VALUE_FC", "POS_NET_UNIT_VALUE_INCL_FC", "PAC_THIRD_ID", "PER_KEY1", "PER_KEY2", "DOC_DOCUMENT_ID", "DMT_NUMBER", "C_SUB_SET", "DOC_GAUGE_ID", "GAU_DESCRIBE", "COM_NAME_ACI", "COM_NAME_DOC", "DOC_RECORD_ID", "RCO_TITLE", "POI_RATIO", "SUM_RATIO", "POI_AMOUNT") AS
  select DOC_SOURCE
     , PDE_FINAL_DELAY
     , DMT_DATE_VALUE
     , FINAL_DELAY_VALUE
     , PAC_PAYMENT_CONDITION_ID
     , sign
     , DMT_RATE_FACTOR
     , POS_FINAL_QUANTITY
     , PDE_FINAL_QUANTITY
     , POS_BALANCE_QUANTITY
     , PDE_BALANCE_QUANTITY
     , POS_NET_VALUE_EXCL_B
     , POS_VAT_AMOUNT
     , DocCurrencyId
     , (select CURRENCY
          from PCS.PC_CURR CUR
             , ACS_FINANCIAL_CURRENCY FIN
         where FIN.ACS_FINANCIAL_CURRENCY_ID = DocCurrencyId
           and CUR.PC_CURR_ID = FIN.PC_CURR_ID) DocCurrencyName
     , CompCurrencyId
     , CompCurrencyName
     , ACS_FINANCIAL_ACCOUNT_ID
     , (select ACC.ACC_NUMBER
          from ACS_ACCOUNT ACC
         where ACC.ACS_ACCOUNT_ID = DOCS.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER_FIN
     , ACS_DIVISION_ACCOUNT_ID
     , (select ACC.ACC_NUMBER
          from ACS_ACCOUNT ACC
         where ACC.ACS_ACCOUNT_ID = DOCS.ACS_DIVISION_ACCOUNT_ID) ACC_NUMBER_DIV
     , ACS_TAX_CODE_ID
     , (select ACC.ACC_NUMBER
          from ACS_ACCOUNT ACC
         where ACC.ACS_ACCOUNT_ID = DOCS.ACS_TAX_CODE_ID) ACC_NUMBER_TAX
     , QUANTITY
     , POS_NET_UNIT_VALUE_LC
     , POS_NET_UNIT_VALUE_INCL_LC
     , POS_NET_UNIT_VALUE_FC
     , POS_NET_UNIT_VALUE_INCL_FC
     , PAC_THIRD_ID
     , (select PER_KEY1
          from PAC_PERSON
         where PAC_PERSON_ID = DOCS.PAC_THIRD_ID) PER_KEY1
     , (select PER_KEY2
          from PAC_PERSON
         where PAC_PERSON_ID = DOCS.PAC_THIRD_ID) PER_KEY2
     , DOC_DOCUMENT_ID
     , DMT_NUMBER
     , C_SUB_SET
     , DOC_GAUGE_ID
     , GAU_DESCRIBE
     , COM_NAME_ACI
     , COM_NAME_DOC
     , DOC_RECORD_ID
     , (select REC.RCO_TITLE
          from DOC_RECORD REC
         where REC.DOC_RECORD_ID = DOCS.DOC_RECORD_ID) RCO_TITLE
     , POI_RATIO
     , SUM_RATIO
     , POI_AMOUNT
  from (select 'D' DOC_SOURCE
             , trunc(PDE.PDE_FINAL_DELAY) PDE_FINAL_DELAY
             , trunc(DMT.DMT_DATE_VALUE) DMT_DATE_VALUE
             , nvl(trunc(PDE.PDE_FINAL_DELAY), trunc(DMT.DMT_DATE_VALUE) ) FINAL_DELAY_VALUE
             , nvl(DMT.PAC_PAYMENT_CONDITION_ID, 0) PAC_PAYMENT_CONDITION_ID
             , decode(GAU.C_ADMIN_DOMAIN, 1, -1, 1) sign
             , decode(nvl(DMT_RATE_FACTOR, 0), 0, 1, DMT_RATE_FACTOR) DMT_RATE_FACTOR
             , decode(POS.POS_FINAL_QUANTITY, 0, 1, POS.POS_FINAL_QUANTITY) POS_FINAL_QUANTITY
             , nvl(PDE.PDE_FINAL_QUANTITY, 0) PDE_FINAL_QUANTITY
             , decode(POS.POS_BALANCE_QUANTITY, 0, 1, POS.POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY
             , nvl(PDE.PDE_BALANCE_QUANTITY, 0) PDE_BALANCE_QUANTITY
             , POS.POS_NET_VALUE_EXCL_B
             , POS.POS_VAT_AMOUNT
             , DMT.ACS_FINANCIAL_CURRENCY_ID DocCurrencyId
             , CUR.CompCurrencyId
             , CUR.CompCurrencyName
             , nvl(POI.ACS_FINANCIAL_ACCOUNT_ID, POS.ACS_FINANCIAL_ACCOUNT_ID) ACS_FINANCIAL_ACCOUNT_ID
             , nvl(POI.ACS_DIVISION_ACCOUNT_ID, POS.ACS_DIVISION_ACCOUNT_ID) ACS_DIVISION_ACCOUNT_ID
             , nvl(POS.ACS_TAX_CODE_ID, 0) ACS_TAX_CODE_ID
             , nvl(PDE.PDE_BALANCE_QUANTITY, POS.POS_BALANCE_QUANTITY) QUANTITY
             , decode(CUR.CompCurrencyId
                    , ACS_FINANCIAL_CURRENCY_ID, POS.POS_NET_UNIT_VALUE
                    , (nvl(pos.POS_NET_VALUE_EXCL_B, 0) / decode(POS.POS_FINAL_QUANTITY, 0, 1, POS.POS_FINAL_QUANTITY) )
                     ) POS_NET_UNIT_VALUE_LC
             , decode(CUR.CompCurrencyId
                    , ACS_FINANCIAL_CURRENCY_ID, POS.POS_NET_UNIT_VALUE_INCL
                    , (nvl(pos.POS_NET_VALUE_INCL_B, 0) / decode(POS.POS_FINAL_QUANTITY, 0, 1, POS.POS_FINAL_QUANTITY) )
                     ) POS_NET_UNIT_VALUE_INCL_LC
             , decode(CUR.CompCurrencyId, ACS_FINANCIAL_CURRENCY_ID, 0, POS.POS_NET_UNIT_VALUE) POS_NET_UNIT_VALUE_FC
             , decode(CUR.CompCurrencyId, ACS_FINANCIAL_CURRENCY_ID, 0, POS.POS_NET_UNIT_VALUE_INCL) POS_NET_UNIT_VALUE_INCL_FC
             , DMT.PAC_THIRD_ID
             , DMT.DOC_DOCUMENT_ID
             , DMT.DMT_NUMBER
             , case
                 when GAS.C_GAUGE_TITLE in('1', '4', '5') then 'PAY'
                 when GAS.C_GAUGE_TITLE in('6', '8', '9', '15', '30') then 'REC'
                 else ''
               end C_SUB_SET
             , GAU.DOC_GAUGE_ID
             , GAU.GAU_DESCRIBE
             , nvl(DMT.COM_NAME_ACI, COMP.COM_NAME) COM_NAME_ACI
             , COMP.COM_NAME COM_NAME_DOC
             , nvl(POI.DOC_RECORD_ID, nvl(POS.DOC_RECORD_ID, DMT.DOC_RECORD_ID) ) DOC_RECORD_ID
             , nvl(POI.POI_RATIO, 1) POI_RATIO
             , nvl(RATIO.SUM_RATIO, 1) SUM_RATIO
             , POI.POI_AMOUNT
          from (select ACS_FUNCTION.GetLocalCurrencyId CompCurrencyId
                     , ACS_FUNCTION.GetLocalCurrencyName CompCurrencyName
                  from dual) CUR
             , (select   DOC_POSITION_ID
                       , sum(POI_RATIO) SUM_RATIO
                    from DOC_POSITION_IMPUTATION DPI
                group by DOC_POSITION_ID) RATIO
             , (select PCS.PC_I_LIB_SESSION.GetComName COM_NAME
                  from dual) COMP
             , DOC_POSITION_IMPUTATION POI
             , DOC_POSITION_DETAIL PDE
             , DOC_GAUGE_POSITION GAP
             , DOC_POSITION POS
             , DOC_GAUGE GAU
             , DOC_GAUGE_STRUCTURED GAS
             , DOC_DOCUMENT DMT
         where DMT.C_DOCUMENT_STATUS in('02', '03')
           and not exists(select 1
                            from ACT_DOCUMENT DOC
                           where DOC.DOC_DOCUMENT_ID = DMT.DOC_DOCUMENT_ID)
           and not exists(select 1
                            from pac_payment_condition
                           where pac_payment_condition_id = dmt.pac_payment_condition_id
                             and C_PAYMENT_CONDITION_KIND = '02')
           and GAP.DOC_GAUGE_ID = GAS.DOC_GAUGE_ID
           and GAS.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
           and POS.DOC_GAUGE_POSITION_ID = GAP.DOC_GAUGE_POSITION_ID
           and POS.DOC_DOCUMENT_ID = DMT.DOC_DOCUMENT_ID
           and POS.DOC_POSITION_ID = PDE.DOC_POSITION_ID(+)
           and GAP.C_GAUGE_TYPE_POS not in('71', '81', '90', '101')
           and POS.C_DOC_POS_STATUS in('02', '03')
           and POS.DOC_POSITION_ID = POI.DOC_POSITION_ID(+)
           and RATIO.DOC_POSITION_ID(+) = POI.DOC_POSITION_ID
           and (    (DMT.DOC_INVOICE_EXPIRY_ID is not null)
                or (     (DMT.DOC_INVOICE_EXPIRY_ID is null)
                    and (DOC_INVOICE_EXPIRY_FUNCTIONS.IsDetailFromBillBook(PDE.DOC_DOC_POSITION_DETAIL_ID) = 0) )
               )
        union all
        select 'S' DOC_SOURCE
             , null PDE_FINAL_DELAY
             , trunc(INX.INX_ISSUING_DATE) DMT_DATE_VALUE
             , trunc(INX.INX_ISSUING_DATE) FINAL_DELAY_VALUE
             , nvl(INX.PAC_PAYMENT_CONDITION_ID, 0) PAC_PAYMENT_CONDITION_ID
             , decode(GAU.C_ADMIN_DOMAIN, 1, -1, 1) sign
             , decode(nvl(POS.POS_RATE_FACTOR, 0), 0, 1, POS.POS_RATE_FACTOR) DMT_RATE_FACTOR
             , decode(POS.POS_FINAL_QUANTITY, 0, 1, POS.POS_FINAL_QUANTITY) POS_FINAL_QUANTITY
             , nvl(POS.POS_FINAL_QUANTITY, 0) PDE_FINAL_QUANTITY
             , decode(POS.POS_BALANCE_QUANTITY, 0, 1, POS.POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY
             , decode(POS.POS_BALANCE_QUANTITY, 0, 1, POS.POS_BALANCE_QUANTITY) PDE_BALANCE_QUANTITY
             , POS.POS_NET_VALUE_EXCL_B
             , POS.POS_VAT_AMOUNT
             , IND.ACS_FINANCIAL_CURRENCY_ID DocCurrencyId
             , CUR.CompCurrencyId
             , CUR.CompCurrencyName
             , nvl(POI.ACS_FINANCIAL_ACCOUNT_ID, POS.ACS_FINANCIAL_ACCOUNT_ID) ACS_FINANCIAL_ACCOUNT_ID
             , nvl(POI.ACS_DIVISION_ACCOUNT_ID, POS.ACS_DIVISION_ACCOUNT_ID) ACS_DIVISION_ACCOUNT_ID
             , nvl(POS.ACS_TAX_CODE_ID, 0) ACS_TAX_CODE_ID
             , decode(POS.POS_BALANCE_QUANTITY, 0, POS.POS_FINAL_QUANTITY, POS.POS_BALANCE_QUANTITY) QUANTITY
             , decode(CUR.CompCurrencyId
                    , IND.ACS_FINANCIAL_CURRENCY_ID, POS.POS_NET_UNIT_VALUE
                    , (nvl(pos.POS_NET_VALUE_EXCL_B, 0) / decode(POS.POS_FINAL_QUANTITY, 0, 1, POS.POS_FINAL_QUANTITY) )
                     ) POS_NET_UNIT_VALUE_LC
             , decode(CUR.CompCurrencyId
                    , IND.ACS_FINANCIAL_CURRENCY_ID, POS.POS_NET_UNIT_VALUE_INCL
                    , (nvl(pos.POS_NET_VALUE_INCL_B, 0) / decode(POS.POS_FINAL_QUANTITY, 0, 1, POS.POS_FINAL_QUANTITY) )
                     ) POS_NET_UNIT_VALUE_INCL_LC
             , decode(CUR.CompCurrencyId, IND.ACS_FINANCIAL_CURRENCY_ID, 0, POS.POS_NET_UNIT_VALUE) POS_NET_UNIT_VALUE_FC
             , decode(CUR.CompCurrencyId, IND.ACS_FINANCIAL_CURRENCY_ID, 0, POS.POS_NET_UNIT_VALUE_INCL) POS_NET_UNIT_VALUE_INCL_FC
             , IND.PAC_THIRD_ID
             , IND.DOC_DOCUMENT_ID
             , IND.DMT_NUMBER
             , case
                 when GAS.C_GAUGE_TITLE in('1', '4', '5') then 'PAY'
                 when GAS.C_GAUGE_TITLE in('6', '8', '9', '15', '30') then 'REC'
                 else ''
               end C_SUB_SET
             , GAU.DOC_GAUGE_ID
             , GAU.GAU_DESCRIBE
             , nvl(IND.COM_NAME_ACI, COMP.COM_NAME) COM_NAME_ACI
             , COMP.COM_NAME COM_NAME_DOC
             , nvl(POI.DOC_RECORD_ID, POS.DOC_RECORD_ID) DOC_RECORD_ID
             , nvl(POI.POI_RATIO, 1) POI_RATIO
             , nvl(RATIO.SUM_RATIO, 1) SUM_RATIO
             , POI.POI_AMOUNT
          from (select ACS_FUNCTION.GetLocalCurrencyId CompCurrencyId
                     , ACS_FUNCTION.GetLocalCurrencyName CompCurrencyName
                  from dual) CUR
             , (select   DOC_POSITION_ID
                       , sum(POI_RATIO) SUM_RATIO
                    from DOC_EST_POS_IMP_CASH_FLOW DPI
                group by DOC_POSITION_ID) RATIO
             , (select PCS.PC_I_LIB_SESSION.GetComName COM_NAME
                  from dual) COMP
             , DOC_EST_POS_IMP_CASH_FLOW POI
             , DOC_INVOICE_EXPIRY INX
             , DOC_DOCUMENT IND
             , DOC_GAUGE_POSITION GAP
             , DOC_ESTIMATED_POS_CASH_FLOW POS
             , DOC_GAUGE GAU
             , DOC_GAUGE_STRUCTURED GAS
         where GAP.DOC_GAUGE_ID = GAS.DOC_GAUGE_ID
           and GAS.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
           and POS.DOC_GAUGE_POSITION_ID = GAP.DOC_GAUGE_POSITION_ID
           and GAP.C_GAUGE_TYPE_POS not in('71', '81', '90', '101')
           and POS.DOC_POSITION_ID = POI.DOC_POSITION_ID(+)
           and POS.DOC_INVOICE_EXPIRY_ID = INX.DOC_INVOICE_EXPIRY_ID
           and INX.DOC_DOCUMENT_ID = IND.DOC_DOCUMENT_ID
           and RATIO.DOC_POSITION_ID(+) = POI.DOC_POSITION_ID) DOCS


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CASH_FLOW_FOOT" ("ACR_CASH_FLOW_ANALYSIS_ID", "CFT_WEEK", "C_CASH_FLOW_IMP_TYP", "CFT_LIQUIDITY_AMOUNT", "CFT_VARIATION_TOTAL", "CFT_CREDIT_USE_AMOUNT", "CFT_LIQ_VARIATION_AMOUNT", "CFT_CREDIT_LIMIT", "CFT_CREDIT_DEFICITSURPLUS") AS
  select ACR_CASH_FLOW_ANALYSIS_ID
       , CFT.CFT_WEEK
       , CFT.C_CASH_FLOW_IMP_TYP
       , CFT.CFT_LIQUIDITY_AMOUNT
       , CFT.CFT_VARIATION_TOTAL
       , CFT.CFT_CREDIT_USE_AMOUNT
       , CFT.CFT_LIQ_VARIATION_AMOUNT
       , CFT.CFT_CREDIT_LIMIT
       , CFT.CFT_CREDIT_DEFICITSURPLUS
    from ACR_CASH_FLOW_FOOT CFT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CASH_FLOW_HRM" ("HRM_PERIOD_ID", "V_HBC_ACC_NAME", "ACS_ACCOUNT_ID", "V_HBC_DIV_NAME", "ACS_DIVISION_ACCOUNT_ID", "AMOUNT_LC_D", "AMOUNT_LC_C") AS
  select   PER.HRM_PERIOD_ID
         , SAB.V_HBC_ACC_NAME
         , SAB.V_HBC_ACC_NUM ACS_ACCOUNT_ID
         , SAB.V_HBC_DIV_NAME
         , SAB.V_HBC_DIV_NUM ACS_DIVISION_ACCOUNT_ID
         , sum(decode(SAB.V_HBC_AMOUNT_TYPE, 'D', SAB.V_HBC_AMOUNT, 0) ) AMOUNT_LC_D
         , sum(decode(SAB.V_HBC_AMOUNT_TYPE, 'C', SAB.V_HBC_AMOUNT, 0) ) AMOUNT_LC_C
      from V_HRM_BREAK_CGDIV SAB
         , HRM_PERIOD PER
     where SAB.SAB_PAY_DATE between PER.PER_BEGIN and PER.PER_END
       and not exists(select 1
                        from ACS_FINANCIAL_ACCOUNT FIN
                       where FIN.ACS_FINANCIAL_ACCOUNT_ID = SAB.ACS_ACCOUNT_ID
                         and FIN.FIN_LIQUIDITY = 1)
  group by PER.HRM_PERIOD_ID
         , SAB.V_HBC_ACC_NAME
         , SAB.V_HBC_ACC_NUM
         , SAB.V_HBC_DIV_NAME
         , SAB.V_HBC_DIV_NUM


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CDA_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select MGM.ACT_MGM_IMPUTATION_ID
       , MGM.ACT_FINANCIAL_IMPUTATION_ID
       , MGM.ACS_PERIOD_ID
       , (select PER.C_TYPE_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) C_TYPE_PERIOD
       , (select PER.PER_NO_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) PER_NO_PERIOD
       , MGM.IMM_VALUE_DATE
       , MGM.IMM_TRANSACTION_DATE
       , MGM.IMM_TYPE
       , MGM.IMM_GENRE
       , MGM.IMM_PRIMARY
       , MGM.IMM_DESCRIPTION
       , MGM.ACS_CPN_ACCOUNT_ID
       , MGM.ACS_CDA_ACCOUNT_ID
       , MGM.ACS_PF_ACCOUNT_ID
       , DIS.ACS_PJ_ACCOUNT_ID
       , MGM.ACS_QTY_UNIT_ID
       , nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D
       , nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C
       , nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D
       , nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C
       , nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D
       , nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C
       , MGM.ACS_FINANCIAL_CURRENCY_ID
       , MGM.ACS_ACS_FINANCIAL_CURRENCY_ID
       , MGM.IMM_EXCHANGE_RATE
       , MGM.IMM_BASE_PRICE
       , MGM.ACT_DOCUMENT_ID
       , MGM.IMM_NUMBER
       , MGM.IMM_NUMBER2
       , MGM.IMM_NUMBER3
       , MGM.IMM_NUMBER4
       , MGM.IMM_NUMBER5
       , MGM.IMM_TEXT1
       , MGM.IMM_TEXT2
       , MGM.IMM_TEXT3
       , MGM.IMM_TEXT4
       , MGM.IMM_TEXT5
       , MGM.DIC_IMP_FREE1_ID
       , MGM.DIC_IMP_FREE2_ID
       , MGM.DIC_IMP_FREE3_ID
       , MGM.DIC_IMP_FREE4_ID
       , MGM.DIC_IMP_FREE5_ID
       , MGM.HRM_PERSON_ID
       , MGM.GCO_GOOD_ID
       , MGM.DOC_RECORD_ID
       , MGM.FAM_FIXED_ASSETS_ID
       , MGM.C_FAM_TRANSACTION_TYP
       , MGM.PAC_PERSON_ID
       , (select IMP.ACS_FINANCIAL_ACCOUNT_ID
            from ACT_FINANCIAL_IMPUTATION IMP
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = MGM.ACT_FINANCIAL_IMPUTATION_ID) ACS_FINANCIAL_ACCOUNT_ID
       , (select ACC_NUMBER
            from ACS_ACCOUNT
           where ACS_ACCOUNT_ID = TMP.ACS_ACCOUNT_ID) ACC_NUMBER
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , JOU.ACT_JOURNAL_ID
       , JOU.JOU_NUMBER
       , JOU.JOU_DESCRIPTION
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'CPN') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'CPN') C_TYPE_CUMUL
    from ACT_JOURNAL JOU
       , ACT_DOCUMENT DOC
       , ACT_MGM_IMPUTATION MGM
       , ACT_MGM_DISTRIBUTION DIS
       , (select LID_FREE_NUMBER_1 ACS_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
   where TMP.ACS_ACCOUNT_ID = MGM.ACS_CDA_ACCOUNT_ID
     and MGM.ACT_MGM_IMPUTATION_ID = DIS.ACT_MGM_IMPUTATION_ID(+)
     and MGM.ACS_PERIOD_ID in(select ACS_PERIOD_ID
                                from ACS_PERIOD PER
                               where PER.ACS_FINANCIAL_YEAR_ID in(select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
                                                                    from COM_LIST_ID_TEMP
                                                                   where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
     and MGM.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACT_ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CDA_IMPUTATION_DET" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "CDA_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACC_DETAIL_PRINTING", "FIN_NUMBER", "CPN_NUMBER", "PF_NUMBER", "PJ_NUMBER") AS
  SELECT
  V.ACT_MGM_IMPUTATION_ID,
  V.ACT_FINANCIAL_IMPUTATION_ID,
  V.ACS_PERIOD_ID,
  V.IMM_VALUE_DATE,
  V.IMM_TRANSACTION_DATE,
  V.IMM_TYPE,
  V.IMM_GENRE,
  V.IMM_PRIMARY,
  V.IMM_DESCRIPTION,
  NVL (V.ACS_CDA_ACCOUNT_ID,CDA.ACS_CDA_ACCOUNT_ID) ACS_CDA_ACCOUNT_ID,
  V.ACS_CPN_ACCOUNT_ID,
  V.ACS_PF_ACCOUNT_ID,
  V.ACS_PJ_ACCOUNT_ID,
  V.ACS_QTY_UNIT_ID,
  V.IMM_QUANTITY_D,
  V.IMM_QUANTITY_C,
  V.IMM_AMOUNT_LC_D,
  V.IMM_AMOUNT_LC_C,
  V.IMM_AMOUNT_FC_D,
  V.IMM_AMOUNT_FC_C,
  V.IMM_AMOUNT_EUR_D,
  V.IMM_AMOUNT_EUR_C,
  V.ACS_FINANCIAL_CURRENCY_ID,
  V.ACS_ACS_FINANCIAL_CURRENCY_ID,
  V.IMM_EXCHANGE_RATE,
  V.IMM_BASE_PRICE,
  V.ACS_FINANCIAL_ACCOUNT_ID,
  NVL (V.ACC_NUMBER, ACS_FUNCTION.GETACCOUNTNUMBER(CDA.ACS_CDA_ACCOUNT_ID)) CDA_NUMBER,
  V.IMM_NUMBER,
  V.IMM_NUMBER2,
  V.IMM_NUMBER3,
  V.IMM_NUMBER4,
  V.IMM_NUMBER5,
  V.IMM_TEXT1,
  V.IMM_TEXT2,
  V.IMM_TEXT3,
  V.IMM_TEXT4,
  V.IMM_TEXT5,
  V.DIC_IMP_FREE1_ID,
  V.DIC_IMP_FREE2_ID,
  V.DIC_IMP_FREE3_ID,
  V.DIC_IMP_FREE4_ID,
  V.DIC_IMP_FREE5_ID,
  V.HRM_PERSON_ID,
  V.GCO_GOOD_ID,
  V.DOC_RECORD_ID,
  V.FAM_FIXED_ASSETS_ID,
  V.C_FAM_TRANSACTION_TYP,
  V.PAC_PERSON_ID,
  V.ACT_DOCUMENT_ID,
  V.DOC_NUMBER,
  V.ACJ_CATALOGUE_DOCUMENT_ID,
  V.ACT_ACT_JOURNAL_ID,
  V.ACT_JOURNAL_ID,
  V.JOU_NUMBER,
  V.JOU_DESCRIPTION,
  V.C_ETAT_JOURNAL,
  V.C_TYPE_CUMUL,
  (SELECT
   ACC.ACC_DETAIL_PRINTING FROM
   ACS_ACCOUNT ACC
   WHERE
   ACC.ACS_ACCOUNT_ID = CDA.ACS_CDA_ACCOUNT_ID) ACC_DETAIL_PRINTING,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_FINANCIAL_ACCOUNT_ID) FIN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_CPN_ACCOUNT_ID) CPN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_PF_ACCOUNT_ID) PF_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_PJ_ACCOUNT_ID) PJ_NUMBER
 FROM
 ACS_CDA_ACCOUNT CDA,
 V_ACT_CDA_IMP_REPORT V
 WHERE
 CDA.ACS_CDA_ACCOUNT_ID = V.ACS_CDA_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CDA_IMPUTATION_DET_RPT" ("IMM_TRANSACTION_DATE", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "FYE_NO_EXERCICE") AS
  SELECT
  MGM.IMM_TRANSACTION_DATE IMM_TRANSACTION_DATE,
  MGM.IMM_AMOUNT_LC_D IMM_AMOUNT_LC_D,
  MGM.IMM_AMOUNT_LC_C IMM_AMOUNT_LC_C,
  MGM.IMM_AMOUNT_FC_D IMM_AMOUNT_FC_D,
  MGM.IMM_AMOUNT_FC_C IMM_AMOUNT_FC_C,
  MGM.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  MGM.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  MGM.ACS_CDA_ACCOUNT_ID ACS_CDA_ACCOUNT_ID,
  MGM.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_IMPUTATION    MGM
WHERE
  MGM.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID
UNION ALL
SELECT
  FYE.FYE_START_DATE IMM_TRANSACTION_DATE,
  TOT.MTO_DEBIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_CREDIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_DEBIT_FC IMM_AMOUNT_FC_D,
  TOT.MTO_CREDIT_FC IMM_AMOUNT_FC_C,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  TOT.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  TOT.ACS_CDA_ACCOUNT_ID ACS_CDA_ACCOUNT_ID,
  TOT.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_TOT_BY_PERIOD TOT
WHERE
  TOT.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  ACS_FUNCTION.GetStatePreviousFinancialYear(FYE.ACS_FINANCIAL_YEAR_ID) = 'ACT' AND
  PER.C_TYPE_PERIOD         = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CDA_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select ACT_MGM_IMPUTATION_ID
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , C_TYPE_PERIOD
       , PER_NO_PERIOD
       , IMM_VALUE_DATE
       , IMM_TRANSACTION_DATE
       , IMM_TYPE
       , IMM_GENRE
       , IMM_PRIMARY
       , IMM_DESCRIPTION
       , ACS_CDA_ACCOUNT_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_QTY_UNIT_ID
       , IMM_QUANTITY_D
       , IMM_QUANTITY_C
       , IMM_AMOUNT_LC_D
       , IMM_AMOUNT_LC_C
       , IMM_AMOUNT_FC_D
       , IMM_AMOUNT_FC_C
       , ACS_FINANCIAL_CURRENCY_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMM_EXCHANGE_RATE
       , IMM_BASE_PRICE
       , ACS_FINANCIAL_ACCOUNT_ID
       , ACC_NUMBER
       , IMM_NUMBER
       , IMM_NUMBER2
       , IMM_NUMBER3
       , IMM_NUMBER4
       , IMM_NUMBER5
       , IMM_TEXT1
       , IMM_TEXT2
       , IMM_TEXT3
       , IMM_TEXT4
       , IMM_TEXT5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , HRM_PERSON_ID
       , GCO_GOOD_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
       , ACT_DOCUMENT_ID
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_ACT_JOURNAL_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , JOU_DESCRIPTION
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
    from V_ACR_CDA_IMPUTATIONS


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CPN_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select MGM.ACT_MGM_IMPUTATION_ID
       , MGM.ACT_FINANCIAL_IMPUTATION_ID
       , MGM.ACS_PERIOD_ID
       , (select PER.C_TYPE_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) C_TYPE_PERIOD
       , (select PER.PER_NO_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) PER_NO_PERIOD
       , MGM.IMM_VALUE_DATE
       , MGM.IMM_TRANSACTION_DATE
       , MGM.IMM_TYPE
       , MGM.IMM_GENRE
       , MGM.IMM_PRIMARY
       , MGM.IMM_DESCRIPTION
       , MGM.ACS_CPN_ACCOUNT_ID
       , MGM.ACS_CDA_ACCOUNT_ID
       , MGM.ACS_PF_ACCOUNT_ID
       , DIS.ACS_PJ_ACCOUNT_ID
       , MGM.ACS_QTY_UNIT_ID
       , nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D
       , nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C
       , nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D
       , nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C
       , nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D
       , nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C
       , MGM.ACS_FINANCIAL_CURRENCY_ID
       , MGM.ACS_ACS_FINANCIAL_CURRENCY_ID
       , MGM.IMM_EXCHANGE_RATE
       , MGM.IMM_BASE_PRICE
       , MGM.ACT_DOCUMENT_ID
       , MGM.IMM_NUMBER
       , MGM.IMM_NUMBER2
       , MGM.IMM_NUMBER3
       , MGM.IMM_NUMBER4
       , MGM.IMM_NUMBER5
       , MGM.IMM_TEXT1
       , MGM.IMM_TEXT2
       , MGM.IMM_TEXT3
       , MGM.IMM_TEXT4
       , MGM.IMM_TEXT5
       , MGM.DIC_IMP_FREE1_ID
       , MGM.DIC_IMP_FREE2_ID
       , MGM.DIC_IMP_FREE3_ID
       , MGM.DIC_IMP_FREE4_ID
       , MGM.DIC_IMP_FREE5_ID
       , MGM.HRM_PERSON_ID
       , MGM.GCO_GOOD_ID
       , MGM.DOC_RECORD_ID
       , MGM.FAM_FIXED_ASSETS_ID
       , MGM.C_FAM_TRANSACTION_TYP
       , MGM.PAC_PERSON_ID
       , (select IMP.ACS_FINANCIAL_ACCOUNT_ID
            from ACT_FINANCIAL_IMPUTATION IMP
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = MGM.ACT_FINANCIAL_IMPUTATION_ID) ACS_FINANCIAL_ACCOUNT_ID
       , (select ACC_NUMBER
            from ACS_ACCOUNT
           where ACS_ACCOUNT_ID = TMP.ACS_ACCOUNT_ID) ACC_NUMBER
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , JOU.ACT_JOURNAL_ID
       , JOU.JOU_NUMBER
       , JOU.JOU_DESCRIPTION
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'CPN') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'CPN') C_TYPE_CUMUL
    from ACT_JOURNAL JOU
       , ACT_DOCUMENT DOC
       , ACT_MGM_IMPUTATION MGM
       , ACT_MGM_DISTRIBUTION DIS
       , (select LID_FREE_NUMBER_1 ACS_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
   where TMP.ACS_ACCOUNT_ID = MGM.ACS_CPN_ACCOUNT_ID
     and MGM.ACT_MGM_IMPUTATION_ID = DIS.ACT_MGM_IMPUTATION_ID(+)
     and MGM.ACS_PERIOD_ID in(select ACS_PERIOD_ID
                                from ACS_PERIOD PER
                               where PER.ACS_FINANCIAL_YEAR_ID in(select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
                                                                    from COM_LIST_ID_TEMP
                                                                   where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
     and MGM.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACT_ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CPN_IMPUTATION_DET" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "CPN_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACC_DETAIL_PRINTING", "FIN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER") AS
  SELECT
  V.ACT_MGM_IMPUTATION_ID,
  V.ACT_FINANCIAL_IMPUTATION_ID,
  V.ACS_PERIOD_ID,
  V.IMM_VALUE_DATE,
  V.IMM_TRANSACTION_DATE,
  V.IMM_TYPE,
  V.IMM_GENRE,
  V.IMM_PRIMARY,
  V.IMM_DESCRIPTION,
  NVL (V.ACS_CPN_ACCOUNT_ID,CPN.ACS_CPN_ACCOUNT_ID) ACS_CPN_ACCOUNT_ID,
  V.ACS_CDA_ACCOUNT_ID,
  V.ACS_PF_ACCOUNT_ID,
  V.ACS_PJ_ACCOUNT_ID,
  V.ACS_QTY_UNIT_ID,
  V.IMM_QUANTITY_D,
  V.IMM_QUANTITY_C,
  V.IMM_AMOUNT_LC_D,
  V.IMM_AMOUNT_LC_C,
  V.IMM_AMOUNT_FC_D,
  V.IMM_AMOUNT_FC_C,
  V.IMM_AMOUNT_EUR_D,
  V.IMM_AMOUNT_EUR_C,
  V.ACS_FINANCIAL_CURRENCY_ID,
  V.ACS_ACS_FINANCIAL_CURRENCY_ID,
  V.IMM_EXCHANGE_RATE,
  V.IMM_BASE_PRICE,
  V.ACS_FINANCIAL_ACCOUNT_ID,
  NVL (V.ACC_NUMBER, ACS_FUNCTION.GETACCOUNTNUMBER(CPN.ACS_CPN_ACCOUNT_ID)) CPN_NUMBER,
  V.IMM_NUMBER,
  V.IMM_NUMBER2,
  V.IMM_NUMBER3,
  V.IMM_NUMBER4,
  V.IMM_NUMBER5,
  V.IMM_TEXT1,
  V.IMM_TEXT2,
  V.IMM_TEXT3,
  V.IMM_TEXT4,
  V.IMM_TEXT5,
  V.DIC_IMP_FREE1_ID,
  V.DIC_IMP_FREE2_ID,
  V.DIC_IMP_FREE3_ID,
  V.DIC_IMP_FREE4_ID,
  V.DIC_IMP_FREE5_ID,
  V.HRM_PERSON_ID,
  V.GCO_GOOD_ID,
  V.DOC_RECORD_ID,
  V.FAM_FIXED_ASSETS_ID,
  V.C_FAM_TRANSACTION_TYP,
  V.PAC_PERSON_ID,
  V.ACT_DOCUMENT_ID,
  V.DOC_NUMBER,
  V.ACJ_CATALOGUE_DOCUMENT_ID,
  V.ACT_ACT_JOURNAL_ID,
  V.ACT_JOURNAL_ID,
  V.JOU_NUMBER,
  V.JOU_DESCRIPTION,
  V.C_ETAT_JOURNAL,
  V.C_TYPE_CUMUL,
  (SELECT
   ACC.ACC_DETAIL_PRINTING FROM
   ACS_ACCOUNT ACC
   WHERE
   ACC.ACS_ACCOUNT_ID = CPN.ACS_CPN_ACCOUNT_ID) ACC_DETAIL_PRINTING,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_FINANCIAL_ACCOUNT_ID) FIN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_CDA_ACCOUNT_ID) CDA_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_PF_ACCOUNT_ID) PF_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_PJ_ACCOUNT_ID) PJ_NUMBER
 FROM
 ACS_CPN_ACCOUNT CPN,
 V_ACT_CPN_IMP_REPORT V
 WHERE
 CPN.ACS_CPN_ACCOUNT_ID = V.ACS_CPN_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CPN_IMPUTATION_DET_RPT" ("IMM_TRANSACTION_DATE", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "ACS_CPN_ACCOUNT_ID", "FYE_NO_EXERCICE") AS
  SELECT
  MGM.IMM_TRANSACTION_DATE IMM_TRANSACTION_DATE,
  MGM.IMM_AMOUNT_LC_D IMM_AMOUNT_LC_D,
  MGM.IMM_AMOUNT_LC_C IMM_AMOUNT_LC_C,
  MGM.IMM_AMOUNT_FC_D IMM_AMOUNT_FC_D,
  MGM.IMM_AMOUNT_FC_C IMM_AMOUNT_FC_C,
  MGM.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  MGM.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  MGM.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_IMPUTATION    MGM
WHERE
  MGM.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID
UNION ALL
SELECT
  FYE.FYE_START_DATE IMM_TRANSACTION_DATE,
  TOT.MTO_DEBIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_CREDIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_DEBIT_FC IMM_AMOUNT_FC_D,
  TOT.MTO_CREDIT_FC IMM_AMOUNT_FC_C,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  TOT.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  TOT.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_TOT_BY_PERIOD TOT
WHERE
  TOT.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  ACS_FUNCTION.GetStatePreviousFinancialYear(FYE.ACS_FINANCIAL_YEAR_ID) = 'ACT' AND
  PER.C_TYPE_PERIOD         = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CPN_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select ACT_MGM_IMPUTATION_ID
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , C_TYPE_PERIOD
       , PER_NO_PERIOD
       , IMM_VALUE_DATE
       , IMM_TRANSACTION_DATE
       , IMM_TYPE
       , IMM_GENRE
       , IMM_PRIMARY
       , IMM_DESCRIPTION
       , ACS_CPN_ACCOUNT_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_QTY_UNIT_ID
       , IMM_QUANTITY_D
       , IMM_QUANTITY_C
       , IMM_AMOUNT_LC_D
       , IMM_AMOUNT_LC_C
       , IMM_AMOUNT_FC_D
       , IMM_AMOUNT_FC_C
       , ACS_FINANCIAL_CURRENCY_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMM_EXCHANGE_RATE
       , IMM_BASE_PRICE
       , ACS_FINANCIAL_ACCOUNT_ID
       , ACC_NUMBER
       , IMM_NUMBER
       , IMM_NUMBER2
       , IMM_NUMBER3
       , IMM_NUMBER4
       , IMM_NUMBER5
       , IMM_TEXT1
       , IMM_TEXT2
       , IMM_TEXT3
       , IMM_TEXT4
       , IMM_TEXT5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , HRM_PERSON_ID
       , GCO_GOOD_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
       , ACT_DOCUMENT_ID
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_ACT_JOURNAL_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , JOU_DESCRIPTION
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
    from V_ACR_CPN_IMPUTATIONS
   where (C_TYPE_PERIOD <> '1')
      or (    C_TYPE_PERIOD = '1'
          and nvl( (select A.C_STATE_FINANCIAL_YEAR
                      from ACS_FINANCIAL_YEAR A
                         , ACS_FINANCIAL_YEAR B
                     where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                       and B.FYE_START_DATE = A.FYE_END_DATE + 1
                       and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                        from COM_LIST_ID_TEMP
                                                       where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
                , 'CLO'
                 ) = 'CLO'
         )
  union all
  select 0 ACT_MGM_IMPUTATION_ID
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , TOT.ACS_PERIOD_ID
       , TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , TOT.IMM_VALUE_DATE
       , TOT.IMM_TRANSACTION_DATE
       , 'MAN' IMM_TYPE
       , 'MAN' IMM_GENRE
       , 0 IMM_PRIMARY
       , 'Report' IMM_DESCRIPTION
       , TOT.ACS_CPN_ACCOUNT_ID
       , TOT.ACS_CDA_ACCOUNT_ID
       , TOT.ACS_PF_ACCOUNT_ID
       , TOT.ACS_PJ_ACCOUNT_ID
       , TOT.ACS_QTY_UNIT_ID
       , TOT.IMM_QUANTITY_D
       , TOT.IMM_QUANTITY_C
       , TOT.IMM_AMOUNT_LC_D
       , TOT.IMM_AMOUNT_LC_C
       , TOT.IMM_AMOUNT_FC_D
       , TOT.IMM_AMOUNT_FC_C
       , TOT.ACS_FINANCIAL_CURRENCY_ID
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMM_EXCHANGE_RATE
       , 0 IMM_BASE_PRICE
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , '' ACC_NUMBER
       , 0 IMM_NUMBER
       , 0 IMM_NUMBER2
       , 0 IMM_NUMBER3
       , 0 IMM_NUMBER4
       , 0 IMM_NUMBER5
       , '' IMM_TEXT1
       , '' IMM_TEXT2
       , '' IMM_TEXT3
       , '' IMM_TEXT4
       , '' IMM_TEXT5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_IMP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 HRM_PERSON_ID
       , 0 GCO_GOOD_ID
       , TOT.DOC_RECORD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 PAC_PERSON_ID
       , 0 ACT_DOCUMENT_ID
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , '' JOU_DESCRIPTION
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
    from V_ACR_CPN_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_CPN_PREV_YEAR_TOTAL" ("C_TYPE_PERIOD", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "PER_NO_PERIOD", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "DOC_RECORD_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select   PER.C_TYPE_PERIOD
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE IMM_VALUE_DATE
         , PER.PER_START_DATE IMM_TRANSACTION_DATE
         , PER.PER_NO_PERIOD
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_CPN_ACCOUNT_ID
         , TOT.ACS_PJ_ACCOUNT_ID
         , TOT.ACS_CDA_ACCOUNT_ID
         , TOT.ACS_PF_ACCOUNT_ID
         , TOT.DOC_RECORD_ID
         , TOT.ACS_QTY_UNIT_ID
         , decode(sign(nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0)
                 ) IMM_QUANTITY_D
         , decode(sign(nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0)
                 ) IMM_QUANTITY_C
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0)
                 ) IMM_AMOUNT_LC_D
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0)
                 ) IMM_AMOUNT_LC_C
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0)
                 ) IMM_AMOUNT_FC_D
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0)
                 ) IMM_AMOUNT_FC_C
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
      from ACT_MGM_TOT_BY_PERIOD TOT
         , ACS_ACCOUNT ACC
         , ACS_CPN_ACCOUNT CPN
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where ACC.ACS_ACCOUNT_ID = TMP.LID_FREE_NUMBER_1
       and ACC.ACS_ACCOUNT_ID = CPN.ACS_CPN_ACCOUNT_ID
       and CPN.ACS_CPN_ACCOUNT_ID = TOT.ACS_CPN_ACCOUNT_ID
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
--    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.C_TYPE_PERIOD = '1'
  group by TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_CPN_ACCOUNT_ID
         , TOT.ACS_CDA_ACCOUNT_ID
         , TOT.ACS_PF_ACCOUNT_ID
         , TOT.ACS_PJ_ACCOUNT_ID
         , TOT.DOC_RECORD_ID
         , TOT.ACS_QTY_UNIT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.C_TYPE_PERIOD
         , PER.PER_NO_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_DIV_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "FINANCIAL_IMPUTATION_ID", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD", "PER_NO_PERIOD") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID
       , IMP.ACS_PERIOD_ID
       , IMP.ACT_DOCUMENT_ID
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_TYPE
       , IMP.IMF_PRIMARY
       , IMP.IMF_DESCRIPTION
       , IMP.IMF_AMOUNT_LC_D
       , IMP.IMF_AMOUNT_LC_C
       , IMP.IMF_EXCHANGE_RATE
       , IMP.IMF_AMOUNT_FC_D
       , IMP.IMF_AMOUNT_FC_C
       , IMP.IMF_AMOUNT_EUR_D
       , IMP.IMF_AMOUNT_EUR_C
       , IMP.IMF_VALUE_DATE
       , IMP.ACS_TAX_CODE_ID
       , IMP.IMF_TRANSACTION_DATE
       , IMP.ACS_FINANCIAL_CURRENCY_ID
       , IMP.C_GENRE_TRANSACTION
       , IMP.A_CONFIRM
       , IMP.A_DATECRE
       , IMP.A_DATEMOD
       , IMP.A_IDCRE
       , IMP.A_IDMOD
       , IMP.A_RECLEVEL
       , IMP.A_RECSTATUS
       , (select nvl(IMF_ACS_AUX_ACCOUNT_CUST_ID, IMF_ACS_AUX_ACCOUNT_SUPP_ID)
            from ACT_FINANCIAL_IMPUTATION
           where ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID
       , IMP.ACT_DET_PAYMENT_ID
       , IMP.ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMP.IMF_GENRE
       , IMP.IMF_BASE_PRICE
       , IMP.ACT_PART_IMPUTATION_ID
       , (select COV.COV_NUMBER
            from ACT_COVER_INFORMATION COV
           where COV.ACT_COVER_INFORMATION_ID = (select DOC.ACT_COVER_INFORMATION_ID
                                                   from ACT_DOCUMENT DOC
                                                  where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ) COV_NUMBER
       , (select PAR.PAR_DOCUMENT
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT
       , (select PAR.DOC_DATE_DELIVERY
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY
       , (select ACC_NUMBER
            from ACS_ACCOUNT ACC
           where ACC.ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
       , (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID
            from ACT_FINANCIAL_DISTRIBUTION DIS
           where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , DIV.ACC_NUMBER DIV_NUMBER
       , (select DOC.DOC_NUMBER
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) DOC_NUMBER
       , (select DOC.DOC_COMMENT
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) DOC_COMMENT
       , (select DOC.ACJ_CATALOGUE_DOCUMENT_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACJ_CATALOGUE_DOCUMENT_ID
       , (select DOC.ACT_JOURNAL_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACT_JOURNAL_ID
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = (select DOC.ACT_JOURNAL_ID
                                         from ACT_DOCUMENT DOC
                                        where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ) JOU_NUMBER
       , (select JOU.JOU_DESCRIPTION
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = (select DOC.ACT_JOURNAL_ID
                                         from ACT_DOCUMENT DOC
                                        where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ) JOU_DESCRIPTION
       , ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
       , IMP.IMF_COMPARE_DATE
       , IMP.IMF_COMPARE_TEXT
       , IMP.IMF_COMPARE_USE_INI
       , IMP.IMF_TEXT1
       , IMP.IMF_TEXT2
       , IMP.IMF_TEXT3
       , IMP.IMF_TEXT4
       , IMP.IMF_TEXT5
       , IMP.IMF_NUMBER
       , IMP.IMF_NUMBER2
       , IMP.IMF_NUMBER3
       , IMP.IMF_NUMBER4
       , IMP.IMF_NUMBER5
       , IMP.DIC_IMP_FREE1_ID
       , IMP.DIC_IMP_FREE2_ID
       , IMP.DIC_IMP_FREE3_ID
       , IMP.DIC_IMP_FREE4_ID
       , IMP.DIC_IMP_FREE5_ID
       , IMP.GCO_GOOD_ID
       , IMP.HRM_PERSON_ID
       , IMP.DOC_RECORD_ID
       , IMP.FAM_FIXED_ASSETS_ID
       , IMP.C_FAM_TRANSACTION_TYP
       , IMP.PAC_PERSON_ID
       , (select DOC.ACT_ACT_JOURNAL_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACT_ACT_JOURNAL_ID
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = (select DOC.ACT_JOURNAL_ID
                                         from ACT_DOCUMENT DOC
                                        where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)
             and ETA.C_SUB_SET = 'ACC') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = (select DOC.ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)
             and SCA.C_SUB_SET = 'ACC') C_TYPE_CUMUL
       , PER.C_TYPE_PERIOD
       , PER.PER_NO_PERIOD
    from ACS_PERIOD PER
       , ACT_FINANCIAL_IMPUTATION IMP
       , ACS_ACCOUNT DIV
       , (select LID_FREE_NUMBER_1 ACS_DIVISION_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
       , (select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
            from COM_LIST_ID_TEMP
           where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') YEA
   where IMP.IMF_ACS_DIVISION_ACCOUNT_ID = DIV.ACS_ACCOUNT_ID
     and DIV.ACS_ACCOUNT_ID = TMP.ACS_DIVISION_ACCOUNT_ID
     and IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and PER.ACS_FINANCIAL_YEAR_ID = YEA.ACS_FINANCIAL_YEAR_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_DIV_IMP_REPORT" ("C_TYPE_PERIOD", "PER_NO_PERIOD", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID") AS
  select C_TYPE_PERIOD
       , PER_NO_PERIOD
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , ACT_DOCUMENT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , IMF_TYPE
       , IMF_PRIMARY
       , IMF_DESCRIPTION
       , IMF_AMOUNT_LC_D
       , IMF_AMOUNT_LC_C
       , IMF_EXCHANGE_RATE
       , IMF_AMOUNT_FC_D
       , IMF_AMOUNT_FC_C
       , IMF_AMOUNT_EUR_D
       , IMF_AMOUNT_EUR_C
       , IMF_VALUE_DATE
       , ACS_TAX_CODE_ID
       , IMF_TRANSACTION_DATE
       , ACS_FINANCIAL_CURRENCY_ID
       , C_GENRE_TRANSACTION
       , ACS_AUXILIARY_ACCOUNT_ID
       , ACT_DET_PAYMENT_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMF_BASE_PRICE
       , ACT_PART_IMPUTATION_ID
       , COV_NUMBER
       , PAR_DOCUMENT
       , DOC_DATE_DELIVERY
       , ACC_NUMBER
       , ACT_FINANCIAL_DISTRIBUTION_ID
       , ACS_DIVISION_ACCOUNT_ID
       , DIV_NUMBER
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , FINANCIAL_IMPUTATION_ID
       , ACT_ACT_JOURNAL_ID
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
       , IMF_COMPARE_DATE
       , IMF_COMPARE_TEXT
       , IMF_COMPARE_USE_INI
       , IMF_TEXT1
       , IMF_TEXT2
       , IMF_TEXT3
       , IMF_TEXT4
       , IMF_TEXT5
       , IMF_NUMBER
       , IMF_NUMBER2
       , IMF_NUMBER3
       , IMF_NUMBER4
       , IMF_NUMBER5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , GCO_GOOD_ID
       , HRM_PERSON_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
    from V_ACR_DIV_IMPUTATION
   where (C_TYPE_PERIOD <> '1') --Priode en cours
       or(C_TYPE_PERIOD = '1' -- Report des exercices clturs
         and nvl( (select A.C_STATE_FINANCIAL_YEAR
                     from ACS_FINANCIAL_YEAR A
                        , ACS_FINANCIAL_YEAR B
                    where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                      and B.FYE_START_DATE = A.FYE_END_DATE + 1
                      and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                       from COM_LIST_ID_TEMP
                                                      where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
               , 'CLO'
                ) = 'CLO')
  union all
  select TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , TOT.ACS_PERIOD_ID
       , 0 ACT_DOCUMENT_ID
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , 'MAN' IMF_TYPE
       , 0 IMF_PRIMARY
       , 'Report' IMF_DESCRIPTION
       , TOT.TOT_DEBIT_LC IMF_AMOUNT_LC_D
       , TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C
       , 0 IMF_EXCHANGE_RATE
       , TOT.TOT_DEBIT_FC IMF_AMOUNT_FC_D
       , TOT.TOT_CREDIT_FC IMF_AMOUNT_FC_C
       , TOT.TOT_DEBIT_EUR IMF_AMOUNT_EUR_D
       , TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C
       , TOT.PER_START_DATE IMF_VALUE_DATE
       , 0 ACS_TAX_CODE_ID
       , TOT.PER_START_DATE IMF_TRANSACTION_DATE
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID
       , '1' C_GENRE_TRANSACTION
       , 0 ACS_AUXILIARY_ACCOUNT_ID
       , 0 ACT_DET_PAYMENT_ID
       , TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMF_BASE_PRICE
       , 0 ACT_PART_IMPUTATION_ID
       , '' COV_NUMBER
       , '' PAR_DOCUMENT
       , to_date(null) DOC_DATE_DELIVERY
       , (select ACC.ACC_NUMBER
            from ACS_ACCOUNT ACC
           where ACC.ACS_ACCOUNT_ID = TOT.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
       , 0 ACT_FINANCIAL_DISTRIBUTION_ID
       , TOT.ACS_DIVISION_ACCOUNT_ID
       , TOT.DIV_NUMBER
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , 0 FINANCIAL_IMPUTATION_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
       , TOT.PER_START_DATE IMF_COMPARE_DATE
       , '' IMF_COMPARE_TEXT
       , '' IMF_COMPARE_USE_INI
       , '' IMF_TEXT1
       , '' IMF_TEXT2
       , '' IMF_TEXT3
       , '' IMF_TEXT4
       , '' IMF_TEXT5
       , 0 IMF_NUMBER
       , 0 IMF_NUMBER2
       , 0 IMF_NUMBER3
       , 0 IMF_NUMBER4
       , 0 IMF_NUMBER5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_MIP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 GCO_GOOD_ID
       , 0 HRM_PERSON_ID
       , 0 DOC_RECORD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 PAC_PERSON_ID
    from V_ACR_DIV_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_DIV_PREV_YEAR_TOTAL" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE", "PER_NO_PERIOD", "C_TYPE_PERIOD") AS
  select   TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , DIV.ACC_NUMBER DIV_NUMBER
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_DEBIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_CREDIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_DEBIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_CREDIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_DEBIT_EUR
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_CREDIT_EUR
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.PER_NO_PERIOD
         , PER.C_TYPE_PERIOD
      from ACS_ACCOUNT DIV
         , ACT_TOTAL_BY_PERIOD TOT
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where DIV.ACS_ACCOUNT_ID = TMP.LID_FREE_NUMBER_1
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.C_TYPE_PERIOD = '1'
       and TOT.ACS_DIVISION_ACCOUNT_ID = DIV.ACS_ACCOUNT_ID
       and TOT.ACS_AUXILIARY_ACCOUNT_ID + 0 is null
       and (    (TOT.ACS_DIVISION_ACCOUNT_ID is not null)
            or (    TOT.ACS_DIVISION_ACCOUNT_ID is null
                and ACR_FUNCTIONS.ExistDivision = 0)
           )
  group by TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , DIV.ACC_NUMBER
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.PER_NO_PERIOD
         , PER.C_TYPE_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_BS" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , substr(replace(ACC_NUMBER, '.', ''), 1, 10)
           , substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) ) MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , (select ACC_NUMBER
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select DFI.DES_DESCRIPTION_SUMMARY
                          from ACS_DESCRIPTION DFI
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'BS' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_BI_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_BS_ALT" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , substr(replace(ACC_NUMBER, '.', ''), 1, 10)
           , substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) ) MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , (select ACS_LIB_ALTERNATIVE.get_SynNumber(ACC_NUMBER)
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select ACS_LIB_ALTERNATIVE.get_AltDescr(ACC_NUMBER, 1)
                          from ACS_DESCRIPTION DFI
                             , ACS_ACCOUNT ACS
                         where ACS.ACS_ACCOUNT_ID = DFI.ACS_ACCOUNT_ID
                           and DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'BS' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_BS_NATURE = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_BS_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_BI_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_BS_MCH2" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , substr(replace(ACC_NUMBER, '.', ''), 1, 10)
           , substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) ) MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_MCH2_BS_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_1 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_MCH2_BS_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_2 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_MCH2_BS_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_BS_LEVEL_3 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , (select ACC_NUMBER
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select DFI.DES_DESCRIPTION_SUMMARY
                          from ACS_DESCRIPTION DFI
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'BS' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_1' then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_2' then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_3' then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_4' then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_5' then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_6' then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_7' then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_8' then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_9' then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when ECO.EDC_DICO_MCH2_BS_NATURE = 'DIC_FIN_ACC_CODE2_10' then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NATURE
                     , '0' ACC_TASK
                     , ECO.EDC_DICO_MCH2_BS_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_MCH2_BI_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_IN" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', ''), instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK), 10)
               else substr(replace(ACC_NUMBER, '.', ''), 1, 10)
             end MANAGEMENT_NUMBER
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', '')
                                                              , instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK) + 10
                                                              , length(ACC_NUMBER)
                                                               )
               else substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) )
             end MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , (select ACC_NUMBER
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select DFI.DES_DESCRIPTION_SUMMARY
                          from ACS_DESCRIPTION DFI
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'IN' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NATURE
                     , case
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_TASK
                     , ECO.EDC_DICO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_IN_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_IN_ALT" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', ''), instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK), 10)
               else substr(replace(ACC_NUMBER, '.', ''), 1, 10)
             end MANAGEMENT_NUMBER
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', '')
                                                              , instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK) + 10
                                                              , length(ACC_NUMBER)
                                                               )
               else substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) )
             end MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , (select ACS_LIB_ALTERNATIVE.get_SynNumber(ACC_NUMBER)
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select ACS_LIB_ALTERNATIVE.get_AltDescr(ACC_NUMBER, 1)
                          from ACS_DESCRIPTION DFI
                             , ACS_ACCOUNT ACS
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.ACS_ACCOUNT_ID = ACS.ACS_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'IN' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_NATURE = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NATURE
                     , case
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_TASK = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_TASK
                     , ECO.EDC_DICO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_IN_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_IN_MCH2" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', ''), instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK), 10)
               else substr(replace(ACC_NUMBER, '.', ''), 1, 10)
             end MANAGEMENT_NUMBER
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', '')
                                                              , instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK) + 10
                                                              , length(ACC_NUMBER)
                                                               )
               else substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) )
             end MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_MCH2_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_1 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_MCH2_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_2 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_MCH2_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_LEVEL_3 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , (select ACC_NUMBER
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select DFI.DES_DESCRIPTION_SUMMARY
                          from ACS_DESCRIPTION DFI
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'IN' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_1' then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_2' then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_3' then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_4' then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_5' then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_6' then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_7' then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_8' then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_9' then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when ECO.EDC_DICO_MCH2_NATURE = 'DIC_FIN_ACC_CODE2_10' then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NATURE
                     , case
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_1' then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_2' then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_3' then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_4' then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_5' then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_6' then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_7' then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_8' then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_9' then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when ECO.EDC_DICO_MCH2_TASK = 'DIC_FIN_ACC_CODE2_10' then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_TASK
                     , ECO.EDC_DICO_MCH2_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_MCH2_IN_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_WO" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', ''), instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK), 10)
               else substr(replace(ACC_NUMBER, '.', ''), 1, 10)
             end MANAGEMENT_NUMBER
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', '')
                                                              , instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK) + 10
                                                              , length(ACC_NUMBER)
                                                               )
               else substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) )
             end MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , (select ACC_NUMBER
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select DFI.DES_DESCRIPTION_SUMMARY
                          from ACS_DESCRIPTION DFI
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'WO' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NATURE
                     , case
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_WO_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_WO_ALT" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', ''), instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK), 10)
               else substr(replace(ACC_NUMBER, '.', ''), 1, 10)
             end MANAGEMENT_NUMBER
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', '')
                                                              , instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK) + 10
                                                              , length(ACC_NUMBER)
                                                               )
               else substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) )
             end MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_1')
                         and (FIN.DIC_FIN_ACC_CODE_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_1_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_2')
                         and (FIN.DIC_FIN_ACC_CODE_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_2_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_3')
                         and (FIN.DIC_FIN_ACC_CODE_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_3_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_4')
                         and (FIN.DIC_FIN_ACC_CODE_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_4_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_5')
                         and (FIN.DIC_FIN_ACC_CODE_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_5_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_6')
                         and (FIN.DIC_FIN_ACC_CODE_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_6_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_7')
                         and (FIN.DIC_FIN_ACC_CODE_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_7_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_8')
                         and (FIN.DIC_FIN_ACC_CODE_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_8_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_9')
                         and (FIN.DIC_FIN_ACC_CODE_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_9_ID
                         when(ECO.EDC_DICO_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE_10')
                         and (FIN.DIC_FIN_ACC_CODE_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_PARENT
                     , (select ACS_LIB_ALTERNATIVE.get_SynNumber(ACC_NUMBER)
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select ACS_LIB_ALTERNATIVE.get_AltDescr(ACC_NUMBER, 1)
                          from ACS_DESCRIPTION DFI
                             , ACS_ACCOUNT ACS
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.ACS_ACCOUNT_ID = ACS.ACS_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'WO' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_WO_NATURE = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_NATURE
                     , case
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_1' then FIN.DIC_FIN_ACC_CODE_1_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_2' then FIN.DIC_FIN_ACC_CODE_2_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_3' then FIN.DIC_FIN_ACC_CODE_3_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_4' then FIN.DIC_FIN_ACC_CODE_4_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_5' then FIN.DIC_FIN_ACC_CODE_5_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_6' then FIN.DIC_FIN_ACC_CODE_6_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_7' then FIN.DIC_FIN_ACC_CODE_7_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_8' then FIN.DIC_FIN_ACC_CODE_8_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_9' then FIN.DIC_FIN_ACC_CODE_9_ID
                         when ECO.EDC_DICO_WO_TASK = 'DIC_FIN_ACC_CODE_10' then FIN.DIC_FIN_ACC_CODE_10_ID
                       end ACC_TASK
                     , ECO.EDC_DICO_WO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_WO_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EDO_WO_MCH2" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_PARENT", "ACC_NUMBER", "ACC_DESCRIPTION", "ACC_TYPE", "ACC_NATURE", "ACC_TASK", "MANAGEMENT_NUMBER", "MANAGEMENT_COMPLEMENT", "DICO_PARENT") AS
  select     ACS_FINANCIAL_ACCOUNT_ID
           , ACC_PARENT
           , ACC_NUMBER
           , ACC_DESCRIPTION
           , ACC_TYPE
           , ACC_NATURE
           , ACC_TASK
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', ''), instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK), 10)
               else substr(replace(ACC_NUMBER, '.', ''), 1, 10)
             end MANAGEMENT_NUMBER
           , case
               when instr(ACC_NUMBER, ACC_TASK) > 0 then substr(replace(ACC_NUMBER, '.', '')
                                                              , instr(ACC_NUMBER, ACC_TASK) + length(ACC_TASK) + 10
                                                              , length(ACC_NUMBER)
                                                               )
               else substr(replace(ACC_NUMBER, '.', ''), 11, length(ACC_NUMBER) )
             end MANAGEMENT_COMPLEMENT
           , DICO_PARENT
        from (select   -3 ACS_FINANCIAL_ACCOUNT_ID
                     , null ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_MCH2_WO_LEVEL_1 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -2 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_1 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_MCH2_WO_LEVEL_2 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
              union
              select   -1 ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_2 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , case
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NUMBER
                     , '' ACC_DESCRIPTION
                     , '' ACC_TYPE
                     , '' ACC_NATURE
                     , '' ACC_TASK
                     , ECO.EDC_DICO_MCH2_WO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
              union
              select   FIN.ACS_FINANCIAL_ACCOUNT_ID
                     , case
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_1')
                         and (FIN.DIC_FIN_ACC_CODE2_1_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_2')
                         and (FIN.DIC_FIN_ACC_CODE2_2_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_3')
                         and (FIN.DIC_FIN_ACC_CODE2_3_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_4')
                         and (FIN.DIC_FIN_ACC_CODE2_4_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_5')
                         and (FIN.DIC_FIN_ACC_CODE2_5_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_6')
                         and (FIN.DIC_FIN_ACC_CODE2_6_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_7')
                         and (FIN.DIC_FIN_ACC_CODE2_7_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_8')
                         and (FIN.DIC_FIN_ACC_CODE2_8_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_9')
                         and (FIN.DIC_FIN_ACC_CODE2_9_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when(ECO.EDC_DICO_MCH2_WO_LEVEL_3 = 'DIC_FIN_ACC_CODE2_10')
                         and (FIN.DIC_FIN_ACC_CODE2_10_ID <> ' ') then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_PARENT
                     , (select ACC_NUMBER
                          from ACS_ACCOUNT
                         where ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER
                     , (select DFI.DES_DESCRIPTION_SUMMARY
                          from ACS_DESCRIPTION DFI
                         where DFI.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                           and DFI.PC_LANG_ID = EDO.PC_LANG_ID) ACC_DESCRIPTION
                     , 'WO' ACC_TYPE
                     , case
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_1' then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_2' then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_3' then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_4' then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_5' then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_6' then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_7' then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_8' then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_9' then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when ECO.EDC_DICO_MCH2_WO_NATURE = 'DIC_FIN_ACC_CODE2_10' then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_NATURE
                     , case
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_1' then FIN.DIC_FIN_ACC_CODE2_1_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_2' then FIN.DIC_FIN_ACC_CODE2_2_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_3' then FIN.DIC_FIN_ACC_CODE2_3_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_4' then FIN.DIC_FIN_ACC_CODE2_4_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_5' then FIN.DIC_FIN_ACC_CODE2_5_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_6' then FIN.DIC_FIN_ACC_CODE2_6_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_7' then FIN.DIC_FIN_ACC_CODE2_7_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_8' then FIN.DIC_FIN_ACC_CODE2_8_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_9' then FIN.DIC_FIN_ACC_CODE2_9_ID
                         when ECO.EDC_DICO_MCH2_WO_TASK = 'DIC_FIN_ACC_CODE2_10' then FIN.DIC_FIN_ACC_CODE2_10_ID
                       end ACC_TASK
                     , ECO.EDC_DICO_MCH2_WO_LEVEL_3 DICO_PARENT
                  from ACS_FINANCIAL_ACCOUNT FIN
                     , ACR_EDO_CONFIG ECO
                     , ACR_EDO EDO
                 where C_EDO_STATUS = 1
                   and exists(select 1
                                from ACS_ACCOUNT ACC
                               where ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
                                 and ACC.ACS_ACCOUNT_CATEG_ID = ECO.ACS_ACCOUNT_CATEG_MCH2_WO_ID)
              order by ACC_NUMBER)
  start with ACC_PARENT is null
  connect by prior ACC_NUMBER = ACC_PARENT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRIES" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_CUSTOM_PARTNER_ID,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       PAC_FUNCTIONS.GetNamesAndCity(nvl(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, EXP.EXP_PAC_CUSTOM_PARTNER_ID)) PER_NAME,
       ACT_FUNCTIONS.GetAnalyse_Date ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 2) DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       (select DIC_BLOCKED_REASON_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DIC_BLOCKED_REASON_ID,
       DOC.DOC_COMMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')) BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')), 1, 3) C_TYPE_CUMUL,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ||', '|| (select DES_DESCRIPTION_SUMMARY from ACS_DESCRIPTION DES where DES.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID and DES.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId) DES_ACC_NUMBER,
       (select ACS_SUB_SET_ID from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_AUXILIARY_ACCOUNT_ID        in (select ACS_ACCOUNT_ID
                                                          from ACS_ACCOUNT
                                                         where ACS_ACCOUNT_ID in (select LID_FREE_NUMBER_1 from COM_LIST_ID_TEMP where LID_FREE_NUMBER_1 is not null))
           and IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.IMF_TRANSACTION_DATE            <= ACT_FUNCTIONS.GetAnalyse_Date
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.EXP_CALC_NET                  = 1
    and ACT_EXPIRY_MANAGEMENT.IsExpiryOpenedAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date) = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRIES_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "PER_NAME", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_CUSTOM_PARTNER_ID,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       PAC_FUNCTIONS.GetNamesAndCity(nvl(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, EXP.EXP_PAC_CUSTOM_PARTNER_ID)) PER_NAME,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       (select DIC_BLOCKED_REASON_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DIC_BLOCKED_REASON_ID,
       DOC.DOC_COMMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')) BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')), 1, 3) C_TYPE_CUMUL,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ||', '|| (select DES_DESCRIPTION_SUMMARY from ACS_DESCRIPTION DES where DES.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID and DES.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId) DES_ACC_NUMBER,
       (select ACS_SUB_SET_ID from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_AUXILIARY_ACCOUNT_ID        in (select ACS_ACCOUNT_ID
                                                          from ACS_ACCOUNT
                                                         where ACS_ACCOUNT_ID in (select LID_FREE_NUMBER_1 from COM_LIST_ID_TEMP where LID_FREE_NUMBER_1 is not null))
           and IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_EXPIRY                 EXP,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.C_STATUS_EXPIRY               = '0'
    and EXP.EXP_CALC_NET                  = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_CUST" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       EXP.ACS_AUXILIARY_ACCOUNT_ID,
       EXP.ACC_NUMBER,
       EXP.DES_ACC_NUMBER,
       EXP.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.PAR_BLOCKED_DOCUMENT,
       EXP.DIC_BLOCKED_REASON_ID,
       EXP.DOC_COMMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from V_ACR_EXPIRIES EXP
  where exists(select 1 from PAC_CUSTOM_PARTNER CUS where CUS.PAC_CUSTOM_PARTNER_ID = EXP.PAC_CUSTOM_PARTNER_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_CUST_ISAG" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "IMF_NUMBER2") AS
  SELECT v."ACT_EXPIRY_ID", v."ACT_DOCUMENT_ID", v."ACT_PART_IMPUTATION_ID",
          v."EXP_ADAPTED", v."EXP_CALCULATED", v."EXP_AMOUNT_LC",
          v."EXP_AMOUNT_FC", v."EXP_AMOUNT_EUR", v."EXP_SLICE",
          v."EXP_POURCENT", v."EXP_CALC_NET", v."C_STATUS_EXPIRY",
          v."EXP_DATE_PMT_TOT", v."EXP_BVR_CODE", v."EXP_REF_BVR",
          v."ACS_FIN_ACC_S_PAYMENT_ID", v."EXP_AMOUNT_PROV_LC",
          v."EXP_AMOUNT_PROV_FC", v."PAC_CUSTOM_PARTNER_ID",
          v."ACS_AUXILIARY_ACCOUNT_ID", v."ACC_NUMBER", v."DES_ACC_NUMBER",
          v."ACS_SUB_SET_ID", v."PER_NAME", v."ANALYSE_DATE",
          v."ACS_PERIOD_ID", v."ACS_FINANCIAL_CURRENCY_ID", v."CURRENCY1",
          v."ACS_ACS_FINANCIAL_CURRENCY_ID", v."CURRENCY2",
          v."IMF_TRANSACTION_DATE", v."IMF_VALUE_DATE", v."IMF_DESCRIPTION",
          v."ACS_FINANCIAL_ACCOUNT_ID", v."ACS_DIVISION_ACCOUNT_ID",
          v."ACJ_CATALOGUE_DOCUMENT_ID", v."DET_PAIED_LC", v."DET_PAIED_FC",
          v."DET_PAIED_EUR", v."EXP_DISCOUNT_DATE", v."EXP_DISCOUNT_LC",
          v."EXP_DISCOUNT_FC", v."EXP_DISCOUNT_EUR", v."DOC_NUMBER",
          v."PAR_DOCUMENT", v."PAR_BLOCKED_DOCUMENT",
          v."DIC_BLOCKED_REASON_ID", v."DOC_COMMENT", v."DOC_DATE_DELIVERY",
          v."LAST_CLAIMS_LEVEL", v."LAST_CLAIMS_DATE", v."BRO",
          v."TYP_SUPPLIER_PERMANENT", v."C_ETAT_JOURNAL", v."C_TYPE_CUMUL",
          (SELECT MIN (imp.imf_number2)
             FROM act_financial_imputation imp
            WHERE imp.act_part_imputation_id =
                                         v.act_part_imputation_id)
                                                                  imf_number2
     FROM v_acr_expiry_cust v


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_CUST_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       EXP.ACS_AUXILIARY_ACCOUNT_ID,
       EXP.ACC_NUMBER,
       EXP.DES_ACC_NUMBER,
       EXP.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       null ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       0 EXP_DISCOUNT_DATE,
       0 EXP_DISCOUNT_LC,
       0 EXP_DISCOUNT_FC,
       0 EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.PAR_BLOCKED_DOCUMENT,
       EXP.DIC_BLOCKED_REASON_ID,
       EXP.DOC_COMMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from  V_ACR_EXPIRIES_STATUS EXP
  where exists(select 1 from PAC_CUSTOM_PARTNER CUS where CUS.PAC_CUSTOM_PARTNER_ID  = EXP.PAC_CUSTOM_PARTNER_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_SUPP" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       EXP.ACS_AUXILIARY_ACCOUNT_ID,
       EXP.ACC_NUMBER,
       EXP.DES_ACC_NUMBER,
       EXP.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.PAR_BLOCKED_DOCUMENT,
       EXP.DIC_BLOCKED_REASON_ID,
       EXP.DOC_COMMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from  V_ACR_EXPIRIES EXP
  where exists(select 1 from PAC_SUPPLIER_PARTNER SUP where SUP.PAC_SUPPLIER_PARTNER_ID = EXP.PAC_SUPPLIER_PARTNER_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_SUPP_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       EXP.ACS_AUXILIARY_ACCOUNT_ID,
       EXP.ACC_NUMBER,
       EXP.DES_ACC_NUMBER,
       EXP.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       null ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       0 EXP_DISCOUNT_DATE,
       0 EXP_DISCOUNT_LC,
       0 EXP_DISCOUNT_FC,
       0 EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.PAR_BLOCKED_DOCUMENT,
       EXP.DIC_BLOCKED_REASON_ID,
       EXP.DOC_COMMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from  V_ACR_EXPIRIES_STATUS EXP
  where exists(select 1 from PAC_SUPPLIER_PARTNER SUP where SUP.PAC_SUPPLIER_PARTNER_ID  = EXP.PAC_SUPPLIER_PARTNER_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_THIRD" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_PERSON_ID,
       PAC_FUNCTIONS.GetNamesAndCity(EXP.EXP_PAC_CUSTOM_PARTNER_ID) PER_NAME,
       ACT_FUNCTIONS.GetAnalyse_Date ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 2) DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       (select DIC_BLOCKED_REASON_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DIC_BLOCKED_REASON_ID,
       DOC.DOC_COMMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, 'REC') BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ||', '|| (select DES_DESCRIPTION_SUMMARY from ACS_DESCRIPTION DES where DES.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID and DES.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId) DES_ACC_NUMBER,
       (select ACS_SUB_SET_ID from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.IMF_TRANSACTION_DATE            <= ACT_FUNCTIONS.GetAnalyse_Date
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and EXP.EXP_PAC_CUSTOM_PARTNER_ID    is not null
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = 'REC'
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.EXP_CALC_NET                  = 1
    and ACT_EXPIRY_MANAGEMENT.IsExpiryOpenedAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date) = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID
union all
select ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP_ADAPTED,
       EXP_CALCULATED,
       EXP_AMOUNT_LC * -1 EXP_AMOUNT_LC,
       EXP_AMOUNT_FC * -1 EXP_AMOUNT_FC,
       EXP_AMOUNT_EUR * -1 EXP_AMOUNT_EUR,
       EXP_SLICE,
       EXP_POURCENT,
       EXP_CALC_NET,
       C_STATUS_EXPIRY,
       EXP_DATE_PMT_TOT,
       EXP_BVR_CODE,
       EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP_AMOUNT_PROV_LC * -1 EXP_AMOUNT_PROV_LC,
       EXP_AMOUNT_PROV_FC * -1 EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_PERSON_ID,
       PAC_FUNCTIONS.GetNamesAndCity(EXP.EXP_PAC_SUPPLIER_PARTNER_ID) PER_NAME,
       ACT_FUNCTIONS.GetAnalyse_Date ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 1) * -1 DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 0) * -1 DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 2) * -1 DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 1) * -1 EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 0) * -1 EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 2) * -1 EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       (select DIC_BLOCKED_REASON_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DIC_BLOCKED_REASON_ID,
       DOC.DOC_COMMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, 'PAY') BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ||', '|| (select DES_DESCRIPTION_SUMMARY from ACS_DESCRIPTION DES where DES.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID and DES.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId) DES_ACC_NUMBER,
       (select ACS_SUB_SET_ID from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.IMF_TRANSACTION_DATE            <= ACT_FUNCTIONS.GetAnalyse_Date
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and EXP.EXP_PAC_SUPPLIER_PARTNER_ID  is not null
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = 'PAY'
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.EXP_CALC_NET                  = 1
    and ACT_EXPIRY_MANAGEMENT.IsExpiryOpenedAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date) = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_EXPIRY_THIRD_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "PER_NAME", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "ANALYSE_DATE", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "PAR_BLOCKED_DOCUMENT", "DIC_BLOCKED_REASON_ID", "DOC_COMMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_PERSON_ID,
       PAC_FUNCTIONS.GetNamesAndCity(EXP.EXP_PAC_CUSTOM_PARTNER_ID) PER_NAME,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       null ANALYSE_DATE,
       0 EXP_DISCOUNT_DATE,
       0 EXP_DISCOUNT_LC,
       0 EXP_DISCOUNT_FC,
       0 EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       (select DIC_BLOCKED_REASON_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DIC_BLOCKED_REASON_ID,
       DOC.DOC_COMMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, 'REC') BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ||', '|| (select DES_DESCRIPTION_SUMMARY from ACS_DESCRIPTION DES where DES.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID and DES.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId) DES_ACC_NUMBER,
       (select ACS_SUB_SET_ID from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and EXP.EXP_PAC_CUSTOM_PARTNER_ID    is not null
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = 'REC'
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.C_STATUS_EXPIRY               = '0'
    and EXP.EXP_CALC_NET                  = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID
union all
select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC * -1 EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC * -1 EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR * -1 EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC * -1 EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC * -1 EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_PERSON_ID,
       PAC_FUNCTIONS.GetNamesAndCity(EXP.EXP_PAC_SUPPLIER_PARTNER_ID) PER_NAME,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) * -1 DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) * -1 DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) * -1 DET_PAIED_EUR,
       null ANALYSE_DATE,
       0 EXP_DISCOUNT_DATE,
       0 EXP_DISCOUNT_LC,
       0 EXP_DISCOUNT_FC,
       0 EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       (select DIC_BLOCKED_REASON_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DIC_BLOCKED_REASON_ID,
       DOC.DOC_COMMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, 'PAY') BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ||', '|| (select DES_DESCRIPTION_SUMMARY from ACS_DESCRIPTION DES where DES.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID and DES.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId) DES_ACC_NUMBER,
       (select ACS_SUB_SET_ID from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID     in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and EXP.EXP_PAC_SUPPLIER_PARTNER_ID  is not null
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = 'PAY'
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.C_STATUS_EXPIRY               = '0'
    and EXP.EXP_CALC_NET                  = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_FINSTA_BILAN_GOV" ("ACC_NUMBER", "ACS_DESCRIPTION", "AMOUNT_LC_D", "AMOUNT_LC_C", "AMOUNT_LC", "FYE_NO_EXERCICE") AS
  SELECT   cpte.acc_number, des_description_summary, SUM (tot_debit_lc)
                                                                        debit,
            SUM (tot_credit_lc) credit,
            SUM ((tot_debit_lc - tot_credit_lc)) net, fye_no_exercice
       FROM act_total_by_period p,
            acs_period per,
            acs_financial_year y,
            acs_account cpte,
            acs_sub_set acs,
            acs_description descr,
            acs_account_categ cat
      WHERE p.acs_period_id = per.acs_period_id
        AND per.acs_financial_year_id = y.acs_financial_year_id
        AND cpte.acs_account_id = p.acs_financial_account_id
        AND acs.acs_sub_set_id = cpte.acs_sub_set_id
        AND cpte.acs_account_id = descr.acs_account_id
        AND cpte.acs_account_categ_id = cat.acs_account_categ_id
        AND aca_key = 'Bilan'
        AND pc_lang_id = 1
        AND c_sub_set = 'ACC'
        AND c_type_cumul = 'EXT'
        AND c_state_financial_year = 'CLO'
        AND p.acs_division_account_id IS NULL
        AND acs_auxiliary_account_id IS NULL
        AND acs_acs_auxiliary_account_id IS NULL
   GROUP BY acc_number, fye_no_exercice, des_description_summary
   ORDER BY fye_no_exercice, acc_number


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_FINSTA_FONCT_GOV" ("ACS_FUNCTION", "ACC_NUMBER", "ACS_DESCRIPTION", "AMOUNT_LC_D", "AMOUNT_LC_C", "TOT_AMOUNT_LC_D", "TOT_AMOUNT_LC_C", "FYE_NO_EXERCICE") AS
  SELECT   acs_function, acc_number, acs_description, amount_lc_d,
            amount_lc_c, tot_amount_lc_d, tot_amount_lc_c, fye_no_exercice
       FROM (SELECT   SUBSTR (cpte.acc_number, 1, 3) acs_function,
                      SUBSTR (cpte.acc_number, 5) acc_number,
                      des_description_summary acs_description, 0 amount_lc_d,
                      0 amount_lc_c,
                      NVL
                         ((SELECT CASE
                                     WHEN SUBSTR (cpte.acc_number, 5, 1) = 3
                                        THEN SUM (tot_debit_lc - tot_credit_lc)
                                     ELSE NULL
                                  END
                             FROM act_total_by_period p,
                                  acs_period per,
                                  acs_financial_year y
                            WHERE p.acs_period_id = per.acs_period_id
                              AND per.acs_financial_year_id =
                                                       y.acs_financial_year_id
                              AND cpte.acs_account_id =
                                                    p.acs_financial_account_id
                              AND y.fye_no_exercice = y1.fye_no_exercice
                              AND NVL (c_type_cumul, 'EXT') = 'EXT'
                              AND p.acs_division_account_id IS NULL
                              AND acs_auxiliary_account_id IS NULL
                              AND acs_acs_auxiliary_account_id IS NULL),
                          0
                         ) tot_amount_lc_d,
                        NVL
                           ((SELECT CASE
                                       WHEN SUBSTR (cpte.acc_number, 5, 1) = 4
                                          THEN SUM (  tot_debit_lc
                                                    - tot_credit_lc
                                                   )
                                       ELSE NULL
                                    END
                               FROM act_total_by_period p,
                                    acs_period per,
                                    acs_financial_year y
                              WHERE p.acs_period_id = per.acs_period_id
                                AND per.acs_financial_year_id =
                                                       y.acs_financial_year_id
                                AND cpte.acs_account_id =
                                                    p.acs_financial_account_id
                                AND y.fye_no_exercice = y1.fye_no_exercice
                                AND NVL (c_type_cumul, 'EXT') = 'EXT'
                                AND p.acs_division_account_id IS NULL
                                AND acs_auxiliary_account_id IS NULL
                                AND acs_acs_auxiliary_account_id IS NULL),
                            0
                           )
                      * (-1) tot_amount_lc_c,
                      fye_no_exercice
                 FROM acs_account cpte,
                      acs_sub_set acs,
                      acs_description descr,
                      acs_account_categ cat,
                      acs_financial_year y1
                WHERE acs.acs_sub_set_id = cpte.acs_sub_set_id
                  AND cpte.acs_account_id = descr.acs_account_id
                  AND cpte.acs_account_categ_id = cat.acs_account_categ_id
                  AND aca_key = 'Fonctionnement'
                  AND pc_lang_id = 1
                  AND c_sub_set = 'ACC'
                  AND c_state_financial_year = 'CLO'
             GROUP BY acc_number,
                      fye_no_exercice,
                      cpte.acs_account_id,
                      des_description_summary)
   ORDER BY fye_no_exercice, acs_function, acc_number


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_FINSTA_INVEST_GOV" ("ACS_FUNCTION", "ACC_NUMBER", "ACS_DESCRIPTION", "AMOUNT_LC_D", "AMOUNT_LC_C", "TOT_AMOUNT_LC_D", "TOT_AMOUNT_LC_C", "FYE_NO_EXERCICE") AS
  SELECT   acs_function, acc_number, acs_description, amount_lc_d,
            amount_lc_c, tot_amount_lc_d, tot_amount_lc_c, fye_no_exercice
       FROM (SELECT   SUBSTR (cpte.acc_number, 1, 3) acs_function,
                      SUBSTR (cpte.acc_number, 5) acc_number,
                      des_description_summary acs_description, 0 amount_lc_d,
                      0 amount_lc_c,
                      NVL
                         ((SELECT CASE
                                     WHEN SUBSTR (cpte.acc_number, 5, 1) = 5
                                        THEN SUM (tot_debit_lc - tot_credit_lc)
                                     ELSE NULL
                                  END
                             FROM act_total_by_period p,
                                  acs_period per,
                                  acs_financial_year y
                            WHERE p.acs_period_id = per.acs_period_id
                              AND per.acs_financial_year_id =
                                                       y.acs_financial_year_id
                              AND cpte.acs_account_id =
                                                    p.acs_financial_account_id
                              AND y.fye_no_exercice = y1.fye_no_exercice
                              AND NVL (c_type_cumul, 'EXT') = 'EXT'
                              AND p.acs_division_account_id IS NULL
                              AND acs_auxiliary_account_id IS NULL
                              AND acs_acs_auxiliary_account_id IS NULL),
                          0
                         ) tot_amount_lc_d,
                        NVL
                           ((SELECT CASE
                                       WHEN SUBSTR (cpte.acc_number, 5, 1) = 6
                                          THEN SUM (  tot_debit_lc
                                                    - tot_credit_lc
                                                   )
                                       ELSE NULL
                                    END
                               FROM act_total_by_period p,
                                    acs_period per,
                                    acs_financial_year y
                              WHERE p.acs_period_id = per.acs_period_id
                                AND per.acs_financial_year_id =
                                                       y.acs_financial_year_id
                                AND cpte.acs_account_id =
                                                    p.acs_financial_account_id
                                AND y.fye_no_exercice = y1.fye_no_exercice
                                AND NVL (c_type_cumul, 'EXT') = 'EXT'
                                AND p.acs_division_account_id IS NULL
                                AND acs_auxiliary_account_id IS NULL
                                AND acs_acs_auxiliary_account_id IS NULL),
                            0
                           )
                      * (-1) tot_amount_lc_c,
                      fye_no_exercice
                 FROM acs_account cpte,
                      acs_sub_set acs,
                      acs_description descr,
                      acs_account_categ cat,
                      acs_financial_year y1
                WHERE acs.acs_sub_set_id = cpte.acs_sub_set_id
                  AND cpte.acs_account_id = descr.acs_account_id
                  AND cpte.acs_account_categ_id = cat.acs_account_categ_id
                  AND aca_key = 'Investissement'
                  AND pc_lang_id = 1
                  AND c_sub_set = 'ACC'
                  AND c_state_financial_year = 'CLO'
             GROUP BY acc_number,
                      fye_no_exercice,
                      cpte.acs_account_id,
                      des_description_summary)
   ORDER BY fye_no_exercice, acs_function, acc_number


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_MGM_ISAG" ("FYE_NO_EXERCICE", "PER_NO_PERIOD", "DOC_NUMBER", "CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "DIC_CDA_FREECODE1_ID", "DIC_CDA_FREECODE2_ID", "DIC_CDA_FREECODE3_ID", "DIC_CDA_FREECODE4_ID", "DIC_DESCRIPTION", "CPN", "CDA", "PF", "IMM_DESCRIPTION", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "EFF_AMOUNT_LC", "VER_NUMBER", "BUDGET_LC", "TYP") AS
  SELECT
   YEAR.FYE_NO_EXERCICE,
   PER.PER_NO_PERIOD,
   DOC.DOC_NUMBER DOC_NUMBER,
   CPN.ACC_NUMBER CPN_ACCOUNT_ID,
   CDA.ACC_NUMBER ACS_CDA_ACCOUNT_ID,
   CDAMAN.DIC_CDA_FREECODE1_ID DIC_CDA_FREECODE1_ID,
   CDAMAN.DIC_CDA_FREECODE2_ID DIC_CDA_FREECODE2_ID,
   CDAMAN.DIC_CDA_FREECODE3_ID DIC_CDA_FREECODE3_ID,
   SUBSTR(CDAMAN.DIC_CDA_FREECODE4_ID,3,3) DIC_CDA_FREECODE4_ID,
   CDC_DES.DIC_DESCRIPTION DIC_DESCRIPTION,
   ACC_DES.DES_DESCRIPTION_SUMMARY CPN,
   CDA_DES.DES_DESCRIPTION_SUMMARY CDA,
   PF_DES.DES_DESCRIPTION_SUMMARY PF,
   M.IMM_DESCRIPTION,
   MBC.CURRENCY ACS_ACS_FINANCIAL_CURRENCY_ID,
   M.IMM_AMOUNT_LC_D,
   M.IMM_AMOUNT_LC_C,
   NVL(M.IMM_AMOUNT_LC_D -  M.IMM_AMOUNT_LC_C,0) EFF_AMOUNT_LC,
   NULL VER_NUMBER,
   0 BUDGET_LC,
   'EFFECTIF' TYP
 FROM
  ACT_DOCUMENT DOC,
  ACT_MGM_IMPUTATION M,
  ACS_ACCOUNT CPN,
  ACS_ACCOUNT CDA,
  ACS_ACCOUNT PF,
  ACS_CDA_ACCOUNT CDAMAN,
  ACS_DESCRIPTION ACC_DES,
  ACS_DESCRIPTION CDA_DES,
  ACS_DESCRIPTION PF_DES,
  (SELECT DISTINCT
      DIC_CDA_FREECODE4.DIC_CDA_FREECODE4_ID DIC_CDA_FREECODE4_ID,
	  DICO_DESCRIPTION2.DIT_DESCR DIC_DESCRIPTION
	  FROM  DIC_CDA_FREECODE4, DICO_DESCRIPTION DICO_DESCRIPTION2
	  WHERE DICO_DESCRIPTION2.DIT_CODE =  DIC_CDA_FREECODE4.DIC_CDA_FREECODE4_ID
	  AND   DICO_DESCRIPTION2.DIT_TABLE  = 'DIC_CDA_FREECODE4'
	  AND   DICO_DESCRIPTION2.PC_LANG_ID  = 1) CDC_DES,
  ACS_PERIOD PER,
  ACS_FINANCIAL_YEAR YEAR,
  ACJ_CATALOGUE_DOCUMENT CAT,
  ACJ_SUB_SET_CAT SUB,
  ACS_FINANCIAL_CURRENCY MB,
  PCS.PC_CURR MBC
 WHERE
  DOC.ACT_DOCUMENT_ID = M.ACT_DOCUMENT_ID AND
  CAT.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID AND
  SUB.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID AND
  M.ACS_CPN_ACCOUNT_ID = CPN.ACS_ACCOUNT_ID (+) AND
  M.ACS_CDA_ACCOUNT_ID=CDA.ACS_ACCOUNT_ID (+) AND
  M.ACS_PF_ACCOUNT_ID = PF.ACS_ACCOUNT_ID (+) AND
  CPN.ACS_ACCOUNT_ID = ACC_DES.ACS_ACCOUNT_ID (+) AND
  ACC_DES.PC_LANG_ID (+) = 1 AND
  CDA.ACS_ACCOUNT_ID= CDA_DES.ACS_ACCOUNT_ID  (+) AND
  CDA_DES.PC_LANG_ID  (+) = 1 AND
  PF.ACS_ACCOUNT_ID = PF_DES.ACS_ACCOUNT_ID (+) AND
  PF_DES.PC_LANG_ID (+) = 1 AND
  CDA.ACS_ACCOUNT_ID = CDAMAN.ACS_CDA_ACCOUNT_ID AND
  CDC_DES.DIC_CDA_FREECODE4_ID = CDAMAN.DIC_CDA_FREECODE4_ID(+) AND
  M.ACS_PERIOD_ID=PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID=YEAR.ACS_FINANCIAL_YEAR_ID
  AND  M.ACS_ACS_FINANCIAL_CURRENCY_ID = MB.ACS_FINANCIAL_CURRENCY_ID
  AND  MB.PC_CURR_ID = MBC.PC_CURR_ID
  AND SUB.C_TYPE_CUMUL = 'PRI'
  AND SUB.C_SUB_SET = 'CPN'
UNION ALL
SELECT
  YEAR.FYE_NO_EXERCICE,
  PER.PER_NO_PERIOD,
  NULL DOC_NUMBER,
	CPN.ACC_NUMBER CPN_ACCOUNT_ID,
	CDA.ACC_NUMBER ACS_CDA_ACCOUNT_ID,
	CDAMAN.DIC_CDA_FREECODE1_ID DIC,
	CDAMAN.DIC_CDA_FREECODE2_ID NT,
	CDAMAN.DIC_CDA_FREECODE3_ID REG,
	SUBSTR(CDAMAN.DIC_CDA_FREECODE4_ID,3,3) CDC,
	CDC_DES.DIC_DESCRIPTION CDC_DESCRIPTION,
	ACC_DES.DES_DESCRIPTION_SUMMARY CPN,
	CDA_DES.DES_DESCRIPTION_SUMMARY CDA,
	PF_DES.DES_DESCRIPTION_SUMMARY PF,
	GLO_DESCR IMM_DESCRIPTION,
	NULL ACS_ACS_FINANCIAL_CURRENCY_ID,
    0 IMM_AMOUNT_LC_D,
    0 IMM_AMOUNT_LC_C,
    0 EFF_AMOUNT_LC,
   VER.VER_NUMBER,
   (BUD_PER.PER_AMOUNT_D - BUD_PER.PER_AMOUNT_C) BUDGET_LC,
   'BUDGET' TYP
FROM
  ACB_GLOBAL_BUDGET BUD,
  ACB_PERIOD_AMOUNT BUD_PER,
  ACB_BUDGET_VERSION VER,
  ACS_ACCOUNT CPN,
  ACS_ACCOUNT CDA,
  ACS_ACCOUNT PF,
  ACS_CDA_ACCOUNT CDAMAN,
  ACS_DESCRIPTION ACC_DES,
  ACS_DESCRIPTION CDA_DES,
  ACS_DESCRIPTION PF_DES,
  (SELECT DISTINCT
      DIC_CDA_FREECODE4.DIC_CDA_FREECODE4_ID DIC_CDA_FREECODE4_ID,
	  DICO_DESCRIPTION2.DIT_DESCR DIC_DESCRIPTION
	  FROM  DIC_CDA_FREECODE4, DICO_DESCRIPTION DICO_DESCRIPTION2
	  WHERE DICO_DESCRIPTION2.DIT_CODE =  DIC_CDA_FREECODE4.DIC_CDA_FREECODE4_ID
	  AND   DICO_DESCRIPTION2.DIT_TABLE  = 'DIC_CDA_FREECODE4'
	  AND   DICO_DESCRIPTION2.PC_LANG_ID  = 1) CDC_DES,
  ACS_PERIOD PER,
  ACS_FINANCIAL_YEAR YEAR
  WHERE
  BUD.ACS_CPN_ACCOUNT_ID = CPN.ACS_ACCOUNT_ID (+) AND
  BUD.ACS_CDA_ACCOUNT_ID=CDA.ACS_ACCOUNT_ID (+) AND
  BUD.ACS_PF_ACCOUNT_ID=PF.ACS_ACCOUNT_ID (+) AND
  CPN.ACS_ACCOUNT_ID = ACC_DES.ACS_ACCOUNT_ID (+) AND
  ACC_DES.PC_LANG_ID (+) = 1 AND
  CDA.ACS_ACCOUNT_ID= CDA_DES.ACS_ACCOUNT_ID  (+) AND
  CDA_DES.PC_LANG_ID  (+) = 1 AND
  PF.ACS_ACCOUNT_ID= PF_DES.ACS_ACCOUNT_ID  (+) AND
  PF_DES.PC_LANG_ID  (+) = 1 AND
  CDA.ACS_ACCOUNT_ID = CDAMAN.ACS_CDA_ACCOUNT_ID AND
  CDC_DES.DIC_CDA_FREECODE4_ID = CDAMAN.DIC_CDA_FREECODE4_ID(+) AND
  BUD_PER.ACS_PERIOD_ID=PER.ACS_PERIOD_ID AND
  VER.ACB_BUDGET_VERSION_ID(+)=BUD.ACB_BUDGET_VERSION_ID AND
  PER.ACS_FINANCIAL_YEAR_ID=YEAR.ACS_FINANCIAL_YEAR_ID  AND
  BUD.ACB_GLOBAL_BUDGET_ID = BUD_PER.ACB_GLOBAL_BUDGET_ID AND
  VER.VER_DEFAULT = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PAC_PERSON_GOV" ("ACT_DOCUMENT_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_ACCOUNT_ID", "ACC_NUMBER", "IMF_DESCRIPTION", "IMF_TRANSACTION_DATE", "DOC_NUMBER", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IDE_BALANCE_AMOUNT", "ACS_FINANCIAL_YEAR_ID", "PAC_PERSON_ID", "GROUPING_DESCRIPTION", "GROUPING_ACC_NUMBER", "CUS_PER_NAME", "SUP_PER_NAME") AS
  select DOC.ACT_DOCUMENT_ID ACT_DOCUMENT_ID
       , act_financial_imputation_id act_financial_imputation_id
       , IMP.ACS_FINANCIAL_ACCOUNT_ID ACS_ACCOUNT_iD
       , ACC_NUMBER ACC_NUMBER
       , IMF_DESCRIPTION IMF_DESCRIPTION
       , IMF_TRANSACTION_DATE
       , DOC_NUMBER DOC_NUMBER
       , (IMF_AMOUNT_LC_D) IMF_AMOUNT_LC_D
       , (IMF_AMOUNT_LC_C) IMF_AMOUNT_LC_C
       , 0 IDE_BALANCE_AMOUNT
       , Y.ACS_FINANCIAL_YEAR_ID
       , PERS.PAC_PERSON_ID
       , 0
       , 0
       , PACCUS.PER_NAME
       , PACSUP.PER_NAME
    from ACT_FINANCIAL_IMPUTATION IMP
       , ACT_DOCUMENT DOC
       , ACT_PART_IMPUTATION PAR
       , PAC_CUSTOM_PARTNER CUS
       , PAC_SUPPLIER_PARTNER SUP
       , PAC_PERSON PACCUS
       , PAC_PERSON PACSUP
       , ACS_PERIOD PER
       , ACS_FINANCIAL_YEAR Y
       , ACS_ACCOUNT_CATEG CATEG
       , ACS_ACCOUNT CG
       , PAC_PERSON PERS
   where IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
     AND DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID (+)
     AND PAR.PAC_CUSTOM_PARTNER_ID = CUS.PAC_CUSTOM_PARTNER_ID (+)
     AND CUS.PAC_CUSTOM_PARTNER_ID = PACCUS.PAC_PERSON_ID (+)
     AND PAR.PAC_SUPPLIER_PARTNER_ID = SUP.PAC_SUPPLIER_PARTNER_ID (+)
     AND SUP.PAC_SUPPLIER_PARTNER_ID = PACSUP.PAC_PERSON_ID (+)
     and IMP.PAC_PERSON_ID = PERS.PAC_PERSON_ID
     and PER.ACS_FINANCIAL_YEAR_ID = Y.ACS_FINANCIAL_YEAR_ID
     and IMP.ACS_FINANCIAL_ACCOUNT_ID = CG.ACS_ACCOUNT_ID
     and CG.ACS_ACCOUNT_CATEG_ID = CATEG.ACS_ACCOUNT_CATEG_ID
     and PER.C_TYPE_PERIOD = 2
  union all
  select   null ACT_DOCUMENT_ID
         , null act_financial_imputation_id
         , null ACS_ACCOUNT_ID
         , ACC_NUMBER ACC_NUMBER
         , des_description_summary IMF_DESCRIPTION
         , null IMF_TRANSACTION_DATE
         , null DOC_NUMBER
         , sum(IMF_AMOUNT_LC_D) IMF_AMOUNT_LC_D
         , sum(IMF_AMOUNT_LC_C) IMF_AMOUNT_LC_C
         , sum(IMF_AMOUNT_LC_D - IMF_AMOUNT_LC_C) IDE_BALANCE_AMOUNT
         , Y.ACS_FINANCIAL_YEAR_ID
         , PERS.PAC_PERSON_ID
         , grouping(DES_DESCRIPTION_SUMMARY)
         , grouping(ACC_NUMBER)
         , null
         , null
      from ACT_FINANCIAL_IMPUTATION IMP
         , ACT_DOCUMENT DOC
         , ACS_PERIOD PER
         , ACS_FINANCIAL_YEAR Y
         , ACS_ACCOUNT_CATEG CATEG
         , ACS_ACCOUNT CG
         , PAC_PERSON PERS
         , ACS_DESCRIPTION DESCR
     where IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
       and DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
       and IMP.PAC_PERSON_ID = PERS.PAC_PERSON_ID
       and CG.ACS_ACCOUNT_ID = DESCR.ACS_ACCOUNT_ID
       and DESCR.PC_LANG_ID = 1
       and PER.ACS_FINANCIAL_YEAR_ID = Y.ACS_FINANCIAL_YEAR_ID
       and IMP.ACS_FINANCIAL_ACCOUNT_ID = CG.ACS_ACCOUNT_ID
       and CG.ACS_ACCOUNT_CATEG_ID = CATEG.ACS_ACCOUNT_CATEG_ID
       and PER.C_TYPE_PERIOD = 2
       and acc_Number is not null
  group by rollup(acc_number, des_description_summary)
         , Y.ACS_FINANCIAL_YEAR_ID
         , PERS.PAC_PERSON_ID
    having grouping(DES_DESCRIPTION_SUMMARY) = 0
        or grouping(ACC_NUMBER) = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PAY_BALANCE_RPT" ("ACS_AUXILIARY_ACCOUNT_ID", "AUX_NUMBER", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "ACS_FINANCIAL_ACCOUNT_ID", "FIN_COLLECTIV", "ACS_DIVISION_ACCOUNT_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_SUB_SET", "PER_NO_PERIOD", "ACS_FINANCIAL_YEAR_ID", "FYE_NO_EXERCICE") AS
  SELECT
    AUX.ACS_AUXILIARY_ACCOUNT_ID,
    ACC.ACC_NUMBER AUX_NUMBER,
    TOT.ACS_FINANCIAL_CURRENCY_ID,
    (SELECT CUB.CURRENCY
     FROM   PCS.PC_CURR CUB,
            ACS_FINANCIAL_CURRENCY CMB
     WHERE  CMB.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_FINANCIAL_CURRENCY_ID and
            CUB.PC_CURR_ID                = CMB.PC_CURR_ID) CURRENCY_MB,
    TOT.TOT_DEBIT_LC,
    TOT.TOT_CREDIT_LC,
    TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
    (SELECT CUE.CURRENCY
     FROM   PCS.PC_CURR CUE,
            ACS_FINANCIAL_CURRENCY CME
     WHERE  CME.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_ACS_FINANCIAL_CURRENCY_ID and
            CUE.PC_CURR_ID                = CME.PC_CURR_ID) CURRENCY_ME,
    TOT.TOT_DEBIT_FC,
    TOT.TOT_CREDIT_FC,
    TOT.ACS_FINANCIAL_ACCOUNT_ID,
    (SELECT FIN.ACC_NUMBER
     FROM   ACS_ACCOUNT FIN
     WHERE  FIN.ACS_ACCOUNT_ID = TOT.ACS_FINANCIAL_ACCOUNT_ID) FIN_COLLECTIV,
    TOT.ACS_DIVISION_ACCOUNT_ID,
    TOT.ACS_PERIOD_ID,
    TOT.C_TYPE_PERIOD,
    TOT.C_TYPE_CUMUL,
    SUB.ACS_SUB_SET_ID,
    SUB.C_SUB_SET,
    PER.PER_NO_PERIOD,
    FYE.ACS_FINANCIAL_YEAR_ID,
    FYE.FYE_NO_EXERCICE
FROM
    ACS_FINANCIAL_YEAR    FYE,
    ACS_PERIOD            PER,
    ACS_SUB_SET           SUB,
    ACT_TOTAL_BY_PERIOD   TOT,
    ACS_FINANCIAL_ACCOUNT FIN,
    ACS_ACCOUNT           ACC,
    ACS_AUXILIARY_ACCOUNT AUX
WHERE
        AUX.ACS_AUXILIARY_ACCOUNT_ID  = TOT.ACS_AUXILIARY_ACCOUNT_ID
    and AUX.ACS_AUXILIARY_ACCOUNT_ID  = ACC.ACS_ACCOUNT_ID
    and TOT.ACS_FINANCIAL_ACCOUNT_ID  = FIN.ACS_FINANCIAL_ACCOUNT_ID
    and ACC.ACS_SUB_SET_ID            = SUB.ACS_SUB_SET_ID
    and SUB.C_SUB_SET                 = 'PAY'
    and ((TOT.ACS_DIVISION_ACCOUNT_ID is not null) or (TOT.ACS_DIVISION_ACCOUNT_ID is null and ACR_FUNCTIONS.ExistDivision = 0))
    and TOT.ACS_PERIOD_ID             = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID     = FYE.ACS_FINANCIAL_YEAR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PAY_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACC_NUMBER", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "MATCHING") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID
       , IMP.ACS_PERIOD_ID
       , IMP.ACT_DOCUMENT_ID
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_TYPE
       , IMP.IMF_PRIMARY
       , IMP.IMF_DESCRIPTION
       , IMP.IMF_AMOUNT_LC_D
       , IMP.IMF_AMOUNT_LC_C
       , IMP.IMF_EXCHANGE_RATE
       , IMP.IMF_AMOUNT_FC_D
       , IMP.IMF_AMOUNT_FC_C
       , IMP.IMF_AMOUNT_EUR_D
       , IMP.IMF_AMOUNT_EUR_C
       , IMP.IMF_VALUE_DATE
       , IMP.ACS_TAX_CODE_ID
       , IMP.IMF_TRANSACTION_DATE
       , IMP.ACS_FINANCIAL_CURRENCY_ID
       , IMP.C_GENRE_TRANSACTION
       , IMP.ACT_DET_PAYMENT_ID
       , IMP.ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMP.IMF_GENRE
       , IMP.IMF_BASE_PRICE
       , IMP.ACT_PART_IMPUTATION_ID
       , IMP.A_CONFIRM
       , IMP.A_DATECRE
       , IMP.A_DATEMOD
       , IMP.A_IDCRE
       , IMP.A_IDMOD
       , IMP.A_RECLEVEL
       , IMP.A_RECSTATUS
       , IMP.IMF_TEXT1
       , IMP.IMF_TEXT2
       , IMP.IMF_TEXT3
       , IMP.IMF_TEXT4
       , IMP.IMF_TEXT5
       , IMP.IMF_NUMBER
       , IMP.IMF_NUMBER2
       , IMP.IMF_NUMBER3
       , IMP.IMF_NUMBER4
       , IMP.IMF_NUMBER5
       , IMP.DIC_IMP_FREE1_ID
       , IMP.DIC_IMP_FREE2_ID
       , IMP.DIC_IMP_FREE3_ID
       , IMP.DIC_IMP_FREE4_ID
       , IMP.DIC_IMP_FREE5_ID
       , IMP.GCO_GOOD_ID
       , IMP.HRM_PERSON_ID
       , IMP.DOC_RECORD_ID
       , IMP.FAM_FIXED_ASSETS_ID
       , IMP.C_FAM_TRANSACTION_TYP
       , IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID
       , (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID
            from ACT_FINANCIAL_DISTRIBUTION DIS
           where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , AUX.ACC_NUMBER
       , IMP.ACS_AUXILIARY_ACCOUNT_ID
       , IMP.IMF_PAC_SUPPLIER_PARTNER_ID PAC_PERSON_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_JOURNAL_ID
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , (select JOU.JOU_DESCRIPTION
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION
       , (select COV.COV_NUMBER
            from ACT_COVER_INFORMATION COV
           where COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID) COV_NUMBER
       , (select PAR.PAR_DOCUMENT
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT
       , (select PAR.DOC_DATE_DELIVERY
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY
       , ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'PAY') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'PAY') C_TYPE_CUMUL
       , AUX.ACS_SUB_SET_ID
       , PER.C_TYPE_PERIOD
       , PER.PER_NO_PERIOD
       , ACR_FUNCTIONS.IsDocumentMatching(IMP.ACT_PART_IMPUTATION_ID) MATCHING
    from ACS_FINANCIAL_ACCOUNT FIN
       , ACT_DOCUMENT DOC
       , ACS_PERIOD PER
       , ACT_FINANCIAL_IMPUTATION IMP
       , ACS_ACCOUNT AUX
       , (select LID_FREE_NUMBER_1 ACS_AUXILIARY_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
       , (select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
            from COM_LIST_ID_TEMP
           where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') YEA
   where AUX.ACS_ACCOUNT_ID = TMP.ACS_AUXILIARY_ACCOUNT_ID
     and AUX.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID
     and IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and PER.ACS_FINANCIAL_YEAR_ID = YEA.ACS_FINANCIAL_YEAR_ID
     and IMP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and IMP.ACS_FINANCIAL_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
     and FIN.FIN_COLLECTIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PAY_IMP_REPORT" ("C_TYPE_PERIOD", "PER_NO_PERIOD", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "MATCHING") AS
  select C_TYPE_PERIOD
       , PER_NO_PERIOD
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , ACT_DOCUMENT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , IMF_TYPE
       , IMF_PRIMARY
       , IMF_DESCRIPTION
       , IMF_AMOUNT_LC_D
       , IMF_AMOUNT_LC_C
       , IMF_EXCHANGE_RATE
       , IMF_AMOUNT_FC_D
       , IMF_AMOUNT_FC_C
       , IMF_AMOUNT_EUR_D
       , IMF_AMOUNT_EUR_C
       , IMF_VALUE_DATE
       , ACS_TAX_CODE_ID
       , IMF_TRANSACTION_DATE
       , ACS_FINANCIAL_CURRENCY_ID
       , C_GENRE_TRANSACTION
       , ACS_AUXILIARY_ACCOUNT_ID
       , ACT_DET_PAYMENT_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMF_BASE_PRICE
       , ACT_PART_IMPUTATION_ID
       , ACC_NUMBER
       , ACT_FINANCIAL_DISTRIBUTION_ID
       , ACS_DIVISION_ACCOUNT_ID
       , DIV_NUMBER
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , FINANCIAL_IMPUTATION_ID
       , ACT_ACT_JOURNAL_ID
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
       , COV_NUMBER
       , PAR_DOCUMENT
       , DOC_DATE_DELIVERY
       , IMF_TEXT1
       , IMF_TEXT2
       , IMF_TEXT3
       , IMF_TEXT4
       , IMF_TEXT5
       , IMF_NUMBER
       , IMF_NUMBER2
       , IMF_NUMBER3
       , IMF_NUMBER4
       , IMF_NUMBER5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , GCO_GOOD_ID
       , HRM_PERSON_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , IMP_PAC_PERSON_ID
       , MATCHING
    from V_ACR_PAY_IMPUTATION
   where (C_TYPE_PERIOD <> '1')
      or (    C_TYPE_PERIOD = '1'
          and nvl( (select A.C_STATE_FINANCIAL_YEAR
                      from ACS_FINANCIAL_YEAR A
                         , ACS_FINANCIAL_YEAR B
                     where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                       and B.FYE_START_DATE = A.FYE_END_DATE + 1
                       and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                        from COM_LIST_ID_TEMP
                                                       where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
                , 'CLO'
                 ) = 'CLO'
         )
  union all
  select TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , TOT.ACS_PERIOD_ID
       , 0 ACT_DOCUMENT_ID
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , 'MAN' IMF_TYPE
       , 0 IMF_PRIMARY
       , 'Report' IMF_DESCRIPTION
       , TOT.TOT_DEBIT_LC IMF_AMOUNT_LC_D
       , TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C
       , 0 IMF_EXCHANGE_RATE
       , TOT.TOT_DEBIT_FC IMF_AMOUNT_FC_D
       , TOT.TOT_CREDIT_FC IMF_AMOUNT_FC_C
       , TOT.TOT_DEBIT_EUR IMF_AMOUNT_EUR_D
       , TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C
       , TOT.PER_START_DATE IMF_VALUE_DATE
       , 0 ACS_TAX_CODE_ID
       , TOT.PER_START_DATE IMF_TRANSACTION_DATE
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID
       , '1' C_GENRE_TRANSACTION
       , TOT.ACS_AUXILIARY_ACCOUNT_ID
       , 0 ACT_DET_PAYMENT_ID
       , TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMF_BASE_PRICE
       , 0 ACT_PART_IMPUTATION_ID
       , TOT.ACC_NUMBER
       , 0 ACT_FINANCIAL_DISTRIBUTION_ID
       , TOT.ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = TOT.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , 0 FINANCIAL_IMPUTATION_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
       , '' COV_NUMBER
       , null PAR_DOCUMENT
       , to_date(null) DOC_DATE_DELIVERY
       , '' IMF_TEXT1
       , '' IMF_TEXT2
       , '' IMF_TEXT3
       , '' IMF_TEXT4
       , '' IMF_TEXT5
       , 0 IMF_NUMBER
       , 0 IMF_NUMBER2
       , 0 IMF_NUMBER3
       , 0 IMF_NUMBER4
       , 0 IMF_NUMBER5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_IMP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 GCO_GOOD_ID
       , 0 HRM_PERSON_ID
       , 0 DOC_RECORD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 IMP_PAC_PERSON_ID
       , 0 MATCHING
    from V_ACR_PAY_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PAY_OUTSTANDING_BALANCE" ("PER_NAME", "EXP_ADAPTED", "DOC_NUMBER", "COV_NUMBER", "IMF_TRANSACTION_DATE", "PER_KEY1", "ACC_NUMBER", "ACS_FIN_ACC_S_PAYMENT_ID", "BALANCE_TYPE", "EXP_AMOUNT_LC", "DIFF_SUM_LC") AS
  select "PER_NAME","EXP_ADAPTED","DOC_NUMBER","COV_NUMBER","IMF_TRANSACTION_DATE","PER_KEY1","ACC_NUMBER","ACS_FIN_ACC_S_PAYMENT_ID","BALANCE_TYPE","EXP_AMOUNT_LC","DIFF_SUM_LC"
    from (select PERS.PER_NAME
               , to_char(COV.COV_EXPIRY_DATE, 'YYYY-MM-DD') EXP_ADAPTED
               , DOC.DOC_NUMBER
               , COV.COV_NUMBER
               , IMP.IMF_TRANSACTION_DATE
               , PERS.PER_KEY1
               , ACC.ACC_NUMBER
               , cov.ACS_FIN_ACC_S_PAYMENT_ID
               , 'COVER' BALANCE_TYPE
               , (COV.COV_AMOUNT_LC) EXP_AMOUNT_LC
               , (COV.COV_AMOUNT_LC) DIFF_SUM_LC
            from ACT_COVER_INFORMATION COV
               , ACT_FINANCIAL_IMPUTATION IMP
               , ACT_DOCUMENT DOC
               , PAC_PERSON PERS
               , ACS_ACCOUNT ACC
           where COV.PAC_SUPPLIER_PARTNER_ID = PERS.PAC_PERSON_ID
             and COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID
             and COV.C_COVER_STATUS = '1'
             and IMP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
             and IMP.IMF_PRIMARY = 1
             and IMP.IMF_TRANSACTION_DATE <= ACT_FUNCTIONS.GetAnalyse_Date
             and ACC.ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID
             and not exists(
                   select 1
                     from ACT_FINANCIAL_IMPUTATION FIN2
                        , ACT_COVER_DISCHARGED DISCH
                    where DISCH.ACT_COVER_INFORMATION_ID = COV.ACT_COVER_INFORMATION_ID
                      and DISCH.ACT_FINANCIAL_IMPUTATION_ID = FIN2.ACT_FINANCIAL_IMPUTATION_ID
                      and FIN2.IMF_TRANSACTION_DATE <= ACT_FUNCTIONS.GetAnalyse_Date) )
  union
  (select PERS.PER_NAME
        , to_char(v.EXP_ADAPTED, 'YYYY-MM-DD') EXP_ADAPTED
        , V.DOC_NUMBER
        , V.PAR_DOCUMENT COV_NUMBER
        , V.IMF_TRANSACTION_DATE
        , PERS.PER_KEY1
        , ACC.ACC_NUMBER
        , v.ACS_FIN_ACC_S_PAYMENT_ID
        , 'PO' BALANCE_TYPE
        , -EXP_AMOUNT_LC
        , -(V.EXP_AMOUNT_LC - V.DET_PAIED_LC) DIFF_SUM_LC
     from V_ACT_EXPIRY_THIRD V
        , ACS_ACCOUNT ACC
        , PAC_PERSON PERS
        , ACS_ACCOUNT AUX
        , ACS_SUB_SET SUB
    where V.ACS_AUXILIARY_ACCOUNT_ID = AUX.ACS_ACCOUNT_ID
      and AUX.ACS_SUB_SET_ID = SUB.ACS_SUB_SET_ID
      and SUB.C_SUB_SET = 'PAY'
      and V.C_TYPE_CUMUL = 'EXT'
      and ACC.ACS_ACCOUNT_ID = V.ACS_FINANCIAL_ACCOUNT_ID
      and PERS.PAC_PERSON_ID = V.PAC_PERSON_ID)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PAY_PREV_YEAR_TOTAL" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE", "PER_NO_PERIOD", "C_TYPE_PERIOD") AS
  select   TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_DEBIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_CREDIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_DEBIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_CREDIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_DEBIT_EUR
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_CREDIT_EUR
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.PER_NO_PERIOD
         , PER.C_TYPE_PERIOD
      from ACS_ACCOUNT ACC
         , ACT_TOTAL_BY_PERIOD TOT
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where ACC.ACS_ACCOUNT_ID = TMP.LID_FREE_NUMBER_1
       and exists(select 1
                    from ACS_SUB_SET SUB
                   where SUB.C_SUB_SET = 'PAY'
                     and SUB.ACS_SUB_SET_ID = ACC.ACS_SUB_SET_ID)
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
       --and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.C_TYPE_PERIOD = '1'
       and TOT.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
       and (    (TOT.ACS_DIVISION_ACCOUNT_ID is not null)
            or (    TOT.ACS_DIVISION_ACCOUNT_ID is null
                and ACR_FUNCTIONS.ExistDivision = 0)
           )
  group by TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.PER_NO_PERIOD
         , PER.C_TYPE_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PERIOD_AUX" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "DES_DESCRIPTION_SUMMARY", "PC_LANG_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_DIVISION_ACCOUNT_ID") AS
  select
       ACC.ACS_AUXILIARY_ACCOUNT_ID,
       PER.ACS_PERIOD_ID,
       PER.ACS_FINANCIAL_YEAR_ID,
       PER.PER_NO_PERIOD,
       PER.C_STATE_PERIOD,
       DES.DES_DESCRIPTION_SUMMARY,
       DES.PC_LANG_ID,
       CUR.ACS_FINANCIAL_CURRENCY_ID,
       ACR_FUNCTIONS.GetDivisionId
  from
        ACS_PERIOD PER,
        ACS_DESCRIPTION DES,
        ACS_AUXILIARY_ACCOUNT ACC,
        ACS_AUX_ACCOUNT_S_FIN_CURR CUR
  where
        PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinancialYearId
    and PER.ACS_PERIOD_ID         = DES.ACS_PERIOD_ID
    and DES.PC_LANG_ID            = PCS.PC_I_LIB_SESSION.GetUserLangId
    and ACC.ACS_AUXILIARY_ACCOUNT_ID = ACR_FUNCTIONS.GetAccountId
    and CUR.ACS_AUXILIARY_ACCOUNT_ID = ACR_FUNCTIONS.GetAccountId


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PERIOD_DIV" ("ACS_DIVISION_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "DES_DESCRIPTION_SUMMARY", "PC_LANG_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_ACCOUNT_ID") AS
  select
       ACR_FUNCTIONS.GetAccountId,
       PER.ACS_PERIOD_ID,
       PER.ACS_FINANCIAL_YEAR_ID,
       PER.PER_NO_PERIOD,
       PER.C_STATE_PERIOD,
       DES.DES_DESCRIPTION_SUMMARY,
       DES.PC_LANG_ID,
       CUR.ACS_FINANCIAL_CURRENCY_ID,
       FIN.ACS_FINANCIAL_ACCOUNT_ID
  from
        ACS_FINANCIAL_CURRENCY CUR,
        ACS_FINANCIAL_ACCOUNT FIN,
        ACS_DESCRIPTION DES,
        ACS_PERIOD PER
  where
        PER.ACS_FINANCIAL_YEAR_ID   = ACR_FUNCTIONS.GetFinancialYearId
    and PER.ACS_PERIOD_ID           = DES.ACS_PERIOD_ID
    and DES.PC_LANG_ID              = PCS.PC_I_LIB_SESSION.GetUserLangId


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PERIOD_FIN" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "DES_DESCRIPTION_SUMMARY", "PC_LANG_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_DIVISION_ACCOUNT_ID") AS
  select
       ACC.ACS_FINANCIAL_ACCOUNT_ID,
       PER.ACS_PERIOD_ID,
       PER.ACS_FINANCIAL_YEAR_ID,
       PER.PER_NO_PERIOD,
       PER.C_STATE_PERIOD,
       DES.DES_DESCRIPTION_SUMMARY,
       DES.PC_LANG_ID,
       CUR.ACS_FINANCIAL_CURRENCY_ID,
       ACR_FUNCTIONS.GetDivisionId
  from
        ACS_PERIOD PER,
        ACS_DESCRIPTION DES,
        ACS_FINANCIAL_ACCOUNT ACC,
        ACS_FIN_ACCOUNT_S_FIN_CURR CUR
  where
        PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinancialYearId
    and PER.ACS_PERIOD_ID         = DES.ACS_PERIOD_ID
    and DES.PC_LANG_ID            = PCS.PC_I_LIB_SESSION.GetUserLangId
    and ACC.ACS_FINANCIAL_ACCOUNT_ID = ACR_FUNCTIONS.GetAccountId
    and CUR.ACS_FINANCIAL_ACCOUNT_ID = ACR_FUNCTIONS.GetAccountId


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PF_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select MGM.ACT_MGM_IMPUTATION_ID
       , MGM.ACT_FINANCIAL_IMPUTATION_ID
       , MGM.ACS_PERIOD_ID
       , (select PER.C_TYPE_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) C_TYPE_PERIOD
       , (select PER.PER_NO_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) PER_NO_PERIOD
       , MGM.IMM_VALUE_DATE
       , MGM.IMM_TRANSACTION_DATE
       , MGM.IMM_TYPE
       , MGM.IMM_GENRE
       , MGM.IMM_PRIMARY
       , MGM.IMM_DESCRIPTION
       , MGM.ACS_CPN_ACCOUNT_ID
       , MGM.ACS_CDA_ACCOUNT_ID
       , MGM.ACS_PF_ACCOUNT_ID
       , DIS.ACS_PJ_ACCOUNT_ID
       , MGM.ACS_QTY_UNIT_ID
       , nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D
       , nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C
       , nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D
       , nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C
       , nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D
       , nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C
       , MGM.ACS_FINANCIAL_CURRENCY_ID
       , MGM.ACS_ACS_FINANCIAL_CURRENCY_ID
       , MGM.IMM_EXCHANGE_RATE
       , MGM.IMM_BASE_PRICE
       , MGM.ACT_DOCUMENT_ID
       , MGM.IMM_NUMBER
       , MGM.IMM_NUMBER2
       , MGM.IMM_NUMBER3
       , MGM.IMM_NUMBER4
       , MGM.IMM_NUMBER5
       , MGM.IMM_TEXT1
       , MGM.IMM_TEXT2
       , MGM.IMM_TEXT3
       , MGM.IMM_TEXT4
       , MGM.IMM_TEXT5
       , MGM.DIC_IMP_FREE1_ID
       , MGM.DIC_IMP_FREE2_ID
       , MGM.DIC_IMP_FREE3_ID
       , MGM.DIC_IMP_FREE4_ID
       , MGM.DIC_IMP_FREE5_ID
       , MGM.HRM_PERSON_ID
       , MGM.GCO_GOOD_ID
       , MGM.DOC_RECORD_ID
       , MGM.FAM_FIXED_ASSETS_ID
       , MGM.C_FAM_TRANSACTION_TYP
       , MGM.PAC_PERSON_ID
       , (select IMP.ACS_FINANCIAL_ACCOUNT_ID
            from ACT_FINANCIAL_IMPUTATION IMP
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = MGM.ACT_FINANCIAL_IMPUTATION_ID) ACS_FINANCIAL_ACCOUNT_ID
       , (select ACC_NUMBER
            from ACS_ACCOUNT
           where ACS_ACCOUNT_ID = TMP.ACS_ACCOUNT_ID) ACC_NUMBER
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , JOU.ACT_JOURNAL_ID
       , JOU.JOU_NUMBER
       , JOU.JOU_DESCRIPTION
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'CPN') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'CPN') C_TYPE_CUMUL
    from ACT_JOURNAL JOU
       , ACT_DOCUMENT DOC
       , ACT_MGM_IMPUTATION MGM
       , ACT_MGM_DISTRIBUTION DIS
       , (select LID_FREE_NUMBER_1 ACS_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
   where TMP.ACS_ACCOUNT_ID = MGM.ACS_PF_ACCOUNT_ID
     and MGM.ACT_MGM_IMPUTATION_ID = DIS.ACT_MGM_IMPUTATION_ID(+)
     and MGM.ACS_PERIOD_ID in(select ACS_PERIOD_ID
                                from ACS_PERIOD PER
                               where PER.ACS_FINANCIAL_YEAR_ID in(select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
                                                                    from COM_LIST_ID_TEMP
                                                                   where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
     and MGM.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACT_ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PF_IMPUTATION_DET" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "PF_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACC_DETAIL_PRINTING", "FIN_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PJ_NUMBER") AS
  SELECT
  V.ACT_MGM_IMPUTATION_ID,
  V.ACT_FINANCIAL_IMPUTATION_ID,
  V.ACS_PERIOD_ID,
  V.IMM_VALUE_DATE,
  V.IMM_TRANSACTION_DATE,
  V.IMM_TYPE,
  V.IMM_GENRE,
  V.IMM_PRIMARY,
  V.IMM_DESCRIPTION,
  V.ACS_CDA_ACCOUNT_ID,
  V.ACS_CPN_ACCOUNT_ID,
  NVL (V.ACS_PF_ACCOUNT_ID,PF.ACS_PF_ACCOUNT_ID) ACS_PF_ACCOUNT_ID,
  V.ACS_PJ_ACCOUNT_ID,
  V.ACS_QTY_UNIT_ID,
  V.IMM_QUANTITY_D,
  V.IMM_QUANTITY_C,
  V.IMM_AMOUNT_LC_D,
  V.IMM_AMOUNT_LC_C,
  V.IMM_AMOUNT_FC_D,
  V.IMM_AMOUNT_FC_C,
  V.IMM_AMOUNT_EUR_D,
  V.IMM_AMOUNT_EUR_C,
  V.ACS_FINANCIAL_CURRENCY_ID,
  V.ACS_ACS_FINANCIAL_CURRENCY_ID,
  V.IMM_EXCHANGE_RATE,
  V.IMM_BASE_PRICE,
  V.ACS_FINANCIAL_ACCOUNT_ID,
  NVL (V.ACC_NUMBER, ACS_FUNCTION.GETACCOUNTNUMBER(PF.ACS_PF_ACCOUNT_ID)) PF_NUMBER,
  V.IMM_NUMBER,
  V.IMM_NUMBER2,
  V.IMM_NUMBER3,
  V.IMM_NUMBER4,
  V.IMM_NUMBER5,
  V.IMM_TEXT1,
  V.IMM_TEXT2,
  V.IMM_TEXT3,
  V.IMM_TEXT4,
  V.IMM_TEXT5,
  V.DIC_IMP_FREE1_ID,
  V.DIC_IMP_FREE2_ID,
  V.DIC_IMP_FREE3_ID,
  V.DIC_IMP_FREE4_ID,
  V.DIC_IMP_FREE5_ID,
  V.HRM_PERSON_ID,
  V.GCO_GOOD_ID,
  V.DOC_RECORD_ID,
  V.FAM_FIXED_ASSETS_ID,
  V.C_FAM_TRANSACTION_TYP,
  V.PAC_PERSON_ID,
  V.ACT_DOCUMENT_ID,
  V.DOC_NUMBER,
  V.ACJ_CATALOGUE_DOCUMENT_ID,
  V.ACT_ACT_JOURNAL_ID,
  V.ACT_JOURNAL_ID,
  V.JOU_NUMBER,
  V.JOU_DESCRIPTION,
  V.C_ETAT_JOURNAL,
  V.C_TYPE_CUMUL,
  (SELECT
   ACC.ACC_DETAIL_PRINTING FROM
   ACS_ACCOUNT ACC
   WHERE
   ACC.ACS_ACCOUNT_ID = PF.ACS_PF_ACCOUNT_ID) ACC_DETAIL_PRINTING,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_FINANCIAL_ACCOUNT_ID) FIN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_CPN_ACCOUNT_ID) CPN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_CDA_ACCOUNT_ID) CDA_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_PJ_ACCOUNT_ID) PJ_NUMBER
 FROM
 ACS_PF_ACCOUNT PF,
 V_ACT_PF_IMP_REPORT V
 WHERE
 PF.ACS_PF_ACCOUNT_ID = V.ACS_PF_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PF_IMPUTATION_DET_RPT" ("IMM_TRANSACTION_DATE", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "ACS_PF_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "FYE_NO_EXERCICE") AS
  SELECT
  MGM.IMM_TRANSACTION_DATE IMM_TRANSACTION_DATE,
  MGM.IMM_AMOUNT_LC_D IMM_AMOUNT_LC_D,
  MGM.IMM_AMOUNT_LC_C IMM_AMOUNT_LC_C,
  MGM.IMM_AMOUNT_FC_D IMM_AMOUNT_FC_D,
  MGM.IMM_AMOUNT_FC_C IMM_AMOUNT_FC_C,
  MGM.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  MGM.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  MGM.ACS_PF_ACCOUNT_ID ACS_PF_ACCOUNT_ID,
  MGM.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_IMPUTATION    MGM
WHERE
  MGM.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID
UNION ALL
SELECT
  FYE.FYE_START_DATE IMM_TRANSACTION_DATE,
  TOT.MTO_DEBIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_CREDIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_DEBIT_FC IMM_AMOUNT_FC_D,
  TOT.MTO_CREDIT_FC IMM_AMOUNT_FC_C,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  TOT.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  TOT.ACS_PF_ACCOUNT_ID ACS_PF_ACCOUNT_ID,
  TOT.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_TOT_BY_PERIOD TOT
WHERE
  TOT.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  ACS_FUNCTION.GetStatePreviousFinancialYear(FYE.ACS_FINANCIAL_YEAR_ID) = 'ACT' AND
  PER.C_TYPE_PERIOD         = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PF_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_PF_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "ACT_DOCUMENT_ID", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select ACT_MGM_IMPUTATION_ID
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , C_TYPE_PERIOD
       , PER_NO_PERIOD
       , IMM_VALUE_DATE
       , IMM_TRANSACTION_DATE
       , IMM_TYPE
       , IMM_GENRE
       , IMM_PRIMARY
       , IMM_DESCRIPTION
       , ACS_PF_ACCOUNT_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_QTY_UNIT_ID
       , IMM_QUANTITY_D
       , IMM_QUANTITY_C
       , IMM_AMOUNT_LC_D
       , IMM_AMOUNT_LC_C
       , IMM_AMOUNT_FC_D
       , IMM_AMOUNT_FC_C
       , ACS_FINANCIAL_CURRENCY_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMM_EXCHANGE_RATE
       , IMM_BASE_PRICE
       , ACS_FINANCIAL_ACCOUNT_ID
       , ACC_NUMBER
       , IMM_NUMBER
       , IMM_NUMBER2
       , IMM_NUMBER3
       , IMM_NUMBER4
       , IMM_NUMBER5
       , IMM_TEXT1
       , IMM_TEXT2
       , IMM_TEXT3
       , IMM_TEXT4
       , IMM_TEXT5
       , ACT_DOCUMENT_ID
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , HRM_PERSON_ID
       , GCO_GOOD_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_ACT_JOURNAL_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , JOU_DESCRIPTION
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
    from V_ACR_PF_IMPUTATIONS


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PJ_IMPUTATIONS" ("ACT_MGM_DISTRIBUTION_ID", "ACS_SUB_SET_ID", "ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "MGM_DESCRIPTION", "MGM_NUMBER", "MGM_NUMBER2", "MGM_TEXT1", "MGM_TEXT2", "MGM_TEXT3", "MGM_TEXT4", "MGM_TEXT5", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select DIS.ACT_MGM_DISTRIBUTION_ID
       , DIS.ACS_SUB_SET_ID
       , MGM.ACT_MGM_IMPUTATION_ID
       , MGM.ACT_FINANCIAL_IMPUTATION_ID
       , MGM.ACS_PERIOD_ID
       , (select PER.C_TYPE_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) C_TYPE_PERIOD
       , (select PER.PER_NO_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) PER_NO_PERIOD
       , MGM.IMM_VALUE_DATE
       , MGM.IMM_TRANSACTION_DATE
       , MGM.IMM_TYPE
       , MGM.IMM_GENRE
       , MGM.IMM_PRIMARY
       , MGM.ACS_CPN_ACCOUNT_ID
       , MGM.ACS_CDA_ACCOUNT_ID
       , MGM.ACS_PF_ACCOUNT_ID
       , DIS.ACS_PJ_ACCOUNT_ID
       , MGM.ACS_QTY_UNIT_ID
       , nvl(DIS.MGM_QUANTITY_D, 0) MGM_QUANTITY_D
       , nvl(DIS.MGM_QUANTITY_C, 0) MGM_QUANTITY_C
       , nvl(DIS.MGM_AMOUNT_LC_D, 0) MGM_AMOUNT_LC_D
       , nvl(DIS.MGM_AMOUNT_LC_C, 0) MGM_AMOUNT_LC_C
       , nvl(DIS.MGM_AMOUNT_FC_D, 0) MGM_AMOUNT_FC_D
       , nvl(DIS.MGM_AMOUNT_FC_C, 0) MGM_AMOUNT_FC_C
       , MGM.ACS_FINANCIAL_CURRENCY_ID
       , MGM.ACS_ACS_FINANCIAL_CURRENCY_ID
       , MGM.IMM_EXCHANGE_RATE
       , MGM.IMM_BASE_PRICE
       , DIS.MGM_DESCRIPTION
       , DIS.MGM_NUMBER
       , DIS.MGM_NUMBER2
       , DIS.MGM_TEXT1
       , DIS.MGM_TEXT2
       , DIS.MGM_TEXT3
       , DIS.MGM_TEXT4
       , DIS.MGM_TEXT5
       , MGM.ACT_DOCUMENT_ID
       , MGM.IMM_NUMBER
       , MGM.IMM_NUMBER2
       , MGM.IMM_NUMBER3
       , MGM.IMM_NUMBER4
       , MGM.IMM_NUMBER5
       , MGM.IMM_TEXT1
       , MGM.IMM_TEXT2
       , MGM.IMM_TEXT3
       , MGM.IMM_TEXT4
       , MGM.IMM_TEXT5
       , MGM.DIC_IMP_FREE1_ID
       , MGM.DIC_IMP_FREE2_ID
       , MGM.DIC_IMP_FREE3_ID
       , MGM.DIC_IMP_FREE4_ID
       , MGM.DIC_IMP_FREE5_ID
       , MGM.HRM_PERSON_ID
       , MGM.GCO_GOOD_ID
       , MGM.DOC_RECORD_ID
       , MGM.FAM_FIXED_ASSETS_ID
       , MGM.C_FAM_TRANSACTION_TYP
       , MGM.PAC_PERSON_ID
       , (select IMP.ACS_FINANCIAL_ACCOUNT_ID
            from ACT_FINANCIAL_IMPUTATION IMP
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = MGM.ACT_FINANCIAL_IMPUTATION_ID) ACS_FINANCIAL_ACCOUNT_ID
       , (select ACC_NUMBER
            from ACS_ACCOUNT
           where ACS_ACCOUNT_ID = TMP.ACS_ACCOUNT_ID) ACC_NUMBER
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , JOU.ACT_JOURNAL_ID
       , JOU.JOU_NUMBER
       , JOU.JOU_DESCRIPTION
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'CPN') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'CPN') C_TYPE_CUMUL
    from ACT_JOURNAL JOU
       , ACT_DOCUMENT DOC
       , ACT_MGM_IMPUTATION MGM
       , ACT_MGM_DISTRIBUTION DIS
       , (select LID_FREE_NUMBER_1 ACS_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
   where TMP.ACS_ACCOUNT_ID = DIS.ACS_PJ_ACCOUNT_ID
     and MGM.ACT_MGM_IMPUTATION_ID = DIS.ACT_MGM_IMPUTATION_ID
     and MGM.ACS_PERIOD_ID in(select ACS_PERIOD_ID
                                from ACS_PERIOD PER
                               where PER.ACS_FINANCIAL_YEAR_ID in(select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
                                                                    from COM_LIST_ID_TEMP
                                                                   where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
     and MGM.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and nvl(DOC.ACT_ACT_JOURNAL_ID, DOC.ACT_JOURNAL_ID) = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PJ_IMPUTATION_DET" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "MGM_DESCRIPTION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "MGM_AMOUNT_EUR_D", "MGM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "PJ_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "MGM_TEXT1", "MGM_TEXT2", "MGM_TEXT3", "MGM_TEXT4", "MGM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACC_DETAIL_PRINTING", "FIN_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER") AS
  SELECT
  V.ACT_MGM_IMPUTATION_ID,
  V.ACT_FINANCIAL_IMPUTATION_ID,
  V.ACS_PERIOD_ID,
  V.IMM_VALUE_DATE,
  V.IMM_TRANSACTION_DATE,
  V.IMM_TYPE,
  V.IMM_GENRE,
  V.IMM_PRIMARY,
  V.MGM_DESCRIPTION,
  V.ACS_CDA_ACCOUNT_ID,
  V.ACS_CPN_ACCOUNT_ID,
  NVL (V.ACS_PJ_ACCOUNT_ID,PJ.ACS_PJ_ACCOUNT_ID) ACS_PJ_ACCOUNT_ID,
  V.ACS_PF_ACCOUNT_ID,
  V.ACS_QTY_UNIT_ID,
  V.MGM_QUANTITY_D,
  V.MGM_QUANTITY_C,
  V.MGM_AMOUNT_LC_D,
  V.MGM_AMOUNT_LC_C,
  V.MGM_AMOUNT_FC_D,
  V.MGM_AMOUNT_FC_C,
  V.MGM_AMOUNT_EUR_D,
  V.MGM_AMOUNT_EUR_C,
  V.ACS_FINANCIAL_CURRENCY_ID,
  V.ACS_ACS_FINANCIAL_CURRENCY_ID,
  V.IMM_EXCHANGE_RATE,
  V.IMM_BASE_PRICE,
  V.ACS_FINANCIAL_ACCOUNT_ID,
  NVL (V.ACC_NUMBER, ACS_FUNCTION.GETACCOUNTNUMBER(PJ.ACS_PJ_ACCOUNT_ID)) PJ_NUMBER,
  V.IMM_NUMBER,
  V.IMM_NUMBER2,
  V.IMM_NUMBER3,
  V.IMM_NUMBER4,
  V.IMM_NUMBER5,
  V.MGM_TEXT1,
  V.MGM_TEXT2,
  V.MGM_TEXT3,
  V.MGM_TEXT4,
  V.MGM_TEXT5,
  V.DIC_IMP_FREE1_ID,
  V.DIC_IMP_FREE2_ID,
  V.DIC_IMP_FREE3_ID,
  V.DIC_IMP_FREE4_ID,
  V.DIC_IMP_FREE5_ID,
  V.HRM_PERSON_ID,
  V.GCO_GOOD_ID,
  V.DOC_RECORD_ID,
  V.FAM_FIXED_ASSETS_ID,
  V.C_FAM_TRANSACTION_TYP,
  V.PAC_PERSON_ID,
  V.ACT_DOCUMENT_ID,
  V.DOC_NUMBER,
  V.ACJ_CATALOGUE_DOCUMENT_ID,
  V.ACT_ACT_JOURNAL_ID,
  V.ACT_JOURNAL_ID,
  V.JOU_NUMBER,
  V.JOU_DESCRIPTION,
  V.C_ETAT_JOURNAL,
  V.C_TYPE_CUMUL,
  (SELECT
   ACC.ACC_DETAIL_PRINTING FROM
   ACS_ACCOUNT ACC
   WHERE
   ACC.ACS_ACCOUNT_ID = PJ.ACS_PJ_ACCOUNT_ID) ACC_DETAIL_PRINTING,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_FINANCIAL_ACCOUNT_ID) FIN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_CPN_ACCOUNT_ID) CPN_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_CDA_ACCOUNT_ID) CDA_NUMBER,
  ACS_FUNCTION.GETACCOUNTNUMBER(V.ACS_PF_ACCOUNT_ID) PF_NUMBER
 FROM
 ACS_PJ_ACCOUNT PJ,
 V_ACT_PJ_IMP_REPORT V
 WHERE
 PJ.ACS_PJ_ACCOUNT_ID = V.ACS_PJ_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PJ_IMPUTATION_DET_RPT" ("IMM_TRANSACTION_DATE", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "FYE_NO_EXERCICE") AS
  SELECT
  MGM.IMM_TRANSACTION_DATE IMM_TRANSACTION_DATE,
  DIS.MGM_AMOUNT_LC_D MGM_AMOUNT_LC_D,
  DIS.MGM_AMOUNT_LC_C MGM_AMOUNT_LC_C,
  DIS.MGM_AMOUNT_FC_D MGM_AMOUNT_FC_D,
  DIS.MGM_AMOUNT_FC_C MGM_AMOUNT_FC_C,
  MGM.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  MGM.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(MGM.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  DIS.ACS_PJ_ACCOUNT_ID ACS_PJ_ACCOUNT_ID,
  MGM.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_DISTRIBUTION	DIS,
  ACT_MGM_IMPUTATION    MGM
WHERE
  MGM.ACT_MGM_IMPUTATION_ID	= DIS.ACT_MGM_IMPUTATION_ID AND
  MGM.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID
UNION ALL
SELECT
  FYE.FYE_START_DATE IMM_TRANSACTION_DATE,
  TOT.MTO_DEBIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_CREDIT_LC IMM_AMOUNT_LC_D,
  TOT.MTO_DEBIT_FC IMM_AMOUNT_FC_D,
  TOT.MTO_CREDIT_FC IMM_AMOUNT_FC_C,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_ACS_FINANCIAL_CURRENCY_ID) CURRENCY_MB,
  TOT.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
  ACS_FUNCTION.GetCurrencyName(TOT.ACS_FINANCIAL_CURRENCY_ID) CURRENCY_ME,
  TOT.ACS_PJ_ACCOUNT_ID ACS_PJ_ACCOUNT_ID,
  TOT.ACS_CPN_ACCOUNT_ID ACS_CPN_ACCOUNT_ID,
  FYE.FYE_NO_EXERCICE FYE_NO_EXERCICE
FROM
  ACS_PERIOD            PER,
  ACS_FINANCIAL_YEAR    FYE,
  ACT_MGM_TOT_BY_PERIOD TOT
WHERE
  TOT.ACS_PERIOD_ID         = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  ACS_FUNCTION.GetStatePreviousFinancialYear(FYE.ACS_FINANCIAL_YEAR_ID) = 'ACT' AND
  PER.C_TYPE_PERIOD         = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PJ_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACT_MGM_DISTRIBUTION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "MGM_DESCRIPTION", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "MGM_NUMBER", "MGM_NUMBER2", "MGM_TEXT1", "MGM_TEXT2", "MGM_TEXT3", "MGM_TEXT4", "MGM_TEXT5", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID") AS
  select ACT_MGM_IMPUTATION_ID
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACT_MGM_DISTRIBUTION_ID
       , ACS_PERIOD_ID
       , C_TYPE_PERIOD
       , PER_NO_PERIOD
       , IMM_VALUE_DATE
       , IMM_TRANSACTION_DATE
       , IMM_TYPE
       , IMM_GENRE
       , IMM_PRIMARY
       , MGM_DESCRIPTION
       , ACS_PJ_ACCOUNT_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_QTY_UNIT_ID
       , MGM_QUANTITY_D
       , MGM_QUANTITY_C
       , MGM_AMOUNT_LC_D
       , MGM_AMOUNT_LC_C
       , MGM_AMOUNT_FC_D
       , MGM_AMOUNT_FC_C
       , ACS_FINANCIAL_CURRENCY_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMM_EXCHANGE_RATE
       , IMM_BASE_PRICE
       , ACS_FINANCIAL_ACCOUNT_ID
       , ACC_NUMBER
       , MGM_NUMBER
       , MGM_NUMBER2
       , MGM_TEXT1
       , MGM_TEXT2
       , MGM_TEXT3
       , MGM_TEXT4
       , MGM_TEXT5
       , ACT_DOCUMENT_ID
       , IMM_NUMBER
       , IMM_NUMBER2
       , IMM_NUMBER3
       , IMM_NUMBER4
       , IMM_NUMBER5
       , IMM_TEXT1
       , IMM_TEXT2
       , IMM_TEXT3
       , IMM_TEXT4
       , IMM_TEXT5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , HRM_PERSON_ID
       , GCO_GOOD_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_ACT_JOURNAL_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , JOU_DESCRIPTION
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
       , ACS_SUB_SET_ID
    from V_ACR_PJ_IMPUTATIONS
   where (C_TYPE_PERIOD <> '1')
      or (    C_TYPE_PERIOD = '1'
          and nvl( (select A.C_STATE_FINANCIAL_YEAR
                      from ACS_FINANCIAL_YEAR A
                         , ACS_FINANCIAL_YEAR B
                     where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                       and B.FYE_START_DATE = A.FYE_END_DATE + 1
                       and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                        from COM_LIST_ID_TEMP
                                                       where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
                , 'CLO'
                 ) = 'CLO'
         )
  union all
  select 0 ACT_MGM_IMPUTATION_ID
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , 0 ACT_MGM_DISTRIBUTION_ID
       , TOT.ACS_PERIOD_ID
       , TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , TOT.IMM_VALUE_DATE
       , TOT.IMM_TRANSACTION_DATE
       , 'MAN' IMM_TYPE
       , 'MAN' IMM_GENRE
       , 0 IMM_PRIMARY
       , 'Report' MGM_DESCRIPTION
       , TOT.ACS_PJ_ACCOUNT_ID
       , TOT.ACS_CPN_ACCOUNT_ID
       , TOT.ACS_CDA_ACCOUNT_ID
       , TOT.ACS_PF_ACCOUNT_ID
       , TOT.ACS_QTY_UNIT_ID
       , TOT.MGM_QUANTITY_D
       , TOT.MGM_QUANTITY_C
       , TOT.MGM_AMOUNT_LC_D
       , TOT.MGM_AMOUNT_LC_C
       , TOT.MGM_AMOUNT_FC_D
       , TOT.MGM_AMOUNT_FC_C
       , TOT.ACS_FINANCIAL_CURRENCY_ID
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMM_EXCHANGE_RATE
       , 0 IMM_BASE_PRICE
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , '' ACC_NUMBER
       , 0 MGM_NUMBER
       , 0 MGM_NUMBER2
       , '' MGM_TEXT1
       , '' MGM_TEXT2
       , '' MGM_TEXT3
       , '' MGM_TEXT4
       , '' MGM_TEXT5
       , 0 ACT_DOCUMENT_ID
       , 0 IMM_NUMBER
       , 0 IMM_NUMBER2
       , 0 IMM_NUMBER3
       , 0 IMM_NUMBER4
       , 0 IMM_NUMBER5
       , '' IMM_TEXT1
       , '' IMM_TEXT2
       , '' IMM_TEXT3
       , '' IMM_TEXT4
       , '' IMM_TEXT5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_IMP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 HRM_PERSON_ID
       , 0 GCO_GOOD_ID
       , TOT.DOC_RECORD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 PAC_PERSON_ID
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , '' JOU_DESCRIPTION
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
       , 0 ACS_SUB_SET_ID
    from V_ACR_PJ_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_PJ_PREV_YEAR_TOTAL" ("C_TYPE_PERIOD", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "PER_NO_PERIOD", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "DOC_RECORD_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select   PER.C_TYPE_PERIOD
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE IMM_VALUE_DATE
         , PER.PER_START_DATE IMM_TRANSACTION_DATE
         , PER.PER_NO_PERIOD
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_PJ_ACCOUNT_ID
         , TOT.ACS_CPN_ACCOUNT_ID
         , TOT.ACS_CDA_ACCOUNT_ID
         , TOT.ACS_PF_ACCOUNT_ID
         , TOT.DOC_RECORD_ID
         , TOT.ACS_QTY_UNIT_ID
         , decode(sign(nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0)
                 ) MGM_QUANTITY_D
         , decode(sign(nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0)
                 ) MGM_QUANTITY_C
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0)
                 ) MGM_AMOUNT_LC_D
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0)
                 ) MGM_AMOUNT_LC_C
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0)
                 ) MGM_AMOUNT_FC_D
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0)
                 ) MGM_AMOUNT_FC_C
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
      from ACT_MGM_TOT_BY_PERIOD TOT
         , ACS_ACCOUNT ACC
         , ACS_PJ_ACCOUNT PJ
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where ACC.ACS_ACCOUNT_ID = TMP.LID_FREE_NUMBER_1
       and ACC.ACS_ACCOUNT_ID = PJ.ACS_PJ_ACCOUNT_ID
       and PJ.ACS_PJ_ACCOUNT_ID = TOT.ACS_PJ_ACCOUNT_ID
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
--    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.C_TYPE_PERIOD = '1'
  group by TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_PJ_ACCOUNT_ID
         , TOT.ACS_CPN_ACCOUNT_ID
         , TOT.ACS_CDA_ACCOUNT_ID
         , TOT.ACS_PF_ACCOUNT_ID
         , TOT.DOC_RECORD_ID
         , TOT.ACS_QTY_UNIT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.C_TYPE_PERIOD
         , PER.PER_NO_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_RCO_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "DOC_RECORD_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "RCO_TITLE", "RCO_DESCRIPTION", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select MGM.ACT_MGM_IMPUTATION_ID
       , MGM.ACT_FINANCIAL_IMPUTATION_ID
       , MGM.ACS_PERIOD_ID
       , (select PER.C_TYPE_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) C_TYPE_PERIOD
       , (select PER.PER_NO_PERIOD
            from ACS_PERIOD PER
           where PER.ACS_PERIOD_ID = MGM.ACS_PERIOD_ID) PER_NO_PERIOD
       , MGM.IMM_VALUE_DATE
       , MGM.IMM_TRANSACTION_DATE
       , MGM.IMM_TYPE
       , MGM.IMM_GENRE
       , MGM.IMM_PRIMARY
       , MGM.IMM_DESCRIPTION
       , MGM.DOC_RECORD_ID
       , MGM.ACS_CPN_ACCOUNT_ID
       , MGM.ACS_CDA_ACCOUNT_ID
       , MGM.ACS_PF_ACCOUNT_ID
       , DIS.ACS_PJ_ACCOUNT_ID
       , MGM.ACS_QTY_UNIT_ID
       , nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D
       , nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C
       , nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D
       , nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C
       , nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D
       , nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C
       , nvl(nvl(DIS.MGM_AMOUNT_EUR_D, MGM.IMM_AMOUNT_EUR_D), 0) IMM_AMOUNT_EUR_D
       , nvl(nvl(DIS.MGM_AMOUNT_EUR_C, MGM.IMM_AMOUNT_EUR_C), 0) IMM_AMOUNT_EUR_C
       , MGM.ACS_FINANCIAL_CURRENCY_ID
       , MGM.ACS_ACS_FINANCIAL_CURRENCY_ID
       , MGM.IMM_EXCHANGE_RATE
       , MGM.IMM_BASE_PRICE
       , MGM.ACT_DOCUMENT_ID
       , MGM.IMM_NUMBER
       , MGM.IMM_NUMBER2
       , MGM.IMM_NUMBER3
       , MGM.IMM_NUMBER4
       , MGM.IMM_NUMBER5
       , MGM.IMM_TEXT1
       , MGM.IMM_TEXT2
       , MGM.IMM_TEXT3
       , MGM.IMM_TEXT4
       , MGM.IMM_TEXT5
       , MGM.DIC_IMP_FREE1_ID
       , MGM.DIC_IMP_FREE2_ID
       , MGM.DIC_IMP_FREE3_ID
       , MGM.DIC_IMP_FREE4_ID
       , MGM.DIC_IMP_FREE5_ID
       , MGM.HRM_PERSON_ID
       , MGM.GCO_GOOD_ID
       , MGM.FAM_FIXED_ASSETS_ID
       , MGM.C_FAM_TRANSACTION_TYP
       , MGM.PAC_PERSON_ID
       , (select IMP.ACS_FINANCIAL_ACCOUNT_ID
            from ACT_FINANCIAL_IMPUTATION IMP
           where MGM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACS_FINANCIAL_ACCOUNT_ID
       , (select RCO.RCO_TITLE
            from DOC_RECORD RCO
           where RCO.DOC_RECORD_ID = MGM.DOC_RECORD_ID) RCO_TITLE
       , (select RCO.RCO_DESCRIPTION
            from DOC_RECORD RCO
           where RCO.DOC_RECORD_ID = MGM.DOC_RECORD_ID) RCO_DESCRIPTION
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , DOC.ACT_ACT_JOURNAL_ID ACT_JOURNAL_ID
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_ACT_JOURNAL_ID) JOU_NUMBER
       , (select JOU.JOU_DESCRIPTION
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_ACT_JOURNAL_ID) JOU_DESCRIPTION
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = DOC.ACT_ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'CPN') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'CPN') C_TYPE_CUMUL
    from ACT_DOCUMENT DOC
       , ACT_MGM_IMPUTATION MGM
       , ACT_MGM_DISTRIBUTION DIS
       , (select LID_FREE_NUMBER_1 DOC_RECORD_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
   where TMP.DOC_RECORD_ID = MGM.DOC_RECORD_ID
     and MGM.ACT_MGM_IMPUTATION_ID = DIS.ACT_MGM_IMPUTATION_ID(+)
     and MGM.ACS_PERIOD_ID in(select ACS_PERIOD_ID
                                from ACS_PERIOD PER
                               where PER.ACS_FINANCIAL_YEAR_ID in(select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
                                                                    from COM_LIST_ID_TEMP
                                                                   where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
     and MGM.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_RCO_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "DOC_RECORD_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "RCO_TITLE", "RCO_DESCRIPTION", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select ACT_MGM_IMPUTATION_ID
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , C_TYPE_PERIOD
       , PER_NO_PERIOD
       , IMM_VALUE_DATE
       , IMM_TRANSACTION_DATE
       , IMM_TYPE
       , IMM_GENRE
       , IMM_PRIMARY
       , IMM_DESCRIPTION
       , DOC_RECORD_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_QTY_UNIT_ID
       , IMM_QUANTITY_D
       , IMM_QUANTITY_C
       , IMM_AMOUNT_LC_D
       , IMM_AMOUNT_LC_C
       , IMM_AMOUNT_FC_D
       , IMM_AMOUNT_FC_C
       , ACS_FINANCIAL_CURRENCY_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMM_EXCHANGE_RATE
       , IMM_BASE_PRICE
       , ACS_FINANCIAL_ACCOUNT_ID
       , RCO_TITLE
       , RCO_DESCRIPTION
       , IMM_NUMBER
       , IMM_NUMBER2
       , IMM_NUMBER3
       , IMM_NUMBER4
       , IMM_NUMBER5
       , IMM_TEXT1
       , IMM_TEXT2
       , IMM_TEXT3
       , IMM_TEXT4
       , IMM_TEXT5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , HRM_PERSON_ID
       , GCO_GOOD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , PAC_PERSON_ID
       , ACT_DOCUMENT_ID
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_ACT_JOURNAL_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , JOU_DESCRIPTION
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
    from V_ACR_RCO_IMPUTATIONS
   where (C_TYPE_PERIOD <> '1')
      or (    C_TYPE_PERIOD = '1'
          and nvl( (select A.C_STATE_FINANCIAL_YEAR
                      from ACS_FINANCIAL_YEAR A
                         , ACS_FINANCIAL_YEAR B
                     where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                       and B.FYE_START_DATE = A.FYE_END_DATE + 1
                       and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                        from COM_LIST_ID_TEMP
                                                       where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
                , 'CLO'
                 ) = 'CLO'
         )
  union all
  select 0 ACT_MGM_IMPUTATION_ID
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , TOT.ACS_PERIOD_ID
       , TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , TOT.IMM_VALUE_DATE
       , TOT.IMM_TRANSACTION_DATE
       , 'MAN' IMM_TYPE
       , 'MAN' IMM_GENRE
       , 0 IMM_PRIMARY
       , 'Report' IMM_DESCRIPTION
       , TOT.DOC_RECORD_ID
       , TOT.ACS_CPN_ACCOUNT_ID
       , TOT.ACS_CDA_ACCOUNT_ID
       , TOT.ACS_PF_ACCOUNT_ID
       , TOT.ACS_PJ_ACCOUNT_ID
       , TOT.ACS_QTY_UNIT_ID
       , TOT.IMM_QUANTITY_D
       , TOT.IMM_QUANTITY_C
       , TOT.IMM_AMOUNT_LC_D
       , TOT.IMM_AMOUNT_LC_C
       , TOT.IMM_AMOUNT_FC_D
       , TOT.IMM_AMOUNT_FC_C
       , TOT.ACS_FINANCIAL_CURRENCY_ID
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMM_EXCHANGE_RATE
       , 0 IMM_BASE_PRICE
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , TOT.RCO_TITLE
       , TOT.RCO_DESCRIPTION
       , 0 IMM_NUMBER
       , 0 IMM_NUMBER2
       , 0 IMM_NUMBER3
       , 0 IMM_NUMBER4
       , 0 IMM_NUMBER5
       , '' IMM_TEXT1
       , '' IMM_TEXT2
       , '' IMM_TEXT3
       , '' IMM_TEXT4
       , '' IMM_TEXT5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_IMP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 HRM_PERSON_ID
       , 0 GCO_GOOD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 PAC_PERSON_ID
       , 0 ACT_DOCUMENT_ID
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , '' JOU_DESCRIPTION
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
    from V_ACR_RCO_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_RCO_PREV_YEAR_TOTAL" ("C_TYPE_PERIOD", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "PER_NO_PERIOD", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "DOC_RECORD_ID", "RCO_TITLE", "RCO_DESCRIPTION", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select   PER.C_TYPE_PERIOD
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE IMM_VALUE_DATE
         , PER.PER_START_DATE IMM_TRANSACTION_DATE
         , PER.PER_NO_PERIOD
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_PJ_ACCOUNT_ID
         , TOT.ACS_CPN_ACCOUNT_ID
         , TOT.ACS_CDA_ACCOUNT_ID
         , TOT.ACS_PF_ACCOUNT_ID
         , TOT.DOC_RECORD_ID
         , RCO.RCO_TITLE
         , RCO.RCO_DESCRIPTION
         , TOT.ACS_QTY_UNIT_ID
         , decode(sign(nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0)
                 ) IMM_QUANTITY_D
         , decode(sign(nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_QUANTITY_D - TOT.MTO_QUANTITY_C), 0)
                 ) IMM_QUANTITY_C
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0)
                 ) IMM_AMOUNT_LC_D
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_DEBIT_LC - TOT.MTO_CREDIT_LC), 0)
                 ) IMM_AMOUNT_LC_C
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0)
                 ) IMM_AMOUNT_FC_D
         , decode(sign(nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.MTO_DEBIT_FC - TOT.MTO_CREDIT_FC), 0)
                 ) IMM_AMOUNT_FC_C
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
      from ACT_MGM_TOT_BY_PERIOD TOT
         , DOC_RECORD RCO
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where RCO.DOC_RECORD_ID = TMP.LID_FREE_NUMBER_1
       and RCO.DOC_RECORD_ID = TOT.DOC_RECORD_ID
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.C_TYPE_PERIOD = '1'
  group by TOT.ACS_FINANCIAL_ACCOUNT_ID
         , TOT.ACS_PJ_ACCOUNT_ID
         , TOT.ACS_CPN_ACCOUNT_ID
         , TOT.ACS_CDA_ACCOUNT_ID
         , TOT.ACS_PF_ACCOUNT_ID
         , TOT.DOC_RECORD_ID
         , RCO.RCO_TITLE
         , RCO.RCO_DESCRIPTION
         , TOT.ACS_QTY_UNIT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , PER.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.C_TYPE_PERIOD
         , PER.PER_NO_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_REC_BALANCE_RPT" ("ACS_AUXILIARY_ACCOUNT_ID", "AUX_NUMBER", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_MB", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY_ME", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "ACS_FINANCIAL_ACCOUNT_ID", "FIN_COLLECTIV", "ACS_DIVISION_ACCOUNT_ID", "ACS_PERIOD_ID", "C_TYPE_PERIOD", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_SUB_SET", "PER_NO_PERIOD", "ACS_FINANCIAL_YEAR_ID", "FYE_NO_EXERCICE") AS
  SELECT
    AUX.ACS_AUXILIARY_ACCOUNT_ID,
    ACC.ACC_NUMBER AUX_NUMBER,
    TOT.ACS_FINANCIAL_CURRENCY_ID,
    (SELECT CUB.CURRENCY
     FROM   PCS.PC_CURR CUB,
            ACS_FINANCIAL_CURRENCY CMB
     WHERE  CMB.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_FINANCIAL_CURRENCY_ID and
            CUB.PC_CURR_ID                = CMB.PC_CURR_ID) CURRENCY_MB,
    TOT.TOT_DEBIT_LC,
    TOT.TOT_CREDIT_LC,
    TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
    (SELECT CUE.CURRENCY
     FROM   PCS.PC_CURR CUE,
            ACS_FINANCIAL_CURRENCY CME
     WHERE  CME.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_ACS_FINANCIAL_CURRENCY_ID and
            CUE.PC_CURR_ID                = CME.PC_CURR_ID) CURRENCY_ME,
    TOT.TOT_DEBIT_FC,
    TOT.TOT_CREDIT_FC,
    TOT.ACS_FINANCIAL_ACCOUNT_ID,
    (SELECT FIN.ACC_NUMBER
     FROM   ACS_ACCOUNT FIN
     WHERE  FIN.ACS_ACCOUNT_ID = TOT.ACS_FINANCIAL_ACCOUNT_ID) FIN_COLLECTIV,
    TOT.ACS_DIVISION_ACCOUNT_ID,
    TOT.ACS_PERIOD_ID,
    TOT.C_TYPE_PERIOD,
    TOT.C_TYPE_CUMUL,
    SUB.ACS_SUB_SET_ID,
    SUB.C_SUB_SET,
    PER.PER_NO_PERIOD,
    FYE.ACS_FINANCIAL_YEAR_ID,
    FYE.FYE_NO_EXERCICE
FROM
    ACS_FINANCIAL_YEAR    FYE,
    ACS_PERIOD            PER,
    ACS_SUB_SET           SUB,
    ACT_TOTAL_BY_PERIOD   TOT,
    ACS_FINANCIAL_ACCOUNT FIN,
    ACS_ACCOUNT           ACC,
    ACS_AUXILIARY_ACCOUNT AUX
WHERE
        AUX.ACS_AUXILIARY_ACCOUNT_ID  = TOT.ACS_AUXILIARY_ACCOUNT_ID
    and AUX.ACS_AUXILIARY_ACCOUNT_ID  = ACC.ACS_ACCOUNT_ID
    and TOT.ACS_FINANCIAL_ACCOUNT_ID  = FIN.ACS_FINANCIAL_ACCOUNT_ID
    and ACC.ACS_SUB_SET_ID            = SUB.ACS_SUB_SET_ID
    and SUB.C_SUB_SET                 = 'REC'
    and ((TOT.ACS_DIVISION_ACCOUNT_ID is not null) or (TOT.ACS_DIVISION_ACCOUNT_ID is null and ACR_FUNCTIONS.ExistDivision = 0))
    and TOT.ACS_PERIOD_ID             = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID     = FYE.ACS_FINANCIAL_YEAR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_REC_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACC_NUMBER", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_TYPE_PERIOD", "PER_NO_PERIOD", "MATCHING") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID
       , IMP.ACS_PERIOD_ID
       , IMP.ACT_DOCUMENT_ID
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_TYPE
       , IMP.IMF_PRIMARY
       , IMP.IMF_DESCRIPTION
       , IMP.IMF_AMOUNT_LC_D
       , IMP.IMF_AMOUNT_LC_C
       , IMP.IMF_EXCHANGE_RATE
       , IMP.IMF_AMOUNT_FC_D
       , IMP.IMF_AMOUNT_FC_C
       , IMP.IMF_AMOUNT_EUR_D
       , IMP.IMF_AMOUNT_EUR_C
       , IMP.IMF_VALUE_DATE
       , IMP.ACS_TAX_CODE_ID
       , IMP.IMF_TRANSACTION_DATE
       , IMP.ACS_FINANCIAL_CURRENCY_ID
       , IMP.C_GENRE_TRANSACTION
       , IMP.ACT_DET_PAYMENT_ID
       , IMP.ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMP.IMF_GENRE
       , IMP.IMF_BASE_PRICE
       , IMP.ACT_PART_IMPUTATION_ID
       , IMP.A_CONFIRM
       , IMP.A_DATECRE
       , IMP.A_DATEMOD
       , IMP.A_IDCRE
       , IMP.A_IDMOD
       , IMP.A_RECLEVEL
       , IMP.A_RECSTATUS
       , IMP.IMF_TEXT1
       , IMP.IMF_TEXT2
       , IMP.IMF_TEXT3
       , IMP.IMF_TEXT4
       , IMP.IMF_TEXT5
       , IMP.IMF_NUMBER
       , IMP.IMF_NUMBER2
       , IMP.IMF_NUMBER3
       , IMP.IMF_NUMBER4
       , IMP.IMF_NUMBER5
       , IMP.DIC_IMP_FREE1_ID
       , IMP.DIC_IMP_FREE2_ID
       , IMP.DIC_IMP_FREE3_ID
       , IMP.DIC_IMP_FREE4_ID
       , IMP.DIC_IMP_FREE5_ID
       , IMP.GCO_GOOD_ID
       , IMP.HRM_PERSON_ID
       , IMP.DOC_RECORD_ID
       , IMP.FAM_FIXED_ASSETS_ID
       , IMP.C_FAM_TRANSACTION_TYP
       , IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID
       , (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID
            from ACT_FINANCIAL_DISTRIBUTION DIS
           where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , AUX.ACC_NUMBER
       , IMP.ACS_AUXILIARY_ACCOUNT_ID
       , IMP.IMF_PAC_CUSTOM_PARTNER_ID PAC_PERSON_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_JOURNAL_ID
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , (select JOU.JOU_DESCRIPTION
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION
       , (select COV.COV_NUMBER
            from ACT_COVER_INFORMATION COV
           where COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID) COV_NUMBER
       , (select PAR.PAR_DOCUMENT
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT
       , (select PAR.DOC_DATE_DELIVERY
            from ACT_PART_IMPUTATION PAR
           where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY
       , ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'REC') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'REC') C_TYPE_CUMUL
       , AUX.ACS_SUB_SET_ID
       , PER.C_TYPE_PERIOD
       , PER.PER_NO_PERIOD
       , ACR_FUNCTIONS.IsDocumentMatching(IMP.ACT_PART_IMPUTATION_ID) MATCHING
    from ACS_FINANCIAL_ACCOUNT FIN
       , ACT_DOCUMENT DOC
       , ACS_PERIOD PER
       , ACT_FINANCIAL_IMPUTATION IMP
       , ACS_ACCOUNT AUX
       , (select LID_FREE_NUMBER_1 ACS_AUXILIARY_ACCOUNT_ID
            from COM_LIST_ID_TEMP
           where LID_FREE_NUMBER_1 is not null) TMP
       , (select LID_FREE_NUMBER_2 ACS_FINANCIAL_YEAR_ID
            from COM_LIST_ID_TEMP
           where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') YEA
   where AUX.ACS_ACCOUNT_ID = TMP.ACS_AUXILIARY_ACCOUNT_ID
     and AUX.ACS_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID
     and IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and PER.ACS_FINANCIAL_YEAR_ID = YEA.ACS_FINANCIAL_YEAR_ID
     and IMP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and IMP.ACS_FINANCIAL_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
     and FIN.FIN_COLLECTIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_REC_IMPUTATION_ISAG" ("IMF_TYPE", "EXS_TYPE", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACT_DOCUMENT_ID", "C_TYPE_CATALOGUE", "DOC_NUMBER", "IMF_TRANSACTION_DATE", "IMF_NUMBER2", "PAR_DOCUMENT", "IMF_DESCRIPTION", "AAN_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "C_GENRE_TRANSACTION", "IMF_GENRE", "ACT_PART_IMPUTATION_ID", "DIV_NUMBER", "DOC_COMMENT", "JOU_NUMBER", "DOC_DATE_DELIVERY", "C_TYPE_CUMUL", "C_ETAT_JOURNAL", "CELL_COLOR") AS
  select TYP IMF_TYPE
     , TYP2 EXS_TYPE
     , ACS_AUXILIARY_ACCOUNT_ID
     , ACT_FINANCIAL_IMPUTATION_ID
     , DOC_ID ACT_DOCUMENT_ID
     , C_TYPE_CATALOGUE
     , DOC_NUMBER
     , IMF_TRANSACTION_DATE
     , IMF_NUMBER2
     , PAR_DOCUMENT
     , IMF_DESCRIPTION
     , IMF_DESCRIPTION2 AAN_DESCRIPTION
     , IMF_AMOUNT_LC_D
     , IMF_AMOUNT_LC_C
     , IMF_AMOUNT_FC_D
     , IMF_AMOUNT_FC_C
     , IMF_AMOUNT_EUR_D
     , IMF_AMOUNT_EUR_C
     , IMF_VALUE_DATE
     , C_GENRE_TRANSACTION
     , IMF_GENRE
     , ACT_PART_IMPUTATION_ID
     , DIV_NUMBER
     , DOC_COMMENT
     , JOU_NUMBER
     , JOU_DESCRIPTION DOC_DATE_DELIVERY
     , C_TYPE_CUMUL
     , C_ETAT_JOURNAL
     , case
         when TYP = 1 then '*;PCS_BLUE_TEXT_ONLY'
         when TYP = 2 then '*;PCS_RED_TEXT_ONLY'
         when TYP = 3 then '*;PCS_GREEN_TEXT_ONLY'
       end CELL_COLOR
  from (select 1 TYP
             , 'PO' TYP2
             , PO.IMF_DESCRIPTION IMF_DESCRIPTION2
             , PO.*
             , PO.ACT_DOCUMENT_ID DOC_ID
             , (select CAT.C_TYPE_CATALOGUE
                  from ACJ_CATALOGUE_DOCUMENT CAT
                 where CAT.ACJ_CATALOGUE_DOCUMENT_ID = PO.ACJ_CATALOGUE_DOCUMENT_ID) C_TYPE_CATALOGUE
          from V_ACR_REC_IMPUTATION PO
         where PO.ACT_DET_PAYMENT_ID is null
           and nvl(substr(trim(PO.PAR_DOCUMENT),(length(trim(PO.PAR_DOCUMENT) ) - 1), 2), 0) <> '-X'
        union all
        select 2 TYP
             , 'POX' TYP2
             , POX.IMF_DESCRIPTION IMF_DESCRIPTION2
             , POX.*
             , nvl( (select min(ACT_DOCUMENT_ID)
                       from ACT_PART_IMPUTATION PAR
                      where PAR.PAR_DOCUMENT = substr(trim(POX.PAR_DOCUMENT), 1,(length(trim(POX.PAR_DOCUMENT) ) - 2) ) )
                 , '000000000000'
                  ) DOC_ID
             , (select CAT.C_TYPE_CATALOGUE
                  from ACJ_CATALOGUE_DOCUMENT CAT
                 where CAT.ACJ_CATALOGUE_DOCUMENT_ID = POX.ACJ_CATALOGUE_DOCUMENT_ID) C_TYPE_CATALOGUE
          from V_ACR_REC_IMPUTATION POX
         where POX.ACT_DET_PAYMENT_ID is null
           and substr(trim(POX.PAR_DOCUMENT),(length(trim(POX.PAR_DOCUMENT) ) - 1), 2) = '-X'
        union all
        select 3 TYP
             , 'PMT' TYP2
             , 'PAIEMENT' IMF_DESCRIPTION2
             , PMT.*
             , (select exp.ACT_DOCUMENT_ID
                  from ACT_DET_PAYMENT DET
                     , ACT_EXPIRY exp
                 where PMT.ACT_DET_PAYMENT_ID = DET.ACT_DET_PAYMENT_ID
                   and DET.ACT_EXPIRY_ID = exp.ACT_EXPIRY_ID) DOC_ID
             , (select CAT.C_TYPE_CATALOGUE
                  from ACJ_CATALOGUE_DOCUMENT CAT
                 where CAT.ACJ_CATALOGUE_DOCUMENT_ID = PMT.ACJ_CATALOGUE_DOCUMENT_ID) C_TYPE_CATALOGUE
          from V_ACR_REC_IMPUTATION PMT
         where PMT.ACT_DET_PAYMENT_ID is not null)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_REC_IMP_REPORT" ("C_TYPE_PERIOD", "PER_NO_PERIOD", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "MATCHING") AS
  select C_TYPE_PERIOD
       , PER_NO_PERIOD
       , ACT_FINANCIAL_IMPUTATION_ID
       , ACS_PERIOD_ID
       , ACT_DOCUMENT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , IMF_TYPE
       , IMF_PRIMARY
       , IMF_DESCRIPTION
       , IMF_AMOUNT_LC_D
       , IMF_AMOUNT_LC_C
       , IMF_EXCHANGE_RATE
       , IMF_AMOUNT_FC_D
       , IMF_AMOUNT_FC_C
       , IMF_AMOUNT_EUR_D
       , IMF_AMOUNT_EUR_C
       , IMF_VALUE_DATE
       , ACS_TAX_CODE_ID
       , IMF_TRANSACTION_DATE
       , ACS_FINANCIAL_CURRENCY_ID
       , C_GENRE_TRANSACTION
       , ACS_AUXILIARY_ACCOUNT_ID
       , ACT_DET_PAYMENT_ID
       , ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMF_BASE_PRICE
       , ACT_PART_IMPUTATION_ID
       , ACC_NUMBER
       , ACT_FINANCIAL_DISTRIBUTION_ID
       , ACS_DIVISION_ACCOUNT_ID
       , DIV_NUMBER
       , DOC_NUMBER
       , DOC_COMMENT
       , ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_JOURNAL_ID
       , JOU_NUMBER
       , FINANCIAL_IMPUTATION_ID
       , ACT_ACT_JOURNAL_ID
       , C_ETAT_JOURNAL
       , C_TYPE_CUMUL
       , COV_NUMBER
       , PAR_DOCUMENT
       , DOC_DATE_DELIVERY
       , IMF_TEXT1
       , IMF_TEXT2
       , IMF_TEXT3
       , IMF_TEXT4
       , IMF_TEXT5
       , IMF_NUMBER
       , IMF_NUMBER2
       , IMF_NUMBER3
       , IMF_NUMBER4
       , IMF_NUMBER5
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , GCO_GOOD_ID
       , HRM_PERSON_ID
       , DOC_RECORD_ID
       , FAM_FIXED_ASSETS_ID
       , C_FAM_TRANSACTION_TYP
       , IMP_PAC_PERSON_ID
       , MATCHING
    from V_ACR_REC_IMPUTATION
   where (C_TYPE_PERIOD <> '1')
      or (    C_TYPE_PERIOD = '1'
          and nvl( (select A.C_STATE_FINANCIAL_YEAR
                      from ACS_FINANCIAL_YEAR A
                         , ACS_FINANCIAL_YEAR B
                     where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                       and B.FYE_START_DATE = A.FYE_END_DATE + 1
                       and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                        from COM_LIST_ID_TEMP
                                                       where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
                , 'CLO'
                 ) = 'CLO'
         )
  union all
  select TOT.C_TYPE_PERIOD
       , TOT.PER_NO_PERIOD
       , 0 ACT_FINANCIAL_IMPUTATION_ID
       , TOT.ACS_PERIOD_ID
       , 0 ACT_DOCUMENT_ID
       , TOT.ACS_FINANCIAL_ACCOUNT_ID
       , 'MAN' IMF_TYPE
       , 0 IMF_PRIMARY
       , 'Report' IMF_DESCRIPTION
       , TOT.TOT_DEBIT_LC IMF_AMOUNT_LC_D
       , TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C
       , 0 IMF_EXCHANGE_RATE
       , TOT.TOT_DEBIT_FC IMF_AMOUNT_FC_D
       , TOT.TOT_CREDIT_FC IMF_AMOUNT_FC_C
       , TOT.TOT_DEBIT_EUR IMF_AMOUNT_EUR_D
       , TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C
       , TOT.PER_START_DATE IMF_VALUE_DATE
       , 0 ACS_TAX_CODE_ID
       , TOT.PER_START_DATE IMF_TRANSACTION_DATE
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID
       , '1' C_GENRE_TRANSACTION
       , TOT.ACS_AUXILIARY_ACCOUNT_ID
       , 0 ACT_DET_PAYMENT_ID
       , TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID
       , 0 IMF_BASE_PRICE
       , 0 ACT_PART_IMPUTATION_ID
       , TOT.ACC_NUMBER
       , 0 ACT_FINANCIAL_DISTRIBUTION_ID
       , TOT.ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = TOT.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , '' DOC_NUMBER
       , '' DOC_COMMENT
       , 0 ACJ_CATALOGUE_DOCUMENT_ID
       , 0 ACT_JOURNAL_ID
       , 0 JOU_NUMBER
       , 0 FINANCIAL_IMPUTATION_ID
       , 0 ACT_ACT_JOURNAL_ID
       , 'PROV' C_ETAT_JOURNAL
       , TOT.C_TYPE_CUMUL
       , '' COV_NUMBER
       , null PAR_DOCUMENT
       , to_date(null) DOC_DATE_DELIVERY
       , '' IMF_TEXT1
       , '' IMF_TEXT2
       , '' IMF_TEXT3
       , '' IMF_TEXT4
       , '' IMF_TEXT5
       , 0 IMF_NUMBER
       , 0 IMF_NUMBER2
       , 0 IMF_NUMBER3
       , 0 IMF_NUMBER4
       , 0 IMF_NUMBER5
       , '' DIC_IMP_FREE1_ID
       , '' DIC_IMP_FREE2_ID
       , '' DIC_IMP_FREE3_ID
       , '' DIC_IMP_FREE4_ID
       , '' DIC_IMP_FREE5_ID
       , 0 GCO_GOOD_ID
       , 0 HRM_PERSON_ID
       , 0 DOC_RECORD_ID
       , 0 FAM_FIXED_ASSETS_ID
       , '' C_FAM_TRANSACTION_TYP
       , 0 IMP_PAC_PERSON_ID
       , 0 MATCHING
    from V_ACR_REC_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_REC_OUTSTANDING_BALANCE" ("PER_NAME", "EXP_ADAPTED", "DOC_NUMBER", "COV_NUMBER", "IMF_TRANSACTION_DATE", "PER_KEY1", "ACC_NUMBER", "ACS_FIN_ACC_S_PAYMENT_ID", "BALANCE_TYPE", "EXP_AMOUNT_LC", "DIFF_SUM_LC") AS
  select "PER_NAME","EXP_ADAPTED","DOC_NUMBER","COV_NUMBER","IMF_TRANSACTION_DATE","PER_KEY1","ACC_NUMBER","ACS_FIN_ACC_S_PAYMENT_ID","BALANCE_TYPE","EXP_AMOUNT_LC","DIFF_SUM_LC"
    from (select PERS.PER_NAME
               , to_char(COV.COV_EXPIRY_DATE, 'YYYY-MM-DD') EXP_ADAPTED
               , DOC.DOC_NUMBER
               , COV.COV_NUMBER
               , IMP.IMF_TRANSACTION_DATE
               , PERS.PER_KEY1
               , ACC.ACC_NUMBER
               , cov.ACS_FIN_ACC_S_PAYMENT_ID
               , 'COVER' BALANCE_TYPE
               , (COV.COV_AMOUNT_LC) EXP_AMOUNT_LC
               , (COV.COV_AMOUNT_LC) DIFF_SUM_LC
            from ACT_COVER_INFORMATION COV
               , ACT_FINANCIAL_IMPUTATION IMP
               , ACT_DOCUMENT DOC
               , PAC_PERSON PERS
               , ACS_ACCOUNT ACC
           where COV.PAC_CUSTOM_PARTNER_ID = PERS.PAC_PERSON_ID
             and COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID
             and COV.C_COVER_STATUS = '1'
             and IMP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
             and IMP.IMF_PRIMARY = 1
             and IMP.IMF_TRANSACTION_DATE <= ACT_FUNCTIONS.GetAnalyse_Date
             and ACC.ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID
             and not exists(
                   select 1
                     from ACT_FINANCIAL_IMPUTATION FIN2
                        , ACT_COVER_DISCHARGED DISCH
                    where DISCH.ACT_COVER_INFORMATION_ID = COV.ACT_COVER_INFORMATION_ID
                      and DISCH.ACT_FINANCIAL_IMPUTATION_ID = FIN2.ACT_FINANCIAL_IMPUTATION_ID
                      and FIN2.IMF_TRANSACTION_DATE <= ACT_FUNCTIONS.GetAnalyse_Date) )
  union
  (select PERS.PER_NAME
        , to_char(v.EXP_ADAPTED, 'YYYY-MM-DD') EXP_ADAPTED
        , V.DOC_NUMBER
        , V.PAR_DOCUMENT COV_NUMBER
        , V.IMF_TRANSACTION_DATE
        , PERS.PER_KEY1
        , ACC.ACC_NUMBER
        , v.ACS_FIN_ACC_S_PAYMENT_ID
        , 'PO' BALANCE_TYPE
        , EXP_AMOUNT_LC
        , (V.EXP_AMOUNT_LC - V.DET_PAIED_LC) DIFF_SUM_LC
     from V_ACT_EXPIRY_THIRD V
        , ACS_ACCOUNT ACC
        , PAC_PERSON PERS
        , ACS_ACCOUNT AUX
        , ACS_SUB_SET SUB
    where V.ACS_AUXILIARY_ACCOUNT_ID = AUX.ACS_ACCOUNT_ID
      and AUX.ACS_SUB_SET_ID = SUB.ACS_SUB_SET_ID
      and SUB.C_SUB_SET = 'REC'
      and V.C_TYPE_CUMUL = 'EXT'
      and ACC.ACS_ACCOUNT_ID = V.ACS_FINANCIAL_ACCOUNT_ID
      and PERS.PAC_PERSON_ID = V.PAC_PERSON_ID)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_REC_PREV_YEAR_TOTAL" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE", "C_TYPE_PERIOD", "PER_NO_PERIOD") AS
  select   TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_DEBIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_CREDIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_DEBIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_CREDIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_DEBIT_EUR
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_CREDIT_EUR
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.C_TYPE_PERIOD
         , PER.PER_NO_PERIOD
      from ACS_ACCOUNT ACC
         , ACT_TOTAL_BY_PERIOD TOT
         , ACS_PERIOD PER
         , COM_LIST_ID_TEMP TMP
     where ACC.ACS_ACCOUNT_ID = TMP.LID_FREE_NUMBER_1
       and exists(select 1
                    from ACS_SUB_SET SUB
                   where SUB.C_SUB_SET = 'REC'
                     and SUB.ACS_SUB_SET_ID = ACC.ACS_SUB_SET_ID)
       and nvl( (select A.C_STATE_FINANCIAL_YEAR
                   from ACS_FINANCIAL_YEAR A
                      , ACS_FINANCIAL_YEAR B
                  where A.FYE_NO_EXERCICE = B.FYE_NO_EXERCICE - 1
                    and B.FYE_START_DATE = A.FYE_END_DATE + 1
                    and B.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                                     from COM_LIST_ID_TEMP
                                                    where LID_CODE = 'ACS_FINANCIAL_YEAR_ID') )
             , 'ACT'
              ) = 'ACT'
--       and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_FINANCIAL_YEAR_ID = (select max(LID_FREE_NUMBER_2)
                                          from COM_LIST_ID_TEMP
                                         where LID_CODE = 'ACS_FINANCIAL_YEAR_ID')
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.C_TYPE_PERIOD = '1'
       and TOT.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
       and (    (TOT.ACS_DIVISION_ACCOUNT_ID is not null)
            or (    TOT.ACS_DIVISION_ACCOUNT_ID is null
                and ACR_FUNCTIONS.ExistDivision = 0)
           )
  group by TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
         , PER.C_TYPE_PERIOD
         , PER.PER_NO_PERIOD


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_SOC_BREAKDOWN" ("ACS_FINANCIAL_YEAR_ID", "ACS_PERIOD_ID", "PAC_PERSON_ID", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "DIC_IMP_FREE_ID") AS
  select ACS_FINANCIAL_YEAR_ID
       , ACS_PERIOD_ID
       , PAC_PERSON_ID
       , case
           when substr(DIC_IMP_FREE_ID, 1, 1) = 'P' then IMF_AMOUNT_LC_D * -1
           else IMF_AMOUNT_LC_D
         end IMF_AMOUNT_LC_D
       , case
           when substr(DIC_IMP_FREE_ID, 1, 1) = 'P' then IMF_AMOUNT_LC_C * -1
           else IMF_AMOUNT_LC_C
         end IMF_AMOUNT_LC_C
       , DIC_IMP_FREE_ID
    from (select   PER.ACS_FINANCIAL_YEAR_ID
                 , IMF.ACS_PERIOD_ID
                 , IMF.PAC_PERSON_ID
                 , sum(nvl(IMF.IMF_AMOUNT_LC_D, 0) ) IMF_AMOUNT_LC_D
                 , sum(nvl(IMF.IMF_AMOUNT_LC_C, 0) ) IMF_AMOUNT_LC_C
                 , case
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE1') then IMF.DIC_IMP_FREE1_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE2') then IMF.DIC_IMP_FREE2_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE3') then IMF.DIC_IMP_FREE3_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE4') then IMF.DIC_IMP_FREE4_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE5') then IMF.DIC_IMP_FREE5_ID
                   end DIC_IMP_FREE_ID
              from ACT_FINANCIAL_IMPUTATION IMF
                 , ACR_SOCIAL_BREAKDOWN ASB
                 , ACR_SOCIAL_CONFIG SCO
                 , ACS_PERIOD PER
             where PER.ACS_FINANCIAL_YEAR_ID = ASB.ACS_FINANCIAL_YEAR_ID
               and PER.ACS_PERIOD_ID = IMF.ACS_PERIOD_ID
               and ASB.C_SOC_BREAKDOWN_STATUS = '1'
               and exists(select 1
                            from PAC_PERSON PER
                           where PER.PER_SOC_BREAKDOWN = 1
                             and IMF.PAC_PERSON_ID = PER.PAC_PERSON_ID)
               and (case
                      when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE1')
                      and (IMF.DIC_IMP_FREE1_ID <> ' ') then 1
                      when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE2')
                      and (IMF.DIC_IMP_FREE2_ID <> ' ') then 1
                      when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE3')
                      and (IMF.DIC_IMP_FREE3_ID <> ' ') then 1
                      when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE4')
                      and (IMF.DIC_IMP_FREE4_ID <> ' ') then 1
                      when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE5')
                      and (IMF.DIC_IMP_FREE5_ID <> ' ') then 1
                      else 0
                    end = 1
                   )
          group by PER.ACS_FINANCIAL_YEAR_ID
                 , IMF.ACS_PERIOD_ID
                 , IMF.PAC_PERSON_ID
                 , case
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE1') then IMF.DIC_IMP_FREE1_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE2') then IMF.DIC_IMP_FREE2_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE3') then IMF.DIC_IMP_FREE3_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE4') then IMF.DIC_IMP_FREE4_ID
                     when(SCO.ASC_DIC_IMP_FREE = 'DIC_IMP_FREE5') then IMF.DIC_IMP_FREE5_ID
                   end)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_SUB_SET_STAT" ("GCDTEXT1", "DES_DESCR_SUM_SUB_SET", "FYE_NO_EXERCICE", "AVERAGEPAYMENT", "MEANCREDITINDAY", "ACS_SUB_SET_ID", "ACS_FINANCIAL_YEAR_ID", "PC_LANG_ID", "LANID") AS
  select
    DEC.GCDTEXT1,
    DES.DES_DESCRIPTION_SUMMARY DES_DESCR_SUM_SUB_SET,
    FYE.FYE_NO_EXERCICE,
    nvl(ACR_FUNCTIONS.AveragePaymentBySubSet(SUB.ACS_SUB_SET_ID,FYE.ACS_FINANCIAL_YEAR_ID),0) AVERAGEPAYMENT,
    nvl(ACR_FUNCTIONS.MeanCreditInDayBySubSet(SUB.ACS_SUB_SET_ID,FYE.ACS_FINANCIAL_YEAR_ID),0) MEANCREDITINDAY,
    SUB.ACS_SUB_SET_ID,
    FYE.ACS_FINANCIAL_YEAR_ID,
    LAN.PC_LANG_ID,
    LAN.LANID
from
    ACS_DESCRIPTION DES,
    ACS_FINANCIAL_YEAR FYE,
    ACS_SUB_SET SUB,
    PCS.V_PC_DESCODES DEC,
    PCS.PC_LANG LAN
where
    SUB.ACS_SUB_SET_ID = DES.ACS_SUB_SET_ID AND
    DES.PC_LANG_ID = LAN.PC_LANG_ID AND
    SUB.C_TYPE_SUB_SET = 'AUX'  AND
    SUB.C_SUB_SET = DEC.GCLCODE AND
    DEC.GCGNAME='C_SUB_SET' AND
    DEC.PC_LANG_ID = DES.PC_LANG_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_AUX" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FIN_CURR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "DES_DESCRIPTION_SUMMARY") AS
  SELECT nvl(TOT.TOT_DEBIT_LC,0),
       nvl(TOT.TOT_CREDIT_LC,0),
       nvl(TOT.TOT_DEBIT_FC,0),
       nvl(TOT.TOT_CREDIT_FC,0),
       nvl(TOT.TOT_DEBIT_EUR,0),
       nvl(TOT.TOT_CREDIT_EUR,0),
       AUX.ACS_FINANCIAL_CURRENCY_ID,
       nvl(TOT.ACS_FINANCIAL_CURRENCY_ID,ACS_FUNCTION.GetLocalCurrencyID),
       AUX.PER_NO_PERIOD,
       AUX.C_STATE_PERIOD,
       AUX.DES_DESCRIPTION_SUMMARY
FROM V_ACR_TOTAL_BY_PERIOD_AUX TOT,
     V_ACR_PERIOD_AUX AUX
WHERE
        AUX.ACS_PERIOD_ID             = TOT.ACS_PERIOD_ID(+)
    and AUX.ACS_AUXILIARY_ACCOUNT_ID  = TOT.ACS_AUXILIARY_ACCOUNT_ID(+)
    and AUX.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_ACS_FINANCIAL_CURRENCY_ID(+)
    and nvl(AUX.ACS_DIVISION_ACCOUNT_ID,0) = nvl(TOT.ACS_DIVISION_ACCOUNT_ID(+),0)
 --    and TOT.ACS_AUXILIARY_ACCOUNT_ID IS NULL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_BY_PERIOD_AUX" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_AUXILIARY_ACCOUNT_ID") AS
  select
       sum(TOT.TOT_DEBIT_LC),
       sum(TOT.TOT_CREDIT_LC),
       sum(TOT.TOT_DEBIT_FC),
       sum(TOT.TOT_CREDIT_FC),
       sum(TOT.TOT_DEBIT_EUR),
       sum(TOT.TOT_CREDIT_EUR),
       TOT.ACS_PERIOD_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       ACR_FUNCTIONS.GetCurrencyId,
--       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACS_AUXILIARY_ACCOUNT_ID
from   ACT_TOTAL_BY_PERIOD TOT,
       ACS_PERIOD PER
where  PER.ACS_FINANCIAL_YEAR_ID    = ACR_FUNCTIONS.GetFinancialYearId
  and  PER.ACS_PERIOD_ID            = TOT.ACS_PERIOD_ID
  and  (TOT.C_TYPE_CUMUL            = ACR_FUNCTIONS.GetC_TYPE_CUMUL1
         or TOT.C_TYPE_CUMUL        = ACR_FUNCTIONS.GetC_TYPE_CUMUL2)
  and  TOT.ACS_AUXILIARY_ACCOUNT_ID = ACR_FUNCTIONS.GetAccountId
  and  (TOT.ACS_ACS_FINANCIAL_CURRENCY_ID = ACR_FUNCTIONS.GetCurrencyId or
        ACR_FUNCTIONS.GetCurrencyId       = ACS_FUNCTION.GetLocalCurrencyID)
group by
       TOT.ACS_PERIOD_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
--       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       ACR_FUNCTIONS.GetCurrencyId,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACS_AUXILIARY_ACCOUNT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_BY_PERIOD_DIV" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID") AS
  select
       sum(TOT.TOT_DEBIT_LC),
       sum(TOT.TOT_CREDIT_LC),
       sum(TOT.TOT_DEBIT_FC),
       sum(TOT.TOT_CREDIT_FC),
       sum(TOT.TOT_DEBIT_EUR),
       sum(TOT.TOT_CREDIT_EUR),
       TOT.ACS_PERIOD_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       ACR_FUNCTIONS.GetCurrencyId,
--     TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID
from   ACT_TOTAL_BY_PERIOD TOT,
       ACS_PERIOD PER
where  PER.ACS_FINANCIAL_YEAR_ID    = ACR_FUNCTIONS.GetFinancialYearId
  and  PER.ACS_PERIOD_ID            = TOT.ACS_PERIOD_ID
  and  (TOT.C_TYPE_CUMUL            = ACR_FUNCTIONS.GetC_TYPE_CUMUL1
         or TOT.C_TYPE_CUMUL        = ACR_FUNCTIONS.GetC_TYPE_CUMUL2)
  and  TOT.ACS_DIVISION_ACCOUNT_ID  = ACR_FUNCTIONS.GetAccountId
  and  TOT.ACS_FINANCIAL_ACCOUNT_ID >= ACR_FUNCTIONS.GetFinancialId(1)
  and  TOT.ACS_FINANCIAL_ACCOUNT_ID <= ACR_FUNCTIONS.GetFinancialId(0)
  and  TOT.ACS_AUXILIARY_ACCOUNT_ID IS NULL
  and  (TOT.ACS_ACS_FINANCIAL_CURRENCY_ID = ACR_FUNCTIONS.GetCurrencyId or
        ACR_FUNCTIONS.GetCurrencyId       = ACS_FUNCTION.GetLocalCurrencyID)
group by
       TOT.ACS_PERIOD_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_BY_PERIOD_FIN" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "C_TYPE_CUMUL", "ACS_PERIOD_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_AUXILIARY_ACCOUNT_ID") AS
  select
       sum(TOT.TOT_DEBIT_LC),
       sum(TOT.TOT_CREDIT_LC),
       sum(TOT.TOT_DEBIT_FC),
       sum(TOT.TOT_CREDIT_FC),
       sum(TOT_DEBIT_EUR),
       sum(TOT_CREDIT_EUR),
       TOT.C_TYPE_CUMUL,
       TOT.ACS_PERIOD_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
--       ACR_FUNCTIONS.GetCurrencyId,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACS_AUXILIARY_ACCOUNT_ID
from   ACT_TOTAL_BY_PERIOD TOT,
       ACS_PERIOD PER
where  PER.ACS_FINANCIAL_YEAR_ID    = ACR_FUNCTIONS.GetFinancialYearId
  and  (TOT.C_TYPE_CUMUL             = ACR_FUNCTIONS.GetC_TYPE_CUMUL1
         or TOT.C_TYPE_CUMUL         = ACR_FUNCTIONS.GetC_TYPE_CUMUL2)
  and  PER.ACS_PERIOD_ID            = TOT.ACS_PERIOD_ID
  and  TOT.ACS_FINANCIAL_ACCOUNT_ID = ACR_FUNCTIONS.GetAccountId
  and  (TOT.ACS_ACS_FINANCIAL_CURRENCY_ID = ACR_FUNCTIONS.GetCurrencyId or
        ACR_FUNCTIONS.GetCurrencyId       = ACS_FUNCTION.GetLocalCurrencyID)
  and  TOT.ACS_AUXILIARY_ACCOUNT_ID IS NULL
group by
       TOT.C_TYPE_CUMUL,
       TOT.ACS_PERIOD_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.ACS_AUXILIARY_ACCOUNT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_DIV" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FIN_CURR_ID", "PER_NO_PERIOD", "DES_DESCRIPTION_SUMMARY") AS
  select
       nvl(sum(TOT.TOT_DEBIT_LC),0),
       nvl(sum(TOT.TOT_CREDIT_LC),0),
       nvl(sum(TOT.TOT_DEBIT_FC),0),
       nvl(sum(TOT.TOT_CREDIT_FC),0),
       nvl(sum(TOT.TOT_DEBIT_EUR),0),
       nvl(sum(TOT.TOT_CREDIT_EUR),0),
       DIV.ACS_FINANCIAL_CURRENCY_ID,
       nvl(TOT.ACS_FINANCIAL_CURRENCY_ID,ACS_FUNCTION.GetLocalCurrencyID),
       DIV.PER_NO_PERIOD,
       DIV.DES_DESCRIPTION_SUMMARY
from V_ACR_TOTAL_BY_PERIOD_DIV TOT,
     V_ACR_PERIOD_DIV DIV
where
        DIV.ACS_PERIOD_ID             = TOT.ACS_PERIOD_ID(+)
    and DIV.ACS_DIVISION_ACCOUNT_ID   = TOT.ACS_DIVISION_ACCOUNT_ID(+)
    and DIV.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_ACS_FINANCIAL_CURRENCY_ID(+)
    and DIV.ACS_FINANCIAL_ACCOUNT_ID  = TOT.ACS_FINANCIAL_ACCOUNT_ID(+)
group by
       DIV.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       DIV.PER_NO_PERIOD,
       DIV.DES_DESCRIPTION_SUMMARY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_FIN" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FIN_CURR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "C_TYPE_CUMUL", "DES_DESCRIPTION_SUMMARY") AS
  SELECT nvl(TOT.TOT_DEBIT_LC,0),
       nvl(TOT.TOT_CREDIT_LC,0),
       nvl(TOT.TOT_DEBIT_FC,0),
       nvl(TOT.TOT_CREDIT_FC,0),
       nvl(TOT.TOT_DEBIT_EUR,0),
       nvl(TOT.TOT_CREDIT_EUR,0),
       FIN.ACS_FINANCIAL_CURRENCY_ID,
       nvl(TOT.ACS_FINANCIAL_CURRENCY_ID,ACS_FUNCTION.GetLocalCurrencyID),
       FIN.PER_NO_PERIOD,
       FIN.C_STATE_PERIOD,
       TOT.C_TYPE_CUMUL,
       FIN.DES_DESCRIPTION_SUMMARY
FROM V_ACR_TOTAL_BY_PERIOD_FIN TOT,
     V_ACR_PERIOD_FIN FIN
WHERE
        FIN.ACS_PERIOD_ID             = TOT.ACS_PERIOD_ID(+)
    and FIN.ACS_FINANCIAL_ACCOUNT_ID  = TOT.ACS_FINANCIAL_ACCOUNT_ID(+)
    and FIN.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_ACS_FINANCIAL_CURRENCY_ID(+)
    and nvl(FIN.ACS_DIVISION_ACCOUNT_ID,0) = nvl(TOT.ACS_DIVISION_ACCOUNT_ID(+),0)
    and TOT.ACS_AUXILIARY_ACCOUNT_ID IS NULL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACR_TOTAL_FIN_LC" ("TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FIN_CURR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "C_TYPE_CUMUL", "DES_DESCRIPTION_SUMMARY") AS
  SELECT nvl(TOT.TOT_DEBIT_LC,0),
       nvl(TOT.TOT_CREDIT_LC,0),
       nvl(TOT.TOT_DEBIT_FC,0),
       nvl(TOT.TOT_CREDIT_FC,0),
       nvl(TOT.TOT_DEBIT_EUR,0),
       nvl(TOT.TOT_CREDIT_EUR,0),
       FIN.ACS_FINANCIAL_CURRENCY_ID,
       nvl(TOT.ACS_FINANCIAL_CURRENCY_ID,ACS_FUNCTION.GetLocalCurrencyID),
       FIN.PER_NO_PERIOD,
       FIN.C_STATE_PERIOD,
       TOT.C_TYPE_CUMUL,
       FIN.DES_DESCRIPTION_SUMMARY
FROM V_ACR_TOTAL_BY_PERIOD_FIN TOT,
     V_ACR_PERIOD_FIN FIN
WHERE
        FIN.ACS_PERIOD_ID             = TOT.ACS_PERIOD_ID(+)
    and FIN.ACS_FINANCIAL_ACCOUNT_ID  = TOT.ACS_FINANCIAL_ACCOUNT_ID(+)
    and FIN.ACS_FINANCIAL_CURRENCY_ID = TOT.ACS_FINANCIAL_CURRENCY_ID(+)
    and nvl(FIN.ACS_DIVISION_ACCOUNT_ID,0) = nvl(TOT.ACS_DIVISION_ACCOUNT_ID(+),0)
    and TOT.ACS_AUXILIARY_ACCOUNT_ID IS NULL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_ACCOUNT_CLASSIF" ("CLASSIFICATION_ID", "CLA_DESCR", "CLA_MULTIPLE_LEAVES_INSTANCES", "CLA_MULTIPLE_NODES_INSTANCES", "CLA_MANDATORY_LINK", "C_CLASSIF_TYPE", "CLA_LEVEL_DISPLAY", "CLA_MULTI_TABLES", "CLA_TRANSLATED", "CLA_USES_CODE", "CLA_CODE_FORMAT", "CLA_MODIFIED_CLASSIF", "CLA_LAST_FLAT_DATE", "CLA_FLAT_CLASSIF", "A_COMID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "CLASSIFICATION_ID_STRING") AS
  select CLA.CLASSIFICATION_ID,
        CLA_DESCR,
        CLA_MULTIPLE_LEAVES_INSTANCES,
        CLA_MULTIPLE_NODES_INSTANCES,
        decode(C_CLASSIF_TYPE,'1',0,'2',1) CLA_MANDATORY_LINK,
        C_CLASSIF_TYPE,
        CLA_LEVEL_DISPLAY,
        CLA_MULTI_TABLES,
        CLA_TRANSLATED,
        CLA_USES_CODE,
        CLA_CODE_FORMAT,
        CLA_MODIFIED_CLASSIF,
        CLA_LAST_FLAT_DATE,
        CLA_FLAT_CLASSIF,
        CLA.A_COMID,
        CLA.A_DATECRE,
        CLA.A_DATEMOD,
        CLA.A_IDCRE,
        CLA.A_IDMOD,
        CLA.A_RECLEVEL,
        CLA.A_RECSTATUS,
        to_char(CLA.CLASSIFICATION_ID)
from CLASSIFICATION CLA,
     CLASSIF_TABLES TAB
where CLA.CLASSIFICATION_ID = TAB.CLASSIFICATION_ID
  and TAB.CTA_TABLENAME = 'ACS_ACCOUNT'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_ACC_ISAG" ("ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "LANID", "FIN_COLLECTIVE", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
FIN.ACS_FINANCIAL_ACCOUNT_ID,
ACC.ACC_NUMBER,
DES.DES_DESCRIPTION_SUMMARY,
DES.DES_DESCRIPTION_LARGE,
LAN.LANID||'' LANID,
FIN.FIN_COLLECTIVE,
FIN.A_DATECRE,
FIN.A_IDCRE,
FIN.A_DATEMOD,
FIN.A_IDMOD
FROM
ACS_DESCRIPTION DES,
PCS.PC_LANG LAN,
ACS_ACCOUNT ACC,
ACS_FINANCIAL_ACCOUNT FIN
WHERE
    FIN.ACS_FINANCIAL_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
AND ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_AUXILIARY_ACCOUNT" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_PREP_COLL_ID", "ACS_INVOICE_COLL_ID", "ACS_FINANCIAL_ACCOUNT_ID", "C_REPORT", "C_TYPE_ACCOUNT", "AUX_DIVERSE", "AUX_LETTERING", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "DIC_AUX_ACC_CODE_1_ID", "DIC_AUX_ACC_CODE_2_ID", "DIC_AUX_ACC_CODE_3_ID", "DIC_AUX_ACC_CODE_4_ID", "DIC_AUX_ACC_CODE_5_ID", "DIC_AUX_ACC_CODE_6_ID", "DIC_AUX_ACC_CODE_7_ID", "DIC_AUX_ACC_CODE_8_ID", "DIC_AUX_ACC_CODE_9_ID", "DIC_AUX_ACC_CODE_10_ID", "ACS_SUB_SET_ID", "C_VALID", "ACC_NUMBER", "ACC_DETAIL_PRINTING", "ACC_BLOCKED", "ACC_INTEREST", "ACC_VALID_SINCE", "ACC_VALID_TO", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE") AS
  SELECT
  ACS_AUXILIARY_ACCOUNT.ACS_AUXILIARY_ACCOUNT_ID,
  ACS_AUXILIARY_ACCOUNT.ACS_PREP_COLL_ID,
  ACS_AUXILIARY_ACCOUNT.ACS_INVOICE_COLL_ID,
  ACS_AUXILIARY_ACCOUNT.ACS_FINANCIAL_ACCOUNT_ID,
  ACS_AUXILIARY_ACCOUNT.C_REPORT,
  ACS_AUXILIARY_ACCOUNT.C_TYPE_ACCOUNT,
  ACS_AUXILIARY_ACCOUNT.AUX_DIVERSE,
  ACS_AUXILIARY_ACCOUNT.AUX_LETTERING,
  ACS_AUXILIARY_ACCOUNT.A_CONFIRM,
  ACS_AUXILIARY_ACCOUNT.A_DATECRE,
  ACS_AUXILIARY_ACCOUNT.A_DATEMOD,
  ACS_AUXILIARY_ACCOUNT.A_IDCRE,
  ACS_AUXILIARY_ACCOUNT.A_IDMOD,
  ACS_AUXILIARY_ACCOUNT.A_RECLEVEL,
  ACS_AUXILIARY_ACCOUNT.A_RECSTATUS,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_1_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_2_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_3_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_4_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_5_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_6_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_7_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_8_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_9_ID,
  ACS_AUXILIARY_ACCOUNT.DIC_AUX_ACC_CODE_10_ID,
  ACS_ACCOUNT.ACS_SUB_SET_ID,
  ACS_ACCOUNT.C_VALID,
  ACS_ACCOUNT.ACC_NUMBER,
  ACS_ACCOUNT.ACC_DETAIL_PRINTING,
  ACS_ACCOUNT.ACC_BLOCKED,
  ACS_ACCOUNT.ACC_INTEREST,
  ACS_ACCOUNT.ACC_VALID_SINCE,
  ACS_ACCOUNT.ACC_VALID_TO,
  ACS_DESCRIPTION.PC_LANG_ID,
  ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
  ACS_DESCRIPTION.DES_DESCRIPTION_LARGE
FROM
  ACS_DESCRIPTION,
  ACS_ACCOUNT,
  ACS_AUXILIARY_ACCOUNT,
  ACS_SUB_SET
WHERE
  ACS_AUXILIARY_ACCOUNT.ACS_AUXILIARY_ACCOUNT_ID = ACS_ACCOUNT.ACS_ACCOUNT_ID and
  ACS_ACCOUNT.ACS_ACCOUNT_ID = ACS_DESCRIPTION.ACS_ACCOUNT_ID and
  ACS_ACCOUNT.ACS_SUB_SET_ID = ACS_SUB_SET.ACS_SUB_SET_ID and
  ACS_SUB_SET.C_TYPE_SUB_SET ='AUX'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_AUX_REMINDER_FILTER" ("COUNT", "ACS_SUB_SET_ID", "AUX_LAST_REMINDER", "C_REMINDER_FILTER", "ACT_JOB_ID") AS
  select count(*) count,
          ACC.ACS_SUB_SET_ID,
          JOB.JOB_ACI_CONTROL_DATE,
          FIL.C_REMINDER_FILTER,
          JOB.ACT_JOB_ID
  from ACS_ACCOUNT            ACC,
       ACT_AUX_ACCOUNT_FILTER FIL,
       ACT_JOB                JOB
  where FIL.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
    and FIL.ACT_JOB_ID = JOB.ACT_JOB_ID
  group by ACC.ACS_SUB_SET_ID,
           JOB.JOB_ACI_CONTROL_DATE,
           FIL.C_REMINDER_FILTER,
           JOB.ACT_JOB_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_AUX_REMINDER_FILTER_DET" ("ACS_SUB_SET_ID", "ACS_AUXILIARY_ACCOUNT_ID", "C_REMINDER_FILTER", "JOB_ACI_CONTROL_DATE") AS
  select ACC.ACS_SUB_SET_ID,
       FIL.ACS_AUXILIARY_ACCOUNT_ID,
       FIL.C_REMINDER_FILTER,
       JOB.JOB_ACI_CONTROL_DATE
  from ACT_AUX_ACCOUNT_FILTER FIL,
       ACS_ACCOUNT            ACC,
       ACT_JOB                JOB
  where FIL.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
    and FIL.ACT_JOB_ID = JOB.ACT_JOB_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_CDA_ISAG" ("ACS_CDA_ACCOUNT_ID", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
CDA.ACS_CDA_ACCOUNT_ID,
ACC.ACC_NUMBER,
DES.DES_DESCRIPTION_SUMMARY,
DES.DES_DESCRIPTION_LARGE,
LAN.LANID||'' LANID,
CDA.A_DATECRE,
CDA.A_IDCRE,
CDA.A_DATEMOD,
CDA.A_IDMOD
FROM
ACS_DESCRIPTION DES,
PCS.PC_LANG LAN,
ACS_ACCOUNT ACC,
ACS_CDA_ACCOUNT CDA
WHERE
    CDA.ACS_CDA_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
AND ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_DIVISION_ACCOUNT" ("ACS_DIVISION_ACCOUNT_ID", "DIC_DIV_ACC_CODE_1_ID", "DIC_DIV_ACC_CODE_2_ID", "DIC_DIV_ACC_CODE_3_ID", "DIC_DIV_ACC_CODE_4_ID", "DIC_DIV_ACC_CODE_5_ID", "DIC_DIV_ACC_CODE_6_ID", "DIC_DIV_ACC_CODE_7_ID", "DIC_DIV_ACC_CODE_8_ID", "DIC_DIV_ACC_CODE_9_ID", "DIC_DIV_ACC_CODE_10_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "DIV_DEFAULT_ACCOUNT", "ACS_SUB_SET_ID", "C_VALID", "ACC_NUMBER", "ACC_DETAIL_PRINTING", "ACC_BLOCKED", "ACC_INTEREST", "ACC_VALID_SINCE", "ACC_VALID_TO", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE") AS
  select ACS_DIVISION_ACCOUNT.ACS_DIVISION_ACCOUNT_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_1_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_2_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_3_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_4_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_5_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_6_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_7_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_8_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_9_ID,
       ACS_DIVISION_ACCOUNT.DIC_DIV_ACC_CODE_10_ID,
       ACS_DIVISION_ACCOUNT.A_CONFIRM,
       ACS_DIVISION_ACCOUNT.A_DATECRE,
       ACS_DIVISION_ACCOUNT.A_DATEMOD,
       ACS_DIVISION_ACCOUNT.A_IDCRE,
       ACS_DIVISION_ACCOUNT.A_IDMOD,
       ACS_DIVISION_ACCOUNT.A_RECLEVEL,
       ACS_DIVISION_ACCOUNT.A_RECSTATUS,
       ACS_DIVISION_ACCOUNT.DIV_DEFAULT_ACCOUNT,
       ACS_ACCOUNT.ACS_SUB_SET_ID,
       ACS_ACCOUNT.C_VALID,
       ACS_ACCOUNT.ACC_NUMBER,
       ACS_ACCOUNT.ACC_DETAIL_PRINTING,
       ACS_ACCOUNT.ACC_BLOCKED,
       ACS_ACCOUNT.ACC_INTEREST,
       ACS_ACCOUNT.ACC_VALID_SINCE,
       ACS_ACCOUNT.ACC_VALID_TO,
       ACS_DESCRIPTION.PC_LANG_ID,
       ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
       ACS_DESCRIPTION.DES_DESCRIPTION_LARGE
from ACS_DESCRIPTION,
     ACS_ACCOUNT,
     ACS_DIVISION_ACCOUNT,
     ACS_SUB_SET
where ACS_DIVISION_ACCOUNT.ACS_DIVISION_ACCOUNT_ID = ACS_ACCOUNT.ACS_ACCOUNT_ID
  and ACS_ACCOUNT.ACS_ACCOUNT_ID                   = ACS_DESCRIPTION.ACS_ACCOUNT_ID
  and ACS_ACCOUNT.ACS_SUB_SET_ID                   = ACS_SUB_SET.ACS_SUB_SET_ID
  and ACS_SUB_SET.C_TYPE_SUB_SET = 'DIVI'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_DIV_ISAG" ("ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT DIV.ACS_DIVISION_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       DES.DES_DESCRIPTION_SUMMARY,
       DES.DES_DESCRIPTION_LARGE,
       LAN.LANID||'' LANID,
       DIV.A_DATECRE,
       DIV.A_IDCRE,
       DIV.A_DATEMOD,
       DIV.A_IDMOD
FROM ACS_DESCRIPTION DES,
     PCS.PC_LANG LAN,
     ACS_ACCOUNT ACC,
     ACS_DIVISION_ACCOUNT DIV
WHERE DIV.ACS_DIVISION_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
  AND ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
  AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_FINANCIAL_ACCOUNT" ("ACS_FINANCIAL_ACCOUNT_ID", "C_BALANCE_SHEET_PROFIT_LOSS", "C_DEBIT_CREDIT", "FIN_COLLECTIVE", "FIN_ETAB_ACCOUNT", "FIN_VAT_POSSIBLE", "PC_BANK_ID", "ACS_LIMIT_CURR_ID", "DIC_FIN_ACC_CODE_1_ID", "DIC_FIN_ACC_CODE_2_ID", "DIC_FIN_ACC_CODE_3_ID", "DIC_FIN_ACC_CODE_4_ID", "DIC_FIN_ACC_CODE_5_ID", "DIC_FIN_ACC_CODE_6_ID", "DIC_FIN_ACC_CODE_7_ID", "DIC_FIN_ACC_CODE_8_ID", "DIC_FIN_ACC_CODE_9_ID", "DIC_FIN_ACC_CODE_10_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "DIC_TYPE_LIMIT_ID", "FIN_CREDIT_LIMIT", "FIN_EXPIRATION_LIMIT", "ACS_DEF_VAT_CODE_ID", "ACS_SUB_SET_ID", "C_VALID", "ACC_NUMBER", "ACC_DETAIL_PRINTING", "ACC_BLOCKED", "ACC_INTEREST", "ACC_VALID_SINCE", "ACC_VALID_TO", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "ISFINACCOUNTINME") AS
  select ACS_FINANCIAL_ACCOUNT.ACS_FINANCIAL_ACCOUNT_ID,
       ACS_FINANCIAL_ACCOUNT.C_BALANCE_SHEET_PROFIT_LOSS,
       ACS_FINANCIAL_ACCOUNT.C_DEBIT_CREDIT,
       ACS_FINANCIAL_ACCOUNT.FIN_COLLECTIVE,
       ACS_FINANCIAL_ACCOUNT.FIN_ETAB_ACCOUNT,
       ACS_FINANCIAL_ACCOUNT.FIN_VAT_POSSIBLE,
       ACS_FINANCIAL_ACCOUNT.PC_BANK_ID,
       ACS_FINANCIAL_ACCOUNT.ACS_LIMIT_CURR_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_1_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_2_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_3_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_4_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_5_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_6_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_7_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_8_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_9_ID,
       ACS_FINANCIAL_ACCOUNT.DIC_FIN_ACC_CODE_10_ID,
       ACS_FINANCIAL_ACCOUNT.A_CONFIRM,
       ACS_FINANCIAL_ACCOUNT.A_DATECRE,
       ACS_FINANCIAL_ACCOUNT.A_DATEMOD,
       ACS_FINANCIAL_ACCOUNT.A_IDCRE,
       ACS_FINANCIAL_ACCOUNT.A_IDMOD,
       ACS_FINANCIAL_ACCOUNT.A_RECLEVEL,
       ACS_FINANCIAL_ACCOUNT.A_RECSTATUS,
       ACS_FINANCIAL_ACCOUNT.DIC_TYPE_LIMIT_ID,
       ACS_FINANCIAL_ACCOUNT.FIN_CREDIT_LIMIT,
       ACS_FINANCIAL_ACCOUNT.FIN_EXPIRATION_LIMIT,
       ACS_FINANCIAL_ACCOUNT.ACS_DEF_VAT_CODE_ID,
       ACS_ACCOUNT.ACS_SUB_SET_ID,
       ACS_ACCOUNT.C_VALID,
       ACS_ACCOUNT.ACC_NUMBER,
       ACS_ACCOUNT.ACC_DETAIL_PRINTING,
       ACS_ACCOUNT.ACC_BLOCKED,
       ACS_ACCOUNT.ACC_INTEREST,
       ACS_ACCOUNT.ACC_VALID_SINCE,
       ACS_ACCOUNT.ACC_VALID_TO,
       ACS_DESCRIPTION.PC_LANG_ID,
       ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
       ACS_DESCRIPTION.DES_DESCRIPTION_LARGE,
	   ACS_FUNCTION.isFinAccountInME(ACS_FINANCIAL_ACCOUNT.ACS_FINANCIAL_ACCOUNT_ID) isFinAccountInME
from ACS_DESCRIPTION,
     ACS_ACCOUNT,
     ACS_FINANCIAL_ACCOUNT,
     ACS_SUB_SET
where ACS_FINANCIAL_ACCOUNT.ACS_FINANCIAL_ACCOUNT_ID = ACS_ACCOUNT.ACS_ACCOUNT_ID
  and ACS_ACCOUNT.ACS_ACCOUNT_ID                     = ACS_DESCRIPTION.ACS_ACCOUNT_ID
  and ACS_ACCOUNT.ACS_SUB_SET_ID                     = ACS_SUB_SET.ACS_SUB_SET_ID
  and ACS_SUB_SET.C_SUB_SET='ACC'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_FINANCIAL_CURRENCY" ("ACS_FINANCIAL_CURRENCY_ID", "PC_CURR_ID", "ACS_LOSS_EXCH_EFFECT_ID", "ACS_GAIN_EXCH_EFFECT_ID", "ACS_LOSS_EXCH_COMP_ID", "ACS_GAIN_EXCH_COMP_ID", "FIN_LOCAL_CURRENCY", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "FIN_BASE_PRICE", "FIN_ROUNDED_AMOUNT", "C_ROUND_TYPE", "C_PRICE_METHOD", "FIN_EURO_FROM", "FIN_EURO_RATE", "CURRENCY", "CURRNAME") AS
  SELECT
	ACS_FINANCIAL_CURRENCY.ACS_FINANCIAL_CURRENCY_ID,
	ACS_FINANCIAL_CURRENCY.PC_CURR_ID,
	ACS_FINANCIAL_CURRENCY.ACS_LOSS_EXCH_EFFECT_ID,
	ACS_FINANCIAL_CURRENCY.ACS_GAIN_EXCH_EFFECT_ID,
	ACS_FINANCIAL_CURRENCY.ACS_LOSS_EXCH_COMP_ID,
	ACS_FINANCIAL_CURRENCY.ACS_GAIN_EXCH_COMP_ID,
	ACS_FINANCIAL_CURRENCY.FIN_LOCAL_CURRENCY,
	ACS_FINANCIAL_CURRENCY.A_CONFIRM,
	ACS_FINANCIAL_CURRENCY.A_DATECRE,
	ACS_FINANCIAL_CURRENCY.A_DATEMOD,
	ACS_FINANCIAL_CURRENCY.A_IDCRE,
	ACS_FINANCIAL_CURRENCY.A_IDMOD,
	ACS_FINANCIAL_CURRENCY.A_RECLEVEL,
	ACS_FINANCIAL_CURRENCY.A_RECSTATUS,
	ACS_FINANCIAL_CURRENCY.FIN_BASE_PRICE,
	ACS_FINANCIAL_CURRENCY.FIN_ROUNDED_AMOUNT,
	ACS_FINANCIAL_CURRENCY.C_ROUND_TYPE,
	ACS_FINANCIAL_CURRENCY.C_PRICE_METHOD,
        ACS_FINANCIAL_CURRENCY.FIN_EURO_FROM,
        ACS_FINANCIAL_CURRENCY.FIN_EURO_RATE,
	PC_CURR.CURRENCY,
	PC_CURR.CURRNAME
FROM
	ACS_FINANCIAL_CURRENCY,
	PCS.PC_CURR
WHERE
	ACS_FINANCIAL_CURRENCY.PC_CURR_ID = PC_CURR.PC_CURR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_FINANCIAL_DIVISION" ("ACS_FINANCIAL_ACCOUNT_ID", "FIN_NUMBER", "FIN_DESCRIPTION_SUMMARY", "FIN_DESCRIPTION_LARGE", "PC_LANG_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DIV_DESCRIPTION_SUMMARY", "DIV_DESCRIPTION_LARGE") AS
  (SELECT
     A.ACS_FINANCIAL_ACCOUNT_ID,
     F.ACC_NUMBER FIN_NUMBER,
     E.DES_DESCRIPTION_SUMMARY FIN_DESCRIPTION_SUMMARY,
     E.DES_DESCRIPTION_LARGE FIN_DESCRIPTION_LARGE,
     C.PC_LANG_ID,
     B.ACS_DIVISION_ACCOUNT_ID,
     D.ACC_NUMBER DIV_NUMBER,
     C.DES_DESCRIPTION_SUMMARY DIV_DESCRIPTION_SUMMARY,
     C.DES_DESCRIPTION_LARGE DIV_DESCRIPTION_LARGE
 FROM
     ACS_FINANCIAL_ACCOUNT A,
     ACS_INTERACTION B,
     ACS_DESCRIPTION C,
     ACS_ACCOUNT D,
     ACS_DESCRIPTION E,
     ACS_ACCOUNT F
 WHERE
     B.ACS_FINANCIAL_ACCOUNT_ID  = A.ACS_FINANCIAL_ACCOUNT_ID   AND
     C.ACS_ACCOUNT_ID = B.ACS_DIVISION_ACCOUNT_ID   AND
     F.ACS_ACCOUNT_ID = B.ACS_FINANCIAL_ACCOUNT_ID   AND
     E.ACS_ACCOUNT_ID = B.ACS_FINANCIAL_ACCOUNT_ID   AND
     D.ACS_ACCOUNT_ID = B.ACS_DIVISION_ACCOUNT_ID AND
     C.PC_LANG_ID = E.PC_LANG_ID
 UNION
 SELECT
     A.ACS_FINANCIAL_ACCOUNT_ID,
     F.ACC_NUMBER FIN_NUMBER,
     E.DES_DESCRIPTION_SUMMARY FIN_DESCRIPTION_SUMMARY,
     E.DES_DESCRIPTION_LARGE FIN_DESCRIPTION_LARGE,
     C.PC_LANG_ID,
     B.ACS_DIVISION_ACCOUNT_ID,
     D.ACC_NUMBER DIV_NUMBER,
     C.DES_DESCRIPTION_SUMMARY DIV_DESCRIPTION_SUMMARY,
     C.DES_DESCRIPTION_LARGE DIV_DESCRIPTION_LARGE
 FROM
     ACS_FINANCIAL_ACCOUNT A,
     ACS_DIVISION_ACCOUNT B,
     ACS_DESCRIPTION C,
     ACS_ACCOUNT D,
     ACS_DESCRIPTION E,
     ACS_ACCOUNT F
 WHERE
     NOT EXISTS (SELECT
     ACS_FINANCIAL_ACCOUNT_ID
 FROM
     ACS_INTERACTION
 WHERE
     ACS_FINANCIAL_ACCOUNT_ID = A.ACS_FINANCIAL_ACCOUNT_ID)    AND
     C.ACS_ACCOUNT_ID = B.ACS_DIVISION_ACCOUNT_ID   AND
     F.ACS_ACCOUNT_ID = A.ACS_FINANCIAL_ACCOUNT_ID   AND
     E.ACS_ACCOUNT_ID = A.ACS_FINANCIAL_ACCOUNT_ID   AND
     D.ACS_ACCOUNT_ID = B.ACS_DIVISION_ACCOUNT_ID AND
     C.PC_LANG_ID = E.PC_LANG_ID)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_FINANCIAL_YEAR" ("ACS_FINANCIAL_YEAR_ID", "C_STATE_FINANCIAL_YEAR", "FYE_NO_EXERCICE", "FYE_START_DATE", "FYE_END_DATE", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE") AS
  select ACS_FINANCIAL_YEAR.ACS_FINANCIAL_YEAR_ID,
       ACS_FINANCIAL_YEAR.C_STATE_FINANCIAL_YEAR,
       ACS_FINANCIAL_YEAR.FYE_NO_EXERCICE,
       ACS_FINANCIAL_YEAR.FYE_START_DATE,
       ACS_FINANCIAL_YEAR.FYE_END_DATE,
       ACS_FINANCIAL_YEAR.A_CONFIRM,
       ACS_FINANCIAL_YEAR.A_DATECRE,
       ACS_FINANCIAL_YEAR.A_DATEMOD,
       ACS_FINANCIAL_YEAR.A_IDCRE,
       ACS_FINANCIAL_YEAR.A_IDMOD,
       ACS_FINANCIAL_YEAR.A_RECLEVEL,
       ACS_FINANCIAL_YEAR.A_RECSTATUS,
       ACS_DESCRIPTION.PC_LANG_ID,
       ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
       ACS_DESCRIPTION.DES_DESCRIPTION_LARGE
from ACS_DESCRIPTION,
     ACS_FINANCIAL_YEAR
where ACS_FINANCIAL_YEAR.ACS_FINANCIAL_YEAR_ID = ACS_DESCRIPTION.ACS_FINANCIAL_YEAR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_FIN_ACC_S_PAYMENT" ("ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "ACC_BLOCKED", "PME_MODELNAME", "FILE_NAME", "PME_SENDER", "PME_PRINCIPAL", "PME_SBVR", "C_TYPE_SUPPORT", "C_METHOD_CATEGORY", "C_TYP_ADD_COMM", "C_ISO20022_VERSION", "ACS_PAYMENT_METHOD_ID", "DES_DESCRIPTION_SUMMARY2", "ACS_FINANCIAL_ACCOUNT_ID", "ACJ_NUMBER_METHOD_ID", "FIN_ETAB_ACCOUNT", "FIN_ACCOUNT_CONTROL", "FIN_IBAN_FORMAT", "FIN_BIC_NUMBER", "BAN_CLEAR", "BAN_GUICH", "BAN_ETAB", "BAN_DOMIC", "BAN_BLZ", "BAN_SWIFT", "BAN_NAME1", "ACS_FIN_ACC_S_PAYMENT_ID", "ACS_FINANCIAL_YEAR_ID", "PMM_LAST_NUMBER", "PAC_CUSTOM_PARTNER_ID", "PMM_WORDING_DELIVERY", "PMM_AVAILABLE_UNTIL", "PMM_COVER_GENERATION", "PMM_ONE_PARTNER_DOC", "C_PART_DOC_GENERATION", "PME_DELETE_FILE", "PME_PARTNER_GROUP", "PME_OPAE_DEBIT", "PME_OPAE_TAX_DEBIT", "PME_OPAE_RECIPIENT_ADVICE", "SOLDE") AS
  select ACS_ACCOUNT.ACC_NUMBER
       , ACS_DESCRIPTION1.DES_DESCRIPTION_SUMMARY
       , ACS_ACCOUNT.ACC_BLOCKED
       , ACS_PAYMENT_METHOD.PME_MODELNAME
       , ACS_PAYMENT_METHOD.PME_PATH || ACS_PAYMENT_METHOD.PME_FILENAME as FILE_NAME
       , ACS_PAYMENT_METHOD.PME_SENDER
       , ACS_PAYMENT_METHOD.PME_PRINCIPAL
       , ACS_PAYMENT_METHOD.PME_SBVR
       , ACS_PAYMENT_METHOD.C_TYPE_SUPPORT
       , ACS_PAYMENT_METHOD.C_METHOD_CATEGORY
       , ACS_PAYMENT_METHOD.C_TYP_ADD_COMM
       , ACS_PAYMENT_METHOD.C_ISO20022_VERSION
       , ACS_PAYMENT_METHOD.ACS_PAYMENT_METHOD_ID
       , ACS_DESCRIPTION2.DES_DESCRIPTION_SUMMARY DES_DESCRIPTION_SUMMARY2
       , ACS_FIN_ACC_S_PAYMENT.ACS_FINANCIAL_ACCOUNT_ID
       , ACS_FIN_ACC_S_PAYMENT.ACJ_NUMBER_METHOD_ID
       , ACS_FINANCIAL_ACCOUNT.FIN_ETAB_ACCOUNT
       , ACS_FINANCIAL_ACCOUNT.FIN_ACCOUNT_CONTROL
       , ACS_FINANCIAL_ACCOUNT.FIN_IBAN_FORMAT
       , ACS_FINANCIAL_ACCOUNT.FIN_BIC_NUMBER
       , PC_BANK.BAN_CLEAR
       , PC_BANK.BAN_GUICH
       , PC_BANK.BAN_ETAB
       , PC_BANK.BAN_DOMIC
       , PC_BANK.BAN_BLZ
       , PC_BANK.BAN_SWIFT
       , PC_BANK.BAN_NAME1
       , ACS_FIN_ACC_S_PAYMENT.ACS_FIN_ACC_S_PAYMENT_ID
       , ACS_FINANCIAL_YEAR.ACS_FINANCIAL_YEAR_ID
       , (ACS_FIN_ACC_S_PAYMENT.PMM_LAST_NUMBER + 1) as PMM_LAST_NUMBER
       , ACS_FIN_ACC_S_PAYMENT.PAC_CUSTOM_PARTNER_ID
       , ACS_FIN_ACC_S_PAYMENT.PMM_WORDING_DELIVERY
       , ACS_FIN_ACC_S_PAYMENT.PMM_AVAILABLE_UNTIL
       , ACS_FIN_ACC_S_PAYMENT.PMM_COVER_GENERATION
       , ACS_FIN_ACC_S_PAYMENT.PMM_ONE_PARTNER_DOC
       , ACS_FIN_ACC_S_PAYMENT.C_PART_DOC_GENERATION
       , ACS_PAYMENT_METHOD.PME_DELETE_FILE
       , ACS_PAYMENT_METHOD.PME_PARTNER_GROUP
       , ACS_PAYMENT_METHOD.PME_OPAE_DEBIT
       , ACS_PAYMENT_METHOD.PME_OPAE_TAX_DEBIT
       , ACS_PAYMENT_METHOD.PME_OPAE_RECIPIENT_ADVICE
       , ACS_FUNCTION.SoldeAccount(ACS_FINANCIAL_YEAR.ACS_FINANCIAL_YEAR_ID
                                 , ACS_FIN_ACC_S_PAYMENT.ACS_FINANCIAL_ACCOUNT_ID
                                  ) SOLDE
    from ACS_DESCRIPTION ACS_DESCRIPTION1
       , ACS_DESCRIPTION ACS_DESCRIPTION2
       , ACS_ACCOUNT
       , ACS_FINANCIAL_ACCOUNT
       , PCS.PC_BANK
       , ACS_FIN_ACC_S_PAYMENT
       , ACS_PAYMENT_METHOD
       , ACS_FINANCIAL_YEAR
   where ACS_DESCRIPTION1.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GETUSERLANGID
     and ACS_DESCRIPTION2.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GETUSERLANGID
     and ACS_FIN_ACC_S_PAYMENT.ACS_FINANCIAL_ACCOUNT_ID = ACS_ACCOUNT.ACS_ACCOUNT_ID
     and ACS_FIN_ACC_S_PAYMENT.ACS_PAYMENT_METHOD_ID = ACS_PAYMENT_METHOD.ACS_PAYMENT_METHOD_ID
     and ACS_DESCRIPTION1.ACS_ACCOUNT_ID = ACS_ACCOUNT.ACS_ACCOUNT_ID
     and ACS_PAYMENT_METHOD.ACS_PAYMENT_METHOD_ID = ACS_DESCRIPTION2.ACS_PAYMENT_METHOD_ID
     and ACS_FIN_ACC_S_PAYMENT.ACS_FINANCIAL_ACCOUNT_ID = ACS_FINANCIAL_ACCOUNT.ACS_FINANCIAL_ACCOUNT_ID(+)
     and ACS_FINANCIAL_ACCOUNT.PC_BANK_ID = PC_BANK.PC_BANK_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_MGM_INTERACTION" ("ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "CDA_NUMBER", "ACS_PF_ACCOUNT_ID", "PF_NUMBER", "ACS_PJ_ACCOUNT_ID", "PJ_NUMBER", "MGM_DEFAULT", "MGM_VALID_SINCE", "MGM_VALID_TO") AS
  SELECT
  AMI.ACS_CPN_ACCOUNT_ID,
  AMI.ACS_CDA_ACCOUNT_ID,
  ACS_FUNCTION.GETACCOUNTNUMBER(AMI.ACS_CDA_ACCOUNT_ID),
  AMI.ACS_PF_ACCOUNT_ID,
  ACS_FUNCTION.GETACCOUNTNUMBER(AMI.ACS_PF_ACCOUNT_ID),
  AMI.ACS_PJ_ACCOUNT_ID,
  ACS_FUNCTION.GETACCOUNTNUMBER(AMI.ACS_PJ_ACCOUNT_ID),
  AMI.MGM_DEFAULT,
  AMI.MGM_VALID_SINCE,
  AMI.MGM_VALID_TO
FROM
  ACS_MGM_INTERACTION AMI




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_PAY_METHOD_ISAG" ("ACS_PAYMENT_METHOD_ID", "C_TYPE_SUPPORT", "PME_SBVR", "DES_DESCRIPTION_SUMMARY", "LANID", "ACC_NUMBER", "FIN_ETAB_ACCOUNT", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD", "ACS_FIN_ACC_S_PAYMENT_ID", "PMM_AVAILABLE_UNTIL") AS
  SELECT
PME.ACS_PAYMENT_METHOD_ID,
PME.C_TYPE_SUPPORT,
PME.PME_SBVR,
DES.DES_DESCRIPTION_SUMMARY,
LAN.LANID||'' LANID,
ACC.ACC_NUMBER,
FIN.FIN_ETAB_ACCOUNT,
PME.A_DATECRE,
PME.A_IDCRE,
PME.A_DATEMOD,
PME.A_IDMOD,
PMM.ACS_FIN_ACC_S_PAYMENT_ID,
PMM.PMM_AVAILABLE_UNTIL
FROM
PCS.PC_LANG LAN,
ACS_FINANCIAL_ACCOUNT FIN,
ACS_ACCOUNT ACC,
ACS_FIN_ACC_S_PAYMENT PMM,
ACS_DESCRIPTION DES,
ACS_PAYMENT_METHOD PME
WHERE
    PME.ACS_PAYMENT_METHOD_ID = PMM.ACS_PAYMENT_METHOD_ID
AND PME.C_TYPE_SUPPORT IN ('33','34','35','50','51','56')
AND PMM.ACS_FINANCIAL_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
AND ACC.ACS_ACCOUNT_ID = FIN.ACS_FINANCIAL_ACCOUNT_ID
AND PME.ACS_PAYMENT_METHOD_ID = DES.ACS_PAYMENT_METHOD_ID
AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_PERIOD" ("ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "C_TYPE_PERIOD", "PER_START_DATE", "PER_END_DATE", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE") AS
  select ACS_PERIOD.ACS_PERIOD_ID, ACS_PERIOD.ACS_FINANCIAL_YEAR_ID,
ACS_PERIOD.PER_NO_PERIOD, ACS_PERIOD.C_STATE_PERIOD, ACS_PERIOD.C_TYPE_PERIOD,
ACS_PERIOD.PER_START_DATE, ACS_PERIOD.PER_END_DATE, ACS_PERIOD.A_CONFIRM,
ACS_PERIOD.A_DATECRE, ACS_PERIOD.A_DATEMOD, ACS_PERIOD.A_IDCRE,
ACS_PERIOD.A_IDMOD, ACS_PERIOD.A_RECLEVEL, ACS_PERIOD.A_RECSTATUS,
ACS_DESCRIPTION.PC_LANG_ID, ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
ACS_DESCRIPTION.DES_DESCRIPTION_LARGE
from ACS_PERIOD, ACS_DESCRIPTION
where ACS_PERIOD.ACS_PERIOD_ID = ACS_DESCRIPTION.ACS_PERIOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_PERIODS" ("ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_START_DATE", "PER_END_DATE", "PER_NO_PERIOD", "DES_DESCRIPTION_SUMMARY", "PC_LANG_ID", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "C_TYPE_CUMUL", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACS_ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "PC_CURR_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_PERIOD", "C_STATE_PERIOD", "ACS_DIVISION_ACCOUNT_ID") AS
  select
ACS_PERIOD.ACS_PERIOD_ID,
ACS_PERIOD.ACS_FINANCIAL_YEAR_ID,
ACS_PERIOD.PER_START_DATE,
ACS_PERIOD.PER_END_DATE,
ACS_PERIOD.PER_NO_PERIOD,
ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
ACS_DESCRIPTION.PC_LANG_ID,
ACT_TOTAL_BY_PERIOD.TOT_DEBIT_LC,
ACT_TOTAL_BY_PERIOD.TOT_CREDIT_LC,
ACT_TOTAL_BY_PERIOD.TOT_DEBIT_FC,
ACT_TOTAL_BY_PERIOD.TOT_CREDIT_FC,
ACT_TOTAL_BY_PERIOD.TOT_DEBIT_EUR,
ACT_TOTAL_BY_PERIOD.TOT_CREDIT_EUR,
ACT_TOTAL_BY_PERIOD.C_TYPE_CUMUL,
ACT_TOTAL_BY_PERIOD.ACS_FINANCIAL_ACCOUNT_ID,
ACT_TOTAL_BY_PERIOD.ACS_AUXILIARY_ACCOUNT_ID,
ACT_TOTAL_BY_PERIOD.ACS_ACS_AUXILIARY_ACCOUNT_ID,
ACT_TOTAL_BY_PERIOD.ACS_FINANCIAL_CURRENCY_ID,
ACS_FINANCIAL_CURRENCY.PC_CURR_ID,
ACT_TOTAL_BY_PERIOD.ACS_ACS_FINANCIAL_CURRENCY_ID,
ACS_PERIOD.C_TYPE_PERIOD,
ACS_PERIOD.C_STATE_PERIOD,
ACT_TOTAL_BY_PERIOD.ACS_DIVISION_ACCOUNT_ID
from
ACS_DESCRIPTION,
ACT_TOTAL_BY_PERIOD,
ACS_PERIOD,
ACS_FINANCIAL_CURRENCY
where
ACS_PERIOD.ACS_PERIOD_ID = ACT_TOTAL_BY_PERIOD.ACS_PERIOD_ID
and ACS_PERIOD.ACS_PERIOD_ID = ACS_DESCRIPTION.ACS_PERIOD_ID
and ACT_TOTAL_BY_PERIOD.ACS_FINANCIAL_CURRENCY_ID = ACS_FINANCIAL_CURRENCY.ACS_FINANCIAL_CURRENCY_ID (+)
UNION
(SELECT
ACS_PERIOD.ACS_PERIOD_ID,
ACS_PERIOD.ACS_FINANCIAL_YEAR_ID,
ACS_PERIOD.PER_START_DATE,
ACS_PERIOD.PER_END_DATE,
ACS_PERIOD.PER_NO_PERIOD,
ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
ACS_DESCRIPTION.PC_LANG_ID,
0 AS TOT_DEBIT_LC, 0 AS TOT_CREDIT_LC,
0 AS TOT_DEBIT_FC, 0 AS TOT_CREDIT_FC,
0 AS TOT_DEBIT_EUR, 0 AS TOT_CREDIT_EUR,
'INT' AS C_TYPE_CUMUL,
0 AS ACS_FINANCIAL_ACCOUNT_ID,
0 AS ACS_AUXILIARY_ACCOUNT_ID,
0 AS ACS_ACS_AUXILIARY_ACCOUNT_ID,
0 AS ACS_FINANCIAL_CURRENCY_ID,
0 AS PC_CURR_ID,
0 AS ACS_ACS_FINANCIAL_CURRENCY_ID,
ACS_PERIOD.C_TYPE_PERIOD,
ACS_PERIOD.C_STATE_PERIOD,
TO_NUMBER('') AS ACS_DIVISION_ACCOUNT_ID
FROM
ACS_DESCRIPTION,
ACS_PERIOD,
ACS_FINANCIAL_CURRENCY
WHERE
ACS_PERIOD.ACS_PERIOD_ID = ACS_DESCRIPTION.ACS_PERIOD_ID )




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_PERIOD_ACCOUNT" ("ACS_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "C_TYPE_PERIOD", "PER_START_DATE", "PER_END_DATE", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE") AS
  select ACS_ACCOUNT.ACS_ACCOUNT_ID,
       ACS_PERIOD.ACS_PERIOD_ID,
       ACS_PERIOD.ACS_FINANCIAL_YEAR_ID,
       ACS_PERIOD.PER_NO_PERIOD,
       ACS_PERIOD.C_STATE_PERIOD,
       ACS_PERIOD.C_TYPE_PERIOD,
       ACS_PERIOD.PER_START_DATE,
       ACS_PERIOD.PER_END_DATE,
       ACS_PERIOD.A_CONFIRM,
       ACS_PERIOD.A_DATECRE,
       ACS_PERIOD.A_DATEMOD,
       ACS_PERIOD.A_IDCRE,
       ACS_PERIOD.A_IDMOD,
       ACS_PERIOD.A_RECLEVEL,
       ACS_PERIOD.A_RECSTATUS,
       ACS_DESCRIPTION.PC_LANG_ID,
       ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
       ACS_DESCRIPTION.DES_DESCRIPTION_LARGE
from ACS_DESCRIPTION,
     ACS_ACCOUNT,
     ACS_PERIOD,
     ACS_FINANCIAL_YEAR
where ACS_PERIOD.ACS_PERIOD_ID         = ACS_DESCRIPTION.ACS_PERIOD_ID
  and ACS_PERIOD.ACS_FINANCIAL_YEAR_ID = ACS_FINANCIAL_YEAR.ACS_FINANCIAL_YEAR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_PF_ISAG" ("ACS_PF_ACCOUNT_ID", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
PF.ACS_PF_ACCOUNT_ID,
ACC.ACC_NUMBER,
DES.DES_DESCRIPTION_SUMMARY,
DES.DES_DESCRIPTION_LARGE,
LAN.LANID||'' LANID,
PF.A_DATECRE,
PF.A_IDCRE,
PF.A_DATEMOD,
PF.A_IDMOD
FROM
ACS_DESCRIPTION DES,
PCS.PC_LANG LAN,
ACS_ACCOUNT ACC,
ACS_PF_ACCOUNT PF
WHERE
    PF.ACS_PF_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
AND ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_QTY_ISAG" ("ACS_QTY_UNIT_ID", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select QTY.ACS_QTY_UNIT_ID
       , ACC.ACC_NUMBER
       , DES.DES_DESCRIPTION_SUMMARY
       , DES.DES_DESCRIPTION_LARGE
       , LAN.LANID || '' LANID
       , QTY.A_DATECRE
       , QTY.A_IDCRE
       , QTY.A_DATEMOD
       , QTY.A_IDMOD
    from ACS_DESCRIPTION DES
       , PCS.PC_LANG LAN
       , ACS_ACCOUNT ACC
       , ACS_QTY_UNIT QTY
   where QTY.ACS_QTY_UNIT_ID = ACC.ACS_ACCOUNT_ID
     and ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
     and DES.PC_LANG_ID = LAN.PC_LANG_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_TAX_CODE" ("ACS_TAX_CODE_ID", "ACS_PREA_ACCOUNT_ID", "ACS_PROV_ACCOUNT_ID", "C_TYPE_TAX", "C_ROUND_TYPE", "C_ESTABLISHING_CALC_SHEET", "DIC_TYPE_SUBMISSION_ID", "DIC_TYPE_MOVEMENT_ID", "TAX_RATE", "TAX_ROUNDED_AMOUNT", "TAX_LIABLED_RATE", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_VAT_DET_ACCOUNT_ID", "DIC_TYPE_VAT_GOOD_ID", "DIC_NO_POS_CALC_SHEET_ID", "ACS_SUB_SET_ID", "C_VALID", "ACC_NUMBER", "ACC_DETAIL_PRINTING", "ACC_BLOCKED", "ACC_INTEREST", "ACC_VALID_SINCE", "ACC_VALID_TO", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE") AS
  select ACS_TAX_CODE.ACS_TAX_CODE_ID,
       ACS_TAX_CODE.ACS_PREA_ACCOUNT_ID,
       ACS_TAX_CODE.ACS_PROV_ACCOUNT_ID,
       ACS_TAX_CODE.C_TYPE_TAX,
       ACS_TAX_CODE.C_ROUND_TYPE,
       ACS_TAX_CODE.C_ESTABLISHING_CALC_SHEET,
       ACS_TAX_CODE.DIC_TYPE_SUBMISSION_ID,
       ACS_TAX_CODE.DIC_TYPE_MOVEMENT_ID,
       ACS_TAX_CODE.TAX_RATE,
       ACS_TAX_CODE.TAX_ROUNDED_AMOUNT,
       ACS_TAX_CODE.TAX_LIABLED_RATE,
       ACS_TAX_CODE.A_CONFIRM,
       ACS_TAX_CODE.A_DATECRE,
       ACS_TAX_CODE.A_DATEMOD,
       ACS_TAX_CODE.A_IDCRE,
       ACS_TAX_CODE.A_IDMOD,
       ACS_TAX_CODE.A_RECLEVEL,
       ACS_TAX_CODE.A_RECSTATUS,
       ACS_TAX_CODE.ACS_VAT_DET_ACCOUNT_ID,
       ACS_TAX_CODE.DIC_TYPE_VAT_GOOD_ID,
       ACS_TAX_CODE.DIC_NO_POS_CALC_SHEET_ID,
       ACS_ACCOUNT.ACS_SUB_SET_ID,
       ACS_ACCOUNT.C_VALID,
       ACS_ACCOUNT.ACC_NUMBER,
       ACS_ACCOUNT.ACC_DETAIL_PRINTING,
       ACS_ACCOUNT.ACC_BLOCKED,
       ACS_ACCOUNT.ACC_INTEREST,
       ACS_ACCOUNT.ACC_VALID_SINCE,
       ACS_ACCOUNT.ACC_VALID_TO,
       ACS_DESCRIPTION.PC_LANG_ID,
       ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY,
       ACS_DESCRIPTION.DES_DESCRIPTION_LARGE
from ACS_DESCRIPTION,
     ACS_ACCOUNT,
     ACS_TAX_CODE,
     ACS_SUB_SET
where ACS_TAX_CODE.ACS_TAX_CODE_ID = ACS_ACCOUNT.ACS_ACCOUNT_ID
  and ACS_ACCOUNT.ACS_ACCOUNT_ID   = ACS_DESCRIPTION.ACS_ACCOUNT_ID
  and ACS_SUB_SET.ACS_SUB_SET_ID   = ACS_ACCOUNT.ACS_SUB_SET_ID
  and ACS_SUB_SET.C_TYPE_SUB_SET   = 'TAX'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACS_VAT_ISAG" ("ACS_TAX_CODE_ID", "ACC_NUMBER", "DES_DESCRIPTION_SUMMARY", "TAX_RATE", "DES_DESCRIPTION_LARGE", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
VAT.ACS_TAX_CODE_ID,
ACC.ACC_NUMBER,
DES.DES_DESCRIPTION_SUMMARY,
ACS_FUNCTION.GetVatRate(VAT.ACS_TAX_CODE_ID,TO_CHAR(TRUNC(SYSDATE),'YYYMMDD')) TAX_RATE,
DES.DES_DESCRIPTION_LARGE,
LAN.LANID||'' LANID,
VAT.A_DATECRE,
VAT.A_IDCRE,
VAT.A_DATEMOD,
VAT.A_IDMOD
FROM
ACS_DESCRIPTION DES,
PCS.PC_LANG LAN,
ACS_ACCOUNT ACC,
ACS_TAX_CODE VAT
WHERE
    VAT.ACS_TAX_CODE_ID = ACC.ACS_ACCOUNT_ID
AND ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
AND DES.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_ACC_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "FINANCIAL_IMPUTATION_ID", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD", "FYE_NO_EXERCICE", "C_STATE_FINANCIAL_YEAR") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID
       , IMP.ACS_PERIOD_ID
       , IMP.ACT_DOCUMENT_ID
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_TYPE
       , IMP.IMF_PRIMARY
       , IMP.IMF_DESCRIPTION
       , IMP.IMF_AMOUNT_LC_D
       , IMP.IMF_AMOUNT_LC_C
       , IMP.IMF_EXCHANGE_RATE
       , IMP.IMF_AMOUNT_FC_D
       , IMP.IMF_AMOUNT_FC_C
       , IMP.IMF_AMOUNT_EUR_D
       , IMP.IMF_AMOUNT_EUR_C
       , IMP.IMF_VALUE_DATE
       , IMP.ACS_TAX_CODE_ID
       , IMP.IMF_TRANSACTION_DATE
       , IMP.ACS_FINANCIAL_CURRENCY_ID
       , IMP.C_GENRE_TRANSACTION
       , IMP.A_CONFIRM
       , IMP.A_DATECRE
       , IMP.A_DATEMOD
       , IMP.A_IDCRE
       , IMP.A_IDMOD
       , IMP.A_RECLEVEL
       , IMP.A_RECSTATUS
       , ACT_FUNCTIONS.AuxAccountFromImputation(IMP.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID
       , IMP.ACT_DET_PAYMENT_ID
       , IMP.ACS_ACS_FINANCIAL_CURRENCY_ID
       , IMP.IMF_GENRE
       , IMP.IMF_BASE_PRICE
       , IMP.ACT_PART_IMPUTATION_ID
       , (select COV.COV_NUMBER
            from ACT_COVER_INFORMATION COV
           where COV.ACT_COVER_INFORMATION_ID =
                   (select nvl( (select DOC.ACT_COVER_INFORMATION_ID
                                   from ACT_DOCUMENT DOC
                                      , ACT_COVER_DISCHARGED COD
                                      , ACT_FINANCIAL_IMPUTATION IMPCOV
                                  where (select count(IMPCOV.ACT_FINANCIAL_IMPUTATION_ID) TOT_IMPS
                                           from ACT_FINANCIAL_IMPUTATION IMPCTRL
                                          where IMPCTRL.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
                                            and IMPCTRL.ACT_FINANCIAL_IMPUTATION_ID <> IMP.ACT_FINANCIAL_IMPUTATION_ID) = 1
                                    and DOC.ACT_DOCUMENT_ID = COD.ACT_DOCUMENT_ID
                                    and COD.ACT_FINANCIAL_IMPUTATION_ID = IMPCOV.ACT_FINANCIAL_IMPUTATION_ID
                                    and IMPCOV.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)
                             , DOC.ACT_COVER_INFORMATION_ID
                              )
                      from dual) ) COV_NUMBER
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , FIN.ACC_NUMBER
       , (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID
            from ACT_FINANCIAL_DISTRIBUTION DIS
           where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , (select DIV.ACC_NUMBER
            from ACS_ACCOUNT DIV
           where DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER
       , DOC.DOC_NUMBER
       , DOC.DOC_COMMENT
       , DOC.ACJ_CATALOGUE_DOCUMENT_ID
       , DOC.ACT_JOURNAL_ID
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , (select JOU.JOU_DESCRIPTION
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION
       , ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
       , IMP.IMF_COMPARE_DATE
       , IMP.IMF_COMPARE_TEXT
       , IMP.IMF_COMPARE_USE_INI
       , IMP.IMF_TEXT1
       , IMP.IMF_TEXT2
       , IMP.IMF_TEXT3
       , IMP.IMF_TEXT4
       , IMP.IMF_TEXT5
       , IMP.IMF_NUMBER
       , IMP.IMF_NUMBER2
       , IMP.IMF_NUMBER3
       , IMP.IMF_NUMBER4
       , IMP.IMF_NUMBER5
       , IMP.DIC_IMP_FREE1_ID
       , IMP.DIC_IMP_FREE2_ID
       , IMP.DIC_IMP_FREE3_ID
       , IMP.DIC_IMP_FREE4_ID
       , IMP.DIC_IMP_FREE5_ID
       , IMP.GCO_GOOD_ID
       , IMP.HRM_PERSON_ID
       , IMP.DOC_RECORD_ID
       , IMP.FAM_FIXED_ASSETS_ID
       , IMP.C_FAM_TRANSACTION_TYP
       , IMP.PAC_PERSON_ID
       , DOC.ACT_ACT_JOURNAL_ID
       , (select ETA.C_ETAT_JOURNAL
            from ACT_ETAT_JOURNAL ETA
           where ETA.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
             and ETA.C_SUB_SET = 'ACC') C_ETAT_JOURNAL
       , (select SCA.C_TYPE_CUMUL
            from ACJ_SUB_SET_CAT SCA
           where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
             and SCA.C_SUB_SET = 'ACC') C_TYPE_CUMUL
       , PER.C_TYPE_PERIOD
       , YEA.FYE_NO_EXERCICE
       , YEA.C_STATE_FINANCIAL_YEAR
    from ACS_PERIOD PER
       , ACS_FINANCIAL_YEAR YEA
       , ACT_FINANCIAL_IMPUTATION IMP
       , ACS_ACCOUNT FIN
       , ACS_SUB_SET SUB
       , ACT_DOCUMENT DOC
       , ACT_PART_IMPUTATION PAR
   where SUB.ACS_SUB_SET_ID = FIN.ACS_SUB_SET_ID
     and SUB.C_SUB_SET = 'ACC'
     and DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
     and PAR.ACT_PART_IMPUTATION_ID (+) = IMP.ACT_PART_IMPUTATION_ID
     and FIN.ACC_NUMBER >= ACR_FUNCTIONS.GetAccNumber(1)
     and FIN.ACC_NUMBER <= ACR_FUNCTIONS.GetAccNumber(0)
     and FIN.ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID
     and IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and YEA.ACS_FINANCIAL_YEAR_ID = PER.ACS_FINANCIAL_YEAR_ID
     and PER.ACS_FINANCIAL_YEAR_ID =
                            decode(ACR_FUNCTIONS.GetFinYearId
                                 , 0, PER.ACS_FINANCIAL_YEAR_ID
                                 , ACR_FUNCTIONS.GetFinYearId
                                  )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_ACC_IMP_REPORT" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID") AS
  select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       IMF_COMPARE_DATE,
       IMF_COMPARE_TEXT,
       IMF_COMPARE_USE_INI,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID
  from V_ACT_ACC_IMPUTATION
      where C_TYPE_PERIOD <> '1'
union all
select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       IMF_COMPARE_DATE,
       IMF_COMPARE_TEXT,
       IMF_COMPARE_USE_INI,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID
  from V_ACT_ACC_IMPUTATION
    where C_TYPE_PERIOD = '1'
    and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_FINANCIAL_IMPUTATION_ID,
       TOT.ACS_PERIOD_ID,
       0 ACT_DOCUMENT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       'MAN' IMF_TYPE,
       0 IMF_PRIMARY,
       'Report' IMF_DESCRIPTION,
       TOT.TOT_DEBIT_LC  IMF_AMOUNT_LC_D,
       TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C,
       0 IMF_EXCHANGE_RATE,
       TOT.TOT_DEBIT_FC   IMF_AMOUNT_FC_D,
       TOT.TOT_CREDIT_FC  IMF_AMOUNT_FC_C,
       TOT.TOT_DEBIT_EUR  IMF_AMOUNT_EUR_D,
       TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C,
       TOT.PER_START_DATE IMF_VALUE_DATE,
       0 ACS_TAX_CODE_ID,
       TOT.PER_START_DATE IMF_TRANSACTION_DATE,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
       '1' C_GENRE_TRANSACTION,
       0 ACS_AUXILIARY_ACCOUNT_ID,
       0 ACT_DET_PAYMENT_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
       0 IMF_BASE_PRICE,
       0 ACT_PART_IMPUTATION_ID,
       '' COV_NUMBER,
       '' PAR_DOCUMENT,
       TO_DATE(null) DOC_DATE_DELIVERY,
       TOT.ACC_NUMBER,
       0 ACT_FINANCIAL_DISTRIBUTION_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       (SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = TOT.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       '' JOU_DESCRIPTION,
       0 FINANCIAL_IMPUTATION_ID,
       0 ACT_ACT_JOURNAL_ID,
       'PROV' C_ETAT_JOURNAL,
       TOT.C_TYPE_CUMUL,
       TOT.PER_START_DATE IMF_COMPARE_DATE,
       '' IMF_COMPARE_TEXT,
       '' IMF_COMPARE_USE_INI,
       '' IMF_TEXT1,
       '' IMF_TEXT2,
       '' IMF_TEXT3,
       '' IMF_TEXT4,
       '' IMF_TEXT5,
       0 IMF_NUMBER,
       0 IMF_NUMBER2,
       0 IMF_NUMBER3,
       0 IMF_NUMBER4,
       0 IMF_NUMBER5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_MIP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 GCO_GOOD_ID,
       0 HRM_PERSON_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 PAC_PERSON_ID
  from
       V_ACT_ACC_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_ACC_PREV_YEAR_TOTAL" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE") AS
  select
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC) , 0)), -1, 0,  nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC),  0))  TOT_DEBIT_LC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC) , 0)),  1, 0, -nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC),  0))  TOT_CREDIT_LC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC) , 0)), -1, 0,  nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC),  0))  TOT_DEBIT_FC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC) , 0)),  1, 0, -nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC),  0))  TOT_CREDIT_FC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)), -1, 0,  nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0))  TOT_DEBIT_EUR,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)),  1, 0, -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0))  TOT_CREDIT_EUR,
       TOT.ACS_PERIOD_ID,
       PER.PER_START_DATE
  from
        ACS_ACCOUNT           ACC,
        ACT_TOTAL_BY_PERIOD   TOT,
        ACS_PERIOD            PER
  where
        ACC.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
    and ACC.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_FINANCIAL_YEAR_ID       = ACR_FUNCTIONS.GetFinYearId
    and PER.ACS_PERIOD_ID               = TOT.ACS_PERIOD_ID
    and PER.C_TYPE_PERIOD               = '1'
    and TOT.ACS_FINANCIAL_ACCOUNT_ID    = ACC.ACS_ACCOUNT_ID
    and TOT.ACS_AUXILIARY_ACCOUNT_ID+0  is null
    and ((TOT.ACS_DIVISION_ACCOUNT_ID is not null) or (TOT.ACS_DIVISION_ACCOUNT_ID is null and ACR_FUNCTIONS.ExistDivision = 0))
  group by
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL,
       TOT.ACS_PERIOD_ID,
       PER.PER_START_DATE




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_CDA_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD") AS
  select
       MGM.ACT_MGM_IMPUTATION_ID,
       MGM.ACT_FINANCIAL_IMPUTATION_ID,
       MGM.ACS_PERIOD_ID,
       MGM.IMM_VALUE_DATE,
       MGM.IMM_TRANSACTION_DATE,
       MGM.IMM_TYPE,
       MGM.IMM_GENRE,
       MGM.IMM_PRIMARY,
       MGM.IMM_DESCRIPTION,
       MGM.ACS_CDA_ACCOUNT_ID,
       MGM.ACS_CPN_ACCOUNT_ID,
       MGM.ACS_PF_ACCOUNT_ID,
       DIS.ACS_PJ_ACCOUNT_ID,
       MGM.ACS_QTY_UNIT_ID,
       nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D,
       nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C,
       nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D,
       nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C,
       nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D,
       nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_D, MGM.IMM_AMOUNT_EUR_D), 0) IMM_AMOUNT_EUR_D,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_C, MGM.IMM_AMOUNT_EUR_C), 0) IMM_AMOUNT_EUR_C,
       MGM.ACS_FINANCIAL_CURRENCY_ID,
       MGM.ACS_ACS_FINANCIAL_CURRENCY_ID,
       MGM.IMM_EXCHANGE_RATE,
       MGM.IMM_BASE_PRICE,
       MGM.ACT_DOCUMENT_ID,
       MGM.IMM_NUMBER,
       MGM.IMM_NUMBER2,
       MGM.IMM_NUMBER3,
       MGM.IMM_NUMBER4,
       MGM.IMM_NUMBER5,
       MGM.IMM_TEXT1,
       MGM.IMM_TEXT2,
       MGM.IMM_TEXT3,
       MGM.IMM_TEXT4,
       MGM.IMM_TEXT5,
       MGM.DIC_IMP_FREE1_ID,
       MGM.DIC_IMP_FREE2_ID,
       MGM.DIC_IMP_FREE3_ID,
       MGM.DIC_IMP_FREE4_ID,
       MGM.DIC_IMP_FREE5_ID,
       MGM.HRM_PERSON_ID,
       MGM.GCO_GOOD_ID,
       MGM.DOC_RECORD_ID,
       MGM.FAM_FIXED_ASSETS_ID,
       MGM.C_FAM_TRANSACTION_TYP,
       MGM.PAC_PERSON_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       CDA.ACC_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       JOU.ACT_JOURNAL_ID,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       (select ETA.C_ETAT_JOURNAL
        from ACT_ETAT_JOURNAL ETA
        where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
          and ETA.C_SUB_SET      = 'CPN') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                   = 'CPN') C_TYPE_CUMUL,
       PER.C_TYPE_PERIOD
  from
       ACT_JOURNAL              JOU,
       ACT_DOCUMENT             DOC,
       ACS_PERIOD               PER,
       ACT_MGM_IMPUTATION       MGM,
       ACT_MGM_DISTRIBUTION     DIS,
       ACT_FINANCIAL_IMPUTATION IMP,
       ACS_ACCOUNT              CDA
  where
        CDA.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
    and CDA.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
    and CDA.ACS_ACCOUNT_ID              = MGM.ACS_CDA_ACCOUNT_ID
    and MGM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID (+)
    and MGM.ACT_MGM_IMPUTATION_ID       = DIS.ACT_MGM_IMPUTATION_ID (+)
    and MGM.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and MGM.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID
    and DOC.ACT_ACT_JOURNAL_ID          = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_CDA_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select  ACT_MGM_IMPUTATION_ID,
          ACT_FINANCIAL_IMPUTATION_ID,
          ACS_PERIOD_ID,
          IMM_VALUE_DATE,
          IMM_TRANSACTION_DATE,
          IMM_TYPE,
          IMM_GENRE,
          IMM_PRIMARY,
          IMM_DESCRIPTION,
          ACS_CDA_ACCOUNT_ID,
          ACS_CPN_ACCOUNT_ID,
          ACS_PF_ACCOUNT_ID,
          ACS_PJ_ACCOUNT_ID,
          ACS_QTY_UNIT_ID,
          IMM_QUANTITY_D,
          IMM_QUANTITY_C,
          IMM_AMOUNT_LC_D,
          IMM_AMOUNT_LC_C,
          IMM_AMOUNT_FC_D,
          IMM_AMOUNT_FC_C,
          IMM_AMOUNT_EUR_D,
          IMM_AMOUNT_EUR_C,
          ACS_FINANCIAL_CURRENCY_ID,
          ACS_ACS_FINANCIAL_CURRENCY_ID,
          IMM_EXCHANGE_RATE,
          IMM_BASE_PRICE,
          ACS_FINANCIAL_ACCOUNT_ID,
          ACC_NUMBER,
          IMM_NUMBER,
          IMM_NUMBER2,
          IMM_NUMBER3,
          IMM_NUMBER4,
          IMM_NUMBER5,
          IMM_TEXT1,
          IMM_TEXT2,
          IMM_TEXT3,
          IMM_TEXT4,
          IMM_TEXT5,
          DIC_IMP_FREE1_ID,
          DIC_IMP_FREE2_ID,
          DIC_IMP_FREE3_ID,
          DIC_IMP_FREE4_ID,
          DIC_IMP_FREE5_ID,
          HRM_PERSON_ID,
          GCO_GOOD_ID,
          DOC_RECORD_ID,
          FAM_FIXED_ASSETS_ID,
          C_FAM_TRANSACTION_TYP,
          PAC_PERSON_ID,
          ACT_DOCUMENT_ID,
          DOC_NUMBER,
          DOC_COMMENT,
          ACJ_CATALOGUE_DOCUMENT_ID,
          ACT_ACT_JOURNAL_ID,
          ACT_JOURNAL_ID,
          JOU_NUMBER,
          JOU_DESCRIPTION,
          C_ETAT_JOURNAL,
          C_TYPE_CUMUL
  from  V_ACT_CDA_IMPUTATIONS
  where C_TYPE_PERIOD <> '1'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_CDA_PREV_YEAR_TOTAL" ("ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select
       PER.ACS_PERIOD_ID,
       PER.PER_START_DATE IMM_VALUE_DATE,
       PER.PER_START_DATE IMM_TRANSACTION_DATE,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_CDA_ACCOUNT_ID,
       TOT.ACS_CPN_ACCOUNT_ID,
       TOT.ACS_PF_ACCOUNT_ID,
       TOT.ACS_PJ_ACCOUNT_ID,
       TOT.ACS_QTY_UNIT_ID,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)), -1, 0,  nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) IMM_QUANTITY_D,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)),  1, 0, -nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) IMM_QUANTITY_C,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) IMM_AMOUNT_LC_D,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) IMM_AMOUNT_LC_C,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) IMM_AMOUNT_FC_D,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) IMM_AMOUNT_FC_C,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)), -1, 0,  nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) IMM_AMOUNT_EUR_D,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)),  1, 0, -nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) IMM_AMOUNT_EUR_C,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL
  from
       ACT_MGM_TOT_BY_PERIOD TOT,
       ACS_ACCOUNT ACC,
       ACS_CDA_ACCOUNT CDA,
       ACS_PERIOD PER
  where
        ACC.ACC_NUMBER            >= ACR_FUNCTIONS.GetAccNumber(1)
    and ACC.ACC_NUMBER            <= ACR_FUNCTIONS.GetAccNumber(0)
    and ACC.ACS_ACCOUNT_ID         = CDA.ACS_CDA_ACCOUNT_ID
    and CDA.ACS_CDA_ACCOUNT_ID     = TOT.ACS_CDA_ACCOUNT_ID (+)
    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_PERIOD_ID         = TOT.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
    and PER.C_TYPE_PERIOD         = '1'
  group by
        TOT.ACS_FINANCIAL_ACCOUNT_ID,
        TOT.ACS_CDA_ACCOUNT_ID,
        TOT.ACS_CPN_ACCOUNT_ID,
        TOT.ACS_PF_ACCOUNT_ID,
        TOT.ACS_PJ_ACCOUNT_ID,
        TOT.ACS_QTY_UNIT_ID,
        ACS_ACS_FINANCIAL_CURRENCY_ID,
        ACS_FINANCIAL_CURRENCY_ID,
        C_TYPE_CUMUL,
        PER.ACS_PERIOD_ID,
        PER.PER_START_DATE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_CPN_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD") AS
  select
       MGM.ACT_MGM_IMPUTATION_ID,
       MGM.ACT_FINANCIAL_IMPUTATION_ID,
       MGM.ACS_PERIOD_ID,
       MGM.IMM_VALUE_DATE,
       MGM.IMM_TRANSACTION_DATE,
       MGM.IMM_TYPE,
       MGM.IMM_GENRE,
       MGM.IMM_PRIMARY,
       MGM.IMM_DESCRIPTION,
       MGM.ACS_CPN_ACCOUNT_ID,
       MGM.ACS_CDA_ACCOUNT_ID,
       MGM.ACS_PF_ACCOUNT_ID,
       DIS.ACS_PJ_ACCOUNT_ID,
       MGM.ACS_QTY_UNIT_ID,
       nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D,
       nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C,
       nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D,
       nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C,
       nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D,
       nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_D, MGM.IMM_AMOUNT_EUR_D), 0) IMM_AMOUNT_EUR_D,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_C, MGM.IMM_AMOUNT_EUR_C), 0) IMM_AMOUNT_EUR_C,
       MGM.ACS_FINANCIAL_CURRENCY_ID,
       MGM.ACS_ACS_FINANCIAL_CURRENCY_ID,
       MGM.IMM_EXCHANGE_RATE,
       MGM.IMM_BASE_PRICE,
       MGM.ACT_DOCUMENT_ID,
       MGM.IMM_NUMBER,
       MGM.IMM_NUMBER2,
       MGM.IMM_NUMBER3,
       MGM.IMM_NUMBER4,
       MGM.IMM_NUMBER5,
       MGM.IMM_TEXT1,
       MGM.IMM_TEXT2,
       MGM.IMM_TEXT3,
       MGM.IMM_TEXT4,
       MGM.IMM_TEXT5,
       MGM.DIC_IMP_FREE1_ID,
       MGM.DIC_IMP_FREE2_ID,
       MGM.DIC_IMP_FREE3_ID,
       MGM.DIC_IMP_FREE4_ID,
       MGM.DIC_IMP_FREE5_ID,
       MGM.HRM_PERSON_ID,
       MGM.GCO_GOOD_ID,
       MGM.DOC_RECORD_ID,
       MGM.FAM_FIXED_ASSETS_ID,
       MGM.C_FAM_TRANSACTION_TYP,
       MGM.PAC_PERSON_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       CPN.ACC_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       JOU.ACT_JOURNAL_ID,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
      (select ETA.C_ETAT_JOURNAL
       from ACT_ETAT_JOURNAL ETA
       where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
         and ETA.C_SUB_SET      = 'CPN') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                 = 'CPN') C_TYPE_CUMUL,
       PER.C_TYPE_PERIOD
  from
       ACT_JOURNAL              JOU,
       ACT_DOCUMENT             DOC,
       ACS_PERIOD               PER,
       ACT_MGM_IMPUTATION       MGM,
       ACT_MGM_DISTRIBUTION     DIS,
       ACT_FINANCIAL_IMPUTATION IMP,
       ACS_ACCOUNT              CPN
  where
        CPN.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
    and CPN.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
    and CPN.ACS_ACCOUNT_ID              = MGM.ACS_CPN_ACCOUNT_ID
    and MGM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID (+)
    and MGM.ACT_MGM_IMPUTATION_ID       = DIS.ACT_MGM_IMPUTATION_ID (+)
    and MGM.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and MGM.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID
    and DOC.ACT_ACT_JOURNAL_ID          = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_CPN_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select
       ACT_MGM_IMPUTATION_ID,
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       IMM_VALUE_DATE,
       IMM_TRANSACTION_DATE,
       IMM_TYPE,
       IMM_GENRE,
       IMM_PRIMARY,
       IMM_DESCRIPTION,
       ACS_CPN_ACCOUNT_ID,
       ACS_CDA_ACCOUNT_ID,
       ACS_PF_ACCOUNT_ID,
       ACS_PJ_ACCOUNT_ID,
       ACS_QTY_UNIT_ID,
       IMM_QUANTITY_D,
       IMM_QUANTITY_C,
       IMM_AMOUNT_LC_D,
       IMM_AMOUNT_LC_C,
       IMM_AMOUNT_FC_D,
       IMM_AMOUNT_FC_C,
       IMM_AMOUNT_EUR_D,
       IMM_AMOUNT_EUR_C,
       ACS_FINANCIAL_CURRENCY_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMM_EXCHANGE_RATE,
       IMM_BASE_PRICE,
       ACS_FINANCIAL_ACCOUNT_ID,
       ACC_NUMBER,
       IMM_NUMBER,
       IMM_NUMBER2,
       IMM_NUMBER3,
       IMM_NUMBER4,
       IMM_NUMBER5,
       IMM_TEXT1,
       IMM_TEXT2,
       IMM_TEXT3,
       IMM_TEXT4,
       IMM_TEXT5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       HRM_PERSON_ID,
       GCO_GOOD_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID,
       ACT_DOCUMENT_ID,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_ACT_JOURNAL_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL
  from
       V_ACT_CPN_IMPUTATIONS
  where
       C_TYPE_PERIOD <> '1'
union all
select
       ACT_MGM_IMPUTATION_ID,
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       IMM_VALUE_DATE,
       IMM_TRANSACTION_DATE,
       IMM_TYPE,
       IMM_GENRE,
       IMM_PRIMARY,
       IMM_DESCRIPTION,
       ACS_CPN_ACCOUNT_ID,
       ACS_CDA_ACCOUNT_ID,
       ACS_PF_ACCOUNT_ID,
       ACS_PJ_ACCOUNT_ID,
       ACS_QTY_UNIT_ID,
       IMM_QUANTITY_D,
       IMM_QUANTITY_C,
       IMM_AMOUNT_LC_D,
       IMM_AMOUNT_LC_C,
       IMM_AMOUNT_FC_D,
       IMM_AMOUNT_FC_C,
       IMM_AMOUNT_EUR_D,
       IMM_AMOUNT_EUR_C,
       ACS_FINANCIAL_CURRENCY_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMM_EXCHANGE_RATE,
       IMM_BASE_PRICE,
       ACS_FINANCIAL_ACCOUNT_ID,
       ACC_NUMBER,
       IMM_NUMBER,
       IMM_NUMBER2,
       IMM_NUMBER3,
       IMM_NUMBER4,
       IMM_NUMBER5,
       IMM_TEXT1,
       IMM_TEXT2,
       IMM_TEXT3,
       IMM_TEXT4,
       IMM_TEXT5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       HRM_PERSON_ID,
       GCO_GOOD_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID,
       ACT_DOCUMENT_ID,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_ACT_JOURNAL_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL
  from
       V_ACT_CPN_IMPUTATIONS
  where
       C_TYPE_PERIOD = '1'
       and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_MGM_IMPUTATION_ID,
       0 ACT_FINANCIAL_IMPUTATION_ID,
       TOT.ACS_PERIOD_ID,
       TOT.IMM_VALUE_DATE,
       TOT.IMM_TRANSACTION_DATE,
       'MAN' IMM_TYPE,
       'MAN' IMM_GENRE,
       0 IMM_PRIMARY,
       'Report' IMM_DESCRIPTION,
       TOT.ACS_CPN_ACCOUNT_ID,
       TOT.ACS_CDA_ACCOUNT_ID,
       TOT.ACS_PF_ACCOUNT_ID,
       TOT.ACS_PJ_ACCOUNT_ID,
       TOT.ACS_QTY_UNIT_ID,
       TOT.IMM_QUANTITY_D,
       TOT.IMM_QUANTITY_C,
       TOT.IMM_AMOUNT_LC_D,
       TOT.IMM_AMOUNT_LC_C,
       TOT.IMM_AMOUNT_FC_D,
       TOT.IMM_AMOUNT_FC_C,
       TOT.IMM_AMOUNT_EUR_D,
       TOT.IMM_AMOUNT_EUR_C,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       0 IMM_EXCHANGE_RATE,
       0 IMM_BASE_PRICE,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       '' ACC_NUMBER,
       0 IMM_NUMBER,
       0 IMM_NUMBER2,
       0 IMM_NUMBER3,
       0 IMM_NUMBER4,
       0 IMM_NUMBER5,
       '' IMM_TEXT1,
       '' IMM_TEXT2,
       '' IMM_TEXT3,
       '' IMM_TEXT4,
       '' IMM_TEXT5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_IMP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 HRM_PERSON_ID,
       0 GCO_GOOD_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 PAC_PERSON_ID,
       0 ACT_DOCUMENT_ID,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_ACT_JOURNAL_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       '' JOU_DESCRIPTION,
       'PROV' C_ETAT_JOURNAL,
       TOT.C_TYPE_CUMUL
  from
       V_ACT_CPN_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_CPN_PREV_YEAR_TOTAL" ("ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select
       PER.ACS_PERIOD_ID,
       PER.PER_START_DATE IMM_VALUE_DATE,
       PER.PER_START_DATE IMM_TRANSACTION_DATE,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_CPN_ACCOUNT_ID,
       TOT.ACS_PJ_ACCOUNT_ID,
       TOT.ACS_CDA_ACCOUNT_ID,
       TOT.ACS_PF_ACCOUNT_ID,
       TOT.ACS_QTY_UNIT_ID,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)), -1, 0,  nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) IMM_QUANTITY_D,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)),  1, 0, -nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) IMM_QUANTITY_C,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) IMM_AMOUNT_LC_D,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) IMM_AMOUNT_LC_C,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) IMM_AMOUNT_FC_D,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) IMM_AMOUNT_FC_C,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)), -1, 0,  nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) IMM_AMOUNT_EUR_D,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)),  1, 0, -nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) IMM_AMOUNT_EUR_C,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL
  from
       ACT_MGM_TOT_BY_PERIOD TOT,
       ACS_ACCOUNT ACC,
       ACS_CPN_ACCOUNT CPN,
       ACS_PERIOD PER
  where
        ACC.ACC_NUMBER            >= ACR_FUNCTIONS.GetAccNumber(1)
    and ACC.ACC_NUMBER            <= ACR_FUNCTIONS.GetAccNumber(0)
    and ACC.ACS_ACCOUNT_ID         = CPN.ACS_CPN_ACCOUNT_ID
    and CPN.ACS_CPN_ACCOUNT_ID     = TOT.ACS_CPN_ACCOUNT_ID
    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_PERIOD_ID         = TOT.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
    and PER.C_TYPE_PERIOD         = '1'
  group by
        TOT.ACS_FINANCIAL_ACCOUNT_ID,
        TOT.ACS_CPN_ACCOUNT_ID,
        TOT.ACS_CDA_ACCOUNT_ID,
        TOT.ACS_PF_ACCOUNT_ID,
        TOT.ACS_PJ_ACCOUNT_ID,
        TOT.ACS_QTY_UNIT_ID,
        ACS_ACS_FINANCIAL_CURRENCY_ID,
        ACS_FINANCIAL_CURRENCY_ID,
        C_TYPE_CUMUL,
        PER.ACS_PERIOD_ID,
        PER.PER_START_DATE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_DEFERRAL_FIN_IMPUTATION" ("DFR_DOC_NUMBER", "DFR_IMF_TRANSACTION_DATE", "DFR_FYE_NO_EXERCICE_ORI", "DFR_ACS_FINANCIAL_YEAR_ID_ORI", "DFR_ACS_PERIOD_ID", "DFR_PER_NO_PERIOD", "DFR_ACC_NUMBER", "DFR_IMF_DESCRIPTION", "DFR_ACT_FIN_IMPUT_ID_ORI", "DFR_IMF_DESCRIPTION_ORI", "DFR_DOC_NUMBER_ORI", "PAC_THIRD_ID", "DFR_PAR_DOCUMENT_ORI", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "DFR_AMOUNT_LC") AS
  select DOCD.DOC_NUMBER
       , IMPD.IMF_TRANSACTION_DATE
       , ACS_FUNCTION.GETFINANCIALYEARNO( (select max(IMP.IMF_TRANSACTION_DATE)
                                             from ACT_FINANCIAL_IMPUTATION IMP
                                            where IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID) ) DFR_FYE_NO_EXERCICE_ORI
       , ACS_FUNCTION.GETFINANCIALYEARID( (select max(IMP.IMF_TRANSACTION_DATE)
                                             from ACT_FINANCIAL_IMPUTATION IMP
                                            where IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID) ) DFR_ACS_FINANCIAL_YEAR_ID_ORI
       , ACS_FUNCTION.GETPERIODID(IMPD.IMF_TRANSACTION_DATE, '2')
       , ACS_FUNCTION.GETPERIODNO(IMPD.IMF_TRANSACTION_DATE, '2')
       , ACS_FUNCTION.GETACCOUNTNUMBER(IMPD.ACS_FINANCIAL_ACCOUNT_ID)
       , IMPD.IMF_DESCRIPTION
       , (select IMP.ACT_FINANCIAL_IMPUTATION_ID
            from ACT_FINANCIAL_IMPUTATION IMP
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID)
       , (select IMP.IMF_DESCRIPTION
            from ACT_FINANCIAL_IMPUTATION IMP
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID)
       , (select DOC.DOC_NUMBER
            from ACT_DOCUMENT DOC
               , ACT_FINANCIAL_IMPUTATION IMP
           where DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
             and IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID)
       , (select PER.PER_NAME
            from ACT_FINANCIAL_IMPUTATION IMP
               , ACT_PART_IMPUTATION PART
               , PAC_PERSON PER
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID
             and PART.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID
             and PER.PAC_PERSON_ID = nvl(PART.PAC_CUSTOM_PARTNER_ID, PART.PAC_SUPPLIER_PARTNER_ID) )
       , (select min(PART.PAR_DOCUMENT)
            from ACT_FINANCIAL_IMPUTATION IMP
               , ACT_DOCUMENT DOC
               , ACT_PART_IMPUTATION PART
           where IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_FINANCIAL_IMPUTATION_ID
             and PART.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
             and DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)
       , IMPD.IMF_AMOUNT_LC_D
       , IMPD.IMF_AMOUNT_LC_C
       , IMPD.IMF_AMOUNT_LC_D - IMPD.IMF_AMOUNT_LC_C
    from ACT_DEFERRAL_IMPUTATION DEFE
       , ACT_FINANCIAL_IMPUTATION IMPD
       , ACT_DOCUMENT DOCD
   where DEFE.ACT_DEFER_FIN_IMP_ID = IMPD.ACT_FINANCIAL_IMPUTATION_ID
     and DOCD.ACT_DOCUMENT_ID = IMPD.ACT_DOCUMENT_ID
     and (select FIN.C_DEFER_AUTHORIZ_TYPE
            from ACT_FINANCIAL_IMPUTATION IMP
               , ACS_FINANCIAL_ACCOUNT FIN
           where IMP.ACS_FINANCIAL_ACCOUNT_ID = FIN.ACS_fINANCIAL_aCCOUNT_ID
             and IMP.ACT_FINANCIAL_IMPUTATION_ID = DEFE.ACT_DEFER_FIN_IMP_ID) <> '0'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_DET_TAX" ("ACT_DET_TAX_ID", "ACT_FINANCIAL_IMPUTATION_ID", "TAX_EXCHANGE_RATE", "TAX_INCLUDED_EXCLUDED", "TAX_LIABLED_AMOUNT", "TAX_LIABLED_RATE", "TAX_RATE", "TAX_RATE_REF", "TAX_VAT_AMOUNT_FC", "TAX_VAT_AMOUNT_LC", "TAX_VAT_AMOUNT_EUR", "ACS_SUB_SET_ID", "ACT_ACT_FINANCIAL_IMPUTATION", "ACT2_ACT_FINANCIAL_IMPUTATION", "ACS_ACCOUNT_ID2", "TAX_REDUCTION", "DET_BASE_PRICE", "TAX_DEDUCTIBLE_RATE", "TAX_TOT_VAT_AMOUNT_LC", "TAX_TOT_VAT_AMOUNT_FC", "ACS_TAX_CODE_ID", "HT_LC", "TTC_LC", "HT_FC", "TTC_FC", "HT_EUR", "TTC_EUR", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "IMF_EXCHANGE_RATE", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_PERIOD_ID", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "ACT_DOCUMENT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "JOU_NUMBER", "JOU_DESCRIPTION", "ACS_DIVISION_ACCOUNT_ID", "ACT_ACT_JOURNAL_ID", "ACS_AUXILIARY_ACCOUNT_ID", "C_TYPE_CUMUL", "TAX_TMP_VAT_ENCASHMENT", "ACT_FIN_IMPUT_ORIGIN_ID", "ACT_VAT_DET_ACCOUNT_ID") AS
  select
       ACT_DET_TAX.ACT_DET_TAX_ID,
       ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID,
       ACT_DET_TAX.TAX_EXCHANGE_RATE,
       ACT_DET_TAX.TAX_INCLUDED_EXCLUDED,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT,
       ACT_DET_TAX.TAX_LIABLED_RATE,
       ACT_DET_TAX.TAX_RATE,
       DECODE(ACT_DET_TAX.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID),0),ACT_DET_TAX.TAX_RATE) TAX_RATE_REF,
       ACT_DET_TAX.TAX_VAT_AMOUNT_FC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_EUR,
       ACT_DET_TAX.ACS_SUB_SET_ID,
       ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACT2_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACS_ACCOUNT_ID2,
       ACT_DET_TAX.TAX_REDUCTION,
       ACT_DET_TAX.DET_BASE_PRICE,
       ACT_DET_TAX.TAX_DEDUCTIBLE_RATE,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_FC,
       ACT_FINANCIAL_IMPUTATION.ACS_TAX_CODE_ID,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT AS HT_LC,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT + ACT_DET_TAX.TAX_VAT_AMOUNT_LC AS TTC_LC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C AS HT_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C + ACT_DET_TAX.TAX_VAT_AMOUNT_FC AS TTC_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C AS HT_EUR,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C + ACT_DET_TAX.TAX_VAT_AMOUNT_EUR AS TTC_EUR,
       B.ACS_FINANCIAL_ACCOUNT_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_TRANSACTION_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_VALUE_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_EXCHANGE_RATE,
       ACT_FINANCIAL_IMPUTATION.ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_PERIOD_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_C,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C,
       ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       (select ACC.ACC_NUMBER from ACS_ACCOUNT ACC where ACC.ACS_ACCOUNT_ID = ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID, IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID)
         from  ACT_FINANCIAL_IMPUTATION IMP
         where IMP.ACT_FINANCIAL_IMPUTATION_ID = ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(ACT_DET_TAX.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       0 ACT_FIN_IMPUT_ORIGIN_ID,
       ACT_DET_TAX.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_FINANCIAL_IMPUTATION,
     ACT_FINANCIAL_IMPUTATION B,
     ACT_DET_TAX,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     ACT_JOURNAL JOU
where
      ACT_DET_TAX.TAX_INCLUDED_EXCLUDED = 'E'
  and ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION = B.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID = ACT_FINANCIAL_IMPUTATION.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'
union all
select
       ACT_DET_TAX.ACT_DET_TAX_ID,
       ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID,
       ACT_DET_TAX.TAX_EXCHANGE_RATE,
       ACT_DET_TAX.TAX_INCLUDED_EXCLUDED,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT,
       ACT_DET_TAX.TAX_LIABLED_RATE,
       ACT_DET_TAX.TAX_RATE,
       DECODE(ACT_DET_TAX.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID),0),ACT_DET_TAX.TAX_RATE) TAX_RATE_REF,
       ACT_DET_TAX.TAX_VAT_AMOUNT_FC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_EUR,
       ACT_DET_TAX.ACS_SUB_SET_ID,
       ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACT2_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACS_ACCOUNT_ID2,
       ACT_DET_TAX.TAX_REDUCTION,
       ACT_DET_TAX.DET_BASE_PRICE,
       ACT_DET_TAX.TAX_DEDUCTIBLE_RATE,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_FC,
       ACT_FINANCIAL_IMPUTATION.ACS_TAX_CODE_ID,
       case
         when ACT_DET_TAX.ACT2_DET_TAX_ID is null then
           ACT_DET_TAX.TAX_LIABLED_AMOUNT - ACT_DET_TAX.TAX_VAT_AMOUNT_LC
         else
           ((select ABS(TAX.TAX_LIABLED_AMOUNT) from ACT_DET_TAX TAX where TAX.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID) * SIGN(ACT_DET_TAX.TAX_VAT_AMOUNT_LC))
       end HT_LC,
       case
         when ACT_DET_TAX.ACT2_DET_TAX_ID is null then
           ACT_DET_TAX.TAX_LIABLED_AMOUNT
         else
           ACT_DET_TAX.TAX_LIABLED_AMOUNT + ((select ABS(TAX.TAX_LIABLED_AMOUNT) from ACT_DET_TAX TAX where TAX.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID) * SIGN(ACT_DET_TAX.TAX_VAT_AMOUNT_LC))
       end TTC_LC,
       case
         when ACT_DET_TAX.ACT2_DET_TAX_ID is null then
           ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C - ACT_DET_TAX.TAX_VAT_AMOUNT_FC
         else
           (select ABS((IMP.IMF_AMOUNT_FC_D - IMP.IMF_AMOUNT_FC_C)) * SIGN(ACT_DET_TAX.TAX_VAT_AMOUNT_FC)
            from ACT_FINANCIAL_IMPUTATION IMP, ACT_DET_TAX TAX
            where TAX.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID
              and TAX.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID)
       end HT_FC,
       case
         when ACT_DET_TAX.ACT2_DET_TAX_ID is null then
           ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C
         else
           (select ABS((IMP.IMF_AMOUNT_FC_D - IMP.IMF_AMOUNT_FC_C + TAX.TAX_VAT_AMOUNT_FC)) * SIGN(ACT_DET_TAX.TAX_VAT_AMOUNT_FC)
            from ACT_FINANCIAL_IMPUTATION IMP, ACT_DET_TAX TAX
            where TAX.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID
              and TAX.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID)
       end TTC_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C - ACT_DET_TAX.TAX_VAT_AMOUNT_EUR AS HT_EUR,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C AS TTC_EUR,
       B.ACS_FINANCIAL_ACCOUNT_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_TRANSACTION_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_VALUE_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_EXCHANGE_RATE,
       ACT_FINANCIAL_IMPUTATION.ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_PERIOD_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_C,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C,
       ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       (select ACC.ACC_NUMBER from ACS_ACCOUNT ACC where ACC.ACS_ACCOUNT_ID = ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID, IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID)
         from  ACT_FINANCIAL_IMPUTATION IMP
         where IMP.ACT_FINANCIAL_IMPUTATION_ID = ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(ACT_DET_TAX.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       0 ACT_FIN_IMPUT_ORIGIN_ID,
       ACT_DET_TAX.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_FINANCIAL_IMPUTATION,
     ACT_FINANCIAL_IMPUTATION B,
     ACT_DET_TAX,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     ACT_JOURNAL JOU
where
      ACT_DET_TAX.TAX_INCLUDED_EXCLUDED = 'I'
  and ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION = B.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID = ACT_FINANCIAL_IMPUTATION.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'
union all
select
       ACT_DET_TAX.ACT_DET_TAX_ID,
       ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID,
       ACT_DET_TAX.TAX_EXCHANGE_RATE,
       ACT_DET_TAX.TAX_INCLUDED_EXCLUDED,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT,
       ACT_DET_TAX.TAX_LIABLED_RATE,
       ACT_DET_TAX.TAX_RATE,
       DECODE(ACT_DET_TAX.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID),0),ACT_DET_TAX.TAX_RATE) TAX_RATE_REF,
       ACT_DET_TAX.TAX_VAT_AMOUNT_FC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_EUR,
       ACT_DET_TAX.ACS_SUB_SET_ID,
       ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACT2_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACS_ACCOUNT_ID2,
       ACT_DET_TAX.TAX_REDUCTION,
       ACT_DET_TAX.DET_BASE_PRICE,
       ACT_DET_TAX.TAX_DEDUCTIBLE_RATE,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_FC,
       ACT_FINANCIAL_IMPUTATION.ACS_TAX_CODE_ID,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT AS HT_LC,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT AS TTC_LC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C AS HT_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C  AS TTC_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C AS HT_EUR,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C  AS TTC_EUR,
       B.ACS_FINANCIAL_ACCOUNT_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_TRANSACTION_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_VALUE_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_EXCHANGE_RATE,
       ACT_FINANCIAL_IMPUTATION.ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_PERIOD_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_C,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C,
       ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       (select ACC.ACC_NUMBER from ACS_ACCOUNT ACC where ACC.ACS_ACCOUNT_ID = ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID, IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID)
         from  ACT_FINANCIAL_IMPUTATION IMP
         where IMP.ACT_FINANCIAL_IMPUTATION_ID = ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(ACT_DET_TAX.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       0 ACT_FIN_IMPUT_ORIGIN_ID,
       ACT_DET_TAX.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_FINANCIAL_IMPUTATION,
     ACT_FINANCIAL_IMPUTATION B,
     ACT_DET_TAX,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     ACT_JOURNAL JOU
where
      ACT_DET_TAX.TAX_INCLUDED_EXCLUDED = 'S'
  and ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION = B.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID = ACT_FINANCIAL_IMPUTATION.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'
union all
select
       ACT_DET_TAX.ACT_DET_TAX_ID,
       ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID,
       ACT_DET_TAX.TAX_EXCHANGE_RATE,
       ACT_DET_TAX.TAX_INCLUDED_EXCLUDED,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT,
       ACT_DET_TAX.TAX_LIABLED_RATE,
       ACT_DET_TAX.TAX_RATE,
       DECODE(ACT_DET_TAX.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = ACT_DET_TAX.ACT2_DET_TAX_ID),0),ACT_DET_TAX.TAX_RATE) TAX_RATE_REF,
       ACT_DET_TAX.TAX_VAT_AMOUNT_FC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_VAT_AMOUNT_EUR,
       ACT_DET_TAX.ACS_SUB_SET_ID,
       ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACT2_ACT_FINANCIAL_IMPUTATION,
       ACT_DET_TAX.ACS_ACCOUNT_ID2,
       ACT_DET_TAX.TAX_REDUCTION,
       ACT_DET_TAX.DET_BASE_PRICE,
       ACT_DET_TAX.TAX_DEDUCTIBLE_RATE,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_LC,
       ACT_DET_TAX.TAX_TOT_VAT_AMOUNT_FC,
       ACT_FINANCIAL_IMPUTATION.ACS_TAX_CODE_ID,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT - ACT_DET_TAX.TAX_VAT_AMOUNT_LC AS HT_LC,
       ACT_DET_TAX.TAX_LIABLED_AMOUNT as TTC_LC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C as HT_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C as TTC_FC,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C as HT_EUR,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_D - ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_EUR_C as TTC_EUR,
       ACT_FINANCIAL_IMPUTATION.ACS_FINANCIAL_ACCOUNT_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_TRANSACTION_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_VALUE_DATE,
       ACT_FINANCIAL_IMPUTATION.IMF_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_EXCHANGE_RATE,
       ACT_FINANCIAL_IMPUTATION.ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_ACS_FINANCIAL_CURRENCY_ID,
       ACT_FINANCIAL_IMPUTATION.ACS_PERIOD_ID,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_LC_C,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_D,
       ACT_FINANCIAL_IMPUTATION.IMF_AMOUNT_FC_C,
       ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       (select ACC.ACC_NUMBER from ACS_ACCOUNT ACC where ACC.ACS_ACCOUNT_ID = ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       ACT_FINANCIAL_IMPUTATION.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID, IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID)
         from  ACT_FINANCIAL_IMPUTATION IMP
         where IMP.ACT_FINANCIAL_IMPUTATION_ID = ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(ACT_DET_TAX.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       DOR.ACT_FINANCIAL_IMPUTATION_ID ACT_FIN_IMPUT_ORIGIN_ID,
       ACT_DET_TAX.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_FINANCIAL_IMPUTATION,
     ACT_FINANCIAL_IMPUTATION B,
     ACT_DET_TAX DOR,
     ACT_DET_TAX,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     ACT_JOURNAL JOU
where
      ACT_DET_TAX.TAX_INCLUDED_EXCLUDED = 'R'
  and ACT_DET_TAX.ACT2_DET_TAX_ID = DOR.ACT_DET_TAX_ID
  and ACT_DET_TAX.ACT_ACT_FINANCIAL_IMPUTATION = B.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_DET_TAX.ACT_FINANCIAL_IMPUTATION_ID = ACT_FINANCIAL_IMPUTATION.ACT_FINANCIAL_IMPUTATION_ID (+)
  and ACT_FINANCIAL_IMPUTATION.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_DET_TAX_DATE" ("ACT_DET_TAX_ID", "ACT_FINANCIAL_IMPUTATION_ID", "TAX_EXCHANGE_RATE", "TAX_INCLUDED_EXCLUDED", "TAX_LIABLED_AMOUNT", "TAX_LIABLED_RATE", "TAX_RATE", "TAX_RATE_REF", "TAX_VAT_AMOUNT_FC", "TAX_VAT_AMOUNT_LC", "TAX_VAT_AMOUNT_EUR", "ACS_SUB_SET_ID", "ACT_ACT_FINANCIAL_IMPUTATION", "ACT2_ACT_FINANCIAL_IMPUTATION", "ACS_ACCOUNT_ID2", "TAX_REDUCTION", "DET_BASE_PRICE", "TAX_DEDUCTIBLE_RATE", "TAX_TOT_VAT_AMOUNT_LC", "TAX_TOT_VAT_AMOUNT_FC", "ACS_TAX_CODE_ID", "HT_LC", "TTC_LC", "HT_FC", "TTC_FC", "HT_EUR", "TTC_EUR", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "IMF_EXCHANGE_RATE", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_PERIOD_ID", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "ACT_DOCUMENT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DIV_NUMBER", "DOC_NUMBER", "JOU_NUMBER", "ACS_DIVISION_ACCOUNT_ID", "ACT_ACT_JOURNAL_ID", "ACS_AUXILIARY_ACCOUNT_ID", "C_TYPE_CUMUL", "TAX_TMP_VAT_ENCASHMENT", "ACT_FIN_IMPUT_ORIGIN_ID", "ACT_VAT_DET_ACCOUNT_ID") AS
  select
       DET.ACT_DET_TAX_ID,
       DET.ACT_FINANCIAL_IMPUTATION_ID,
       DET.TAX_EXCHANGE_RATE,
       DET.TAX_INCLUDED_EXCLUDED,
       DET.TAX_LIABLED_AMOUNT,
       DET.TAX_LIABLED_RATE,
       DET.TAX_RATE,
       DECODE(DET.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID),0),DET.TAX_RATE) TAX_RATE_REF,
       DET.TAX_VAT_AMOUNT_FC,
       DET.TAX_VAT_AMOUNT_LC,
       DET.TAX_VAT_AMOUNT_EUR,
       DET.ACS_SUB_SET_ID,
       DET.ACT_ACT_FINANCIAL_IMPUTATION,
       DET.ACT2_ACT_FINANCIAL_IMPUTATION,
       DET.ACS_ACCOUNT_ID2,
       DET.TAX_REDUCTION,
       DET.DET_BASE_PRICE,
       DET.TAX_DEDUCTIBLE_RATE,
       DET.TAX_TOT_VAT_AMOUNT_LC,
       DET.TAX_TOT_VAT_AMOUNT_FC,
       AFI.ACS_TAX_CODE_ID,
       DET.TAX_LIABLED_AMOUNT AS HT_LC,
       DET.TAX_LIABLED_AMOUNT + DET.TAX_VAT_AMOUNT_LC AS TTC_LC,
       AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C AS HT_FC,
       AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C + DET.TAX_VAT_AMOUNT_FC AS TTC_FC,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C AS HT_EUR,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C + DET.TAX_VAT_AMOUNT_EUR AS TTC_EUR,
       AFI2.ACS_FINANCIAL_ACCOUNT_ID,
       AFI.IMF_TRANSACTION_DATE,
       AFI.IMF_VALUE_DATE,
       AFI.IMF_DESCRIPTION,
       AFI.IMF_EXCHANGE_RATE,
       AFI.ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_PERIOD_ID,
       AFI.IMF_AMOUNT_LC_D,
       AFI.IMF_AMOUNT_LC_C,
       AFI.IMF_AMOUNT_FC_D,
       AFI.IMF_AMOUNT_FC_C,
       AFI.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       AFI.DIV_NUMBER,
       DOC.DOC_NUMBER,
       JOU.JOU_NUMBER,
       AFI.ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       ACT_FUNCTIONS.AuxAccountFromImputation(DET.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(DET.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       0 ACT_FIN_IMPUT_ORIGIN_ID,
       DET.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_JOURNAL JOU,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     V_ACT_FIN_IMPUTATION_DATE AFI2,
     V_ACT_FIN_IMPUTATION_DATE AFI,
     ACT_DET_TAX DET
where
      DET.TAX_INCLUDED_EXCLUDED = 'E'
  and DET.ACT_ACT_FINANCIAL_IMPUTATION = AFI2.ACT_FINANCIAL_IMPUTATION_ID (+)
  and DET.ACT_FINANCIAL_IMPUTATION_ID = AFI.ACT_FINANCIAL_IMPUTATION_ID (+)
  and AFI.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and AFI.IMF_TRANSACTION_DATE >= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateFrom,
                                         AFI.IMF_TRANSACTION_DATE)
  and AFI.IMF_TRANSACTION_DATE <= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateTo,
                                         AFI.IMF_TRANSACTION_DATE)
  and decode(DET.ACT_VAT_DET_ACCOUNT_ID,
             null,0,
             DET.ACT_VAT_DET_ACCOUNT_ID) = decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                                  null,decode(DET.ACT_VAT_DET_ACCOUNT_ID,
                                                              null,0,
                                                              DET.ACT_VAT_DET_ACCOUNT_ID),
                                                 ACT_FUNCTIONS.GetVatDetAccountId)
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'
union all
select
       DET.ACT_DET_TAX_ID,
       DET.ACT_FINANCIAL_IMPUTATION_ID,
       DET.TAX_EXCHANGE_RATE,
       DET.TAX_INCLUDED_EXCLUDED,
       DET.TAX_LIABLED_AMOUNT,
       DET.TAX_LIABLED_RATE,
       DET.TAX_RATE,
       DECODE(DET.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID),0),DET.TAX_RATE) TAX_RATE_REF,
       DET.TAX_VAT_AMOUNT_FC,
       DET.TAX_VAT_AMOUNT_LC,
       DET.TAX_VAT_AMOUNT_EUR,
       DET.ACS_SUB_SET_ID,
       DET.ACT_ACT_FINANCIAL_IMPUTATION,
       DET.ACT2_ACT_FINANCIAL_IMPUTATION,
       DET.ACS_ACCOUNT_ID2,
       DET.TAX_REDUCTION,
       DET.DET_BASE_PRICE,
       DET.TAX_DEDUCTIBLE_RATE,
       DET.TAX_TOT_VAT_AMOUNT_LC,
       DET.TAX_TOT_VAT_AMOUNT_FC,
       AFI.ACS_TAX_CODE_ID,
       case
         when DET.ACT2_DET_TAX_ID is null then
           DET.TAX_LIABLED_AMOUNT - DET.TAX_VAT_AMOUNT_LC
         else
           ((select ABS(TAX.TAX_LIABLED_AMOUNT) from ACT_DET_TAX TAX where TAX.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID) * SIGN(DET.TAX_VAT_AMOUNT_LC))
       end HT_LC,
       case
         when DET.ACT2_DET_TAX_ID is null then
           DET.TAX_LIABLED_AMOUNT
         else
           DET.TAX_LIABLED_AMOUNT + ((select ABS(TAX.TAX_LIABLED_AMOUNT) from ACT_DET_TAX TAX where TAX.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID) * SIGN(DET.TAX_VAT_AMOUNT_LC))
       end TTC_LC,
       case
         when DET.ACT2_DET_TAX_ID is null then
           AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C - DET.TAX_VAT_AMOUNT_FC
         else
           (select ABS((IMP.IMF_AMOUNT_FC_D - IMP.IMF_AMOUNT_FC_C)) * SIGN(DET.TAX_VAT_AMOUNT_FC)
            from ACT_FINANCIAL_IMPUTATION IMP, ACT_DET_TAX TAX
            where TAX.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID
              and TAX.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID)
       end HT_FC,
       case
         when DET.ACT2_DET_TAX_ID is null then
           AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C
         else
           (select ABS((IMP.IMF_AMOUNT_FC_D - IMP.IMF_AMOUNT_FC_C + TAX.TAX_VAT_AMOUNT_FC)) * SIGN(DET.TAX_VAT_AMOUNT_FC)
            from ACT_FINANCIAL_IMPUTATION IMP, ACT_DET_TAX TAX
            where TAX.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID
              and TAX.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID)
       end TTC_FC,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C - DET.TAX_VAT_AMOUNT_EUR AS HT_EUR,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C AS TTC_EUR,
       AFI2.ACS_FINANCIAL_ACCOUNT_ID,
       AFI.IMF_TRANSACTION_DATE,
       AFI.IMF_VALUE_DATE,
       AFI.IMF_DESCRIPTION,
       AFI.IMF_EXCHANGE_RATE,
       AFI.ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_PERIOD_ID,
       AFI.IMF_AMOUNT_LC_D,
       AFI.IMF_AMOUNT_LC_C,
       AFI.IMF_AMOUNT_FC_D,
       AFI.IMF_AMOUNT_FC_C,
       AFI.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       AFI.DIV_NUMBER,
       DOC.DOC_NUMBER,
       JOU.JOU_NUMBER,
       AFI.ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       ACT_FUNCTIONS.AuxAccountFromImputation(DET.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(DET.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       0 ACT_FIN_IMPUT_ORIGIN_ID,
       DET.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_JOURNAL JOU,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     V_ACT_FIN_IMPUTATION_DATE AFI2,
     V_ACT_FIN_IMPUTATION_DATE AFI,
     ACT_DET_TAX DET
where
      DET.TAX_INCLUDED_EXCLUDED = 'I'
  and DET.ACT_ACT_FINANCIAL_IMPUTATION = AFI2.ACT_FINANCIAL_IMPUTATION_ID (+)
  and DET.ACT_FINANCIAL_IMPUTATION_ID = AFI.ACT_FINANCIAL_IMPUTATION_ID (+)
  and AFI.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and AFI.IMF_TRANSACTION_DATE >= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateFrom,
                                         AFI.IMF_TRANSACTION_DATE)
  and AFI.IMF_TRANSACTION_DATE <= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateTo,
                                         AFI.IMF_TRANSACTION_DATE)
  and decode(DET.ACT_VAT_DET_ACCOUNT_ID,
             null,0,
             DET.ACT_VAT_DET_ACCOUNT_ID) = decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                                  null,decode(DET.ACT_VAT_DET_ACCOUNT_ID,
                                                              null,0,
                                                              DET.ACT_VAT_DET_ACCOUNT_ID),
                                                 ACT_FUNCTIONS.GetVatDetAccountId)
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'
union all
select
       DET.ACT_DET_TAX_ID,
       DET.ACT_FINANCIAL_IMPUTATION_ID,
       DET.TAX_EXCHANGE_RATE,
       DET.TAX_INCLUDED_EXCLUDED,
       DET.TAX_LIABLED_AMOUNT,
       DET.TAX_LIABLED_RATE,
       DET.TAX_RATE,
       DECODE(DET.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID),0),DET.TAX_RATE) TAX_RATE_REF,
       DET.TAX_VAT_AMOUNT_FC,
       DET.TAX_VAT_AMOUNT_LC,
       DET.TAX_VAT_AMOUNT_EUR,
       DET.ACS_SUB_SET_ID,
       DET.ACT_ACT_FINANCIAL_IMPUTATION,
       DET.ACT2_ACT_FINANCIAL_IMPUTATION,
       DET.ACS_ACCOUNT_ID2,
       DET.TAX_REDUCTION,
       DET.DET_BASE_PRICE,
       DET.TAX_DEDUCTIBLE_RATE,
       DET.TAX_TOT_VAT_AMOUNT_LC,
       DET.TAX_TOT_VAT_AMOUNT_FC,
       AFI.ACS_TAX_CODE_ID,
       DET.TAX_LIABLED_AMOUNT AS HT_LC,
       DET.TAX_LIABLED_AMOUNT AS TTC_LC,
       AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C AS HT_FC,
       AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C AS TTC_FC,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C AS HT_EUR,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C AS TTC_EUR,
       AFI2.ACS_FINANCIAL_ACCOUNT_ID,
       AFI.IMF_TRANSACTION_DATE,
       AFI.IMF_VALUE_DATE,
       AFI.IMF_DESCRIPTION,
       AFI.IMF_EXCHANGE_RATE,
       AFI.ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_PERIOD_ID,
       AFI.IMF_AMOUNT_LC_D,
       AFI.IMF_AMOUNT_LC_C,
       AFI.IMF_AMOUNT_FC_D,
       AFI.IMF_AMOUNT_FC_C,
       AFI.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       AFI.DIV_NUMBER,
       DOC.DOC_NUMBER,
       JOU.JOU_NUMBER,
       AFI.ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       ACT_FUNCTIONS.AuxAccountFromImputation(DET.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(DET.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       0 ACT_FIN_IMPUT_ORIGIN_ID,
       DET.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_JOURNAL JOU,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     V_ACT_FIN_IMPUTATION_DATE AFI2,
     V_ACT_FIN_IMPUTATION_DATE AFI,
     ACT_DET_TAX DET
where
      DET.TAX_INCLUDED_EXCLUDED = 'S'
  and DET.ACT_ACT_FINANCIAL_IMPUTATION = AFI2.ACT_FINANCIAL_IMPUTATION_ID (+)
  and DET.ACT_FINANCIAL_IMPUTATION_ID = AFI.ACT_FINANCIAL_IMPUTATION_ID (+)
  and AFI.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and AFI.IMF_TRANSACTION_DATE >= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateFrom,
                                         AFI.IMF_TRANSACTION_DATE)
  and AFI.IMF_TRANSACTION_DATE <= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateTo,
                                         AFI.IMF_TRANSACTION_DATE)
  and decode(DET.ACT_VAT_DET_ACCOUNT_ID,
             null,0,
             DET.ACT_VAT_DET_ACCOUNT_ID) = decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                                  null,decode(DET.ACT_VAT_DET_ACCOUNT_ID,
                                                              null,0,
                                                              DET.ACT_VAT_DET_ACCOUNT_ID),
                                                 ACT_FUNCTIONS.GetVatDetAccountId)
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'
union all
select
       DET.ACT_DET_TAX_ID,
       DET.ACT_FINANCIAL_IMPUTATION_ID,
       DET.TAX_EXCHANGE_RATE,
       DET.TAX_INCLUDED_EXCLUDED,
       DET.TAX_LIABLED_AMOUNT,
       DET.TAX_LIABLED_RATE,
       DET.TAX_RATE,
       DECODE(DET.TAX_RATE,100,NVL((SELECT T2.TAX_RATE FROM ACT_DET_TAX T2 WHERE T2.ACT_DET_TAX_ID = DET.ACT2_DET_TAX_ID),0),DET.TAX_RATE) TAX_RATE_REF,
       DET.TAX_VAT_AMOUNT_FC,
       DET.TAX_VAT_AMOUNT_LC,
       DET.TAX_VAT_AMOUNT_EUR,
       DET.ACS_SUB_SET_ID,
       DET.ACT_ACT_FINANCIAL_IMPUTATION,
       DET.ACT2_ACT_FINANCIAL_IMPUTATION,
       DET.ACS_ACCOUNT_ID2,
       DET.TAX_REDUCTION,
       DET.DET_BASE_PRICE,
       DET.TAX_DEDUCTIBLE_RATE,
       DET.TAX_TOT_VAT_AMOUNT_LC,
       DET.TAX_TOT_VAT_AMOUNT_FC,
       AFI.ACS_TAX_CODE_ID,
       DET.TAX_LIABLED_AMOUNT - DET.TAX_VAT_AMOUNT_LC AS HT_LC,
       DET.TAX_LIABLED_AMOUNT as TTC_LC,
       AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C as HT_FC,
       AFI.IMF_AMOUNT_FC_D - AFI.IMF_AMOUNT_FC_C as TTC_FC,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C as HT_EUR,
       AFI.IMF_AMOUNT_EUR_D - AFI.IMF_AMOUNT_EUR_C as TTC_EUR,
       AFI.ACS_FINANCIAL_ACCOUNT_ID,
       AFI.IMF_TRANSACTION_DATE,
       AFI.IMF_VALUE_DATE,
       AFI.IMF_DESCRIPTION,
       AFI.IMF_EXCHANGE_RATE,
       AFI.ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_ACS_FINANCIAL_CURRENCY_ID,
       AFI.ACS_PERIOD_ID,
       AFI.IMF_AMOUNT_LC_D,
       AFI.IMF_AMOUNT_LC_C,
       AFI.IMF_AMOUNT_FC_D,
       AFI.IMF_AMOUNT_FC_C,
       AFI.ACT_DOCUMENT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       AFI.DIV_NUMBER,
       DOC.DOC_NUMBER,
       JOU.JOU_NUMBER,
       AFI.ACS_DIVISION_ACCOUNT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       ACT_FUNCTIONS.AuxAccountFromImputation(DET.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       SUC.C_TYPE_CUMUL,
       NVL(DET.TAX_TMP_VAT_ENCASHMENT,0) TAX_TMP_VAT_ENCASHMENT,
       DOR.ACT_FINANCIAL_IMPUTATION_ID ACT_FIN_IMPUT_ORIGIN_ID,
       DET.ACT_VAT_DET_ACCOUNT_ID
from
     ACT_JOURNAL JOU,
     ACJ_SUB_SET_CAT SUC,
     ACT_DOCUMENT DOC,
     V_ACT_FIN_IMPUTATION_DATE AFI2,
     V_ACT_FIN_IMPUTATION_DATE AFI,
     ACT_DET_TAX DOR,
     ACT_DET_TAX DET
where
      DET.TAX_INCLUDED_EXCLUDED = 'R'
  and DET.ACT2_DET_TAX_ID = DOR.ACT_DET_TAX_ID
  and DET.ACT_ACT_FINANCIAL_IMPUTATION = AFI2.ACT_FINANCIAL_IMPUTATION_ID (+)
  and DET.ACT_FINANCIAL_IMPUTATION_ID = AFI.ACT_FINANCIAL_IMPUTATION_ID (+)
  and AFI.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
  and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
  and AFI.IMF_TRANSACTION_DATE >= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateFrom,
                                         AFI.IMF_TRANSACTION_DATE)
  and AFI.IMF_TRANSACTION_DATE <= decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                         null,ACT_FUNCTIONS.GetDateTo,
                                         AFI.IMF_TRANSACTION_DATE)
  and decode(DET.ACT_VAT_DET_ACCOUNT_ID,
             null,0,
             DET.ACT_VAT_DET_ACCOUNT_ID) = decode(ACT_FUNCTIONS.GetVatDetAccountId,
                                                  null,decode(DET.ACT_VAT_DET_ACCOUNT_ID,
                                                              null,0,
                                                              DET.ACT_VAT_DET_ACCOUNT_ID),
                                                 ACT_FUNCTIONS.GetVatDetAccountId)
  and DOC.ACJ_CATALOGUE_DOCUMENT_ID = SUC.ACJ_CATALOGUE_DOCUMENT_ID
  and SUC.C_SUB_SET = 'ACC'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_DIV_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "FINANCIAL_IMPUTATION_ID", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       ACT_FUNCTIONS.AuxAccountFromImputation(IMP.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       (select COV.COV_NUMBER
        from ACT_COVER_INFORMATION COV
        where COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID) COV_NUMBER,
       (select PAR.PAR_DOCUMENT
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       (SELECT ACC_NUMBER FROM ACS_ACCOUNT ACC WHERE ACC.ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER,
       (SELECT DIS.ACT_FINANCIAL_DISTRIBUTION_ID FROM ACT_FINANCIAL_DISTRIBUTION DIS WHERE DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DIV.ACC_NUMBER DIV_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_JOURNAL_ID,
       (SELECT JOU.JOU_NUMBER FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER,
       (SELECT JOU.JOU_DESCRIPTION FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID,
       IMP.IMF_COMPARE_DATE,
       IMP.IMF_COMPARE_TEXT,
       IMP.IMF_COMPARE_USE_INI,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select ETA.C_ETAT_JOURNAL
        from ACT_ETAT_JOURNAL ETA
        where ETA.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
          and ETA.C_SUB_SET      = 'ACC') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                 = 'ACC') C_TYPE_CUMUL,
       PER.C_TYPE_PERIOD
  from
       ACT_DOCUMENT               DOC,
       ACS_PERIOD                 PER,
       ACT_FINANCIAL_IMPUTATION   IMP,
       ACS_ACCOUNT                DIV,
       ACS_SUB_SET                SUB
 where SUB.ACS_SUB_SET_ID              = DIV.ACS_SUB_SET_ID
   and SUB.C_SUB_SET                   = 'DTO'
   and DIV.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
   and DIV.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
   and DIV.ACS_ACCOUNT_ID              = IMP.IMF_ACS_DIVISION_ACCOUNT_ID
   and IMP.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
   and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
   and IMP.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_DIV_IMP_REPORT" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "IMF_COMPARE_DATE", "IMF_COMPARE_TEXT", "IMF_COMPARE_USE_INI", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID") AS
  select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       IMF_COMPARE_DATE,
       IMF_COMPARE_TEXT,
       IMF_COMPARE_USE_INI,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID
  from V_ACT_DIV_IMPUTATION
      where C_TYPE_PERIOD <> '1'
union all
select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       IMF_COMPARE_DATE,
       IMF_COMPARE_TEXT,
       IMF_COMPARE_USE_INI,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID
  from V_ACT_DIV_IMPUTATION
    where C_TYPE_PERIOD = '1'
    and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_FINANCIAL_IMPUTATION_ID,
       TOT.ACS_PERIOD_ID,
       0 ACT_DOCUMENT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       'MAN' IMF_TYPE,
       0 IMF_PRIMARY,
       'Report' IMF_DESCRIPTION,
       TOT.TOT_DEBIT_LC  IMF_AMOUNT_LC_D,
       TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C,
       0 IMF_EXCHANGE_RATE,
       TOT.TOT_DEBIT_FC   IMF_AMOUNT_FC_D,
       TOT.TOT_CREDIT_FC  IMF_AMOUNT_FC_C,
       TOT.TOT_DEBIT_EUR  IMF_AMOUNT_EUR_D,
       TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C,
       TOT.PER_START_DATE IMF_VALUE_DATE,
       0 ACS_TAX_CODE_ID,
       TOT.PER_START_DATE IMF_TRANSACTION_DATE,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
       '1' C_GENRE_TRANSACTION,
       0 ACS_AUXILIARY_ACCOUNT_ID,
       0 ACT_DET_PAYMENT_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
       0 IMF_BASE_PRICE,
       0 ACT_PART_IMPUTATION_ID,
       '' COV_NUMBER,
       '' PAR_DOCUMENT,
       TO_DATE(null) DOC_DATE_DELIVERY,
       (SELECT ACC.ACC_NUMBER FROM ACS_ACCOUNT ACC WHERE ACC.ACS_ACCOUNT_ID = TOT.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER,
       0 ACT_FINANCIAL_DISTRIBUTION_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       TOT.DIV_NUMBER,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       0 FINANCIAL_IMPUTATION_ID,
       0 ACT_ACT_JOURNAL_ID,
       'PROV' C_ETAT_JOURNAL,
       TOT.C_TYPE_CUMUL,
       TOT.PER_START_DATE IMF_COMPARE_DATE,
       '' IMF_COMPARE_TEXT,
       '' IMF_COMPARE_USE_INI,
       '' IMF_TEXT1,
       '' IMF_TEXT2,
       '' IMF_TEXT3,
       '' IMF_TEXT4,
       '' IMF_TEXT5,
       0 IMF_NUMBER,
       0 IMF_NUMBER2,
       0 IMF_NUMBER3,
       0 IMF_NUMBER4,
       0 IMF_NUMBER5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_MIP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 GCO_GOOD_ID,
       0 HRM_PERSON_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 PAC_PERSON_ID
  from
       V_ACT_DIV_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_DIV_PREV_YEAR_TOTAL" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE") AS
  select
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       DIV.ACC_NUMBER DIV_NUMBER,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC) , 0)), -1, 0,  nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC),  0))  TOT_DEBIT_LC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC) , 0)),  1, 0, -nvl(sum(TOT.TOT_DEBIT_LC  - TOT.TOT_CREDIT_LC),  0))  TOT_CREDIT_LC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC) , 0)), -1, 0,  nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC),  0))  TOT_DEBIT_FC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC) , 0)),  1, 0, -nvl(sum(TOT.TOT_DEBIT_FC  - TOT.TOT_CREDIT_FC),  0))  TOT_CREDIT_FC,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)), -1, 0,  nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0))  TOT_DEBIT_EUR,
       decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)),  1, 0, -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0))  TOT_CREDIT_EUR,
       TOT.ACS_PERIOD_ID,
       PER.PER_START_DATE
  from
        ACS_ACCOUNT           DIV,
        ACT_TOTAL_BY_PERIOD   TOT,
        ACS_PERIOD            PER
  where
        DIV.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
    and DIV.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_FINANCIAL_YEAR_ID       = ACR_FUNCTIONS.GetFinYearId
    and PER.ACS_PERIOD_ID               = TOT.ACS_PERIOD_ID
    and PER.C_TYPE_PERIOD               = '1'
    and TOT.ACS_DIVISION_ACCOUNT_ID     = DIV.ACS_ACCOUNT_ID
    and TOT.ACS_AUXILIARY_ACCOUNT_ID+0  is null
    and ((TOT.ACS_DIVISION_ACCOUNT_ID is not null) or (TOT.ACS_DIVISION_ACCOUNT_ID is null and ACR_FUNCTIONS.ExistDivision = 0))
  group by
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       DIV.ACC_NUMBER,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL,
       TOT.ACS_PERIOD_ID,
       PER.PER_START_DATE




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRIES" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_CUSTOM_PARTNER_ID,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       PAC_FUNCTIONS.GetNamesAndCity(nvl(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, EXP.EXP_PAC_CUSTOM_PARTNER_ID)) PER_NAME,
       ACT_FUNCTIONS.GetAnalyse_Date ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 2) DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')) BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')), 1, 3) C_TYPE_CUMUL
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_AUXILIARY_ACCOUNT_ID        in (select ACS_ACCOUNT_ID
                                                          from ACS_ACCOUNT
                                                         where ACC_NUMBER <= NVL(ACT_FUNCTIONS.GetAnalyse_Auxiliary(0),ACC_NUMBER)
                                                           and ACC_NUMBER >= NVL(ACT_FUNCTIONS.GetAnalyse_Auxiliary(1),ACC_NUMBER))
           and IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.IMF_TRANSACTION_DATE            <= ACT_FUNCTIONS.GetAnalyse_Date
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT
                                              where C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.EXP_CALC_NET                  = 1
    and ACT_EXPIRY_MANAGEMENT.IsExpiryOpenedAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date) = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRIES_COVER" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_CUSTOM_PARTNER_ID,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       PAC_FUNCTIONS.GetNamesAndCity(nvl(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, EXP.EXP_PAC_CUSTOM_PARTNER_ID)) PER_NAME,
       ACT_FUNCTIONS.GetAnalyse_Date,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalCoverPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 1),
       ACT_FUNCTIONS.TotalCoverPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 0),
       ACT_FUNCTIONS.TotalCoverPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 2),
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date),
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 1),
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 0),
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetAnalyse_Date, 2),
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID),
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID),
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')) BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID),
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')), 1, 3) C_TYPE_CUMUL
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_AUXILIARY_ACCOUNT_ID        in (select ACS_ACCOUNT_ID
                                                          from ACS_ACCOUNT
                                                         where ACC_NUMBER <= NVL(ACT_FUNCTIONS.GetAnalyse_Auxiliary(0),ACC_NUMBER)
                                                           and ACC_NUMBER >= NVL(ACT_FUNCTIONS.GetAnalyse_Auxiliary(1),ACC_NUMBER))
           and IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.IMF_TRANSACTION_DATE            <= ACT_FUNCTIONS.GetAnalyse_Date
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select CAT.ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT CAT
                                              where CAT.C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.EXP_CALC_NET                  = 1
    and EXP.EXP_AMOUNT_LC <> ACT_FUNCTIONS.TotalCoverPaymentAt(EXP.ACT_EXPIRY_ID, ACT_FUNCTIONS.GetAnalyse_Date, 1)
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRIES_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "PER_NAME", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID PAC_CUSTOM_PARTNER_ID,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       PAC_FUNCTIONS.GetNamesAndCity(nvl(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, EXP.EXP_PAC_CUSTOM_PARTNER_ID)) PER_NAME,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')) BRO,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       JOU.C_ETAT_JOURNAL,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')), 1, 3) C_TYPE_CUMUL
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_AUXILIARY_ACCOUNT_ID        in (select ACS_ACCOUNT_ID
                                                          from ACS_ACCOUNT
                                                         where ACC_NUMBER <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
                                                           and ACC_NUMBER >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1))
           and IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_ETAT_JOURNAL           JOU,
       ACT_EXPIRY                 EXP,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID    in (select CAT.ACJ_CATALOGUE_DOCUMENT_ID
                                               from ACJ_CATALOGUE_DOCUMENT CAT
                                              where CAT.C_TYPE_CATALOGUE <> '8')   -- Transaction de relance
    and DOC.ACT_JOURNAL_ID                = JOU.ACT_JOURNAL_ID
    and JOU.C_SUB_SET                     = nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')
    and (JOU.C_ETAT_JOURNAL <> 'BRO' or (ACT_FUNCTIONS.GetBRO = 1 and JOU.C_ETAT_JOURNAL = 'BRO'))
    and EXP.C_STATUS_EXPIRY               = '0'
    and EXP.EXP_CALC_NET                  = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "EXP_PAC_CUSTOM_PARTNER_ID", "EXP_PAC_SUPPLIER_PARTNER_ID", "PER_NAME", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_CUSTOM_PARTNER_ID,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID,
       PAC_FUNCTIONS.GetNamesAndCity(nvl(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, EXP.EXP_PAC_CUSTOM_PARTNER_ID)) PER_NAME,
       IMP.ACS_PERIOD_ID,
       (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY1,
       (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY FIN where FIN.ACS_FINANCIAL_CURRENCY_ID = (select ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID))) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       DOC.DOC_NUMBER,
       (select PAR_DOCUMENT from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select DOC_DATE_DELIVERY from ACT_PART_IMPUTATION where ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE,
       ACT_FUNCTIONS.GetBROState(DOC.ACT_JOURNAL_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')) BRO,
       ACT_FUNCTIONS.GetPreDataEntry(EXP.ACT_DOCUMENT_ID) TYP_SUPPLIER_PERMANENT,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC')), 1, 3) C_TYPE_CUMUL
  from
       (select IMP1.*
          from ACT_FINANCIAL_IMPUTATION IMP1
         where IMP1.ACS_FINANCIAL_ACCOUNT_ID        in (select ACS_FINANCIAL_ACCOUNT_ID
                                                          from ACS_FINANCIAL_ACCOUNT
                                                         where FIN_COLLECTIVE = 1)
           and IMP1.ACT_DET_PAYMENT_ID              is null
           and nvl(IMP1.ACS_AUXILIARY_ACCOUNT_ID, 0) > 0) IMP,
       ACT_EXPIRY                 EXP,
       ACT_DOCUMENT               DOC
  where EXP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
    and exists (select 1
                  from ACT_ETAT_JOURNAL JOU
                 where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
                   and JOU.C_SUB_SET      = nvl2(EXP.EXP_PAC_SUPPLIER_PARTNER_ID, 'PAY', 'REC'))
    and EXP.EXP_CALC_NET                  = 1
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       CUS.ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES     EXP,
       PAC_CUSTOM_PARTNER CUS,
       ACS_ACCOUNT        SAC
  where
        SAC.ACC_NUMBER            >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACC_NUMBER            <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and SAC.ACS_ACCOUNT_ID         = CUS.ACS_AUXILIARY_ACCOUNT_ID
    and CUS.PAC_CUSTOM_PARTNER_ID  = EXP.PAC_CUSTOM_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_COVER" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       CUS.ACS_AUXILIARY_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       ACC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(ACC.ACS_ACCOUNT_ID),
       ACC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES_COVER EXP,
       PAC_CUSTOM_PARTNER   CUS,
       ACS_ACCOUNT          ACC
  where
        ACC.ACC_NUMBER            >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and ACC.ACC_NUMBER            <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and ACC.ACS_ACCOUNT_ID         = CUS.ACS_AUXILIARY_ACCOUNT_ID
    and CUS.PAC_CUSTOM_PARTNER_ID  = EXP.PAC_CUSTOM_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_CTRL" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       CUS.ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES     EXP,
       PAC_CUSTOM_PARTNER CUS,
       ACS_ACCOUNT        SAC
  where
        SAC.ACC_NUMBER             = ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACS_ACCOUNT_ID         = CUS.ACS_AUXILIARY_ACCOUNT_ID
    and CUS.PAC_CUSTOM_PARTNER_ID  = EXP.PAC_CUSTOM_PARTNER_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_EVAL" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_TYPE_CUMUL", "EXP_PAYABLE_EVAL_LC") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       CUS.ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_TYPE_CUMUL,
       decode(EXP.ACS_FINANCIAL_CURRENCY_ID, EXP.ACS_ACS_FINANCIAL_CURRENCY_ID, EXP.EXP_AMOUNT_LC - EXP.DET_PAIED_LC,
              ACT_CURRENCY_EVALUATION.GetConvertAmount(EXP.EXP_AMOUNT_FC - EXP.DET_PAIED_FC, EXP.ACS_FINANCIAL_CURRENCY_ID, EXP.ACS_ACS_FINANCIAL_CURRENCY_ID, ACT_FUNCTIONS.GetAnalyse_Date, ACT_CURRENCY_EVALUATION.GetRateType))
  from
       V_ACT_EXPIRIES     EXP,
       PAC_CUSTOM_PARTNER CUS,
       ACS_ACCOUNT        SAC
  where
        SAC.ACC_NUMBER            >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACC_NUMBER            <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and SAC.ACS_ACCOUNT_ID         = CUS.ACS_AUXILIARY_ACCOUNT_ID
    and CUS.PAC_CUSTOM_PARTNER_ID  = EXP.PAC_CUSTOM_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_EXTRACT" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "DOC_DOCUMENT_DATE", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACC_BLOCKED", "C_ETAT_JOURNAL", "C_JOB_STATE", "CAT_DESCRIPTION", "JOB_DESCRIPTION", "ACS_PAYMENT_METHOD_ID", "C_TYPE_CUMUL", "ACS_DIVISION_ACCOUNT_ID", "EXP_DISCOUNT_LC_MAX", "EXP_DISCOUNT_FC_MAX", "EXP_DISCOUNT_EUR_MAX", "PREDATAENTRY") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       CUS.PAC_CUSTOM_PARTNER_ID,
       CUS.ACS_AUXILIARY_ACCOUNT_ID,
       (select SAC.ACC_NUMBER from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = CUS.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select SAC.ACS_SUB_SET_ID from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = CUS.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID,
       (select PER.PER_NAME from PAC_PERSON PER where PER.PAC_PERSON_ID = CUS.PAC_CUSTOM_PARTNER_ID) PER_NAME,
       ACT_FUNCTIONS.GetPayDate ANALYSE_DATE,
       (select IMP.ACS_PERIOD_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) ACS_PERIOD_ID,
       (select IMP.ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = (select IMP.ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1))) CURRENCY1,
       (select IMP.ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = (select IMP.ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1))) CURRENCY2,
       (select IMP.IMF_TRANSACTION_DATE from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) IMF_TRANSACTION_DATE,
       (select IMP.IMF_VALUE_DATE from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) IMF_VALUE_DATE,
       (select IMP.IMF_DESCRIPTION from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) IMF_DESCRIPTION,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR.PAR_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       DOC.DOC_DOCUMENT_DATE,
       (select PAR.PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       0 CRE_BLOCKED,
       (select SAC.ACC_BLOCKED from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = CUS.ACS_AUXILIARY_ACCOUNT_ID) ACC_BLOCKED,
       (select JOU.C_ETAT_JOURNAL from ACT_ETAT_JOURNAL JOU where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID AND JOU.C_SUB_SET = 'REC') C_ETAT_JOURNAL,
       (select JOB.C_JOB_STATE from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) C_JOB_STATE,
       (select CATA.CAT_DESCRIPTION from ACJ_CATALOGUE_DOCUMENT CATA where CATA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID) CAT_DESCRIPTION,
       (select JOB.JOB_DESCRIPTION from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) JOB_DESCRIPTION,
       NVL((select pay2.acs_payment_method_id from acs_fin_acc_s_payment pay2 where
        pay2.ACS_FIN_ACC_S_PAYMENT_ID = EXP.ACS_FIN_ACC_S_PAYMENT_ID),
        (select pay.acs_payment_method_id from acs_fin_acc_s_payment pay where
        pay.ACS_FIN_ACC_S_PAYMENT_ID = CUS.ACS_FIN_ACC_S_PAYMENT_ID)) ACS_PAYMENT_METHOD_ID,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL,
       ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) ACS_DIVISION_ACCOUNT_ID,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 1) EXP_DISCOUNT_LC_MAX,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC_MAX,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR_MAX,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) PREDATAENTRY
  from
       ACT_DOCUMENT DOC,
       PAC_CUSTOM_PARTNER CUS,
       ACT_EXPIRY EXP
  where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
    and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
    and DOC.ACS_FINANCIAL_YEAR_ID in (select ACS_FINANCIAL_YEAR_ID from ACS_FINANCIAL_YEAR where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate)
    and EXP.EXP_PAC_CUSTOM_PARTNER_ID = CUS.PAC_CUSTOM_PARTNER_ID
    and EXP.ACT_DOCUMENT_ID in (select IMP.ACT_DOCUMENT_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.IMF_PRIMARY = 1)
    and EXP.EXP_CALC_NET = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_EXTRACT_FC" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "DET_DIFF_EXCHANGE", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "DOC_DOCUMENT_DATE", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACC_BLOCKED", "C_ETAT_JOURNAL", "C_JOB_STATE", "CAT_DESCRIPTION", "JOB_DESCRIPTION", "ACS_PAYMENT_METHOD_ID", "C_TYPE_CUMUL", "ACS_DIVISION_ACCOUNT_ID", "EXP_DISCOUNT_LC_MAX", "EXP_DISCOUNT_FC_MAX", "EXP_DISCOUNT_EUR_MAX", "PREDATAENTRY") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       CUS.PAC_CUSTOM_PARTNER_ID,
       CUS.ACS_AUXILIARY_ACCOUNT_ID,
       (select SAC.ACC_NUMBER from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = CUS.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select SAC.ACS_SUB_SET_ID from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = CUS.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID,
       (select PER.PER_NAME from PAC_PERSON PER where PER.PAC_PERSON_ID = CUS.PAC_CUSTOM_PARTNER_ID) PER_NAME,
       ACT_FUNCTIONS.GetPayDate ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = IMP.ACS_FINANCIAL_CURRENCY_ID)) CURRENCY1,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = IMP.ACS_ACS_FINANCIAL_CURRENCY_ID)) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       ACS_FUNCTION.RoundNear((EXP_AMOUNT_LC - ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1)) - ACS_FUNCTION.ConvertAmountForView( (EXP_AMOUNT_FC - ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0)), IMP.ACS_FINANCIAL_CURRENCY_ID, IMP.ACS_ACS_FINANCIAL_CURRENCY_ID, ACT_FUNCTIONS.GetPayDate, 0, 0, 1), 0.01) DET_DIFF_EXCHANGE,
       ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE,
       ACS_FUNCTION.ConvertAmountForView(ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0), IMP.ACS_FINANCIAL_CURRENCY_ID, IMP.ACS_ACS_FINANCIAL_CURRENCY_ID, ACT_FUNCTIONS.GetPayDate, 0, 0, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR.PAR_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       DOC.DOC_DOCUMENT_DATE,
       (select PAR.PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       0 CRE_BLOCKED,
       (select SAC.ACC_BLOCKED from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = CUS.ACS_AUXILIARY_ACCOUNT_ID) ACC_BLOCKED,
       (select JOU.C_ETAT_JOURNAL from ACT_ETAT_JOURNAL JOU where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID AND JOU.C_SUB_SET = 'REC') C_ETAT_JOURNAL,
       (select JOB.C_JOB_STATE from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) C_JOB_STATE,
       (select CATA.CAT_DESCRIPTION from ACJ_CATALOGUE_DOCUMENT CATA where CATA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID) CAT_DESCRIPTION,
       (select JOB.JOB_DESCRIPTION from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) JOB_DESCRIPTION,
       NVL((select pay2.acs_payment_method_id from acs_fin_acc_s_payment pay2 where
        pay2.ACS_FIN_ACC_S_PAYMENT_ID = EXP.ACS_FIN_ACC_S_PAYMENT_ID),
        (select pay.acs_payment_method_id from acs_fin_acc_s_payment pay where
        pay.ACS_FIN_ACC_S_PAYMENT_ID = CUS.ACS_FIN_ACC_S_PAYMENT_ID)) ACS_PAYMENT_METHOD_ID,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL,
       ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) ACS_DIVISION_ACCOUNT_ID,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 1) EXP_DISCOUNT_LC_MAX,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC_MAX,
       ACT_FUNCTIONS.DiscountToleranceAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR_MAX,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID)  PREDATAENTRY
  from
       ACT_DOCUMENT DOC,
       ACT_FINANCIAL_IMPUTATION IMP,
       PAC_CUSTOM_PARTNER CUS,
       ACT_EXPIRY EXP
  where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
    and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
    and DOC.ACS_FINANCIAL_YEAR_ID in (select ACS_FINANCIAL_YEAR_ID from ACS_FINANCIAL_YEAR where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate)
    and EXP.EXP_PAC_CUSTOM_PARTNER_ID = CUS.PAC_CUSTOM_PARTNER_ID
    and EXP.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
    and IMP.IMF_PRIMARY = 1
    and EXP.EXP_CALC_NET = 1
    and IMP.ACS_FINANCIAL_CURRENCY_ID <> IMP.ACS_ACS_FINANCIAL_CURRENCY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_PAYMENT" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_AMOUNT_TOPAY_LC", "EXP_AMOUNT_TOPAY_FC", "EXP_AMOUNT_TOPAY_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "ACS_AUXILIARY_ACCOUNT_ID", "DOC_NUMBER", "DOC_DOCUMENT_DATE", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "JOU_NUMBER", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "PAR_BLOCKED_DOCUMENT", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "C_TYPE_CUMUL", "IMF_DESCRIPTION") AS
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_CUSTOM_PARTNER
           where PAC_CUSTOM_PARTNER_ID = PAR.PAC_CUSTOM_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , JOU.JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL
       , ACT_FUNCTIONS.DescriptionOfExpiry(PAR.ACT_PART_IMPUTATION_ID) IMF_DESCRIPTION
    from ACT_JOURNAL JOU
       , (select DOC.*
            from ACT_DOCUMENT DOC
           where DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACJ_CATALOGUE_DOCUMENT
                                                   where C_TYPE_CATALOGUE not in('9', '8', '4', '3') )   -- Lettrage, relance, paiement manuel, paiement automatique
             and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
             and DOC.ACS_FINANCIAL_YEAR_ID in(select ACS_FINANCIAL_YEAR_ID
                                                from ACS_FINANCIAL_YEAR
                                               where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate) ) DOC
       , ACT_EXPIRY EXP
       , ACT_PART_IMPUTATION PAR
   where PAR.PAC_CUSTOM_PARTNER_ID in(select CUS.PAC_CUSTOM_PARTNER_ID
                                        from PAC_CUSTOM_PARTNER CUS
                                       where CUS.ACS_AUXILIARY_ACCOUNT_ID = ACT_FUNCTIONS.GetAuxiliary_Id)
     and PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID
     and to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
     and (    (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is null)
          or (     (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is not null)
              and (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) in(
                                       select COLUMN_VALUE ACS_DIVISION_ACCOUNT_ID
                                         from table
                                                  (ACS_FUNCTION.TableDivisionsAuthorized(PCS.PC_I_LIB_SESSION.GetUserId) ) )
                  )
             )
         )
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_CUSTOM_PARTNER
           where PAC_CUSTOM_PARTNER_ID = PAR.PAC_CUSTOM_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL
       , ACT_FUNCTIONS.DescriptionOfExpiry(PAR.ACT_PART_IMPUTATION_ID) IMF_DESCRIPTION
    from ACT_DOCUMENT DOC
       , ACT_PART_IMPUTATION PAR
       , ACT_EXPIRY EXP
   where EXP.ACT_EXPIRY_ID in(select DET.ACT_EXPIRY_ID
                                from ACT_DET_PAYMENT DET
                               where DET.ACT_DOCUMENT_ID = ACT_FUNCTIONS.GetDocument_Id)
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and PAR.PAC_CUSTOM_PARTNER_ID in(select CUS.PAC_CUSTOM_PARTNER_ID
                                        from PAC_CUSTOM_PARTNER CUS
                                       where CUS.ACS_AUXILIARY_ACCOUNT_ID = ACT_FUNCTIONS.GetAuxiliary_Id)
     and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACT_JOURNAL_ID is not null
     and (    (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is null)
          or (     (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is not null)
              and (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) in(
                                       select COLUMN_VALUE ACS_DIVISION_ACCOUNT_ID
                                         from table
                                                  (ACS_FUNCTION.TableDivisionsAuthorized(PCS.PC_I_LIB_SESSION.GetUserId) ) )
                  )
             )
         )
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_CUSTOM_PARTNER
           where PAC_CUSTOM_PARTNER_ID = EXP.EXP_PAC_CUSTOM_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , JOU.JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'REC'), 1, 3) C_TYPE_CUMUL
       , ACT_FUNCTIONS.DescriptionOfExpiry(PAR.ACT_PART_IMPUTATION_ID) IMF_DESCRIPTION
    from ACT_JOURNAL JOU
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
       , ACT_PART_IMPUTATION PAR
   where PAR.PAC_CUSTOM_PARTNER_ID in(select CUS.PAC_CUSTOM_PARTNER_ID
                                        from PAC_CUSTOM_PARTNER CUS
                                       where CUS.ACS_AUXILIARY_ACCOUNT_ID = ACT_FUNCTIONS.GetAuxiliary_Id)
     and DOC.ACS_FINANCIAL_YEAR_ID in(select ACS_FINANCIAL_YEAR_ID
                                        from ACS_FINANCIAL_YEAR
                                       where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate)
     and PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID
     and to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                            from ACJ_CATALOGUE_DOCUMENT
                                           where C_TYPE_CATALOGUE in('9', '4', '3') )   -- Lettrage, paiement manuel, paiement automatique
     and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
     and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
     and (    (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is null)
          or (     (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is not null)
              and (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) in(
                                       select COLUMN_VALUE ACS_DIVISION_ACCOUNT_ID
                                         from table
                                                  (ACS_FUNCTION.TableDivisionsAuthorized(PCS.PC_I_LIB_SESSION.GetUserId) ) )
                  )
             )
         )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_CUST_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_CUSTOM_PARTNER_ID,
       SAC.ACS_ACCOUNT_ID ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       null,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       0,
       0,
       0,
       0,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES_STATUS EXP,
       PAC_CUSTOM_PARTNER    CUS,
       ACS_ACCOUNT           SAC
  where
        SAC.ACC_NUMBER            >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACC_NUMBER            <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and SAC.ACS_ACCOUNT_ID         = CUS.ACS_AUXILIARY_ACCOUNT_ID
    and CUS.PAC_CUSTOM_PARTNER_ID  = EXP.PAC_CUSTOM_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_ISAG" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "PAR_DOCUMENT", "IMF_NUMBER2", "DOC_NUMBER", "DOC_COMMENT", "PAC_CUSTOM_PARTNER_ID", "PER_KEY1", "PER_KEY2", "CAT_KEY", "C_TYPE_CATALOGUE", "CAT_DESCRIPTION", "DOC_DATE_DELIVERY", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_SLICE", "NUMBER_OF_SLICE", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "LAST_PAYMENT_DATE", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE") AS
  select ACT_EXPIRY_ID
       , exp.ACT_DOCUMENT_ID
       , PAR.PAR_DOCUMENT
       , IMP.IMF_NUMBER2
       , (select DOC.DOC_NUMBER
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) DOC_NUMBER
       , (select DOC.DOC_COMMENT
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) DOC_COMMENT
       , PAR.PAC_CUSTOM_PARTNER_ID
       , PER.PER_KEY1
       , PER.PER_KEY2
       , (select CAT.CAT_KEY
            from ACJ_CATALOGUE_DOCUMENT CAT
           where CAT.ACJ_CATALOGUE_DOCUMENT_ID = (select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ) CAT_KEY
       , (select CAT.C_TYPE_CATALOGUE
            from ACJ_CATALOGUE_DOCUMENT CAT
           where CAT.ACJ_CATALOGUE_DOCUMENT_ID = (select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ) C_TYPE_CATALOGUE
       , (select CAT.CAT_DESCRIPTION
            from ACJ_CATALOGUE_DOCUMENT CAT
           where CAT.ACJ_CATALOGUE_DOCUMENT_ID = (select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ) CAT_DESCRIPTION
       , PAR.DOC_DATE_DELIVERY
       , EXP_ADAPTED
       , EXP_CALCULATED
       , EXP_AMOUNT_LC
       , EXP_AMOUNT_FC
       , EXP_SLICE
       , (SELECT COUNT(EXX.ACT_EXPIRY_ID) FROM ACT_EXPIRY EXX WHERE EXX.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID AND EXX.EXP_CALC_NET = 1) NUMBER_OF_SLICE
       , EXP_CALC_NET
       , C_STATUS_EXPIRY
       , EXP_DATE_PMT_TOT
       , EXP_BVR_CODE
       , EXP_REF_BVR
       , exp.ACS_FIN_ACC_S_PAYMENT_ID
       , trunc(sysdate) ANALYSE_DATE
       , IMP.ACS_PERIOD_ID
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY FIN
                                where FIN.ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY1
       , PAR.ACS_ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY FIN
                                where FIN.ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY2
       , IMP.IMF_TRANSACTION_DATE
       , IMP.IMF_VALUE_DATE
       , IMP.IMF_DESCRIPTION
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , (select DOC.ACJ_CATALOGUE_DOCUMENT_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_FUNCTIONS.TotalPayment(exp.ACT_EXPIRY_ID, 1) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPayment(exp.ACT_EXPIRY_ID, 0) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPayment(exp.ACT_EXPIRY_ID, 2) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(IMP.IMF_VALUE_DATE) )
                                                                                                      EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.DiscountAmountAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(IMP.IMF_VALUE_DATE), 1)
                                                                                                        EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.DiscountAmountAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(IMP.IMF_VALUE_DATE), 0)
                                                                                                        EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.DiscountAmountAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(IMP.IMF_VALUE_DATE), 2)
                                                                                                       EXP_DISCOUNT_EUR
       , ACT_FUNCTIONS.LastPaymentDate(exp.ACT_EXPIRY_ID) LAST_PAYMENT_DATE
       , ACT_FUNCTIONS.LastClaimsNumber(exp.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL
       , ACT_FUNCTIONS.LastClaimsDate(exp.ACT_EXPIRY_ID) LAST_CLAIMS_DATE
    from ACT_FINANCIAL_IMPUTATION IMP
       , ACT_EXPIRY exp
       , PAC_PERSON PER
       , ACT_PART_IMPUTATION PAR
   where PAR.PAC_CUSTOM_PARTNER_ID = PER.PAC_PERSON_ID
     and PAR.ACT_PART_IMPUTATION_ID = exp.ACT_PART_IMPUTATION_ID
     and exp.EXP_CALC_NET = 1
     and exp.C_STATUS_EXPIRY <> '9'
     and exp.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID
     and IMP.ACT_DET_PAYMENT_ID is null
     and IMP.ACS_AUXILIARY_ACCOUNT_ID is not null
     and IMP.ACS_FINANCIAL_ACCOUNT_ID in(select ACS_FINANCIAL_ACCOUNT_ID
                                           from ACS_FINANCIAL_ACCOUNT FIN
                                          where FIN.FIN_COLLECTIVE = 1)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_ISAG_JOB" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "PAR_DOCUMENT", "IMF_NUMBER2", "DOC_NUMBER", "PAC_CUSTOM_PARTNER_ID", "PER_KEY1", "PER_KEY2", "CAT_KEY", "C_TYPE_CATALOGUE", "DOC_DATE_DELIVERY", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_SLICE", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "LAST_PAYMENT_DATE", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "JOB_ID") AS
  select ACT_EXPIRY_ID
       , exp.ACT_DOCUMENT_ID
       , PAR.PAR_DOCUMENT
       , IMP.IMF_NUMBER2
       , (select DOC.DOC_NUMBER
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) DOC_NUMBER
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select PER.PER_KEY1
            from PAC_PERSON PER
           where PER.PAC_PERSON_ID = PAR.PAC_CUSTOM_PARTNER_ID) PER_KEY1
       , (select PER.PER_KEY2
            from PAC_PERSON PER
           where PER.PAC_PERSON_ID = PAR.PAC_CUSTOM_PARTNER_ID) PER_KEY2
       , (select CAT.CAT_KEY
            from ACJ_CATALOGUE_DOCUMENT CAT
           where CAT.ACJ_CATALOGUE_DOCUMENT_ID = (select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ) CAT_KEY
       , (select CAT.C_TYPE_CATALOGUE
            from ACJ_CATALOGUE_DOCUMENT CAT
           where CAT.ACJ_CATALOGUE_DOCUMENT_ID = (select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACT_DOCUMENT DOC
                                                   where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ) C_TYPE_CATALOGUE
       , PAR.DOC_DATE_DELIVERY
       , EXP_ADAPTED
       , EXP_CALCULATED
       , EXP_AMOUNT_LC
       , EXP_AMOUNT_FC
       , EXP_SLICE
       , EXP_CALC_NET
       , C_STATUS_EXPIRY
       , EXP_DATE_PMT_TOT
       , EXP_BVR_CODE
       , EXP_REF_BVR
       , exp.ACS_FIN_ACC_S_PAYMENT_ID
       , trunc(sysdate) ANALYSE_DATE
       , IMP.ACS_PERIOD_ID
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY FIN
                                where FIN.ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY1
       , PAR.ACS_ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY FIN
                                where FIN.ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY2
       , IMP.IMF_TRANSACTION_DATE
       , IMP.IMF_VALUE_DATE
       , IMP.IMF_DESCRIPTION
       , IMP.ACS_FINANCIAL_ACCOUNT_ID
       , IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID
       , (select DOC.ACJ_CATALOGUE_DOCUMENT_ID
            from ACT_DOCUMENT DOC
           where DOC.ACT_DOCUMENT_ID = PAR.ACT_DOCUMENT_ID) ACJ_CATALOGUE_DOCUMENT_ID
       , ACT_FUNCTIONS.TotalPayment(exp.ACT_EXPIRY_ID, 1) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPayment(exp.ACT_EXPIRY_ID, 0) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPayment(exp.ACT_EXPIRY_ID, 2) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(sysdate) ) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.DiscountAmountAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(sysdate), 1) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.DiscountAmountAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(sysdate), 0) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.DiscountAmountAfter(exp.ACT_DOCUMENT_ID, exp.EXP_SLICE, trunc(sysdate), 2) EXP_DISCOUNT_EUR
       , ACT_FUNCTIONS.LastPaymentDate(exp.ACT_EXPIRY_ID) LAST_PAYMENT_DATE
       , ACT_FUNCTIONS.LastClaimsNumber(exp.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL
       , ACT_FUNCTIONS.LastClaimsDate(exp.ACT_EXPIRY_ID) LAST_CLAIMS_DATE
       , DOI.ACI_CONVERSION_ID JOB_ID
    from ACT_FINANCIAL_IMPUTATION IMP
       , ACT_EXPIRY exp
       , ACI_DOCUMENT DOI
       , ACT_PART_IMPUTATION PAR
   where PAR.ACT_PART_IMPUTATION_ID = exp.ACT_PART_IMPUTATION_ID
     and PAR.ACT_DOCUMENT_ID = DOI.ACT_DOCUMENT_ID
     and PAR.PAC_CUSTOM_PARTNER_ID is not null
     and exp.EXP_CALC_NET = 1
     and exp.C_STATUS_EXPIRY = '0'
     and ACT_EXPIRY_MANAGEMENT.IsExpiryOpened(exp.ACT_EXPIRY_ID) = 1
     and exp.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID
     and IMP.ACT_DET_PAYMENT_ID is null
     and IMP.ACS_AUXILIARY_ACCOUNT_ID is not null
     and IMP.ACS_FINANCIAL_ACCOUNT_ID in(select ACS_FINANCIAL_ACCOUNT_ID
                                           from ACS_FINANCIAL_ACCOUNT FIN
                                          where FIN.FIN_COLLECTIVE = 1)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SEL_CUST_PAYMENT" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_AMOUNT_TOPAY_LC", "EXP_AMOUNT_TOPAY_FC", "EXP_AMOUNT_TOPAY_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "ACS_AUXILIARY_ACCOUNT_ID", "DOC_NUMBER", "DOC_DOCUMENT_DATE", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "JOU_NUMBER", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select CUS.ACS_AUXILIARY_ACCOUNT_ID
            from PAC_CUSTOM_PARTNER CUS
           where CUS.PAC_CUSTOM_PARTNER_ID = PAR.PAC_CUSTOM_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate)EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , 0 CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
    from ACT_PART_IMPUTATION PAR
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
   where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_EXPIRY_ID in(select SEL.ACT_EXPIRY_ID
                                from ACT_EXPIRY_SELECTION SEL
                               where SEL.ACT_ETAT_EVENT_ID = ACT_FUNCTIONS.GetEtatEvent_Id)
     and PAR.PAC_CUSTOM_PARTNER_ID is not null
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                            from ACJ_CATALOGUE_DOCUMENT
                                           where C_TYPE_CATALOGUE not in('9', '8', '4', '3') )   -- Lettrage, relance, paiement manuel, paiement automatique
     and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
     and DOC.ACT_JOURNAL_ID is not null
     and DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_CUSTOM_PARTNER
           where PAC_CUSTOM_PARTNER_ID = EXP.EXP_PAC_CUSTOM_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfToleranceDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , 0 CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
    from ACT_PART_IMPUTATION PAR
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
   where EXP.EXP_CALC_NET = 1
     and EXP.ACT_EXPIRY_ID in(select SEL.ACT_EXPIRY_ID
                                from ACT_EXPIRY_SELECTION SEL
                               where SEL.ACT_ETAT_EVENT_ID = ACT_FUNCTIONS.GetEtatEvent_Id)
     and PAR.PAC_CUSTOM_PARTNER_ID is not null
     and EXP.ACT_EXPIRY_ID in(select DET.ACT_EXPIRY_ID
                                from ACT_DET_PAYMENT DET
                               where DET.ACT_DOCUMENT_ID = ACT_FUNCTIONS.GetDocument_Id)
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and DOC.ACT_JOURNAL_ID is not null
     and DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_CUSTOM_PARTNER_ID
       , (select CUS.ACS_AUXILIARY_ACCOUNT_ID
            from PAC_CUSTOM_PARTNER CUS
           where CUS.PAC_CUSTOM_PARTNER_ID = PAR.PAC_CUSTOM_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountToleranceDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , 0 CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
    from ACT_PART_IMPUTATION PAR
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
   where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_EXPIRY_ID in(select SEL.ACT_EXPIRY_ID
                                from ACT_EXPIRY_SELECTION SEL
                               where SEL.ACT_ETAT_EVENT_ID = ACT_FUNCTIONS.GetEtatEvent_Id)
     and PAR.PAC_CUSTOM_PARTNER_ID is not null
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                            from ACJ_CATALOGUE_DOCUMENT
                                           where C_TYPE_CATALOGUE in('9', '4', '3') )   -- Lettrage, paiement manuel, paiement automatique
     and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
     and DOC.ACT_JOURNAL_ID is not null
     and DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SEL_SUPP_PAYMENT" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_AMOUNT_TOPAY_LC", "EXP_AMOUNT_TOPAY_FC", "EXP_AMOUNT_TOPAY_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "ACS_AUXILIARY_ACCOUNT_ID", "DOC_NUMBER", "DOC_DOCUMENT_DATE", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "JOU_NUMBER", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_SUPPLIER_PARTNER_ID
       , (select SUP.ACS_AUXILIARY_ACCOUNT_ID
            from PAC_SUPPLIER_PARTNER SUP
           where SUP.PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , (select SUP.CRE_BLOCKED
            from PAC_SUPPLIER_PARTNER SUP
           where SUP.PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
    from ACT_PART_IMPUTATION PAR
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
   where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_EXPIRY_ID in(select SEL.ACT_EXPIRY_ID
                                from ACT_EXPIRY_SELECTION SEL
                               where SEL.ACT_ETAT_EVENT_ID = ACT_FUNCTIONS.GetEtatEvent_Id)
     and PAR.PAC_SUPPLIER_PARTNER_ID is not null
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                            from ACJ_CATALOGUE_DOCUMENT
                                           where C_TYPE_CATALOGUE not in('9', '8', '4', '3') )   -- Lettrage, relance, paiement manuel, paiement automatique
     and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
     and DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_SUPPLIER_PARTNER_ID
       , (select SUP.ACS_AUXILIARY_ACCOUNT_ID
            from PAC_SUPPLIER_PARTNER SUP
           where SUP.PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , (select SUP.CRE_BLOCKED
            from PAC_SUPPLIER_PARTNER SUP
           where SUP.PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
    from ACT_PART_IMPUTATION PAR
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
   where EXP.EXP_CALC_NET = 1
     and EXP.ACT_EXPIRY_ID in(select SEL.ACT_EXPIRY_ID
                                from ACT_EXPIRY_SELECTION SEL
                               where SEL.ACT_ETAT_EVENT_ID = ACT_FUNCTIONS.GetEtatEvent_Id)
     and PAR.PAC_SUPPLIER_PARTNER_ID is not null
     and EXP.ACT_EXPIRY_ID in(select DET.ACT_EXPIRY_ID
                                from ACT_DET_PAYMENT DET
                               where DET.ACT_DOCUMENT_ID = ACT_FUNCTIONS.GetDocument_Id)
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
       , PAR.PAC_SUPPLIER_PARTNER_ID
       , (select SUP.ACS_AUXILIARY_ACCOUNT_ID
            from PAC_SUPPLIER_PARTNER SUP
           where SUP.PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , (select SUP.CRE_BLOCKED
            from PAC_SUPPLIER_PARTNER SUP
           where SUP.PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
    from ACT_PART_IMPUTATION PAR
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
   where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_EXPIRY_ID in(select SEL.ACT_EXPIRY_ID
                                from ACT_EXPIRY_SELECTION SEL
                               where SEL.ACT_ETAT_EVENT_ID = ACT_FUNCTIONS.GetEtatEvent_Id)
     and PAR.PAC_SUPPLIER_PARTNER_ID is not null
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                            from ACJ_CATALOGUE_DOCUMENT
                                           where C_TYPE_CATALOGUE in('9', '4', '3') )   -- Lettrage, paiement manuel, paiement automatique
     and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
     and DOC.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       SUP.ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES       EXP,
       PAC_SUPPLIER_PARTNER SUP,
       ACS_ACCOUNT          SAC
  where
        SAC.ACC_NUMBER             >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACC_NUMBER             <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and SAC.ACS_ACCOUNT_ID          = SUP.ACS_AUXILIARY_ACCOUNT_ID
    and SUP.PAC_SUPPLIER_PARTNER_ID = EXP.PAC_SUPPLIER_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_COVER" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       SUP.ACS_AUXILIARY_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       ACC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(ACC.ACS_ACCOUNT_ID),
       ACC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES_COVER EXP,
       PAC_SUPPLIER_PARTNER SUP,
       ACS_ACCOUNT          ACC
  where
        ACC.ACC_NUMBER              >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and ACC.ACC_NUMBER              <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and ACC.ACS_ACCOUNT_ID           = SUP.ACS_AUXILIARY_ACCOUNT_ID
    and SUP.PAC_SUPPLIER_PARTNER_ID  = EXP.PAC_SUPPLIER_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_CTRL" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       SUP.ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES       EXP,
       PAC_SUPPLIER_PARTNER SUP,
       ACS_ACCOUNT          SAC
  where
        SAC.ACC_NUMBER              = ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACS_ACCOUNT_ID          = SUP.ACS_AUXILIARY_ACCOUNT_ID
    and SUP.PAC_SUPPLIER_PARTNER_ID = EXP.PAC_SUPPLIER_PARTNER_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_EVAL" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_TYPE_CUMUL", "EXP_PAYABLE_EVAL_LC") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       SUP.ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       EXP.ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC,
       EXP.EXP_DISCOUNT_FC,
       EXP.EXP_DISCOUNT_EUR,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_TYPE_CUMUL,
       decode(EXP.ACS_FINANCIAL_CURRENCY_ID, EXP.ACS_ACS_FINANCIAL_CURRENCY_ID, EXP.EXP_AMOUNT_LC - EXP.DET_PAIED_LC,
              ACT_CURRENCY_EVALUATION.GetConvertAmount(EXP.EXP_AMOUNT_FC - EXP.DET_PAIED_FC, EXP.ACS_FINANCIAL_CURRENCY_ID, EXP.ACS_ACS_FINANCIAL_CURRENCY_ID, ACT_FUNCTIONS.GetAnalyse_Date, ACT_CURRENCY_EVALUATION.GetRateType))
  from
       V_ACT_EXPIRIES       EXP,
       PAC_SUPPLIER_PARTNER SUP,
       ACS_ACCOUNT          SAC
  where
        SAC.ACC_NUMBER             >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACC_NUMBER             <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and SAC.ACS_ACCOUNT_ID          = SUP.ACS_AUXILIARY_ACCOUNT_ID
    and SUP.PAC_SUPPLIER_PARTNER_ID = EXP.PAC_SUPPLIER_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_EXTRACT" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "DOC_DOCUMENT_DATE", "DIC_PRIORITY_PAYMENT_ID", "DIC_LEVEL_PRIORITY_ID", "DIC_CENTER_PAYMENT_ID", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACC_BLOCKED", "C_ETAT_JOURNAL", "C_JOB_STATE", "CAT_DESCRIPTION", "JOB_DESCRIPTION", "ACS_PAYMENT_METHOD_ID", "C_TYPE_CUMUL", "ACS_DIVISION_ACCOUNT_ID", "EXP_DISCOUNT_LC_MAX", "EXP_DISCOUNT_FC_MAX", "EXP_DISCOUNT_EUR_MAX", "PREDATAENTRY", "C_CURR_RATE_COVER_TYPE") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       SUP.ACS_AUXILIARY_ACCOUNT_ID,
       (select SAC.ACC_NUMBER from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = SUP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select SAC.ACS_SUB_SET_ID from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = SUP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID,
       (select PER.PER_NAME from PAC_PERSON PER where PER.PAC_PERSON_ID = SUP.PAC_SUPPLIER_PARTNER_ID) PER_NAME,
       ACT_FUNCTIONS.GetPayDate ANALYSE_DATE,
       (select IMP.ACS_PERIOD_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) ACS_PERIOD_ID,
       (select IMP.ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = (select IMP.ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1))) CURRENCY1,
       (select IMP.ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = (select IMP.ACS_ACS_FINANCIAL_CURRENCY_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1))) CURRENCY2,
       (select IMP.IMF_TRANSACTION_DATE from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) IMF_TRANSACTION_DATE,
       (select IMP.IMF_VALUE_DATE from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) IMF_VALUE_DATE,
       (select IMP.IMF_DESCRIPTION from ACT_FINANCIAL_IMPUTATION IMP where IMP.ACT_DOCUMENT_ID = EXP.ACT_DOCUMENT_ID and IMP.IMF_PRIMARY = 1) IMF_DESCRIPTION,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR.PAR_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       DOC.DOC_DOCUMENT_DATE,
       nvl(nvl((select PAR.DIC_PRIORITY_PAYMENT_ID from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID)
               , SUP.DIC_PRIORITY_PAYMENT_ID), 'zzz'),
       nvl(nvl((select PAR.DIC_LEVEL_PRIORITY_ID from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID)
               , SUP.DIC_LEVEL_PRIORITY_ID), 'zzz'),
       nvl((select PAR.DIC_CENTER_PAYMENT_ID from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID)
           , SUP.DIC_CENTER_PAYMENT_ID),
       (select PAR.PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       SUP.CRE_BLOCKED,
       (select SAC.ACC_BLOCKED from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = SUP.ACS_AUXILIARY_ACCOUNT_ID) ACC_BLOCKED,
       (select JOU.C_ETAT_JOURNAL from ACT_ETAT_JOURNAL JOU where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID AND JOU.C_SUB_SET = 'PAY') C_ETAT_JOURNAL,
       (select JOB.C_JOB_STATE from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) C_JOB_STATE,
       (select CATA.CAT_DESCRIPTION from ACJ_CATALOGUE_DOCUMENT CATA where CATA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID) CAT_DESCRIPTION,
       (select JOB.JOB_DESCRIPTION from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) JOB_DESCRIPTION,
       NVL((select pay2.acs_payment_method_id from acs_fin_acc_s_payment pay2 where
        pay2.ACS_FIN_ACC_S_PAYMENT_ID = EXP.ACS_FIN_ACC_S_PAYMENT_ID),
        (select pay.acs_payment_method_id from acs_fin_acc_s_payment pay where
        pay.ACS_FIN_ACC_S_PAYMENT_ID = SUP.ACS_FIN_ACC_S_PAYMENT_ID)) ACS_PAYMENT_METHOD_ID,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL,
       ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) ACS_DIVISION_ACCOUNT_ID,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 1) EXP_DISCOUNT_LC_MAX,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC_MAX,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR_MAX,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID)  PREDATAENTRY,
       DOC.C_CURR_RATE_COVER_TYPE
  from
       ACT_DOCUMENT DOC,
       PAC_SUPPLIER_PARTNER SUP,
       ACT_EXPIRY EXP
  where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
    and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
    and DOC.ACS_FINANCIAL_YEAR_ID in (select ACS_FINANCIAL_YEAR_ID from ACS_FINANCIAL_YEAR where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate)
    and EXP.EXP_PAC_SUPPLIER_PARTNER_ID = SUP.PAC_SUPPLIER_PARTNER_ID
    and EXP.ACT_DOCUMENT_ID in (select IMP.ACT_DOCUMENT_ID from ACT_FINANCIAL_IMPUTATION IMP where IMP.IMF_PRIMARY = 1)
    and EXP.EXP_CALC_NET = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_EXTRACT_FC" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "DET_DIFF_EXCHANGE", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "DOC_DOCUMENT_DATE", "DIC_PRIORITY_PAYMENT_ID", "DIC_LEVEL_PRIORITY_ID", "DIC_CENTER_PAYMENT_ID", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACC_BLOCKED", "C_ETAT_JOURNAL", "C_JOB_STATE", "CAT_DESCRIPTION", "JOB_DESCRIPTION", "ACS_PAYMENT_METHOD_ID", "C_TYPE_CUMUL", "ACS_DIVISION_ACCOUNT_ID", "EXP_DISCOUNT_LC_MAX", "EXP_DISCOUNT_FC_MAX", "EXP_DISCOUNT_EUR_MAX", "PREDATAENTRY", "IMF_EXCHANGE_RATE", "C_CURR_RATE_COVER_TYPE") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.EXP_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       SUP.ACS_AUXILIARY_ACCOUNT_ID,
       (select SAC.ACC_NUMBER from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = SUP.ACS_AUXILIARY_ACCOUNT_ID) ACC_NUMBER,
       (select SAC.ACS_SUB_SET_ID from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = SUP.ACS_AUXILIARY_ACCOUNT_ID) ACS_SUB_SET_ID,
       (select PER.PER_NAME from PAC_PERSON PER where PER.PAC_PERSON_ID = SUP.PAC_SUPPLIER_PARTNER_ID) PER_NAME,
       ACT_FUNCTIONS.GetPayDate ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = IMP.ACS_FINANCIAL_CURRENCY_ID)) CURRENCY1,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       (select CURRENCY from PCS.PC_CURR where PC_CURR_ID = (select PC_CURR_ID from ACS_FINANCIAL_CURRENCY where ACS_FINANCIAL_CURRENCY_ID = IMP.ACS_ACS_FINANCIAL_CURRENCY_ID)) CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0) DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 2) DET_PAIED_EUR,
       ACS_FUNCTION.RoundNear((EXP_AMOUNT_LC - ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 1)) - ACS_FUNCTION.ConvertAmountForView( (EXP_AMOUNT_FC - ACT_FUNCTIONS.TotalPayment(EXP.ACT_EXPIRY_ID, 0)), IMP.ACS_FINANCIAL_CURRENCY_ID, IMP.ACS_ACS_FINANCIAL_CURRENCY_ID, ACT_FUNCTIONS.GetPayDate, 0, 0, 1), 0.01) DET_DIFF_EXCHANGE,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE,
       ACS_FUNCTION.ConvertAmountForView(ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0), IMP.ACS_FINANCIAL_CURRENCY_ID, IMP.ACS_ACS_FINANCIAL_CURRENCY_ID, ACT_FUNCTIONS.GetPayDate, 0, 0, 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR,
       DOC.DOC_NUMBER,
       (select PAR.PAR_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       DOC.DOC_DOCUMENT_DATE,
       nvl(nvl((select PAR.DIC_PRIORITY_PAYMENT_ID from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID)
               , SUP.DIC_PRIORITY_PAYMENT_ID), 'zzz') DIC_PRIORITY_PAYMENT_ID,
       nvl(nvl((select PAR.DIC_LEVEL_PRIORITY_ID from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID)
               , SUP.DIC_LEVEL_PRIORITY_ID), 'zzz') DIC_LEVEL_PRIORITY_ID,
       nvl((select PAR.DIC_CENTER_PAYMENT_ID from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID)
           , SUP.DIC_CENTER_PAYMENT_ID) DIC_CENTER_PAYMENT_ID,
       (select PAR.PAR_BLOCKED_DOCUMENT from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID) PAR_BLOCKED_DOCUMENT,
       SUP.CRE_BLOCKED,
       (select SAC.ACC_BLOCKED from ACS_ACCOUNT SAC where SAC.ACS_ACCOUNT_ID = SUP.ACS_AUXILIARY_ACCOUNT_ID) ACC_BLOCKED,
       (select JOU.C_ETAT_JOURNAL from ACT_ETAT_JOURNAL JOU where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID AND JOU.C_SUB_SET = 'PAY') C_ETAT_JOURNAL,
       (select JOB.C_JOB_STATE from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) C_JOB_STATE,
       (select CATA.CAT_DESCRIPTION from ACJ_CATALOGUE_DOCUMENT CATA where CATA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID) CAT_DESCRIPTION,
       (select JOB.JOB_DESCRIPTION from ACT_JOB JOB where JOB.ACT_JOB_ID = DOC.ACT_JOB_ID) JOB_DESCRIPTION,
       NVL((select pay2.acs_payment_method_id from acs_fin_acc_s_payment pay2 where
        pay2.ACS_FIN_ACC_S_PAYMENT_ID = EXP.ACS_FIN_ACC_S_PAYMENT_ID),
        (select pay.acs_payment_method_id from acs_fin_acc_s_payment pay where
        pay.ACS_FIN_ACC_S_PAYMENT_ID = SUP.ACS_FIN_ACC_S_PAYMENT_ID)) ACS_PAYMENT_METHOD_ID,
       substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL,
       ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) ACS_DIVISION_ACCOUNT_ID,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 1) EXP_DISCOUNT_LC_MAX,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 0) EXP_DISCOUNT_FC_MAX,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate, 2) EXP_DISCOUNT_EUR_MAX,
       ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID)  PREDATAENTRY,
       IMP.IMF_EXCHANGE_RATE,
       DOC.C_CURR_RATE_COVER_TYPE
  from
       ACT_DOCUMENT DOC,
       ACT_FINANCIAL_IMPUTATION IMP,
       PAC_SUPPLIER_PARTNER SUP,
       ACT_EXPIRY EXP
  where to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
    and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
    and DOC.ACS_FINANCIAL_YEAR_ID in (select ACS_FINANCIAL_YEAR_ID from ACS_FINANCIAL_YEAR where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate)
    and EXP.EXP_PAC_SUPPLIER_PARTNER_ID = SUP.PAC_SUPPLIER_PARTNER_ID
    and EXP.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
    and IMP.IMF_PRIMARY  = 1
    and EXP.EXP_CALC_NET = 1
    and IMP.ACS_FINANCIAL_CURRENCY_ID <> IMP.ACS_ACS_FINANCIAL_CURRENCY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_PAYMENT" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_AMOUNT_TOPAY_LC", "EXP_AMOUNT_TOPAY_FC", "EXP_AMOUNT_TOPAY_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "ACS_AUXILIARY_ACCOUNT_ID", "DOC_NUMBER", "DOC_DOCUMENT_DATE", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "JOU_NUMBER", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "PAR_BLOCKED_DOCUMENT", "CRE_BLOCKED", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "C_TYPE_CUMUL", "IMF_DESCRIPTION") AS
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
        , PAR.PAC_SUPPLIER_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_SUPPLIER_PARTNER
           where PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , JOU.JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , (select CRE_BLOCKED
            from PAC_SUPPLIER_PARTNER
           where PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
       , ACT_FUNCTIONS.DescriptionOfExpiry(PAR.ACT_PART_IMPUTATION_ID) IMF_DESCRIPTION
    from ACT_JOURNAL JOU
       , (select DOC.*
            from ACT_DOCUMENT DOC
           where DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                                    from ACJ_CATALOGUE_DOCUMENT
                                                   where C_TYPE_CATALOGUE not in('9', '8', '4', '3') )   -- Lettrage, relance, paiement manuel, paiement automatique
             and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
             and DOC.ACS_FINANCIAL_YEAR_ID in(select ACS_FINANCIAL_YEAR_ID
                                                from ACS_FINANCIAL_YEAR
                                               where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate) ) DOC
       , ACT_EXPIRY EXP
       , ACT_PART_IMPUTATION PAR
   where PAR.PAC_SUPPLIER_PARTNER_ID in(select SUP.PAC_SUPPLIER_PARTNER_ID
                                          from PAC_SUPPLIER_PARTNER SUP
                                         where SUP.ACS_AUXILIARY_ACCOUNT_ID = ACT_FUNCTIONS.GetAuxiliary_Id)
     and PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID
     and to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
     and (    (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is null)
          or (     (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is not null)
              and (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) in(
                                       select COLUMN_VALUE ACS_DIVISION_ACCOUNT_ID
                                         from table
                                                  (ACS_FUNCTION.TableDivisionsAuthorized(PCS.PC_I_LIB_SESSION.GetUserId) ) )
                  )
             )
         )
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 1
                                        ) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 0
                                        ) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                               , EXP.EXP_SLICE
                                                                               , ACT_FUNCTIONS.GetPayDate
                                                                                )
                                           , EXP.ACT_EXPIRY_ID
                                            )
                                       , 2
                                        ) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
        , PAR.PAC_SUPPLIER_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_SUPPLIER_PARTNER
           where PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , (select JOU.JOU_NUMBER
            from ACT_JOURNAL JOU
           where JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 1
                                          ) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 0
                                          ) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(nvl(ACT_FUNCTIONS.GetExpiryIdOfDateOnly(EXP.ACT_DOCUMENT_ID
                                                                                 , EXP.EXP_SLICE
                                                                                 , ACT_FUNCTIONS.GetPayDate
                                                                                  )
                                             , EXP.ACT_EXPIRY_ID
                                              )
                                         , 2
                                          ) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , (select CRE_BLOCKED
            from PAC_SUPPLIER_PARTNER
           where PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
       , ACT_FUNCTIONS.DescriptionOfExpiry(PAR.ACT_PART_IMPUTATION_ID) IMF_DESCRIPTION
    from ACT_DOCUMENT DOC
       , ACT_PART_IMPUTATION PAR
       , ACT_EXPIRY EXP
   where EXP.ACT_EXPIRY_ID in(select DET.ACT_EXPIRY_ID
                                from ACT_DET_PAYMENT DET
                               where DET.ACT_DOCUMENT_ID = ACT_FUNCTIONS.GetDocument_Id)
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID
     and PAR.PAC_SUPPLIER_PARTNER_ID in(select SUP.PAC_SUPPLIER_PARTNER_ID
                                          from PAC_SUPPLIER_PARTNER SUP
                                         where SUP.ACS_AUXILIARY_ACCOUNT_ID = ACT_FUNCTIONS.GetAuxiliary_Id)
     and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and (    (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is null)
          or (     (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is not null)
              and (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) in(
                                       select COLUMN_VALUE ACS_DIVISION_ACCOUNT_ID
                                         from table
                                                  (ACS_FUNCTION.TableDivisionsAuthorized(PCS.PC_I_LIB_SESSION.GetUserId) ) )
                  )
             )
         )
  union
  select EXP.ACT_EXPIRY_ID
       , EXP.ACT_DOCUMENT_ID
       , EXP.ACT_PART_IMPUTATION_ID
       , EXP.EXP_ADAPTED
       , EXP.EXP_CALCULATED
       , EXP.EXP_AMOUNT_LC
       , EXP.EXP_AMOUNT_FC
       , EXP.EXP_AMOUNT_EUR
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_AMOUNT_TOPAY_LC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_AMOUNT_TOPAY_FC
       , ACT_FUNCTIONS.GetAmountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_AMOUNT_TOPAY_EUR
       , EXP.EXP_SLICE
       , EXP.EXP_POURCENT
       , EXP.EXP_CALC_NET
       , EXP.C_STATUS_EXPIRY
       , EXP.EXP_DATE_PMT_TOT
       , EXP.EXP_BVR_CODE
       , EXP.EXP_REF_BVR
       , EXP.ACS_FIN_ACC_S_PAYMENT_ID
       , EXP.EXP_AMOUNT_PROV_LC
       , EXP.EXP_AMOUNT_PROV_FC
        , PAR.PAC_SUPPLIER_PARTNER_ID
       , (select ACS_AUXILIARY_ACCOUNT_ID
            from PAC_SUPPLIER_PARTNER
           where PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) ACS_AUXILIARY_ACCOUNT_ID
       , DOC.DOC_NUMBER
       , DOC.DOC_DOCUMENT_DATE
       , PAR.PAR_DOCUMENT
       , PAR.DOC_DATE_DELIVERY
       , JOU.JOU_NUMBER
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 1, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_LC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 0, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_FC
       , ACT_FUNCTIONS.TotalPaymentWithoutDocument(EXP.ACT_EXPIRY_ID, 2, ACT_FUNCTIONS.GetDocument_Id) DET_PAIED_EUR
       , ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, ACT_FUNCTIONS.GetPayDate) EXP_DISCOUNT_DATE
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 1) EXP_DISCOUNT_LC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 0) EXP_DISCOUNT_FC
       , ACT_FUNCTIONS.GetDiscountOfExpiry(EXP.ACT_EXPIRY_ID, 2) EXP_DISCOUNT_EUR
       , PAR.PAR_BLOCKED_DOCUMENT
       , (select CRE_BLOCKED
            from PAC_SUPPLIER_PARTNER
           where PAC_SUPPLIER_PARTNER_ID = PAR.PAC_SUPPLIER_PARTNER_ID) CRE_BLOCKED
       , PAR.ACS_FINANCIAL_CURRENCY_ID
       , (select CURRENCY
            from PCS.PC_CURR
           where PC_CURR_ID = (select PC_CURR_ID
                                 from ACS_FINANCIAL_CURRENCY
                                where ACS_FINANCIAL_CURRENCY_ID = PAR.ACS_FINANCIAL_CURRENCY_ID) ) CURRENCY
       , substr(ACT_FUNCTIONS.GetCumulTyp(DOC.ACJ_CATALOGUE_DOCUMENT_ID, 'PAY'), 1, 3) C_TYPE_CUMUL
       , ACT_FUNCTIONS.DescriptionOfExpiry(PAR.ACT_PART_IMPUTATION_ID) IMF_DESCRIPTION
    from ACT_JOURNAL JOU
       , ACT_DOCUMENT DOC
       , ACT_EXPIRY EXP
       , ACT_PART_IMPUTATION PAR
   where PAR.PAC_SUPPLIER_PARTNER_ID in(select SUP.PAC_SUPPLIER_PARTNER_ID
                                          from PAC_SUPPLIER_PARTNER SUP
                                         where SUP.ACS_AUXILIARY_ACCOUNT_ID = ACT_FUNCTIONS.GetAuxiliary_Id)
     and DOC.ACS_FINANCIAL_YEAR_ID in(select ACS_FINANCIAL_YEAR_ID
                                        from ACS_FINANCIAL_YEAR
                                       where FYE_START_DATE <= ACT_FUNCTIONS.GetEndFinYearDate)
     and PAR.ACT_PART_IMPUTATION_ID = EXP.ACT_PART_IMPUTATION_ID
     and to_number(EXP.C_STATUS_EXPIRY) + 0 = 0
     and EXP.EXP_CALC_NET = 1
     and EXP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
     and DOC.ACJ_CATALOGUE_DOCUMENT_ID in(select ACJ_CATALOGUE_DOCUMENT_ID
                                            from ACJ_CATALOGUE_DOCUMENT
                                           where C_TYPE_CATALOGUE in('9', '4', '3') )   -- Lettrage, paiement manuel, paiement automatique
     and DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
     and ACT_FUNCTIONS.GetPreDataEntry(DOC.ACT_DOCUMENT_ID) <> 1
     and (    (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is null)
          or (     (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) is not null)
              and (ACT_FUNCTIONS.GetCollDivisionId(EXP.ACT_EXPIRY_ID) in(
                                       select COLUMN_VALUE ACS_DIVISION_ACCOUNT_ID
                                         from table
                                                  (ACS_FUNCTION.TableDivisionsAuthorized(PCS.PC_I_LIB_SESSION.GetUserId) ) )
                  )
             )
         )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_SUPP_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_SUPPLIER_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC,
       EXP.PAC_SUPPLIER_PARTNER_ID,
       SAC.ACS_ACCOUNT_ID ACS_AUXILIARY_ACCOUNT_ID,
       SAC.ACC_NUMBER,
       SAC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(SAC.ACS_ACCOUNT_ID),
       SAC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       null,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC,
       EXP.DET_PAIED_FC,
       EXP.DET_PAIED_EUR,
       0,
       0,
       0,
       0,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES_STATUS EXP,
       PAC_SUPPLIER_PARTNER  SUP,
       ACS_ACCOUNT           SAC
  where
        SAC.ACC_NUMBER              >= ACT_FUNCTIONS.GetAnalyse_Auxiliary(1)
    and SAC.ACC_NUMBER              <= ACT_FUNCTIONS.GetAnalyse_Auxiliary(0)
    and SAC.ACS_ACCOUNT_ID           = SUP.ACS_AUXILIARY_ACCOUNT_ID
    and SUP.PAC_SUPPLIER_PARTNER_ID  = EXP.PAC_SUPPLIER_PARTNER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_THIRD" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC * PER.COEFF,
       EXP.EXP_AMOUNT_FC * PER.COEFF,
       EXP.EXP_AMOUNT_EUR * PER.COEFF,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC * PER.COEFF,
       EXP.EXP_AMOUNT_PROV_FC * PER.COEFF,
       PER.PAC_PERSON_ID,
       ACC.ACS_ACCOUNT_ID ACS_AUXILIARY_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       ACC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(ACC.ACS_ACCOUNT_ID),
       ACC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       ANALYSE_DATE,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC * PER.COEFF,
       EXP.DET_PAIED_FC * PER.COEFF,
       EXP.DET_PAIED_EUR * PER.COEFF,
       EXP.EXP_DISCOUNT_DATE,
       EXP.EXP_DISCOUNT_LC * PER.COEFF,
       EXP.EXP_DISCOUNT_FC * PER.COEFF,
       EXP.EXP_DISCOUNT_EUR * PER.COEFF,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES     EXP,
       ACS_ACCOUNT        ACC,
       (select 1 COEFF,
               PAC_CUSTOM_PARTNER_ID PAC_PERSON_ID,
               CUS.ACS_AUXILIARY_ACCOUNT_ID
    		from PAC_CUSTOM_PARTNER CUS
  		  union all
  		  select -1 COEFF,
               PAC_SUPPLIER_PARTNER_ID PAC_PERSON_ID,
               SUP.ACS_AUXILIARY_ACCOUNT_ID
  		  from PAC_SUPPLIER_PARTNER SUP) PER
  where
        PER.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID AND
        DECODE(PER.COEFF, 1, EXP.PAC_CUSTOM_PARTNER_ID, EXP.PAC_SUPPLIER_PARTNER_ID) = PER.PAC_PERSON_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EXPIRY_THIRD_STATUS" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "ACT_PART_IMPUTATION_ID", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_AMOUNT_EUR", "EXP_SLICE", "EXP_POURCENT", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "EXP_AMOUNT_PROV_LC", "EXP_AMOUNT_PROV_FC", "PAC_PERSON_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "DES_ACC_NUMBER", "ACS_SUB_SET_ID", "PER_NAME", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "DOC_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE", "BRO", "TYP_SUPPLIER_PERMANENT", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select EXP.ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       EXP.ACT_PART_IMPUTATION_ID,
       EXP.EXP_ADAPTED,
       EXP.EXP_CALCULATED,
       EXP.EXP_AMOUNT_LC * PER.COEFF EXP_AMOUNT_LC,
       EXP.EXP_AMOUNT_FC * PER.COEFF EXP_AMOUNT_FC,
       EXP.EXP_AMOUNT_EUR * PER.COEFF EXP_AMOUNT_EUR,
       EXP.EXP_SLICE,
       EXP.EXP_POURCENT,
       EXP.EXP_CALC_NET,
       EXP.C_STATUS_EXPIRY,
       EXP.EXP_DATE_PMT_TOT,
       EXP.EXP_BVR_CODE,
       EXP.EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       EXP.EXP_AMOUNT_PROV_LC * PER.COEFF EXP_AMOUNT_PROV_LC,
       EXP.EXP_AMOUNT_PROV_FC * PER.COEFF EXP_AMOUNT_PROV_FC,
       PER.PAC_PERSON_ID,
       ACC.ACS_ACCOUNT_ID ACS_AUXILIARY_ACCOUNT_ID,
       ACC.ACC_NUMBER,
       ACC.ACC_NUMBER ||', '|| ACS_FUNCTION.GETACCOUNTDESCRIPTIONSUMMARY(ACC.ACS_ACCOUNT_ID),
       ACC.ACS_SUB_SET_ID,
       EXP.PER_NAME,
       null,
       EXP.ACS_PERIOD_ID,
       EXP.ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY1,
       EXP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       EXP.CURRENCY2,
       EXP.IMF_TRANSACTION_DATE,
       EXP.IMF_VALUE_DATE,
       EXP.IMF_DESCRIPTION,
       EXP.ACS_FINANCIAL_ACCOUNT_ID,
       EXP.ACS_DIVISION_ACCOUNT_ID,
       EXP.ACJ_CATALOGUE_DOCUMENT_ID,
       EXP.DET_PAIED_LC * PER.COEFF DET_PAIED_LC,
       EXP.DET_PAIED_FC * PER.COEFF DET_PAIED_FC,
       EXP.DET_PAIED_EUR * PER.COEFF DET_PAIED_EUR,
       0,
       0,
       0,
       0,
       EXP.DOC_NUMBER,
       EXP.PAR_DOCUMENT,
       EXP.DOC_DATE_DELIVERY,
       EXP.LAST_CLAIMS_LEVEL,
       EXP.LAST_CLAIMS_DATE,
       EXP.BRO,
       EXP.TYP_SUPPLIER_PERMANENT,
       EXP.C_ETAT_JOURNAL,
       EXP.C_TYPE_CUMUL
  from
       V_ACT_EXPIRIES_STATUS EXP,
   	   ACS_ACCOUNT ACC,
       (select 1 COEFF,
               PAC_CUSTOM_PARTNER_ID PAC_PERSON_ID,
               CUS.ACS_AUXILIARY_ACCOUNT_ID
    		from PAC_CUSTOM_PARTNER CUS
  		  union all
  		  select -1 COEFF,
               PAC_SUPPLIER_PARTNER_ID PAC_PERSON_ID,
               SUP.ACS_AUXILIARY_ACCOUNT_ID
  		  from PAC_SUPPLIER_PARTNER SUP) PER
  where
        PER.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID AND
        DECODE(PER.COEFF, 1, EXP.PAC_CUSTOM_PARTNER_ID, EXP.PAC_SUPPLIER_PARTNER_ID) = PER.PAC_PERSON_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_EYPIRY_ISAG" ("ACT_EXPIRY_ID", "ACT_DOCUMENT_ID", "PAR_DOCUMENT", "IMF_NUMBER2", "DOC_NUMBER", "PAC_CUSTOM_PARTNER_ID", "PER_KEY1", "PER_KEY2", "CAT_KEY", "C_TYPE_CATALOGUE", "DOC_DATE_DELIVERY", "EXP_ADAPTED", "EXP_CALCULATED", "EXP_AMOUNT_LC", "EXP_AMOUNT_FC", "EXP_SLICE", "EXP_CALC_NET", "C_STATUS_EXPIRY", "EXP_DATE_PMT_TOT", "EXP_BVR_CODE", "EXP_REF_BVR", "ACS_FIN_ACC_S_PAYMENT_ID", "ANALYSE_DATE", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY1", "ACS_ACS_FINANCIAL_CURRENCY_ID", "CURRENCY2", "IMF_TRANSACTION_DATE", "IMF_VALUE_DATE", "IMF_DESCRIPTION", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "DET_PAIED_LC", "DET_PAIED_FC", "DET_PAIED_EUR", "EXP_DISCOUNT_DATE", "EXP_DISCOUNT_LC", "EXP_DISCOUNT_FC", "EXP_DISCOUNT_EUR", "LAST_PAYMENT_DATE", "LAST_CLAIMS_LEVEL", "LAST_CLAIMS_DATE") AS
  select ACT_EXPIRY_ID,
       EXP.ACT_DOCUMENT_ID,
       PAR.PAR_DOCUMENT,
       IMP.IMF_NUMBER2,
       DOC.DOC_NUMBER,
       PAR.PAC_CUSTOM_PARTNER_ID,
       PER.PER_KEY1,
       PER.PER_KEY2,
       CATA.CAT_KEY,
       CATA.C_TYPE_CATALOGUE,
       PAR.DOC_DATE_DELIVERY,
       EXP_ADAPTED,
       EXP_CALCULATED,
       EXP_AMOUNT_LC,
       EXP_AMOUNT_FC,
       EXP_SLICE,
       EXP_CALC_NET,
       C_STATUS_EXPIRY,
       EXP_DATE_PMT_TOT,
       EXP_BVR_CODE,
       EXP_REF_BVR,
       EXP.ACS_FIN_ACC_S_PAYMENT_ID,
       TRUNC(SYSDATE) ANALYSE_DATE,
       IMP.ACS_PERIOD_ID,
       PAR.ACS_FINANCIAL_CURRENCY_ID,
       CUR1.CURRENCY CURRENCY1,
       PAR.ACS_ACS_FINANCIAL_CURRENCY_ID,
       CUR2.CURRENCY CURRENCY2,
       IMP.IMF_TRANSACTION_DATE,
       IMP.IMF_VALUE_DATE,
       IMP.IMF_DESCRIPTION,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       DIS.ACS_DIVISION_ACCOUNT_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, TRUNC(SYSDATE), 1) DET_PAIED_LC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, TRUNC(SYSDATE), 0)DET_PAIED_FC,
       ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, TRUNC(SYSDATE), 2)DET_PAIED_EUR,
       ACT_FUNCTIONS.DiscountDateAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, TRUNC(SYSDATE)) EXP_DISCOUNT_DATE,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, TRUNC(SYSDATE), 1) EXP_DISCOUNT_LC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, TRUNC(SYSDATE), 0) EXP_DISCOUNT_FC,
       ACT_FUNCTIONS.DiscountAmountAfter(EXP.ACT_DOCUMENT_ID, EXP.EXP_SLICE, TRUNC(SYSDATE), 2) EXP_DISCOUNT_EUR,
	   ACT_FUNCTIONS.LastPaymentDate(EXP.ACT_EXPIRY_ID) LAST_PAYMENT_DATE,
       ACT_FUNCTIONS.LastClaimsNumber(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_LEVEL,
       ACT_FUNCTIONS.LastClaimsDate(EXP.ACT_EXPIRY_ID) LAST_CLAIMS_DATE
  from
       PCS.PC_CURR                CUR2,
       ACS_FINANCIAL_CURRENCY     FIN2,
       PCS.PC_CURR                CUR1,
       ACS_FINANCIAL_CURRENCY     FIN1,
       ACT_FINANCIAL_DISTRIBUTION DIS,
       ACS_FINANCIAL_ACCOUNT      FIN,
       ACT_FINANCIAL_IMPUTATION   IMP,
       ACT_EXPIRY                 EXP,
       ACJ_CATALOGUE_DOCUMENT     CATA,
       ACT_DOCUMENT               DOC,
	   PAC_PERSON				  PER,
       ACT_PART_IMPUTATION        PAR
  where
        PAR.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
	AND PAR.PAC_CUSTOM_PARTNER_ID         = PER.PAC_PERSON_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID     = CATA.ACJ_CATALOGUE_DOCUMENT_ID
    and C_TYPE_CATALOGUE                 <> '8'   -- Transaction de relance
    and PAR.ACT_PART_IMPUTATION_ID        = EXP.ACT_PART_IMPUTATION_ID
    and EXP_CALC_NET + 0                  = 1
	AND EXP.C_STATUS_EXPIRY||' '			  = 0
    and EXP.EXP_AMOUNT_LC <> ACT_FUNCTIONS.TotalPaymentAt(EXP.ACT_EXPIRY_ID, TRUNC(SYSDATE), 1)
    and EXP.ACT_PART_IMPUTATION_ID        = IMP.ACT_PART_IMPUTATION_ID
    and IMP.ACT_DET_PAYMENT_ID is null and IMP.ACS_AUXILIARY_ACCOUNT_ID is not null
    and IMP.ACS_FINANCIAL_ACCOUNT_ID      = FIN.ACS_FINANCIAL_ACCOUNT_ID
    and FIN.FIN_COLLECTIVE                = 1
    and IMP.ACT_FINANCIAL_IMPUTATION_ID   = DIS.ACT_FINANCIAL_IMPUTATION_ID (+)
    and PAR.ACS_FINANCIAL_CURRENCY_ID     = FIN1.ACS_FINANCIAL_CURRENCY_ID
    and FIN1.PC_CURR_ID                   = CUR1.PC_CURR_ID
    and PAR.ACS_ACS_FINANCIAL_CURRENCY_ID = FIN2.ACS_FINANCIAL_CURRENCY_ID
    and FIN2.PC_CURR_ID                   = CUR2.PC_CURR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_FINANCIAL_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_ACS_AUX_ACCOUNT_CUST_ID", "IMF_ACS_AUX_ACCOUNT_SUPP_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "PAC_PERSON_ID", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "FINANCIAL_IMPUTATION_ID", "IMF_COMPARE_DATE", "ACT_JOURNAL_ID", "PER_NO_PERIOD", "ACS_FINANCIAL_YEAR_ID", "C_TYPE_CUMUL_ACC", "C_TYPE_CUMUL_REC", "C_TYPE_CUMUL_PAY", "C_TYPE_CATALOGUE") AS
  SELECT IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID,
       IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       nvl(IMP.IMF_PAC_CUSTOM_PARTNER_ID, IMP.IMF_PAC_SUPPLIER_PARTNER_ID) PAC_PERSON_ID,
       IMP.IMF_PAC_CUSTOM_PARTNER_ID PAC_CUSTOM_PARTNER_ID,
       IMP.IMF_PAC_SUPPLIER_PARTNER_ID PAC_SUPPLIER_PARTNER_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (SELECT ACC.ACC_NUMBER FROM ACS_ACCOUNT ACC WHERE ACC.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID,
       IMP.IMF_COMPARE_DATE,
       (SELECT ACT_JOURNAL_ID FROM ACT_DOCUMENT WHERE ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID) ACT_JOURNAL_ID,
       (SELECT PER.PER_NO_PERIOD FROM ACS_PERIOD PER WHERE PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID) PER_NO_PERIOD,
       (SELECT PER.ACS_FINANCIAL_YEAR_ID FROM ACS_PERIOD PER WHERE PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID) ACS_FINANCIAL_YEAR_ID,
       (SELECT C_TYPE_CUMUL FROM ACJ_SUB_SET_CAT SUB WHERE SUB.C_SUB_SET = 'ACC' AND SUB.ACJ_CATALOGUE_DOCUMENT_ID = (SELECT ACJ_CATALOGUE_DOCUMENT_ID FROM ACT_DOCUMENT WHERE ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)) C_TYPE_CUMUL_ACC,
       (SELECT C_TYPE_CUMUL FROM ACJ_SUB_SET_CAT SUB WHERE SUB.C_SUB_SET = 'REC' AND SUB.ACJ_CATALOGUE_DOCUMENT_ID = (SELECT ACJ_CATALOGUE_DOCUMENT_ID FROM ACT_DOCUMENT WHERE ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)) C_TYPE_CUMUL_REC,
       (SELECT C_TYPE_CUMUL FROM ACJ_SUB_SET_CAT SUB WHERE SUB.C_SUB_SET = 'PAY' AND SUB.ACJ_CATALOGUE_DOCUMENT_ID = (SELECT ACJ_CATALOGUE_DOCUMENT_ID FROM ACT_DOCUMENT WHERE ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)) C_TYPE_CUMUL_PAY,
       (SELECT C_TYPE_CATALOGUE FROM ACJ_CATALOGUE_DOCUMENT WHERE ACJ_CATALOGUE_DOCUMENT_ID = (SELECT ACJ_CATALOGUE_DOCUMENT_ID FROM ACT_DOCUMENT WHERE ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID)) C_TYPE_CATALOGUE
from ACT_FINANCIAL_IMPUTATION IMP


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_FIN_IMPUTATION_DATE" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "DOC_DATE_DELIVERY", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACS_DIVISION_ACCOUNT_ID", "PAC_PERSON_ID", "DIV_NUMBER", "FINANCIAL_IMPUTATION_ID") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       nvl(nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID,IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID),IMP.ACS_AUXILIARY_ACCOUNT_ID) AS ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       (select PAR.DOC_DATE_DELIVERY from ACT_PART_IMPUTATION PAR where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       nvl(IMP.IMF_PAC_CUSTOM_PARTNER_ID,IMP.IMF_PAC_SUPPLIER_PARTNER_ID) AS PAC_PERSON_ID,
       (SELECT ACC.ACC_NUMBER FROM ACS_ACCOUNT ACC WHERE ACC.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
  from
       ACT_FINANCIAL_IMPUTATION IMP
 where
       IMP.IMF_TRANSACTION_DATE >= decode(ACT_FUNCTIONS.GetDateFrom, null, IMP.IMF_TRANSACTION_DATE,ACT_FUNCTIONS.GetDateFrom)
   and IMP.IMF_TRANSACTION_DATE <= decode(ACT_FUNCTIONS.GetDateTo  , null, IMP.IMF_TRANSACTION_DATE,ACT_FUNCTIONS.GetDateTo)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_FIN_IMPUT_PART" ("ACS_SUB_SET_ID", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "ACS_FINANCIAL_YEAR_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C") AS
  select SUB.ACS_SUB_SET_ID,
       AUX1.ACS_AUXILIARY_ACCOUNT_ID,
       PERS.PAC_PERSON_ID,
       YEAR.ACS_FINANCIAL_YEAR_ID,
       PER.ACS_PERIOD_ID,
       FAC.ACS_FINANCIAL_ACCOUNT_ID,
       NVL(DIV.ACS_DIVISION_ACCOUNT_ID,0) ACS_DIVISION_ACCOUNT_ID,
       FC.ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
       LC.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
       CAT.ACJ_CATALOGUE_DOCUMENT_ID,
       sum(IMP.IMF_AMOUNT_LC_D)  IMF_AMOUNT_LC_D,
       sum(IMP.IMF_AMOUNT_LC_C)  IMF_AMOUNT_LC_C,
       sum(IMP.IMF_AMOUNT_FC_D)  IMF_AMOUNT_FC_D,
       sum(IMP.IMF_AMOUNT_FC_C)  IMF_AMOUNT_FC_C,
       sum(IMP.IMF_AMOUNT_EUR_D) IMF_AMOUNT_EUR_D,
       sum(IMP.IMF_AMOUNT_EUR_C) IMF_AMOUNT_EUR_C
  from V_ACT_FINANCIAL_IMPUTATION IMP,
       ACT_DOCUMENT DOC,
       PAC_PERSON PERS,
       ACS_ACCOUNT AUX,
       ACS_AUXILIARY_ACCOUNT AUX1,
       ACS_FINANCIAL_ACCOUNT FAC,
       ACJ_CATALOGUE_DOCUMENT CAT,
       ACS_PERIOD PER,
       ACS_DIVISION_ACCOUNT DIV,
       ACS_FINANCIAL_CURRENCY FC,
       ACS_FINANCIAL_CURRENCY LC,
       ACS_SUB_SET SUB,
       ACS_FINANCIAL_YEAR YEAR
  where IMP.ACT_DOCUMENT_ID = DOC.ACT_DOCUMENT_ID
    and IMP.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
    and DOC.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID
    and PER.ACS_FINANCIAL_YEAR_ID = YEAR.ACS_FINANCIAL_YEAR_ID
    and IMP.PAC_PERSON_ID = PERS.PAC_PERSON_ID
    and IMP.ACS_FINANCIAL_CURRENCY_ID = FC.ACS_FINANCIAL_CURRENCY_ID
    and IMP.ACS_ACS_FINANCIAL_CURRENCY_ID = LC.ACS_FINANCIAL_CURRENCY_ID
    and IMP.ACS_FINANCIAL_ACCOUNT_ID = FAC.ACS_FINANCIAL_ACCOUNT_ID
    and IMP.ACS_DIVISION_ACCOUNT_ID = DIV.ACS_DIVISION_ACCOUNT_ID(+)
    and IMP.ACS_AUXILIARY_ACCOUNT_ID = AUX.ACS_ACCOUNT_ID
    and AUX.ACS_SUB_SET_ID = SUB.ACS_SUB_SET_ID
    and AUX1.ACS_AUXILIARY_ACCOUNT_ID = IMP.ACS_AUXILIARY_ACCOUNT_ID
group by SUB.ACS_SUB_SET_ID,
         AUX1.ACS_AUXILIARY_ACCOUNT_ID,
         PERS.PAC_PERSON_ID,
         YEAR.ACS_FINANCIAL_YEAR_ID,
         PER.ACS_PERIOD_ID,
         FAC.ACS_FINANCIAL_ACCOUNT_ID,
         DIV.ACS_DIVISION_ACCOUNT_ID,
         FC.ACS_FINANCIAL_CURRENCY_ID,
         LC.ACS_FINANCIAL_CURRENCY_ID,
         CAT.ACJ_CATALOGUE_DOCUMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_FIN_IMP_CASH_FLOW" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "IMF_NUMBER", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "IMF_ACS_DIVISION_ACCOUNT_ID", "DOC_RECORD_ID", "PAC_PERSON_ID") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.IMF_NUMBER,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       nvl(nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID,IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID),IMP.ACS_AUXILIARY_ACCOUNT_ID) AS ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID,
       IMP.DOC_RECORD_ID,
       nvl(IMP.IMF_PAC_CUSTOM_PARTNER_ID,IMP.IMF_PAC_SUPPLIER_PARTNER_ID) AS PAC_PERSON_ID
  from
       ACT_FINANCIAL_IMPUTATION IMP


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_IMPUTATION_JOU" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "PAC_PERSON_ID", "DIV_NUMBER", "FINANCIAL_IMPUTATION_ID") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       nvl(nvl(IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID, IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID),IMP.ACS_AUXILIARY_ACCOUNT_ID) ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID from ACT_FINANCIAL_DISTRIBUTION DIS where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       nvl(IMP.IMF_PAC_CUSTOM_PARTNER_ID, IMP.IMF_PAC_SUPPLIER_PARTNER_ID) PAC_PERSON_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
  from
       ACT_FINANCIAL_IMPUTATION IMP,
  	   (select JOU.ACT_JOURNAL_ID
  		    from ACT_JOURNAL JOU
  	   	 where JOU.JOU_NUMBER            >= ACR_FUNCTIONS.GetJOU_NUMBER(1)
           and JOU.JOU_NUMBER            <= ACR_FUNCTIONS.GetJOU_NUMBER(0)
           and JOU.ACS_FINANCIAL_YEAR_ID  = ACR_FUNCTIONS.GetFinYearId) JOU
 where IMP.ACT_DOCUMENT_ID in (select DOC.ACT_DOCUMENT_ID
                                 from ACT_DOCUMENT DOC
                                where DOC.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_INTEREST_DETAIL" ("ACT_INTEREST_DETAIL_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACT_JOB_ID", "IDE_VALUE_DATE", "IDE_TRANSACTION_DATE", "IDE_AMOUNT_LC_D", "IDE_AMOUNT_LC_C", "IDE_AMOUNT_FC_D", "IDE_AMOUNT_FC_C", "IDE_BALANCE_AMOUNT", "IDE_INTEREST_RATE_D", "IDE_INTEREST_RATE_C", "IDE_DAYS_NBR_D", "IDE_DAYS_NBR_C", "IDE_NBR_D", "IDE_NBR_C", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_DESCRIPTION", "ACT_PART_IMPUTATION_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "DOC_NUMBER", "CURRENCY", "TRI") AS
  SELECT
   IDE.ACT_INTEREST_DETAIL_ID,
   IDE.ACS_FINANCIAL_ACCOUNT_ID,
   IDE.ACS_DIVISION_ACCOUNT_ID,
   IDE.ACT_FINANCIAL_IMPUTATION_ID,
   IDE.ACT_JOB_ID,
   IDE.IDE_VALUE_DATE,
   NVL(IDE.IDE_TRANSACTION_DATE,IDE_VALUE_DATE) IDE_TRANSACTION_DATE,
   IDE.IDE_AMOUNT_LC_D,
   IDE.IDE_AMOUNT_LC_C,
   IDE.IDE_AMOUNT_FC_D,
   IDE.IDE_AMOUNT_FC_C,
   IDE.IDE_BALANCE_AMOUNT,
   IDE.IDE_INTEREST_RATE_D,
   IDE.IDE_INTEREST_RATE_C,
   IDE.IDE_DAYS_NBR_D,
   IDE.IDE_DAYS_NBR_C,
   IDE.IDE_NBR_D,
   IDE.IDE_NBR_C,
   IDE.A_CONFIRM,
   IDE.A_DATECRE,
   IDE.A_DATEMOD,
   IDE.A_IDCRE,
   IDE.A_IDMOD,
   IDE.A_RECLEVEL,
   IDE.A_RECSTATUS,
   (SELECT IMP.IMF_DESCRIPTION FROM ACT_FINANCIAL_IMPUTATION IMP WHERE IMP.ACT_FINANCIAL_IMPUTATION_ID = IDE.ACT_FINANCIAL_IMPUTATION_ID) IMF_DESCRIPTION,
   (SELECT IMP.ACT_PART_IMPUTATION_ID FROM ACT_FINANCIAL_IMPUTATION IMP WHERE IMP.ACT_FINANCIAL_IMPUTATION_ID = IDE.ACT_FINANCIAL_IMPUTATION_ID) ACT_PART_IMPUTATION_ID,
   NVL((SELECT DIS.ACT_FINANCIAL_DISTRIBUTION_ID FROM ACT_FINANCIAL_DISTRIBUTION DIS WHERE DIS.ACT_FINANCIAL_IMPUTATION_ID = IDE.ACT_FINANCIAL_IMPUTATION_ID), 0) ACT_FINANCIAL_DISTRIBUTION_ID,
   NVL((SELECT DOC.DOC_NUMBER FROM ACT_DOCUMENT DOC WHERE DOC.ACT_DOCUMENT_ID = (SELECT IMP.ACT_DOCUMENT_ID FROM ACT_FINANCIAL_IMPUTATION IMP WHERE IMP.ACT_FINANCIAL_IMPUTATION_ID = IDE.ACT_FINANCIAL_IMPUTATION_ID)),' ') DOC_NUMBER,
   NVL((SELECT CUR.CURRENCY FROM PCS.PC_CURR CUR, ACS_FINANCIAL_CURRENCY AFC WHERE IDE.ACS_FINANCIAL_CURRENCY_ID = AFC.ACS_FINANCIAL_CURRENCY_ID AND AFC.PC_CURR_ID = CUR.PC_CURR_ID),
       (SELECT CUR.CURRENCY FROM PCS.PC_CURR CUR, ACS_FINANCIAL_CURRENCY AFC WHERE AFC.PC_CURR_ID = CUR.PC_CURR_ID AND AFC.FIN_LOCAL_CURRENCY = 1)) CURRENCY,
   0 TRI
FROM
   ACT_INTEREST_DETAIL IDE
UNION ALL
 SELECT
   IMF.ACT_FINANCIAL_IMPUTATION_ID ACT_INTEREST_DETAIL_ID,
   IMF.ACS_FINANCIAL_ACCOUNT_ID ACS_FINANCIAL_ACCOUNT_ID,
   IMF.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
   IMF.ACT_FINANCIAL_IMPUTATION_ID ACT_FINANCIAL_IMPUTATION_ID,
   DOC.ACT_JOB_ID ACT_JOB_ID,
   IMF.IMF_VALUE_DATE IDE_VALUE_DATE,
   IMF.IMF_TRANSACTION_DATE IDE_TRANSACTION_DATE,
   IMF.IMF_AMOUNT_LC_D IDE_AMOUNT_LC_D,
   IMF.IMF_AMOUNT_LC_C IDE_AMOUNT_LC_C,
   IMF.IMF_AMOUNT_FC_D IDE_AMOUNT_FC_D,
   IMF.IMF_AMOUNT_FC_C IDE_AMOUNT_FC_C,
   0 IDE_BALANCE_AMOUNT,
   0 IDE_INTEREST_RATE_D,
   0 IDE_INTEREST_RATE_D,
   0 IDE_DAYS_NBR_D,
   0 IDE_DAYS_NBR_C,
   0 IDE_NBR_D,
   0 IDE_NBR_C,
   IMF.A_CONFIRM,
   IMF.A_DATECRE,
   IMF.A_DATEMOD,
   IMF.A_IDCRE,
   IMF.A_IDMOD,
   IMF.A_RECLEVEL,
   IMF.A_RECSTATUS,
   IMF.IMF_DESCRIPTION,
   IMF.ACT_PART_IMPUTATION_ID,
   NVL((SELECT DIS.ACT_FINANCIAL_DISTRIBUTION_ID FROM ACT_FINANCIAL_DISTRIBUTION DIS WHERE DIS.ACT_FINANCIAL_IMPUTATION_ID = IMF.ACT_FINANCIAL_IMPUTATION_ID), 0) ACT_FINANCIAL_DISTRIBUTION_ID,
   NVL(DOC.DOC_NUMBER,' ') DOC_NUMBER,
   NVL((SELECT CUR.CURRENCY FROM PCS.PC_CURR CUR, ACS_FINANCIAL_CURRENCY AFC WHERE IMF.ACS_FINANCIAL_CURRENCY_ID = AFC.ACS_FINANCIAL_CURRENCY_ID AND AFC.PC_CURR_ID = CUR.PC_CURR_ID),' ') CURRENCY,
   1 TRI
 FROM
   ACT_FINANCIAL_IMPUTATION IMF,
   ACT_DOCUMENT DOC
 WHERE
   DOC.ACT_DOCUMENT_ID = IMF.ACT_DOCUMENT_ID(+) AND
   EXISTS (SELECT 1 FROM ACT_ETAT_EVENT EVE WHERE EVE.C_TYPE_EVENT = '9' AND EVE.ACT_JOB_ID = DOC.ACT_JOB_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_INTEREST_DOCUMENT" ("ACT_JOB_ID", "ACS_INT_CALC_METHOD_ID", "ICM_DESCRIPTION", "C_TYPE_CUMUL", "ACT_CALC_PERIOD_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "FYE_NO_EXERCICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "FIN_NUMBER", "PAC_PERSON_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACT_DOCUMENT_ID", "DOC_NUMBER", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "ACT_FINANCIAL_IMPUTATION_ID", "C_GENRE_TRANSACTION") AS
  SELECT DISTINCT
   JOB.ACT_JOB_ID,
   ICM.ACS_INT_CALC_METHOD_ID,
   ICM.ICM_DESCRIPTION,
   TYP.C_TYPE_CUMUL,
   (SELECT MAX(CAL.ACT_CALC_PERIOD_ID) FROM ACT_CALC_PERIOD CAL
   WHERE CAL.ACT_JOB_ID = JOB.ACT_JOB_ID) ACT_CALC_PERIOD_ID,
   (SELECT MAX(CAL.ACS_PERIOD_ID) FROM ACT_CALC_PERIOD CAL
   WHERE CAL.ACT_JOB_ID = JOB.ACT_JOB_ID) ACS_PERIOD_ID,
   FYE.ACS_FINANCIAL_YEAR_ID,
   FYE.FYE_NO_EXERCICE,
   MEL.ACS_FINANCIAL_ACCOUNT_ID,
   MEL.ACS_FINANCIAL_CURRENCY_ID,
   FIN.ACC_NUMBER FIN_NUMBER,
   FIN.PAC_PERSON_ID,
   IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
   (select ACC.ACC_NUMBER  from ACS_ACCOUNT ACC where ACC.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
   DOC.ACT_DOCUMENT_ID,
   DOC.DOC_NUMBER,
   IMP.IMF_DESCRIPTION,
   IMP.IMF_AMOUNT_LC_D,
   IMP.IMF_AMOUNT_LC_C,
   IMP.ACT_FINANCIAL_IMPUTATION_ID,
   IMP.C_GENRE_TRANSACTION
FROM
   ACT_FINANCIAL_IMPUTATION IMP,
   ACT_DOCUMENT DOC,
   ACS_ACCOUNT FIN,
   ACS_METHOD_ELEM MEL,
   ACT_CALC_PERIOD CAL,
   ACS_FINANCIAL_YEAR FYE,
   ACT_JOB JOB,
   ACS_CALC_CUMUL_TYPE TYP,
   ACS_INT_CALC_METHOD ICM
WHERE
   JOB.ACT_JOB_ID = CAL.ACT_JOB_ID AND
   JOB.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
   CAL.ACS_INT_CALC_METHOD_ID = ICM.ACS_INT_CALC_METHOD_ID AND
   ICM.ACS_INT_CALC_METHOD_ID = MEL.ACS_INT_CALC_METHOD_ID AND
   TYP.ACS_INT_CALC_METHOD_ID = ICM.ACS_INT_CALC_METHOD_ID AND
   MEL.ACS_FINANCIAL_ACCOUNT_ID = FIN.ACS_ACCOUNT_ID AND
   JOB.ACT_JOB_ID = DOC.ACT_JOB_ID AND
   DOC.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID AND
   MEL.ACS_FINANCIAL_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_INTEREST_DOCUMENT_FC" ("ACT_JOB_ID", "ACS_INT_CALC_METHOD_ID", "ICM_DESCRIPTION", "C_TYPE_CUMUL", "ACT_CALC_PERIOD_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "FYE_NO_EXERCICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "FIN_NUMBER", "PAC_PERSON_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACT_DOCUMENT_ID", "DOC_NUMBER", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "ACT_FINANCIAL_IMPUTATION_ID", "C_GENRE_TRANSACTION") AS
  SELECT DISTINCT job.act_job_id, icm.acs_int_calc_method_id,
                   icm.icm_description, typ.c_type_cumul,
                   (SELECT MAX (cal.act_calc_period_id)
                      FROM act_calc_period cal
                     WHERE cal.act_job_id = job.act_job_id)
                                                           act_calc_period_id,
                   (SELECT MAX (cal.acs_period_id)
                      FROM act_calc_period cal
                     WHERE cal.act_job_id = job.act_job_id) acs_period_id,
                   fye.acs_financial_year_id, fye.fye_no_exercice,
                   mel.acs_financial_account_id,
                   mel.acs_financial_currency_id, fin.acc_number fin_number,
                   fin.pac_person_id,
                   imp.imf_acs_division_account_id acs_division_account_id,
                   (SELECT acc.acc_number
                      FROM acs_account acc
                     WHERE acc.acs_account_id =
                                   imp.imf_acs_division_account_id)
                                                                   div_number,
                   doc.act_document_id, doc.doc_number, imp.imf_description,
                   imp.imf_amount_lc_d, imp.imf_amount_lc_c,
                   imp.imf_amount_fc_d, imp.imf_amount_fc_c,
                   imp.act_financial_imputation_id, imp.c_genre_transaction
              FROM act_financial_imputation imp,
                   act_document doc,
                   acs_account fin,
                   acs_method_elem mel,
                   act_calc_period cal,
                   acs_financial_year fye,
                   act_job job,
                   acs_calc_cumul_type typ,
                   acs_int_calc_method icm
             WHERE job.act_job_id = cal.act_job_id
               AND job.acs_financial_year_id = fye.acs_financial_year_id
               AND cal.acs_int_calc_method_id = icm.acs_int_calc_method_id
               AND icm.acs_int_calc_method_id = mel.acs_int_calc_method_id
               AND typ.acs_int_calc_method_id = icm.acs_int_calc_method_id
               AND mel.acs_financial_account_id = fin.acs_account_id
               AND job.act_job_id = doc.act_job_id
               AND doc.act_document_id = imp.act_document_id
               AND mel.acs_financial_account_id = imp.acs_financial_account_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_JOURNAL" ("ACT_JOURNAL_ID", "PC_USER_ID", "JOU_DESCRIPTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "C_TYPE_JOURNAL", "ACS_ACCOUNTING_ID", "ACT_JOB_ID", "JOU_NUMBER", "ACS_FINANCIAL_YEAR_ID", "ACT_ETAT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_SUB_SET", "C_JOB_STATE", "JOB_DESCRIPTION", "ACJ_JOB_TYPE_ID") AS
  SELECT
	ACT_JOURNAL.ACT_JOURNAL_ID,
	ACT_JOURNAL.PC_USER_ID,
	ACT_JOURNAL.JOU_DESCRIPTION,
	ACT_JOURNAL.A_CONFIRM,
	ACT_JOURNAL.A_DATECRE,
	ACT_JOURNAL.A_DATEMOD,
	ACT_JOURNAL.A_IDCRE,
	ACT_JOURNAL.A_IDMOD,
	ACT_JOURNAL.A_RECLEVEL,
	ACT_JOURNAL.A_RECSTATUS,
	ACT_JOURNAL.C_TYPE_JOURNAL,
	ACT_JOURNAL.ACS_ACCOUNTING_ID,
	ACT_JOURNAL.ACT_JOB_ID,
	ACT_JOURNAL.JOU_NUMBER,
	ACT_JOURNAL.ACS_FINANCIAL_YEAR_ID,
	ACT_ETAT_JOURNAL.ACT_ETAT_JOURNAL_ID,
	ACT_ETAT_JOURNAL.C_ETAT_JOURNAL,
	ACT_ETAT_JOURNAL.C_SUB_SET,
	ACT_JOB.C_JOB_STATE,
	ACT_JOB.JOB_DESCRIPTION,
	ACT_JOB.ACJ_JOB_TYPE_ID
FROM
	ACT_JOURNAL,
	ACT_ETAT_JOURNAL,
	ACT_JOB
WHERE
	ACT_JOURNAL.ACT_JOURNAL_ID = ACT_ETAT_JOURNAL.ACT_JOURNAL_ID (+) AND
        ACT_JOURNAL.ACT_JOB_ID = ACT_JOB.ACT_JOB_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_JOURNAL_COND" ("ACS_ACCOUNTING_ID", "ACT_JOURNAL_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "ACS_PERIOD_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_TAX_CODE_ID", "IMF_AMOUNT_LC_D_SUM", "IMF_AMOUNT_LC_C_SUM", "IMF_AMOUNT_FC_D_SUM", "IMF_AMOUNT_FC_C_SUM", "IMF_AMOUNT_EUR_D_SUM", "IMF_AMOUNT_EUR_C_SUM") AS
  select (select ACS_ACCOUNTING_ID from ACT_JOURNAL where ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) ACS_ACCOUNTING_ID,
       DOC.ACT_JOURNAL_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       IMP.ACS_PERIOD_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       IMP.ACS_TAX_CODE_ID,
       SUM(IMP.IMF_AMOUNT_LC_D)    IMF_AMOUNT_LC_D_SUM,
       SUM(IMP.IMF_AMOUNT_LC_C)    IMF_AMOUNT_LC_C_SUM,
       SUM(IMP.IMF_AMOUNT_FC_D)    IMF_AMOUNT_FC_D_SUM,
       SUM(IMP.IMF_AMOUNT_FC_C)    IMF_AMOUNT_FC_C_SUM,
       SUM(IMP.IMF_AMOUNT_EUR_D)   IMF_AMOUNT_EUR_D_SUM,
       SUM(IMP.IMF_AMOUNT_EUR_C)   IMF_AMOUNT_EUR_C_SUM
  from ACT_FINANCIAL_IMPUTATION IMP,
       ACT_DOCUMENT DOC
 where exists (select 1
                 from ACT_JOURNAL JOU
                where JOU.JOU_NUMBER           >= ACR_FUNCTIONS.GetJOU_NUMBER(1)
                  and JOU.JOU_NUMBER           <= ACR_FUNCTIONS.GetJOU_NUMBER(0)
                  and JOU.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
                  and JOU.ACS_ACCOUNTING_ID     = (select ACS_ACCOUNTING_ID from ACS_ACCOUNTING where C_TYPE_ACCOUNTING = 'FIN')
                  and JOU.ACT_JOURNAL_ID        = DOC.ACT_JOURNAL_ID)
   and IMP.ACT_DOCUMENT_ID               = DOC.ACT_DOCUMENT_ID
 group by
       DOC.ACT_JOURNAL_ID,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       IMP.ACS_PERIOD_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID,
       IMP.ACS_TAX_CODE_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_JOU_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID") AS
  select IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.ACS_FINANCIAL_ACCOUNT_ID) ACC_NUMBER,
       (select DIS.ACT_FINANCIAL_DISTRIBUTION_ID from ACT_FINANCIAL_DISTRIBUTION DIS where DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (select ACC_NUMBER from ACS_ACCOUNT where ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       DOC.DOC_NUMBER,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       JOU.ACT_JOURNAL_ID,
       JOU.JOU_NUMBER,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID
  from ACT_FINANCIAL_IMPUTATION IMP,
       ACT_DOCUMENT DOC,
       ACT_JOURNAL JOU
  where JOU.JOU_NUMBER            >= ACR_FUNCTIONS.GetJOU_NUMBER(1)
    and JOU.JOU_NUMBER            <= ACR_FUNCTIONS.GetJOU_NUMBER(0)
    and JOU.ACS_FINANCIAL_YEAR_ID  = ACR_FUNCTIONS.GetFinYearId
    and JOU.ACT_JOURNAL_ID         = DOC.ACT_JOURNAL_ID
    and DOC.ACT_DOCUMENT_ID        = IMP.ACT_DOCUMENT_ID
    and exists (select 1 from ACS_PERIOD PER where PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId and PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_MGM_TOT_BY_YEAR" ("ACS_FINANCIAL_YEAR_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "C_TYPE_CUMUL", "ACS_QTY_UNIT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "MTO_DEBIT_LC", "MRO_CREDIT_LC", "MTO_DEBIT_FC", "MTO_CREDIT_FC", "MTO_QUANTITY_D", "MTO_QUANTITY_C", "MTO_DEBIT_EUR", "MTO_CREDIT_EUR") AS
  select
  PER.ACS_FINANCIAL_YEAR_ID,
  TOT.ACS_FINANCIAL_CURRENCY_ID,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
  TOT.ACS_CPN_ACCOUNT_ID,
  TOT.ACS_CDA_ACCOUNT_ID,
  TOT.ACS_PJ_ACCOUNT_ID,
  TOT.ACS_PF_ACCOUNT_ID,
  TOT.C_TYPE_CUMUL,
  TOT.ACS_QTY_UNIT_ID,
  TOT.ACS_FINANCIAL_ACCOUNT_ID,
  sum(TOT.MTO_DEBIT_LC) MTO_DEBIT_LC,
  sum(TOT.MTO_CREDIT_LC) MTO_CREDIT_LC,
  sum(TOT.MTO_DEBIT_FC) MTO_DEBIT_FC,
  sum(TOT.MTO_CREDIT_FC)MTO_CREDIT_FC,
  sum(TOT.MTO_QUANTITY_D)MTO_QUANTITY_D,
  sum(TOT.MTO_QUANTITY_C)MTO_QUANTITY_C,
  sum(TOT.MTO_DEBIT_EUR)MTO_DEBIT_EUR,
  sum(TOT.MTO_CREDIT_EUR)MTO_CREDIT_EUR
from
  ACT_MGM_TOT_BY_PERIOD TOT,
  ACS_PERIOD PER
where
  TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
group by
  PER.ACS_FINANCIAL_YEAR_ID,
  TOT.ACS_FINANCIAL_CURRENCY_ID,
  TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
  TOT.ACS_CPN_ACCOUNT_ID,
  TOT.ACS_CDA_ACCOUNT_ID,
  TOT.ACS_PJ_ACCOUNT_ID,
  TOT.ACS_PF_ACCOUNT_ID,
  TOT.C_TYPE_CUMUL,
  TOT.ACS_QTY_UNIT_ID,
  TOT.ACS_FINANCIAL_ACCOUNT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PAY_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACC_NUMBER", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_TYPE_PERIOD", "MATCHING") AS
  select
       IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       (SELECT DIS.ACT_FINANCIAL_DISTRIBUTION_ID FROM ACT_FINANCIAL_DISTRIBUTION DIS WHERE DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       AUX.ACC_NUMBER,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       IMP.IMF_PAC_SUPPLIER_PARTNER_ID PAC_PERSON_ID,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_JOURNAL_ID,
       (SELECT JOU.JOU_NUMBER FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER,
       (SELECT JOU.JOU_DESCRIPTION FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION,
       (select COV.COV_NUMBER
        from ACT_COVER_INFORMATION COV
        where COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID) COV_NUMBER,
       (select PAR.PAR_DOCUMENT
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID)DOC_DATE_DELIVERY,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select ETA.C_ETAT_JOURNAL
        from ACT_ETAT_JOURNAL ETA
        where ETA.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
          and ETA.C_SUB_SET      = 'PAY') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID   = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                   = 'PAY') C_TYPE_CUMUL,
       AUX.ACS_SUB_SET_ID,
       PER.C_TYPE_PERIOD,
       ACR_FUNCTIONS.IsDocumentMatching (IMP.ACT_PART_IMPUTATION_ID) MATCHING
  from
       ACS_FINANCIAL_ACCOUNT      FIN,
       ACT_DOCUMENT               DOC,
       ACS_PERIOD                 PER,
       ACT_FINANCIAL_IMPUTATION   IMP,
       ACS_ACCOUNT                AUX,
       ACS_SUB_SET                SUB
  where
        SUB.C_SUB_SET                   = 'PAY'
    and SUB.ACS_SUB_SET_ID              = AUX.ACS_SUB_SET_ID
    and AUX.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
    and AUX.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
    and AUX.ACS_ACCOUNT_ID              = IMP.ACS_AUXILIARY_ACCOUNT_ID
    and IMP.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and IMP.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID (+)
    and IMP.ACS_FINANCIAL_ACCOUNT_ID    = FIN.ACS_FINANCIAL_ACCOUNT_ID
    and FIN.FIN_COLLECTIVE              = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PAY_IMP_REPORT" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "MATCHING") AS
  select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       IMP_PAC_PERSON_ID,
       MATCHING
  from V_ACT_PAY_IMPUTATION
      where C_TYPE_PERIOD <> '1'
union all
select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       IMP_PAC_PERSON_ID,
       MATCHING
  from V_ACT_PAY_IMPUTATION
    where C_TYPE_PERIOD = '1'
    and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_FINANCIAL_IMPUTATION_ID,
       TOT.ACS_PERIOD_ID,
       0 ACT_DOCUMENT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       'MAN' IMF_TYPE,
       0 IMF_PRIMARY,
       'Report' IMF_DESCRIPTION,
       TOT.TOT_DEBIT_LC  IMF_AMOUNT_LC_D,
       TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C,
       0 IMF_EXCHANGE_RATE,
       TOT.TOT_DEBIT_FC   IMF_AMOUNT_FC_D,
       TOT.TOT_CREDIT_FC  IMF_AMOUNT_FC_C,
       TOT.TOT_DEBIT_EUR  IMF_AMOUNT_EUR_D,
       TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C,
       TOT.PER_START_DATE IMF_VALUE_DATE,
       0 ACS_TAX_CODE_ID,
       TOT.PER_START_DATE IMF_TRANSACTION_DATE,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
       '1' C_GENRE_TRANSACTION,
       TOT.ACS_AUXILIARY_ACCOUNT_ID,
       0 ACT_DET_PAYMENT_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
       0 IMF_BASE_PRICE,
       0 ACT_PART_IMPUTATION_ID,
       TOT.ACC_NUMBER,
       0 ACT_FINANCIAL_DISTRIBUTION_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       (SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = TOT.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       0 FINANCIAL_IMPUTATION_ID,
       0 ACT_ACT_JOURNAL_ID,
       'PROV' C_ETAT_JOURNAL,
       TOT.C_TYPE_CUMUL,
       '' COV_NUMBER,
       null PAR_DOCUMENT,
       TO_DATE(null) DOC_DATE_DELIVERY,
       '' IMF_TEXT1,
       '' IMF_TEXT2,
       '' IMF_TEXT3,
       '' IMF_TEXT4,
       '' IMF_TEXT5,
       0 IMF_NUMBER,
       0 IMF_NUMBER2,
       0 IMF_NUMBER3,
       0 IMF_NUMBER4,
       0 IMF_NUMBER5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_IMP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 GCO_GOOD_ID,
       0 HRM_PERSON_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 IMP_PAC_PERSON_ID,
       0 MATCHING
  from
       V_ACT_PAY_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PAY_PREV_YEAR_TOTAL" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE") AS
  select   TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_DEBIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_CREDIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_DEBIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_CREDIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_DEBIT_EUR
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_CREDIT_EUR
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
      from ACS_ACCOUNT ACC
         , ACT_TOTAL_BY_PERIOD TOT
         , ACS_PERIOD PER
     where ACC.ACC_NUMBER >= ACR_FUNCTIONS.GetAccNumber(1)
       and ACC.ACC_NUMBER <= ACR_FUNCTIONS.GetAccNumber(0)
       and exists(select 1
                    from ACS_SUB_SET SUB
                   where SUB.C_SUB_SET = 'PAY'
                     and SUB.ACS_SUB_SET_ID = ACC.ACS_SUB_SET_ID)
       and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.C_TYPE_PERIOD = '1'
       and TOT.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
       and (    (TOT.ACS_DIVISION_ACCOUNT_ID is not null)
            or (    TOT.ACS_DIVISION_ACCOUNT_ID is null
                and ACR_FUNCTIONS.ExistDivision = 0)
           )
  group by TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PERIOD_BALANCE_COLL" ("ACS_FINANCIAL_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS2_PERIOD_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "ACJ2_CATALOGUE_DOCUMENT_ID", "ACS_FINANCIAL_CURRENCY_ID", "NUMBER_OF_DOCUMENT", "AMOUNT_LC_D", "AMOUNT_LC_C", "AMOUNT_FC_D", "AMOUNT_FC_C", "AMOUNT_EUR_D", "AMOUNT_EUR_C") AS
  select
		acs_financial_account_id,
		acs_period_id,
		acs2_period_id,
		acj_catalogue_document_id,
		acj2_catalogue_document_id,
		acs_financial_currency_id,
		sum(number_of_document) number_of_document,
                nvl(sum(imf_amount_lc_d),0)  amount_lc_d,
                nvl(sum(imf_amount_lc_c),0)  amount_lc_c,
                nvl(sum(imf_amount_fc_d),0)  amount_fc_d,
                nvl(sum(imf_amount_fc_c),0)  amount_fc_c,
                nvl(sum(imf_amount_eur_d),0) amount_eur_d,
                nvl(sum(imf_amount_eur_c),0) amount_eur_c
from
		act_period_balance_coll
group by
		acs_financial_account_id,
		acs_period_id,
		acs2_period_id,
		acj_catalogue_document_id,
		acj2_catalogue_document_id,
		acs_financial_currency_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PF_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_PF_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD") AS
  select
       MGM.ACT_MGM_IMPUTATION_ID,
       MGM.ACT_FINANCIAL_IMPUTATION_ID,
       MGM.ACS_PERIOD_ID,
       MGM.IMM_VALUE_DATE,
       MGM.IMM_TRANSACTION_DATE,
       MGM.IMM_TYPE,
       MGM.IMM_GENRE,
       MGM.IMM_PRIMARY,
       MGM.IMM_DESCRIPTION,
       MGM.ACS_PF_ACCOUNT_ID,
       MGM.ACS_CPN_ACCOUNT_ID,
       MGM.ACS_CDA_ACCOUNT_ID,
       DIS.ACS_PJ_ACCOUNT_ID,
       MGM.ACS_QTY_UNIT_ID,
       nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D,
       nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C,
       nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D,
       nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C,
       nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D,
       nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_D, MGM.IMM_AMOUNT_EUR_D), 0) IMM_AMOUNT_EUR_D,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_C, MGM.IMM_AMOUNT_EUR_C), 0) IMM_AMOUNT_EUR_C,
       MGM.ACS_FINANCIAL_CURRENCY_ID,
       MGM.ACS_ACS_FINANCIAL_CURRENCY_ID,
       MGM.IMM_EXCHANGE_RATE,
       MGM.IMM_BASE_PRICE,
       MGM.ACT_DOCUMENT_ID,
       MGM.IMM_NUMBER,
       MGM.IMM_NUMBER2,
       MGM.IMM_NUMBER3,
       MGM.IMM_NUMBER4,
       MGM.IMM_NUMBER5,
       MGM.IMM_TEXT1,
       MGM.IMM_TEXT2,
       MGM.IMM_TEXT3,
       MGM.IMM_TEXT4,
       MGM.IMM_TEXT5,
       MGM.DIC_IMP_FREE1_ID,
       MGM.DIC_IMP_FREE2_ID,
       MGM.DIC_IMP_FREE3_ID,
       MGM.DIC_IMP_FREE4_ID,
       MGM.DIC_IMP_FREE5_ID,
       MGM.HRM_PERSON_ID,
       MGM.GCO_GOOD_ID,
       MGM.DOC_RECORD_ID,
       MGM.FAM_FIXED_ASSETS_ID,
       MGM.C_FAM_TRANSACTION_TYP,
       MGM.PAC_PERSON_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       PF.ACC_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       JOU.ACT_JOURNAL_ID,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       (select ETA.C_ETAT_JOURNAL
        from ACT_ETAT_JOURNAL ETA
        where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
          and ETA.C_SUB_SET      = 'CPN') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                 = 'CPN') C_TYPE_CUMUL,
       PER.C_TYPE_PERIOD
  from
       ACT_JOURNAL              JOU,
       ACT_DOCUMENT             DOC,
       ACS_PERIOD               PER,
       ACT_MGM_IMPUTATION       MGM,
       ACT_MGM_DISTRIBUTION     DIS,
       ACT_FINANCIAL_IMPUTATION IMP,
       ACS_ACCOUNT              PF
  where
        PF.ACC_NUMBER                  >= ACR_FUNCTIONS.GetAccNumber(1)
    and PF.ACC_NUMBER                  <= ACR_FUNCTIONS.GetAccNumber(0)
    and PF.ACS_ACCOUNT_ID               = MGM.ACS_PF_ACCOUNT_ID
    and MGM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID (+)
    and MGM.ACT_MGM_IMPUTATION_ID       = DIS.ACT_MGM_IMPUTATION_ID (+)
    and MGM.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and MGM.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID
    and DOC.ACT_ACT_JOURNAL_ID          = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PF_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACS_PF_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "ACT_DOCUMENT_ID", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select ACT_MGM_IMPUTATION_ID,
         ACT_FINANCIAL_IMPUTATION_ID,
         ACS_PERIOD_ID,
         IMM_VALUE_DATE,
         IMM_TRANSACTION_DATE,
         IMM_TYPE,
         IMM_GENRE,
         IMM_PRIMARY,
         IMM_DESCRIPTION,
         ACS_PF_ACCOUNT_ID,
         ACS_CPN_ACCOUNT_ID,
         ACS_CDA_ACCOUNT_ID,
         ACS_PJ_ACCOUNT_ID,
         ACS_QTY_UNIT_ID,
         IMM_QUANTITY_D,
         IMM_QUANTITY_C,
         IMM_AMOUNT_LC_D,
         IMM_AMOUNT_LC_C,
         IMM_AMOUNT_FC_D,
         IMM_AMOUNT_FC_C,
         IMM_AMOUNT_EUR_D,
         IMM_AMOUNT_EUR_C,
         ACS_FINANCIAL_CURRENCY_ID,
         ACS_ACS_FINANCIAL_CURRENCY_ID,
         IMM_EXCHANGE_RATE,
         IMM_BASE_PRICE,
         ACS_FINANCIAL_ACCOUNT_ID,
         ACC_NUMBER,
         IMM_NUMBER,
         IMM_NUMBER2,
         IMM_NUMBER3,
         IMM_NUMBER4,
         IMM_NUMBER5,
         IMM_TEXT1,
         IMM_TEXT2,
         IMM_TEXT3,
         IMM_TEXT4,
         IMM_TEXT5,
         ACT_DOCUMENT_ID,
         DIC_IMP_FREE1_ID,
         DIC_IMP_FREE2_ID,
         DIC_IMP_FREE3_ID,
         DIC_IMP_FREE4_ID,
         DIC_IMP_FREE5_ID,
         HRM_PERSON_ID,
         GCO_GOOD_ID,
         DOC_RECORD_ID,
         FAM_FIXED_ASSETS_ID,
         C_FAM_TRANSACTION_TYP,
         PAC_PERSON_ID,
         DOC_NUMBER,
         DOC_COMMENT,
         ACJ_CATALOGUE_DOCUMENT_ID,
         ACT_ACT_JOURNAL_ID,
         ACT_JOURNAL_ID,
         JOU_NUMBER,
         JOU_DESCRIPTION,
         C_ETAT_JOURNAL,
         C_TYPE_CUMUL
  from  V_ACT_PF_IMPUTATIONS
  where C_TYPE_PERIOD <> '1'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PF_PREV_YEAR_TOTAL" ("ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select
       PER.ACS_PERIOD_ID,
       PER.PER_START_DATE IMM_VALUE_DATE,
       PER.PER_START_DATE IMM_TRANSACTION_DATE,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_PF_ACCOUNT_ID,
       TOT.ACS_CPN_ACCOUNT_ID,
       TOT.ACS_CDA_ACCOUNT_ID,
       TOT.ACS_PJ_ACCOUNT_ID,
       TOT.ACS_QTY_UNIT_ID,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)), -1, 0,  nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) IMM_QUANTITY_D,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)),  1, 0, -nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) IMM_QUANTITY_C,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) IMM_AMOUNT_LC_D,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) IMM_AMOUNT_LC_C,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) IMM_AMOUNT_FC_D,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) IMM_AMOUNT_FC_C,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)), -1, 0,  nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) IMM_AMOUNT_EUR_D,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)),  1, 0, -nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) IMM_AMOUNT_EUR_C,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL
  from
       ACT_MGM_TOT_BY_PERIOD TOT,
       ACS_ACCOUNT ACC,
       ACS_PF_ACCOUNT PF,
       ACS_PERIOD PER
  where
        ACC.ACC_NUMBER            >= ACR_FUNCTIONS.GetAccNumber(1)
    and ACC.ACC_NUMBER            <= ACR_FUNCTIONS.GetAccNumber(0)
    and ACC.ACS_ACCOUNT_ID         = PF.ACS_PF_ACCOUNT_ID
    and PF.ACS_PF_ACCOUNT_ID       = TOT.ACS_PF_ACCOUNT_ID
    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_PERIOD_ID         = TOT.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
    and PER.C_TYPE_PERIOD         = '1'
  group by
        TOT.ACS_FINANCIAL_ACCOUNT_ID,
        TOT.ACS_PF_ACCOUNT_ID,
        TOT.ACS_CPN_ACCOUNT_ID,
        TOT.ACS_CDA_ACCOUNT_ID,
        TOT.ACS_PJ_ACCOUNT_ID,
        TOT.ACS_QTY_UNIT_ID,
        ACS_ACS_FINANCIAL_CURRENCY_ID,
        ACS_FINANCIAL_CURRENCY_ID,
        C_TYPE_CUMUL,
        PER.ACS_PERIOD_ID,
        PER.PER_START_DATE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PJ_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACT_MGM_DISTRIBUTION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "MGM_DESCRIPTION", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "MGM_AMOUNT_EUR_D", "MGM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "MGM_NUMBER", "MGM_NUMBER2", "MGM_TEXT1", "MGM_TEXT2", "MGM_TEXT3", "MGM_TEXT4", "MGM_TEXT5", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_TYPE_PERIOD") AS
  select
       MGM.ACT_MGM_IMPUTATION_ID,
       MGM.ACT_FINANCIAL_IMPUTATION_ID,
       DIS.ACT_MGM_DISTRIBUTION_ID,
       MGM.ACS_PERIOD_ID,
       MGM.IMM_VALUE_DATE,
       MGM.IMM_TRANSACTION_DATE,
       MGM.IMM_TYPE,
       MGM.IMM_GENRE,
       MGM.IMM_PRIMARY,
       DIS.MGM_DESCRIPTION,
       DIS.ACS_PJ_ACCOUNT_ID,
       MGM.ACS_CPN_ACCOUNT_ID,
       MGM.ACS_CDA_ACCOUNT_ID,
       MGM.ACS_PF_ACCOUNT_ID,
       MGM.ACS_QTY_UNIT_ID,
       nvl(DIS.MGM_QUANTITY_D,   0) MGM_QUANTITY_D,
       nvl(DIS.MGM_QUANTITY_C,   0) MGM_QUANTITY_C,
       nvl(DIS.MGM_AMOUNT_LC_D,  0) MGM_AMOUNT_LC_D,
       nvl(DIS.MGM_AMOUNT_LC_C,  0) MGM_AMOUNT_LC_C,
       nvl(DIS.MGM_AMOUNT_FC_D,  0) MGM_AMOUNT_FC_D,
       nvl(DIS.MGM_AMOUNT_FC_C,  0) MGM_AMOUNT_FC_C,
       nvl(DIS.MGM_AMOUNT_EUR_D, 0) MGM_AMOUNT_EUR_D,
       nvl(DIS.MGM_AMOUNT_EUR_C, 0) MGM_AMOUNT_EUR_C,
       MGM.ACS_FINANCIAL_CURRENCY_ID,
       MGM.ACS_ACS_FINANCIAL_CURRENCY_ID,
       MGM.IMM_EXCHANGE_RATE,
       MGM.IMM_BASE_PRICE,
       DIS.MGM_NUMBER,
       DIS.MGM_NUMBER2,
       DIS.MGM_TEXT1,
       DIS.MGM_TEXT2,
       DIS.MGM_TEXT3,
       DIS.MGM_TEXT4,
       DIS.MGM_TEXT5,
       MGM.ACT_DOCUMENT_ID,
       MGM.IMM_NUMBER,
       MGM.IMM_NUMBER2,
       MGM.IMM_NUMBER3,
       MGM.IMM_NUMBER4,
       MGM.IMM_NUMBER5,
       MGM.IMM_TEXT1,
       MGM.IMM_TEXT2,
       MGM.IMM_TEXT3,
       MGM.IMM_TEXT4,
       MGM.IMM_TEXT5,
       MGM.DIC_IMP_FREE1_ID,
       MGM.DIC_IMP_FREE2_ID,
       MGM.DIC_IMP_FREE3_ID,
       MGM.DIC_IMP_FREE4_ID,
       MGM.DIC_IMP_FREE5_ID,
       MGM.HRM_PERSON_ID,
       MGM.GCO_GOOD_ID,
       MGM.DOC_RECORD_ID,
       MGM.FAM_FIXED_ASSETS_ID,
       MGM.C_FAM_TRANSACTION_TYP,
       MGM.PAC_PERSON_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       PJ.ACC_NUMBER,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       JOU.ACT_JOURNAL_ID,
       JOU.JOU_NUMBER,
       JOU.JOU_DESCRIPTION,
       (select ETA.C_ETAT_JOURNAL
	    from ACT_ETAT_JOURNAL  ETA
		where ETA.ACT_JOURNAL_ID = JOU.ACT_JOURNAL_ID
          and ETA.C_SUB_SET      = 'CPN') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
	    from ACJ_SUB_SET_CAT SCA
		where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                 = 'CPN') C_TYPE_CUMUL,
       DIS.ACS_SUB_SET_ID,
       PER.C_TYPE_PERIOD
  from
       ACT_JOURNAL              JOU,
       ACT_DOCUMENT             DOC,
       ACS_PERIOD               PER,
       ACT_MGM_IMPUTATION       MGM,
       ACT_FINANCIAL_IMPUTATION IMP,
       ACT_MGM_DISTRIBUTION     DIS,
       ACS_ACCOUNT              PJ
  where
        PJ.ACC_NUMBER                  >= ACR_FUNCTIONS.GetAccNumber(1)
    and PJ.ACC_NUMBER                  <= ACR_FUNCTIONS.GetAccNumber(0)
    and MGM.ACT_MGM_IMPUTATION_ID       = DIS.ACT_MGM_IMPUTATION_ID
    and DIS.ACS_PJ_ACCOUNT_ID           = PJ.ACS_ACCOUNT_ID
    and MGM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID (+)
    and MGM.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and MGM.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID
    and NVL(DOC.ACT_ACT_JOURNAL_ID,DOC.ACT_JOURNAL_ID) = JOU.ACT_JOURNAL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PJ_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACT_MGM_DISTRIBUTION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "MGM_DESCRIPTION", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "MGM_AMOUNT_EUR_D", "MGM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "MGM_NUMBER", "MGM_NUMBER2", "MGM_TEXT1", "MGM_TEXT2", "MGM_TEXT3", "MGM_TEXT4", "MGM_TEXT5", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID") AS
  select
       ACT_MGM_IMPUTATION_ID,
       ACT_FINANCIAL_IMPUTATION_ID,
       ACT_MGM_DISTRIBUTION_ID,
       ACS_PERIOD_ID,
       IMM_VALUE_DATE,
       IMM_TRANSACTION_DATE,
       IMM_TYPE,
       IMM_GENRE,
       IMM_PRIMARY,
       MGM_DESCRIPTION,
       ACS_PJ_ACCOUNT_ID,
       ACS_CPN_ACCOUNT_ID,
       ACS_CDA_ACCOUNT_ID,
       ACS_PF_ACCOUNT_ID,
       ACS_QTY_UNIT_ID,
       MGM_QUANTITY_D,
       MGM_QUANTITY_C,
       MGM_AMOUNT_LC_D,
       MGM_AMOUNT_LC_C,
       MGM_AMOUNT_FC_D,
       MGM_AMOUNT_FC_C,
       MGM_AMOUNT_EUR_D,
       MGM_AMOUNT_EUR_C,
       ACS_FINANCIAL_CURRENCY_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMM_EXCHANGE_RATE,
       IMM_BASE_PRICE,
       ACS_FINANCIAL_ACCOUNT_ID,
       ACC_NUMBER,
       MGM_NUMBER,
       MGM_NUMBER2,
       MGM_TEXT1,
       MGM_TEXT2,
       MGM_TEXT3,
       MGM_TEXT4,
       MGM_TEXT5,
       ACT_DOCUMENT_ID,
       IMM_NUMBER,
       IMM_NUMBER2,
       IMM_NUMBER3,
       IMM_NUMBER4,
       IMM_NUMBER5,
       IMM_TEXT1,
       IMM_TEXT2,
       IMM_TEXT3,
       IMM_TEXT4,
       IMM_TEXT5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       HRM_PERSON_ID,
       GCO_GOOD_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_ACT_JOURNAL_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       ACS_SUB_SET_ID
  from
       V_ACT_PJ_IMPUTATIONS
  where
       C_TYPE_PERIOD <> '1'
union all
select
       ACT_MGM_IMPUTATION_ID,
       ACT_FINANCIAL_IMPUTATION_ID,
       ACT_MGM_DISTRIBUTION_ID,
       ACS_PERIOD_ID,
       IMM_VALUE_DATE,
       IMM_TRANSACTION_DATE,
       IMM_TYPE,
       IMM_GENRE,
       IMM_PRIMARY,
       MGM_DESCRIPTION,
       ACS_PJ_ACCOUNT_ID,
       ACS_CPN_ACCOUNT_ID,
       ACS_CDA_ACCOUNT_ID,
       ACS_PF_ACCOUNT_ID,
       ACS_QTY_UNIT_ID,
       MGM_QUANTITY_D,
       MGM_QUANTITY_C,
       MGM_AMOUNT_LC_D,
       MGM_AMOUNT_LC_C,
       MGM_AMOUNT_FC_D,
       MGM_AMOUNT_FC_C,
       MGM_AMOUNT_EUR_D,
       MGM_AMOUNT_EUR_C,
       ACS_FINANCIAL_CURRENCY_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMM_EXCHANGE_RATE,
       IMM_BASE_PRICE,
       ACS_FINANCIAL_ACCOUNT_ID,
       ACC_NUMBER,
       MGM_NUMBER,
       MGM_NUMBER2,
       MGM_TEXT1,
       MGM_TEXT2,
       MGM_TEXT3,
       MGM_TEXT4,
       MGM_TEXT5,
       ACT_DOCUMENT_ID,
       IMM_NUMBER,
       IMM_NUMBER2,
       IMM_NUMBER3,
       IMM_NUMBER4,
       IMM_NUMBER5,
       IMM_TEXT1,
       IMM_TEXT2,
       IMM_TEXT3,
       IMM_TEXT4,
       IMM_TEXT5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       HRM_PERSON_ID,
       GCO_GOOD_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       PAC_PERSON_ID,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_ACT_JOURNAL_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       ACS_SUB_SET_ID
  from
       V_ACT_PJ_IMPUTATIONS
  where
       C_TYPE_PERIOD = '1'
       and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_MGM_IMPUTATION_ID,
       0 ACT_FINANCIAL_IMPUTATION_ID,
       0 ACT_MGM_DISTRIBUTION_ID,
       TOT.ACS_PERIOD_ID,
       TOT.IMM_VALUE_DATE,
       TOT.IMM_TRANSACTION_DATE,
       'MAN' IMM_TYPE,
       'MAN' IMM_GENRE,
       0 IMM_PRIMARY,
       'Report' MGM_DESCRIPTION,
       TOT.ACS_PJ_ACCOUNT_ID,
       TOT.ACS_CPN_ACCOUNT_ID,
       TOT.ACS_CDA_ACCOUNT_ID,
       TOT.ACS_PF_ACCOUNT_ID,
       TOT.ACS_QTY_UNIT_ID,
       TOT.MGM_QUANTITY_D,
       TOT.MGM_QUANTITY_C,
       TOT.MGM_AMOUNT_LC_D,
       TOT.MGM_AMOUNT_LC_C,
       TOT.MGM_AMOUNT_FC_D,
       TOT.MGM_AMOUNT_FC_C,
       TOT.MGM_AMOUNT_EUR_D,
       TOT.MGM_AMOUNT_EUR_C,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       0 IMM_EXCHANGE_RATE,
       0 IMM_BASE_PRICE,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       '' ACC_NUMBER,
       0 MGM_NUMBER,
       0 MGM_NUMBER2,
       '' MGM_TEXT1,
       '' MGM_TEXT2,
       '' MGM_TEXT3,
       '' MGM_TEXT4,
       '' MGM_TEXT5,
       0 ACT_DOCUMENT_ID,
       0 IMM_NUMBER,
       0 IMM_NUMBER2,
       0 IMM_NUMBER3,
       0 IMM_NUMBER4,
       0 IMM_NUMBER5,
       '' IMM_TEXT1,
       '' IMM_TEXT2,
       '' IMM_TEXT3,
       '' IMM_TEXT4,
       '' IMM_TEXT5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_IMP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 HRM_PERSON_ID,
       0 GCO_GOOD_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 PAC_PERSON_ID,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_ACT_JOURNAL_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       '' JOU_DESCRIPTION,
       'PROV' C_ETAT_JOURNAL,
       TOT.C_TYPE_CUMUL,
       0 ACS_SUB_SET_ID
  from
       V_ACT_PJ_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_PJ_PREV_YEAR_TOTAL" ("ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "MGM_AMOUNT_EUR_D", "MGM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL") AS
  select
       PER.ACS_PERIOD_ID,
       PER.PER_START_DATE IMM_VALUE_DATE,
       PER.PER_START_DATE IMM_TRANSACTION_DATE,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       TOT.ACS_PJ_ACCOUNT_ID,
       TOT.ACS_CPN_ACCOUNT_ID,
       TOT.ACS_CDA_ACCOUNT_ID,
       TOT.ACS_PF_ACCOUNT_ID,
       TOT.ACS_QTY_UNIT_ID,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)), -1, 0,  nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) MGM_QUANTITY_D,
       decode(sign(nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)),  1, 0, -nvl(sum(MTO_QUANTITY_D - MTO_QUANTITY_C), 0)) MGM_QUANTITY_C,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) MGM_AMOUNT_LC_D,
       decode(sign(nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_LC   - MTO_CREDIT_LC),  0)) MGM_AMOUNT_LC_C,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)), -1, 0,  nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) MGM_AMOUNT_FC_D,
       decode(sign(nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC) , 0)),  1, 0, -nvl(sum(MTO_DEBIT_FC   - MTO_CREDIT_FC),  0)) MGM_AMOUNT_FC_C,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)), -1, 0,  nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) MGM_AMOUNT_EUR_D,
       decode(sign(nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)),  1, 0, -nvl(sum(MTO_DEBIT_EUR  - MTO_CREDIT_EUR), 0)) MGM_AMOUNT_EUR_C,
       TOT.ACS_FINANCIAL_CURRENCY_ID,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID,
       TOT.C_TYPE_CUMUL
  from
       ACT_MGM_TOT_BY_PERIOD TOT,
       ACS_ACCOUNT ACC,
       ACS_PJ_ACCOUNT PJ,
       ACS_PERIOD PER
  where
        ACC.ACC_NUMBER            >= ACR_FUNCTIONS.GetAccNumber(1)
    and ACC.ACC_NUMBER            <= ACR_FUNCTIONS.GetAccNumber(0)
    and ACC.ACS_ACCOUNT_ID         = PJ.ACS_PJ_ACCOUNT_ID
    and PJ.ACS_PJ_ACCOUNT_ID       = TOT.ACS_PJ_ACCOUNT_ID
    and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_PERIOD_ID         = TOT.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
    and PER.C_TYPE_PERIOD         = '1'
  group by
           TOT.ACS_FINANCIAL_ACCOUNT_ID,
           TOT.ACS_PJ_ACCOUNT_ID,
           TOT.ACS_CPN_ACCOUNT_ID,
           TOT.ACS_CDA_ACCOUNT_ID,
           TOT.ACS_PF_ACCOUNT_ID,
           TOT.ACS_QTY_UNIT_ID,
           ACS_ACS_FINANCIAL_CURRENCY_ID,
           ACS_FINANCIAL_CURRENCY_ID,
           C_TYPE_CUMUL,
           PER.ACS_PERIOD_ID,
           PER.PER_START_DATE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_RCO_IMPUTATIONS" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "DOC_RECORD_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACT_DOCUMENT_ID", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACS_FINANCIAL_ACCOUNT_ID", "RCO_TITLE", "RCO_DESCRIPTION", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD") AS
  select
       MGM.ACT_MGM_IMPUTATION_ID,
       MGM.ACT_FINANCIAL_IMPUTATION_ID,
       MGM.ACS_PERIOD_ID,
       MGM.IMM_VALUE_DATE,
       MGM.IMM_TRANSACTION_DATE,
       MGM.IMM_TYPE,
       MGM.IMM_GENRE,
       MGM.IMM_PRIMARY,
       MGM.IMM_DESCRIPTION,
       MGM.DOC_RECORD_ID,
       MGM.ACS_CPN_ACCOUNT_ID,
       MGM.ACS_CDA_ACCOUNT_ID,
       MGM.ACS_PF_ACCOUNT_ID,
       DIS.ACS_PJ_ACCOUNT_ID,
       MGM.ACS_QTY_UNIT_ID,
       nvl(nvl(DIS.MGM_QUANTITY_D, MGM.IMM_QUANTITY_D), 0) IMM_QUANTITY_D,
       nvl(nvl(DIS.MGM_QUANTITY_C, MGM.IMM_QUANTITY_C), 0) IMM_QUANTITY_C,
       nvl(nvl(DIS.MGM_AMOUNT_LC_D, MGM.IMM_AMOUNT_LC_D), 0) IMM_AMOUNT_LC_D,
       nvl(nvl(DIS.MGM_AMOUNT_LC_C, MGM.IMM_AMOUNT_LC_C), 0) IMM_AMOUNT_LC_C,
       nvl(nvl(DIS.MGM_AMOUNT_FC_D, MGM.IMM_AMOUNT_FC_D), 0) IMM_AMOUNT_FC_D,
       nvl(nvl(DIS.MGM_AMOUNT_FC_C, MGM.IMM_AMOUNT_FC_C), 0) IMM_AMOUNT_FC_C,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_D, MGM.IMM_AMOUNT_EUR_D), 0) IMM_AMOUNT_EUR_D,
       nvl(nvl(DIS.MGM_AMOUNT_EUR_C, MGM.IMM_AMOUNT_EUR_C), 0) IMM_AMOUNT_EUR_C,
       MGM.ACS_FINANCIAL_CURRENCY_ID,
       MGM.ACS_ACS_FINANCIAL_CURRENCY_ID,
       MGM.IMM_EXCHANGE_RATE,
       MGM.IMM_BASE_PRICE,
       MGM.ACT_DOCUMENT_ID,
       MGM.IMM_NUMBER,
       MGM.IMM_NUMBER2,
       MGM.IMM_NUMBER3,
       MGM.IMM_NUMBER4,
       MGM.IMM_NUMBER5,
       MGM.IMM_TEXT1,
       MGM.IMM_TEXT2,
       MGM.IMM_TEXT3,
       MGM.IMM_TEXT4,
       MGM.IMM_TEXT5,
       MGM.DIC_IMP_FREE1_ID,
       MGM.DIC_IMP_FREE2_ID,
       MGM.DIC_IMP_FREE3_ID,
       MGM.DIC_IMP_FREE4_ID,
       MGM.DIC_IMP_FREE5_ID,
       MGM.HRM_PERSON_ID,
       MGM.GCO_GOOD_ID,
       MGM.FAM_FIXED_ASSETS_ID,
       MGM.C_FAM_TRANSACTION_TYP,
       MGM.PAC_PERSON_ID,
       (select IMP.ACS_FINANCIAL_ACCOUNT_ID from ACT_FINANCIAL_IMPUTATION IMP where MGM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACS_FINANCIAL_ACCOUNT_ID,
       RCO.RCO_TITLE,
       RCO.RCO_DESCRIPTION,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       DOC.ACT_ACT_JOURNAL_ID ACT_JOURNAL_ID,
       (select JOU.JOU_NUMBER from ACT_JOURNAL JOU where JOU.ACT_JOURNAL_ID = DOC.ACT_ACT_JOURNAL_ID) JOU_NUMBER,
       (select JOU.JOU_DESCRIPTION from ACT_JOURNAL JOU where JOU.ACT_JOURNAL_ID = DOC.ACT_ACT_JOURNAL_ID) JOU_DESCRIPTION,
      (select ETA.C_ETAT_JOURNAL
       from ACT_ETAT_JOURNAL ETA
       where ETA.ACT_JOURNAL_ID = DOC.ACT_ACT_JOURNAL_ID
         and ETA.C_SUB_SET      = 'CPN') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                 = 'CPN') C_TYPE_CUMUL,
       PER.C_TYPE_PERIOD
  from
       ACT_DOCUMENT             DOC,
       ACS_PERIOD               PER,
       ACT_MGM_IMPUTATION       MGM,
       ACT_MGM_DISTRIBUTION     DIS,
       DOC_RECORD               RCO
  where
        RCO.RCO_TITLE                  >= ACR_FUNCTIONS.GetRcoTitle(1)
    and RCO.RCO_TITLE                  <= ACR_FUNCTIONS.GetRcoTitle(0)
    and RCO.DOC_RECORD_ID               = MGM.DOC_RECORD_ID
    and MGM.ACT_MGM_IMPUTATION_ID       = DIS.ACT_MGM_IMPUTATION_ID (+)
    and MGM.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and MGM.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_RCO_IMP_REPORT" ("ACT_MGM_IMPUTATION_ID", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "DOC_RECORD_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "ACS_FINANCIAL_ACCOUNT_ID", "RCO_TITLE", "RCO_DESCRIPTION", "IMM_NUMBER", "IMM_NUMBER2", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "PAC_PERSON_ID", "ACT_DOCUMENT_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_ACT_JOURNAL_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "C_ETAT_JOURNAL", "C_TYPE_CUMUL") AS
  select  ACT_MGM_IMPUTATION_ID,
          ACT_FINANCIAL_IMPUTATION_ID,
          ACS_PERIOD_ID,
          IMM_VALUE_DATE,
          IMM_TRANSACTION_DATE,
          IMM_TYPE,
          IMM_GENRE,
          IMM_PRIMARY,
          IMM_DESCRIPTION,
          DOC_RECORD_ID,
          ACS_CPN_ACCOUNT_ID,
          ACS_CDA_ACCOUNT_ID,
          ACS_PF_ACCOUNT_ID,
          ACS_PJ_ACCOUNT_ID,
          ACS_QTY_UNIT_ID,
          IMM_QUANTITY_D,
          IMM_QUANTITY_C,
          IMM_AMOUNT_LC_D,
          IMM_AMOUNT_LC_C,
          IMM_AMOUNT_FC_D,
          IMM_AMOUNT_FC_C,
          IMM_AMOUNT_EUR_D,
          IMM_AMOUNT_EUR_C,
          ACS_FINANCIAL_CURRENCY_ID,
          ACS_ACS_FINANCIAL_CURRENCY_ID,
          IMM_EXCHANGE_RATE,
          IMM_BASE_PRICE,
          ACS_FINANCIAL_ACCOUNT_ID,
          RCO_TITLE,
          RCO_DESCRIPTION,
          IMM_NUMBER,
          IMM_NUMBER2,
          IMM_NUMBER3,
          IMM_NUMBER4,
          IMM_NUMBER5,
          IMM_TEXT1,
          IMM_TEXT2,
          IMM_TEXT3,
          IMM_TEXT4,
          IMM_TEXT5,
          DIC_IMP_FREE1_ID,
          DIC_IMP_FREE2_ID,
          DIC_IMP_FREE3_ID,
          DIC_IMP_FREE4_ID,
          DIC_IMP_FREE5_ID,
          HRM_PERSON_ID,
          GCO_GOOD_ID,
          FAM_FIXED_ASSETS_ID,
          C_FAM_TRANSACTION_TYP,
          PAC_PERSON_ID,
          ACT_DOCUMENT_ID,
          DOC_NUMBER,
          DOC_COMMENT,
          ACJ_CATALOGUE_DOCUMENT_ID,
          ACT_ACT_JOURNAL_ID,
          ACT_JOURNAL_ID,
          JOU_NUMBER,
          JOU_DESCRIPTION,
          C_ETAT_JOURNAL,
          C_TYPE_CUMUL
  from  V_ACT_RCO_IMPUTATIONS
  where C_TYPE_PERIOD <> '1'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_RDE_HIGHEST_LEVEL" ("ACT_JOB_ID", "ACT_DOCUMENT_ID", "PAC_CUSTOM_PARTNER_ID", "PER_NAME", "PER_FORENAME", "EXP_REF_BVR", "PAR_REMIND_DATE", "DOC_DATE_DELIVERY", "EXP_ADAPTED", "LAST_REM_NO", "LAST_REM_DATE", "LAST_PMT_DATE", "EXP_REF_BVR_FA", "DOC_DOCUMENT_DATE_FA", "EXP_AMOUNT_LC", "AMOUNT_PMT", "REM_PAYABLE_AMOUNT_LC", "CURRENCY") AS
  select
  DOC.ACT_JOB_ID,
  DOC.ACT_DOCUMENT_ID,
  CUS.PAC_CUSTOM_PARTNER_ID,
  SUBSTR(PER.PER_NAME,1,30)                                                            PER_NAME,
  SUBSTR(PER_FORENAME,1,30)                                                            PER_FORENAME,
  SUBSTR(EXP.EXP_REF_BVR,1,12)                                                         EXP_REF_BVR,
  TRUNC(PAR.PAR_REMIND_DATE)                                                           PAR_REMIND_DATE,
  TRUNC(PAR.DOC_DATE_DELIVERY)                                                         DOC_DATE_DELIVERY,
  TRUNC(EXP.EXP_ADAPTED)                                                               EXP_ADAPTED,
  ACT_FUNCTIONS.LASTCLAIMSNOWITHOUTDOC(REM.ACT_EXPIRY_ID,REM.ACT_DOCUMENT_ID)          LAST_REM_NO,
  TRUNC(ACT_FUNCTIONS.LASTCLAIMSDATEWITHOUTDOC(REM.ACT_EXPIRY_ID,REM.ACT_DOCUMENT_ID)) LAST_REM_DATE,
  TRUNC(ACT_FUNCTIONS.LASTPAYMENTDATE(REM.ACT_EXPIRY_ID))                              LAST_PMT_DATE,
  SUBSTR(EFA.EXP_REF_BVR,1,12)                                                         EXP_REF_BVR_FA,
  TRUNC(DFA.DOC_DOCUMENT_DATE)                                                         DOC_DOCUMENT_DATE_FA,
  EFA.EXP_AMOUNT_LC,
  EFA.EXP_AMOUNT_LC - REM.REM_PAYABLE_AMOUNT_LC                                        AMOUNT_PMT,
  REM.REM_PAYABLE_AMOUNT_LC,
  CUR.CURRENCY
from
  PAC_PERSON             PER,
  ACT_DOCUMENT           DFA,
  ACT_EXPIRY             EFA,
  PCS.PC_CURR            CUR,
  ACS_FINANCIAL_CURRENCY FCU,
  PAC_REMAINDER_DETAIL   RDE,
  PAC_REMAINDER_CATEGORY RCA,
  ACT_REMINDER           REM,
  PAC_CUSTOM_PARTNER     CUS,
  ACT_EXPIRY             EXP,
  ACT_PART_IMPUTATION    PAR,
  ACT_DOCUMENT           DOC
where
  DOC.ACT_DOCUMENT_ID            = PAR.ACT_DOCUMENT_ID AND
  PAR.ACT_PART_IMPUTATION_ID     = EXP.ACT_PART_IMPUTATION_ID AND
  To_Number(EXP.C_STATUS_EXPIRY) = 9 AND
  PAR.PAC_CUSTOM_PARTNER_ID      = CUS.PAC_CUSTOM_PARTNER_ID AND
  PAR.ACT_PART_IMPUTATION_ID     = REM.ACT_PART_IMPUTATION_ID AND
  CUS.PAC_REMAINDER_CATEGORY_ID  = RCA.PAC_REMAINDER_CATEGORY_ID AND
  RCA.PAC_REMAINDER_CATEGORY_ID  = RDE.PAC_REMAINDER_CATEGORY_ID AND
  REM.REM_NUMBER                 = RDE.RDE_NO_REMAINDER AND
  RDE.RDE_CLAIMS_LEVEL           = 1 AND
  REM.ACS_FINANCIAL_CURRENCY_ID  = FCU.ACS_FINANCIAL_CURRENCY_ID AND
  FCU.PC_CURR_ID                 = CUR.PC_CURR_ID AND
  EFA.EXP_CALC_NET+0             = 1 AND
  REM.ACT_EXPIRY_ID              = EFA.ACT_EXPIRY_ID AND
  EFA.ACT_DOCUMENT_ID            = DFA.ACT_DOCUMENT_ID AND
  PAR.PAC_CUSTOM_PARTNER_ID      = PER.PAC_PERSON_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_REC_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACC_NUMBER", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "ACS_SUB_SET_ID", "C_TYPE_PERIOD", "MATCHING") AS
  select
       IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       (SELECT DIS.ACT_FINANCIAL_DISTRIBUTION_ID FROM ACT_FINANCIAL_DISTRIBUTION DIS WHERE DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       AUX.ACC_NUMBER,
       IMP.ACS_AUXILIARY_ACCOUNT_ID,
       IMP.IMF_PAC_CUSTOM_PARTNER_ID PAC_PERSON_ID,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_JOURNAL_ID,
       (SELECT JOU.JOU_NUMBER FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER,
       (SELECT JOU.JOU_DESCRIPTION FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION,
       (select COV.COV_NUMBER
        from ACT_COVER_INFORMATION COV
        where COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID) COV_NUMBER,
       (select PAR.PAR_DOCUMENT
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select ETA.C_ETAT_JOURNAL
        from ACT_ETAT_JOURNAL ETA
        where ETA.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID
          and ETA.C_SUB_SET      = 'REC') C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID   = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                   = 'REC') C_TYPE_CUMUL,
       AUX.ACS_SUB_SET_ID,
       PER.C_TYPE_PERIOD,
       ACR_FUNCTIONS.IsDocumentMatching (IMP.ACT_PART_IMPUTATION_ID) MATCHING
  from
       ACS_FINANCIAL_ACCOUNT      FIN,
       ACT_DOCUMENT               DOC,
       ACS_PERIOD                 PER,
       ACT_FINANCIAL_IMPUTATION   IMP,
       ACS_ACCOUNT                AUX,
       ACS_SUB_SET                SUB
  where
        SUB.C_SUB_SET                   = 'REC'
    and SUB.ACS_SUB_SET_ID              = AUX.ACS_SUB_SET_ID
    and AUX.ACC_NUMBER                 >= ACR_FUNCTIONS.GetAccNumber(1)
    and AUX.ACC_NUMBER                 <= ACR_FUNCTIONS.GetAccNumber(0)
    and AUX.ACS_ACCOUNT_ID              = IMP.ACS_AUXILIARY_ACCOUNT_ID
    and IMP.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId,0,PER.ACS_FINANCIAL_YEAR_ID,ACR_FUNCTIONS.GetFinYearId)
    and IMP.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID (+)
    and IMP.ACS_FINANCIAL_ACCOUNT_ID    = FIN.ACS_FINANCIAL_ACCOUNT_ID
    and FIN.FIN_COLLECTIVE              = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_REC_IMP_REPORT" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "ACC_NUMBER", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "MATCHING") AS
  select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       IMP_PAC_PERSON_ID,
       MATCHING
  from V_ACT_REC_IMPUTATION
      where C_TYPE_PERIOD <> '1'
union all
select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACS_AUXILIARY_ACCOUNT_ID,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       ACC_NUMBER,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       IMP_PAC_PERSON_ID,
       MATCHING
  from V_ACT_REC_IMPUTATION
    where C_TYPE_PERIOD = '1'
    and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_FINANCIAL_IMPUTATION_ID,
       TOT.ACS_PERIOD_ID,
       0 ACT_DOCUMENT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       'MAN' IMF_TYPE,
       0 IMF_PRIMARY,
       'Report' IMF_DESCRIPTION,
       TOT.TOT_DEBIT_LC  IMF_AMOUNT_LC_D,
       TOT.TOT_CREDIT_LC IMF_AMOUNT_LC_C,
       0 IMF_EXCHANGE_RATE,
       TOT.TOT_DEBIT_FC   IMF_AMOUNT_FC_D,
       TOT.TOT_CREDIT_FC  IMF_AMOUNT_FC_C,
       TOT.TOT_DEBIT_EUR  IMF_AMOUNT_EUR_D,
       TOT.TOT_CREDIT_EUR IMF_AMOUNT_EUR_C,
       TOT.PER_START_DATE IMF_VALUE_DATE,
       0 ACS_TAX_CODE_ID,
       TOT.PER_START_DATE IMF_TRANSACTION_DATE,
       TOT.ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
       '1' C_GENRE_TRANSACTION,
       TOT.ACS_AUXILIARY_ACCOUNT_ID,
       0 ACT_DET_PAYMENT_ID,
       TOT.ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
       0 IMF_BASE_PRICE,
       0 ACT_PART_IMPUTATION_ID,
       TOT.ACC_NUMBER,
       0 ACT_FINANCIAL_DISTRIBUTION_ID,
       TOT.ACS_DIVISION_ACCOUNT_ID,
       (SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = TOT.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       0 FINANCIAL_IMPUTATION_ID,
       0 ACT_ACT_JOURNAL_ID,
       'PROV' C_ETAT_JOURNAL,
       TOT.C_TYPE_CUMUL,
       '' COV_NUMBER,
       null PAR_DOCUMENT,
       TO_DATE(null) DOC_DATE_DELIVERY,
       '' IMF_TEXT1,
       '' IMF_TEXT2,
       '' IMF_TEXT3,
       '' IMF_TEXT4,
       '' IMF_TEXT5,
       0 IMF_NUMBER,
       0 IMF_NUMBER2,
       0 IMF_NUMBER3,
       0 IMF_NUMBER4,
       0 IMF_NUMBER5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_IMP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 GCO_GOOD_ID,
       0 HRM_PERSON_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 IMP_PAC_PERSON_ID,
       0 MATCHING
  from
       V_ACT_REC_PREV_YEAR_TOTAL TOT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_REC_PREV_YEAR_TOTAL" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER", "ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE") AS
  select   TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_DEBIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_LC - TOT.TOT_CREDIT_LC), 0)
                 ) TOT_CREDIT_LC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_DEBIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_FC - TOT.TOT_CREDIT_FC), 0)
                 ) TOT_CREDIT_FC
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , -1, 0
                , nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_DEBIT_EUR
         , decode(sign(nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0) )
                , 1, 0
                , -nvl(sum(TOT.TOT_DEBIT_EUR - TOT.TOT_CREDIT_EUR), 0)
                 ) TOT_CREDIT_EUR
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE
      from ACS_ACCOUNT ACC
         , ACT_TOTAL_BY_PERIOD TOT
         , ACS_PERIOD PER
     where ACC.ACC_NUMBER >= ACR_FUNCTIONS.GetAccNumber(1)
       and ACC.ACC_NUMBER <= ACR_FUNCTIONS.GetAccNumber(0)
       and exists(select 1
                    from ACS_SUB_SET SUB
                   where SUB.C_SUB_SET = 'REC'
                     and SUB.ACS_SUB_SET_ID = ACC.ACS_SUB_SET_ID)
       and ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
       and PER.ACS_FINANCIAL_YEAR_ID = ACR_FUNCTIONS.GetFinYearId
       and PER.ACS_PERIOD_ID = TOT.ACS_PERIOD_ID
       and PER.C_TYPE_PERIOD = '1'
       and TOT.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
       and (    (TOT.ACS_DIVISION_ACCOUNT_ID is not null)
            or (    TOT.ACS_DIVISION_ACCOUNT_ID is null
                and ACR_FUNCTIONS.ExistDivision = 0)
           )
  group by TOT.ACS_AUXILIARY_ACCOUNT_ID
         , TOT.ACS_FINANCIAL_ACCOUNT_ID
         , ACC.ACC_NUMBER
         , TOT.ACS_DIVISION_ACCOUNT_ID
         , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID
         , TOT.ACS_FINANCIAL_CURRENCY_ID
         , TOT.C_TYPE_CUMUL
         , TOT.ACS_PERIOD_ID
         , PER.PER_START_DATE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_REMINDER_ANALYSE" ("ACT_JOB_ID", "PAR_REMIND_DATE", "DOC_DATE_DELIVERY", "ACJ_CATALOGUE_DOCUMENT_ID", "ACS_PERIOD_ID", "REM_NUMBER", "ACS_ACS_FINANCIAL_CURRENCY_ID", "NUMBER_OF_REMINDER", "AMOUNT_LC", "PAYABLE_AMOUNT_LC", "AMOUNT_FC", "PAYABLE_AMOUNT_FC", "AMOUNT_EUR", "PAYABLE_AMOUNT_EUR") AS
  select
       JOB.ACT_JOB_ID,
       PART.PAR_REMIND_DATE,
       PART.DOC_DATE_DELIVERY,
       CAT.ACJ_CATALOGUE_DOCUMENT_ID,
       IMP.ACS_PERIOD_ID,
       REM.REM_NUMBER,
       REM.ACS_ACS_FINANCIAL_CURRENCY_ID,
       count (*) NUMBER_OF_REMINDER,
       sum(EXP.EXP_AMOUNT_LC)          AMOUNT_LC,
       sum(REM.REM_PAYABLE_AMOUNT_LC)  PAYABLE_AMOUNT_LC,
       sum(EXP.EXP_AMOUNT_FC)          AMOUNT_FC,
       sum(REM.REM_PAYABLE_AMOUNT_FC)  PAYABLE_AMOUNT_FC,
       sum(EXP.EXP_AMOUNT_EUR)         AMOUNT_EUR,
       sum(REM.REM_PAYABLE_AMOUNT_EUR) PAYABLE_AMOUNT_EUR
from
     ACT_FINANCIAL_IMPUTATION IMP,
     ACT_PART_IMPUTATION PART,
     ACT_DOCUMENT DOC,
     ACT_EXPIRY EXP,
     ACT_REMINDER REM,
     ACT_JOB JOB,
     ACJ_CATALOGUE_DOCUMENT CAT
where
      CAT.C_TYPE_CATALOGUE = '8'
  and JOB.JOB_ACI_CONTROL_DATE is not null
  and IMP.IMF_PRIMARY+0 = 1
  and CAT.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
  and DOC.ACT_JOB_ID = JOB.ACT_JOB_ID
  and DOC.ACT_DOCUMENT_ID = PART.ACT_DOCUMENT_ID
  and PART.ACT_PART_IMPUTATION_ID = REM.ACT_PART_IMPUTATION_ID
  and DOC.ACT_DOCUMENT_ID = REM.ACT_DOCUMENT_ID
  and REM.ACT_EXPIRY_ID = EXP.ACT_EXPIRY_ID
  and EXP.ACT_DOCUMENT_ID = IMP.ACT_DOCUMENT_ID
group by
         JOB.ACT_JOB_ID,
         PART.PAR_REMIND_DATE,
         PART.DOC_DATE_DELIVERY,
         CAT.ACJ_CATALOGUE_DOCUMENT_ID,
         IMP.ACS_PERIOD_ID,
         REM.REM_NUMBER,
         REM.ACS_ACS_FINANCIAL_CURRENCY_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_REP_MGM_IMPUTATION" ("ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "PC_USER_ID", "C_ETAT_JOURNAL", "C_SUB_SET", "ACT_JOB_ID", "ACS_FINANCIAL_YEAR_ID", "JOB_DESCRIPTION", "FYE_NO_EXERCICE", "ACT_DOCUMENT_ID", "DOC_DOCUMENT_DATE", "DOC_NUMBER", "DOC_TOTAL_AMOUNT_DC", "DOC_TOTAL_AMOUNT_EUR", "ACT_MGM_IMPUTATION_ID", "IMM_TRANSACTION_DATE", "IMM_VALUE_DATE", "IMM_PRIMARY", "IMM_DESCRIPTION", "ACT_FINANCIAL_IMPUTATION_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "ACS_FINANCIAL_CURRENCY_ID", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_EXCHANGE_RATE", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "ACT_MGM_DISTRIBUTION_ID", "ACS_PJ_ACCOUNT_ID", "MGM_DESCRIPTION", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_FC_C", "ACS_AUXILIARY_ACCOUNT_ID") AS
  SELECT
   JOU.ACT_JOURNAL_ID,
   JOU.JOU_NUMBER,
   JOU.JOU_DESCRIPTION,
   JOU.PC_USER_ID,
   EJO.C_ETAT_JOURNAL,
   EJO.C_SUB_SET,
   JOB.ACT_JOB_ID,
   JOB.ACS_FINANCIAL_YEAR_ID,
   JOB.JOB_DESCRIPTION,
   FYE.FYE_NO_EXERCICE,
   DOC.ACT_DOCUMENT_ID,
   DOC.DOC_DOCUMENT_DATE,
   DOC.DOC_NUMBER,
   DOC.DOC_TOTAL_AMOUNT_DC,
   DOC.DOC_TOTAL_AMOUNT_EUR,
   IMM.ACT_MGM_IMPUTATION_ID,
   IMM.IMM_TRANSACTION_DATE,
   IMM.IMM_VALUE_DATE,
   IMM.IMM_PRIMARY,
   IMM.IMM_DESCRIPTION,
   IMM.ACT_FINANCIAL_IMPUTATION_ID,
   IMM.ACS_CPN_ACCOUNT_ID,
   IMM.ACS_CDA_ACCOUNT_ID,
   IMM.ACS_PF_ACCOUNT_ID,
   IMM.ACS_QTY_UNIT_ID,
   IMM.ACS_ACS_FINANCIAL_CURRENCY_ID,
   IMM.IMM_AMOUNT_LC_D,
   IMM.IMM_AMOUNT_LC_C,
   IMM.ACS_FINANCIAL_CURRENCY_ID,
   IMM.IMM_AMOUNT_FC_D,
   IMM.IMM_AMOUNT_FC_C,
   IMM.IMM_EXCHANGE_RATE,
   IMM.IMM_QUANTITY_D,
   IMM.IMM_QUANTITY_C,
   MGM.ACT_MGM_DISTRIBUTION_ID,
   MGM.ACS_PJ_ACCOUNT_ID,
   MGM.MGM_DESCRIPTION,
   MGM.MGM_AMOUNT_LC_D,
   MGM.MGM_AMOUNT_LC_C,
   MGM.MGM_AMOUNT_FC_D,
   MGM.MGM_AMOUNT_FC_C,
   ACT_FUNCTIONS.AuxAccountFromImputation(IMM.ACT_FINANCIAL_IMPUTATION_ID) ACS_AUXILIARY_ACCOUNT_ID
FROM
   ACT_MGM_DISTRIBUTION MGM,
   ACT_MGM_IMPUTATION IMM,
   ACT_DOCUMENT DOC,
   ACS_FINANCIAL_YEAR FYE,
   ACT_JOB JOB,
   ACT_ETAT_JOURNAL EJO,
   ACT_JOURNAL JOU
WHERE
   JOU.ACT_JOURNAL_ID = EJO.ACT_JOURNAL_ID  AND
   JOU.ACT_JOB_ID = JOB.ACT_JOB_ID AND
   JOB.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
   JOB.ACT_JOB_ID = DOC.ACT_JOB_ID AND
   DOC.ACT_DOCUMENT_ID = IMM.ACT_DOCUMENT_ID (+) AND
   IMM.ACT_MGM_IMPUTATION_ID = MGM.ACT_MGM_IMPUTATION_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_STAT_PAY" ("ACS_DIVISION_ACCOUNT_ID", "PER_NO_PERIOD", "FYE_NO_EXERCICE", "PER_FORENAME", "PER_NAME", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "ACS_FINANCIAL_YEAR_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_ACCOUNT_ID") AS
  select IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (select PER.PER_NO_PERIOD from ACS_PERIOD PER where PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID) PER_NO_PERIOD,
       (select YEA.FYE_NO_EXERCICE from ACS_FINANCIAL_YEAR YEA where YEA.ACS_FINANCIAL_YEAR_ID = (select ACS_FINANCIAL_YEAR_ID
                                                                                                    from ACS_PERIOD
                                                                                                   where ACS_PERIOD_ID = IMP.ACS_PERIOD_ID)) FYE_NO_EXERCICE,
       (select PER.PER_FORENAME from PAC_PERSON PER where PER.PAC_PERSON_ID = IMP.IMF_PAC_SUPPLIER_PARTNER_ID) PER_FORENAME,
       (select PER.PER_NAME from PAC_PERSON PER where PER.PAC_PERSON_ID = IMP.IMF_PAC_SUPPLIER_PARTNER_ID) PER_NAME,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       (select PER.ACS_FINANCIAL_YEAR_ID from ACS_PERIOD PER where PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID) ACS_FINANCIAL_YEAR_ID,
       IMP.IMF_ACS_AUX_ACCOUNT_SUPP_ID ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID
  from ACT_FINANCIAL_IMPUTATION IMP
 where IMP.ACT_PART_IMPUTATION_ID is not null
   and IMP.IMF_PAC_SUPPLIER_PARTNER_ID is not null


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_STAT_REC" ("ACS_DIVISION_ACCOUNT_ID", "PER_NO_PERIOD", "FYE_NO_EXERCICE", "PER_FORENAME", "PER_NAME", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "ACS_FINANCIAL_YEAR_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_ACCOUNT_ID") AS
  select IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (select PER.PER_NO_PERIOD from ACS_PERIOD PER where PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID) PER_NO_PERIOD,
       (select YEA.FYE_NO_EXERCICE from ACS_FINANCIAL_YEAR YEA where YEA.ACS_FINANCIAL_YEAR_ID = (select ACS_FINANCIAL_YEAR_ID
                                                                                                    from ACS_PERIOD
                                                                                                   where ACS_PERIOD_ID = IMP.ACS_PERIOD_ID)) FYE_NO_EXERCICE,
       (select PER.PER_FORENAME from PAC_PERSON PER where PER.PAC_PERSON_ID = IMP.IMF_PAC_CUSTOM_PARTNER_ID) PER_FORENAME,
       (select PER.PER_NAME from PAC_PERSON PER where PER.PAC_PERSON_ID = IMP.IMF_PAC_CUSTOM_PARTNER_ID) PER_NAME,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       (select PER.ACS_FINANCIAL_YEAR_ID from ACS_PERIOD PER where PER.ACS_PERIOD_ID = IMP.ACS_PERIOD_ID) ACS_FINANCIAL_YEAR_ID,
       IMP.IMF_ACS_AUX_ACCOUNT_CUST_ID ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID
  from ACT_FINANCIAL_IMPUTATION IMP
 where IMP.ACT_PART_IMPUTATION_ID is not null
   and IMP.IMF_PAC_CUSTOM_PARTNER_ID is not null


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_THIRD_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACC_NUMBER", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "C_TYPE_PERIOD") AS
  select
       IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       IMP.IMF_DESCRIPTION,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.DOC_RECORD_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       (SELECT DIS.ACT_FINANCIAL_DISTRIBUTION_ID FROM ACT_FINANCIAL_DISTRIBUTION DIS WHERE DIS.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID) ACT_FINANCIAL_DISTRIBUTION_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       (SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
       AUX.ACC_NUMBER,
       AUX.ACS_ACCOUNT_ID ACS_AUXILIARY_ACCOUNT_ID,
       nvl(IMP.IMF_PAC_SUPPLIER_PARTNER_ID, IMP.IMF_PAC_CUSTOM_PARTNER_ID) PAC_PERSON_ID,
       DOC.DOC_NUMBER,
       DOC.DOC_COMMENT,
       DOC.ACJ_CATALOGUE_DOCUMENT_ID,
       DOC.ACT_JOURNAL_ID,
       (SELECT JOU.JOU_NUMBER FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER,
       (SELECT JOU.JOU_DESCRIPTION FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION,
       (select COV.COV_NUMBER
        from ACT_COVER_INFORMATION COV
        where COV.ACT_COVER_INFORMATION_ID = DOC.ACT_COVER_INFORMATION_ID) COV_NUMBER,
       (select PAR.PAR_DOCUMENT
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) PAR_DOCUMENT,
       (select PAR.DOC_DATE_DELIVERY
        from ACT_PART_IMPUTATION PAR
        where PAR.ACT_PART_IMPUTATION_ID = IMP.ACT_PART_IMPUTATION_ID) DOC_DATE_DELIVERY,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID,
       DOC.ACT_ACT_JOURNAL_ID,
       (select ETA.C_ETAT_JOURNAL
        from ACT_ETAT_JOURNAL ETA
        where ETA.ACT_JOURNAL_ID  = DOC.ACT_JOURNAL_ID
          and ETA.C_SUB_SET       = SUB.C_SUB_SET) C_ETAT_JOURNAL,
       (select SCA.C_TYPE_CUMUL
        from ACJ_SUB_SET_CAT SCA
        where SCA.ACJ_CATALOGUE_DOCUMENT_ID = DOC.ACJ_CATALOGUE_DOCUMENT_ID
          and SCA.C_SUB_SET                 = SUB.C_SUB_SET) C_TYPE_CUMUL,
       PER.C_TYPE_PERIOD
  from
       ACS_FINANCIAL_ACCOUNT      FIN,
       ACT_DOCUMENT               DOC,
       ACS_PERIOD                 PER,
       ACT_FINANCIAL_IMPUTATION   IMP,
       ACS_SUB_SET                SUB,
       ACS_ACCOUNT                AUX
  where
        AUX.ACS_SUB_SET_ID              = SUB.ACS_SUB_SET_ID
    and AUX.ACS_ACCOUNT_ID              = IMP.ACS_AUXILIARY_ACCOUNT_ID
    and IMP.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
    and PER.ACS_FINANCIAL_YEAR_ID       = DECODE(ACR_FUNCTIONS.GetFinYearId, 0, PER.ACS_FINANCIAL_YEAR_ID, ACR_FUNCTIONS.GetFinYearId)
    and IMP.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID (+)
    and IMP.ACS_FINANCIAL_ACCOUNT_ID    = FIN.ACS_FINANCIAL_ACCOUNT_ID
    and FIN.FIN_COLLECTIVE              = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_THIRD_IMP_REPORT" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "ACT_FINANCIAL_DISTRIBUTION_ID", "ACS_DIVISION_ACCOUNT_ID", "DIV_NUMBER", "ACC_NUMBER", "ACS_AUXILIARY_ACCOUNT_ID", "PAC_PERSON_ID", "DOC_NUMBER", "DOC_COMMENT", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "JOU_NUMBER", "JOU_DESCRIPTION", "COV_NUMBER", "PAR_DOCUMENT", "DOC_DATE_DELIVERY", "FINANCIAL_IMPUTATION_ID", "ACT_ACT_JOURNAL_ID", "C_ETAT_JOURNAL", "C_TYPE_CUMUL", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID") AS
  select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_GENRE,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       ACC_NUMBER,
       ACS_AUXILIARY_ACCOUNT_ID,
       PAC_PERSON_ID,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       IMP_PAC_PERSON_ID
   from
       V_ACT_THIRD_IMPUTATION
      where C_TYPE_PERIOD <> '1'
union all
select
       ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       IMF_TYPE,
       IMF_PRIMARY,
       IMF_DESCRIPTION,
       IMF_AMOUNT_LC_D,
       IMF_AMOUNT_LC_C,
       IMF_EXCHANGE_RATE,
       IMF_AMOUNT_FC_D,
       IMF_AMOUNT_FC_C,
       IMF_AMOUNT_EUR_D,
       IMF_AMOUNT_EUR_C,
       IMF_VALUE_DATE,
       ACS_TAX_CODE_ID,
       IMF_TRANSACTION_DATE,
       ACS_FINANCIAL_CURRENCY_ID,
       C_GENRE_TRANSACTION,
       ACT_DET_PAYMENT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMF_GENRE,
       IMF_BASE_PRICE,
       ACT_PART_IMPUTATION_ID,
       ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       ACC_NUMBER,
       ACS_AUXILIARY_ACCOUNT_ID,
       PAC_PERSON_ID,
       DOC_NUMBER,
       DOC_COMMENT,
       ACJ_CATALOGUE_DOCUMENT_ID,
       ACT_JOURNAL_ID,
       JOU_NUMBER,
       JOU_DESCRIPTION,
       COV_NUMBER,
       PAR_DOCUMENT,
       DOC_DATE_DELIVERY,
       FINANCIAL_IMPUTATION_ID,
       ACT_ACT_JOURNAL_ID,
       C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       IMF_TEXT1,
       IMF_TEXT2,
       IMF_TEXT3,
       IMF_TEXT4,
       IMF_TEXT5,
       IMF_NUMBER,
       IMF_NUMBER2,
       IMF_NUMBER3,
       IMF_NUMBER4,
       IMF_NUMBER5,
       DIC_IMP_FREE1_ID,
       DIC_IMP_FREE2_ID,
       DIC_IMP_FREE3_ID,
       DIC_IMP_FREE4_ID,
       DIC_IMP_FREE5_ID,
       GCO_GOOD_ID,
       HRM_PERSON_ID,
       DOC_RECORD_ID,
       FAM_FIXED_ASSETS_ID,
       C_FAM_TRANSACTION_TYP,
       IMP_PAC_PERSON_ID
  from
       V_ACT_THIRD_IMPUTATION
    where C_TYPE_PERIOD = '1'
    and NVL(ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId),'CLO') = 'CLO'
union all
select
       0 ACT_FINANCIAL_IMPUTATION_ID,
       ACS_PERIOD_ID,
       0 ACT_DOCUMENT_ID,
       ACS_FINANCIAL_ACCOUNT_ID,
       'MAN' IMF_TYPE,
       0 IMF_PRIMARY,
       'Report' IMF_DESCRIPTION,
       TOT_DEBIT_LC  IMF_AMOUNT_LC_D,
       TOT_CREDIT_LC IMF_AMOUNT_LC_C,
       0 IMF_EXCHANGE_RATE,
       TOT_DEBIT_FC   IMF_AMOUNT_FC_D,
       TOT_CREDIT_FC  IMF_AMOUNT_FC_C,
       TOT_DEBIT_EUR  IMF_AMOUNT_EUR_D,
       TOT_CREDIT_EUR IMF_AMOUNT_EUR_C,
       PER_START_DATE IMF_VALUE_DATE,
       0 ACS_TAX_CODE_ID,
       PER_START_DATE IMF_TRANSACTION_DATE,
       ACS_ACS_FINANCIAL_CURRENCY_ID ACS_FINANCIAL_CURRENCY_ID,
       '1' C_GENRE_TRANSACTION,
       0 ACT_DET_PAYMENT_ID,
       ACS_FINANCIAL_CURRENCY_ID ACS_ACS_FINANCIAL_CURRENCY_ID,
       'STD' IMF_GENRE,
       0 IMF_BASE_PRICE,
       0 ACT_PART_IMPUTATION_ID,
       0 ACT_FINANCIAL_DISTRIBUTION_ID,
       ACS_DIVISION_ACCOUNT_ID,
       DIV_NUMBER,
       ACC_NUMBER,
       ACS_AUXILIARY_ACCOUNT_ID,
       0 PAC_PERSON_ID,
       '' DOC_NUMBER,
       '' DOC_COMMENT,
       0 ACJ_CATALOGUE_DOCUMENT_ID,
       0 ACT_JOURNAL_ID,
       0 JOU_NUMBER,
       '' JOU_DESCRIPTION,
       '' COV_NUMBER,
       null PAR_DOCUMENT,
       TO_DATE(null) DOC_DATE_DELIVERY,
       0 FINANCIAL_IMPUTATION_ID,
       0 ACT_ACT_JOURNAL_ID,
       'PROV' C_ETAT_JOURNAL,
       C_TYPE_CUMUL,
       '' IMF_TEXT1,
       '' IMF_TEXT2,
       '' IMF_TEXT3,
       '' IMF_TEXT4,
       '' IMF_TEXT5,
       0 IMF_NUMBER,
       0 IMF_NUMBER2,
       0 IMF_NUMBER3,
       0 IMF_NUMBER4,
       0 IMF_NUMBER5,
       '' DIC_IMP_FREE1_ID,
       '' DIC_IMP_FREE2_ID,
       '' DIC_IMP_FREE3_ID,
       '' DIC_IMP_FREE4_ID,
       '' DIC_IMP_FREE5_ID,
       0 GCO_GOOD_ID,
       0 HRM_PERSON_ID,
       0 DOC_RECORD_ID,
       0 FAM_FIXED_ASSETS_ID,
       '' C_FAM_TRANSACTION_TYP,
       0 IMP_PAC_PERSON_ID
  from V_ACT_THIRD_PREV_YEAR_TOTAL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_THIRD_PREV_YEAR_TOTAL" ("ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_CUMUL", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR", "ACS_PERIOD_ID", "PER_START_DATE", "ACC_NUMBER", "DIV_NUMBER") AS
  select
       ACS_AUXILIARY_ACCOUNT_ID,
       TOT.ACS_FINANCIAL_ACCOUNT_ID,
       ACS_DIVISION_ACCOUNT_ID,
       ACS_ACS_FINANCIAL_CURRENCY_ID,
       ACS_FINANCIAL_CURRENCY_ID,
       C_TYPE_CUMUL,
       decode(sign(nvl(sum(TOT_DEBIT_LC  - TOT_CREDIT_LC) , 0)), -1, 0,  nvl(sum(TOT_DEBIT_LC  - TOT_CREDIT_LC),  0))  TOT_DEBIT_LC,
       decode(sign(nvl(sum(TOT_DEBIT_LC  - TOT_CREDIT_LC) , 0)),  1, 0, -nvl(sum(TOT_DEBIT_LC  - TOT_CREDIT_LC),  0))  TOT_CREDIT_LC,
       decode(sign(nvl(sum(TOT_DEBIT_FC  - TOT_CREDIT_FC) , 0)), -1, 0,  nvl(sum(TOT_DEBIT_FC  - TOT_CREDIT_FC),  0))  TOT_DEBIT_FC,
       decode(sign(nvl(sum(TOT_DEBIT_FC  - TOT_CREDIT_FC) , 0)),  1, 0, -nvl(sum(TOT_DEBIT_FC  - TOT_CREDIT_FC),  0))  TOT_CREDIT_FC,
       decode(sign(nvl(sum(TOT_DEBIT_EUR - TOT_CREDIT_EUR), 0)), -1, 0,  nvl(sum(TOT_DEBIT_EUR - TOT_CREDIT_EUR), 0))  TOT_DEBIT_EUR,
       decode(sign(nvl(sum(TOT_DEBIT_EUR - TOT_CREDIT_EUR), 0)),  1, 0, -nvl(sum(TOT_DEBIT_EUR - TOT_CREDIT_EUR), 0))  TOT_CREDIT_EUR,
       TOT.ACS_PERIOD_ID,
       PER.PER_START_DATE,
       ACC.ACC_NUMBER,
       DIV.ACC_NUMBER DIV_NUMBER
  from
        ACS_ACCOUNT           DIV,
        ACS_ACCOUNT           ACC,
        ACT_TOTAL_BY_PERIOD   TOT,
        ACS_PERIOD            PER
  where
        ACS_FUNCTION.GetStatePreviousFinancialYear(ACR_FUNCTIONS.GetFinYearId) = 'ACT'
    and PER.ACS_FINANCIAL_YEAR_ID       = ACR_FUNCTIONS.GetFinYearId
    and PER.ACS_PERIOD_ID               = TOT.ACS_PERIOD_ID
    and PER.C_TYPE_PERIOD               = '1'
    and TOT.ACS_AUXILIARY_ACCOUNT_ID    = ACC.ACS_ACCOUNT_ID
    and ((ACS_DIVISION_ACCOUNT_ID is not null) or (ACS_DIVISION_ACCOUNT_ID is null and ACR_FUNCTIONS.ExistDivision = 0))
    and TOT.ACS_DIVISION_ACCOUNT_ID     = DIV.ACS_ACCOUNT_ID (+)
  group by
           ACS_AUXILIARY_ACCOUNT_ID,
           TOT.ACS_FINANCIAL_ACCOUNT_ID,
           ACS_DIVISION_ACCOUNT_ID,
           ACS_ACS_FINANCIAL_CURRENCY_ID,
           ACS_FINANCIAL_CURRENCY_ID,
           C_TYPE_CUMUL,
           TOT.ACS_PERIOD_ID,
           PER.PER_START_DATE,
           ACC.ACC_NUMBER,
           DIV.ACC_NUMBER




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_ACT_TOTAL_BY_PERIOD_ACC" ("ACT_TOTAL_BY_PERIOD_ID", "ACS_PERIOD_ID", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACS_ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "A_CONFIRM", "C_TYPE_PERIOD", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "C_TYPE_CUMUL", "ACS_DIVISION_ACCOUNT_ID", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR") AS
  select
  ACT_TOTAL_BY_PERIOD_ID,
  ACS_PERIOD_ID,
  TOT_DEBIT_LC,
  TOT_CREDIT_LC,
  TOT_DEBIT_FC,
  TOT_CREDIT_FC,
  ACS_FINANCIAL_ACCOUNT_ID,
  ACS_AUXILIARY_ACCOUNT_ID,
  ACS_ACS_AUXILIARY_ACCOUNT_ID,
  ACS_FINANCIAL_CURRENCY_ID,
  ACS_ACS_FINANCIAL_CURRENCY_ID,
  A_CONFIRM,
  C_TYPE_PERIOD,
  A_DATECRE,
  A_DATEMOD,
  A_IDCRE,
  A_IDMOD,
  A_RECLEVEL,
  A_RECSTATUS,
  C_TYPE_CUMUL,
  ACS_DIVISION_ACCOUNT_ID,
  TOT_DEBIT_EUR,
  TOT_CREDIT_EUR
from
  ACT_TOTAL_BY_PERIOD
where
  ACS_AUXILIARY_ACCOUNT_ID is null




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_COM_CPY_CODES" ("COM_CPY_CODES_ID", "COM_CPY_CODES_VALUE_ID", "PC_LANG_ID", "CPC_NAME", "CPV_NAME", "LANID", "CPD_CODE", "CPD_TEXT1", "CPD_TEXT2", "CPD_TEXT3") AS
  SELECT
  A.COM_CPY_CODES_ID,
  B.COM_CPY_CODES_VALUE_ID,
  C.PC_LANG_ID,
  CPC_NAME,
  CPV_NAME,
  LANID,
  CPD_CODE,
  CPD_TEXT1,
  CPD_TEXT2,
  CPD_TEXT3
FROM
  COM_CPY_CODES A,
  COM_CPY_CODES_VALUE B,
  COM_CPY_CODES_VALUE_DESCR C,
  PCS.PC_LANG D
WHERE
  A.COM_CPY_CODES_ID = B.COM_CPY_CODES_ID AND
  B.COM_CPY_CODES_VALUE_ID = C.COM_CPY_CODES_VALUE_ID AND
  C.PC_LANG_ID = D.PC_LANG_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_COM_CPY_CODES1" ("PC_LANG_ID", "LANID", "GCGNAME", "GCLCODE", "GCDCODE", "GCDTEXT1", "GCDTEXT2", "GCDTEXT3") AS
  SELECT
  C.PC_LANG_ID,
  LANID,
  CPC_NAME,
  CPV_NAME,
  CPD_CODE,
  CPD_TEXT1,
  CPD_TEXT2,
  CPD_TEXT3
FROM
  COM_CPY_CODES A,
  COM_CPY_CODES_VALUE B,
  COM_CPY_CODES_VALUE_DESCR C,
  PCS.PC_LANG D
WHERE
  A.COM_CPY_CODES_ID = B.COM_CPY_CODES_ID AND
  B.COM_CPY_CODES_VALUE_ID = C.COM_CPY_CODES_VALUE_ID AND
  C.PC_LANG_ID = D.PC_LANG_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_COM_CPY_PCS_CODES" ("PC_LANG_ID", "LANID", "GCGNAME", "GCLCODE", "GCDCODE", "GCDTEXT1", "GCDTEXT2", "GCDTEXT3") AS
  SELECT c.pc_lang_id, lanid, cpc_name, cpv_name, cpd_code, cpd_text1, cpd_text2, cpd_text3
     FROM com_cpy_codes a,
          com_cpy_codes_value b,
          com_cpy_codes_value_descr c,
          pcs.pc_lang d
    WHERE a.com_cpy_codes_id = b.com_cpy_codes_id
      AND b.com_cpy_codes_value_id = c.com_cpy_codes_value_id
      AND c.pc_lang_id = d.pc_lang_id
   UNION
   SELECT pc_lang_id  , lanid, gcgname , gclcode , gcdcode , gcdtext1 , gcdtext2 , gcdtext3
     FROM pcs.pc_gcodes e
    WHERE NOT EXISTS ( SELECT cpv_name
                         FROM com_cpy_codes a, com_cpy_codes_value b
                        WHERE a.com_cpy_codes_id = b.com_cpy_codes_id
                          AND a.cpc_name = e.gcgname
                          AND b.cpv_name = e.gclcode)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_COM_ECC_DIFF_DATA" ("COM_ROWNUM", "COM_LEVEL", "COM_ECC_DIFF_DATA_ID", "COM_ECC_DIFF_DATA_PARENT_ID", "CED_TABLE_ID", "CED_TABLE", "CED_FIELD", "CED_VALUE_FROM", "CED_VALUE", "CED_TEXT_VALUE_FROM", "CED_TEXT_VALUE", "CED_MODE", "CED_TYPE", "CED_DATE", "CED_OPTION_TYPE") AS
  select     rownum
           , level
           , COM_ECC_DIFF_DATA_ID
           , COM_ECC_DIFF_DATA_PARENT_ID
           , CED_TABLE_ID
           , CED_TABLE
           , CED_FIELD
           , CED_VALUE_FROM
           , CED_VALUE
           , CED_TEXT_VALUE_FROM
           , CED_TEXT_VALUE
           , CED_MODE
           , CED_TYPE
           , CED_DATE
           , CED_OPTION_TYPE
        from COM_ECC_DIFF_DATA
  start with COM_ECC_DIFF_DATA_PARENT_ID is null
  connect by prior COM_ECC_DIFF_DATA_ID = COM_ECC_DIFF_DATA_PARENT_ID
    order siblings by COM_ECC_DIFF_DATA_PARENT_ID
            , COM_ECC_DIFF_DATA_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DIC_ADDRESS_TYPE_ISAG" ("DIC_ADDRESS_TYPE_ID", "DAD_DESCR", "PC_LANG_ID") AS
  select DIC.DIC_ADDRESS_TYPE_ID,
       nvl(DES.DIT_DESCR,DIC.DAD_DESCR) DIT_DESCR,
       nvl(DES.PC_LANG_ID,0) PC_LANG_ID
from DICO_DESCRIPTION DES,
     DIC_ADDRESS_TYPE DIC
where  DES.DIT_TABLE = 'DIC_ADDRESS_TYPE'
   and DES.DIT_CODE(+) = DIC.DIC_ADDRESS_TYPE_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DIC_COMMUNICATION_TYPE_ISAG" ("DIC_COMMUNICATION_TYPE_ID", "DIT_DESCR", "PC_LANG_ID") AS
  select DIC.DIC_COMMUNICATION_TYPE_ID,
       nvl(DES.DIT_DESCR,DIC.DCO_DESCR) DIT_DESCR,
       nvl(DES.PC_LANG_ID,0) PC_LANG_ID
from DICO_DESCRIPTION DES,
     DIC_COMMUNICATION_TYPE DIC
where  DES.DIT_TABLE = 'DIC_COMMUNICATION_TYPE'
   and DES.DIT_CODE(+) = DIC.DIC_COMMUNICATION_TYPE_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DIC_PERSON_POLITNESS_ISAG" ("DIC_PERSON_POLITNESS_ID", "DIT_DESCR", "PC_LANG_ID") AS
  select DIC.DIC_PERSON_POLITNESS_ID,
       NVL(DES.DIT_DESCR,DIC.DPO_DESCR) DIT_DESCR,
       NVL(DES.PC_LANG_ID,0) PC_LANG_ID
from DICO_DESCRIPTION DES,
     DIC_PERSON_POLITNESS DIC
where DES.DIT_TABLE = 'DIC_PERSON_POLITNESS'
  and DES.DIT_CODE(+) = DIC.DIC_PERSON_POLITNESS_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_CAN_POSITION" ("GCO_GOOD_ID", "DMT_NUMBER", "DMT_DATE_VALUE", "YEAR", "MONTH", "WEEK", "POS_FINAL_QUANTITY", "DIC_UNIT_OF_MEASURE_ID", "POS_UNIT_COST_PRICE", "POS_NET_VALUE_EXCL_B", "C_GAUGE_TITLE") AS
  SELECT
  POS.GCO_GOOD_ID,
  DOC.DMT_NUMBER,
  DOC.DMT_DATE_VALUE,
  to_char(DOC.DMT_DATE_VALUE,'YYYY') ANNEE,
  to_char(DOC.DMT_DATE_VALUE,'MM') MOIS,
  to_char(DOC.DMT_DATE_VALUE,'WW') WEEK,
  POS.POS_FINAL_QUANTITY,
  POS.DIC_UNIT_OF_MEASURE_ID,
  POS.POS_UNIT_COST_PRICE,
  POS.POS_NET_VALUE_EXCL_B,
  GAU.C_GAUGE_TITLE
FROM
  DOC_DOCUMENT  DOC,
  DOC_POSITION POS,
  DOC_GAUGE_STRUCTURED GAU
WHERE
  DOC.DOC_DOCUMENT_ID=POS.DOC_DOCUMENT_ID AND
  DOC.DOC_GAUGE_ID=GAU.DOC_GAUGE_ID AND
  (GAU.C_GAUGE_TITLE = '8' OR GAU.C_GAUGE_TITLE = '9' OR GAU.C_GAUGE_TITLE = '30')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_COMPARE_PROV" ("ACTION", "GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPR_PROVISORY_INPUT", "SPR_PROVISORY_OUTPUT", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT") AS
  (select "ACTION","GCO_GOOD_ID","STM_LOCATION_ID","PDE_CHARACTERIZATION_VALUE_1","PDE_CHARACTERIZATION_VALUE_2","PDE_CHARACTERIZATION_VALUE_3","PDE_CHARACTERIZATION_VALUE_4","PDE_CHARACTERIZATION_VALUE_5","GCO_CHARACTERIZATION_ID","GCO_GCO_CHARACTERIZATION_ID","GCO2_GCO_CHARACTERIZATION_ID","GCO3_GCO_CHARACTERIZATION_ID","GCO4_GCO_CHARACTERIZATION_ID","SPR_PROVISORY_INPUT","SPR_PROVISORY_OUTPUT","SPO_PROVISORY_INPUT","SPO_PROVISORY_OUTPUT"
     from V_DOC_PROV_TO_ADD
   union all
   select "ACTION","GCO_GOOD_ID","STM_LOCATION_ID","PDE_CHARACTERIZATION_VALUE_1","PDE_CHARACTERIZATION_VALUE_2","PDE_CHARACTERIZATION_VALUE_3","PDE_CHARACTERIZATION_VALUE_4","PDE_CHARACTERIZATION_VALUE_5","GCO_CHARACTERIZATION_ID","GCO_GCO_CHARACTERIZATION_ID","GCO2_GCO_CHARACTERIZATION_ID","GCO3_GCO_CHARACTERIZATION_ID","GCO4_GCO_CHARACTERIZATION_ID","SPR_PROVISORY_INPUT","SPR_PROVISORY_OUTPUT","SPO_PROVISORY_INPUT","SPO_PROVISORY_OUTPUT"
     from V_DOC_PROV_TO_UPDATE
   union all
   select "ACTION","GCO_GOOD_ID","STM_LOCATION_ID","SPO_CHARACTERIZATION_VALUE_1","SPO_CHARACTERIZATION_VALUE_2","SPO_CHARACTERIZATION_VALUE_3","SPO_CHARACTERIZATION_VALUE_4","SPO_CHARACTERIZATION_VALUE_5","GCO_CHARACTERIZATION_ID","GCO_GCO_CHARACTERIZATION_ID","GCO2_GCO_CHARACTERIZATION_ID","GCO3_GCO_CHARACTERIZATION_ID","GCO4_GCO_CHARACTERIZATION_ID","SPR_PROVISORY_INPUT","SPR_PROVISORY_OUTPUT","SPO_PROVISORY_INPUT","SPO_PROVISORY_OUTPUT"
     from V_DOC_PROV_TO_DELETE)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_DOCUMENT" ("DOC_DOCUMENT_ID", "PAC_THIRD_ID", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "DIC_GAUGE_TYPE_DOC_ID", "DMT_NUMBER", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_REFERENCE", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DMT_DATE_DOCUMENT", "DMT_DATE_PARTNER_DOCUMENT", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "DOC_FOOT_ID", "FOO_FOOT_TEXT", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_B", "FOO_GOOD_TOT_AMOUNT_EX_E", "FOO_GOOD_TOT_AMOUNT_EX_B", "FOO_TOTAL_VAT_AMOUNT", "FOO_TOT_VAT_AMOUNT_E", "FOO_TOT_VAT_AMOUNT_B", "FOO_TOT_VAT_AMOUNT_V", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_CHARGE_TOT_AMOUNT_E", "FOO_CHARGE_TOT_AMOUNT_B", "FOO_CHARG_TOT_AMOUNT_EX_E", "FOO_CHARG_TOT_AMOUNT_EX_B", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_DISCOUNT_TOT_AMOUNT_E", "FOO_DISCOUNT_TOT_AMOUNT_B", "FOO_DISC_TOT_AMOUNT_EX_E", "FOO_DISC_TOT_AMOUNT_EX_B", "FOO_COST_TOTAL_AMOUNT", "FOO_COST_TOT_AMOUNT_E", "FOO_COST_TOT_AMOUNT_B", "FOO_COST_TOT_AMOUNT_EX_E", "FOO_COST_TOT_AMOUNT_EX_B", "FOO_DOC_TOT_AMT_COR_B", "DOC_POSITION_COR_ID", "FOO_PAID_AMOUNT", "FOO_PAID_AMOUNT_EUR", "FOO_PAID_AMOUNT_B", "FOO_PAID_BALANCED_AMOUNT", "FOO_RECEIVED_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "FOO_MODIFY_RATE", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "PCO_DESCR", "C_TEXT_TYPE", "DIC_PC_THEME_ID", "APH_CODE", "DOC_POSITION_ID", "GCO_GOOD_ID", "POS_NUMBER", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "DIC_UNIT_OF_MEASURE_ID", "POS_GENERATE_MOVEMENT", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_VAT_AMOUNT_E", "POS_VAT_AMOUNT_V", "POS_GROSS_UNIT_VALUE", "POS_GROSS_UNIT_VALUE2", "POS_GROSS_UNIT_VALUE_INCL", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_GROSS_VALUE", "POS_GROSS_VALUE_E", "POS_GROSS_VALUE_B", "POS_GROSS_VALUE_V", "POS_GROSS_VALUE_INCL", "POS_GROSS_VALUE_INCL_E", "POS_GROSS_VALUE_INCL_B", "POS_GROSS_VALUE_INCL_V", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_E", "POS_NET_VALUE_EXCL_B", "POS_NET_VALUE_EXCL_V", "POS_NET_VALUE_INCL", "POS_NET_VALUE_INCL_E", "POS_NET_VALUE_INCL_B", "POS_NET_VALUE_INCL_V", "POS_BASIS_QUANTITY", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY", "POS_FINAL_QUANTITY_SU", "POS_BALANCE_QUANTITY", "POS_VALUE_QUANTITY", "POS_BALANCE_QTY_VALUE", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "POS_REF_UNIT_VALUE", "POS_RATE_FACTOR", "POS_STOCK_OUTAGE", "POS_UNIT_COST_PRICE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "PAC_REPRESENTATIVE_ID", "PAC_REPR_ACI_ID", "PAC_REPR_DELIVERY_ID", "POS_MODIFY_RATE", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "C_POS_DELIVERY_TYP", "POS_BALANCED", "POS_IMF_TEXT_1", "POS_IMF_TEXT_2", "POS_IMF_TEXT_3", "POS_IMF_TEXT_4", "POS_IMF_TEXT_5", "POS_IMF_NUMBER_2", "POS_IMF_NUMBER_3", "POS_IMF_NUMBER_4", "POS_IMF_NUMBER_5", "POS_IMF_DATE_1", "POS_IMF_DATE_2", "POS_IMF_DATE_3", "POS_IMF_DATE_4", "POS_IMF_DATE_5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "POS_PARTNER_NUMBER", "POS_PARTNER_REFERENCE", "POS_DATE_PARTNER_DOCUMENT", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "CURRENCY", "GAG_FUNCTION1", "GAG_NAME1", "GAG_NAME2", "GAG_FUNCTION2", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "TAX_RATE", "LANID", "REP_DESCR", "SEN_DESCR") AS
  select DOC_DOCUMENT.DOC_DOCUMENT_ID
       , DOC_DOCUMENT.PAC_THIRD_ID
       , DOC_DOCUMENT.PAC_THIRD_ACI_ID
       , DOC_DOCUMENT.PAC_THIRD_DELIVERY_ID
       , DOC_DOCUMENT.PAC_THIRD_TARIFF_ID
       , DOC_GAUGE.DIC_GAUGE_TYPE_DOC_ID
       , DOC_DOCUMENT.DMT_NUMBER
       , DOC_DOCUMENT.DMT_PARTNER_NUMBER
       , DOC_DOCUMENT.DMT_PARTNER_REFERENCE
       , DOC_DOCUMENT.DMT_REFERENCE
       , DOC_DOCUMENT.DMT_HEADING_TEXT
       , DOC_DOCUMENT.DMT_DOCUMENT_TEXT
       , DOC_DOCUMENT.DMT_DATE_DOCUMENT
       , DOC_DOCUMENT.DMT_DATE_PARTNER_DOCUMENT
       , DOC_DOCUMENT.DMT_ADDRESS1
       , DOC_DOCUMENT.DMT_FORMAT_CITY1
       , DOC_FOOT.DOC_FOOT_ID
       , DOC_FOOT.FOO_FOOT_TEXT
       , DOC_FOOT.FOO_DOCUMENT_TOTAL_AMOUNT
       , DOC_FOOT.FOO_DOCUMENT_TOT_AMOUNT_E
       , DOC_FOOT.FOO_DOCUMENT_TOT_AMOUNT_B
       , DOC_FOOT.FOO_GOOD_TOTAL_AMOUNT
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_E
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_B
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_TOTAL_VAT_AMOUNT
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_E
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_B
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_V
       , DOC_FOOT.FOO_CHARGE_TOTAL_AMOUNT
       , DOC_FOOT.FOO_CHARGE_TOT_AMOUNT_E
       , DOC_FOOT.FOO_CHARGE_TOT_AMOUNT_B
       , DOC_FOOT.FOO_CHARG_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_CHARG_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_DISCOUNT_TOTAL_AMOUNT
       , DOC_FOOT.FOO_DISCOUNT_TOT_AMOUNT_E
       , DOC_FOOT.FOO_DISCOUNT_TOT_AMOUNT_B
       , DOC_FOOT.FOO_DISC_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_DISC_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_COST_TOTAL_AMOUNT
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_E
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_B
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_DOC_TOT_AMT_COR_B
       , DOC_FOOT.DOC_POSITION_ID DOC_POSITION_COR_ID
       , DOC_FOOT.FOO_PAID_AMOUNT
       , DOC_FOOT.FOO_PAID_AMOUNT_EUR
       , DOC_FOOT.FOO_PAID_AMOUNT_B
       , DOC_FOOT.FOO_PAID_BALANCED_AMOUNT
       , DOC_FOOT.FOO_RECEIVED_AMOUNT
       , DOC_FOOT.FOO_RETURN_AMOUNT
       , DOC_FOOT.FOO_PACKAGING
       , DOC_FOOT.FOO_MARKING
       , DOC_FOOT.FOO_MEASURE
       , DOC_FOOT.FOO_MODIFY_RATE
       , DOC_FOOT.FOO_TOTAL_NET_WEIGHT_MEAS
       , DOC_FOOT.FOO_TOTAL_GROSS_WEIGHT_MEAS
       , PAC_PAYMENT_CONDITION.PCO_DESCR
       , PC_APPLTXT.C_TEXT_TYPE
       , PC_APPLTXT.DIC_PC_THEME_ID
       , PC_APPLTXT.APH_CODE
       , DOC_POSITION.DOC_POSITION_ID
       , DOC_POSITION.GCO_GOOD_ID
       , DOC_POSITION.POS_NUMBER
       , DOC_POSITION.POS_REFERENCE
       , DOC_POSITION.POS_SHORT_DESCRIPTION
       , DOC_POSITION.POS_LONG_DESCRIPTION
       , DOC_POSITION.POS_FREE_DESCRIPTION
       , DOC_POSITION.POS_BODY_TEXT
       , DOC_POSITION.DIC_UNIT_OF_MEASURE_ID
       , DOC_POSITION.POS_GENERATE_MOVEMENT
       , DOC_POSITION.POS_DISCOUNT_AMOUNT
       , DOC_POSITION.POS_CHARGE_AMOUNT
       , DOC_POSITION.POS_VAT_AMOUNT
       , DOC_POSITION.POS_VAT_BASE_AMOUNT
       , DOC_POSITION.POS_VAT_AMOUNT_E
       , DOC_POSITION.POS_VAT_AMOUNT_V
       , DOC_POSITION.POS_GROSS_UNIT_VALUE
       , DOC_POSITION.POS_GROSS_UNIT_VALUE2
       , DOC_POSITION.POS_GROSS_UNIT_VALUE_INCL
       , DOC_POSITION.POS_NET_UNIT_VALUE
       , DOC_POSITION.POS_NET_UNIT_VALUE_INCL
       , DOC_POSITION.POS_GROSS_VALUE
       , DOC_POSITION.POS_GROSS_VALUE_E
       , DOC_POSITION.POS_GROSS_VALUE_B
       , DOC_POSITION.POS_GROSS_VALUE_V
       , DOC_POSITION.POS_GROSS_VALUE_INCL
       , DOC_POSITION.POS_GROSS_VALUE_INCL_E
       , DOC_POSITION.POS_GROSS_VALUE_INCL_B
       , DOC_POSITION.POS_GROSS_VALUE_INCL_V
       , DOC_POSITION.POS_NET_VALUE_EXCL
       , DOC_POSITION.POS_NET_VALUE_EXCL_E
       , DOC_POSITION.POS_NET_VALUE_EXCL_B
       , DOC_POSITION.POS_NET_VALUE_EXCL_V
       , DOC_POSITION.POS_NET_VALUE_INCL
       , DOC_POSITION.POS_NET_VALUE_INCL_E
       , DOC_POSITION.POS_NET_VALUE_INCL_B
       , DOC_POSITION.POS_NET_VALUE_INCL_V
       , DOC_POSITION.POS_BASIS_QUANTITY
       , DOC_POSITION.POS_BASIS_QUANTITY_SU
       , DOC_POSITION.POS_INTERMEDIATE_QUANTITY
       , DOC_POSITION.POS_INTERMEDIATE_QUANTITY_SU
       , DOC_POSITION.POS_FINAL_QUANTITY
       , DOC_POSITION.POS_FINAL_QUANTITY_SU
       , DOC_POSITION.POS_BALANCE_QUANTITY
       , DOC_POSITION.POS_VALUE_QUANTITY
       , DOC_POSITION.POS_BALANCE_QTY_VALUE
       , DOC_POSITION.POS_NET_WEIGHT
       , DOC_POSITION.POS_GROSS_WEIGHT
       , DOC_POSITION.POS_REF_UNIT_VALUE
       , DOC_POSITION.POS_RATE_FACTOR
       , DOC_POSITION.POS_STOCK_OUTAGE
       , DOC_POSITION.POS_UNIT_COST_PRICE
       , DOC_POSITION.DIC_POS_FREE_TABLE_1_ID
       , DOC_POSITION.DIC_POS_FREE_TABLE_2_ID
       , DOC_POSITION.DIC_POS_FREE_TABLE_3_ID
       , DOC_POSITION.POS_DECIMAL_1
       , DOC_POSITION.POS_DECIMAL_2
       , DOC_POSITION.POS_DECIMAL_3
       , DOC_POSITION.POS_TEXT_1
       , DOC_POSITION.POS_TEXT_2
       , DOC_POSITION.POS_TEXT_3
       , DOC_POSITION.POS_DISCOUNT_UNIT_VALUE
       , DOC_POSITION.POS_DISCOUNT_RATE
       , DOC_POSITION.PAC_REPRESENTATIVE_ID
       , DOC_POSITION.PAC_REPR_ACI_ID
       , DOC_POSITION.PAC_REPR_DELIVERY_ID
       , DOC_POSITION.POS_MODIFY_RATE
       , DOC_POSITION.POS_NET_TARIFF
       , DOC_POSITION.POS_SPECIAL_TARIFF
       , DOC_POSITION.POS_FLAT_RATE
       , DOC_POSITION.C_POS_DELIVERY_TYP
       , DOC_POSITION.POS_BALANCED
       , DOC_POSITION.POS_IMF_TEXT_1
       , DOC_POSITION.POS_IMF_TEXT_2
       , DOC_POSITION.POS_IMF_TEXT_3
       , DOC_POSITION.POS_IMF_TEXT_4
       , DOC_POSITION.POS_IMF_TEXT_5
       , DOC_POSITION.POS_IMF_NUMBER_2
       , DOC_POSITION.POS_IMF_NUMBER_3
       , DOC_POSITION.POS_IMF_NUMBER_4
       , DOC_POSITION.POS_IMF_NUMBER_5
       , DOC_POSITION.POS_IMF_DATE_1
       , DOC_POSITION.POS_IMF_DATE_2
       , DOC_POSITION.POS_IMF_DATE_3
       , DOC_POSITION.POS_IMF_DATE_4
       , DOC_POSITION.POS_IMF_DATE_5
       , DOC_POSITION.DIC_IMP_FREE1_ID
       , DOC_POSITION.DIC_IMP_FREE2_ID
       , DOC_POSITION.DIC_IMP_FREE3_ID
       , DOC_POSITION.DIC_IMP_FREE4_ID
       , DOC_POSITION.DIC_IMP_FREE5_ID
       , DOC_POSITION.POS_PARTNER_NUMBER
       , DOC_POSITION.POS_PARTNER_REFERENCE
       , DOC_POSITION.POS_DATE_PARTNER_DOCUMENT
       , DOC_POSITION.POS_DATE_1
       , DOC_POSITION.POS_DATE_2
       , DOC_POSITION.POS_DATE_3
       , PC_CURR.CURRENCY
       , DOC_GAUGE_SIGNATORY.GAG_FUNCTION GAG_FUNCTION1
       , DOC_GAUGE_SIGNATORY.GAG_NAME GAG_NAME1
       , DOC_DOC_GAUGE_SIGNATORY.GAG_NAME GAG_NAME2
       , DOC_DOC_GAUGE_SIGNATORY.GAG_FUNCTION GAG_FUNCTION2
       , PAC_PERSON.PER_NAME
       , PAC_PERSON.PER_FORENAME
       , PAC_PERSON.PER_ACTIVITY
       , ACS_TAX_CODE.TAX_RATE
       , PC_LANG.LANID
       , PAC_REPRESENTATIVE.REP_DESCR
       , PAC_SENDING_CONDITION_TEXT.SEN_DESCR
    from DOC_DOCUMENT DOC_DOCUMENT
       , DOC_FOOT DOC_FOOT
       , DOC_GAUGE DOC_GAUGE
       , PAC_ADDRESS PAC_ADDRESS
       , PAC_PAYMENT_CONDITION PAC_PAYMENT_CONDITION
       , PCS.PC_APPLTXT PC_APPLTXT
       , DOC_POSITION DOC_POSITION
       , ACS_FINANCIAL_CURRENCY ACS_FINANCIAL_CURRENCY
       , PCS.PC_CURR PC_CURR
       , DOC_GAUGE_SIGNATORY DOC_GAUGE_SIGNATORY
       , DOC_GAUGE_SIGNATORY DOC_DOC_GAUGE_SIGNATORY
       , PAC_PERSON PAC_PERSON
       , ACS_TAX_CODE ACS_TAX_CODE
       , PCS.PC_LANG PC_LANG
       , PAC_REPRESENTATIVE
       , PAC_SENDING_CONDITION_TEXT
   where DOC_DOCUMENT.DOC_DOCUMENT_ID = DOC_FOOT.DOC_DOCUMENT_ID(+)
     and DOC_DOCUMENT.DOC_GAUGE_ID = DOC_GAUGE.DOC_GAUGE_ID
     and DOC_DOCUMENT.PAC_ADDRESS_ID = PAC_ADDRESS.PAC_ADDRESS_ID(+)
     and DOC_DOCUMENT.PAC_PAYMENT_CONDITION_ID = PAC_PAYMENT_CONDITION.PAC_PAYMENT_CONDITION_ID(+)
     and PAC_PAYMENT_CONDITION.PC_APPLTXT_ID = PC_APPLTXT.PC_APPLTXT_ID(+)
     and DOC_DOCUMENT.DOC_DOCUMENT_ID = DOC_POSITION.DOC_DOCUMENT_ID(+)
     and DOC_DOCUMENT.ACS_FINANCIAL_CURRENCY_ID = ACS_FINANCIAL_CURRENCY.ACS_FINANCIAL_CURRENCY_ID(+)
     and ACS_FINANCIAL_CURRENCY.PC_CURR_ID = PC_CURR.PC_CURR_ID(+)
     and DOC_GAUGE.DOC_GAUGE_SIGNATORY_ID = DOC_GAUGE_SIGNATORY.DOC_GAUGE_SIGNATORY_ID(+)
     and DOC_GAUGE.DOC_DOC_GAUGE_SIGNATORY_ID = DOC_DOC_GAUGE_SIGNATORY.DOC_GAUGE_SIGNATORY_ID(+)
     and PAC_ADDRESS.PAC_PERSON_ID = PAC_PERSON.PAC_PERSON_ID(+)
     and DOC_POSITION.ACS_TAX_CODE_ID = ACS_TAX_CODE.ACS_TAX_CODE_ID(+)
     and DOC_DOCUMENT.PC_LANG_ID = PC_LANG.PC_LANG_ID(+)
     and DOC_DOCUMENT.PAC_REPRESENTATIVE_ID = PAC_REPRESENTATIVE.PAC_REPRESENTATIVE_ID(+)
     and DOC_DOCUMENT.PAC_SENDING_CONDITION_ID = PAC_SENDING_CONDITION_TEXT.PAC_SENDING_CONDITION_ID(+)
     and DOC_DOCUMENT.PC_LANG_ID = PAC_SENDING_CONDITION_TEXT.PC_LANG_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_DOCUMENT_DELAY" ("V_GAUGE", "V_NAME", "V_PAYS", "V_ACT", "V_ARE", "V_DOC", "V_MOI", "V_REF", "V_CAT", "V_LIGNE", "V_MODEL", "V_FAMILY", "V_GRP", "V_QTE_B", "V_QTE_D", "V_QTE_S", "V_J_REEL", "V_J_RETARD") AS
  SELECT
  GAU.GAU_DESCRIBE V_GAUGE,
  PER.PER_NAME V_NAME,
  CNY.CNTNAME V_PAYS,
  DAC.ACT_DESCR V_ACT,
  DAE.ARE_DESCR V_ARE,
  DOC_DEC.DMT_NUMBER V_DOC,
  TO_CHAR(DOC_DEC.DMT_DATE_DOCUMENT,'YYYY.MM') V_MOI,
  GCO.GOO_MAJOR_REFERENCE V_REF,
  GCA.GCO_GOOD_CATEGORY_WORDING V_CAT,
  LIN.DIC_GOOD_LINE_WORDING V_LIGNE,
  MOD.DIC_GOOD_MODEL_WORDING V_MODEL,
  FAM.DIC_GOOD_FAMILY_WORDING V_FAMILY,
  GRP.DIC_GOOD_GROUP_WORDING V_GRP,
  DET_DEC.PDE_BASIS_QUANTITY V_QTE_B,
  DECODE(DET.PDE_BASIS_QUANTITY,NULL,0,DET.PDE_BASIS_QUANTITY) V_QTE_D,
  DET_DEC.PDE_BALANCE_QUANTITY V_QTE_S,
  TRUNC(DECODE(DOC.DMT_DATE_DOCUMENT,NULL,SYSDATE+1,DOC.DMT_DATE_DOCUMENT)-DOC_DEC.DMT_DATE_DOCUMENT) V_J_REEL,
  TRUNC(DECODE(DOC.DMT_DATE_DOCUMENT,NULL,SYSDATE+1,DOC.DMT_DATE_DOCUMENT)-DET_DEC.PDE_BASIS_DELAY) V_J_RETARD
FROM
  PAC_PERSON PER,
  PAC_ADDRESS ADR,
  PCS.PC_CNTRY CNY,
  PAC_THIRD PAT,
  DIC_THIRD_ACTIVITY DAC,
  DIC_THIRD_AREA DAE,
  DOC_DOCUMENT DOC,
  DOC_DOCUMENT DOC_DEC,
  DOC_POSITION_DETAIL DET,
  DOC_POSITION_DETAIL DET_DEC,
  DOC_POSITION POS,
  GCO_GOOD GCO,
  GCO_GOOD_CATEGORY GCA,
  DIC_GOOD_LINE LIN,
  DIC_GOOD_MODEL MOD,
  DIC_GOOD_GROUP GRP,
  DIC_GOOD_FAMILY FAM,
  DOC_GAUGE_STRUCTURED GST_DEC,
  DOC_GAUGE GAU,
  (SELECT
     HIS.DOC_POSITION_DETAIL_ID DET_ID,COUNT(HIS.DOC_POSITION_DETAIL_ID) NB_DELAY,MIN(HIS.DHI_BASIS_DELAY) MIN_DELAY
   FROM
     DOC_DELAY_HISTORY HIS
   GROUP BY   HIS.DOC_POSITION_DETAIL_ID) HDE
WHERE
  PER.PAC_PERSON_ID=ADR.PAC_PERSON_ID AND
  PER.PAC_PERSON_ID=PAT.PAC_THIRD_ID AND
  ADR.PAC_ADDRESS_ID=DOC_DEC.PAC_ADDRESS_ID AND
  CNY.PC_CNTRY_ID=ADR.PC_CNTRY_ID AND
  PAT.DIC_THIRD_ACTIVITY_ID=DAC.DIC_THIRD_ACTIVITY_ID AND
  PAT.DIC_THIRD_AREA_ID=DAE.DIC_THIRD_AREA_ID AND
  DOC.DOC_DOCUMENT_ID (+) =DET.DOC_DOCUMENT_ID AND
  DET_DEC.DOC_POSITION_DETAIL_ID=DET.DOC_DOC_POSITION_DETAIL_ID (+) AND
  DOC_DEC.DOC_DOCUMENT_ID=DET_DEC.DOC_DOCUMENT_ID AND
  GST_DEC.DOC_GAUGE_ID=DOC_DEC.DOC_GAUGE_ID AND
  GST_DEC.DOC_GAUGE_ID=GAU.DOC_GAUGE_ID AND
  DET_DEC.DOC_POSITION_DETAIL_ID = HDE.DET_ID (+) AND
  POS.DOC_POSITION_ID = DET_DEC.DOC_POSITION_ID AND
  GCO.GCO_GOOD_ID=POS.GCO_GOOD_ID AND
  GCA.GCO_GOOD_CATEGORY_ID=GCO.GCO_GOOD_CATEGORY_ID AND
  GCO.DIC_GOOD_LINE_ID = LIN.DIC_GOOD_LINE_ID (+) AND
  GCO.DIC_GOOD_MODEL_ID =MOD.DIC_GOOD_MODEL_ID (+) AND
  GCO.DIC_GOOD_GROUP_ID = GRP.DIC_GOOD_GROUP_ID (+) AND
  GCO.DIC_GOOD_FAMILY_ID = FAM.DIC_GOOD_FAMILY_ID (+) AND
  (GST_DEC.C_GAUGE_TITLE=1 OR GST_DEC.C_GAUGE_TITLE=6) AND
  DET_DEC.PDE_BASIS_DELAY<=SYSDATE




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_DOCUMENT_IMPUTATION" ("DOC_POSITION_ID", "C_DOC_POS_STATUS", "DOC_POSITION_CHARGE_ID", "DOC_FOOT_CHARGE_ID", "DOC_DOCUMENT_ID", "DOC_RECORD_ID", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "C_FAM_TRANSACTION_TYP", "FAM_FIXED_ASSETS_ID", "HRM_PERSON_ID", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "POI_AMOUNT", "POI_AMOUNT_B", "POI_AMOUNT_E", "POI_AMOUNT_V", "POI_VAT_AMOUNT", "POI_VAT_AMOUNT_B", "POI_VAT_AMOUNT_E", "POI_VAT_AMOUNT_V", "POI_IMF_NUMBER_1", "POI_IMF_NUMBER_2", "POI_IMF_NUMBER_3", "POI_IMF_NUMBER_4", "POI_IMF_NUMBER_5", "POI_IMF_TEXT_1", "POI_IMF_TEXT_2", "POI_IMF_TEXT_3", "POI_IMF_TEXT_4", "POI_IMF_TEXT_5", "POI_IMF_DATE_1", "POI_IMF_DATE_2", "POI_IMF_DATE_3", "POI_IMF_DATE_4", "POI_IMF_DATE_5", "POI_RATIO", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS") AS
  select nvl(POI.DOC_POSITION_ID, (select PCH.DOC_POSITION_ID
                                     from DOC_POSITION_CHARGE PCH
                                    where PCH.DOC_POSITION_CHARGE_ID = POI.DOC_POSITION_CHARGE_ID) ) DOC_POSITION_ID
       , nvl(nvl( (select POS.C_DOC_POS_STATUS
                     from DOC_POSITION POS
                    where POS.DOC_POSITION_ID = POI.DOC_POSITION_ID)
               , (select POS2.C_DOC_POS_STATUS
                    from DOC_POSITION POS2
                   where POS2.DOC_POSITION_ID = (select PCH.DOC_POSITION_ID
                                                   from DOC_POSITION_CHARGE PCH
                                                  where PCH.DOC_POSITION_CHARGE_ID = POI.DOC_POSITION_CHARGE_ID) )
                )
           , '01'
            ) C_DOC_POS_STATUS
       , POI.DOC_POSITION_CHARGE_ID
       , POI.DOC_FOOT_CHARGE_ID
       , POI.DOC_DOCUMENT_ID
       , POI.DOC_RECORD_ID
       , POI.ACS_PJ_ACCOUNT_ID
       , POI.ACS_PF_ACCOUNT_ID
       , POI.ACS_FINANCIAL_ACCOUNT_ID
       , POI.DIC_IMP_FREE1_ID
       , POI.DIC_IMP_FREE2_ID
       , POI.DIC_IMP_FREE3_ID
       , POI.DIC_IMP_FREE4_ID
       , POI.DIC_IMP_FREE5_ID
       , POI.C_FAM_TRANSACTION_TYP
       , POI.FAM_FIXED_ASSETS_ID
       , POI.HRM_PERSON_ID
       , POI.ACS_CDA_ACCOUNT_ID
       , POI.ACS_CPN_ACCOUNT_ID
       , POI.ACS_DIVISION_ACCOUNT_ID
       , POI.POI_AMOUNT
       , POI.POI_AMOUNT_B
       , POI.POI_AMOUNT_E
       , POI.POI_AMOUNT_V
       , POI.POI_VAT_AMOUNT
       , POI.POI_VAT_AMOUNT_B
       , POI.POI_VAT_AMOUNT_E
       , POI.POI_VAT_AMOUNT_V
       , POI.POI_IMF_NUMBER_1
       , POI.POI_IMF_NUMBER_2
       , POI.POI_IMF_NUMBER_3
       , POI.POI_IMF_NUMBER_4
       , POI.POI_IMF_NUMBER_5
       , POI.POI_IMF_TEXT_1
       , POI.POI_IMF_TEXT_2
       , POI.POI_IMF_TEXT_3
       , POI.POI_IMF_TEXT_4
       , POI.POI_IMF_TEXT_5
       , POI.POI_IMF_DATE_1
       , POI.POI_IMF_DATE_2
       , POI.POI_IMF_DATE_3
       , POI.POI_IMF_DATE_4
       , POI.POI_IMF_DATE_5
       , POI.POI_RATIO
       , POI.A_CONFIRM
       , POI.A_DATECRE
       , POI.A_DATEMOD
       , POI.A_IDCRE
       , POI.A_IDMOD
       , POI.A_RECLEVEL
       , POI.A_RECSTATUS
    from DOC_POSITION_IMPUTATION POI   --, DOC_POSITION POS, DOC_POSITION_CHARGE PCH, DOC_POSITION POS2
   where (   POI.DOC_POSITION_ID is not null
          or POI.DOC_POSITION_CHARGE_ID is not null
          or POI.DOC_FOOT_CHARGE_ID is not null)
--     and POS.DOC_POSITION_ID (+) = POI.DOC_POSITION_ID
--     and PCH.DOC_POSITION_CHARGE_ID (+) = POI.DOC_POSITION_CHARGE_ID
--     and POS2.DOC_POSITION_ID (+) = PCH.DOC_POSITION_ID
  union
  select DOC_POSITION_ID
       , C_DOC_POS_STATUS
       , null DOC_POSITION_CHARGE_ID
       , null DOC_FOOT_CHARGE_ID
       , DOC_DOCUMENT_ID
       , nvl(DOC_DOC_RECORD_ID, DOC_RECORD_ID) DOC_RECORD_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , C_FAM_TRANSACTION_TYP
       , FAM_FIXED_ASSETS_ID
       , HRM_PERSON_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_DIVISION_ACCOUNT_ID
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE, POS_GROSS_VALUE_INCL) POS_AMOUNT
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE_B, POS_GROSS_VALUE_INCL_B) POS_AMOUNT_B
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE_E, POS_GROSS_VALUE_INCL_E) POS_AMOUNT_E
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE_V, POS_GROSS_VALUE_INCL_V) POS_AMOUNT_V
       , POS_VAT_AMOUNT
       , POS_VAT_BASE_AMOUNT
       , POS_VAT_AMOUNT_E
       , POS_VAT_AMOUNT_V
       , POS_NUMBER POS_IMF_NUMBER_1
       , POS_IMF_NUMBER_2
       , POS_IMF_NUMBER_3
       , POS_IMF_NUMBER_4
       , POS_IMF_NUMBER_5
       , POS_IMF_TEXT_1
       , POS_IMF_TEXT_2
       , POS_IMF_TEXT_3
       , POS_IMF_TEXT_4
       , POS_IMF_TEXT_5
       , POS_IMF_DATE_1
       , POS_IMF_DATE_2
       , POS_IMF_DATE_3
       , POS_IMF_DATE_4
       , POS_IMF_DATE_5
       , 100 POI_RATIO
       , A_CONFIRM
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
    from DOC_POSITION
   where not exists(select DOC_POSITION_IMPUTATION_ID
                      from DOC_POSITION_IMPUTATION
                     where DOC_POSITION_ID = DOC_POSITION.DOC_POSITION_ID)
  union
  select PCH.DOC_POSITION_ID
       , POS.C_DOC_POS_STATUS
       , PCH.DOC_POSITION_CHARGE_ID
       , null DOC_FOOT_CHARGE_ID
       , PCH.DOC_DOCUMENT_ID
       , nvl(POS.DOC_DOC_RECORD_ID, POS.DOC_RECORD_ID) DOC_RECORD_ID
       , PCH.ACS_PJ_ACCOUNT_ID
       , PCH.ACS_PF_ACCOUNT_ID
       , PCH.ACS_FINANCIAL_ACCOUNT_ID
       , PCH.DIC_IMP_FREE1_ID
       , PCH.DIC_IMP_FREE2_ID
       , PCH.DIC_IMP_FREE3_ID
       , PCH.DIC_IMP_FREE4_ID
       , PCH.DIC_IMP_FREE5_ID
       , PCH.C_FAM_TRANSACTION_TYP
       , PCH.FAM_FIXED_ASSETS_ID
       , PCH.HRM_PERSON_ID
       , PCH.ACS_CDA_ACCOUNT_ID
       , PCH.ACS_CPN_ACCOUNT_ID
       , PCH.ACS_DIVISION_ACCOUNT_ID
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * PCH_AMOUNT
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * PCH_AMOUNT_B
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * PCH_AMOUNT_E
       , 0 PCH_AMOUNT_V
       , 0 POI_VAT_AMOUNT
       , 0 POI_VAT_BASE_AMOUNT
       , 0 POI_VAT_AMOUNT_E
       , 0 POI_VAT_AMOUNT_V
       , PCH_IMP_NUMBER_1
       , PCH_IMP_NUMBER_2
       , PCH_IMP_NUMBER_3
       , PCH_IMP_NUMBER_4
       , PCH_IMP_NUMBER_5
       , PCH_IMP_TEXT_1
       , PCH_IMP_TEXT_2
       , PCH_IMP_TEXT_3
       , PCH_IMP_TEXT_4
       , PCH_IMP_TEXT_5
       , PCH_IMP_DATE_1
       , PCH_IMP_DATE_2
       , PCH_IMP_DATE_3
       , PCH_IMP_DATE_4
       , PCH_IMP_DATE_5
       , 100 POI_RATIO
       , PCH.A_CONFIRM
       , PCH.A_DATECRE
       , PCH.A_DATEMOD
       , PCH.A_IDCRE
       , PCH.A_IDMOD
       , PCH.A_RECLEVEL
       , PCH.A_RECSTATUS
    from DOC_POSITION_CHARGE PCH
       , DOC_POSITION POS
   where not exists(select DOC_POSITION_IMPUTATION_ID
                      from DOC_POSITION_IMPUTATION
                     where DOC_POSITION_CHARGE_ID = PCH.DOC_POSITION_CHARGE_ID)
     and POS.DOC_POSITION_ID = PCH.DOC_POSITION_ID
  union
  select null DOC_POSITION_ID
       , '01' C_DOC_POS_STATUS
       , null DOC_POSITION_CHARGE_ID
       , FCH.DOC_FOOT_CHARGE_ID
       , FCH.DOC_FOOT_ID DOC_DOCUMENT_ID
       , DMT.DOC_RECORD_ID
       , FCH.ACS_PJ_ACCOUNT_ID
       , FCH.ACS_PF_ACCOUNT_ID
       , FCH.ACS_FINANCIAL_ACCOUNT_ID
       , FCH.DIC_IMP_FREE1_ID
       , FCH.DIC_IMP_FREE2_ID
       , FCH.DIC_IMP_FREE3_ID
       , FCH.DIC_IMP_FREE4_ID
       , FCH.DIC_IMP_FREE5_ID
       , FCH.C_FAM_TRANSACTION_TYP
       , FCH.FAM_FIXED_ASSETS_ID
       , FCH.HRM_PERSON_ID
       , FCH.ACS_CDA_ACCOUNT_ID
       , FCH.ACS_CPN_ACCOUNT_ID
       , FCH.ACS_DIVISION_ACCOUNT_ID
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * decode(DOC_FUNCTIONS.isDocumentTTC(DOC_FOOT_ID), 1, FCH_EXCL_AMOUNT, FCH_INCL_AMOUNT) POS_AMOUNT
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * decode(DOC_FUNCTIONS.isDocumentTTC(DOC_FOOT_ID), 1, FCH_EXCL_AMOUNT_B, FCH_INCL_AMOUNT_B) POS_AMOUNT_B
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * decode(DOC_FUNCTIONS.isDocumentTTC(DOC_FOOT_ID), 1, FCH_EXCL_AMOUNT_E, FCH_INCL_AMOUNT_E) POS_AMOUNT_E
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * decode(DOC_FUNCTIONS.isDocumentTTC(DOC_FOOT_ID), 1, FCH_EXCL_AMOUNT_V, FCH_INCL_AMOUNT_V) POS_AMOUNT_V
       , FCH_VAT_AMOUNT
       , FCH_VAT_BASE_AMOUNT
       , FCH_VAT_AMOUNT_E
       , FCH_VAT_AMOUNT_V
       , FCH_IMP_NUMBER_1
       , FCH_IMP_NUMBER_2
       , FCH_IMP_NUMBER_3
       , FCH_IMP_NUMBER_4
       , FCH_IMP_NUMBER_5
       , FCH_IMP_TEXT_1
       , FCH_IMP_TEXT_2
       , FCH_IMP_TEXT_3
       , FCH_IMP_TEXT_4
       , FCH_IMP_TEXT_5
       , FCH_IMP_DATE_1
       , FCH_IMP_DATE_2
       , FCH_IMP_DATE_3
       , FCH_IMP_DATE_4
       , FCH_IMP_DATE_5
       , 100 POI_RATIO
       , FCH.A_CONFIRM
       , FCH.A_DATECRE
       , FCH.A_DATEMOD
       , FCH.A_IDCRE
       , FCH.A_IDMOD
       , FCH.A_RECLEVEL
       , FCH.A_RECSTATUS
    from DOC_FOOT_CHARGE FCH
       , DOC_DOCUMENT DMT
   where not exists(select DOC_POSITION_IMPUTATION_ID
                      from DOC_POSITION_IMPUTATION
                     where DOC_FOOT_CHARGE_ID = FCH.DOC_FOOT_CHARGE_ID)
     and DMT.DOC_DOCUMENT_Id = FCH.DOC_FOOT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_DOCUMENT_POSITION" ("DOC_POSITION_DETAIL_ID", "DOC_GAUGE_FLOW_ID", "DOC_POS_DETAIL_FATHERSON_ID", "DOC_POS_DETAIL_ORIGINE_ID", "GCO_CHARACTERIZATION_1_ID", "CHA_CHARACTERIZATION_DESIGN_1", "PDE_CHARACTERIZATION_VALUE_1", "GCO_CHARACTERIZATION_2_ID", "CHA_CHARACTERIZATION_DESIGN_2", "PDE_CHARACTERIZATION_VALUE_2", "GCO_CHARACTERIZATION_3_ID", "CHA_CHARACTERIZATION_DESIGN_3", "PDE_CHARACTERIZATION_VALUE_3", "GCO_CHARACTERIZATION_4_ID", "CHA_CHARACTERIZATION_DESIGN_4", "PDE_CHARACTERIZATION_VALUE_4", "GCO_CHARACTERIZATION_5_ID", "CHA_CHARACTERIZATION_DESIGN_5", "PDE_CHARACTERIZATION_VALUE_5", "STM_STOCK_ID", "STO_DESCRIPTION", "STM_LOCATION_ID", "LOC_DESCRIPTION", "PDE_BASIS_DELAY", "PDE_INTERMEDIATE_DELAY", "PDE_FINAL_DELAY", "PDE_BASIS_QUANTITY", "PDE_INTERMEDIATE_QUANTITY", "PDE_FINAL_QUANTITY", "PDE_BALANCE_QUANTITY", "PDE_BASIS_DELAY_W", "PDE_BASIS_DELAY_M", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_DELAY_M", "PDE_FINAL_DELAY_W", "PDE_FINAL_DELAY_M", "PDE_MOVEMENT_QUANTITY", "PDE_MOVEMENT_VALUE", "DOC_POSITION_ID", "GCO_GOOD_ID", "DOC_RECORD_POS_ID", "PAC_THIRD_POS_ID", "RCO_TITLE_POS", "RCO_DESCRIPTION_POS", "DIC_ACCOUNTABLE_GROUP_POS_ID", "STM_MOVEMENT_KIND_ID", "ACS_TAX_CODE_ID", "ACS_FIN_ACC_POS_ID", "ACS_DIV_ACC_POS_ID", "C_GAUGE_TYPE_POS", "C_DOC_POS_STATUS", "POS_NUMBER", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "POS_GENERATE_MOVEMENT", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_VAT_AMOUNT_E", "POS_VAT_AMOUNT_V", "POS_GROSS_UNIT_VALUE", "POS_GROSS_UNIT_VALUE2", "POS_GROSS_UNIT_VALUE_INCL", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_GROSS_VALUE", "POS_GROSS_VALUE_E", "POS_GROSS_VALUE_B", "POS_GROSS_VALUE_V", "POS_GROSS_VALUE_INCL", "POS_GROSS_VALUE_INCL_E", "POS_GROSS_VALUE_INCL_B", "POS_GROSS_VALUE_INCL_V", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_E", "POS_NET_VALUE_EXCL_B", "POS_NET_VALUE_EXCL_V", "POS_NET_VALUE_INCL", "POS_NET_VALUE_INCL_E", "POS_NET_VALUE_INCL_B", "POS_NET_VALUE_INCL_V", "POS_BASIS_QUANTITY", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY", "POS_FINAL_QUANTITY_SU", "POS_BALANCE_QUANTITY", "POS_VALUE_QUANTITY", "POS_BALANCE_QTY_VALUE", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "POS_REF_UNIT_VALUE", "POS_RATE_FACTOR", "POS_STOCK_OUTAGE", "POS_UNIT_COST_PRICE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "PAC_REPRESENTATIVE_POS_ID", "POS_MODIFY_RATE", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "C_POS_DELIVERY_TYP", "POS_BALANCED", "POS_IMF_TEXT_1", "POS_IMF_TEXT_2", "POS_IMF_TEXT_3", "POS_IMF_TEXT_4", "POS_IMF_TEXT_5", "POS_IMF_NUMBER_2", "POS_IMF_NUMBER_3", "POS_IMF_NUMBER_4", "POS_IMF_NUMBER_5", "POS_IMF_DATE_1", "POS_IMF_DATE_2", "POS_IMF_DATE_3", "POS_IMF_DATE_4", "POS_IMF_DATE_5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "POS_PARTNER_NUMBER", "POS_PARTNER_REFERENCE", "POS_DATE_PARTNER_DOCUMENT", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "DOC_GAUGE_POSITION_ID", "C_GAUGE_SHOW_DELAY", "DOC_DOCUMENT_ID", "ACS_FINANCIAL_CURRENCY_ID", "PAC_PAYMENT_CONDITION_ID", "PAC_THIRD_ID", "DOC_RECORD_DOC_ID", "PAC_THIRD_DOC_ID", "RCO_TITLE_DOC", "RCO_DESCRIPTION_DOC", "DIC_ACCOUNTABLE_GROUP_DOC_ID", "ACS_FIN_DOC_ID", "ACS_DIV_ACC_DOC_ID", "PAC_REPRESENTATIVE_ID", "PAC_ADDRESS_1_ID", "PAC_ADDRESS_2_ID", "PAC_ADDRESS_3_ID", "DIC_GAUGE_TYPE_DOC_ID", "C_DOCUMENT_STATUS", "DMT_NUMBER", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DMT_MAIN_EDITING", "DMT_DATE_MAIN_PRINTING", "DMT_ALT1_EDITING", "DMT_DATE_ALT1_PRINTING", "DMT_ALT2_EDITING", "DMT_DATE_ALT2_PRINTING", "DMT_ALT3_EDITING", "DMT_DATE_ALT3_PRINTING", "DMT_ALT4_EDITING", "DMT_DATE_ALT4_PRINTING", "DMT_ALT5_EDITING", "DMT_DATE_ALT5_PRINTING", "DMT_ALT6_EDITING", "DMT_DATE_ALT6_PRINTING", "DMT_ALT7_EDITING", "DMT_DATE_ALT7_PRINTING", "DMT_ALT8_EDITING", "DMT_DATE_ALT8_PRINTING", "DMT_ALT9_EDITING", "DMT_DATE_ALT9_PRINTING", "DMT_ALT10_EDITING", "DMT_DATE_ALT10_PRINTING", "DMT_MAIN_PRINTING", "DMT_ALT1_PRINTING", "DMT_ALT2_PRINTING", "DMT_ALT3_PRINTING", "DMT_ALT4_PRINTING", "DMT_ALT5_PRINTING", "DMT_ALT6_PRINTING", "DMT_ALT7_PRINTING", "DMT_ALT8_PRINTING", "DMT_ALT9_PRINTING", "DMT_ALT10_PRINTING", "DMT_DATE_FALLING_DUE", "DMT_LAST_USED_POS_NUMBER", "DMT_RATE_OF_EXCHANGE", "DMT_DATE_DOCUMENT", "DMT_DATE_PARTNER_DOCUMENT", "DMT_DATE_VALUE", "DMT_ADDRESS1", "DMT_POSTCODE1", "DMT_TOWN1", "DMT_STATE1", "PC_CNTRY_1_ID", "CNTID_1", "CNTNAME_1", "DMT_ADDRESS2", "DMT_POSTCODE2", "DMT_TOWN2", "DMT_STATE2", "PC_CNTRY_2_ID", "CNTID_2", "CNTNAME_2", "DMT_ADDRESS3", "DMT_POSTCODE3", "DMT_TOWN3", "DMT_STATE3", "PC_CNTRY_3_ID", "CNTID_3", "CNTNAME_3", "PC_LANG_ID", "DMT_BASE_PRICE", "DMT_RATE_FACTOR", "DOC_GAUGE_ID", "DMT_FINANCIAL_CHARGING", "DOC_GAUGE_NUMBERING_ID", "DIC_ADDRESS_TYPE_ID", "DIC_GAUGE_CATEG_ID", "C_ADMIN_DOMAIN", "C_GAUGE_TYPE", "GAU_DESCRIBE", "GAU_EDIFACT", "C_GAUGE_TITLE", "DOC_FOOT_ID", "DOC_GAUGE_SIGNATORY_1_ID", "DOC_GAUGE_SIGNATORY_2_ID", "FOO_FOOT_TEXT", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_B", "FOO_GOOD_TOT_AMOUNT_EX_E", "FOO_GOOD_TOT_AMOUNT_EX_B", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_CHARGE_TOT_AMOUNT_E", "FOO_CHARGE_TOT_AMOUNT_B", "FOO_CHARG_TOT_AMOUNT_EX_E", "FOO_CHARG_TOT_AMOUNT_EX_B", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_DISCOUNT_TOT_AMOUNT_E", "FOO_DISCOUNT_TOT_AMOUNT_B", "FOO_DISC_TOT_AMOUNT_EX_E", "FOO_DISC_TOT_AMOUNT_EX_B", "FOO_COST_TOTAL_AMOUNT", "FOO_COST_TOT_AMOUNT_E", "FOO_COST_TOT_AMOUNT_B", "FOO_COST_TOT_AMOUNT_EX_E", "FOO_COST_TOT_AMOUNT_EX_B", "FOO_TOTAL_VAT_AMOUNT", "FOO_TOT_VAT_AMOUNT_E", "FOO_TOT_VAT_AMOUNT_B", "FOO_TOT_VAT_AMOUNT_V", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "FOO_TOTAL_RATE_FACTOR", "FOO_PAID_AMOUNT", "FOO_PAID_AMOUNT_EUR", "FOO_PAID_AMOUNT_B", "FOO_PAID_BALANCED_AMOUNT", "FOO_RECEIVED_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "FOO_DOC_TOT_AMT_COR_B", "DOC_POSITION_COR_ID", "FOO_MODIFY_RATE") AS
  select DOC_POSITION_DETAIL.DOC_POSITION_DETAIL_ID
       , DOC_POSITION_DETAIL.DOC_GAUGE_FLOW_ID
       , DOC_POSITION_DETAIL.DOC_DOC_POSITION_DETAIL_ID DOC_POS_DETAIL_FATHERSON_ID
       , DOC_POSITION_DETAIL.DOC2_DOC_POSITION_DETAIL_ID DOC_POS_DETAIL_ORIGINE_ID
       , DOC_POSITION_DETAIL.GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_1_ID
       , GCO_CHARACTERIZATION_1.CHA_CHARACTERIZATION_DESIGN CHA_CHARACTERIZATION_DESIGN_1
       , DOC_POSITION_DETAIL.PDE_CHARACTERIZATION_VALUE_1
       , DOC_POSITION_DETAIL.GCO_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_2_ID
       , GCO_CHARACTERIZATION_2.CHA_CHARACTERIZATION_DESIGN CHA_CHARACTERIZATION_DESIGN_2
       , DOC_POSITION_DETAIL.PDE_CHARACTERIZATION_VALUE_2
       , DOC_POSITION_DETAIL.GCO2_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_3_ID
       , GCO_CHARACTERIZATION_3.CHA_CHARACTERIZATION_DESIGN CHA_CHARACTERIZATION_DESIGN_3
       , DOC_POSITION_DETAIL.PDE_CHARACTERIZATION_VALUE_3
       , DOC_POSITION_DETAIL.GCO3_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_4_ID
       , GCO_CHARACTERIZATION_4.CHA_CHARACTERIZATION_DESIGN CHA_CHARACTERIZATION_DESIGN_4
       , DOC_POSITION_DETAIL.PDE_CHARACTERIZATION_VALUE_4
       , DOC_POSITION_DETAIL.GCO4_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_5_ID
       , GCO_CHARACTERIZATION_5.CHA_CHARACTERIZATION_DESIGN CHA_CHARACTERIZATION_DESIGN_5
       , DOC_POSITION_DETAIL.PDE_CHARACTERIZATION_VALUE_5
       , DOC_POSITION.STM_STOCK_ID
       , STM_STOCK.STO_DESCRIPTION
       , DOC_POSITION_DETAIL.STM_LOCATION_ID
       , STM_LOCATION.LOC_DESCRIPTION
       , DOC_POSITION_DETAIL.PDE_BASIS_DELAY
       , DOC_POSITION_DETAIL.PDE_INTERMEDIATE_DELAY
       , DOC_POSITION_DETAIL.PDE_FINAL_DELAY
       , DOC_POSITION_DETAIL.PDE_BASIS_QUANTITY
       , DOC_POSITION_DETAIL.PDE_INTERMEDIATE_QUANTITY
       , DOC_POSITION_DETAIL.PDE_FINAL_QUANTITY
       , DOC_POSITION_DETAIL.PDE_BALANCE_QUANTITY
       , DOC_POSITION_DETAIL.PDE_BASIS_DELAY_W
       , DOC_POSITION_DETAIL.PDE_BASIS_DELAY_M
       , DOC_POSITION_DETAIL.PDE_INTERMEDIATE_DELAY_W
       , DOC_POSITION_DETAIL.PDE_INTERMEDIATE_DELAY_M
       , DOC_POSITION_DETAIL.PDE_FINAL_DELAY_W
       , DOC_POSITION_DETAIL.PDE_FINAL_DELAY_M
       , DOC_POSITION_DETAIL.PDE_MOVEMENT_QUANTITY
       , DOC_POSITION_DETAIL.PDE_MOVEMENT_VALUE
       , DOC_POSITION.DOC_POSITION_ID
       , DOC_POSITION.GCO_GOOD_ID
       , DOC_POSITION.DOC_RECORD_ID DOC_RECORD_POS_ID
       , DOC_RECORD_1.PAC_THIRD_ID PAC_THIRD_POS_ID
       , DOC_RECORD_1.RCO_TITLE RCO_TITLE_POS
       , DOC_RECORD_1.RCO_DESCRIPTION RCO_DESCRIPTION_POS
       , DOC_RECORD_1.DIC_ACCOUNTABLE_GROUP_ID DIC_ACCOUNTABLE_GROUP_POS_ID
       , DOC_POSITION.STM_MOVEMENT_KIND_ID
       , DOC_POSITION.ACS_TAX_CODE_ID
       , DOC_POSITION.ACS_FINANCIAL_ACCOUNT_ID ACS_FIN_ACC_POS_ID
       , DOC_POSITION.ACS_DIVISION_ACCOUNT_ID ACS_DIV_ACC_POS_ID
       , DOC_POSITION.C_GAUGE_TYPE_POS
       , DOC_POSITION.C_DOC_POS_STATUS
       , DOC_POSITION.POS_NUMBER
       , DOC_POSITION.POS_REFERENCE
       , DOC_POSITION.POS_SHORT_DESCRIPTION
       , DOC_POSITION.POS_LONG_DESCRIPTION
       , DOC_POSITION.POS_FREE_DESCRIPTION
       , DOC_POSITION.POS_BODY_TEXT
       , DOC_POSITION.POS_GENERATE_MOVEMENT
       , DOC_POSITION.POS_DISCOUNT_AMOUNT
       , DOC_POSITION.POS_CHARGE_AMOUNT
       , DOC_POSITION.POS_VAT_AMOUNT
       , DOC_POSITION.POS_VAT_BASE_AMOUNT
       , DOC_POSITION.POS_VAT_AMOUNT_E
       , DOC_POSITION.POS_VAT_AMOUNT_V
       , DOC_POSITION.POS_GROSS_UNIT_VALUE
       , DOC_POSITION.POS_GROSS_UNIT_VALUE2
       , DOC_POSITION.POS_GROSS_UNIT_VALUE_INCL
       , DOC_POSITION.POS_NET_UNIT_VALUE
       , DOC_POSITION.POS_NET_UNIT_VALUE_INCL
       , DOC_POSITION.POS_GROSS_VALUE
       , DOC_POSITION.POS_GROSS_VALUE_E
       , DOC_POSITION.POS_GROSS_VALUE_B
       , DOC_POSITION.POS_GROSS_VALUE_V
       , DOC_POSITION.POS_GROSS_VALUE_INCL
       , DOC_POSITION.POS_GROSS_VALUE_INCL_E
       , DOC_POSITION.POS_GROSS_VALUE_INCL_B
       , DOC_POSITION.POS_GROSS_VALUE_INCL_V
       , DOC_POSITION.POS_NET_VALUE_EXCL
       , DOC_POSITION.POS_NET_VALUE_EXCL_E
       , DOC_POSITION.POS_NET_VALUE_EXCL_B
       , DOC_POSITION.POS_NET_VALUE_EXCL_V
       , DOC_POSITION.POS_NET_VALUE_INCL
       , DOC_POSITION.POS_NET_VALUE_INCL_E
       , DOC_POSITION.POS_NET_VALUE_INCL_B
       , DOC_POSITION.POS_NET_VALUE_INCL_V
       , DOC_POSITION.POS_BASIS_QUANTITY
       , DOC_POSITION.POS_BASIS_QUANTITY_SU
       , DOC_POSITION.POS_INTERMEDIATE_QUANTITY
       , DOC_POSITION.POS_INTERMEDIATE_QUANTITY_SU
       , DOC_POSITION.POS_FINAL_QUANTITY
       , DOC_POSITION.POS_FINAL_QUANTITY_SU
       , DOC_POSITION.POS_BALANCE_QUANTITY
       , DOC_POSITION.POS_VALUE_QUANTITY
       , DOC_POSITION.POS_BALANCE_QTY_VALUE
       , DOC_POSITION.POS_NET_WEIGHT
       , DOC_POSITION.POS_GROSS_WEIGHT
       , DOC_POSITION.POS_REF_UNIT_VALUE
       , DOC_POSITION.POS_RATE_FACTOR
       , DOC_POSITION.POS_STOCK_OUTAGE
       , DOC_POSITION.POS_UNIT_COST_PRICE
       , DOC_POSITION.DIC_POS_FREE_TABLE_1_ID
       , DOC_POSITION.DIC_POS_FREE_TABLE_2_ID
       , DOC_POSITION.DIC_POS_FREE_TABLE_3_ID
       , DOC_POSITION.POS_DECIMAL_1
       , DOC_POSITION.POS_DECIMAL_2
       , DOC_POSITION.POS_DECIMAL_3
       , DOC_POSITION.POS_TEXT_1
       , DOC_POSITION.POS_TEXT_2
       , DOC_POSITION.POS_TEXT_3
       , DOC_POSITION.POS_DISCOUNT_UNIT_VALUE
       , DOC_POSITION.POS_DISCOUNT_RATE
       , DOC_POSITION.PAC_REPRESENTATIVE_ID PAC_REPRESENTATIVE_POS_ID
       , DOC_POSITION.POS_MODIFY_RATE
       , DOC_POSITION.POS_NET_TARIFF
       , DOC_POSITION.POS_SPECIAL_TARIFF
       , DOC_POSITION.POS_FLAT_RATE
       , DOC_POSITION.C_POS_DELIVERY_TYP
       , DOC_POSITION.POS_BALANCED
       , DOC_POSITION.POS_IMF_TEXT_1
       , DOC_POSITION.POS_IMF_TEXT_2
       , DOC_POSITION.POS_IMF_TEXT_3
       , DOC_POSITION.POS_IMF_TEXT_4
       , DOC_POSITION.POS_IMF_TEXT_5
       , DOC_POSITION.POS_IMF_NUMBER_2
       , DOC_POSITION.POS_IMF_NUMBER_3
       , DOC_POSITION.POS_IMF_NUMBER_4
       , DOC_POSITION.POS_IMF_NUMBER_5
       , DOC_POSITION.POS_IMF_DATE_1
       , DOC_POSITION.POS_IMF_DATE_2
       , DOC_POSITION.POS_IMF_DATE_3
       , DOC_POSITION.POS_IMF_DATE_4
       , DOC_POSITION.POS_IMF_DATE_5
       , DOC_POSITION.DIC_IMP_FREE1_ID
       , DOC_POSITION.DIC_IMP_FREE2_ID
       , DOC_POSITION.DIC_IMP_FREE3_ID
       , DOC_POSITION.DIC_IMP_FREE4_ID
       , DOC_POSITION.DIC_IMP_FREE5_ID
       , DOC_POSITION.POS_PARTNER_NUMBER
       , DOC_POSITION.POS_PARTNER_REFERENCE
       , DOC_POSITION.POS_DATE_PARTNER_DOCUMENT
       , DOC_POSITION.POS_DATE_1
       , DOC_POSITION.POS_DATE_2
       , DOC_POSITION.POS_DATE_3
       , DOC_GAUGE_POSITION.DOC_GAUGE_POSITION_ID
       , DOC_GAUGE_POSITION.C_GAUGE_SHOW_DELAY
       , DOC_DOCUMENT.DOC_DOCUMENT_ID
       , DOC_DOCUMENT.ACS_FINANCIAL_CURRENCY_ID
       , DOC_DOCUMENT.PAC_PAYMENT_CONDITION_ID
       , DOC_DOCUMENT.PAC_THIRD_ID
       , DOC_DOCUMENT.DOC_RECORD_ID DOC_RECORD_DOC_ID
       , DOC_RECORD_2.PAC_THIRD_ID PAC_THIRD_DOC_ID
       , DOC_RECORD_2.RCO_TITLE RCO_TITLE_DOC
       , DOC_RECORD_2.RCO_DESCRIPTION RCO_DESCRIPTION_DOC
       , DOC_RECORD_2.DIC_ACCOUNTABLE_GROUP_ID DIC_ACCOUNTABLE_GROUP_DOC_ID
       , DOC_DOCUMENT.ACS_FINANCIAL_ACCOUNT_ID ACS_FIN_DOC_ID
       , DOC_DOCUMENT.ACS_DIVISION_ACCOUNT_ID ACS_DIV_ACC_DOC_ID
       , DOC_DOCUMENT.PAC_REPRESENTATIVE_ID
       , DOC_DOCUMENT.PAC_ADDRESS_ID PAC_ADDRESS_1_ID
       , DOC_DOCUMENT.PAC_PAC_ADDRESS_ID PAC_ADDRESS_2_ID
       , DOC_DOCUMENT.PAC2_PAC_ADDRESS_ID PAC_ADDRESS_3_ID
       , DOC_DOCUMENT.DIC_GAUGE_TYPE_DOC_ID
       , DOC_DOCUMENT.C_DOCUMENT_STATUS
       , DOC_DOCUMENT.DMT_NUMBER
       , DOC_DOCUMENT.DMT_PARTNER_NUMBER
       , DOC_DOCUMENT.DMT_PARTNER_REFERENCE
       , DOC_DOCUMENT.DMT_REFERENCE
       , DOC_DOCUMENT.DMT_TITLE_TEXT
       , DOC_DOCUMENT.DMT_HEADING_TEXT
       , DOC_DOCUMENT.DMT_DOCUMENT_TEXT
       , DOC_DOCUMENT.DMT_MAIN_EDITING
       , DOC_DOCUMENT.DMT_DATE_MAIN_PRINTING
       , DOC_DOCUMENT.DMT_ALT1_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT1_PRINTING
       , DOC_DOCUMENT.DMT_ALT2_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT2_PRINTING
       , DOC_DOCUMENT.DMT_ALT3_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT3_PRINTING
       , DOC_DOCUMENT.DMT_ALT4_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT4_PRINTING
       , DOC_DOCUMENT.DMT_ALT5_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT5_PRINTING
       , DOC_DOCUMENT.DMT_ALT6_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT6_PRINTING
       , DOC_DOCUMENT.DMT_ALT7_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT7_PRINTING
       , DOC_DOCUMENT.DMT_ALT8_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT8_PRINTING
       , DOC_DOCUMENT.DMT_ALT9_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT9_PRINTING
       , DOC_DOCUMENT.DMT_ALT10_EDITING
       , DOC_DOCUMENT.DMT_DATE_ALT10_PRINTING
       , DOC_DOCUMENT.DMT_MAIN_PRINTING
       , DOC_DOCUMENT.DMT_ALT1_PRINTING
       , DOC_DOCUMENT.DMT_ALT2_PRINTING
       , DOC_DOCUMENT.DMT_ALT3_PRINTING
       , DOC_DOCUMENT.DMT_ALT4_PRINTING
       , DOC_DOCUMENT.DMT_ALT5_PRINTING
       , DOC_DOCUMENT.DMT_ALT6_PRINTING
       , DOC_DOCUMENT.DMT_ALT7_PRINTING
       , DOC_DOCUMENT.DMT_ALT8_PRINTING
       , DOC_DOCUMENT.DMT_ALT9_PRINTING
       , DOC_DOCUMENT.DMT_ALT10_PRINTING
       , DOC_DOCUMENT.DMT_DATE_FALLING_DUE
       , DOC_DOCUMENT.DMT_LAST_USED_POS_NUMBER
       , DOC_DOCUMENT.DMT_RATE_OF_EXCHANGE
       , DOC_DOCUMENT.DMT_DATE_DOCUMENT
       , DOC_DOCUMENT.DMT_DATE_PARTNER_DOCUMENT
       , DOC_DOCUMENT.DMT_DATE_VALUE
       , DOC_DOCUMENT.DMT_ADDRESS1
       , DOC_DOCUMENT.DMT_POSTCODE1
       , DOC_DOCUMENT.DMT_TOWN1
       , DOC_DOCUMENT.DMT_STATE1
       , DOC_DOCUMENT.PC_CNTRY_ID PC_CNTRY_1_ID
       , PC_CNTRY_1.CNTID CNTID_1
       , PC_CNTRY_1.CNTNAME CNTNAME_1
       , DOC_DOCUMENT.DMT_ADDRESS2
       , DOC_DOCUMENT.DMT_POSTCODE2
       , DOC_DOCUMENT.DMT_TOWN2
       , DOC_DOCUMENT.DMT_STATE2
       , DOC_DOCUMENT.PC__PC_CNTRY_ID PC_CNTRY_2_ID
       , PC_CNTRY_2.CNTID CNTID_2
       , PC_CNTRY_2.CNTNAME CNTNAME_2
       , DOC_DOCUMENT.DMT_ADDRESS3
       , DOC_DOCUMENT.DMT_POSTCODE3
       , DOC_DOCUMENT.DMT_TOWN3
       , DOC_DOCUMENT.DMT_STATE3
       , DOC_DOCUMENT.PC_2_PC_CNTRY_ID PC_CNTRY_3_ID
       , PC_CNTRY_3.CNTID CNTID_3
       , PC_CNTRY_3.CNTNAME CNTNAME_3
       , DOC_DOCUMENT.PC_LANG_ID
       , DOC_DOCUMENT.DMT_BASE_PRICE
       , DOC_DOCUMENT.DMT_RATE_FACTOR
       , DOC_GAUGE.DOC_GAUGE_ID
       , DOC_DOCUMENT.DMT_FINANCIAL_CHARGING
       , DOC_GAUGE.DOC_GAUGE_NUMBERING_ID
       , DOC_GAUGE.DIC_ADDRESS_TYPE_ID
       , DOC_GAUGE.DIC_GAUGE_CATEG_ID
       , DOC_GAUGE.C_ADMIN_DOMAIN
       , DOC_GAUGE.C_GAUGE_TYPE
       , DOC_GAUGE.GAU_DESCRIBE
       , DOC_GAUGE.GAU_EDIFACT
       , DOC_GAUGE_STRUCTURED.C_GAUGE_TITLE
       , DOC_FOOT.DOC_FOOT_ID
       , DOC_FOOT.DOC_GAUGE_SIGNATORY_ID DOC_GAUGE_SIGNATORY_1_ID
       , DOC_FOOT.DOC_DOC_GAUGE_SIGNATORY_ID DOC_GAUGE_SIGNATORY_2_ID
       , DOC_FOOT.FOO_FOOT_TEXT
       , DOC_FOOT.FOO_DOCUMENT_TOTAL_AMOUNT
       , DOC_FOOT.FOO_DOCUMENT_TOT_AMOUNT_E
       , DOC_FOOT.FOO_DOCUMENT_TOT_AMOUNT_B
       , DOC_FOOT.FOO_GOOD_TOTAL_AMOUNT
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_E
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_B
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_CHARGE_TOTAL_AMOUNT
       , DOC_FOOT.FOO_CHARGE_TOT_AMOUNT_E
       , DOC_FOOT.FOO_CHARGE_TOT_AMOUNT_B
       , DOC_FOOT.FOO_CHARG_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_CHARG_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_DISCOUNT_TOTAL_AMOUNT
       , DOC_FOOT.FOO_DISCOUNT_TOT_AMOUNT_E
       , DOC_FOOT.FOO_DISCOUNT_TOT_AMOUNT_B
       , DOC_FOOT.FOO_DISC_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_DISC_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_COST_TOTAL_AMOUNT
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_E
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_B
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_TOTAL_VAT_AMOUNT
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_E
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_B
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_V
       , DOC_FOOT.FOO_TOTAL_BASIS_QUANTITY
       , DOC_FOOT.FOO_TOTAL_INTERM_QUANTITY
       , DOC_FOOT.FOO_TOTAL_FINAL_QUANTITY
       , DOC_FOOT.FOO_TOTAL_NET_WEIGHT
       , DOC_FOOT.FOO_TOTAL_NET_WEIGHT_MEAS
       , DOC_FOOT.FOO_TOTAL_GROSS_WEIGHT
       , DOC_FOOT.FOO_TOTAL_GROSS_WEIGHT_MEAS
       , DOC_FOOT.FOO_TOTAL_RATE_FACTOR
       , DOC_FOOT.FOO_PAID_AMOUNT
       , DOC_FOOT.FOO_PAID_AMOUNT_EUR
       , DOC_FOOT.FOO_PAID_AMOUNT_B
       , DOC_FOOT.FOO_PAID_BALANCED_AMOUNT
       , DOC_FOOT.FOO_RECEIVED_AMOUNT
       , DOC_FOOT.FOO_RETURN_AMOUNT
       , DOC_FOOT.FOO_PACKAGING
       , DOC_FOOT.FOO_MARKING
       , DOC_FOOT.FOO_MEASURE
       , DOC_FOOT.FOO_DOC_TOT_AMT_COR_B
       , DOC_FOOT.DOC_POSITION_ID DOC_POSITION_COR_ID
       , DOC_FOOT.FOO_MODIFY_RATE
    from DOC_POSITION_DETAIL
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_1
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_2
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_3
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_4
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_5
       , STM_LOCATION
       , DOC_POSITION
       , STM_STOCK
       , DOC_GAUGE_POSITION
       , DOC_RECORD DOC_RECORD_1
       , DOC_DOCUMENT
       , PCS.PC_CNTRY PC_CNTRY_1
       , PCS.PC_CNTRY PC_CNTRY_2
       , PCS.PC_CNTRY PC_CNTRY_3
       , DOC_GAUGE
       , DOC_GAUGE_STRUCTURED
       , DOC_RECORD DOC_RECORD_2
       , DOC_FOOT
   where DOC_POSITION_DETAIL.DOC_POSITION_ID = DOC_POSITION.DOC_POSITION_ID
     and DOC_POSITION_DETAIL.GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_1.GCO_CHARACTERIZATION_ID(+)
     and DOC_POSITION_DETAIL.GCO_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_2.GCO_CHARACTERIZATION_ID(+)
     and DOC_POSITION_DETAIL.GCO2_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_3.GCO_CHARACTERIZATION_ID(+)
     and DOC_POSITION_DETAIL.GCO3_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_4.GCO_CHARACTERIZATION_ID(+)
     and DOC_POSITION_DETAIL.GCO4_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_5.GCO_CHARACTERIZATION_ID(+)
     and DOC_POSITION_DETAIL.STM_LOCATION_ID = STM_LOCATION.STM_LOCATION_ID(+)
     and DOC_POSITION.DOC_GAUGE_POSITION_ID = DOC_GAUGE_POSITION.DOC_GAUGE_POSITION_ID
     and DOC_POSITION.DOC_DOCUMENT_ID = DOC_DOCUMENT.DOC_DOCUMENT_ID
     and DOC_POSITION.STM_STOCK_ID = STM_STOCK.STM_STOCK_ID(+)
     and DOC_POSITION.DOC_RECORD_ID = DOC_RECORD_1.DOC_RECORD_ID(+)
     and DOC_DOCUMENT.DOC_GAUGE_ID = DOC_GAUGE.DOC_GAUGE_ID
     and DOC_DOCUMENT.DOC_GAUGE_ID = DOC_GAUGE_STRUCTURED.DOC_GAUGE_ID
     and DOC_DOCUMENT.PC_CNTRY_ID = PC_CNTRY_1.PC_CNTRY_ID(+)
     and DOC_DOCUMENT.PC__PC_CNTRY_ID = PC_CNTRY_2.PC_CNTRY_ID(+)
     and DOC_DOCUMENT.PC_2_PC_CNTRY_ID = PC_CNTRY_3.PC_CNTRY_ID(+)
     and DOC_DOCUMENT.DOC_RECORD_ID = DOC_RECORD_2.DOC_RECORD_ID(+)
     and DOC_DOCUMENT.DOC_DOCUMENT_ID = DOC_FOOT.DOC_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E001_DETAIL" ("F5001_01", "F5901_02", "F5901_03", "F5901_04", "F5901_05", "F5901_06", "F5901_07", "F5901_08", "F5901_09", "F5901_10", "F5901_11", "F5901_12", "F5901_13", "F5901_14", "F5901_15", "F5901_16", "F5901_17", "F5901_18", "F5901_19", "F5901_20", "F5901_21", "F5901_22", "F5901_23", "F5901_24", "F5901_25", "F5901_99", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '5901' F5001_01,
   LPAD (DOC_EDI_FUNCTION.GETPARAMVALUE('PARTNER'), 7, '0') F5901_02,
   RPAD (DOC.DMT_NUMBER, 8, ' ') F5901_03,
   LPAD (POS.POS_NUMBER, 6, '0') F5901_04,
   LPAD (NVL (PAC.PER_KEY2, '0'), 7, '0') F5901_05,
   RPAD (DOC.DMT_NUMBER, 8, ' ') F5901_06,
   TO_CHAR (NVL (DOC.DMT_DATE_DELIVERY, DOC.DMT_DATE_DOCUMENT),'YYYYMMDD') F5901_07,
   LPAD (' ', 8) F5901_08,
   TO_CHAR (NVL  (DOC.DMT_DATE_PARTNER_DOCUMENT, DOC.DMT_DATE_DOCUMENT), 'YYYYMMDD') F5901_09,
   TO_CHAR (NVL (DOC.DMT_DATE_DELIVERY, DOC.DMT_DATE_DOCUMENT), 'YYYYMMDD') F5901_10,
   LPAD (' ', 8) F5901_11,
   RPAD ( REPLACE (POS.POS_REFERENCE, '.', ''), 12, '0') F5901_12,
   '01' F5901_13,
   '0' F5901_14,
   TO_CHAR  (POS.POS_FINAL_QUANTITY,  'FM0000000V999') F5901_15,
   '0001' F5901_16,
   DECODE (UPPER (POS.DIC_UNIT_OF_MEASURE_ID), 'PCE', '01', 'GR', '10', 'KG', '11', '  ') F5901_17,
   TO_CHAR (POS.POS_NET_UNIT_VALUE,  'FM000000000V999') F5901_18,
   LPAD (' ', 3) F5901_19,
   TO_CHAR (NVL (GCO.DATA_UNIT_PRICE_SALE, 0),  'FM000000V99') F5901_20,
   '001' F5901_21,
   '0' F5901_22,
   DOC_EDI_FUNCTION.GETE001CODETVA(DOC.DMT_DATE_DELIVERY, DOC.DMT_DATE_DOCUMENT, ACS.ACS_TAX_CODE_ID) F5901_23,
   '000' F5901_24,
   LPAD ( NVL (PAC.PER_KEY2, '0'), 7, '0') F5901_25,
   LPAD ('0', 11, '0') F5901_99,
   '' NOT_EXPORTED_FIELDS
FROM
   ACS_TAX_CODE ACS,
   DOC_DOCUMENT DOC,
   DOC_POSITION POS,
   GCO_FREE_DATA GCO,
   PAC_PERSON PAC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
   DOC.PAC_THIRD_ID    = PAC.PAC_PERSON_ID (+) AND
   POS.GCO_GOOD_ID     = GCO.GCO_GOOD_ID (+) AND
   POS.ACS_TAX_CODE_ID = ACS.ACS_TAX_CODE_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E001_FOOT" ("F5002_01", "F5902_02", "F5902_03", "F5902_04", "F5902_05", "F5902_06", "F5902_07", "F5902_08", "F5902_09", "F5902_10", "F5902_11", "F5902_12", "F5902_13", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '5902' F5002_01,
   LPAD (DOC_EDI_FUNCTION.GETPARAMVALUE('PARTNER'),7 ,'0') F5902_02,
   RPAD (DOC.DMT_NUMBER,8 ,' ') F5902_03,
   TO_CHAR(FOO.FOO_GOOD_TOT_AMOUNT_EXCL, 'FM000000000V999') F5902_04,
   RPAD(' ', 4) F5902_05,
   RPAD(' ', 10) F5902_06,
   RPAD(' ', 1) F5902_07,
   DECODE(SIGN(FOO.FOO_DISC_TOT_AMOUNT_EXCL), 1, '0200', RPAD(' ', 4)) F5902_08,
   TO_CHAR(FOO.FOO_DISC_TOT_AMOUNT_EXCL,  'FM0000000V999') F5902_09,
   TO_CHAR(FOO.FOO_GOOD_TOT_AMOUNT_EXCL -  FOO.FOO_DISCOUNT_TOTAL_AMOUNT,  'FM000000000V999') F5902_10,
   TO_CHAR(FOO.FOO_TOTAL_VAT_AMOUNT,      'FM0000000V999') F5902_11,
   TO_CHAR(FOO.FOO_DOCUMENT_TOTAL_AMOUNT, 'FM000000000V999') F5902_12,
   RPAD('0', 66, '0') F5902_13,
   '' NOT_EXPORTED_FIELDS
FROM
   DOC_DOCUMENT DOC,
   DOC_FOOT FOO
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID AND
   DOC.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E001_HEAD" ("F5000_01", "F5900_02", "F5900_03", "F5900_04", "F5900_05", "F5900_06", "F5900_07", "F5900_08", "F5900_09", "F5900_10", "F5900_11", "F5900_99", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '5900' F5000_01,
   LPAD (DOC_EDI_FUNCTION.GETPARAMVALUE('PARTNER'), 7, '0') F5900_02,
   RPAD (DMT_NUMBER, 8, ' ') F5900_03,
   TO_CHAR (DOC.DMT_DATE_DOCUMENT, 'YYYYMMDD') F5900_04,
   DECODE (STR.C_GAUGE_TITLE, 8, '1', '2') F5900_05,
   '2022200' F5900_06,
   '0' F5900_07,
   RPAD (' ', 8, ' ') F5900_08,
   DECODE (UPPER (PC.CURRENCY), 'CHF', '001', 'DEM', '013',  'FRF', '014', '000') F5900_09,
   '000000' F5900_10,
   DECODE (DOC.DIC_TYPE_SUBMISSION_ID, '0', ' ', '0') F5900_11,
   RPAD ('0', 106, '0') F5900_99,
   '' NOT_EXPORTED_FIELDS
FROM DOC_DOCUMENT DOC,
   DOC_GAUGE_STRUCTURED STR,
   ACS_FINANCIAL_CURRENCY ACS,
   PCS.PC_CURR PC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID AND
   DOC.DOC_GAUGE_ID    = STR.DOC_GAUGE_ID  AND
   DOC.ACS_FINANCIAL_CURRENCY_ID = ACS.ACS_FINANCIAL_CURRENCY_ID AND
   ACS.PC_CURR_ID = PC.PC_CURR_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_DETAIL" ("LINE_ID", "P1RENR", "P1REPOK", "P1ATNR", "P1BEZ1", "P1BEZ2", "P1BEZ3", "P1BEZ4", "P1BEZ5", "P1ZUSP", "P1MEAF", "P1MHAF", "P1MEZO", "P1MHZO", "P1GWEN", "P1GWPN", "P1EPLW", "P1PWLW", "P1EPFW", "P1PWFW", "P1SRENR", "P1VERKEHR", "P1RUECKCODE", "P1BEWPLICHT", "P1BEWNUMMER", "P1WNR1", "P1SCHLUESSEL", "P1WBZ1", "P1WBZ2", "P1WBZ3", "P1GENR", "P1TBEZ", "P1EMKZ", "P1EMBA", "P1EMVON", "P1EMBIS", "P1AUSLISTNR", "P1IMO_KEY", "P1IMO_KLASSE", "P1IMO_UNNR", "P1IMO_BEZEICH", "P1IMO_SEITENNR", "P1IMO_VGRUPPE", "P1IMO_KENNZ", "P1IMO_MERKU", "P1IMO_MERKE", "P1IMO_FLAMM", "P1PRODUKTGRP", "P1PRODUKTDSC", "PTTEXT", "NOT_EXPORTED_FIELDS") AS
  select 'P1' LINE_ID
       , rpad('a', 35, ' ') P1RENR
       , rpad('b', 6, ' ') P1REPOK
       , rpad('c', 35, ' ') P1ATNR
       , rpad('d', 35, ' ') P1BEZ1
       , rpad('e', 35, ' ') P1BEZ2
       , rpad('f', 35, ' ') P1BEZ3
       , rpad('g', 35, ' ') P1BEZ4
       , rpad('h', 35, ' ') P1BEZ5
       , rpad('i', 6, ' ') P1ZUSP
       , rpad('j', 15, ' ') P1MEAF
       , rpad('k', 5, ' ') P1MHAF
       , rpad('l', 15, ' ') P1MEZO
       , rpad('m', 5, ' ') P1MHZO
       , rpad('n', 12, ' ') P1GWEN
       , rpad('o', 12, ' ') P1GWPN
       , rpad('p', 10, ' ') P1EPLW
       , rpad('q', 10, ' ') P1PWLW
       , rpad('r', 15, ' ') P1EPFW
       , rpad('s', 15, ' ') P1PWFW
       , rpad('t', 35, ' ') P1SRENR
       , rpad('u', 1, ' ') P1VERKEHR
       , rpad('v', 1, ' ') P1RUECKCODE
       , rpad('w', 1, ' ') P1BEWPLICHT
       , rpad('x', 5, ' ') P1BEWNUMMER
       , rpad('y', 8, ' ') P1WNR1
       , rpad('z', 3, ' ') P1SCHLUESSEL
       , rpad('A', 42, ' ') P1WBZ1
       , rpad('B', 42, ' ') P1WBZ2
       , rpad('C', 42, ' ') P1WBZ3
       , rpad('D', 35, ' ') P1GENR
       , rpad('E', 20, ' ') P1TBEZ
       , rpad('F', 1, ' ') P1EMKZ
       , rpad('G', 11, ' ') P1EMBA
       , rpad('H', 8, ' ') P1EMVON
       , rpad('I', 8, ' ') P1EMBIS
       , rpad('J', 8, ' ') P1AUSLISTNR
       , rpad('K', 11, ' ') P1IMO_KEY
       , rpad('L', 7, ' ') P1IMO_KLASSE
       , rpad('M', 4, ' ') P1IMO_UNNR
       , rpad('N', 254, ' ') P1IMO_BEZEICH
       , rpad('O', 28, ' ') P1IMO_SEITENNR
       , rpad('P', 32, ' ') P1IMO_VGRUPPE
       , rpad('Q', 20, ' ') P1IMO_KENNZ
       , rpad('R', 40, ' ') P1IMO_MERKU
       , rpad('S', 36, ' ') P1IMO_MERKE
       , rpad('T', 84, ' ') P1IMO_FLAMM
       , rpad('U', 10, ' ') P1PRODUKTGRP
       , rpad('V', 35, ' ') P1PRODUKTDSC
       , rpad('W', 81, '0') PTTEXT
       , 'PTTEXT' NOT_EXPORTED_FIELDS
    from DOC_DOCUMENT DOC
       , DOC_POSITION POS
   where DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID
     and DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_DETAIL_PZ" ("LINE_ID", "OZL_BESTMENGE", "OZL_T2NUMMER", "P1RENR", "P1REPOK", "NOT_EXPORTED_FIELDS") AS
  select 'PZ' LINE_ID
       , rpad(' ', 20) OZL_BESTMENGE
       , rpad(' ', 20) OZL_T2NUMMER
       , rpad(DMT.DMT_NUMBER, 35) P1RENR
       , rpad(POS.POS_NUMBER, 10) P1REPOK
       , to_char(null) NOT_EXPORTED_FIELDS
    from DOC_POSITION POS
       , DOC_DOCUMENT DMT
   where DMT.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID
     and DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_DETAIL_V1" ("LINE_ID", "EV_IMPORTKEY", "EV_VERPACKEY", "EV_ANZAHL", "EV_LAENGE", "EV_BREITE", "EV_HOEHE", "EV_MASSEINHEIT", "EV_TARA", "EV_MARKIERUNG", "EV_PACKSTKNR_VON", "EV_PACKSTKNR_BIS", "EV_BRUTTOGEW", "EV_VERPACKBEZ", "EV_VOLUMEN", "EV_KATEGORIE", "EV_VERPACKNR", "EV_VERPACKTYP", "EV_EDECCONTAINERNR", "EV_IMPORTKEY_HIGH", "POS_NUMBER", "NOT_EXPORTED_FIELDS") AS
  select 'V1' LINE_ID
       , rpad(' ', 10) EV_IMPORTKEY
       , rpad(' ', 20) EV_VERPACKEY
       , rpad(' ', 10) EV_ANZAHL
       , rpad(' ', 5) EV_LAENGE
       , rpad(' ', 5) EV_BREITE
       , rpad(' ', 5) EV_HOEHE
       , rpad(' ', 2) EV_MASSEINHEIT
       , rpad(' ', 20) EV_TARA
       , rpad(' ', 250) EV_MARKIERUNG
       , rpad(' ', 15) EV_PACKSTKNR_VON
       , rpad(' ', 15) EV_PACKSTKNR_BIS
       , rpad(' ', 20) EV_BRUTTOGEW
       , rpad(' ', 55) EV_VERPACKBEZ
       , rpad(' ', 20) EV_VOLUMEN
       , rpad(' ', 15) EV_KATEGORIE
       , rpad(' ', 30) EV_VERPACKNR
       , rpad(' ', 3) EV_VERPACKTYP
       , rpad(' ', 11) EV_EDECCONTAINERNR
       , rpad(' ', 10) EV_IMPORTKEY_HIGH
       , POS.POS_NUMBER
       , 'POS_NUMBER' NOT_EXPORTED_FIELDS
    from DOC_POSITION POS
       , DOC_DOCUMENT DMT
   where DMT.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID
     and DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_DETAIL_VP" ("LINE_ID", "EV_IMPORTKEY", "P1REPOK", "EVP_POSMENGE", "EVP_POSNETTO", "P1REPO", "NOT_EXPORTED_FIELDS") AS
  select 'VP' LINE_ID
       , rpad(' ', 10) EV_IMPORTKEY
       , rpad(POS.POS_NUMBER, 10) P1REPOK
       , rpad(' ', 20) EVP_POSMENGE
       , rpad(' ', 10) EVP_POSNETTO
       , rpad(' ', 10) P1REPO
       , to_char(null) NOT_EXPORTED_FIELDS
    from DOC_POSITION POS
       , DOC_DOCUMENT DMT
   where DMT.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID
     and DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_FOOT_HF" ("LINE_ID", "LINE_TEXT") AS
  select 'HF' LINE_ID
       , replace(FOO_FOOT_TEXT, chr(10), '') LINE_TEXT
   from DOC_FOOT
  where DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_HEAD" ("LINE_ID", "H1MANR", "H1ARNR", "H1ARDA", "H1KOMNR", "H2AUFNR", "H1LSNR", "H1KDNR", "H1KDUI", "H1KNA1", "H1KNA2", "H1KNA5", "H1KNA6", "H1KSTR", "H1KNA7", "H1KPLZ", "H1KORT", "H2HLLD", "H1KBEO", "H1KPLD", "H1HLLD", "H1KTEL", "H1KFAX", "H1KTLX", "H1LRNR", "H1LNA1", "H1LNA2", "H1LNA5", "H1LNA6", "H1LSTR", "H1LNA7", "H1LPLZ", "H1LORT", "H1LLAN", "H1LBEO", "H1LPLD", "H1LTEL", "H1LFAX", "H1LTLX", "H1BSLD", "H2ICCD", "H2ICOR", "H1VAIN", "H1VAR2", "H1VART", "H1GRCD", "H2ZBED", "H2ZEICH", "H1GESBERID", "H1AUFARTID", "H1MUSTIDNR", "H1DGESCH", "H2REBT", "H1REBT", "H1WACD", "H1KURS", "H2KUDI", "H2GWNE", "H2GWBR", "H2SPED", "H1SNA1", "H1SNA2", "H1SNA5", "H1SNA6", "H1SSTR", "H1SNA7", "H1SORT", "H2SLAND", "H1SBEO", "H1SLAN", "H1STEL", "H1SFAX", "H1STLX", "H1MARK1", "H1MARK2", "H1MARK3", "H1MARK4", "H1MARK5", "H1MARK6", "H1MARK7", "H1MARK8", "H1MARK9", "H1MARK10", "H1FRACHT_KOST", "H1FRACHT_KOST1", "H1VERPACK_KOST", "H1VERPACK_KOST1", "H1VERSICH_KOST", "H1VERSICH_KOST1", "H1ZOLL_KOST", "H1ZOLL_KOST1", "H1SONST_KOST", "H1SONST_KOST1", "H2BFNAK", "H1HOTINVAR", "H2INITTXT1", "H2INITTXT2", "H2INITTXT3", "H2INITTXT4", "H2INITTXT5", "H2INITTXT6", "H2INITTXT7", "H2INITTXT8", "H2INITTXT9", "H2INITTXT10", "H2ENDTXT1", "H2ENDTXT2", "H2ENDTXT3", "H2ENDTXT4", "H2ENDTXT5", "H2ENDTXT6", "H2ENDTXT7", "H2ENDTXT8", "H2ENDTXT9", "H2ENDTXT10", "H2N1NA1", "H2N1NA2", "H2N1NA3", "H2N1STR", "H2N1ORT", "H2N1PLZ", "H2N1LAN", "H2N1TEL", "H2N1FAX", "H2N1TLX", "H2N2NA1", "H2N2NA2", "H2N2NA3", "H2N2STR", "H2N2ORT", "H2N2PLZ", "H2N2LAN", "H2N2TEL", "H2N2FAX", "H2N2TLX", "H2N3NA1", "H2N3NA2", "H2N3NA3", "H2N3STR", "H2N3ORT", "H2N3PLZ", "H2N3LAN", "H2N3TEL", "H2N3FAX", "H2N3TLX", "H2N4NA1", "H2N4NA2", "H2N4NT3", "H2N4STR", "H2N4ORT", "H2N4PLZ", "H2N4LAN", "H2N4TEL", "H2N4FAX", "H2N4TLX", "H1BSLT", "H1CONT", "H1EDAS", "H1EZTS", "H1VSAART", "H2GFKL", "H2GFTX", "H2ABL1") AS
  select 'H1' LINE_ID
       , rpad(' ', 3, ' ') H1MANR
       , rpad(DMT.DMT_NUMBER, 35, ' ') H1ARNR
       , to_char(DMT.DMT_DATE_DOCUMENT, 'DD.MM.YYYY') H1ARDA
       , rpad(' ', 35, ' ') H1KOMNR
       , rpad(nvl(DMT.DMT_PARTNER_NUMBER, ' '), 35, ' ') H2AUFNR
       , rpad(' ', 35, ' ') H1LSNR
       , rpad(nvl(substr(PER1.PER_KEY1, 1, 17), ' '), 17, ' ') H1KDNR
       , rpad(' ', 15, ' ') H1KDUI
       ,
-- ADRESSE DE FACTURATION, ON ADMET QUE C'EST LA PREMIRE ADRESSE
         rpad(nvl(substr(PER2.PER_NAME, 1, 35), ' '), 35, ' ') H1KNA1
       , rpad(' ', 35, ' ') H1KNA2
       , rpad(' ', 35, ' ') H1KNA5
       , rpad(' ', 35, ' ') H1KNA6
       , rpad(nvl(substr(DMT.DMT_ADDRESS1, 1, 35), ' '), 35, ' ') H1KSTR
       , rpad(nvl(substr(DMT.DMT_ADDRESS1, 36, 35), ' '), 35, ' ') H1KNA7
       , rpad(nvl(substr(DMT.DMT_POSTCODE1, 1, 9), ' '), 9, ' ') H1KPLZ
       , rpad(nvl(substr(DMT.DMT_TOWN1, 1, 35), ' '), 35, ' ') H1KORT
       , rpad(nvl(substr(DMT.DMT_STATE1, 1, 35), ' '), 35, ' ') H2HLLD
       , rpad(nvl(substr(DMT.DMT_POSTCODE1, 1, 30), ' '), 30, ' ') H1KBEO
       , rpad(nvl(substr(CNT1.CNTID, 1, 3), ' '), 3, ' ') H1KPLD
       , rpad(' ', 3, ' ') H1HLLD
       , rpad(' ', 25, ' ') H1KTEL
       , rpad(' ', 25, ' ') H1KFAX
       , rpad(' ', 15, ' ') H1KTLX
       ,
-- ADRESSE DE LIVRAISON, ON ADMET QUE C'EST LA 2ME ADRESSE
         rpad(nvl(substr(PER3.PER_KEY1, 1, 17), ' '), 17, ' ') H1LRNR
       , rpad(nvl(substr(PER3.PER_NAME, 1, 35), ' '), 35, ' ') H1LNA1
       , rpad(' ', 35, ' ') H1LNA2
       , rpad(' ', 35, ' ') H1LNA5
       , rpad(' ', 35, ' ') H1LNA6
       , rpad(nvl(substr(DMT.DMT_ADDRESS2, 1, 35), ' '), 35, ' ') H1LSTR
       , rpad(nvl(substr(DMT.DMT_ADDRESS2, 36, 35), ' '), 35, ' ') H1LNA7
       , rpad(nvl(substr(DMT.DMT_POSTCODE2, 1, 9), ' '), 9, ' ') H1LPLZ
       , rpad(nvl(DMT.DMT_TOWN2, ' '), 35, ' ') H1LORT
       , rpad(nvl(DMT.DMT_STATE2, ' '), 35, ' ') H1LLAN
       , rpad(nvl(DMT.DMT_STATE2, ' '), 30, ' ') H1LBEO
       , rpad(nvl(CNT2.CNTID, ' '), 3, ' ') H1LPLD
       , rpad(' ', 25, ' ') H1LTEL
       , rpad(' ', 25, ' ') H1LFAX
       , rpad(' ', 15, ' ') H1LTLX
       , rpad(' ', 30, ' ') H1BSLD
       , rpad(' ', 3, ' ') H2ICCD
       ,
-- DMT.C_INCOTERMS H2ICCD
         rpad(' ', 28, ' ') H2ICOR
       ,
-- DMT.DMT_INCOTERMS_STATE H2ICOR
         rpad(nvl(SEN1.C_CONDITION_MODE, ' '), 5, ' ') H1VAIN
       , rpad(nvl(SEN1.SEN_KEY, ' '), 35, ' ') H1VAR2
       , rpad(' ', 1, ' ') H1VART
       , rpad(' ', 4, ' ') H1GRCD
       , rpad(nvl(PCO1.PCO_DESCR, ' '), 60, ' ') H2ZBED
       , rpad(nvl(substr(DMT.DMT_REFERENCE, 1, 10), ' '), 10, ' ') H2ZEICH
       , rpad(' ', 3, ' ') H1GESBERID
       , rpad(' ', 3, ' ') H1AUFARTID
       , rpad(' ', 15, ' ') H1MUSTIDNR
       , rpad(' ', 1, ' ') H1DGESCH
       , to_char(FOO1.FOO_GOOD_TOT_AMOUNT_B, 'FM0000000000000V99') H2REBT
       , to_char(FOO1.FOO_GOOD_TOTAL_AMOUNT, 'FM0000000000000V99') H1REBT
       , rpad(nvl(CUR.CURRENCY, ' '), 3, ' ') H1WACD
       , to_char(0, 'FM00000000V999999') H1KURS
       , to_char(0, 'FM000000') H2KUDI
       , to_char(FOO1.FOO_TOTAL_NET_WEIGHT, 'FM000000000000V999') H2GWNE
       , to_char(FOO1.FOO_TOTAL_GROSS_WEIGHT, 'FM0000000000000V99') H2GWBR
       ,
-- ADRESSE DU TRANSPORTEUR, PROVIENT DU MODE D'EXPDITION
         rpad(nvl(substr(PER4.PER_KEY1, 1, 17), ' '), 17, ' ') H2SPED
       , rpad(nvl(substr(PER4.PER_NAME, 1, 35), ' '), 35, ' ') H1SNA1
       , rpad(' ', 35, ' ') H1SNA2
       , rpad(' ', 35, ' ') H1SNA5
       , rpad(' ', 35, ' ') H1SNA6
       , rpad(nvl(substr(ADD3.ADD_ADDRESS1, 1, 35), ' '), 35, ' ') H1SSTR
       , rpad(nvl(substr(ADD3.ADD_ADDRESS1, 36, 35), ' '), 35, ' ') H1SNA7
       , rpad(nvl(ADD3.ADD_CITY, ' '), 35, ' ') H1SORT
       , rpad(nvl(ADD3.ADD_STATE, ' '), 35, ' ') H2SLAND
       , rpad(nvl(ADD3.ADD_STATE, ' '), 30, ' ') H1SBEO
       , rpad(nvl(CNT3.CNTID, ' '), 3, ' ') H1SLAN
       , rpad(' ', 25, ' ') H1STEL
       , rpad(' ', 25, ' ') H1SFAX
       , rpad(' ', 15, ' ') H1STLX
       ,
--Marquage
         rpad(nvl(substr(FOO1.FOO_MARKING, 1, 35), ' '), 35, ' ') H1MARK1
       , rpad(nvl(substr(FOO1.FOO_MARKING, 36, 35), ' '), 35, ' ') H1MARK2
       , rpad(nvl(substr(FOO1.FOO_MARKING, 71, 35), ' '), 35, ' ') H1MARK3
       , rpad(nvl(substr(FOO1.FOO_MARKING, 106, 35), ' '), 35, ' ') H1MARK4
       , rpad(nvl(substr(FOO1.FOO_MARKING, 141, 35), ' '), 35, ' ') H1MARK5
       , rpad(nvl(substr(FOO1.FOO_MARKING, 176, 35), ' '), 35, ' ') H1MARK6
       , rpad(nvl(substr(FOO1.FOO_MARKING, 211, 35), ' '), 35, ' ') H1MARK7
       , rpad(nvl(substr(FOO1.FOO_MARKING, 246, 35), ' '), 35, ' ') H1MARK8
       , rpad(nvl(substr(FOO1.FOO_MARKING, 281, 35), ' '), 35, ' ') H1MARK9
       , rpad(nvl(substr(FOO1.FOO_MARKING, 316, 35), ' '), 35, ' ') H1MARK10
       , to_char(0, 'FM0000000000V99') H1FRACHT_KOST
       , to_char(0, 'FM0000000000V99') H1FRACHT_KOST1
       , to_char(0, 'FM0000000000V99') H1VERPACK_KOST
       , to_char(0, 'FM0000000000V99') H1VERPACK_KOST1
       , to_char(0, 'FM0000000000V99') H1VERSICH_KOST
       , to_char(0, 'FM0000000000V99') H1VERSICH_KOST1
       , to_char(0, 'FM0000000000V99') H1ZOLL_KOST
       , to_char(0, 'FM0000000000V99') H1ZOLL_KOST1
       , to_char(0, 'FM0000000000V99') H1SONST_KOST
       , to_char(0, 'FM0000000000V99') H1SONST_KOST1
       , rpad(' ', 3, ' ') H2BFNAK
       , 'N' H1HOTINVAR
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 1, 80), ' '), 80, ' ') H2INITTXT1
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 81, 80), ' '), 80, ' ') H2INITTXT2
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 161, 80), ' '), 80, ' ') H2INITTXT3
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 241, 80), ' '), 80, ' ') H2INITTXT4
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 321, 80), ' '), 80, ' ') H2INITTXT5
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 401, 80), ' '), 80, ' ') H2INITTXT6
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 481, 80), ' '), 80, ' ') H2INITTXT7
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 561, 80), ' '), 80, ' ') H2INITTXT8
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 641, 80), ' '), 80, ' ') H2INITTXT9
       , rpad(nvl(substr(DMT.DMT_HEADING_TEXT, 721, 80), ' '), 80, ' ') H2INITTXT10
       ,
-- TEXTE DE PIED
         rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 1, 80), ' '), 80, ' ') H2ENDTXT1
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 81, 80), ' '), 80, ' ') H2ENDTXT2
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 161, 80), ' '), 80, ' ') H2ENDTXT3
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 241, 80), ' '), 80, ' ') H2ENDTXT4
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 321, 80), ' '), 80, ' ') H2ENDTXT5
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 401, 80), ' '), 80, ' ') H2ENDTXT6
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 481, 80), ' '), 80, ' ') H2ENDTXT7
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 561, 80), ' '), 80, ' ') H2ENDTXT8
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 641, 80), ' '), 80, ' ') H2ENDTXT9
       , rpad(nvl(substr(FOO1.FOO_FOOT_TEXT, 721, 80), ' '), 80, ' ') H2ENDTXT10
       ,
-- NOTIFY 1
         rpad(' ', 35, ' ') H2N1NA1
       , rpad(' ', 35, ' ') H2N1NA2
       , rpad(' ', 35, ' ') H2N1NA3
       , rpad(' ', 35, ' ') H2N1STR
       , rpad(' ', 35, ' ') H2N1ORT
       , rpad(' ', 9, ' ') H2N1PLZ
       , rpad(' ', 35, ' ') H2N1LAN
       , rpad(' ', 25, ' ') H2N1TEL
       , rpad(' ', 25, ' ') H2N1FAX
       , rpad(' ', 15, ' ') H2N1TLX
       ,
-- NOTIFY 2
         rpad(' ', 35, ' ') H2N2NA1
       , rpad(' ', 35, ' ') H2N2NA2
       , rpad(' ', 35, ' ') H2N2NA3
       , rpad(' ', 35, ' ') H2N2STR
       , rpad(' ', 35, ' ') H2N2ORT
       , rpad(' ', 9, ' ') H2N2PLZ
       , rpad(' ', 35, ' ') H2N2LAN
       , rpad(' ', 25, ' ') H2N2TEL
       , rpad(' ', 25, ' ') H2N2FAX
       , rpad(' ', 15, ' ') H2N2TLX
       ,
-- NOTIFY 3
         rpad(' ', 35, ' ') H2N3NA1
       , rpad(' ', 35, ' ') H2N3NA2
       , rpad(' ', 35, ' ') H2N3NA3
       , rpad(' ', 35, ' ') H2N3STR
       , rpad(' ', 35, ' ') H2N3ORT
       , rpad(' ', 9, ' ') H2N3PLZ
       , rpad(' ', 35, ' ') H2N3LAN
       , rpad(' ', 25, ' ') H2N3TEL
       , rpad(' ', 25, ' ') H2N3FAX
       , rpad(' ', 15, ' ') H2N3TLX
       ,
-- NOTIFY 4
         rpad(' ', 35, ' ') H2N4NA1
       , rpad(' ', 35, ' ') H2N4NA2
       , rpad(' ', 35, ' ') H2N4NT3
       , rpad(' ', 35, ' ') H2N4STR
       , rpad(' ', 35, ' ') H2N4ORT
       , rpad(' ', 9, ' ') H2N4PLZ
       , rpad(' ', 35, ' ') H2N4LAN
       , rpad(' ', 25, ' ') H2N4TEL
       , rpad(' ', 25, ' ') H2N4FAX
       , rpad(' ', 15, ' ') H2N4TLX
       ,
-- SUITE
         rpad(' ', 30, ' ') H1BSLT
       , rpad(' ', 3, ' ') H1CONT
       , rpad(' ', 8, ' ') H1EDAS
       , rpad(' ', 5, ' ') H1EZTS
       , rpad(' ', 15, ' ') H1VSAART
       , rpad(' ', 20, ' ') H2GFKL
       , rpad(' ', 50, ' ') H2GFTX
       , rpad(' ', 30, ' ') H2ABL1
    from DOC_DOCUMENT DMT
       , PAC_PERSON PER1
       , PAC_PERSON PER2
       , PAC_PERSON PER3
       , PAC_PERSON PER4
       , PAC_CUSTOM_PARTNER CUS
       , PAC_ADDRESS ADD1
       , PAC_ADDRESS ADD2
       , PAC_ADDRESS ADD3
       , PCS.PC_CNTRY CNT1
       , PCS.PC_CNTRY CNT2
       , PCS.PC_CNTRY CNT3
       , PAC_SENDING_CONDITION SEN1
       , PAC_PAYMENT_CONDITION PCO1
       , DOC_FOOT FOO1
       , ACS_FINANCIAL_CURRENCY FIN
       , PCS.PC_CURR CUR
   where DMT.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID
     and DMT.PAC_THIRD_ID = PER1.PAC_PERSON_ID
     and DMT.PAC_THIRD_ID = CUS.PAC_CUSTOM_PARTNER_ID
     and DMT.PAC_ADDRESS_ID = ADD1.PAC_ADDRESS_ID
     and ADD1.PAC_PERSON_ID = PER2.PAC_PERSON_ID
     and CNT1.PC_CNTRY_ID = DMT.PC_CNTRY_ID
     and DMT.PAC_PAC_ADDRESS_ID = ADD2.PAC_ADDRESS_ID(+)
     and ADD2.PAC_PERSON_ID = PER3.PAC_PERSON_ID(+)
     and DMT.PC__PC_CNTRY_ID = CNT2.PC_CNTRY_ID(+)
     and DMT.PAC_SENDING_CONDITION_ID = SEN1.PAC_SENDING_CONDITION_ID(+)
     and SEN1.PAC_ADDRESS_ID = ADD3.PAC_ADDRESS_ID(+)
     and ADD3.PC_CNTRY_ID = CNT3.PC_CNTRY_ID(+)
     and ADD3.PAC_PERSON_ID = PER4.PAC_PERSON_ID(+)
     and DMT.PAC_PAYMENT_CONDITION_ID = PCO1.PAC_PAYMENT_CONDITION_ID(+)
     and DMT.DOC_DOCUMENT_ID = FOO1.DOC_FOOT_ID
     and DMT.ACS_FINANCIAL_CURRENCY_ID = FIN.ACS_FINANCIAL_CURRENCY_ID
     and FIN.PC_CURR_ID = CUR.PC_CURR_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E002_HEAD_HM" ("LINE_ID", "LINE_TEXT") AS
  select 'HM' LINE_ID
       , replace(DMT_HEADING_TEXT, chr(10), '') LINE_TEXT
    from DOC_DOCUMENT
   where DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E003_DETAIL" ("F001", "F002", "F003", "F004", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '02' F001,
   DOC.DMT_NUMBER F002,
   GOO_MAJOR_REFERENCE F003,
   TO_CHAR(POS.POS_FINAL_QUANTITY, 'FM00000000000V9999') F004,
   '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
   DOC_DOCUMENT DOC,
   GCO_GOOD GCO
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
   POS.GCO_GOOD_ID = GCO.GCO_GOOD_ID AND
   POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E003_HEADER" ("F001", "F002", "F003", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '01' F001,
   DOC.DMT_NUMBER F002,
   TO_CHAR(DMT_DATE_DOCUMENT, 'DD.MM.YYYY') F003,
   '' NOT_EXPORTED_FIELDS
FROM
   DOC_DOCUMENT DOC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E800_DETAIL_CC" ("P001", "P002", "P003", "P004", "P005", "P006", "P007", "P008", "P009", "P010", "P011", "P012", "P013", "P014", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '02' P001,
   RPAD (SUBSTR(POS.POS_TEXT_1,1,INSTR(POS.POS_TEXT_1,'/',1)-1),10,' ') P002,
   LPAD (SUBSTR(POS.POS_TEXT_1,INSTR(POS.POS_TEXT_1,'/',1)+1,5), 5, ' ') P003,
   RPAD (GOO.GOO_MAJOR_REFERENCE, 18, ' ') P004,
   RPAD (SUBSTR(POS.POS_LONG_DESCRIPTION,1,40), 40, ' ') P005,
   RPAD (' ', 10, ' ') P006,
   TO_CHAR (PDE.PDE_FINAL_DELAY, 'DD.MM.YYYY') P007,
   LPAD (TO_CHAR (POS.POS_NET_VALUE_EXCL, 'FM9999990.00'), 10, ' ') P008,
   LPAD (TO_CHAR (POS.POS_NET_VALUE_INCL, 'FM9999990.00'), 10, ' ') P009,
   LPAD (TO_CHAR (POS.POS_NET_VALUE_INCL - POS.POS_NET_VALUE_EXCL, 'FM9999990.00'), 10, ' ') P010,
   LPAD (TO_CHAR (POS.POS_FINAL_QUANTITY, 'FM99990.0000'), 10, ' ') P011,
   RPAD (DOC.DMT_NUMBER,10 ,' ') P012,
   LPAD (' ', 3, ' ') P013,
   LPAD (' ', 10, ' ' ) P014,
   '' NOT_EXPORTED_FIELDS
FROM
   DOC_POSITION POS,
   DOC_POSITION_DETAIL PDE,
   DOC_DOCUMENT DOC,
   GCO_GOOD GOO,
   DOC_RECORD REC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
   POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID  AND
   POS.DOC_POSITION_ID = PDE.DOC_POSITION_ID AND
   POS.DOC_RECORD_ID = REC.DOC_RECORD_ID (+)  AND
   POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E800_DETAIL_COM" ("F001", "F002", "F003", "P001_03", "P001_04", "P001_05", "P001_06", "P001_07", "P001_08", "P001_09", "P001_10", "P001_11", "P001_12", "P001_13", "P001_14", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '02' F001,
   RPAD (DOC.DMT_NUMBER,10 ,' ') F002,
   LPAD(TO_CHAR(POS_NUMBER), 4, '0') F003,
   RPAD(GOO_MAJOR_REFERENCE, 18, ' ') P001_03,
   TO_CHAR(POS.POS_FINAL_QUANTITY, 'FM00000000000V9999') P001_04,
   TO_CHAR(POS.POS_VALUE_QUANTITY, 'FM00000000000V9999') P001_05,
   RPAD(' ', 3, ' ') P001_06,
   DECODE(REC.RCO_NUMBER, NULL, LPAD(' ', 9), LPAD(TO_CHAR(REC.RCO_NUMBER), 9 , '0')) P001_07,
   RPAD(NVL(REC.RCO_TITLE, ' '), 30, ' ') P001_08,
   TO_CHAR(POS.POS_NET_VALUE_EXCL, 'FM00000000000V9999') P001_09,
   TO_CHAR(POS.POS_NET_VALUE_INCL - POS.POS_NET_VALUE_EXCL, 'FM00000000000V9999') P001_10,
   TO_CHAR(POS.POS_NET_VALUE_INCL, 'FM00000000000V9999') P001_11,
   TO_CHAR(POS_NET_TARIFF) P001_12,
   RPAD(POS.POS_SHORT_DESCRIPTION, 30, ' ') P001_13,
   RPAD(' ', 30 , ' ') P001_14,
   '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
   DOC_DOCUMENT DOC,
   GCO_GOOD GCO,
   DOC_RECORD REC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
   POS.GCO_GOOD_ID = GCO.GCO_GOOD_ID  AND
   POS.DOC_RECORD_ID = REC.DOC_RECORD_ID (+)  AND
   POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E800_HEADER_CC" ("F001", "F002", "F003", "F004", "F005", "F006", "F007", "F008", "F009", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '01' F001,
   RPAD (DOC.DMT_PARTNER_NUMBER,10 ,' ') F002,
   TO_CHAR(DOC.DMT_DATE_DOCUMENT, 'DD.MM.YYYY') F003,
   LPAD (TO_CHAR(FOO.FOO_DOCUMENT_TOTAL_AMOUNT - FOO.FOO_TOTAL_VAT_AMOUNT, 'FM999990.00'), 10) F004,
   LPAD (TO_CHAR(DOC_EDI_FUNCTION.GETPOSITIONSNUMBER('1')), 5) F005,
   DECODE (DOC_EDI_FUNCTION.EXPORTEDEDI, 1, 'U', 'N') F006,
   LPAD (TO_CHAR(FOO.FOO_TOTAL_VAT_AMOUNT, 'FM999990.00'), 10) F007,
   LPAD (TO_CHAR(FOO.FOO_DOCUMENT_TOTAL_AMOUNT, 'FM999990.00'), 10) F008,
   RPAD (DOC.DMT_NUMBER,10 ,' ') F009,
   '' NOT_EXPORTED_FIELDS
FROM
   DOC_DOCUMENT DOC,
   DOC_FOOT FOO
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID AND
   DOC.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E800_HEADER_COM" ("F001", "F002", "F003", "F004", "F005", "F006", "F007", "F008", "F009", "NOT_EXPORTED_FIELDS") AS
  SELECT
   '01' F001,
   RPAD (DOC.DMT_NUMBER,10 ,' ') F002,
   TO_CHAR(DMT_DATE_DOCUMENT, 'DD.MM.YYYY') F003,
   LPAD (TO_CHAR(FOO.FOO_DOCUMENT_TOTAL_AMOUNT - FOO.FOO_TOTAL_VAT_AMOUNT, 'FM999999.00'), 10) F004,
   LPAD (TO_CHAR(DOC_EDI_FUNCTION.GETPOSITIONSNUMBER('1')), 5) F005,
   DECODE (DOC_EDI_FUNCTION.EXPORTEDEDI, 1, 'U', 'N') F006,
   LPAD (TO_CHAR(FOO.FOO_TOTAL_VAT_AMOUNT, 'FM999999.00'), 10) F007,
   LPAD (TO_CHAR(FOO.FOO_DOCUMENT_TOTAL_AMOUNT, 'FM999999.00'), 10) F008,
   'XXXXXXXXXX' F009,
   '' NOT_EXPORTED_FIELDS
FROM
   DOC_DOCUMENT DOC,
   DOC_FOOT FOO
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID AND
   DOC.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E900_DETAIL" ("P001_00", "P001_01", "P001_02", "P001_03", "P001_04", "P001_05", "P001_06", "P001_07", "P001_08", "P001_09", "P001_10", "P001_11", "P001_12", "P001_13", "P001_14", "NOT_EXPORTED_FIELDS") AS
  SELECT
   'P001' P001_00,
   RPAD(DOC.DMT_NUMBER, 30, ' ') P001_01,
   LPAD(TO_CHAR(POS_NUMBER), 5, '0') P001_02,
   RPAD(GOO_MAJOR_REFERENCE, 30, ' ') P001_03,
   TO_CHAR(POS.POS_FINAL_QUANTITY, 'FM00000000000V9999') P001_04,
   TO_CHAR(POS.POS_VALUE_QUANTITY, 'FM00000000000V9999') P001_05,
   RPAD(' ', 3, ' ') P001_06,
   DECODE(REC.RCO_NUMBER, NULL, LPAD(' ', 9), LPAD(TO_CHAR(REC.RCO_NUMBER), 9 , '0')) P001_07,
   RPAD(NVL(REC.RCO_TITLE, ' '), 30, ' ') P001_08,
   TO_CHAR(POS.POS_NET_VALUE_EXCL, 'FM00000000000V9999') P001_09,
   TO_CHAR(POS.POS_NET_VALUE_INCL - POS.POS_NET_VALUE_EXCL, 'FM00000000000V9999') P001_10,
   TO_CHAR(POS.POS_NET_VALUE_INCL, 'FM00000000000V9999') P001_11,
   TO_CHAR(POS_NET_TARIFF) P001_12,
   RPAD(POS.POS_SHORT_DESCRIPTION, 30, ' ') P001_13,
   RPAD(' ', 30 , ' ') P001_14,
   '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
   DOC_DOCUMENT DOC,
   GCO_GOOD GCO,
   DOC_RECORD REC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
   POS.GCO_GOOD_ID = GCO.GCO_GOOD_ID  AND
   POS.DOC_RECORD_ID = REC.DOC_RECORD_ID (+)  AND
   POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E900_DETAIL_TEXT" ("P002_00", "P002_01", "P002_02", "P002_03", "P002_04", "NOT_EXPORTED_FIELDS") AS
  SELECT
  'P002' P002_00,
  RPAD(DOC.DMT_NUMBER, 30, ' ') P002_01,
  LPAD(TO_CHAR(POS_NUMBER), 5, '0') P002_02,
  '001' P002_03,
  RPAD(NVL(DOC_EDI_FUNCTION.ReplaceCtrl(POS.POS_FREE_DESCRIPTION), ' '), 1950, ' ') P002_04,
  '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
     DOC_DOCUMENT DOC
WHERE
  DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
  POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
  POS.C_GAUGE_TYPE_POS = '1' AND
  NVL(POS.POS_FREE_DESCRIPTION, ' ') <> ' '
UNION SELECT
  'P002' P002_00,
  RPAD(DOC.DMT_NUMBER, 30, ' ') P002_01,
  LPAD(TO_CHAR(POS_NUMBER), 5, '0') P002_02,
  '002' P002_03,
  RPAD(NVL(DOC_EDI_FUNCTION.ReplaceCtrl(POS.POS_BODY_TEXT), ' '), 1950, ' ') P002_04,
  '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
     DOC_DOCUMENT DOC
WHERE
  DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
  POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
  POS.C_GAUGE_TYPE_POS = '1' AND
  NVL(POS.POS_BODY_TEXT, ' ') <> ' '
UNION SELECT
  'P002' P002_00,
  RPAD(DOC.DMT_NUMBER, 30, ' ') P002_01,
  LPAD(TO_CHAR(POS_NUMBER), 5, '0') P002_02,
  '003' P002_03,
  RPAD(NVL(DOC_EDI_FUNCTION.ReplaceCtrl(POS.POS_LONG_DESCRIPTION), ' '), 1950, ' ') P002_04,
  '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
     DOC_DOCUMENT DOC
WHERE
  DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
  POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
  POS.C_GAUGE_TYPE_POS = '1' AND
  NVL(POS.POS_LONG_DESCRIPTION, ' ') <> ' '




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E900_FILE_HEAD" ("HEAD_00", "HEAD_01", "HEAD_02", "HEAD_03", "HEAD_04", "HEAD_05", "HEAD_06", "NOT_EXPORTED_FIELDS") AS
  SELECT
   'HEAD' HEAD_00,
   TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') HEAD_01,
   'INVOIC' HEAD_02,
   '01' HEAD_03,
   RPAD(NVL(DOC_EDI_FUNCTION.GETPARAMVALUE('PARTNER'), NVL(PAR.CUS_SUPPLIER_NUMBER, ' ')), 13, ' ') HEAD_04,
   RPAD(NVL(PAR.CUS_EAN_NUMBER, ' '), 13, ' ') HEAD_05,
   RPAD('REMARQUE', 30, ' ') HEAD_06,
   '' NOT_EXPORTED_FIELDS
FROM DOC_DOCUMENT DOC,
   PAC_CUSTOM_PARTNER PAR
WHERE
   DOC.PAC_THIRD_ID = PAR.PAC_CUSTOM_PARTNER_ID (+) AND
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E900_HEAD" ("H001_00", "H001_01", "H001_02", "H001_03", "H001_04", "H001_05", "H001_06", "H001_07", "H001_08", "H001_09", "H001_10", "H001_11", "H001_12", "H001_13", "H001_14", "NOT_EXPORTED_FIELDS") AS
  SELECT
   'H001' H001_00,
   RPAD(DOC.DMT_NUMBER, 30, ' ') H001_01,
   DECODE(GAU.C_GAUGE_TITLE, '8', '01', '9', '02', '  ') H001_02,
   TO_CHAR(DMT_DATE_DOCUMENT, 'YYYYMMDD') H001_03,
   TO_CHAR(NVL(DMT_DATE_VALUE, DMT_DATE_DOCUMENT), 'YYYYMMDD') H001_04,
   TO_CHAR(NVL(DMT_DATE_DELIVERY, DMT_DATE_DOCUMENT), 'YYYYMMDD') H001_05,
   DECODE(REC.RCO_NUMBER, NULL, LPAD(' ', 9), LPAD(TO_CHAR(REC.RCO_NUMBER), 9 , '0')) H001_06,
   RPAD(NVL(REC.RCO_TITLE, ' '), 30, ' ') H001_07,
   RPAD(NVL(PAC.SEN_KEY, ' '), 30, ' ') H001_08,
   RPAD(NVL(DMT_REFERENCE, ' '), 50, ' ') H001_09,
   RPAD(NVL(CUR.CURRENCY, ' '), 3, ' ') H001_10,
   RPAD(NVL(LAN.LANID, ' '), 2, ' ') H001_11,
   RPAD(NVL(DOC.C_INCOTERMS, ' '), 10, ' ') H001_12,
   RPAD(NVL(DOC.DMT_INCOTERMS_PLACE, ' '), 70, ' ') H001_13,
   RPAD(NVL(PAY.PCO_DESCR, ' '), 50, ' ') H001_14,
   '' NOT_EXPORTED_FIELDS
FROM DOC_DOCUMENT DOC,
   DOC_GAUGE_STRUCTURED GAU,
   DOC_RECORD REC,
   PAC_SENDING_CONDITION PAC,
   ACS_FINANCIAL_CURRENCY FIN,
   PAC_PAYMENT_CONDITION PAY,
   PCS.PC_CURR CUR,
   PCS.PC_LANG LAN
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   DOC.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID  AND
   DOC.DOC_RECORD_ID = REC.DOC_RECORD_ID (+) AND
   DOC.PAC_SENDING_CONDITION_ID = PAC.PAC_SENDING_CONDITION_ID (+)  AND
   DOC.ACS_FINANCIAL_CURRENCY_ID = FIN.ACS_FINANCIAL_CURRENCY_ID (+)  AND
   DOC.PAC_PAYMENT_CONDITION_ID = PAY.PAC_PAYMENT_CONDITION_ID (+)  AND
   FIN.PC_CURR_ID = CUR.PC_CURR_ID (+)  AND
   DOC.PC_LANG_ID = LAN.PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E900_HEAD_ADR" ("H002_00", "H002_01", "H002_02", "H002_03", "H002_04", "H002_05", "H002_06", "H002_07", "H002_08", "NOT_EXPORTED_FIELDS") AS
  SELECT
   'H002' H002_00,
   RPAD(DOC.DMT_NUMBER, 30, ' ') H002_01,
   RPAD(' ', 3, ' ') H002_02,
   '1' H002_03,
   RPAD(NVL(CNT.CNTID, ' '),  5, ' ') H002_04,
   RPAD(NVL(DOC.DMT_POSTCODE1, ' '), 10, ' ') H002_05,
   RPAD(NVL(DOC.DMT_TOWN1, ' '), 30, ' ') H002_06,
   RPAD(NVL(DOC.DMT_ADDRESS1, ' '), 255, ' ') H002_07,
   RPAD(NVL(DOC.DMT_STATE1, ' '), 30, ' ') H002_08,
   '' NOT_EXPORTED_FIELDS
FROM DOC_DOCUMENT DOC,
   PCS.PC_CNTRY CNT
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   DOC.PC_CNTRY_ID = CNT.PC_CNTRY_ID (+)
UNION SELECT
   'H002' H002_00,
   RPAD(DOC.DMT_NUMBER, 30, ' ') H002_01,
   RPAD(' ', 3, ' ') H002_02,
   '2' H002_03,
   RPAD(CNT.CNTID, 5, ' ') H002_04,
   RPAD(NVL(DOC.DMT_POSTCODE2, ' '), 10, ' ') H002_05,
   RPAD(NVL(DOC.DMT_TOWN2, ' '), 30, ' ') H002_06,
   RPAD(NVL(DOC.DMT_ADDRESS2, ' '), 255, ' ') H002_07,
   RPAD(NVL(DOC.DMT_STATE2, ' '), 30, ' ') H002_08,
   '' NOT_EXPORTED_FIELDS
FROM DOC_DOCUMENT DOC,
   PCS.PC_CNTRY CNT
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   DOC.PC__PC_CNTRY_ID = CNT.PC_CNTRY_ID (+)
UNION SELECT
   'H002' H002_00,
   RPAD(DOC.DMT_NUMBER, 30, ' ') H002_01,
   RPAD(' ', 3, ' ') H002_02,
   '3' H002_03,
   RPAD(CNT.CNTID, 5, ' ') H002_04,
   RPAD(NVL(DOC.DMT_POSTCODE3, ' '), 10, ' ') H002_05,
   RPAD(NVL(DOC.DMT_TOWN3, ' '), 30, ' ') H002_06,
   RPAD(NVL(DOC.DMT_ADDRESS3, ' '), 255, ' ') H002_07,
   RPAD(NVL(DOC.DMT_STATE3, ' '), 30, ' ') H002_08,
   '' NOT_EXPORTED_FIELDS
FROM DOC_DOCUMENT DOC,
   PCS.PC_CNTRY CNT
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   DOC.PC_2_PC_CNTRY_ID = CNT.PC_CNTRY_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E900_TEXT" ("P003_00", "P003_01", "P003_02", "P003_03", "NOT_EXPORTED_FIELDS") AS
  SELECT
   'P003' P003_00,
   RPAD(DOC.DMT_NUMBER, 30, ' ') P003_01,
   LPAD(TO_CHAR(POS_NUMBER), 5, '0') P003_02,
   RPAD(NVL(DOC_EDI_FUNCTION.ReplaceCtrl(POS.POS_BODY_TEXT), ' '), 1950, ' ') P003_03,
   '' NOT_EXPORTED_FIELDS
FROM DOC_POSITION POS,
   DOC_DOCUMENT DOC
WHERE
   DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
   POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
   POS.C_GAUGE_TYPE_POS = '4' AND
   NVL(POS.POS_BODY_TEXT, ' ') <> ' '




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E950_DETAIL_EAN" ("F001", "F002", "F003", "F004", "F005") AS
  SELECT
  'A' F001,
  ';' F002,
  TO_CHAR(POS.POS_FINAL_QUANTITY, 'FM999999999.0000') F003,
  ';' F004,
  RTRIM(GOO_EAN_CODE) F005
FROM DOC_POSITION POS,
     DOC_DOCUMENT DOC,
	 GCO_GOOD GCO
WHERE
  DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
  POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
  POS.GCO_GOOD_ID = GCO.GCO_GOOD_ID AND
  POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E950_DETAIL_PRINC" ("F001", "F002", "F003", "F004", "F005") AS
  SELECT
  'A' F001,
  ';' F002,
  TO_CHAR(POS.POS_FINAL_QUANTITY, 'FM999999999.0000') F003,
  ';' F004,
  RTRIM(GOO_MAJOR_REFERENCE) F005
FROM DOC_POSITION POS,
     DOC_DOCUMENT DOC,
	 GCO_GOOD GCO
WHERE
  DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
  POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
  POS.GCO_GOOD_ID = GCO.GCO_GOOD_ID AND
  POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_E950_DETAIL_SEC" ("F001", "F002", "F003", "F004", "F005") AS
  SELECT
  'A' F001,
  ';' F002,
  TO_CHAR(POS.POS_FINAL_QUANTITY, 'FM999999999.0000') F003,
  ';' F004,
  RTRIM(GOO_SECONDARY_REFERENCE) F005
FROM DOC_POSITION POS,
     DOC_DOCUMENT DOC,
	 GCO_GOOD GCO
WHERE
  DOC.DOC_DOCUMENT_ID = DOC_EDI_FUNCTION.GETDOCUMENTID  AND
  POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID  AND
  POS.GCO_GOOD_ID = GCO.GCO_GOOD_ID AND
  POS.C_GAUGE_TYPE_POS = '1'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DADR01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "ADRESSE-QUAL", "PARTNER-ID", "PARTNER-QUAL", "NAME-ZEILE-1", "NAME-ZEILE-2", "NAME-ZEILE-3", "NAME-ZEILE-4", "STRASSE-1", "STRASSE-2", "STRASSE-3", "STRASSE-4", "ORT", "PLZ", "LAND", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "ADRESSE-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 35)) "PARTNER-ID"
 , trim(substr(DID.DID_VALUE, 91 , 3)) "PARTNER-QUAL"
 , trim(substr(DID.DID_VALUE, 95 , 35)) "NAME-ZEILE-1"
 , trim(substr(DID.DID_VALUE, 131 , 35)) "NAME-ZEILE-2"
 , trim(substr(DID.DID_VALUE, 167 , 35)) "NAME-ZEILE-3"
 , trim(substr(DID.DID_VALUE, 203 , 35)) "NAME-ZEILE-4"
 , trim(substr(DID.DID_VALUE, 239 , 35)) "STRASSE-1"
 , trim(substr(DID.DID_VALUE, 275 , 35)) "STRASSE-2"
 , trim(substr(DID.DID_VALUE, 131 , 35)) "STRASSE-3"
 , trim(substr(DID.DID_VALUE, 167 , 35)) "STRASSE-4"
 , trim(substr(DID.DID_VALUE, 203 , 35)) "ORT"
 , trim(substr(DID.DID_VALUE, 239 , 9)) "PLZ"
 , trim(substr(DID.DID_VALUE, 249 , 3)) "LAND"
 , trim(substr(DID.DID_VALUE, 253 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DADR01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DAPI01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "PRODUKT-QUAL", "PRODUKT-ID-1", "PRODUKT-TYP-1", "PRODUKT-ID-2", "PRODUKT-TYP-2", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "PRODUKT-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 35)) "PRODUKT-ID-1"
 , trim(substr(DID.DID_VALUE, 91 , 3)) "PRODUKT-TYP-1"
 , trim(substr(DID.DID_VALUE, 95 , 35)) "PRODUKT-ID-2"
 , trim(substr(DID.DID_VALUE, 131 , 3)) "PRODUKT-TYP-2"
 , trim(substr(DID.DID_VALUE, 135 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DAPI01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DBET01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "ZEILE-BETRAG-QUAL", "ZEILE-BETRAG", "ZEILE-BETRAG-WAEH", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "ZEILE-BETRAG-QUAL"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 55 , 15),'9(13)v99') "ZEILE-BETRAG"
 , trim(substr(DID.DID_VALUE, 71 , 3)) "ZEILE-BETRAG-WAEH"
 , trim(substr(DID.DID_VALUE, 75 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DBET01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DCAL01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "ZU-AB-QUAL", "ZU-AB-KENNZEICHEN", "PROZENT-QUAL", "RABATT-%", "RABATT-BASIS", "RABATT-BETRAG", "RABATT-WAEHRUNG", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "ZU-AB-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 3)) "ZU-AB-KENNZEICHEN"
 , trim(substr(DID.DID_VALUE, 59 , 3)) "PROZENT-QUAL"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 63 , 5),'9(3)v99') "RABATT-%"
 , trim(substr(DID.DID_VALUE, 69 , 3)) "RABATT-BASIS"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 73 , 14),'9(12)v99') "RABATT-BETRAG"
 , trim(substr(DID.DID_VALUE, 88 , 3)) "RABATT-WAEHRUNG"
 , trim(substr(DID.DID_VALUE, 92 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DCAL01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DDAT01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "DATUM-QUAL", "DATUM", "DATUM-FORMAT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "DATUM-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 35)) "DATUM"
 , trim(substr(DID.DID_VALUE, 91 , 3)) "DATUM-FORMAT"
 , trim(substr(DID.DID_VALUE, 95 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DDAT01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DDET01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "SUB-LINE-ARTIKEL-NR", "KONFIGURATION-CODE", "ARTIKEL-NR", "ARTIKEL-TYP", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 6)) "SUB-LINE-ARTIKEL-NR"
 , trim(substr(DID.DID_VALUE, 58 , 3)) "KONFIGURATION-CODE"
 , trim(substr(DID.DID_VALUE, 62 , 35)) "ARTIKEL-NR"
 , trim(substr(DID.DID_VALUE, 98 , 3)) "ARTIKEL-TYP"
 , trim(substr(DID.DID_VALUE, 102 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DDET01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DIPR01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "PREIS-QUAL", "PREIS", "PREIS-ART", "PREIS-DEF", "PREIS-BASIS", "PREIS-EINHEIT", "PREIS-SUBLINE-AEND", "PREIS-WAEHRUNG", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "PREIS-QUAL"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 55 , 14),'9(12)v99') "PREIS"
 , trim(substr(DID.DID_VALUE, 70 , 3)) "PREIS-ART"
 , trim(substr(DID.DID_VALUE, 74 , 3)) "PREIS-DEF"
 , trim(substr(DID.DID_VALUE, 78 , 9)) "PREIS-BASIS"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "PREIS-EINHEIT"
 , trim(substr(DID.DID_VALUE, 55 , 3)) "PREIS-SUBLINE-AEND"
 , trim(substr(DID.DID_VALUE, 59 , 3)) "PREIS-WAEHRUNG"
 , trim(substr(DID.DID_VALUE, 63 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DIPR01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DIQT01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "MENGE-QUAL", "MENGE", "MENGE-EINHEIT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "MENGE-QUAL"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 55 , 14),'9(11)v999') "MENGE"
 , trim(substr(DID.DID_VALUE, 70 , 3)) "MENGE-EINHEIT"
 , trim(substr(DID.DID_VALUE, 74 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DIQT01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DITD01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "DOKUMENT-ID", "POSITION-NR", "ARTIKEL-BEZ-QUAL", "ARTIKEL-BEZ-CODE", "ARTIKEL-BEZ-1", "ARTIKEL-BEZ-2", "ARTIKEL-BEZ-ID", "ARTIKEL-BEZ-SPRACHE", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "ARTIKEL-BEZ-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 3)) "ARTIKEL-BEZ-CODE"
 , trim(substr(DID.DID_VALUE, 59 , 70)) "ARTIKEL-BEZ-1"
 , trim(substr(DID.DID_VALUE, 130 , 70)) "ARTIKEL-BEZ-2"
 , trim(substr(DID.DID_VALUE, 2 , 17)) "ARTIKEL-BEZ-ID"
 , trim(substr(DID.DID_VALUE, 20 , 3)) "ARTIKEL-BEZ-SPRACHE"
 , trim(substr(DID.DID_VALUE, 24 , 78)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DITD01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DMES01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "MASS-QUAL", "MASS-DIMENSION", "MASS-EINHEIT", "MASS-WERT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "MASS-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 3)) "MASS-DIMENSION"
 , trim(substr(DID.DID_VALUE, 59 , 3)) "MASS-EINHEIT"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 63 , 14),'9(12)v99') "MASS-WERT"
 , trim(substr(DID.DID_VALUE, 78 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DMES01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DMWS01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "MWST-QUAL", "MWST-TYP", "MWST-ID", "MWST-SATZ", "MWST-CODE", "MWST-KATEGORIE", "MWST-NUMMER", "STEUER-BETRAG", "STEUERBARE-BETRAG", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "MWST-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 3)) "MWST-TYP"
 , trim(substr(DID.DID_VALUE, 59 , 3)) "MWST-ID"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 63 , 5),'9(3)v99') "MWST-SATZ"
 , trim(substr(DID.DID_VALUE, 69 , 3)) "MWST-CODE"
 , trim(substr(DID.DID_VALUE, 73 , 3)) "MWST-KATEGORIE"
 , trim(substr(DID.DID_VALUE, 77 , 20)) "MWST-NUMMER"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 98 , 16),'9(14)v99') "STEUER-BETRAG"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 115 , 16),'9(14)v99') "STEUERBARE-BETRAG"
 , trim(substr(DID.DID_VALUE, 132 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DMWS01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DPLA01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "ORT-QUAL", "ORT-ID", "ORT-ID-QUAL", "ORT-BEZ", "MENGE", "MENGE-EINHEIT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "ORT-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 25)) "ORT-ID"
 , trim(substr(DID.DID_VALUE, 81 , 3)) "ORT-ID-QUAL"
 , trim(substr(DID.DID_VALUE, 85 , 70)) "ORT-BEZ"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 156 , 14),'9(11)v999') "MENGE"
 , trim(substr(DID.DID_VALUE, 171 , 3)) "MENGE-EINHEIT"
 , trim(substr(DID.DID_VALUE, 175 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DPLA01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DREF01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "POSITION-NR", "REFERENZ-QUAL", "REFERENZ-NR", "REFERENZ-POS", "REFERENZ-DAT-1", "REFERENZ-DAT-2", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "REFERENZ-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 35)) "REFERENZ-NR"
 , trim(substr(DID.DID_VALUE, 91 , 6)) "REFERENZ-POS"
 , trim(substr(DID.DID_VALUE, 98 , 35)) "REFERENZ-DAT-1"
 , trim(substr(DID.DID_VALUE, 134 , 35)) "REFERENZ-DAT-2"
 , trim(substr(DID.DID_VALUE, 170 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DREF01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_DTXT01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "DOKUMENT-ID", "POSITION-NR", "FREIER-TEXT-QUAL", "FREIER-TEXT1", "FREIER-TEXT2", "FREIER-TEXT3", "FREIER-TEXT4", "FREIER-TEXT5", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "POSITION-NR"
 , trim(substr(DID.DID_VALUE, 51 , 3)) "FREIER-TEXT-QUAL"
 , trim(substr(DID.DID_VALUE, 55 , 70)) "FREIER-TEXT1"
 , trim(substr(DID.DID_VALUE, 126 , 70)) "FREIER-TEXT2"
 , trim(substr(DID.DID_VALUE, 197 , 70)) "FREIER-TEXT3"
 , trim(substr(DID.DID_VALUE, 268 , 70)) "FREIER-TEXT4"
 , trim(substr(DID.DID_VALUE, 339 , 70)) "FREIER-TEXT5"
 , trim(substr(DID.DID_VALUE, 410 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'DTXT01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_ENDREC" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "NPOSITION", "NRECORD", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 6)) "NPOSITION"
 , trim(substr(DID.DID_VALUE, 51 , 6)) "NRECORD"
 , trim(substr(DID.DID_VALUE, 58 , 50)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'ENDREC'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HADR01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "ADRESSE-QUAL", "PARTNER-ID", "PARTNER-QUAL", "NAME-ZEILE-1", "NAME-ZEILE-2", "NAME-ZEILE-3", "NAME-ZEILE-4", "STRASSE-1", "STRASSE-2", "STRASSE-3", "STRASSE-4", "ORT", "PLZ", "LAND", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "ADRESSE-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 35)) "PARTNER-ID"
 , trim(substr(DID.DID_VALUE, 84 , 3)) "PARTNER-QUAL"
 , trim(substr(DID.DID_VALUE, 88 , 35)) "NAME-ZEILE-1"
 , trim(substr(DID.DID_VALUE, 124 , 35)) "NAME-ZEILE-2"
 , trim(substr(DID.DID_VALUE, 160 , 35)) "NAME-ZEILE-3"
 , trim(substr(DID.DID_VALUE, 196 , 35)) "NAME-ZEILE-4"
 , trim(substr(DID.DID_VALUE, 232 , 35)) "STRASSE-1"
 , trim(substr(DID.DID_VALUE, 268 , 35)) "STRASSE-2"
 , trim(substr(DID.DID_VALUE, 160 , 35)) "STRASSE-3"
 , trim(substr(DID.DID_VALUE, 196 , 35)) "STRASSE-4"
 , trim(substr(DID.DID_VALUE, 232 , 35)) "ORT"
 , trim(substr(DID.DID_VALUE, 268 , 9)) "PLZ"
 , trim(substr(DID.DID_VALUE, 278 , 3)) "LAND"
 , trim(substr(DID.DID_VALUE, 282 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HADR01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HADR02" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "ADRESSE-QUAL", "PARTNER-ID", "NAME-ZEILE-1", "NAME-ZEILE-2", "STRASSE-1", "STRASSE-2", "STRASSE-3", "ORT", "PLZ", "LAND", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "ADRESSE-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 35)) "PARTNER-ID"
 , trim(substr(DID.DID_VALUE, 84 , 35)) "NAME-ZEILE-1"
 , trim(substr(DID.DID_VALUE, 120 , 35)) "NAME-ZEILE-2"
 , trim(substr(DID.DID_VALUE, 156 , 35)) "STRASSE-1"
 , trim(substr(DID.DID_VALUE, 192 , 35)) "STRASSE-2"
 , trim(substr(DID.DID_VALUE, 228 , 35)) "STRASSE-3"
 , trim(substr(DID.DID_VALUE, 264 , 35)) "ORT"
 , trim(substr(DID.DID_VALUE, 300 , 9)) "PLZ"
 , trim(substr(DID.DID_VALUE, 310 , 3)) "LAND"
 , trim(substr(DID.DID_VALUE, 314 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HADR02'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HCTI01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "DOKUMENT-ID", "ADRESSE-QUAL", "PARTNER-ID", "KONTAKT-QUAL", "KONTAKT-ID", "KONTAKT-BEZ", "KONTAKT-TELEFON", "KONTAKT-TELEFAX", "KONTAKT-TELEX", "KONTAKT-EMAIL", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "ADRESSE-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 35)) "PARTNER-ID"
 , trim(substr(DID.DID_VALUE, 84 , 3)) "KONTAKT-QUAL"
 , trim(substr(DID.DID_VALUE, 88 , 17)) "KONTAKT-ID"
 , trim(substr(DID.DID_VALUE, 106 , 35)) "KONTAKT-BEZ"
 , trim(substr(DID.DID_VALUE, 142 , 25)) "KONTAKT-TELEFON"
 , trim(substr(DID.DID_VALUE, 168 , 25)) "KONTAKT-TELEFAX"
 , trim(substr(DID.DID_VALUE, 194 , 25)) "KONTAKT-TELEX"
 , trim(substr(DID.DID_VALUE, 220 , 25)) "KONTAKT-EMAIL"
 , trim(substr(DID.DID_VALUE, 246 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HCTI01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HDAT01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "DATUM-QUAL", "DATUM", "DATUM-FORMAT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "DATUM-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 35)) "DATUM"
 , trim(substr(DID.DID_VALUE, 84 , 3)) "DATUM-FORMAT"
 , trim(substr(DID.DID_VALUE, 88 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HDAT01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HHDR01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "DOKUMENT-ART", "DOKUMENT-FUNKTION", "DOKUMENT-ANTWORT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "DOKUMENT-ART"
 , trim(substr(DID.DID_VALUE, 48 , 3)) "DOKUMENT-FUNKTION"
 , trim(substr(DID.DID_VALUE, 52 , 3)) "DOKUMENT-ANTWORT"
 , trim(substr(DID.DID_VALUE, 56 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HHDR01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HPAY01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "ZAHLUNGSBED-QUAL", "ZAHLUNG-BED-IDENT", "ZAHLUNG-REFERENZ", "ZAHLUNG-ZEITBEZUG", "ZAHLUNG-ZEITSPANNE-IN", "ZAHLUNG-ZEITSPANNE-ANZ", "ZAHLUNG-ART", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "ZAHLUNGSBED-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 17)) "ZAHLUNG-BED-IDENT"
 , trim(substr(DID.DID_VALUE, 66 , 3)) "ZAHLUNG-REFERENZ"
 , trim(substr(DID.DID_VALUE, 70 , 3)) "ZAHLUNG-ZEITBEZUG"
 , trim(substr(DID.DID_VALUE, 74 , 3)) "ZAHLUNG-ZEITSPANNE-IN"
 , trim(substr(DID.DID_VALUE, 78 , 3)) "ZAHLUNG-ZEITSPANNE-ANZ"
 , trim(substr(DID.DID_VALUE, 82 , 3)) "ZAHLUNG-ART"
 , trim(substr(DID.DID_VALUE, 86 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HPAY01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HPER01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "ZAHLUNGSBED-QUAL", "RABATT-QUAL", "RABATT-%", "RABATT-WERT-QUAL", "RABATT-WERT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "ZAHLUNGSBED-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 3)) "RABATT-QUAL"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 52 , 5),'9(3)v99') "RABATT-%"
 , trim(substr(DID.DID_VALUE, 58 , 3)) "RABATT-WERT-QUAL"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 62 , 14),'9(12)v99') "RABATT-WERT"
 , trim(substr(DID.DID_VALUE, 77 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HPER01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HREF01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "REFERENZ-QUAL", "REFERENZ-NR", "REFERENZ-DAT-1", "REFERENZ-DAT-2", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "REFERENZ-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 35)) "REFERENZ-NR"
 , trim(substr(DID.DID_VALUE, 84 , 35)) "REFERENZ-DAT-1"
 , trim(substr(DID.DID_VALUE, 120 , 35)) "REFERENZ-DAT-2"
 , trim(substr(DID.DID_VALUE, 156 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HREF01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HREF02" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "ADRESSE-QUAL", "PARTNER-ID", "REFERENZ-QUAL", "REFERENZ-NR", "REFERENZ-VERSION", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "ADRESSE-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 35)) "PARTNER-ID"
 , trim(substr(DID.DID_VALUE, 84 , 3)) "REFERENZ-QUAL"
 , trim(substr(DID.DID_VALUE, 88 , 35)) "REFERENZ-NR"
 , trim(substr(DID.DID_VALUE, 124 , 35)) "REFERENZ-VERSION"
 , trim(substr(DID.DID_VALUE, 160 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HREF02'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HTRS01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "TRANSPORT-QUAL", "TRANSPORT-REF", "TRANSPORT-ART", "TRANSPORT-TYP", "TRANSPORTEUR", "ORT-QUAL", "ORT-ID", "ORT-ID-QUAL", "ORT-BEZ", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "TRANSPORT-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 17)) "TRANSPORT-REF"
 , trim(substr(DID.DID_VALUE, 66 , 3)) "TRANSPORT-ART"
 , trim(substr(DID.DID_VALUE, 70 , 3)) "TRANSPORT-TYP"
 , trim(substr(DID.DID_VALUE, 74 , 35)) "TRANSPORTEUR"
 , trim(substr(DID.DID_VALUE, 110 , 3)) "ORT-QUAL"
 , trim(substr(DID.DID_VALUE, 114 , 25)) "ORT-ID"
 , trim(substr(DID.DID_VALUE, 140 , 3)) "ORT-ID-QUAL"
 , trim(substr(DID.DID_VALUE, 144 , 70)) "ORT-BEZ"
 , trim(substr(DID.DID_VALUE, 215 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HTRS01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HTRT01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "TRANSPORTKOND-QUAL", "TRANPORTKOND", "TRANPORTKOND-CODE", "ORT-QUAL", "ORT-ID", "ORT-ID-QUAL", "ORT-BEZ", "TRANPORTKOND-ORT", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "TRANSPORTKOND-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 3)) "TRANPORTKOND"
 , trim(substr(DID.DID_VALUE, 52 , 3)) "TRANPORTKOND-CODE"
 , trim(substr(DID.DID_VALUE, 56 , 3)) "ORT-QUAL"
 , trim(substr(DID.DID_VALUE, 60 , 25)) "ORT-ID"
 , trim(substr(DID.DID_VALUE, 86 , 3)) "ORT-ID-QUAL"
 , trim(substr(DID.DID_VALUE, 90 , 70)) "ORT-BEZ"
 , trim(substr(DID.DID_VALUE, 161 , 70)) "TRANPORTKOND-ORT"
 , trim(substr(DID.DID_VALUE, 232 , 29)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HTRT01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HTXT01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "FREIER-TEXT-QUAL", "FREIER-TEXT-1", "FREIER-TEXT-2", "FREIER-TEXT-3", "FREIER-TEXT-4", "FREIER-TEXT-5", "FREIER-TEXT-CODE", "FREIER-TEXT-SPRACHE", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "FREIER-TEXT-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 70)) "FREIER-TEXT-1"
 , trim(substr(DID.DID_VALUE, 119 , 70)) "FREIER-TEXT-2"
 , trim(substr(DID.DID_VALUE, 190 , 70)) "FREIER-TEXT-3"
 , trim(substr(DID.DID_VALUE, 2 , 70)) "FREIER-TEXT-4"
 , trim(substr(DID.DID_VALUE, 73 , 70)) "FREIER-TEXT-5"
 , trim(substr(DID.DID_VALUE, 144 , 3)) "FREIER-TEXT-CODE"
 , trim(substr(DID.DID_VALUE, 148 , 3)) "FREIER-TEXT-SPRACHE"
 , trim(substr(DID.DID_VALUE, 152 , 96)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HTXT01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_HWAE01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "WAEHRUNG-QUAL", "WAEHRUNG", "WAEHRUNG-ART", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , trim(substr(DID.DID_VALUE, 44 , 3)) "WAEHRUNG-QUAL"
 , trim(substr(DID.DID_VALUE, 48 , 3)) "WAEHRUNG"
 , trim(substr(DID.DID_VALUE, 52 , 3)) "WAEHRUNG-ART"
 , trim(substr(DID.DID_VALUE, 56 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'HWAE01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_BEST_D96A_TTRL01" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "DOKUMENT-ID", "GESAMTPOS-BETRAG", "GESAMTPOS-WAEHRUNG", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 35)) "DOKUMENT-ID"
 , DOC_EDI_SC_FUNCTIONS.toNumber(substr(DID.DID_VALUE, 44 , 15),'9(13)v99') "GESAMTPOS-BETRAG"
 , trim(substr(DID.DID_VALUE, 60 , 3)) "GESAMTPOS-WAEHRUNG"
 , trim(substr(DID.DID_VALUE, 64 , 100)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'TTRL01'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EDI_SC_INFREC" ("DOC_EDI_IMPORT_JOB_DATA_ID", "DOC_EDI_IMPORT_JOB_ID", "C_EDI_JOB_DATA_STATUS", "DID_TAG", "DID_JOIN_KEY", "DID_ERROR_TEXT", "DID_LINE_NUMBER", "RECORDART", "NRCODE", "PARTNER-ID", "OWNER-ID", "APPLICATION-ID", "TESTINDICATOR", "DOCUMENT-REF", "MAPPING-VERSION", "INTERCHANGE-REF", "APPLICATION-REF", "COMMON-AGREEMENT-ID", "PREPERATION-DATE", "PREPERATION-TIME", "REVERSE-ROUTING", "ROUTING-ADRESS", "ACKNOWLEDGEMENT-REQ", "MESSAGE-REF", "DOCUMENT-ID", "REST", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select
   "DOC_EDI_IMPORT_JOB_DATA_ID"
 , "DOC_EDI_IMPORT_JOB_ID"
 , "C_EDI_JOB_DATA_STATUS"
 , "DID_TAG"
 , "DID_JOIN_KEY"
 , "DID_ERROR_TEXT"
 , "DID_LINE_NUMBER"
 , trim(substr(DID.DID_VALUE, 1 , 6)) "RECORDART"
 , trim(substr(DID.DID_VALUE, 8 , 1)) "NRCODE"
 , trim(substr(DID.DID_VALUE, 10 , 15)) "PARTNER-ID"
 , trim(substr(DID.DID_VALUE, 26 , 19)) "OWNER-ID"
 , trim(substr(DID.DID_VALUE, 46 , 20)) "APPLICATION-ID"
 , trim(substr(DID.DID_VALUE, 67 , 1)) "TESTINDICATOR"
 , trim(substr(DID.DID_VALUE, 69 , 35)) "DOCUMENT-REF"
 , trim(substr(DID.DID_VALUE, 105 , 29)) "MAPPING-VERSION"
 , trim(substr(DID.DID_VALUE, 135 , 14)) "INTERCHANGE-REF"
 , trim(substr(DID.DID_VALUE, 150 , 14)) "APPLICATION-REF"
 , trim(substr(DID.DID_VALUE, 165 , 35)) "COMMON-AGREEMENT-ID"
 , trim(substr(DID.DID_VALUE, 201 , 8)) "PREPERATION-DATE"
 , trim(substr(DID.DID_VALUE, 209 , 6)) "PREPERATION-TIME"
 , trim(substr(DID.DID_VALUE, 216 , 14)) "REVERSE-ROUTING"
 , trim(substr(DID.DID_VALUE, 231 , 14)) "ROUTING-ADRESS"
 , trim(substr(DID.DID_VALUE, 246 , 1)) "ACKNOWLEDGEMENT-REQ"
 , trim(substr(DID.DID_VALUE, 248 , 14)) "MESSAGE-REF"
 , trim(substr(DID.DID_VALUE, 263 , 35)) "DOCUMENT-ID"
 , trim(substr(DID.DID_VALUE, 299 , 49)) "REST"
 , "A_DATECRE"
 , "A_IDCRE"
 , "A_DATEMOD"
 , "A_IDMOD"
from DOC_EDI_IMPORT_JOB_DATA DID
where DID_TAG = 'INFREC'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_ESTIMATE_POS" ("DOC_ESTIMATE_ID", "C_DOC_ESTIMATE_STATUS", "C_DOC_ESTIMATE_CODE", "PAC_CUSTOM_PARTNER_ID", "PC_LANG_ID", "ACS_FINANCIAL_CURRENCY_ID", "GAL_PROJECT_ID", "DES_NUMBER", "DES_HEADING_TEXT", "DES_FOOT_TEXT", "DOC_GAUGE_OFFER_ID", "DOC_GAUGE_ORDER_ID", "DES_RECALC_AMOUNTS", "DOC_ESTIMATE_POS_ID", "DEP_NUMBER", "DEP_REFERENCE", "DEP_SECONDARY_REFERENCE", "DEP_SHORT_DESCRIPTION", "DEP_LONG_DESCRIPTION", "DEP_DELIVERY_DATE", "DEP_OPTION", "DEP_RECALC_AMOUNTS", "DEP_FREE_DESCRIPTION", "DEP_COMMENT", "C_SCHEDULE_PLANNING", "PPS_NOMENCLATURE_ID", "GAL_TASK_ID", "GAL_BUDGET_ID", "DOC_ESTIMATE_ELEMENT_ID", "C_DOC_ESTIMATE_ELEMENT_TYPE", "DED_NUMBER", "DOC_ESTIMATE_ELEMENT_COST_ID", "DOC_ESTIMATE_FOOT_ID", "DEC_COST_PRICE", "DEC_UNIT_SALE_PRICE_TH", "DEC_UNIT_SALE_PRICE", "DEC_UNIT_MARGIN_AMOUNT", "DEC_UNIT_MARGIN_RATE", "DEC_QUANTITY", "DEC_SALE_PRICE_TH", "DEC_SALE_PRICE", "DEC_SALE_PRICE_CORR", "DEC_MARGIN_AMOUNT", "DEC_MARGIN_AMOUNT_CORR", "DEC_MARGIN_RATE", "DEC_MARGIN_RATE_CORR", "DEC_GLOBAL_MARGIN_AMOUNT", "DOC_ESTIMATE_COMP_ID", "ECP_REFERENCE", "ECP_SECONDARY_REFERENCE", "ECP_SHORT_DESCRIPTION", "ECP_LONG_DESCRIPTION", "ECP_FREE_DESCRIPTION", "DOC_ESTIMATE_TASK_ID", "FAL_TASK_ID", "C_TASK_TYPE", "FAL_LIST_STEP_LINK_ID", "DTK_REFERENCE", "DTK_DESCRIPTION", "DTK_ADJUSTING_TIME", "DTK_WORK_TIME", "DTK_QTY_FIX_ADJUSTING", "DTK_QTY_REF_WORK", "DTK_RATE1", "DTK_RATE2", "GCO_GOOD_ID", "GCO_NEW_GOOD_ID", "DIC_UNIT_OF_MEASURE_ID", "C_MANAGEMENT_MODE", "GCO_GOOD_CATEGORY_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "C_DOC_ESTIMATE_CREATE_MODE", "C_SUPPLY_MODE", "C_SUPPLY_TYPE") AS
  select
         -- DOC_ESTIMATE
         DES.DOC_ESTIMATE_ID
       , DES.C_DOC_ESTIMATE_STATUS
       , DES.C_DOC_ESTIMATE_CODE
       , DES.PAC_CUSTOM_PARTNER_ID
       , DES.PC_LANG_ID
       , DES.ACS_FINANCIAL_CURRENCY_ID
       , DES.GAL_PROJECT_ID
       , DES.DES_NUMBER
       , DES.DES_HEADING_TEXT
       , DES.DES_FOOT_TEXT
       , DES.DOC_GAUGE_OFFER_ID
       , DES.DOC_GAUGE_ORDER_ID
       , DES.DES_RECALC_AMOUNTS
       -- DOC_ESTIMATE_POSITION
  ,      DEP.DOC_ESTIMATE_POS_ID
       , DEP.DEP_NUMBER
       , DEP.DEP_REFERENCE
       , DEP.DEP_SECONDARY_REFERENCE
       , DEP.DEP_SHORT_DESCRIPTION
       , DEP.DEP_LONG_DESCRIPTION
       , DEP.DEP_DELIVERY_DATE
       , DEP.DEP_OPTION
       , DEP.DEP_RECALC_AMOUNTS
       , DEP.DEP_FREE_DESCRIPTION
       , DEP.DEP_COMMENT
       , DEP.C_SCHEDULE_PLANNING
       , DEP.PPS_NOMENCLATURE_ID
       , DEP.GAL_TASK_ID
       , DEP.GAL_BUDGET_ID
       -- DOC_ESTIMATE_ELEMENT
  ,      cast(null as number(12) ) as DOC_ESTIMATE_ELEMENT_ID
       , cast(null as varchar2(10) ) as C_DOC_ESTIMATE_ELEMENT_TYPE
       , cast(null as number(9) ) as DED_NUMBER
       -- DOC_ESTIMATE_ELEMENT_COST
  ,      dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DEC_COST_PRICE
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_QUANTITY
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       -- DOC_ESTIMATE_COMP
  ,      cast(null as number(12) ) as DOC_ESTIMATE_COMP_ID
       , cast(null as varchar2(30) ) as ECP_REFERENCE
       , cast(null as varchar2(30) ) as ECP_SECONDARY_REFERENCE
       , cast(null as varchar2(30) ) as ECP_SHORT_DESCRIPTION
       , cast(null as varchar2(4000) ) as ECP_LONG_DESCRIPTION
       , cast(null as varchar2(4000) ) as ECP_FREE_DESCRIPTION
       -- DOC_ESTIMATE_TASK
  ,      cast(null as number(12) ) as DOC_ESTIMATE_TASK_ID
       , cast(null as number(12) ) as FAL_TASK_ID
       , cast(null as varchar2(10) ) as C_TASK_TYPE
       , cast(null as number(12) ) as FAL_LIST_STEP_LINK_ID
       , cast(null as varchar2(30) ) as DTK_REFERENCE
       , cast(null as varchar2(4000) ) as DTK_DESCRIPTION
       , cast(null as number(15, 4) ) as DTK_ADJUSTING_TIME
       , cast(null as number(15, 4) ) as DTK_WORK_TIME
       , cast(null as number(9) ) as DTK_QTY_FIX_ADJUSTING
       , cast(null as number(9) ) as DTK_QTY_REF_WORK
       , cast(null as number(15, 4) ) as DTK_RATE1
       , cast(null as number(15, 4) ) as DTK_RATE2
       -- Champs prsents sur plusieurs tables (DOC_ESTIMATE_POSITION, DOC_ESTIMATE_COMP, DOC_ESTIMATE_TASK)
  ,      DEP.GCO_GOOD_ID
       , DEP.GCO_NEW_GOOD_ID
       , DEP.DIC_UNIT_OF_MEASURE_ID
       , DEP.C_MANAGEMENT_MODE
       , DEP.GCO_GOOD_CATEGORY_ID
       , DEP.STM_STOCK_ID
       , DEP.STM_LOCATION_ID
       , DEP.C_DOC_ESTIMATE_CREATE_MODE
       , DEP.C_SUPPLY_MODE
       , DEP.C_SUPPLY_TYPE
    from DOC_ESTIMATE DES
       , DOC_ESTIMATE_POS DEP
       , DOC_ESTIMATE_ELEMENT_COST dec
   where DES.DOC_ESTIMATE_ID = DEP.DOC_ESTIMATE_ID
     and DEP.DOC_ESTIMATE_POS_ID = dec.DOC_ESTIMATE_POS_ID
  union
  select
         -- DOC_ESTIMATE
         DES.DOC_ESTIMATE_ID
       , DES.C_DOC_ESTIMATE_STATUS
       , DES.C_DOC_ESTIMATE_CODE
       , DES.PAC_CUSTOM_PARTNER_ID
       , DES.PC_LANG_ID
       , DES.ACS_FINANCIAL_CURRENCY_ID
       , DES.GAL_PROJECT_ID
       , DES.DES_NUMBER
       , DES.DES_HEADING_TEXT
       , DES.DES_FOOT_TEXT
       , DES.DOC_GAUGE_OFFER_ID
       , DES.DOC_GAUGE_ORDER_ID
       , DES.DES_RECALC_AMOUNTS
       -- DOC_ESTIMATE_POSITION
  ,      DEP.DOC_ESTIMATE_POS_ID
       , DEP.DEP_NUMBER
       , DEP.DEP_REFERENCE
       , DEP.DEP_SECONDARY_REFERENCE
       , DEP.DEP_SHORT_DESCRIPTION
       , DEP.DEP_LONG_DESCRIPTION
       , DEP.DEP_DELIVERY_DATE
       , DEP.DEP_OPTION
       , DEP.DEP_RECALC_AMOUNTS
       , DEP.DEP_FREE_DESCRIPTION
       , DEP.DEP_COMMENT
       , DEP.C_SCHEDULE_PLANNING
       , DEP.PPS_NOMENCLATURE_ID
       , DEP.GAL_TASK_ID
       , DEP.GAL_BUDGET_ID
       -- DOC_ESTIMATE_ELEMENT
  ,      DED.DOC_ESTIMATE_ELEMENT_ID
       , DED.C_DOC_ESTIMATE_ELEMENT_TYPE
       , DED.DED_NUMBER
       -- DOC_ESTIMATE_ELEMENT_COST
  ,      dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DEC_COST_PRICE
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_QUANTITY
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       -- DOC_ESTIMATE_COMP
  ,      ECP.DOC_ESTIMATE_COMP_ID
       , ECP.ECP_REFERENCE
       , ECP.ECP_SECONDARY_REFERENCE
       , ECP.ECP_SHORT_DESCRIPTION
       , ECP.ECP_LONG_DESCRIPTION
       , ECP.ECP_FREE_DESCRIPTION
       -- DOC_ESTIMATE_TASK
  ,      cast(null as number(12) ) as DOC_ESTIMATE_TASK_ID
       , cast(null as number(12) ) as FAL_TASK_ID
       , cast(null as varchar2(10) ) as C_TASK_TYPE
       , cast(null as number(12) ) as FAL_LIST_STEP_LINK_ID
       , cast(null as varchar2(30) ) as DTK_REFERENCE
       , cast(null as varchar2(4000) ) as DTK_DESCRIPTION
       , cast(null as number(15, 4) ) as DTK_ADJUSTING_TIME
       , cast(null as number(15, 4) ) as DTK_WORK_TIME
       , cast(null as number(9) ) as DTK_QTY_FIX_ADJUSTING
       , cast(null as number(9) ) as DTK_QTY_REF_WORK
       , cast(null as number(15, 4) ) as DTK_RATE1
       , cast(null as number(15, 4) ) as DTK_RATE2
       -- Champs prsents sur plusieurs tables (DOC_ESTIMATE_POSITION, DOC_ESTIMATE_COMP, DOC_ESTIMATE_TASK)
  ,      ECP.GCO_GOOD_ID
       , ECP.GCO_NEW_GOOD_ID
       , ECP.DIC_UNIT_OF_MEASURE_ID
       , ECP.C_MANAGEMENT_MODE
       , ECP.GCO_GOOD_CATEGORY_ID
       , ECP.STM_STOCK_ID
       , ECP.STM_LOCATION_ID
       , ECP.C_DOC_ESTIMATE_CREATE_MODE
       , ECP.C_SUPPLY_MODE
       , ECP.C_SUPPLY_TYPE
    from DOC_ESTIMATE DES
       , DOC_ESTIMATE_POS DEP
       , DOC_ESTIMATE_ELEMENT DED
       , DOC_ESTIMATE_ELEMENT_COST dec
       , DOC_ESTIMATE_COMP ECP
   where DES.DOC_ESTIMATE_ID = DEP.DOC_ESTIMATE_ID
     and DEP.DOC_ESTIMATE_POS_ID = DED.DOC_ESTIMATE_POS_ID
     and DED.DOC_ESTIMATE_ELEMENT_ID = dec.DOC_ESTIMATE_ELEMENT_ID
     and DED.DOC_ESTIMATE_ELEMENT_ID = ECP.DOC_ESTIMATE_COMP_ID
  union
  select
         -- DOC_ESTIMATE
         DES.DOC_ESTIMATE_ID
       , DES.C_DOC_ESTIMATE_STATUS
       , DES.C_DOC_ESTIMATE_CODE
       , DES.PAC_CUSTOM_PARTNER_ID
       , DES.PC_LANG_ID
       , DES.ACS_FINANCIAL_CURRENCY_ID
       , DES.GAL_PROJECT_ID
       , DES.DES_NUMBER
       , DES.DES_HEADING_TEXT
       , DES.DES_FOOT_TEXT
       , DES.DOC_GAUGE_OFFER_ID
       , DES.DOC_GAUGE_ORDER_ID
       , DES.DES_RECALC_AMOUNTS
       -- DOC_ESTIMATE_POSITION
  ,      DEP.DOC_ESTIMATE_POS_ID
       , DEP.DEP_NUMBER
       , DEP.DEP_REFERENCE
       , DEP.DEP_SECONDARY_REFERENCE
       , DEP.DEP_SHORT_DESCRIPTION
       , DEP.DEP_LONG_DESCRIPTION
       , DEP.DEP_DELIVERY_DATE
       , DEP.DEP_OPTION
       , DEP.DEP_RECALC_AMOUNTS
       , DEP.DEP_FREE_DESCRIPTION
       , DEP.DEP_COMMENT
       , DEP.C_SCHEDULE_PLANNING
       , DEP.PPS_NOMENCLATURE_ID
       , DEP.GAL_TASK_ID
       , DEP.GAL_BUDGET_ID
       -- DOC_ESTIMATE_ELEMENT
  ,      DED.DOC_ESTIMATE_ELEMENT_ID
       , DED.C_DOC_ESTIMATE_ELEMENT_TYPE
       , DED.DED_NUMBER
       -- DOC_ESTIMATE_ELEMENT_COST
  ,      dec.DOC_ESTIMATE_ELEMENT_COST_ID
       , dec.DOC_ESTIMATE_FOOT_ID
       , dec.DEC_COST_PRICE
       , dec.DEC_UNIT_SALE_PRICE_TH
       , dec.DEC_UNIT_SALE_PRICE
       , dec.DEC_UNIT_MARGIN_AMOUNT
       , dec.DEC_UNIT_MARGIN_RATE
       , dec.DEC_QUANTITY
       , dec.DEC_SALE_PRICE_TH
       , dec.DEC_SALE_PRICE
       , dec.DEC_SALE_PRICE_CORR
       , dec.DEC_MARGIN_AMOUNT
       , dec.DEC_MARGIN_AMOUNT_CORR
       , dec.DEC_MARGIN_RATE
       , dec.DEC_MARGIN_RATE_CORR
       , dec.DEC_GLOBAL_MARGIN_AMOUNT
       -- DOC_ESTIMATE_COMP
  ,      cast(null as number(12) ) as DOC_ESTIMATE_COMP_ID
       , cast(null as varchar2(30) ) as ECP_REFERENCE
       , cast(null as varchar2(30) ) as ECP_SECONDARY_REFERENCE
       , cast(null as varchar2(30) ) as ECP_SHORT_DESCRIPTION
       , cast(null as varchar2(4000) ) as ECP_LONG_DESCRIPTION
       , cast(null as varchar2(4000) ) as ECP_FREE_DESCRIPTION
       -- DOC_ESTIMATE_TASK
  ,      DTK.DOC_ESTIMATE_TASK_ID
       , DTK.FAL_TASK_ID
       , DTK.C_TASK_TYPE
       , DTK.FAL_LIST_STEP_LINK_ID
       , DTK.DTK_REFERENCE
       , DTK.DTK_DESCRIPTION
       , DTK.DTK_ADJUSTING_TIME
       , DTK.DTK_WORK_TIME
       , DTK.DTK_QTY_FIX_ADJUSTING
       , DTK.DTK_QTY_REF_WORK
       , DTK.DTK_RATE1
       , DTK.DTK_RATE2
       -- Champs prsents sur plusieurs tables (DOC_ESTIMATE_POSITION, DOC_ESTIMATE_COMP, DOC_ESTIMATE_TASK)
  ,      cast(null as number(12) ) as GCO_GOOD_ID
       , cast(null as number(12) ) as GCO_NEW_GOOD_ID
       , cast(null as varchar2(10) ) as DIC_UNIT_OF_MEASURE_ID
       , cast(null as varchar2(10) ) as C_MANAGEMENT_MODE
       , cast(null as number(12) ) as GCO_GOOD_CATEGORY_ID
       , cast(null as number(12) ) as STM_STOCK_ID
       , cast(null as number(12) ) as STM_LOCATION_ID
       , DTK.C_DOC_ESTIMATE_CREATE_MODE
       , cast(null as varchar2(10) ) as C_SUPPLY_MODE
       , cast(null as varchar2(10) ) as C_SUPPLY_TYPE
    from DOC_ESTIMATE DES
       , DOC_ESTIMATE_POS DEP
       , DOC_ESTIMATE_ELEMENT DED
       , DOC_ESTIMATE_ELEMENT_COST dec
       , DOC_ESTIMATE_TASK DTK
   where DES.DOC_ESTIMATE_ID = DEP.DOC_ESTIMATE_ID
     and DEP.DOC_ESTIMATE_POS_ID = DED.DOC_ESTIMATE_POS_ID
     and DED.DOC_ESTIMATE_ELEMENT_ID = dec.DOC_ESTIMATE_ELEMENT_ID
     and DED.DOC_ESTIMATE_ELEMENT_ID = DTK.DOC_ESTIMATE_TASK_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_EXPIRY" ("DOC_DOCUMENT_ID", "DOC_PAYMENT_DATE_ID", "PC_LANG_ID", "LANNAME", "LANID", "DMT_NUMBER", "DMT_TITLE_TEXT", "DMT_DATE_DOCUMENT", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "DMT_ADDRESS1", "DMT_POSTCODE1", "DMT_TOWN1", "DMT_FORMAT_CITY1", "DMT_NAME1", "DMT_FORENAME1", "DMT_ACTIVITY1", "DMT_CARE_OF1", "DMT_PO_BOX1", "DMT_PO_BOX_NBR1", "DMT_COUNTY1", "DMT_CONTACT1", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "PAD_BAND_NUMBER", "PAD_PAYMENT_DATE", "PAD_DISCOUNT_AMOUNT", "PAD_BVR_REFERENCE_NUM", "PAD_BVR_CODING_LINE", "PAD_NET_DATE_AMOUNT", "APT_LABEL", "PME_SBVR", "BAN_NAME1", "BAN_ZIP", "BAN_CITY") AS
  select distinct DOC_DOCUMENT.DOC_DOCUMENT_ID
                , DOC_PAYMENT_DATE.DOC_PAYMENT_DATE_ID
                , PCS.PC_LANG.PC_LANG_ID
                , PC_LANG.LANNAME
                , PC_LANG.LANID
                , DOC_DOCUMENT.DMT_NUMBER
                , DOC_DOCUMENT.DMT_TITLE_TEXT
                , DOC_DOCUMENT.DMT_DATE_DOCUMENT
                , PAC_PERSON.PER_NAME
                , PAC_PERSON.PER_FORENAME
                , PAC_PERSON.PER_ACTIVITY
                , DOC_DOCUMENT.DMT_ADDRESS3 as DMT_ADDRESS1
                , DOC_DOCUMENT.DMT_POSTCODE3 as DMT_POSTCODE1
                , DOC_DOCUMENT.DMT_TOWN3 as DMT_TOWN1
                , DOC_DOCUMENT.DMT_FORMAT_CITY3 as DMT_FORMAT_CITY1
                , DOC_DOCUMENT.DMT_NAME3 as DMT_NAME1
                , DOC_DOCUMENT.DMT_FORENAME3 as DMT_FORENAME1
                , DOC_DOCUMENT.DMT_ACTIVITY3 as DMT_ACTIVITY1
                , DOC_DOCUMENT.DMT_CARE_OF3 as DMT_CARE_OF1
                , DOC_DOCUMENT.DMT_PO_BOX3 as DMT_PO_BOX1
                , DOC_DOCUMENT.DMT_PO_BOX_NBR3 as DMT_PO_BOX_NBR1
                , DOC_DOCUMENT.DMT_COUNTY3 as DMT_COUNTY1
                , DOC_DOCUMENT.DMT_CONTACT3 as DMT_CONTACT1
                , DOC_FOOT.C_BVR_GENERATION_METHOD
                , DOC_FOOT.FOO_GENERATE_BVR_NUMBER
                , DOC_PAYMENT_DATE.PAD_BAND_NUMBER
                , DOC_PAYMENT_DATE.PAD_PAYMENT_DATE
                , DOC_PAYMENT_DATE.PAD_DISCOUNT_AMOUNT
                , DOC_PAYMENT_DATE.PAD_BVR_REFERENCE_NUM
                , DOC_PAYMENT_DATE.PAD_BVR_CODING_LINE
                , DOC_PAYMENT_DATE.PAD_NET_DATE_AMOUNT
                , V_PC_APPLTXT.APT_LABEL
                , ACS_PAYMENT_METHOD.PME_SBVR
                , PC_BANK.BAN_NAME1
                , PC_BANK.BAN_ZIP
                , PC_BANK.BAN_CITY
             from DOC_DOCUMENT DOC_DOCUMENT
                , DOC_FOOT DOC_FOOT
                , PAC_PERSON PAC_PERSON
                , PAC_ADDRESS PAC_ADDRESS
                , PAC_PAYMENT_CONDITION PAC_PAYMENT_CONDITION
                , DOC_PAYMENT_DATE DOC_PAYMENT_DATE
                , PCS.V_PC_APPLTXT V_PC_APPLTXT
                , ACS_FIN_ACC_S_PAYMENT ACS_FIN_ACC_S_PAYMENT
                , ACS_PAYMENT_METHOD ACS_PAYMENT_METHOD
                , PCS.PC_LANG PC_LANG
                , ACS_FINANCIAL_ACCOUNT ACS_FINANCIAL_ACCOUNT
                , PCS.PC_BANK PC_BANK
            where DOC_DOCUMENT.DOC_DOCUMENT_ID = DOC_FOOT.DOC_DOCUMENT_ID(+)
              and DOC_DOCUMENT.PC_LANG_ID = PCS.PC_LANG.PC_LANG_ID
              and DOC_DOCUMENT.PAC_THIRD_ACI_ID = PAC_PERSON.PAC_PERSON_ID(+)
              and DOC_DOCUMENT.PAC_THIRD_ACI_ID = PAC_ADDRESS.PAC_PERSON_ID(+)
              and DOC_DOCUMENT.PAC_PAYMENT_CONDITION_ID = PAC_PAYMENT_CONDITION.PAC_PAYMENT_CONDITION_ID(+)
              and DOC_FOOT.DOC_FOOT_ID = DOC_PAYMENT_DATE.DOC_FOOT_ID
              and PAC_PAYMENT_CONDITION.PC_APPLTXT_ID = V_PC_APPLTXT.PC_APPLTXT_ID(+)
              and DOC_DOCUMENT.ACS_FIN_ACC_S_PAYMENT_ID = ACS_FIN_ACC_S_PAYMENT.ACS_FIN_ACC_S_PAYMENT_ID(+)
              and ACS_FIN_ACC_S_PAYMENT.ACS_PAYMENT_METHOD_ID = ACS_PAYMENT_METHOD.ACS_PAYMENT_METHOD_ID(+)
              and V_PC_APPLTXT.PC_LANG_ID = PC_LANG.PC_LANG_ID(+)
              and ACS_FIN_ACC_S_PAYMENT.ACS_FINANCIAL_ACCOUNT_ID = ACS_FINANCIAL_ACCOUNT.ACS_FINANCIAL_ACCOUNT_ID(+)
              and ACS_FINANCIAL_ACCOUNT.PC_BANK_ID = PC_BANK.PC_BANK_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_FATHER" ("DMT_NUMBER", "DOC_DOCUMENT_ID", "DECH_DMT_NUMBER", "DECH_DOC_DOCUMENT_ID") AS
  select distinct DOC_DOCUMENT.DMT_NUMBER
                , DOC_DOCUMENT.DOC_DOCUMENT_ID
                , DECH_DOC_DOCUMENT.DMT_NUMBER DECH_DMT_NUMBER
                , DECH_DOC_DOCUMENT.DOC_DOCUMENT_ID DECH_DOC_DOCUMENT_ID
             from DOC_DOCUMENT DOC_DOCUMENT
                , DOC_POSITION DOC_POSITION
                , DOC_POSITION_DETAIL DOC_POSITION_DETAIL
                , DOC_POSITION_DETAIL DECH_DOC_POSITION_DETAIL
                , DOC_POSITION DECH_DOC_POSITION
                , DOC_DOCUMENT DECH_DOC_DOCUMENT
            where DOC_DOCUMENT."DOC_DOCUMENT_ID" = DOC_POSITION."DOC_DOCUMENT_ID"
              and DOC_POSITION."DOC_POSITION_ID" = DOC_POSITION_DETAIL."DOC_POSITION_ID"
              and DOC_POSITION_DETAIL."DOC_DOC_POSITION_DETAIL_ID" = DECH_DOC_POSITION_DETAIL."DOC_POSITION_DETAIL_ID"
              and DECH_DOC_POSITION_DETAIL."DOC_POSITION_ID" = DECH_DOC_POSITION."DOC_POSITION_ID"
              and DECH_DOC_POSITION."DOC_DOCUMENT_ID" = DECH_DOC_DOCUMENT."DOC_DOCUMENT_ID"




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_FCH_TOT_INVOICE_EXPIRY" ("DOC_DOCUMENT_ID", "DOC_INVOICE_EXPIRY_ID", "FOO_TOT_FCH_AMOUNT", "FOO_TOT_FCH_AMOUNT_B", "FOO_TOT_FCH_AMOUNT_E", "FOO_TOT_FCH_AMOUNT_V", "FOO_INCL_AMOUNT_AMOUNT", "FOO_INCL_AMOUNT_B", "FOO_INCL_AMOUNT_E", "FOO_EXCL_AMOUNT", "FOO_EXCL_AMOUNT_B", "FOO_EXCL_AMOUNT_E") AS
  select   DOC_FOOT_ID DOC_DOCUMENT_ID
         , FCH.DOC_INVOICE_EXPIRY_ID
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_VAT_TOTAL_AMOUNT, FCH_VAT_TOTAL_AMOUNT) ), 0)
                                                                                                     FOO_TOT_FCH_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_VAT_TOTAL_AMOUNT_B, FCH_VAT_TOTAL_AMOUNT_B) ), 0)
                                                                                                   FOO_TOT_FCH_AMOUNT_B
         , 0 FOO_TOT_FCH_AMOUNT_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_VAT_TOTAL_AMOUNT_V, FCH_VAT_TOTAL_AMOUNT_V) ), 0)
                                                                                                   FOO_TOT_FCH_AMOUNT_V
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_INCL_AMOUNT, FCH_INCL_AMOUNT) ), 0) FOO_INCL_AMOUNT_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_INCL_AMOUNT_B, FCH_INCL_AMOUNT_B) ), 0) FOO_INCL_AMOUNT_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_INCL_AMOUNT_E, FCH_INCL_AMOUNT_E) ), 0) FOO_INCL_AMOUNT_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_EXCL_AMOUNT, FCH_EXCL_AMOUNT) ), 0) FOO_EXCL_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_EXCL_AMOUNT_B, FCH_EXCL_AMOUNT_B) ), 0) FOO_EXCL_AMOUNT_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_EXCL_AMOUNT_E, FCH_EXCL_AMOUNT_E) ), 0) FOO_EXCL_AMOUNT_E
      from DOC_FOOT_CHARGE FCH
  group by DOC_FOOT_ID, FCH.DOC_INVOICE_EXPIRY_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_FOOT" ("DOC_FOOT_ID", "DOC_DOCUMENT_ID", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_DOCUMENT_TOTAL_AMOUNT_B", "FOO_DOCUMENT_TOTAL_AMOUNT_E", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT_E", "FOO_TOTAL_VAT_AMOUNT", "FOO_TOTAL_VAT_AMOUNT_B", "FOO_TOTAL_VAT_AMOUNT_E", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT_B", "FOO_CHARGE_TOTAL_AMOUNT_E", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT_B", "FOO_DISCOUNT_TOTAL_AMOUNT_E", "FOO_COST_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT_B", "FOO_COST_TOTAL_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_GOOD_TOT_AMOUNT_EX_B", "FOO_GOOD_TOT_AMOUNT_EX_E", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EX_B", "FOO_CHARG_TOT_AMOUNT_EX_E", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EX_B", "FOO_DISC_TOT_AMOUNT_EX_E", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EX_B", "FOO_COST_TOT_AMOUNT_EX_E", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "FOO_TOTAL_RATE_FACTOR", "FOO_DOC_TOT_AMT_COR_B", "DMT_NUMBER", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select /*+ first_rows */
         DOC.DOC_DOCUMENT_ID DOC_FOOT_ID
       , DOC.DOC_DOCUMENT_ID
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT, 0) +
         nvl(FCH.FOO_COST_TOTAL_AMOUNT, 0) +
         nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT, 0) -
         nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT, 0) FOO_DOCUMENT_TOTAL_AMOUNT
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT_B, 0) +
         nvl(FCH.FOO_COST_TOTAL_AMOUNT_B, 0) +
         nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT_B, 0) -
         nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT_B, 0) FOO_DOCUMENT_TOTAL_AMOUNT_B
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT_E, 0) +
         nvl(FCH.FOO_COST_TOTAL_AMOUNT_E, 0) +
         nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT_E, 0) -
         nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT_E, 0) FOO_DOCUMENT_TOTAL_AMOUNT_E
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT, 0) FOO_GOOD_TOTAL_AMOUNT
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT_B, 0) FOO_GOOD_TOTAL_AMOUNT_B
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT_E, 0) FOO_GOOD_TOTAL_AMOUNT_E
       , nvl(POS.FOO_TOT_POS_AMOUNT, 0) + nvl(FCH.FOO_TOT_FCH_AMOUNT, 0) FOO_TOTAL_VAT_AMOUNT
       , nvl(POS.FOO_TOT_POS_AMOUNT_B, 0) + nvl(FCH.FOO_TOT_FCH_AMOUNT_B, 0) FOO_TOTAL_VAT_AMOUNT_B
       , 0 FOO_TOTAL_VAT_AMOUNT_E
       , nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT, 0) FOO_CHARGE_TOTAL_AMOUNT
       , nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT_B, 0) FOO_CHARGE_TOTAL_AMOUNT_B
       , nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT_E, 0) FOO_CHARGE_TOTAL_AMOUNT_E
       , nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT, 0) FOO_DISCOUNT_TOTAL_AMOUNT
       , nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT_B, 0) FOO_DISCOUNT_TOTAL_AMOUNT_B
       , nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT_E, 0) FOO_DISCOUNT_TOTAL_AMOUNT_E
       , nvl(FCH.FOO_COST_TOTAL_AMOUNT, 0) FOO_COST_TOTAL_AMOUNT
       , nvl(FCH.FOO_COST_TOTAL_AMOUNT_B, 0) FOO_COST_TOTAL_AMOUNT_B
       , nvl(FCH.FOO_COST_TOTAL_AMOUNT_E, 0) FOO_COST_TOTAL_AMOUNT_E
       , nvl(POS.FOO_GOOD_TOT_AMOUNT_EXCL, 0) FOO_GOOD_TOT_AMOUNT_EXCL
       , nvl(POS.FOO_GOOD_TOT_AMOUNT_EXCL_B, 0) FOO_GOOD_TOT_AMOUNT_EX_B
       , nvl(POS.FOO_GOOD_TOT_AMOUNT_EXCL_E, 0) FOO_GOOD_TOT_AMOUNT_EX_E
       , nvl(FCH.FOO_CHARG_TOT_AMOUNT_EXCL, 0) FOO_CHARG_TOT_AMOUNT_EXCL
       , nvl(FCH.FOO_CHARG_TOT_AMOUNT_EXCL_B, 0) FOO_CHARG_TOT_AMOUNT_EX_B
       , nvl(FCH.FOO_CHARG_TOT_AMOUNT_EXCL_E, 0) FOO_CHARG_TOT_AMOUNT_EX_E
       , nvl(FCH.FOO_DISC_TOT_AMOUNT_EXCL, 0) FOO_DISC_TOT_AMOUNT_EXCL
       , nvl(FCH.FOO_DISC_TOT_AMOUNT_EXCL_B, 0) FOO_DISC_TOT_AMOUNT_EX_B
       , nvl(FCH.FOO_DISC_TOT_AMOUNT_EXCL_E, 0) FOO_DISC_TOT_AMOUNT_EX_E
       , nvl(FCH.FOO_COST_TOT_AMOUNT_EXCL, 0) FOO_COST_TOT_AMOUNT_EXCL
       , nvl(FCH.FOO_COST_TOT_AMOUNT_EXCL_B, 0) FOO_COST_TOT_AMOUNT_EX_B
       , nvl(FCH.FOO_COST_TOT_AMOUNT_EXCL_E, 0) FOO_COST_TOT_AMOUNT_EX_E
       , nvl(POS.FOO_TOTAL_NET_WEIGHT, 0) FOO_TOTAL_NET_WEIGHT
       , nvl(POS.FOO_TOTAL_GROSS_WEIGHT, 0) FOO_TOTAL_GROSS_WEIGHT
       , nvl(POS.FOO_TOTAL_BASIS_QUANTITY, 0) FOO_TOTAL_BASIS_QUANTITY
       , nvl(POS.FOO_TOTAL_INTERM_QUANTITY, 0) FOO_TOTAL_INTERM_QUANTITY
       , nvl(POS.FOO_TOTAL_FINAL_QUANTITY, 0) FOO_TOTAL_FINAL_QUANTITY
       , nvl(POS.FOO_TOTAL_RATE_FACTOR, 0) FOO_TOTAL_RATE_FACTOR
       , nvl(POS.FOO_GOOD_TOTAL_AMOUNT_B, 0) +
         nvl(FCH.FOO_COST_TOTAL_AMOUNT_B, 0) +
         nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT_B, 0) -
         nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT_B, 0) -
         ACS_FUNCTION.ConvertAmountForView(nvl(POS.FOO_GOOD_TOTAL_AMOUNT, 0) +
                                           nvl(FCH.FOO_COST_TOTAL_AMOUNT, 0) +
                                           nvl(FCH.FOO_CHARGE_TOTAL_AMOUNT, 0) -
                                           nvl(FCH.FOO_DISCOUNT_TOTAL_AMOUNT, 0)
                                         , DOC.ACS_FINANCIAL_CURRENCY_ID
                                         , ACS_FUNCTION.GetLocalCurrencyId
                                         , DOC.DMT_DATE_DOCUMENT
                                         , DOC.DMT_RATE_OF_EXCHANGE
                                         , DOC.DMT_BASE_PRICE
                                         , 1
                                          ) FOO_DOC_TOT_AMT_COR_B
       , DOC.DMT_NUMBER
       , DOC.A_DATECRE
       , DOC.A_IDCRE
       , DOC.A_DATEMOD
       , DOC.A_IDMOD
    from DOC_DOCUMENT DOC
       , V_DOC_FOOT_CHARGE FCH
       , V_DOC_FOOT_POSITION POS
   where FCH.DOC_DOCUMENT_ID(+) = DOC.DOC_DOCUMENT_ID
     and POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_FOOT_CHARGE" ("DOC_DOCUMENT_ID", "FOO_TOT_FCH_AMOUNT", "FOO_TOT_FCH_AMOUNT_B", "FOO_TOT_FCH_AMOUNT_E", "FOO_TOT_FCH_AMOUNT_V", "FOO_COST_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT_B", "FOO_COST_TOTAL_AMOUNT_E", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT_B", "FOO_DISCOUNT_TOTAL_AMOUNT_E", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT_B", "FOO_CHARGE_TOTAL_AMOUNT_E", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL_B", "FOO_COST_TOT_AMOUNT_EXCL_E", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL_B", "FOO_DISC_TOT_AMOUNT_EXCL_E", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL_B", "FOO_CHARG_TOT_AMOUNT_EXCL_E", "FOO_FCH_TOT_AMOUNT_EXCL") AS
  select   DMT.DOC_DOCUMENT_ID
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_VAT_TOTAL_AMOUNT, FCH_VAT_TOTAL_AMOUNT) ), 0)
                                                                                                     FOO_TOT_FCH_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_VAT_TOTAL_AMOUNT_B, FCH_VAT_TOTAL_AMOUNT_B) ), 0)
                                                                                                   FOO_TOT_FCH_AMOUNT_B
         , 0 FOO_TOT_FCH_AMOUNT_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', -FCH_VAT_TOTAL_AMOUNT_V, FCH_VAT_TOTAL_AMOUNT_V) ), 0)
                                                                                                   FOO_TOT_FCH_AMOUNT_V
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '01', FCH_INCL_AMOUNT, 0) ), 0) FOO_COST_TOTAL_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '01', FCH_INCL_AMOUNT_B, 0) ), 0) FOO_COST_TOTAL_AMOUNT_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '01', FCH_INCL_AMOUNT_E, 0) ), 0) FOO_COST_TOTAL_AMOUNT_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', FCH_INCL_AMOUNT, 0) ), 0) FOO_DISCOUNT_TOTAL_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', FCH_INCL_AMOUNT_B, 0) ), 0) FOO_DISCOUNT_TOTAL_AMOUNT_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', FCH_INCL_AMOUNT_E, 0) ), 0) FOO_DISCOUNT_TOTAL_AMOUNT_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '03', FCH_INCL_AMOUNT, 0) ), 0) FOO_CHARGE_TOTAL_AMOUNT
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '03', FCH_INCL_AMOUNT_B, 0) ), 0) FOO_CHARGE_TOTAL_AMOUNT_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '03', FCH_INCL_AMOUNT_E, 0) ), 0) FOO_CHARGE_TOTAL_AMOUNT_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '01', FCH_EXCL_AMOUNT, 0) ), 0) FOO_COST_TOT_AMOUNT_EXCL
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '01', FCH_EXCL_AMOUNT_B, 0) ), 0) FOO_COST_TOT_AMOUNT_EXCL_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '01', FCH_EXCL_AMOUNT_E, 0) ), 0) FOO_COST_TOT_AMOUNT_EXCL_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', FCH_EXCL_AMOUNT, 0) ), 0) FOO_DISC_TOT_AMOUNT_EXCL
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', FCH_EXCL_AMOUNT_B, 0) ), 0) FOO_DISC_TOT_AMOUNT_EXCL_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '02', FCH_EXCL_AMOUNT_E, 0) ), 0) FOO_DISC_TOT_AMOUNT_EXCL_E
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '03', FCH_EXCL_AMOUNT, 0) ), 0) FOO_CHARG_TOT_AMOUNT_EXCL
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '03', FCH_EXCL_AMOUNT_B, 0) ), 0) FOO_CHARG_TOT_AMOUNT_EXCL_B
         , nvl(sum(decode(FCH.C_FINANCIAL_CHARGE, '03', FCH_EXCL_AMOUNT_E, 0) ), 0) FOO_CHARG_TOT_AMOUNT_EXCL_E
         , decode(DMT.C_DOCUMENT_STATUS,'04',0,'05',0,nvl(sum(decode(FCH.FCH_DISCHARGED, 1, 0, decode(FCH.C_FINANCIAL_CHARGE, '03', decode(DMT.C_CURR_RATE_COVER_TYPE, '04', FCH.FCH_EXCL_AMOUNT_B, FCH.FCH_EXCL_AMOUNT), 0) ) ), 0) -
           nvl(sum(decode(FCH.FCH_DISCHARGED, 1, 0, decode(FCH.C_FINANCIAL_CHARGE, '02', decode(DMT.C_CURR_RATE_COVER_TYPE, '04', FCH.FCH_EXCL_AMOUNT_B, FCH.FCH_EXCL_AMOUNT), 0) ) ), 0) +
           nvl(sum(decode(FCH.FCH_DISCHARGED, 1, 0, decode(FCH.C_FINANCIAL_CHARGE, '01', decode(DMT.C_CURR_RATE_COVER_TYPE, '04', FCH.FCH_EXCL_AMOUNT_B, FCH.FCH_EXCL_AMOUNT), 0) ) ), 0))
                                                                                                FOO_FCH_TOT_AMOUNT_EXCL
      from DOC_FOOT_CHARGE FCH, DOC_DOCUMENT DMT
     where DMT.DOC_DOCUMENT_ID = FCH.DOC_FOOT_ID
  group by DMT.DOC_DOCUMENT_ID, DMT.C_DOCUMENT_STATUS


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_FOOT_POSITION" ("DOC_DOCUMENT_ID", "DOC_FOOT_ID", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_GOOD_TOT_AMOUNT_EXCL_B", "FOO_GOOD_TOT_AMOUNT_EXCL_E", "FOO_TOT_POS_AMOUNT", "FOO_TOT_POS_AMOUNT_B", "FOO_TOT_POS_AMOUNT_E", "FOO_TOT_POS_AMOUNT_V", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "FOO_TOTAL_RATE_FACTOR", "POS_QUANTITY_BALANCED", "FOO_HEDGE_BALANCE_AMOUNT") AS
  select   FOO.DOC_DOCUMENT_ID
         , FOO.DOC_FOOT_ID
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL) ), 0) FOO_GOOD_TOTAL_AMOUNT
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL_B) ), 0) FOO_GOOD_TOTAL_AMOUNT_B
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL_E) ), 0) FOO_GOOD_TOTAL_AMOUNT_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL_B) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL_B
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL_E) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT) ), 0) FOO_TOT_POS_AMOUNT
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT_B) ), 0) FOO_TOT_POS_AMOUNT_B
         , 0 FOO_TOT_POS_AMOUNT_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT_V) ), 0) FOO_TOT_POS_AMOUNT_V
         , nvl(sum(case
                     when POS.C_GAUGE_TYPE_POS in('7', '8', '9', '10') then POS.POS_GROSS_WEIGHT
                     when POS.C_GAUGE_TYPE_POS = '1'
                     and POS.DOC_DOC_POSITION_ID is null then POS.POS_GROSS_WEIGHT
                     else 0
                   end
                  )
             , 0
              ) FOO_TOTAL_GROSS_WEIGHT
         , nvl(sum(case
                     when POS.C_GAUGE_TYPE_POS in('7', '8', '9', '10') then POS.POS_NET_WEIGHT
                     when POS.C_GAUGE_TYPE_POS = '1'
                     and POS.DOC_DOC_POSITION_ID is null then POS.POS_NET_WEIGHT
                     else 0
                   end
                  )
             , 0
              ) FOO_TOTAL_NET_WEIGHT
         , nvl(sum(POS.POS_BASIS_QUANTITY), 0) FOO_TOTAL_BASIS_QUANTITY
         , nvl(sum(POS.POS_INTERMEDIATE_QUANTITY), 0) FOO_TOTAL_INTERM_QUANTITY
         , nvl(sum(POS.POS_FINAL_QUANTITY), 0) FOO_TOTAL_FINAL_QUANTITY
         , nvl(sum(POS.POS_RATE_FACTOR), 0) FOO_TOTAL_RATE_FACTOR   -- ???
         , nvl(sum(POS.POS_QUANTITY_BALANCED), 0) POS_QUANTITY_BALANCED   -- ???
         -- Attention on tient encore compte des montants chancier dans la mthode DOC_FUNCTIONS.UpdateBalanceTotal
  ,        sum(case
                 when POS.POS_BASIS_QUANTITY = 0 then 0
                 else (decode(DMT.C_CURR_RATE_COVER_TYPE, '04', POS.POS_NET_VALUE_EXCL_B, POS.POS_NET_VALUE_EXCL) *
                       DOC_I_LIB_POSITION.GetChangeRiskBalanceQty(POS.DOC_POSITION_ID)
                      ) /
                      (POS.POS_BASIS_QUANTITY)
               end
              ) FOO_HEDGE_BALANCE_AMOUNT
      from DOC_POSITION POS
         , DOC_DOCUMENT DMT
         , DOC_FOOT FOO
         , DOC_GAUGE_STRUCTURED GAS
     where POS.DOC_DOCUMENT_ID(+) = FOO.DOC_DOCUMENT_ID
       and DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
       and GAS.DOC_GAUGE_ID = POS.DOC_GAUGE_ID
       and POS.C_DOC_POS_STATUS <> '05'   -- Exclure le montants les positions annules du montant du document
  group by FOO.DOC_DOCUMENT_ID
         , FOO.DOC_FOOT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_GAUGE" ("DOC_GAUGE_ID", "PC_LANG_ID", "LANNAME", "GAU_DESCRIBE", "C_GAUGE_STATUS", "C_GAUGE_STATUS_WORDING", "C_ADMIN_DOMAIN", "C_ADMIN_DOMAIN_WORDING", "C_GAUGE_TYPE", "C_GAUGE_TYPE_WORDING", "DIC_GAUGE_CATEG_ID", "GAUGE_CATEG_WORDING", "DIC_GAUGE_TYPE_DOC_ID", "GAUGE_TYPE_DOC_WORDING", "GAU_NUMBERING", "GAU_REF_PARTNER", "GAU_TRAVELLER", "GAU_DOSSIER", "GAU_EXPIRY", "GAU_EDIFACT", "GAU_EXPIRY_NBR", "PER_NAME", "GAN_DESCRIBE", "PC__PC_APPLTXT_ID", "TITEL_TEXT", "HEADER_TEXT", "FOOT_TEXT", "DOC_TEXT", "DIC_ADDRESS_TYPE_ID", "DIC_ADD_TYP_WORDING", "DIC_ADDRESS_TYPE1_ID", "DIC_ADD_TYP1_WORDING", "DIC_ADDRESS_TYPE2_ID", "DIC_ADD_TYP2_WORDING", "GAU_EDIT_NAME", "GAU_EDIT_NAME1", "GAU_EDIT_NAME2", "GAU_EDIT_NAME3", "GAU_EDIT_NAME4", "GAU_EDIT_NAME5", "GAU_EDIT_NAME6", "GAU_EDIT_NAME7", "GAU_EDIT_NAME8", "GAU_EDIT_NAME9", "GAU_EDIT_NAME10", "GAU_EDIT_TEXT", "GAU_EDIT_TEXT1", "GAU_EDIT_TEXT2", "GAU_EDIT_TEXT3", "GAU_EDIT_TEXT4", "GAU_EDIT_TEXT5", "GAU_EDIT_TEXT6", "GAU_EDIT_TEXT7", "GAU_EDIT_TEXT8", "GAU_EDIT_TEXT9", "GAU_EDIT_TEXT10", "C_GAUGE_FORM_TYPE", "GAUGE_FORM_TYPE1", "GAUGE_FORM_TYPE2", "GAUGE_FORM_TYPE3", "GAUGE_FORM_TYPE4", "GAUGE_FORM_TYPE5", "GAUGE_FORM_TYPE6", "GAUGE_FORM_TYPE7", "GAUGE_FORM_TYPE8", "GAUGE_FORM_TYPE9", "GAUGE_FORM_TYPE10", "GAU_EDIT_BOOL1", "GAU_EDIT_BOOL2", "GAU_EDIT_BOOL3", "GAU_EDIT_BOOL4", "GAU_EDIT_BOOL5", "GAU_EDIT_BOOL6", "GAU_EDIT_BOOL7", "GAU_EDIT_BOOL8", "GAU_EDIT_BOOL9", "GAU_EDIT_BOOL10", "C_APPLI_COPY_SUPP", "APPLI_COPY_SUPP1", "APPLI_COPY_SUPP2", "APPLI_COPY_SUPP3", "APPLI_COPY_SUPP4", "APPLI_COPY_SUPP5", "APPLI_COPY_SUPP6", "APPLI_COPY_SUPP7", "APPLI_COPY_SUPP8", "APPLI_COPY_SUPP9", "APPLI_COPY_SUPP10", "GAU_COLLATE_COPIES", "GAU_COLLATE_COPIES1", "GAU_COLLATE_COPIES2", "GAU_COLLATE_COPIES3", "GAU_COLLATE_COPIES4", "GAU_COLLATE_COPIES5", "GAU_COLLATE_COPIES6", "GAU_COLLATE_COPIES7", "GAU_COLLATE_COPIES8", "GAU_COLLATE_COPIES9", "GAU_COLLATE_COPIES10", "GAU_CONFIRM_CANCEL", "C_DIRECTION_NUMBER", "C_GAUGE_RECORD_VERIFY", "C_GAU_AUTO_CREATE_RECORD", "GAU_SHOW_FORMS_ON_INSERT", "GAU_SHOW_FORMS_ON_UPDATE", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "GAU_FREE_DATA_USE", "GAU_FREE_NUMBER1", "GAU_FREE_NUMBER2", "GAU_FREE_DATE1", "GAU_FREE_DATE2", "GAU_FREE_TEXT_LONG", "GAU_FREE_TEXT_SHORT", "GAU_FREE_BOOL1", "GAU_FREE_BOOL2", "DIC_GAUGE_GROUP_ID", "GAU_COPY_SOURCE_FREE_DATA", "GAU_INIT_DMT_DATE_DOCUMENT", "GAU_INIT_DMT_DATE_VALUE", "GAU_INIT_DMT_DATE_FALLING_DUE", "C_PACKING_TYPE", "GAU_PAR_EDIT_NAME_1", "GAU_PAR_EDIT_NAME_2", "GAU_PAR_EDIT_NAME_3", "GAU_PAR_EDIT_NAME_4", "GAU_PAR_EDIT_NAME_5", "GAU_PAR_EDIT_NAME_6", "GAU_PAR_EDIT_NAME_7", "GAU_PAR_EDIT_NAME_8", "GAU_PAR_EDIT_NAME_9", "GAU_PAR_EDIT_NAME_10", "GAU_PAR_EDIT_NAME_11", "GAU_PAR_EDIT_TEXT_1", "GAU_PAR_EDIT_TEXT_2", "GAU_PAR_EDIT_TEXT_3", "GAU_PAR_EDIT_TEXT_4", "GAU_PAR_EDIT_TEXT_5", "GAU_PAR_EDIT_TEXT_6", "GAU_PAR_EDIT_TEXT_7", "GAU_PAR_EDIT_TEXT_8", "GAU_PAR_EDIT_TEXT_9", "GAU_PAR_EDIT_TEXT_10", "GAU_PAR_EDIT_TEXT_11", "GAU_PAR_COPY_SUP_1", "GAU_PAR_COPY_SUP_2", "GAU_PAR_COPY_SUP_3", "GAU_PAR_COPY_SUP_4", "GAU_PAR_COPY_SUP_5", "GAU_PAR_COPY_SUP_6", "GAU_PAR_COPY_SUP_7", "GAU_PAR_COPY_SUP_8", "GAU_PAR_COPY_SUP_9", "GAU_PAR_COPY_SUP_10", "GAU_PAR_COPY_SUP_11", "GAU_PAR_COLLATES_COPIES_1", "GAU_PAR_COLLATES_COPIES_2", "GAU_PAR_COLLATES_COPIES_3", "GAU_PAR_COLLATES_COPIES_4", "GAU_PAR_COLLATES_COPIES_5", "GAU_PAR_COLLATES_COPIES_6", "GAU_PAR_COLLATES_COPIES_7", "GAU_PAR_COLLATES_COPIES_8", "GAU_PAR_COLLATES_COPIES_9", "GAU_PAR_COLLATES_COPIES_10", "GAU_PAR_COLLATES_COPIES_11", "GAU_INCOTERMS", "GAU_COLLATE_PRINTED_REPORTS", "GAU_EDIT_BOOL", "GAU_REPORT_PRINT_TEST", "GAU_REPORT_PRINT_TEST1", "GAU_REPORT_PRINT_TEST2", "GAU_REPORT_PRINT_TEST3", "GAU_REPORT_PRINT_TEST4", "GAU_REPORT_PRINT_TEST5", "GAU_REPORT_PRINT_TEST6", "GAU_REPORT_PRINT_TEST7", "GAU_REPORT_PRINT_TEST8", "GAU_REPORT_PRINT_TEST9", "GAU_REPORT_PRINT_TEST10", "GAU_PAR_EDIT_BOOL1", "GAU_PAR_EDIT_BOOL2", "GAU_PAR_EDIT_BOOL3", "GAU_PAR_EDIT_BOOL4", "GAU_PAR_EDIT_BOOL5", "GAU_PAR_EDIT_BOOL6", "GAU_PAR_EDIT_BOOL7", "GAU_PAR_EDIT_BOOL8", "GAU_PAR_EDIT_BOOL9", "GAU_PAR_EDIT_BOOL10", "GAU_PAR_EDIT_BOOL11", "C_GAUGE_TYPE_COMMENT_VISIBLE", "GAU_ALWAYS_SHOW_COMMENT", "GAU_ADDR1_COMMENT_VISIBLE", "GAU_ADDR2_COMMENT_VISIBLE", "GAU_ADDR3_COMMENT_VISIBLE", "GAU_USE_MANAGED_DATA", "DIC_GAU_STATISTIC_1_ID", "DIC_GAU_STATISTIC_2_ID", "DIC_GAU_STATISTIC_3_ID", "GAU_BOOLEAN_1", "GAU_BOOLEAN_2", "GAU_BOOLEAN_3", "GAU_NUMERIC_1", "GAU_NUMERIC_2", "GAU_NUMERIC_3", "GAU_CANCEL_STATUS", "GAU_SHOW_FORMS_ON_CONFIRM", "GAU_ASA_RECORD", "DIC_TYPE_DOC_CUSTOM_ID", "GAU_CONFIRM_STATUS", "GAU_HISTORY", "A_DATECRE", "A_DATEMOD") AS
  select DOC_GAUGE."DOC_GAUGE_ID", PC_LANG."PC_LANG_ID", PC_LANG."LANNAME",
DOC_GAUGE."GAU_DESCRIBE", DOC_GAUGE."C_GAUGE_STATUS",
V_PC_DES_GAU_STATUS."GCDTEXT1" C_GAUGE_STATUS_WORDING,
DOC_GAUGE."C_ADMIN_DOMAIN",
V_PC_DES_ADMIN_DOMAIN."GCDTEXT1" C_ADMIN_DOMAIN_WORDING,
DOC_GAUGE."C_GAUGE_TYPE", V_PC_DES_GAU_TYPE."GCDTEXT1" C_GAUGE_TYPE_WORDING,
DOC_GAUGE."DIC_GAUGE_CATEG_ID",
DIC_GAUGE_CATEG."GAC_DESCRIBE" GAUGE_CATEG_WORDING,
DOC_GAUGE."DIC_GAUGE_TYPE_DOC_ID",
DIC_GAUGE_TYPE_DOC."GAT_DESCRIBE" GAUGE_TYPE_DOC_WORDING,
DOC_GAUGE."GAU_NUMBERING", DOC_GAUGE."GAU_REF_PARTNER",
DOC_GAUGE."GAU_TRAVELLER", DOC_GAUGE."GAU_DOSSIER", DOC_GAUGE."GAU_EXPIRY",
DOC_GAUGE."GAU_EDIFACT", DOC_GAUGE."GAU_EXPIRY_NBR", PAC_PERSON."PER_NAME",
DOC_GAUGE_NUMBERING."GAN_DESCRIBE",
DOC_GAUGE."PC__PC_APPLTXT_ID", PC_APPLTXT_TITEL."APH_CODE" TITEL_TEXT,
PC_APPLTXT_HEADER."APH_CODE" HEADER_TEXT, PC_APPLTXT_FOOT."APH_CODE" FOOT_TEXT,
PC_APPLTXT_DOC."APH_CODE" DOC_TEXT, DOC_GAUGE."DIC_ADDRESS_TYPE_ID",
DIC_ADDRESS_TYPE."DAD_DESCR" DIC_ADD_TYP_WORDING,
DOC_GAUGE."DIC_ADDRESS_TYPE1_ID",
DIC_ADDRESS_TYPE1."DAD_DESCR" DIC_ADD_TYP1_WORDING,
DOC_GAUGE."DIC_ADDRESS_TYPE2_ID",
DIC_ADDRESS_TYPE2."DAD_DESCR" DIC_ADD_TYP2_WORDING, DOC_GAUGE."GAU_EDIT_NAME",
DOC_GAUGE."GAU_EDIT_NAME1", DOC_GAUGE."GAU_EDIT_NAME2",
DOC_GAUGE."GAU_EDIT_NAME3", DOC_GAUGE."GAU_EDIT_NAME4",
DOC_GAUGE."GAU_EDIT_NAME5", DOC_GAUGE."GAU_EDIT_NAME6",
DOC_GAUGE."GAU_EDIT_NAME7", DOC_GAUGE."GAU_EDIT_NAME8",
DOC_GAUGE."GAU_EDIT_NAME9", DOC_GAUGE."GAU_EDIT_NAME10",
DOC_GAUGE."GAU_EDIT_TEXT",  DOC_GAUGE."GAU_EDIT_TEXT1",
DOC_GAUGE."GAU_EDIT_TEXT2", DOC_GAUGE."GAU_EDIT_TEXT3",
DOC_GAUGE."GAU_EDIT_TEXT4", DOC_GAUGE."GAU_EDIT_TEXT5",
DOC_GAUGE."GAU_EDIT_TEXT6", DOC_GAUGE."GAU_EDIT_TEXT7",
DOC_GAUGE."GAU_EDIT_TEXT8", DOC_GAUGE."GAU_EDIT_TEXT9",
DOC_GAUGE."GAU_EDIT_TEXT10", DOC_GAUGE."C_GAUGE_FORM_TYPE",
DOC_GAUGE."GAUGE_FORM_TYPE1", DOC_GAUGE."GAUGE_FORM_TYPE2",
DOC_GAUGE."GAUGE_FORM_TYPE3", DOC_GAUGE."GAUGE_FORM_TYPE4",
DOC_GAUGE."GAUGE_FORM_TYPE5", DOC_GAUGE."GAUGE_FORM_TYPE6",
DOC_GAUGE."GAUGE_FORM_TYPE7", DOC_GAUGE."GAUGE_FORM_TYPE8",
DOC_GAUGE."GAUGE_FORM_TYPE9", DOC_GAUGE."GAUGE_FORM_TYPE10",
DOC_GAUGE."GAU_EDIT_BOOL1", DOC_GAUGE."GAU_EDIT_BOOL2",
DOC_GAUGE."GAU_EDIT_BOOL3", DOC_GAUGE."GAU_EDIT_BOOL4",
DOC_GAUGE."GAU_EDIT_BOOL5", DOC_GAUGE."GAU_EDIT_BOOL6",
DOC_GAUGE."GAU_EDIT_BOOL7", DOC_GAUGE."GAU_EDIT_BOOL8",
DOC_GAUGE."GAU_EDIT_BOOL9", DOC_GAUGE."GAU_EDIT_BOOL10",
DOC_GAUGE.C_APPLI_COPY_SUPP, DOC_GAUGE.APPLI_COPY_SUPP1,
DOC_GAUGE.APPLI_COPY_SUPP2, DOC_GAUGE.APPLI_COPY_SUPP3,
DOC_GAUGE.APPLI_COPY_SUPP4, DOC_GAUGE.APPLI_COPY_SUPP5,
DOC_GAUGE.APPLI_COPY_SUPP6, DOC_GAUGE.APPLI_COPY_SUPP7,
DOC_GAUGE.APPLI_COPY_SUPP8, DOC_GAUGE.APPLI_COPY_SUPP9,
DOC_GAUGE.APPLI_COPY_SUPP10, DOC_GAUGE.GAU_COLLATE_COPIES,
DOC_GAUGE.GAU_COLLATE_COPIES1, DOC_GAUGE.GAU_COLLATE_COPIES2,
DOC_GAUGE.GAU_COLLATE_COPIES3, DOC_GAUGE.GAU_COLLATE_COPIES4,
DOC_GAUGE.GAU_COLLATE_COPIES5, DOC_GAUGE.GAU_COLLATE_COPIES6,
DOC_GAUGE.GAU_COLLATE_COPIES7, DOC_GAUGE.GAU_COLLATE_COPIES8,
DOC_GAUGE.GAU_COLLATE_COPIES9, DOC_GAUGE.GAU_COLLATE_COPIES10,
DOC_GAUGE.GAU_CONFIRM_CANCEL, DOC_GAUGE.C_DIRECTION_NUMBER,
DOC_GAUGE.C_GAUGE_RECORD_VERIFY, DOC_GAUGE.C_GAU_AUTO_CREATE_RECORD, DOC_GAUGE.GAU_SHOW_FORMS_ON_INSERT,
DOC_GAUGE.GAU_SHOW_FORMS_ON_UPDATE, DOC_GAUGE.DIC_GAUGE_FREE_CODE_1_ID, DOC_GAUGE.DIC_GAUGE_FREE_CODE_2_ID,
DOC_GAUGE.DIC_GAUGE_FREE_CODE_3_ID, DOC_GAUGE.GAU_FREE_DATA_USE,
DOC_GAUGE.GAU_FREE_NUMBER1, DOC_GAUGE.GAU_FREE_NUMBER2,
DOC_GAUGE.GAU_FREE_DATE1, DOC_GAUGE.GAU_FREE_DATE2,
DOC_GAUGE.GAU_FREE_TEXT_LONG, DOC_GAUGE.GAU_FREE_TEXT_SHORT,
DOC_GAUGE.GAU_FREE_BOOL1, DOC_GAUGE.GAU_FREE_BOOL2,
DOC_GAUGE.DIC_GAUGE_GROUP_ID, DOC_GAUGE.GAU_COPY_SOURCE_FREE_DATA,
DOC_GAUGE.GAU_INIT_DMT_DATE_DOCUMENT, DOC_GAUGE.GAU_INIT_DMT_DATE_VALUE,
DOC_GAUGE.GAU_INIT_DMT_DATE_FALLING_DUE, DOC_GAUGE.C_PACKING_TYPE, DOC_GAUGE.GAU_PAR_EDIT_NAME_1,
DOC_GAUGE.GAU_PAR_EDIT_NAME_2, DOC_GAUGE.GAU_PAR_EDIT_NAME_3,
DOC_GAUGE.GAU_PAR_EDIT_NAME_4, DOC_GAUGE.GAU_PAR_EDIT_NAME_5,
DOC_GAUGE.GAU_PAR_EDIT_NAME_6, DOC_GAUGE.GAU_PAR_EDIT_NAME_7,
DOC_GAUGE.GAU_PAR_EDIT_NAME_8, DOC_GAUGE.GAU_PAR_EDIT_NAME_9,
DOC_GAUGE.GAU_PAR_EDIT_NAME_10, DOC_GAUGE.GAU_PAR_EDIT_NAME_11,
DOC_GAUGE.GAU_PAR_EDIT_TEXT_1, DOC_GAUGE.GAU_PAR_EDIT_TEXT_2,
DOC_GAUGE.GAU_PAR_EDIT_TEXT_3, DOC_GAUGE.GAU_PAR_EDIT_TEXT_4,
DOC_GAUGE.GAU_PAR_EDIT_TEXT_5, DOC_GAUGE.GAU_PAR_EDIT_TEXT_6,
DOC_GAUGE.GAU_PAR_EDIT_TEXT_7, DOC_GAUGE.GAU_PAR_EDIT_TEXT_8,
DOC_GAUGE.GAU_PAR_EDIT_TEXT_9, DOC_GAUGE.GAU_PAR_EDIT_TEXT_10,
DOC_GAUGE.GAU_PAR_EDIT_TEXT_11, DOC_GAUGE.GAU_PAR_COPY_SUP_1,
DOC_GAUGE.GAU_PAR_COPY_SUP_2, DOC_GAUGE.GAU_PAR_COPY_SUP_3,
DOC_GAUGE.GAU_PAR_COPY_SUP_4, DOC_GAUGE.GAU_PAR_COPY_SUP_5,
DOC_GAUGE.GAU_PAR_COPY_SUP_6, DOC_GAUGE.GAU_PAR_COPY_SUP_7,
DOC_GAUGE.GAU_PAR_COPY_SUP_8, DOC_GAUGE.GAU_PAR_COPY_SUP_9,
DOC_GAUGE.GAU_PAR_COPY_SUP_10, DOC_GAUGE.GAU_PAR_COPY_SUP_11,
DOC_GAUGE.GAU_PAR_COLLATES_COPIES_1, DOC_GAUGE.GAU_PAR_COLLATES_COPIES_2,
DOC_GAUGE.GAU_PAR_COLLATES_COPIES_3, DOC_GAUGE.GAU_PAR_COLLATES_COPIES_4,
DOC_GAUGE.GAU_PAR_COLLATES_COPIES_5, DOC_GAUGE.GAU_PAR_COLLATES_COPIES_6,
DOC_GAUGE.GAU_PAR_COLLATES_COPIES_7, DOC_GAUGE.GAU_PAR_COLLATES_COPIES_8,
DOC_GAUGE.GAU_PAR_COLLATES_COPIES_9, DOC_GAUGE.GAU_PAR_COLLATES_COPIES_10,
DOC_GAUGE.GAU_PAR_COLLATES_COPIES_11,  DOC_GAUGE.GAU_INCOTERMS,
DOC_GAUGE.GAU_COLLATE_PRINTED_REPORTS, DOC_GAUGE.GAU_EDIT_BOOL,
DOC_GAUGE.GAU_REPORT_PRINT_TEST, DOC_GAUGE.GAU_REPORT_PRINT_TEST1,
DOC_GAUGE.GAU_REPORT_PRINT_TEST2, DOC_GAUGE.GAU_REPORT_PRINT_TEST3,
DOC_GAUGE.GAU_REPORT_PRINT_TEST4, DOC_GAUGE.GAU_REPORT_PRINT_TEST5,
DOC_GAUGE.GAU_REPORT_PRINT_TEST6, DOC_GAUGE.GAU_REPORT_PRINT_TEST7,
DOC_GAUGE.GAU_REPORT_PRINT_TEST8, DOC_GAUGE.GAU_REPORT_PRINT_TEST9,
DOC_GAUGE.GAU_REPORT_PRINT_TEST10,
DOC_GAUGE.GAU_PAR_EDIT_BOOL1, DOC_GAUGE.GAU_PAR_EDIT_BOOL2,
DOC_GAUGE.GAU_PAR_EDIT_BOOL3, DOC_GAUGE.GAU_PAR_EDIT_BOOL4,
DOC_GAUGE.GAU_PAR_EDIT_BOOL5, DOC_GAUGE.GAU_PAR_EDIT_BOOL6,
DOC_GAUGE.GAU_PAR_EDIT_BOOL7, DOC_GAUGE.GAU_PAR_EDIT_BOOL8,
DOC_GAUGE.GAU_PAR_EDIT_BOOL9, DOC_GAUGE.GAU_PAR_EDIT_BOOL10,
DOC_GAUGE.GAU_PAR_EDIT_BOOL11,
DOC_GAUGE.C_GAUGE_TYPE_COMMENT_VISIBLE, DOC_GAUGE.GAU_ALWAYS_SHOW_COMMENT,
DOC_GAUGE.GAU_ADDR1_COMMENT_VISIBLE, DOC_GAUGE.GAU_ADDR2_COMMENT_VISIBLE,
DOC_GAUGE.GAU_ADDR3_COMMENT_VISIBLE, DOC_GAUGE.GAU_USE_MANAGED_DATA,
DOC_GAUGE.DIC_GAU_STATISTIC_1_ID, DOC_GAUGE.DIC_GAU_STATISTIC_2_ID,
DOC_GAUGE.DIC_GAU_STATISTIC_3_ID, DOC_GAUGE.GAU_BOOLEAN_1,
DOC_GAUGE.GAU_BOOLEAN_2, DOC_GAUGE.GAU_BOOLEAN_3, DOC_GAUGE.GAU_NUMERIC_1,
DOC_GAUGE.GAU_NUMERIC_2, DOC_GAUGE.GAU_NUMERIC_3, DOC_GAUGE.GAU_CANCEL_STATUS,
DOC_GAUGE.GAU_SHOW_FORMS_ON_CONFIRM, DOC_GAUGE.GAU_ASA_RECORD,
DOC_GAUGE.DIC_TYPE_DOC_CUSTOM_ID,
DOC_GAUGE.GAU_CONFIRM_STATUS, GAU_HISTORY,
DOC_GAUGE."A_DATECRE",
DOC_GAUGE."A_DATEMOD"
from "DOC_GAUGE" DOC_GAUGE, "PCS"."PC_LANG" PC_LANG,
"DIC_GAUGE_CATEG" DIC_GAUGE_CATEG, "DIC_GAUGE_TYPE_DOC" DIC_GAUGE_TYPE_DOC,
"PAC_PERSON" PAC_PERSON, "DOC_GAUGE_NUMBERING" DOC_GAUGE_NUMBERING,
"PCS"."PC_APPLTXT" PC_APPLTXT_TITEL, "PCS"."PC_APPLTXT" PC_APPLTXT_HEADER,
"PCS"."PC_APPLTXT" PC_APPLTXT_FOOT, "PCS"."PC_APPLTXT" PC_APPLTXT_DOC,
"PCS"."V_PC_DESCODES" V_PC_DES_GAU_STATUS,
"PCS"."V_PC_DESCODES" V_PC_DES_ADMIN_DOMAIN,
"PCS"."V_PC_DESCODES" V_PC_DES_GAU_TYPE, "DIC_ADDRESS_TYPE" DIC_ADDRESS_TYPE,
"DIC_ADDRESS_TYPE" DIC_ADDRESS_TYPE1, "DIC_ADDRESS_TYPE" DIC_ADDRESS_TYPE2
where DOC_GAUGE."DIC_GAUGE_CATEG_ID" = DIC_GAUGE_CATEG."DIC_GAUGE_CATEG_ID"(+)
and DOC_GAUGE."DIC_GAUGE_TYPE_DOC_ID" = DIC_GAUGE_TYPE_DOC."DIC_GAUGE_TYPE_DOC_ID"(+)
and DOC_GAUGE."PAC_THIRD_ID" = PAC_PERSON."PAC_PERSON_ID"(+)
and DOC_GAUGE."DOC_GAUGE_NUMBERING_ID" = DOC_GAUGE_NUMBERING."DOC_GAUGE_NUMBERING_ID"(+)
and DOC_GAUGE."PC__PC_APPLTXT_ID" = PC_APPLTXT_TITEL."PC_APPLTXT_ID"
and DOC_GAUGE."PC_APPLTXT_ID" = PC_APPLTXT_HEADER."PC_APPLTXT_ID"(+)
and DOC_GAUGE."PC_3_PC_APPLTXT_ID" = PC_APPLTXT_FOOT."PC_APPLTXT_ID"(+)
and DOC_GAUGE."PC_2_PC_APPLTXT_ID" = PC_APPLTXT_DOC."PC_APPLTXT_ID"(+)
and DOC_GAUGE."C_GAUGE_STATUS" = V_PC_DES_GAU_STATUS."GCLCODE"
and DOC_GAUGE."C_ADMIN_DOMAIN" = V_PC_DES_ADMIN_DOMAIN."GCLCODE"
and DOC_GAUGE."C_GAUGE_TYPE" = V_PC_DES_GAU_TYPE."GCLCODE"
and V_PC_DES_GAU_STATUS."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DES_ADMIN_DOMAIN."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DES_GAU_TYPE."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DES_GAU_STATUS."GCGNAME" = 'C_GAUGE_STATUS'
and V_PC_DES_ADMIN_DOMAIN."GCGNAME" = 'C_ADMIN_DOMAIN'
and V_PC_DES_GAU_TYPE."GCGNAME" = 'C_GAUGE_TYPE'
and DOC_GAUGE."DIC_ADDRESS_TYPE_ID" = DIC_ADDRESS_TYPE."DIC_ADDRESS_TYPE_ID"(+)
and DOC_GAUGE."DIC_ADDRESS_TYPE1_ID" = DIC_ADDRESS_TYPE1."DIC_ADDRESS_TYPE_ID"(+)
and DOC_GAUGE."DIC_ADDRESS_TYPE2_ID" = DIC_ADDRESS_TYPE2."DIC_ADDRESS_TYPE_ID"(+)
with check option




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_GAUGE_FLOW" ("CODE", "GAF_DESCRIBE", "SEQ_SRC", "SRC", "SEQ_DST", "DST", "GAR_QUANTITY_EXCEED", "GAR_GOOD_CHANGING", "GAR_PARTNER_CHANGING", "GAR_EXTOURNE_MVT", "GAR_BALANCE_PARENT", "GAR_TRANSFERT_PRICE", "GAR_TRANSFERT_QUANTITY", "GAR_INIT_PRICE_MVT", "GAR_INIT_QTY_MVT", "GAR_PART_DISCHARGE", "GAR_TRANSFERT_STOCK", "GAR_TRANSFERT_DESCR", "GAR_TRANSFERT_REMISE_TAXE", "GAR_INIT_COST_PRICE", "GAR_TRANSFER_MVMT_SWAP", "GAR_INVERT_AMOUNT", "GAR_TRANSFERT_RECORD", "GAR_TRANSFERT_REPRESENT", "GAR_TRANSFERT_FREE_DATA", "GAR_TRANSFERT_PRICE_MVT", "GAR_TRANSFERT_PRECIOUS_MAT", "GAC_TRANSFERT_PRICE", "GAC_TRANSFERT_QUANTITY", "GAC_INIT_PRICE_MVT", "GAC_INIT_QTY_MVT", "GAC_BOND", "GAC_PART_COPY", "GAC_TRANSFERT_STOCK", "GAC_TRANSFERT_DESCR", "GAC_TRANSFERT_REMISE_TAXE", "GAC_TRANSFERT_RECORD", "GAC_TRANSFERT_REPRESENT", "GAC_TRANSFERT_FREE_DATA", "GAC_TRANSFERT_PRICE_MVT", "GAC_INIT_COST_PRICE", "GAC_TRANSFERT_CHARACT", "GAC_TRANSFERT_PRECIOUS_MAT", "GAUGE_SRC_ID", "GAUGE_DST_ID", "DOC_GAUGE_RECEIPT_ID", "FLOW_DOCUM_SRC_ID", "FLOW_DOCUM_DST_ID", "DOC_GAUGE_FLOW_ID") AS
  SELECT 'DISCHARGE' CODE
	 , DGF.GAF_DESCRIBE
     , GAD_SRC.GAD_SEQ SEQ_SRC
	 , GAU.GAU_DESCRIBE SRC
     , GAD.GAD_SEQ SEQ_DST
	 , GAU_DST.GAU_DESCRIBE DST
     , GAR_QUANTITY_EXCEED
     , GAR_GOOD_CHANGING
     , GAR_PARTNER_CHANGING
     , GAR_EXTOURNE_MVT
     , GAR_BALANCE_PARENT
     , GAR_TRANSFERT_PRICE
     , GAR_TRANSFERT_QUANTITY
     , GAR_INIT_PRICE_MVT
     , GAR_INIT_QTY_MVT
     , GAR_PART_DISCHARGE
     , GAR_TRANSFERT_STOCK
     , GAR_TRANSFERT_DESCR
     , GAR_TRANSFERT_REMISE_TAXE
     , GAR_INIT_COST_PRICE
     , GAR_TRANSFER_MVMT_SWAP
     , GAR_INVERT_AMOUNT
     , GAR_TRANSFERT_RECORD
     , GAR_TRANSFERT_REPRESENT
     , GAR_TRANSFERT_FREE_DATA
     , GAR_TRANSFERT_PRICE_MVT
     , GAR_TRANSFERT_PRECIOUS_MAT
	 , NULL GAC_TRANSFERT_PRICE
     , NULL GAC_TRANSFERT_QUANTITY
     , NULL GAC_INIT_PRICE_MVT
     , NULL GAC_INIT_QTY_MVT
     , NULL GAC_BOND
     , NULL GAC_PART_COPY
     , NULL GAC_TRANSFERT_STOCK
     , NULL GAC_TRANSFERT_DESCR
     , NULL GAC_TRANSFERT_REMISE_TAXE
     , NULL GAC_TRANSFERT_RECORD
     , NULL GAC_TRANSFERT_REPRESENT
     , NULL GAC_TRANSFERT_FREE_DATA
     , NULL GAC_TRANSFERT_PRICE_MVT
     , NULL GAC_INIT_COST_PRICE
     , NULL GAC_TRANSFERT_CHARACT
     , NULL GAC_TRANSFERT_PRECIOUS_MAT
     , GAU.DOC_GAUGE_ID GAUGE_SRC_ID
     , GAU_DST.DOC_GAUGE_ID GAUGE_DST_ID
     , GAR.DOC_GAUGE_RECEIPT_ID
     , GAD.DOC_GAUGE_FLOW_DOCUM_ID FLOW_DOCUM_SRC_ID
     , GAD_SRC.DOC_GAUGE_FLOW_DOCUM_ID FLOW_DOCUM_DST_ID
	 , DGF.DOC_GAUGE_FLOW_ID
  FROM DOC_GAUGE GAU
     , DOC_GAUGE GAU_DST
     , DOC_GAUGE_RECEIPT GAR
     , DOC_GAUGE_FLOW_DOCUM GAD
     , DOC_GAUGE_FLOW_DOCUM GAD_SRC
	 , DOC_GAUGE_FLOW DGF
 WHERE GAD.DOC_GAUGE_ID = GAU_DST.DOC_GAUGE_ID
   AND GAR.DOC_GAUGE_FLOW_DOCUM_ID = GAD.DOC_GAUGE_FLOW_DOCUM_ID
   AND GAU.DOC_GAUGE_ID = GAR.DOC_DOC_GAUGE_ID
   AND GAU.DOC_GAUGE_ID = GAD_SRC.DOC_GAUGE_ID
   AND GAD.DOC_GAUGE_FLOW_ID = DGF.DOC_GAUGE_FLOW_ID
UNION ALL
SELECT 'COPY' CODE
, DGF.GAF_DESCRIBE
,GAD_SRC.GAD_SEQ, GAU.GAU_DESCRIBE SRC,
         GAD.GAD_SEQ SEQ_DST,GAU_DST.GAU_DESCRIBE DST
     , NULL GAR_QUANTITY_EXCEED
     , NULL GAR_GOOD_CHANGING
     , NULL GAR_PARTNER_CHANGING
     , NULL GAR_EXTOURNE_MVT
     , NULL GAR_BALANCE_PARENT
     , NULL GAR_TRANSFERT_PRICE
     , NULL GAR_TRANSFERT_QUANTITY
     , NULL GAR_INIT_PRICE_MVT
     , NULL GAR_INIT_QTY_MVT
     , NULL GAR_PART_DISCHARGE
     , NULL GAR_TRANSFERT_STOCK
     , NULL GAR_TRANSFERT_DESCR
     , NULL GAR_TRANSFERT_REMISE_TAXE
     , NULL GAR_INIT_COST_PRICE
     , NULL GAR_TRANSFER_MVMT_SWAP
     , NULL GAR_INVERT_AMOUNT
     , NULL GAR_TRANSFERT_RECORD
     , NULL GAR_TRANSFERT_REPRESENT
     , NULL GAR_TRANSFERT_FREE_DATA
     , NULL GAR_TRANSFERT_PRICE_MVT
     , NULL GAR_TRANSFERT_PRECIOUS_MAT
     , GAC_TRANSFERT_PRICE
     , GAC_TRANSFERT_QUANTITY
     , GAC_INIT_PRICE_MVT
     , GAC_INIT_QTY_MVT
     , GAC_BOND
     , GAC_PART_COPY
     , GAC_TRANSFERT_STOCK
     , GAC_TRANSFERT_DESCR
     , GAC_TRANSFERT_REMISE_TAXE
     , GAC_TRANSFERT_RECORD
     , GAC_TRANSFERT_REPRESENT
     , GAC_TRANSFERT_FREE_DATA
     , GAC_TRANSFERT_PRICE_MVT
     , GAC_INIT_COST_PRICE
     , GAC_TRANSFERT_CHARACT
     , GAC_TRANSFERT_PRECIOUS_MAT
     , GAU.DOC_GAUGE_ID
     , GAU_DST.DOC_GAUGE_ID
     , GAR.DOC_GAUGE_COPY_ID
     , GAD.DOC_GAUGE_FLOW_DOCUM_ID
     , GAD_SRC.DOC_GAUGE_FLOW_DOCUM_ID
	 , DGF.DOC_GAUGE_FLOW_ID
  FROM DOC_GAUGE GAU
     , DOC_GAUGE GAU_DST
     , DOC_GAUGE_COPY GAR
     , DOC_GAUGE_FLOW_DOCUM GAD
     , DOC_GAUGE_FLOW_DOCUM GAD_SRC
	 , DOC_GAUGE_FLOW DGF
 WHERE GAD.DOC_GAUGE_ID = GAU_DST.DOC_GAUGE_ID
   AND GAR.DOC_GAUGE_FLOW_DOCUM_ID = GAD.DOC_GAUGE_FLOW_DOCUM_ID
   AND GAU.DOC_GAUGE_ID = GAR.DOC_DOC_GAUGE_ID
   AND GAU.DOC_GAUGE_ID = GAD_SRC.DOC_GAUGE_ID
   AND GAD.DOC_GAUGE_FLOW_ID = DGF.DOC_GAUGE_FLOW_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_GAUGE_FLOW_COPY" ("GAF_DESCRIBE", "C_ADMIN_DOMAIN", "GAD_ORIGIN_DOC", "PARENT_GAUGE_ID", "PARENT_DESCRIBE", "CHILD_GAUGE_ID", "CHILD_DESCRIBE", "DOC_GAUGE_COPY_ID", "DOC_GAUGE_FLOW_DOCUM_ID", "GAC_TRANSFERT_PRICE", "GAC_TRANSFERT_QUANTITY", "GAC_INIT_PRICE_MVT", "GAC_INIT_QTY_MVT", "GAC_BOND", "GAC_PART_COPY", "DOC_DOC_GAUGE_ID", "GAC_TRANSFERT_STOCK", "GAC_TRANSFERT_DESCR", "GAC_TRANSFERT_REMISE_TAXE", "GAC_TRANSFERT_RECORD", "GAC_TRANSFERT_REPRESENT", "GAC_TRANSFERT_FREE_DATA", "GAC_TRANSFERT_PRICE_MVT", "GAC_INIT_COST_PRICE", "GAC_TRANSFERT_CHARACT", "GAC_TRANSFERT_PRECIOUS_MAT", "DOC_GAUGE_FLOW_ID", "PAC_THIRD_ID", "GCO_GOOD_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM") AS
  select flo.gaf_describe,
       flo.c_admin_domain,
       fld.gad_origin_doc,
       ga2.doc_gauge_id parent_gauge_id,
       ga2.gau_describe parent_describe,
       ga1.doc_gauge_id child_gauge_id,
       ga1.gau_describe child_describe,
       cop.doc_gauge_copy_id,
       cop.doc_gauge_flow_docum_id,
       cop.gac_transfert_price,
       cop.gac_transfert_quantity,
       cop.gac_init_price_mvt,
       cop.gac_init_qty_mvt,
       cop.gac_bond,
       cop.gac_part_copy,
       cop.doc_doc_gauge_id,
       cop.gac_transfert_stock,
       cop.gac_transfert_descr,
       cop.gac_transfert_remise_taxe,
       cop.gac_transfert_record,
       cop.gac_transfert_represent,
       cop.gac_transfert_free_data,
       cop.gac_transfert_price_mvt,
       cop.gac_init_cost_price,
       cop.gac_transfert_charact,
       cop.gac_transfert_precious_mat,
       flo.doc_gauge_flow_id,
       flo.pac_third_id,
       flo.gco_good_id,
       cop.a_datecre,
       cop.a_datemod,
       cop.a_idcre,
       cop.a_idmod,
       cop.a_reclevel,
       cop.a_recstatus,
       cop.a_confirm
  from doc_gauge_flow flo, doc_gauge_flow_docum fld, doc_gauge_copy cop, doc_gauge ga1, doc_gauge ga2
where flo.doc_gauge_flow_id = fld.doc_gauge_flow_id
  and fld.doc_gauge_flow_docum_id = cop.doc_gauge_flow_docum_id
  and ga1.doc_gauge_id = fld.doc_gauge_id
  and ga2.doc_gauge_id = cop.doc_doc_gauge_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_GAUGE_FLOW_RECEIPT" ("GAF_DESCRIBE", "C_ADMIN_DOMAIN", "GAD_ORIGIN_DOC", "PARENT_GAUGE_ID", "PARENT_DESCRIBE", "CHILD_GAUGE_ID", "CHILD_DESCRIBE", "DOC_GAUGE_RECEIPT_ID", "DOC_GAUGE_FLOW_DOCUM_ID", "GAR_QUANTITY_EXCEED", "GAR_GOOD_CHANGING", "GAR_PARTNER_CHANGING", "GAR_EXTOURNE_MVT", "GAR_BALANCE_PARENT", "GAR_TRANSFERT_PRICE", "GAR_TRANSFERT_QUANTITY", "GAR_INIT_PRICE_MVT", "GAR_INIT_QTY_MVT", "GAR_PART_DISCHARGE", "DOC_DOC_GAUGE_ID", "GAR_TRANSFERT_STOCK", "GAR_TRANSFERT_DESCR", "GAR_TRANSFERT_REMISE_TAXE", "GAR_INIT_COST_PRICE", "GAR_TRANSFER_MVMT_SWAP", "GAR_INVERT_AMOUNT", "GAR_TRANSFERT_RECORD", "GAR_TRANSFERT_REPRESENT", "GAR_TRANSFERT_FREE_DATA", "GAR_TRANSFERT_PRICE_MVT", "GAR_TRANSFERT_PRECIOUS_MAT", "DOC_GAUGE_FLOW_ID", "PAC_THIRD_ID", "GCO_GOOD_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM") AS
  select flo.gaf_describe,
       flo.c_admin_domain,
       fld.gad_origin_doc,
       ga2.doc_gauge_id parent_gauge_id,
       ga2.gau_describe parent_describe,
       ga1.doc_gauge_id child_gauge_id,
       ga1.gau_describe child_describe,
       rec.doc_gauge_receipt_id,
       rec.doc_gauge_flow_docum_id,
       rec.gar_quantity_exceed,
       rec.gar_good_changing,
       rec.gar_partner_changing,
       rec.gar_extourne_mvt,
       rec.gar_balance_parent,
       rec.gar_transfert_price,
       rec.gar_transfert_quantity,
       rec.gar_init_price_mvt,
       rec.gar_init_qty_mvt,
       rec.gar_part_discharge,
       rec.doc_doc_gauge_id,
       rec.gar_transfert_stock,
       rec.gar_transfert_descr,
       rec.gar_transfert_remise_taxe,
       rec.gar_init_cost_price,
       rec.gar_transfer_mvmt_swap,
       rec.gar_invert_amount,
       rec.gar_transfert_record,
       rec.gar_transfert_represent,
       rec.gar_transfert_free_data,
       rec.gar_transfert_price_mvt,
       rec.gar_transfert_precious_mat,
       flo.doc_gauge_flow_id,
       flo.pac_third_id,
       flo.gco_good_id,
       rec.a_datecre,
       rec.a_datemod,
       rec.a_idcre,
       rec.a_idmod,
       rec.a_reclevel,
       rec.a_recstatus,
       rec.a_confirm
  from doc_gauge_flow flo, doc_gauge_flow_docum fld, doc_gauge_receipt rec, doc_gauge ga1, doc_gauge ga2
where flo.doc_gauge_flow_id = fld.doc_gauge_flow_id
  and fld.doc_gauge_flow_docum_id = rec.doc_gauge_flow_docum_id
  and ga1.doc_gauge_id = fld.doc_gauge_id
  and ga2.doc_gauge_id = rec.doc_doc_gauge_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_GAUGE_STRUCTURED" ("DOC_GAUGE_ID", "PC_LANG_ID", "GAU_DESCRIBE", "LANNAME", "C_GAUGE_TITLE", "GCDTEXT1", "DIC_TYPE_MOVEMENT_ID", "DIC_DESCRIPTION", "C_ROUND_TYPE", "C_ROUND_TYPE_WORDING", "GAS_ROUND_AMOUNT", "GAS_POSITION__NUMBERING", "GAS_MODIFY_NUMBERING", "GAS_INCREMENT", "GAS_FIRST_NO", "GAS_INCREMENT_NBR", "GAS_BALANCE_STATUS", "GAS_PCENT", "GAS_FINANCIAL_CHARGE", "GAS_TOTAL_DOC", "ACS_FIN_ACC_S_PAYMENT_ID", "ACS_PAYMENT_METHOD_ID", "CAT_DESCRIPTION", "GAS_FINANCIAL_REF", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "GAS_GOOD_THIRD", "GAS_WEIGHT", "GAS_CORRELATION", "GAS_SUBSTITUTE", "GAS_CHARACTERIZATION", "GAS_PAY_CONDITION", "GAS_VAT", "GAS_TAXE", "ACJ_JOB_TYPE_S_CATALOGUE_ID", "C_TYPE_EDI", "C_CONTROLE_DATE_DOCUM", "C_CONTROLE_DATE_DOCUM_WORDING", "GAS_ANAL_CHARGE", "GAS_SENDING_CONDITION", "GAS_CHANGE_ACC_S_PAYMENT", "GAS_VISIBLE_COUNT", "C_CREDIT_LIMIT", "GAS_COMMISSION_MANAGEMENT", "GAS_CALCULATE_COMMISSION", "GAS_CASH_REGISTER", "GAS_FORM_CASH_REGISTER", "GAS_VAT_DET_ACCOUNT_VISIBLE", "GAS_INIT_FREE_DATA", "GAS_AUTO_ATTRIBUTION", "GAS_DIFFERED_CONFIRMATION", "PAC_PAYMENT_CONDITION_ID", "PAC_PAYMENT_CONDITION_WORDING", "C_BVR_GENERATION_METHOD", "C_START_CONTROL_DATE", "C_START_CONTROL_DATE_WORDING", "C_DOC_PRE_ENTRY", "C_DOC_PRE_ENTRY_THIRD", "GAS_CALCUL_CREDIT_LIMIT", "GAS_DOC_STATUS_CREDIT_LIMIT", "GAS_CREDIT_LIMIT_STATUS_01", "GAS_CREDIT_LIMIT_STATUS_02", "GAS_CREDIT_LIMIT_STATUS_03", "GAS_CREDIT_LIMIT_STATUS_04", "ACJ_JOB_TYPE_S_CAT_PMT_ID", "CAT_PMT_DESCRIPTION", "GAS_EDI_EXPORT_METHOD", "GAS_UNIT_PRICE_DECIMAL", "GAS_POS_QTY_DECIMAL", "GAS_STORED_PROC_VALIDATE", "GAS_STORED_PROC_CONFIRM", "GAS_ALL_CHARACTERIZATION", "GAS_CPN_ACCOUNT_MODIFY", "GAS_STORED_PROC_EDIT", "GAS_STORED_PROC_AFTER_VALIDATE", "GAS_STORED_PROC_AFTER_CONFIRM", "GAS_STORED_PROC_AFTER_EDIT", "GAS_STORED_PROC_DELETE", "GAS_STORED_PROC_AFTER_DELETE", "GAS_PROC_VALIDATE_POS", "GAS_PROC_EDIT_POS", "GAS_PROC_DELETE_POS", "GAS_PROC_AFTER_VALIDATE_POS", "GAS_PROC_AFTER_EDIT_POS", "GAS_PROC_AFTER_DELETE_POS", "GAS_AUTO_MRP", "C_DOC_CREDITLIMIT_MODE", "GAS_WEIGHING_MGM", "GAS_WEIGHT_MAT", "GAS_USE_PARTNER_DATE", "GAS_COST", "GAS_DISCOUNT", "GAS_CHARGE", "GAS_CASH_MULTIPLE_TRANSACTION", "C_PIC_FORECAST_CONTROL", "GAS_PREVIOUS_PERIODS_NB", "GAS_FOLLOWING_PERIODS_NB", "GAS_MULTISOURCING_MGM", "GAS_AUTH_BALANCE_RETURN", "GAS_AUTH_BALANCE_NO_RETURN") AS
  select DISTINCT DOC_GAUGE_STRUCTURED."DOC_GAUGE_ID", PC_LANG."PC_LANG_ID",
DOC_GAUGE.GAU_DESCRIBE,
PC_LANG."LANNAME", DOC_GAUGE_STRUCTURED."C_GAUGE_TITLE",
V_PC_DESCODES_GAUGE_TITLE."GCDTEXT1",
DOC_GAUGE_STRUCTURED."DIC_TYPE_MOVEMENT_ID", DIC_TYPE_MOVEMENT."DIC_DESCRIPTION",
DOC_GAUGE_STRUCTURED."C_ROUND_TYPE",
V_PC_DESCODES_ROUND_TYPE."GCDTEXT1" C_ROUND_TYPE_WORDING,
DOC_GAUGE_STRUCTURED."GAS_ROUND_AMOUNT",
DOC_GAUGE_STRUCTURED."GAS_POSITION__NUMBERING",
DOC_GAUGE_STRUCTURED."GAS_MODIFY_NUMBERING",
DOC_GAUGE_STRUCTURED."GAS_INCREMENT", DOC_GAUGE_STRUCTURED."GAS_FIRST_NO",
DOC_GAUGE_STRUCTURED."GAS_INCREMENT_NBR",
DOC_GAUGE_STRUCTURED."GAS_BALANCE_STATUS", DOC_GAUGE_STRUCTURED."GAS_PCENT",
DOC_GAUGE_STRUCTURED."GAS_FINANCIAL_CHARGE",
DOC_GAUGE_STRUCTURED."GAS_TOTAL_DOC",
DOC_GAUGE_STRUCTURED."ACS_FIN_ACC_S_PAYMENT_ID",
ACS_FIN_ACC_S_PAYMENT."ACS_PAYMENT_METHOD_ID",
ACJ_CATALOGUE_DOCUMENT."CAT_DESCRIPTION",
DOC_GAUGE_STRUCTURED."GAS_FINANCIAL_REF",
DOC_GAUGE_STRUCTURED.ACS_FINANCIAL_ACCOUNT_ID,
DOC_GAUGE_STRUCTURED.ACS_DIVISION_ACCOUNT_ID,
DOC_GAUGE_STRUCTURED."GAS_GOOD_THIRD", DOC_GAUGE_STRUCTURED."GAS_WEIGHT",
DOC_GAUGE_STRUCTURED."GAS_CORRELATION", DOC_GAUGE_STRUCTURED."GAS_SUBSTITUTE",
DOC_GAUGE_STRUCTURED."GAS_CHARACTERIZATION",
DOC_GAUGE_STRUCTURED."GAS_PAY_CONDITION", DOC_GAUGE_STRUCTURED."GAS_VAT",
DOC_GAUGE_STRUCTURED."GAS_TAXE",
DOC_GAUGE_STRUCTURED.ACJ_JOB_TYPE_S_CATALOGUE_ID,
DOC_GAUGE_STRUCTURED.C_TYPE_EDI,
DOC_GAUGE_STRUCTURED.C_CONTROLE_DATE_DOCUM, V_PC_DESCODES_CTRL_DATE_DOCUM."GCDTEXT1" C_CONTROLE_DATE_DOCUM_WORDING,
DOC_GAUGE_STRUCTURED.GAS_ANAL_CHARGE, DOC_GAUGE_STRUCTURED.GAS_SENDING_CONDITION,
DOC_GAUGE_STRUCTURED.GAS_CHANGE_ACC_S_PAYMENT, DOC_GAUGE_STRUCTURED.GAS_VISIBLE_COUNT,
DOC_GAUGE_STRUCTURED.C_CREDIT_LIMIT, DOC_GAUGE_STRUCTURED.GAS_COMMISSION_MANAGEMENT,
DOC_GAUGE_STRUCTURED.GAS_CALCULATE_COMMISSION, DOC_GAUGE_STRUCTURED.GAS_CASH_REGISTER,
DOC_GAUGE_STRUCTURED.GAS_FORM_CASH_REGISTER, DOC_GAUGE_STRUCTURED.GAS_VAT_DET_ACCOUNT_VISIBLE,
DOC_GAUGE_STRUCTURED.GAS_INIT_FREE_DATA, DOC_GAUGE_STRUCTURED.GAS_AUTO_ATTRIBUTION,
DOC_GAUGE_STRUCTURED.GAS_DIFFERED_CONFIRMATION,
DOC_GAUGE_STRUCTURED.PAC_PAYMENT_CONDITION_ID, PCS.PC_FUNCTIONS.GetAppltxtDescr(PAC_PAYMENT_CONDITION."PC_APPLTXT_ID",PC_LANG."PC_LANG_ID") PAC_PAYMENT_CONDITION_WORDING,
DOC_GAUGE_STRUCTURED.C_BVR_GENERATION_METHOD,
DOC_GAUGE_STRUCTURED.C_START_CONTROL_DATE, V_PC_DESCODES_START_CTRL_DATE."GCDTEXT1" C_START_CONTROL_DATE_WORDING,
DOC_GAUGE_STRUCTURED.C_DOC_PRE_ENTRY, DOC_GAUGE_STRUCTURED.C_DOC_PRE_ENTRY_THIRD,
DOC_GAUGE_STRUCTURED.GAS_CALCUL_CREDIT_LIMIT, DOC_GAUGE_STRUCTURED.GAS_DOC_STATUS_CREDIT_LIMIT,
DOC_GAUGE_STRUCTURED.GAS_CREDIT_LIMIT_STATUS_01, DOC_GAUGE_STRUCTURED.GAS_CREDIT_LIMIT_STATUS_02,
DOC_GAUGE_STRUCTURED.GAS_CREDIT_LIMIT_STATUS_03, DOC_GAUGE_STRUCTURED.GAS_CREDIT_LIMIT_STATUS_04,
DOC_GAUGE_STRUCTURED.ACJ_JOB_TYPE_S_CAT_PMT_ID, ACJ_CATALOGUE_DOCUMENT2."CAT_DESCRIPTION" CAT_PMT_DESCRIPTION,
DOC_GAUGE_STRUCTURED.GAS_EDI_EXPORT_METHOD,
DOC_GAUGE_STRUCTURED.GAS_UNIT_PRICE_DECIMAL, DOC_GAUGE_STRUCTURED.GAS_POS_QTY_DECIMAL,
DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_VALIDATE, DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_CONFIRM,
DOC_GAUGE_STRUCTURED.GAS_ALL_CHARACTERIZATION, DOC_GAUGE_STRUCTURED.GAS_CPN_ACCOUNT_MODIFY,
DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_EDIT, DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_AFTER_VALIDATE,
DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_AFTER_CONFIRM, DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_AFTER_EDIT,
DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_DELETE, DOC_GAUGE_STRUCTURED.GAS_STORED_PROC_AFTER_DELETE,
DOC_GAUGE_STRUCTURED.GAS_PROC_VALIDATE_POS, DOC_GAUGE_STRUCTURED.GAS_PROC_EDIT_POS,
DOC_GAUGE_STRUCTURED.GAS_PROC_DELETE_POS, DOC_GAUGE_STRUCTURED.GAS_PROC_AFTER_VALIDATE_POS,
DOC_GAUGE_STRUCTURED.GAS_PROC_AFTER_EDIT_POS, DOC_GAUGE_STRUCTURED.GAS_PROC_AFTER_DELETE_POS,
DOC_GAUGE_STRUCTURED.GAS_AUTO_MRP, DOC_GAUGE_STRUCTURED.C_DOC_CREDITLIMIT_MODE,
DOC_GAUGE_STRUCTURED.GAS_WEIGHING_MGM, DOC_GAUGE_STRUCTURED.GAS_WEIGHT_MAT,
DOC_GAUGE_STRUCTURED.GAS_USE_PARTNER_DATE, DOC_GAUGE_STRUCTURED.GAS_COST,
DOC_GAUGE_STRUCTURED.GAS_DISCOUNT, DOC_GAUGE_STRUCTURED.GAS_CHARGE,
DOC_GAUGE_STRUCTURED.GAS_CASH_MULTIPLE_TRANSACTION, DOC_GAUGE_STRUCTURED.C_PIC_FORECAST_CONTROL,
DOC_GAUGE_STRUCTURED.GAS_PREVIOUS_PERIODS_NB,
DOC_GAUGE_STRUCTURED.GAS_FOLLOWING_PERIODS_NB, DOC_GAUGE_STRUCTURED.GAS_MULTISOURCING_MGM,
DOC_GAUGE_STRUCTURED.GAS_AUTH_BALANCE_RETURN, DOC_GAUGE_STRUCTURED.GAS_AUTH_BALANCE_NO_RETURN
from "DOC_GAUGE_STRUCTURED" DOC_GAUGE_STRUCTURED,
"DOC_GAUGE" DOC_GAUGE,
"DIC_TYPE_MOVEMENT" DIC_TYPE_MOVEMENT,
"ACS_FIN_ACC_S_PAYMENT" ACS_FIN_ACC_S_PAYMENT,
"PAC_PAYMENT_CONDITION" PAC_PAYMENT_CONDITION,
"ACJ_JOB_TYPE_S_CATALOGUE" ACJ_JOB_TYPE_S_CATALOGUE,
"ACJ_JOB_TYPE_S_CATALOGUE" ACJ_JOB_TYPE_S_CATALOGUE2,
"ACJ_CATALOGUE_DOCUMENT" ACJ_CATALOGUE_DOCUMENT,
"ACJ_CATALOGUE_DOCUMENT" ACJ_CATALOGUE_DOCUMENT2,
"PCS"."V_PC_DESCODES" V_PC_DESCODES_GAUGE_TITLE,
"PCS"."V_PC_DESCODES" V_PC_DESCODES_ROUND_TYPE,
"PCS"."V_PC_DESCODES" V_PC_DESCODES_CTRL_DATE_DOCUM,
"PCS"."V_PC_DESCODES" V_PC_DESCODES_START_CTRL_DATE,
"PCS"."V_PC_DESCODES" V_PC_DESCODES_TYPE_EDI,
"PCS"."PC_LANG" PC_LANG
where DOC_GAUGE.DOC_GAUGE_ID = DOC_GAUGE_STRUCTURED.DOC_GAUGE_ID
and DOC_GAUGE_STRUCTURED."DIC_TYPE_MOVEMENT_ID" = DIC_TYPE_MOVEMENT."DIC_TYPE_MOVEMENT_ID"(+)
and DOC_GAUGE_STRUCTURED."C_GAUGE_TITLE" = V_PC_DESCODES_GAUGE_TITLE."GCLCODE"
and DOC_GAUGE_STRUCTURED."C_ROUND_TYPE" = V_PC_DESCODES_ROUND_TYPE."GCLCODE"
and DOC_GAUGE_STRUCTURED."C_CONTROLE_DATE_DOCUM" = V_PC_DESCODES_CTRL_DATE_DOCUM."GCLCODE"
and DOC_GAUGE_STRUCTURED."C_START_CONTROL_DATE" = V_PC_DESCODES_START_CTRL_DATE."GCLCODE"
and DOC_GAUGE_STRUCTURED."C_TYPE_EDI" = V_PC_DESCODES_TYPE_EDI."GCLCODE"
and DOC_GAUGE_STRUCTURED."ACS_FIN_ACC_S_PAYMENT_ID" = ACS_FIN_ACC_S_PAYMENT."ACS_FIN_ACC_S_PAYMENT_ID"(+)
and DOC_GAUGE_STRUCTURED."ACJ_JOB_TYPE_S_CATALOGUE_ID" = ACJ_JOB_TYPE_S_CATALOGUE."ACJ_JOB_TYPE_S_CATALOGUE_ID"(+)
and ACJ_JOB_TYPE_S_CATALOGUE."ACJ_CATALOGUE_DOCUMENT_ID" = ACJ_CATALOGUE_DOCUMENT."ACJ_CATALOGUE_DOCUMENT_ID"(+)
and DOC_GAUGE_STRUCTURED."ACJ_JOB_TYPE_S_CAT_PMT_ID" = ACJ_JOB_TYPE_S_CATALOGUE2."ACJ_JOB_TYPE_S_CATALOGUE_ID"(+)
and ACJ_JOB_TYPE_S_CATALOGUE2."ACJ_CATALOGUE_DOCUMENT_ID" = ACJ_CATALOGUE_DOCUMENT2."ACJ_CATALOGUE_DOCUMENT_ID"(+)
and DOC_GAUGE_STRUCTURED."PAC_PAYMENT_CONDITION_ID" = PAC_PAYMENT_CONDITION."PAC_PAYMENT_CONDITION_ID" (+)
and V_PC_DESCODES_GAUGE_TITLE."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DESCODES_ROUND_TYPE."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DESCODES_CTRL_DATE_DOCUM."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DESCODES_START_CTRL_DATE."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DESCODES_TYPE_EDI."PC_LANG_ID" = PC_LANG."PC_LANG_ID"
and V_PC_DESCODES_GAUGE_TITLE."GCGNAME" = 'C_GAUGE_TITLE'
and V_PC_DESCODES_ROUND_TYPE."GCGNAME" = 'C_ROUND_TYPE'
and V_PC_DESCODES_CTRL_DATE_DOCUM."GCGNAME" = 'C_CONTROLE_DATE_DOCUM'
and V_PC_DESCODES_START_CTRL_DATE."GCGNAME" = 'C_START_CONTROL_DATE'
and V_PC_DESCODES_TYPE_EDI."GCGNAME" = 'C_TYPE_EDI'
with check option


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_HEADER_4_PRNT" ("DOC_DOCUMENT_ID", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_VALUE", "DMT_DATE_FALLING_DUE", "DMT_DATE_DELIVERY", "C_DOCUMENT_STATUS", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_DATE_PARTNER_DOCUMENT", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DIC_DOC_FREE_1_ID", "DIC_DOC_FREE_2_ID", "DIC_DOC_FREE_3_ID", "DIC_TYPE_SUBMISSION_ID", "DOC_DIC_POS_FREE_TABLE_1_ID", "DOC_DIC_POS_FREE_TABLE_2_ID", "DOC_DIC_POS_FREE_TABLE_3_ID", "DMT_DECIMAL_1", "DMT_DECIMAL_2", "DMT_DECIMAL_3", "DMT_TEXT_1", "DMT_TEXT_2", "DMT_TEXT_3", "DMT_DATE_1", "DMT_DATE_2", "DMT_DATE_3", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "DMT_GAU_FREE_NUMBER1", "DMT_GAU_FREE_NUMBER2", "DMT_GAU_FREE_DATE1", "DMT_GAU_FREE_DATE2", "DMT_GAU_FREE_TEXT_LONG", "DMT_GAU_FREE_TEXT_SHORT", "DMT_GAU_FREE_BOOL1", "DMT_GAU_FREE_BOOL2", "DIC_TARIFF_ID", "C_INCOTERMS", "DMT_INCOTERMS_PLACE", "PAC_REPRESENTATIVE_ID", "REP_DESCR", "DIC_ACCOUNTABLE_GROUP_ID", "RCO_TITLE", "RCO_DESCRIPTION", "PAC_THIRD_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_INTRA", "THI_NO_TVA", "THI_NO_SIREN", "THI_NO_SIRET", "THI_NO_FORMAT", "C_DELIVERY_TYP", "CUS_SUPPLIER_NUMBER", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "DIC_TYPE_PARTNER_ID", "CRE_CUSTOMER_NUMBER", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "DIC_TYPE_PARTNER_F_ID", "PAC_SENDING_CONDITION_ID", "SEN_DESCR", "SENDING_ADDRESS_ID", "SEN_PER_NAME", "SEN_PER_FORENAME", "SEN_PER_ACTIVITY", "SEN_PER_COMMENT", "SEN_PER_KEY1", "SEN_PER_KEY2", "SEN_ADD_ADDRESS1", "SEN_ADD_FORMAT", "ACS_PAYMENT_METHOD_ID", "PAY_METH_DESCR", "CUSTOMER_ACCOUNT", "SUPPLIER_ACCOUNT", "PC_LANG_ID", "PAC_PAYMENT_CONDITION_ID", "PCO_DESCR", "PMT_PC_APPLTXT_ID", "COND_DESCR", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "CURRNAME", "LANID", "ADDRESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "PER_DPO_DESCR", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "CNTID", "CNTNAME", "DIC_PC_CNTRY_GRP_ID", "CNT_CE_CODE", "CNT_CE_MEMBER", "ADDRESS2_ID", "PER2_NAME", "PER2_FORENAME", "PER2_ACTIVITY", "PER2_COMMENT", "PER2_KEY1", "PER2_KEY2", "PER2_DPO_DESCR", "DMT_ADDRESS2", "DMT_FORMAT_CITY2", "CNTID2", "CNTNAME2", "DIC_PC_CNTRY_GRP_ID2", "CNT_CE_CODE2", "CNT_CE_MEMBER2", "ADDRESS3_ID", "PER3_NAME", "PER3_FORENAME", "PER3_ACTIVITY", "PER3_COMMENT", "PER3_KEY1", "PER3_KEY2", "PER3_DPO_DESCR", "DMT_ADDRESS3", "DMT_FORMAT_CITY3", "CNTID3", "CNTNAME3", "DIC_PC_CNTRY_GRP_ID3", "CNT_CE_CODE3", "CNT_CE_MEMBER3", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "C_ADMIN_DOMAIN", "DIC_DOC_FREE_TABLE_1_ID", "DIC_DOC_FREE_TABLE_2_ID", "DIC_DOC_FREE_TABLE_3_ID", "DIC_DOC_FREE_TABLE_4_ID", "DIC_DOC_FREE_TABLE_5_ID", "FRD_ALPHA_SHORT_1", "FRD_ALPHA_SHORT_2", "FRD_ALPHA_SHORT_3", "FRD_ALPHA_SHORT_4", "FRD_ALPHA_SHORT_5", "FRD_ALPHA_LONG_1", "FRD_ALPHA_LONG_2", "FRD_ALPHA_LONG_3", "FRD_ALPHA_LONG_4", "FRD_ALPHA_LONG_5", "FRD_INTEGER_1", "FRD_INTEGER_2", "FRD_INTEGER_3", "FRD_INTEGER_4", "FRD_INTEGER_5", "FRD_DECIMAL_1", "FRD_DECIMAL_2", "FRD_DECIMAL_3", "FRD_DECIMAL_4", "FRD_DECIMAL_5", "FRD_BOOLEAN_1", "FRD_BOOLEAN_2", "FRD_BOOLEAN_3", "FRD_BOOLEAN_4", "FRD_BOOLEAN_5", "DOC_FOOT_ID", "DOC_GAUGE_SIGNATORY_ID", "GAG_NAME", "GAG_FUNCTION", "DOC_DOC_GAUGE_SIGNATORY_ID", "GAG2_NAME", "GAG2_FUNCTION", "FOO_FOOT_TEXT", "FOO_FOOT_TEXT2", "FOO_FOOT_TEXT3", "FOO_FOOT_TEXT4", "FOO_FOOT_TEXT5", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT", "FOO_TOTAL_VAT_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "FOO_REF_BVR_NUMBER", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_PAID_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "DIC_TYPE_DOC_CUSTOM_ID", "C_DIRECTION_NUMBER", "FOO_TOT_VAT_AMOUNT_V", "FOO_RECEIVED_AMOUNT", "FOO_PAID_BALANCED_AMOUNT", "PAD_PAYMENT_DATE", "PAD_BAND_NUMBER", "PAD_DATE_AMOUNT", "PAD_DISCOUNT_AMOUNT", "PAD_NET_DATE_AMOUNT", "PAD_BVR_REFERENCE_NUM", "PAD_BVR_CODING_LINE", "FOO_PARCEL_QTY", "PAC_DISTRIBUTION_CHANNEL_ID", "PAC_SALE_TERRITORY_ID", "PDC_KEY", "PDC_DESCRIPTION", "STE_KEY", "STE_DESCRIPTION", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_REPR_ACI_ID", "PAC_REPR_DELIVERY_ID", "PC_LANG_ACI_ID", "PC_LANG_DELIVERY_ID", "DMT_NAME1", "DMT_FORENAME1", "DMT_ACTIVITY1", "DMT_CARE_OF1", "DMT_PO_BOX1", "DMT_PO_BOX_NBR1", "DMT_COUNTY1", "DMT_CONTACT1", "DMT_NAME2", "DMT_FORENAME2", "DMT_ACTIVITY2", "DMT_CARE_OF2", "DMT_PO_BOX2", "DMT_PO_BOX_NBR2", "DMT_COUNTY2", "DMT_CONTACT2", "DMT_NAME3", "DMT_FORENAME3", "DMT_ACTIVITY3", "DMT_CARE_OF3", "DMT_PO_BOX3", "DMT_PO_BOX_NBR3", "DMT_COUNTY3", "DMT_CONTACT3", "DOC_RECORD_ID") AS
  select DMT.DOC_DOCUMENT_ID
       , DMT.DMT_NUMBER DMT_NUMBER
       , DMT.DMT_DATE_DOCUMENT
       , DMT.DMT_DATE_VALUE
       , DMT.DMT_DATE_FALLING_DUE
       , DMT.DMT_DATE_DELIVERY
       , DMT.C_DOCUMENT_STATUS
       , DMT.DMT_PARTNER_NUMBER
       , DMT.DMT_PARTNER_REFERENCE
       , DMT.DMT_DATE_PARTNER_DOCUMENT
       , DMT.DMT_REFERENCE
       , DMT.DMT_TITLE_TEXT
       , DMT.DMT_HEADING_TEXT
       , DMT.DMT_DOCUMENT_TEXT
       , DMT.DIC_DOC_FREE_1_ID
       , DMT.DIC_DOC_FREE_2_ID
       , DMT.DIC_DOC_FREE_3_ID
       , DMT.DIC_TYPE_SUBMISSION_ID
       , DMT.DIC_POS_FREE_TABLE_1_ID DOC_DIC_POS_FREE_TABLE_1_ID
       , DMT.DIC_POS_FREE_TABLE_2_ID DOC_DIC_POS_FREE_TABLE_2_ID
       , DMT.DIC_POS_FREE_TABLE_3_ID DOC_DIC_POS_FREE_TABLE_3_ID
       , DMT.DMT_DECIMAL_1
       , DMT.DMT_DECIMAL_2
       , DMT.DMT_DECIMAL_3
       , DMT.DMT_TEXT_1
       , DMT.DMT_TEXT_2
       , DMT.DMT_TEXT_3
       , DMT.DMT_DATE_1
       , DMT.DMT_DATE_2
       , DMT.DMT_DATE_3
       , DMT.DIC_GAUGE_FREE_CODE_1_ID
       , DMT.DIC_GAUGE_FREE_CODE_2_ID
       , DMT.DIC_GAUGE_FREE_CODE_3_ID
       , DMT.DMT_GAU_FREE_NUMBER1
       , DMT.DMT_GAU_FREE_NUMBER2
       , DMT.DMT_GAU_FREE_DATE1
       , DMT.DMT_GAU_FREE_DATE2
       , DMT.DMT_GAU_FREE_TEXT_LONG
       , DMT.DMT_GAU_FREE_TEXT_SHORT
       , DMT.DMT_GAU_FREE_BOOL1
       , DMT.DMT_GAU_FREE_BOOL2
       , DMT.DIC_TARIFF_ID
       , DMT.C_INCOTERMS
       , DMT.DMT_INCOTERMS_PLACE
       , REP.PAC_REPRESENTATIVE_ID
       , REP.REP_DESCR
       , REC.DIC_ACCOUNTABLE_GROUP_ID
       , REC.RCO_TITLE
       , REC.RCO_DESCRIPTION
       , DMT.PAC_THIRD_ID
       , THI.DIC_THIRD_ACTIVITY_ID
       , THI.DIC_THIRD_AREA_ID
       , THI.THI_NO_INTRA
       , THI.THI_NO_TVA
       , THI.THI_NO_SIREN
       , THI.THI_NO_SIRET
       , THI.THI_NO_FORMAT
       , CUS.C_DELIVERY_TYP
       , CUS.CUS_SUPPLIER_NUMBER
       , CUS.CUS_FREE_ZONE1
       , CUS.CUS_FREE_ZONE2
       , CUS.CUS_FREE_ZONE3
       , CUS.CUS_FREE_ZONE4
       , CUS.CUS_FREE_ZONE5
       , CUS.DIC_STATISTIC_1_ID
       , CUS.DIC_STATISTIC_2_ID
       , CUS.DIC_STATISTIC_3_ID
       , CUS.DIC_STATISTIC_4_ID
       , CUS.DIC_STATISTIC_5_ID
       , CUS.DIC_TYPE_PARTNER_ID
       , SUP.CRE_CUSTOMER_NUMBER
       , SUP.CRE_FREE_ZONE1
       , SUP.CRE_FREE_ZONE2
       , SUP.CRE_FREE_ZONE3
       , SUP.CRE_FREE_ZONE4
       , SUP.CRE_FREE_ZONE5
       , SUP.DIC_STATISTIC_F1_ID
       , SUP.DIC_STATISTIC_F2_ID
       , SUP.DIC_STATISTIC_F3_ID
       , SUP.DIC_STATISTIC_F4_ID
       , SUP.DIC_STATISTIC_F5_ID
       , SUP.DIC_TYPE_PARTNER_F_ID
       , PSC.PAC_SENDING_CONDITION_ID
       , PAC_FUNCTIONS.GetSendCondDescr(PSC.PAC_SENDING_CONDITION_ID, DMT.PC_LANG_ID) SEN_DESCR
       , PSC.PAC_ADDRESS_ID SENDING_ADDRESS_ID
       , PER_SEN.PER_NAME SEN_PER_NAME
       , PER_SEN.PER_FORENAME SEN_PER_FORENAME
       , PER_SEN.PER_ACTIVITY SEN_PER_ACTIVITY
       , PER_SEN.PER_COMMENT SEN_PER_COMMENT
       , PER_SEN.PER_KEY1 SEN_PER_KEY1
       , PER_SEN.PER_KEY2 SEN_PER_KEY2
       , ADR_SEN.ADD_ADDRESS1 SEN_ADD_ADDRESS1
       , ADR_SEN.ADD_FORMAT SEN_ADD_FORMAT
       , APM.ACS_PAYMENT_METHOD_ID
       , ACS_FUNCTION.GetPayMethDescr(APM.ACS_PAYMENT_METHOD_ID, DMT.PC_LANG_ID) PAY_METH_DESCR
       , ACCC.ACC_NUMBER CUSTOMER_ACCOUNT
       , ACCS.ACC_NUMBER SUPPLIER_ACCOUNT
       , DMT.PC_LANG_ID
       , PMT.PAC_PAYMENT_CONDITION_ID
       , PMT.PCO_DESCR
       , PMT.PC_APPLTXT_ID PMT_PC_APPLTXT_ID
       , PCS.PC_FUNCTIONS.GetAppltxtDescr(PMT.PC_APPLTXT_ID, DMT.PC_LANG_ID) COND_DESCR
       , AFC.ACS_FINANCIAL_CURRENCY_ID
       , CUR.CURRENCY
       , CUR.CURRNAME
       , LANG.LANID
       , DMT.PAC_ADDRESS_ID ADDRESS_ID
       , PER.PER_NAME
       , PER.PER_FORENAME
       , PER.PER_ACTIVITY
       , PER.PER_COMMENT
       , PER.PER_KEY1
       , PER.PER_KEY2
       , (select DPO_DESCR
            from DIC_PERSON_POLITNESS
           where DIC_PERSON_POLITNESS_ID = PER.DIC_PERSON_POLITNESS_ID) PER_DPO_DESCR
       , DMT.DMT_ADDRESS1
       , DMT.DMT_FORMAT_CITY1
       , CNT.CNTID
       , CNT.CNTNAME
       , CNT.DIC_PC_CNTRY_GRP_ID
       , CNT.CNT_CE_CODE
       , CNT.CNT_CE_MEMBER
       , DMT.PAC_PAC_ADDRESS_ID ADDRESS2_ID
       , PER2.PER_NAME PER2_NAME
       , PER2.PER_FORENAME PER2_FORENAME
       , PER2.PER_ACTIVITY PER2_ACTIVITY
       , PER2.PER_COMMENT PER2_COMMENT
       , PER2.PER_KEY1 PER2_KEY1
       , PER2.PER_KEY2 PER2_KEY2
       , (select DPO_DESCR
            from DIC_PERSON_POLITNESS
           where DIC_PERSON_POLITNESS_ID = PER2.DIC_PERSON_POLITNESS_ID) PER2_DPO_DESCR
       , DMT.DMT_ADDRESS2
       , DMT.DMT_FORMAT_CITY2
       , CNT2.CNTID CNTID2
       , CNT2.CNTNAME CNTNAME2
       , CNT2.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID2
       , CNT2.CNT_CE_CODE CNT_CE_CODE2
       , CNT2.CNT_CE_MEMBER CNT_CE_MEMBER2
       , DMT.PAC2_PAC_ADDRESS_ID ADDRESS3_ID
       , PER3.PER_NAME PER3_NAME
       , PER3.PER_FORENAME PER3_FORENAME
       , PER3.PER_ACTIVITY PER3_ACTIVITY
       , PER3.PER_COMMENT PER3_COMMENT
       , PER3.PER_KEY1 PER3_KEY1
       , PER3.PER_KEY2 PER3_KEY2
       , (select DPO_DESCR
            from DIC_PERSON_POLITNESS
           where DIC_PERSON_POLITNESS_ID = PER3.DIC_PERSON_POLITNESS_ID) PER3_DPO_DESCR
       , DMT.DMT_ADDRESS3
       , DMT.DMT_FORMAT_CITY3
       , CNT3.CNTID CNTID3
       , CNT3.CNTNAME CNTNAME3
       , CNT3.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID3
       , CNT3.CNT_CE_CODE CNT_CE_CODE3
       , CNT3.CNT_CE_MEMBER CNT_CE_MEMBER3
       , GAU.C_GAUGE_TYPE
       , GST.C_GAUGE_TITLE
       , GAU.C_ADMIN_DOMAIN
       , DFD.DIC_DOC_FREE_TABLE_1_ID
       , DFD.DIC_DOC_FREE_TABLE_2_ID
       , DFD.DIC_DOC_FREE_TABLE_3_ID
       , DFD.DIC_DOC_FREE_TABLE_4_ID
       , DFD.DIC_DOC_FREE_TABLE_5_ID
       , DFD.FRD_ALPHA_SHORT_1
       , DFD.FRD_ALPHA_SHORT_2
       , DFD.FRD_ALPHA_SHORT_3
       , DFD.FRD_ALPHA_SHORT_4
       , DFD.FRD_ALPHA_SHORT_5
       , DFD.FRD_ALPHA_LONG_1
       , DFD.FRD_ALPHA_LONG_2
       , DFD.FRD_ALPHA_LONG_3
       , DFD.FRD_ALPHA_LONG_4
       , DFD.FRD_ALPHA_LONG_5
       , DFD.FRD_INTEGER_1
       , DFD.FRD_INTEGER_2
       , DFD.FRD_INTEGER_3
       , DFD.FRD_INTEGER_4
       , DFD.FRD_INTEGER_5
       , DFD.FRD_DECIMAL_1
       , DFD.FRD_DECIMAL_2
       , DFD.FRD_DECIMAL_3
       , DFD.FRD_DECIMAL_4
       , DFD.FRD_DECIMAL_5
       , DFD.FRD_BOOLEAN_1
       , DFD.FRD_BOOLEAN_2
       , DFD.FRD_BOOLEAN_3
       , DFD.FRD_BOOLEAN_4
       , DFD.FRD_BOOLEAN_5
       , FOO.DOC_FOOT_ID
       , FOO.DOC_GAUGE_SIGNATORY_ID
       , DGS.GAG_NAME
       , DGS.GAG_FUNCTION
       , FOO.DOC_DOC_GAUGE_SIGNATORY_ID
       , DGS2.GAG_NAME GAG2_NAME
       , DGS2.GAG_FUNCTION GAG2_FUNCTION
       , FOO.FOO_FOOT_TEXT
       , FOO.FOO_FOOT_TEXT2
       , FOO.FOO_FOOT_TEXT3
       , FOO.FOO_FOOT_TEXT4
       , FOO.FOO_FOOT_TEXT5
       , FOO.FOO_DOCUMENT_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOTAL_AMOUNT
       , FOO.FOO_TOTAL_VAT_AMOUNT
       , FOO.FOO_CHARGE_TOTAL_AMOUNT
       , FOO.FOO_DISCOUNT_TOTAL_AMOUNT
       , FOO.FOO_COST_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOT_AMOUNT_EXCL
       , FOO.FOO_CHARG_TOT_AMOUNT_EXCL
       , FOO.FOO_DISC_TOT_AMOUNT_EXCL
       , FOO.FOO_COST_TOT_AMOUNT_EXCL
       , FOO.FOO_TOTAL_NET_WEIGHT
       , FOO.FOO_TOTAL_GROSS_WEIGHT
       , FOO.FOO_TOTAL_NET_WEIGHT_MEAS
       , FOO.FOO_TOTAL_GROSS_WEIGHT_MEAS
       , FOO.FOO_TOTAL_BASIS_QUANTITY
       , FOO.FOO_TOTAL_INTERM_QUANTITY
       , FOO.FOO_TOTAL_FINAL_QUANTITY
       , FOO.C_BVR_GENERATION_METHOD
       , FOO.FOO_GENERATE_BVR_NUMBER
       , FOO.FOO_REF_BVR_NUMBER
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_B
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_E
       , FOO.FOO_PAID_AMOUNT
       , FOO.FOO_RETURN_AMOUNT
       , FOO.FOO_PACKAGING
       , FOO.FOO_MARKING
       , FOO.FOO_MEASURE
       , FOO.DIC_TYPE_DOC_CUSTOM_ID
       , FOO.C_DIRECTION_NUMBER
       , FOO.FOO_TOT_VAT_AMOUNT_V
       , FOO.FOO_RECEIVED_AMOUNT
       , FOO.FOO_PAID_BALANCED_AMOUNT
       , DPD.PAD_PAYMENT_DATE
       , DPD.PAD_BAND_NUMBER
       , DPD.PAD_DATE_AMOUNT
       , DPD.PAD_DISCOUNT_AMOUNT
       , DPD.PAD_NET_DATE_AMOUNT
       , DPD.PAD_BVR_REFERENCE_NUM
       , DPD.PAD_BVR_CODING_LINE
       , FOO.FOO_PARCEL_QTY
       , DMT.PAC_DISTRIBUTION_CHANNEL_ID
       , DMT.PAC_SALE_TERRITORY_ID
       , PDC.PDC_KEY
       , PDC.PDC_DESCRIPTION
       , STE.STE_KEY
       , STE.STE_DESCRIPTION
       , DMT.PAC_THIRD_ACI_ID
       , DMT.PAC_THIRD_DELIVERY_ID
       , DMT.PAC_THIRD_TARIFF_ID
       , DMT.PAC_REPR_ACI_ID
       , DMT.PAC_REPR_DELIVERY_ID
       , DMT.PC_LANG_ACI_ID
       , DMT.PC_LANG_DELIVERY_ID
       , nvl(DMT.DMT_NAME1, PER.PER_NAME) DMT_NAME1
       , nvl(DMT.DMT_FORENAME1, PER.PER_FORENAME) DMT_FORENAME1
       , nvl(DMT.DMT_ACTIVITY1, PER.PER_ACTIVITY) DMT_ACTIVITY1
       , nvl(DMT.DMT_CARE_OF1, ADR.ADD_CARE_OF) DMT_CARE_OF1
       , nvl(DMT.DMT_PO_BOX1, ADR.ADD_PO_BOX) DMT_PO_BOX1
       , nvl(DMT.DMT_PO_BOX_NBR1, ADR.ADD_PO_BOX_NBR) DMT_PO_BOX_NBR1
       , nvl(DMT.DMT_COUNTY1, ADR.ADD_COUNTY) DMT_COUNTY1
       , nvl(DMT.DMT_CONTACT1, PER.PER_CONTACT) DMT_CONTACT1
       , nvl(DMT.DMT_NAME2, PER2.PER_NAME) DMT_NAME2
       , nvl(DMT.DMT_FORENAME2, PER2.PER_FORENAME) DMT_FORENAME2
       , nvl(DMT.DMT_ACTIVITY2, PER2.PER_ACTIVITY) DMT_ACTIVITY2
       , nvl(DMT.DMT_CARE_OF2, ADR2.ADD_CARE_OF) DMT_CARE_OF2
       , nvl(DMT.DMT_PO_BOX2, ADR2.ADD_PO_BOX) DMT_PO_BOX2
       , nvl(DMT.DMT_PO_BOX_NBR2, ADR2.ADD_PO_BOX_NBR) DMT_PO_BOX_NBR2
       , nvl(DMT.DMT_COUNTY2, ADR2.ADD_COUNTY) DMT_COUNTY2
       , nvl(DMT.DMT_CONTACT2, PER2.PER_CONTACT) DMT_CONTACT2
       , nvl(DMT.DMT_NAME3, PER3.PER_NAME) DMT_NAME3
       , nvl(DMT.DMT_FORENAME3, PER3.PER_FORENAME) DMT_FORENAME3
       , nvl(DMT.DMT_ACTIVITY3, PER3.PER_ACTIVITY) DMT_ACTIVITY3
       , nvl(DMT.DMT_CARE_OF3, ADR3.ADD_CARE_OF) DMT_CARE_OF3
       , nvl(DMT.DMT_PO_BOX3, ADR3.ADD_PO_BOX) DMT_PO_BOX3
       , nvl(DMT.DMT_PO_BOX_NBR3, ADR3.ADD_PO_BOX_NBR) DMT_PO_BOX_NBR3
       , nvl(DMT.DMT_COUNTY3, ADR3.ADD_COUNTY) DMT_COUNTY3
       , nvl(DMT.DMT_CONTACT3, PER3.PER_CONTACT) DMT_CONTACT3
       , DMT.DOC_RECORD_ID
    from PCS.PC_LANG LANG
       , ACS_FIN_ACC_S_PAYMENT AFA
       , ACS_PAYMENT_METHOD APM
       , DOC_RECORD REC
       , DOC_PAYMENT_DATE DPD
       , DOC_FOOT FOO
       , PAC_SENDING_CONDITION PSC
       , PAC_PAYMENT_CONDITION PMT
       , ACS_FINANCIAL_CURRENCY AFC
       , DOC_FREE_DATA DFD
       , DOC_GAUGE_SIGNATORY DGS
       , DOC_GAUGE_SIGNATORY DGS2
       , PAC_CUSTOM_PARTNER CUS
       , ACS_ACCOUNT ACCC
       , PAC_ADDRESS ADR
       , PAC_ADDRESS ADR2
       , PAC_ADDRESS ADR3
       , PAC_REPRESENTATIVE REP
       , PAC_ADDRESS ADR_SEN
       , PAC_PERSON PER_SEN
       , PAC_PERSON PER
       , PAC_PERSON PER2
       , PAC_PERSON PER3
       , PAC_SUPPLIER_PARTNER SUP
       , ACS_ACCOUNT ACCS
       , PAC_THIRD THI
       , PCS.PC_CURR CUR
       , PCS.PC_CNTRY CNT
       , PCS.PC_CNTRY CNT2
       , PCS.PC_CNTRY CNT3
       , DOC_GAUGE GAU
       , DOC_GAUGE_STRUCTURED GST
       , DOC_DOCUMENT DMT
       , PAC_SALE_TERRITORY STE
       , PAC_DISTRIBUTION_CHANNEL PDC
   where DMT.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
     and GAU.DOC_GAUGE_ID = GST.DOC_GAUGE_ID
     and DMT.PC_LANG_ID = LANG.PC_LANG_ID
     and FOO.DOC_FOOT_ID = DPD.DOC_FOOT_ID(+)
     and DMT.ACS_FIN_ACC_S_PAYMENT_ID = AFA.ACS_FIN_ACC_S_PAYMENT_ID(+)
     and AFA.ACS_PAYMENT_METHOD_ID = APM.ACS_PAYMENT_METHOD_ID(+)
     and DMT.PAC_REPRESENTATIVE_ID = REP.PAC_REPRESENTATIVE_ID(+)
     and DMT.DOC_DOCUMENT_ID = DFD.DOC_DOCUMENT_ID(+)
     and DMT.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID(+)
     and FOO.DOC_GAUGE_SIGNATORY_ID = DGS.DOC_GAUGE_SIGNATORY_ID(+)
     and FOO.DOC_DOC_GAUGE_SIGNATORY_ID = DGS2.DOC_GAUGE_SIGNATORY_ID(+)
     and DMT.DOC_RECORD_ID = REC.DOC_RECORD_ID(+)
     and DMT.PAC_SENDING_CONDITION_ID = PSC.PAC_SENDING_CONDITION_ID(+)
     and PSC.PAC_ADDRESS_ID = ADR_SEN.PAC_ADDRESS_ID(+)
     and ADR_SEN.PAC_PERSON_ID = PER_SEN.PAC_PERSON_ID(+)
     and DMT.PAC_THIRD_ID = THI.PAC_THIRD_ID(+)
     and DMT.PAC_THIRD_ID = CUS.PAC_CUSTOM_PARTNER_ID(+)
     and CUS.ACS_AUXILIARY_ACCOUNT_ID = ACCC.ACS_ACCOUNT_ID(+)
     and SUP.ACS_AUXILIARY_ACCOUNT_ID = ACCS.ACS_ACCOUNT_ID(+)
     and DMT.PAC_THIRD_ID = SUP.PAC_SUPPLIER_PARTNER_ID(+)
     and DMT.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID(+)
     and ADR.PAC_PERSON_ID = PER.PAC_PERSON_ID(+)
     and DMT.PAC_PAC_ADDRESS_ID = ADR2.PAC_ADDRESS_ID(+)
     and ADR2.PAC_PERSON_ID = PER2.PAC_PERSON_ID(+)
     and DMT.PAC2_PAC_ADDRESS_ID = ADR3.PAC_ADDRESS_ID(+)
     and ADR3.PAC_PERSON_ID = PER3.PAC_PERSON_ID(+)
     and DMT.PC_CNTRY_ID = CNT.PC_CNTRY_ID(+)
     and DMT.PC__PC_CNTRY_ID = CNT2.PC_CNTRY_ID(+)
     and DMT.PC_2_PC_CNTRY_ID = CNT3.PC_CNTRY_ID(+)
     and DMT.ACS_FINANCIAL_CURRENCY_ID = AFC.ACS_FINANCIAL_CURRENCY_ID(+)
     and AFC.PC_CURR_ID = CUR.PC_CURR_ID(+)
     and DMT.PAC_PAYMENT_CONDITION_ID = PMT.PAC_PAYMENT_CONDITION_ID(+)
     and DMT.PAC_SALE_TERRITORY_ID = STE.PAC_SALE_TERRITORY_ID(+)
     and DMT.PAC_DISTRIBUTION_CHANNEL_ID = PDC.PAC_DISTRIBUTION_CHANNEL_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_HEADER_4_PRNT_NOENV" ("DOC_DOCUMENT_ID", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_VALUE", "DMT_DATE_FALLING_DUE", "DMT_DATE_DELIVERY", "C_DOCUMENT_STATUS", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_DATE_PARTNER_DOCUMENT", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DIC_DOC_FREE_1_ID", "DIC_DOC_FREE_2_ID", "DIC_DOC_FREE_3_ID", "DIC_TYPE_SUBMISSION_ID", "DOC_DIC_POS_FREE_TABLE_1_ID", "DOC_DIC_POS_FREE_TABLE_2_ID", "DOC_DIC_POS_FREE_TABLE_3_ID", "DMT_DECIMAL_1", "DMT_DECIMAL_2", "DMT_DECIMAL_3", "DMT_TEXT_1", "DMT_TEXT_2", "DMT_TEXT_3", "DMT_DATE_1", "DMT_DATE_2", "DMT_DATE_3", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "DMT_GAU_FREE_NUMBER1", "DMT_GAU_FREE_NUMBER2", "DMT_GAU_FREE_DATE1", "DMT_GAU_FREE_DATE2", "DMT_GAU_FREE_TEXT_LONG", "DMT_GAU_FREE_TEXT_SHORT", "DMT_GAU_FREE_BOOL1", "DMT_GAU_FREE_BOOL2", "DIC_TARIFF_ID", "C_INCOTERMS", "DMT_INCOTERMS_PLACE", "PAC_REPRESENTATIVE_ID", "REP_DESCR", "DIC_ACCOUNTABLE_GROUP_ID", "RCO_TITLE", "RCO_DESCRIPTION", "PAC_THIRD_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_INTRA", "THI_NO_TVA", "THI_NO_SIREN", "THI_NO_SIRET", "THI_NO_FORMAT", "C_DELIVERY_TYP", "CUS_SUPPLIER_NUMBER", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "DIC_TYPE_PARTNER_ID", "CRE_CUSTOMER_NUMBER", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "DIC_TYPE_PARTNER_F_ID", "PAC_SENDING_CONDITION_ID", "SEN_DESCR", "SENDING_ADDRESS_ID", "SEN_PER_NAME", "SEN_PER_FORENAME", "SEN_PER_ACTIVITY", "SEN_PER_COMMENT", "SEN_PER_KEY1", "SEN_PER_KEY2", "SEN_ADD_ADDRESS1", "SEN_ADD_FORMAT", "ACS_PAYMENT_METHOD_ID", "PAY_METH_DESCR", "CUSTOMER_ACCOUNT", "SUPPLIER_ACCOUNT", "PC_LANG_ID", "PAC_PAYMENT_CONDITION_ID", "PCO_DESCR", "PMT_PC_APPLTXT_ID", "COND_DESCR", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "CURRNAME", "LANID", "ADDRESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "CNTID", "CNTNAME", "DIC_PC_CNTRY_GRP_ID", "CNT_CE_CODE", "CNT_CE_MEMBER", "ADDRESS2_ID", "PER2_NAME", "PER2_FORENAME", "PER2_ACTIVITY", "PER2_COMMENT", "PER2_KEY1", "PER2_KEY2", "DMT_ADDRESS2", "DMT_FORMAT_CITY2", "CNTID2", "CNTNAME2", "DIC_PC_CNTRY_GRP_ID2", "CNT_CE_CODE2", "CNT_CE_MEMBER2", "ADDRESS3_ID", "PER3_NAME", "PER3_FORENAME", "PER3_ACTIVITY", "PER3_COMMENT", "PER3_KEY1", "PER3_KEY2", "DMT_ADDRESS3", "DMT_FORMAT_CITY3", "CNTID3", "CNTNAME3", "DIC_PC_CNTRY_GRP_ID3", "CNT_CE_CODE3", "CNT_CE_MEMBER3", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "C_ADMIN_DOMAIN", "DIC_DOC_FREE_TABLE_1_ID", "DIC_DOC_FREE_TABLE_2_ID", "DIC_DOC_FREE_TABLE_3_ID", "DIC_DOC_FREE_TABLE_4_ID", "DIC_DOC_FREE_TABLE_5_ID", "FRD_ALPHA_SHORT_1", "FRD_ALPHA_SHORT_2", "FRD_ALPHA_SHORT_3", "FRD_ALPHA_SHORT_4", "FRD_ALPHA_SHORT_5", "FRD_ALPHA_LONG_1", "FRD_ALPHA_LONG_2", "FRD_ALPHA_LONG_3", "FRD_ALPHA_LONG_4", "FRD_ALPHA_LONG_5", "FRD_INTEGER_1", "FRD_INTEGER_2", "FRD_INTEGER_3", "FRD_INTEGER_4", "FRD_INTEGER_5", "FRD_DECIMAL_1", "FRD_DECIMAL_2", "FRD_DECIMAL_3", "FRD_DECIMAL_4", "FRD_DECIMAL_5", "FRD_BOOLEAN_1", "FRD_BOOLEAN_2", "FRD_BOOLEAN_3", "FRD_BOOLEAN_4", "FRD_BOOLEAN_5", "DOC_FOOT_ID", "DOC_GAUGE_SIGNATORY_ID", "GAG_NAME", "GAG_FUNCTION", "DOC_DOC_GAUGE_SIGNATORY_ID", "GAG2_NAME", "GAG2_FUNCTION", "FOO_FOOT_TEXT", "FOO_FOOT_TEXT2", "FOO_FOOT_TEXT3", "FOO_FOOT_TEXT4", "FOO_FOOT_TEXT5", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT", "FOO_TOTAL_VAT_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "FOO_REF_BVR_NUMBER", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_PAID_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "DIC_TYPE_DOC_CUSTOM_ID", "C_DIRECTION_NUMBER", "FOO_TOT_VAT_AMOUNT_V", "FOO_RECEIVED_AMOUNT", "FOO_PAID_BALANCED_AMOUNT", "PAD_PAYMENT_DATE", "PAD_BAND_NUMBER", "PAD_DATE_AMOUNT", "PAD_DISCOUNT_AMOUNT", "PAD_NET_DATE_AMOUNT", "PAD_BVR_REFERENCE_NUM", "PAD_BVR_CODING_LINE") AS
  SELECT
        DMT.DOC_DOCUMENT_ID,
        DMT.DMT_NUMBER DMT_NUMBER,
        DMT.DMT_DATE_DOCUMENT,
        DMT.DMT_DATE_VALUE,
        DMT.DMT_DATE_FALLING_DUE,
        DMT.DMT_DATE_DELIVERY,
        DMT.C_DOCUMENT_STATUS,
        DMT.DMT_PARTNER_NUMBER,
        DMT.DMT_PARTNER_REFERENCE,
        DMT.DMT_DATE_PARTNER_DOCUMENT,
        DMT.DMT_REFERENCE,
        DMT.DMT_TITLE_TEXT,
        DMT.DMT_HEADING_TEXT,
        DMT.DMT_DOCUMENT_TEXT,
        DMT.DIC_DOC_FREE_1_ID,
        DMT.DIC_DOC_FREE_2_ID,
        DMT.DIC_DOC_FREE_3_ID,
        DMT.DIC_TYPE_SUBMISSION_ID,
        DMT.DIC_POS_FREE_TABLE_1_ID DOC_DIC_POS_FREE_TABLE_1_ID,
        DMT.DIC_POS_FREE_TABLE_2_ID DOC_DIC_POS_FREE_TABLE_2_ID,
        DMT.DIC_POS_FREE_TABLE_3_ID DOC_DIC_POS_FREE_TABLE_3_ID,
        DMT.DMT_DECIMAL_1,
        DMT.DMT_DECIMAL_2,
        DMT.DMT_DECIMAL_3,
        DMT.DMT_TEXT_1,
        DMT.DMT_TEXT_2,
        DMT.DMT_TEXT_3,
        DMT.DMT_DATE_1,
        DMT.DMT_DATE_2,
        DMT.DMT_DATE_3,
        DMT.DIC_GAUGE_FREE_CODE_1_ID,
        DMT.DIC_GAUGE_FREE_CODE_2_ID,
        DMT.DIC_GAUGE_FREE_CODE_3_ID,
        DMT.DMT_GAU_FREE_NUMBER1,
        DMT.DMT_GAU_FREE_NUMBER2,
        DMT.DMT_GAU_FREE_DATE1,
        DMT.DMT_GAU_FREE_DATE2,
        DMT.DMT_GAU_FREE_TEXT_LONG,
        DMT.DMT_GAU_FREE_TEXT_SHORT,
        DMT.DMT_GAU_FREE_BOOL1,
        DMT.DMT_GAU_FREE_BOOL2,
        DMT.DIC_TARIFF_ID,
        DMT.C_INCOTERMS,
        DMT.DMT_INCOTERMS_PLACE,
        REP.PAC_REPRESENTATIVE_ID,
        REP.REP_DESCR,
        REC.DIC_ACCOUNTABLE_GROUP_ID,
        REC.RCO_TITLE,
        REC.RCO_DESCRIPTION,
        DMT.PAC_THIRD_ID,
        THI.DIC_THIRD_ACTIVITY_ID,
        THI.DIC_THIRD_AREA_ID,
        THI.THI_NO_INTRA,
        THI.THI_NO_TVA,
        THI.THI_NO_SIREN,
        THI.THI_NO_SIRET,
        THI.THI_NO_FORMAT,
        CUS.C_DELIVERY_TYP,
        CUS.CUS_SUPPLIER_NUMBER,
        CUS.CUS_FREE_ZONE1,
        CUS.CUS_FREE_ZONE2,
        CUS.CUS_FREE_ZONE3,
        CUS.CUS_FREE_ZONE4,
        CUS.CUS_FREE_ZONE5,
        CUS.DIC_STATISTIC_1_ID,
        CUS.DIC_STATISTIC_2_ID,
        CUS.DIC_STATISTIC_3_ID,
        CUS.DIC_STATISTIC_4_ID,
        CUS.DIC_STATISTIC_5_ID,
        CUS.DIC_TYPE_PARTNER_ID,
        SUP.CRE_CUSTOMER_NUMBER,
        SUP.CRE_FREE_ZONE1,
        SUP.CRE_FREE_ZONE2,
        SUP.CRE_FREE_ZONE3,
        SUP.CRE_FREE_ZONE4,
        SUP.CRE_FREE_ZONE5,
        SUP.DIC_STATISTIC_F1_ID,
        SUP.DIC_STATISTIC_F2_ID,
        SUP.DIC_STATISTIC_F3_ID,
        SUP.DIC_STATISTIC_F4_ID,
        SUP.DIC_STATISTIC_F5_ID,
        SUP.DIC_TYPE_PARTNER_F_ID,
        PSC.PAC_SENDING_CONDITION_ID,
        PAC_FUNCTIONS.GetSendCondDescr(PSC.PAC_SENDING_CONDITION_ID, DMT.PC_LANG_ID) SEN_DESCR,
        PSC.PAC_ADDRESS_ID SENDING_ADDRESS_ID,
        PER_SEN.PER_NAME SEN_PER_NAME,
        PER_SEN.PER_FORENAME SEN_PER_FORENAME,
        PER_SEN.PER_ACTIVITY SEN_PER_ACTIVITY,
        PER_SEN.PER_COMMENT SEN_PER_COMMENT,
        PER_SEN.PER_KEY1 SEN_PER_KEY1,
        PER_SEN.PER_KEY2 SEN_PER_KEY2,
        ADR_SEN.ADD_ADDRESS1 SEN_ADD_ADDRESS1,
        ADR_SEN.ADD_FORMAT SEN_ADD_FORMAT,
        APM.ACS_PAYMENT_METHOD_ID,
        ACS_FUNCTION.GetPayMethDescr(APM.ACS_PAYMENT_METHOD_ID, DMT.PC_LANG_ID) PAY_METH_DESCR,
        ACCC.ACC_NUMBER CUSTOMER_ACCOUNT,
        ACCS.ACC_NUMBER SUPPLIER_ACCOUNT,
        DMT.PC_LANG_ID,
        PMT.PAC_PAYMENT_CONDITION_ID,
        PMT.PCO_DESCR,
        PMT.PC_APPLTXT_ID PMT_PC_APPLTXT_ID,
        PCS.PC_FUNCTIONS.GetAppltxtDescr(PMT.PC_APPLTXT_ID, DMT.PC_LANG_ID) COND_DESCR,
        AFC.ACS_FINANCIAL_CURRENCY_ID,
        CUR.CURRENCY,
        CUR.CURRNAME,
        LANG.LANID,
        DMT.PAC_ADDRESS_ID ADDRESS_ID,
        PER.PER_NAME,
        PER.PER_FORENAME,
        PER.PER_ACTIVITY,
        PER.PER_COMMENT,
        PER.PER_KEY1,
        PER.PER_KEY2,
        DMT.DMT_ADDRESS1,
        DMT.DMT_FORMAT_CITY1,
        CNT.CNTID,
        CNT.CNTNAME,
        CNT.DIC_PC_CNTRY_GRP_ID,
        CNT.CNT_CE_CODE,
        CNT.CNT_CE_MEMBER,
        DMT.PAC_PAC_ADDRESS_ID ADDRESS2_ID,
        PER2.PER_NAME PER2_NAME,
        PER2.PER_FORENAME PER2_FORENAME,
        PER2.PER_ACTIVITY PER2_ACTIVITY,
        PER2.PER_COMMENT PER2_COMMENT,
        PER2.PER_KEY1 PER2_KEY1,
        PER2.PER_KEY2 PER2_KEY2,
        DMT.DMT_ADDRESS2,
        DMT.DMT_FORMAT_CITY2,
        CNT2.CNTID CNTID2,
        CNT2.CNTNAME CNTNAME2,
        CNT2.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID2,
        CNT2.CNT_CE_CODE CNT_CE_CODE2,
        CNT2.CNT_CE_MEMBER CNT_CE_MEMBER2,
        DMT.PAC2_PAC_ADDRESS_ID ADDRESS3_ID,
        PER3.PER_NAME PER3_NAME,
        PER3.PER_FORENAME PER3_FORENAME,
        PER3.PER_ACTIVITY PER3_ACTIVITY,
        PER3.PER_COMMENT PER3_COMMENT,
        PER3.PER_KEY1 PER3_KEY1,
        PER3.PER_KEY2 PER3_KEY2,
        DMT.DMT_ADDRESS3,
        DMT.DMT_FORMAT_CITY3,
        CNT3.CNTID CNTID3,
        CNT3.CNTNAME CNTNAME3,
        CNT3.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID3,
        CNT3.CNT_CE_CODE CNT_CE_CODE3,
        CNT3.CNT_CE_MEMBER CNT_CE_MEMBER3,
        GAU.C_GAUGE_TYPE,
        GST.C_GAUGE_TITLE,
        GAU.C_ADMIN_DOMAIN,
        DFD.DIC_DOC_FREE_TABLE_1_ID,
        DFD.DIC_DOC_FREE_TABLE_2_ID,
        DFD.DIC_DOC_FREE_TABLE_3_ID,
        DFD.DIC_DOC_FREE_TABLE_4_ID,
        DFD.DIC_DOC_FREE_TABLE_5_ID,
        DFD.FRD_ALPHA_SHORT_1,
        DFD.FRD_ALPHA_SHORT_2,
        DFD.FRD_ALPHA_SHORT_3,
        DFD.FRD_ALPHA_SHORT_4,
        DFD.FRD_ALPHA_SHORT_5,
        DFD.FRD_ALPHA_LONG_1,
        DFD.FRD_ALPHA_LONG_2,
        DFD.FRD_ALPHA_LONG_3,
        DFD.FRD_ALPHA_LONG_4,
        DFD.FRD_ALPHA_LONG_5,
        DFD.FRD_INTEGER_1,
        DFD.FRD_INTEGER_2,
        DFD.FRD_INTEGER_3,
        DFD.FRD_INTEGER_4,
        DFD.FRD_INTEGER_5,
        DFD.FRD_DECIMAL_1,
        DFD.FRD_DECIMAL_2,
        DFD.FRD_DECIMAL_3,
        DFD.FRD_DECIMAL_4,
        DFD.FRD_DECIMAL_5,
        DFD.FRD_BOOLEAN_1,
        DFD.FRD_BOOLEAN_2,
        DFD.FRD_BOOLEAN_3,
        DFD.FRD_BOOLEAN_4,
        DFD.FRD_BOOLEAN_5,
        FOO.DOC_FOOT_ID,
        FOO.DOC_GAUGE_SIGNATORY_ID,
        DGS.GAG_NAME,
        DGS.GAG_FUNCTION,
        FOO.DOC_DOC_GAUGE_SIGNATORY_ID,
        DGS2.GAG_NAME GAG2_NAME,
        DGS2.GAG_FUNCTION GAG2_FUNCTION,
        FOO.FOO_FOOT_TEXT,
        FOO.FOO_FOOT_TEXT2,
        FOO.FOO_FOOT_TEXT3,
        FOO.FOO_FOOT_TEXT4,
        FOO.FOO_FOOT_TEXT5,
        FOO.FOO_DOCUMENT_TOTAL_AMOUNT,
        FOO.FOO_GOOD_TOTAL_AMOUNT,
        FOO.FOO_TOTAL_VAT_AMOUNT,
        FOO.FOO_CHARGE_TOTAL_AMOUNT,
        FOO.FOO_DISCOUNT_TOTAL_AMOUNT,
        FOO.FOO_COST_TOTAL_AMOUNT,
        FOO.FOO_GOOD_TOT_AMOUNT_EXCL,
        FOO.FOO_CHARG_TOT_AMOUNT_EXCL,
        FOO.FOO_DISC_TOT_AMOUNT_EXCL,
        FOO.FOO_COST_TOT_AMOUNT_EXCL,
        FOO.FOO_TOTAL_NET_WEIGHT,
        FOO.FOO_TOTAL_GROSS_WEIGHT,
        FOO.FOO_TOTAL_NET_WEIGHT_MEAS,
        FOO.FOO_TOTAL_GROSS_WEIGHT_MEAS,
        FOO.FOO_TOTAL_BASIS_QUANTITY,
        FOO.FOO_TOTAL_INTERM_QUANTITY,
        FOO.FOO_TOTAL_FINAL_QUANTITY,
        FOO.C_BVR_GENERATION_METHOD,
        FOO.FOO_GENERATE_BVR_NUMBER,
        FOO.FOO_REF_BVR_NUMBER,
        FOO.FOO_DOCUMENT_TOT_AMOUNT_B,
        FOO.FOO_DOCUMENT_TOT_AMOUNT_E,
        FOO.FOO_PAID_AMOUNT,
        FOO.FOO_RETURN_AMOUNT,
        FOO.FOO_PACKAGING,
        FOO.FOO_MARKING,
        FOO.FOO_MEASURE,
        FOO.DIC_TYPE_DOC_CUSTOM_ID,
        FOO.C_DIRECTION_NUMBER,
        FOO.FOO_TOT_VAT_AMOUNT_V,
        FOO.FOO_RECEIVED_AMOUNT,
        FOO.FOO_PAID_BALANCED_AMOUNT,
        DPD.PAD_PAYMENT_DATE,
        DPD.PAD_BAND_NUMBER,
        DPD.PAD_DATE_AMOUNT,
        DPD.PAD_DISCOUNT_AMOUNT,
        DPD.PAD_NET_DATE_AMOUNT,
        DPD.PAD_BVR_REFERENCE_NUM,
        DPD.PAD_BVR_CODING_LINE
FROM
        PCS.PC_LANG LANG,
        ACS_FIN_ACC_S_PAYMENT AFA,
        ACS_PAYMENT_METHOD APM,
        DOC_RECORD REC,
        DOC_PAYMENT_DATE DPD,
        DOC_FOOT FOO,
        PAC_SENDING_CONDITION PSC,
        PAC_PAYMENT_CONDITION PMT,
        ACS_FINANCIAL_CURRENCY AFC,
        DOC_FREE_DATA DFD,
        DOC_GAUGE_SIGNATORY DGS,
        DOC_GAUGE_SIGNATORY DGS2,
        PAC_CUSTOM_PARTNER CUS,
        ACS_ACCOUNT ACCC,
        PAC_ADDRESS ADR,
        PAC_ADDRESS ADR2,
        PAC_ADDRESS ADR3,
        PAC_REPRESENTATIVE REP,
        PAC_ADDRESS ADR_SEN,
        PAC_PERSON PER_SEN,
        PAC_PERSON PER,
        PAC_PERSON PER2,
        PAC_PERSON PER3,
        PAC_SUPPLIER_PARTNER SUP,
        ACS_ACCOUNT ACCS,
        PAC_THIRD THI,
        PCS.PC_CURR CUR,
        PCS.PC_CNTRY CNT,
        PCS.PC_CNTRY CNT2,
        PCS.PC_CNTRY CNT3,
        DOC_GAUGE GAU,
        DOC_GAUGE_STRUCTURED GST,
        DOC_DOCUMENT DMT
WHERE
        DMT.DOC_GAUGE_ID=GAU.DOC_GAUGE_ID AND
        GAU.DOC_GAUGE_ID=GST.DOC_GAUGE_ID AND
        DMT.PC_LANG_ID=LANG.PC_LANG_ID AND
        FOO.DOC_FOOT_ID=DPD.DOC_FOOT_ID (+) AND
        DMT.ACS_FIN_ACC_S_PAYMENT_ID=AFA.ACS_FIN_ACC_S_PAYMENT_ID (+) AND
        AFA.ACS_PAYMENT_METHOD_ID=APM.ACS_PAYMENT_METHOD_ID (+) AND
        DMT.PAC_REPRESENTATIVE_ID=REP.PAC_REPRESENTATIVE_ID(+) AND
        DMT.DOC_DOCUMENT_ID=DFD.DOC_DOCUMENT_ID (+) AND
        DMT.DOC_DOCUMENT_ID=FOO.DOC_DOCUMENT_ID(+) AND
        FOO.DOC_GAUGE_SIGNATORY_ID=DGS.DOC_GAUGE_SIGNATORY_ID (+) AND
        FOO.DOC_DOC_GAUGE_SIGNATORY_ID=DGS2.DOC_GAUGE_SIGNATORY_ID (+) AND
        DMT.DOC_RECORD_ID=REC.DOC_RECORD_ID(+) AND
        DMT.PAC_SENDING_CONDITION_ID=PSC.PAC_SENDING_CONDITION_ID (+) AND
        PSC.PAC_ADDRESS_ID=ADR_SEN.PAC_ADDRESS_ID (+) AND
        ADR_SEN.PAC_PERSON_ID = PER_SEN.PAC_PERSON_ID (+) AND
        DMT.PAC_THIRD_ID=THI.PAC_THIRD_ID(+) AND
        DMT.PAC_THIRD_ID=CUS.PAC_CUSTOM_PARTNER_ID (+) AND
        CUS.ACS_AUXILIARY_ACCOUNT_ID=ACCC.ACS_ACCOUNT_ID(+) AND
        SUP.ACS_AUXILIARY_ACCOUNT_ID=ACCS.ACS_ACCOUNT_ID(+) AND
        DMT.PAC_THIRD_ID=SUP.PAC_SUPPLIER_PARTNER_ID (+) AND
        DMT.PAC_ADDRESS_ID=ADR.PAC_ADDRESS_ID(+) AND
        ADR.PAC_PERSON_ID=PER.PAC_PERSON_ID(+) AND
        DMT.PAC_PAC_ADDRESS_ID=ADR2.PAC_ADDRESS_ID(+) AND
        ADR2.PAC_PERSON_ID=PER2.PAC_PERSON_ID (+) AND
        DMT.PAC2_PAC_ADDRESS_ID=ADR3.PAC_ADDRESS_ID (+) AND
        ADR3.PAC_PERSON_ID=PER3.PAC_PERSON_ID (+) AND
        DMT.PC_CNTRY_ID=CNT.PC_CNTRY_ID (+) AND
        DMT.PC__PC_CNTRY_ID=CNT2.PC_CNTRY_ID (+) AND
        DMT.PC_2_PC_CNTRY_ID=CNT3.PC_CNTRY_ID (+) AND
        DMT.ACS_FINANCIAL_CURRENCY_ID=AFC.ACS_FINANCIAL_CURRENCY_ID (+) AND
        AFC.PC_CURR_ID=CUR.PC_CURR_ID (+) AND
        DMT.PAC_PAYMENT_CONDITION_ID=PMT.PAC_PAYMENT_CONDITION_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_INTERFACE_NOENV" ("DOC_DOCUMENT_ID", "PAC_THIRD_ID", "DIC_GAUGE_TYPE_DOC_ID", "DMT_NUMBER", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_REFERENCE", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DMT_DATE_DOCUMENT", "DMT_DATE_PARTNER_DOCUMENT", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "DOC_FOOT_ID", "FOO_FOOT_TEXT", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_B", "FOO_GOOD_TOT_AMOUNT_EX_E", "FOO_GOOD_TOT_AMOUNT_EX_B", "FOO_TOTAL_VAT_AMOUNT", "FOO_TOT_VAT_AMOUNT_E", "FOO_TOT_VAT_AMOUNT_B", "FOO_TOT_VAT_AMOUNT_V", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_CHARGE_TOT_AMOUNT_E", "FOO_CHARGE_TOT_AMOUNT_B", "FOO_CHARG_TOT_AMOUNT_EX_E", "FOO_CHARG_TOT_AMOUNT_EX_B", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_DISCOUNT_TOT_AMOUNT_E", "FOO_DISCOUNT_TOT_AMOUNT_B", "FOO_DISC_TOT_AMOUNT_EX_E", "FOO_DISC_TOT_AMOUNT_EX_B", "FOO_COST_TOTAL_AMOUNT", "FOO_COST_TOT_AMOUNT_E", "FOO_COST_TOT_AMOUNT_B", "FOO_COST_TOT_AMOUNT_EX_E", "FOO_COST_TOT_AMOUNT_EX_B", "FOO_DOC_TOT_AMT_COR_B", "DOC_POSITION_COR_ID", "FOO_PAID_AMOUNT", "FOO_PAID_AMOUNT_EUR", "FOO_PAID_AMOUNT_B", "FOO_PAID_BALANCED_AMOUNT", "FOO_RECEIVED_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "FOO_MODIFY_RATE", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "PCO_DESCR", "C_TEXT_TYPE", "DIC_PC_THEME_ID", "APH_CODE", "DOC_POSITION_ID", "GCO_GOOD_ID", "POS_NUMBER", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "DIC_UNIT_OF_MEASURE_ID", "POS_GENERATE_MOVEMENT", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_VAT_AMOUNT_E", "POS_VAT_AMOUNT_V", "POS_GROSS_UNIT_VALUE", "POS_GROSS_UNIT_VALUE2", "POS_GROSS_UNIT_VALUE_INCL", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_GROSS_VALUE", "POS_GROSS_VALUE_E", "POS_GROSS_VALUE_B", "POS_GROSS_VALUE_V", "POS_GROSS_VALUE_INCL", "POS_GROSS_VALUE_INCL_E", "POS_GROSS_VALUE_INCL_B", "POS_GROSS_VALUE_INCL_V", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_E", "POS_NET_VALUE_EXCL_B", "POS_NET_VALUE_EXCL_V", "POS_NET_VALUE_INCL", "POS_NET_VALUE_INCL_E", "POS_NET_VALUE_INCL_B", "POS_NET_VALUE_INCL_V", "POS_BASIS_QUANTITY", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY", "POS_FINAL_QUANTITY_SU", "POS_BALANCE_QUANTITY", "POS_VALUE_QUANTITY", "POS_BALANCE_QTY_VALUE", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "POS_REF_UNIT_VALUE", "POS_RATE_FACTOR", "POS_STOCK_OUTAGE", "POS_UNIT_COST_PRICE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "PAC_REPRESENTATIVE_ID", "POS_MODIFY_RATE", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "C_POS_DELIVERY_TYP", "POS_BALANCED", "POS_IMF_TEXT_1", "POS_IMF_TEXT_2", "POS_IMF_TEXT_3", "POS_IMF_TEXT_4", "POS_IMF_TEXT_5", "POS_IMF_NUMBER_2", "POS_IMF_NUMBER_3", "POS_IMF_NUMBER_4", "POS_IMF_NUMBER_5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "POS_PARTNER_NUMBER", "POS_PARTNER_REFERENCE", "POS_DATE_PARTNER_DOCUMENT", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "CURRENCY", "GAG_FUNCTION1", "GAG_NAME1", "GAG_NAME2", "GAG_FUNCTION2", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "TAX_RATE", "LANID", "REP_DESCR", "SEN_DESCR") AS
  select DOC_DOCUMENT.DOC_DOCUMENT_ID
       , DOC_DOCUMENT.PAC_THIRD_ID
       , DOC_GAUGE.DIC_GAUGE_TYPE_DOC_ID
       , DOC_DOCUMENT.DMT_NUMBER
       , DOC_DOCUMENT.DMT_PARTNER_NUMBER
       , DOC_DOCUMENT.DMT_PARTNER_REFERENCE
       , DOC_DOCUMENT.DMT_REFERENCE
       , DOC_DOCUMENT.DMT_HEADING_TEXT
       , DOC_DOCUMENT.DMT_DOCUMENT_TEXT
       , DOC_DOCUMENT.DMT_DATE_DOCUMENT
       , DOC_DOCUMENT.DMT_DATE_PARTNER_DOCUMENT
       , DOC_DOCUMENT.DMT_ADDRESS1
       , DOC_DOCUMENT.DMT_FORMAT_CITY1
       , DOC_FOOT.DOC_FOOT_ID
       , DOC_FOOT.FOO_FOOT_TEXT
       , DOC_FOOT.FOO_DOCUMENT_TOTAL_AMOUNT
       , DOC_FOOT.FOO_DOCUMENT_TOT_AMOUNT_E
       , DOC_FOOT.FOO_DOCUMENT_TOT_AMOUNT_B
       , DOC_FOOT.FOO_GOOD_TOTAL_AMOUNT
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_E
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_B
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_GOOD_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_TOTAL_VAT_AMOUNT
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_E
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_B
       , DOC_FOOT.FOO_TOT_VAT_AMOUNT_V
       , DOC_FOOT.FOO_CHARGE_TOTAL_AMOUNT
       , DOC_FOOT.FOO_CHARGE_TOT_AMOUNT_E
       , DOC_FOOT.FOO_CHARGE_TOT_AMOUNT_B
       , DOC_FOOT.FOO_CHARG_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_CHARG_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_DISCOUNT_TOTAL_AMOUNT
       , DOC_FOOT.FOO_DISCOUNT_TOT_AMOUNT_E
       , DOC_FOOT.FOO_DISCOUNT_TOT_AMOUNT_B
       , DOC_FOOT.FOO_DISC_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_DISC_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_COST_TOTAL_AMOUNT
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_E
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_B
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_EX_E
       , DOC_FOOT.FOO_COST_TOT_AMOUNT_EX_B
       , DOC_FOOT.FOO_DOC_TOT_AMT_COR_B
       , DOC_FOOT.DOC_POSITION_ID DOC_POSITION_COR_ID
       , DOC_FOOT.FOO_PAID_AMOUNT
       , DOC_FOOT.FOO_PAID_AMOUNT_EUR
       , DOC_FOOT.FOO_PAID_AMOUNT_B
       , DOC_FOOT.FOO_PAID_BALANCED_AMOUNT
       , DOC_FOOT.FOO_RECEIVED_AMOUNT
       , DOC_FOOT.FOO_RETURN_AMOUNT
       , DOC_FOOT.FOO_PACKAGING
       , DOC_FOOT.FOO_MARKING
       , DOC_FOOT.FOO_MEASURE
       , DOC_FOOT.FOO_MODIFY_RATE
       , DOC_FOOT.FOO_TOTAL_NET_WEIGHT_MEAS
       , DOC_FOOT.FOO_TOTAL_GROSS_WEIGHT_MEAS
       , PAC_PAYMENT_CONDITION.PCO_DESCR
       , PC_APPLTXT.C_TEXT_TYPE
       , PC_APPLTXT.DIC_PC_THEME_ID
       , PC_APPLTXT.APH_CODE
       , DOC_POSITION.DOC_POSITION_ID
       , DOC_POSITION.GCO_GOOD_ID
       , DOC_POSITION.POS_NUMBER
       , DOC_POSITION.POS_REFERENCE
       , DOC_POSITION.POS_SHORT_DESCRIPTION
       , DOC_POSITION.POS_LONG_DESCRIPTION
       , DOC_POSITION.POS_FREE_DESCRIPTION
       , DOC_POSITION.POS_BODY_TEXT
       , DOC_POSITION.DIC_UNIT_OF_MEASURE_ID
       , DOC_POSITION.POS_GENERATE_MOVEMENT
       , DOC_POSITION.POS_DISCOUNT_AMOUNT
       , DOC_POSITION.POS_CHARGE_AMOUNT
       , DOC_POSITION.POS_VAT_AMOUNT
       , DOC_POSITION.POS_VAT_BASE_AMOUNT
       , DOC_POSITION.POS_VAT_AMOUNT_E
       , DOC_POSITION.POS_VAT_AMOUNT_V
       , DOC_POSITION.POS_GROSS_UNIT_VALUE
       , DOC_POSITION.POS_GROSS_UNIT_VALUE2
       , DOC_POSITION.POS_GROSS_UNIT_VALUE_INCL
       , DOC_POSITION.POS_NET_UNIT_VALUE
       , DOC_POSITION.POS_NET_UNIT_VALUE_INCL
       , DOC_POSITION.POS_GROSS_VALUE
       , DOC_POSITION.POS_GROSS_VALUE_E
       , DOC_POSITION.POS_GROSS_VALUE_B
       , DOC_POSITION.POS_GROSS_VALUE_V
       , DOC_POSITION.POS_GROSS_VALUE_INCL
       , DOC_POSITION.POS_GROSS_VALUE_INCL_E
       , DOC_POSITION.POS_GROSS_VALUE_INCL_B
       , DOC_POSITION.POS_GROSS_VALUE_INCL_V
       , DOC_POSITION.POS_NET_VALUE_EXCL
       , DOC_POSITION.POS_NET_VALUE_EXCL_E
       , DOC_POSITION.POS_NET_VALUE_EXCL_B
       , DOC_POSITION.POS_NET_VALUE_EXCL_V
       , DOC_POSITION.POS_NET_VALUE_INCL
       , DOC_POSITION.POS_NET_VALUE_INCL_E
       , DOC_POSITION.POS_NET_VALUE_INCL_B
       , DOC_POSITION.POS_NET_VALUE_INCL_V
       , DOC_POSITION.POS_BASIS_QUANTITY
       , DOC_POSITION.POS_BASIS_QUANTITY_SU
       , DOC_POSITION.POS_INTERMEDIATE_QUANTITY
       , DOC_POSITION.POS_INTERMEDIATE_QUANTITY_SU
       , DOC_POSITION.POS_FINAL_QUANTITY
       , DOC_POSITION.POS_FINAL_QUANTITY_SU
       , DOC_POSITION.POS_BALANCE_QUANTITY
       , DOC_POSITION.POS_VALUE_QUANTITY
       , DOC_POSITION.POS_BALANCE_QTY_VALUE
       , DOC_POSITION.POS_NET_WEIGHT
       , DOC_POSITION.POS_GROSS_WEIGHT
       , DOC_POSITION.POS_REF_UNIT_VALUE
       , DOC_POSITION.POS_RATE_FACTOR
       , DOC_POSITION.POS_STOCK_OUTAGE
       , DOC_POSITION.POS_UNIT_COST_PRICE
       , DOC_POSITION.DIC_POS_FREE_TABLE_1_ID
       , DOC_POSITION.DIC_POS_FREE_TABLE_2_ID
       , DOC_POSITION.DIC_POS_FREE_TABLE_3_ID
       , DOC_POSITION.POS_DECIMAL_1
       , DOC_POSITION.POS_DECIMAL_2
       , DOC_POSITION.POS_DECIMAL_3
       , DOC_POSITION.POS_TEXT_1
       , DOC_POSITION.POS_TEXT_2
       , DOC_POSITION.POS_TEXT_3
       , DOC_POSITION.POS_DISCOUNT_UNIT_VALUE
       , DOC_POSITION.POS_DISCOUNT_RATE
       , DOC_POSITION.PAC_REPRESENTATIVE_ID
       , DOC_POSITION.POS_MODIFY_RATE
       , DOC_POSITION.POS_NET_TARIFF
       , DOC_POSITION.POS_SPECIAL_TARIFF
       , DOC_POSITION.POS_FLAT_RATE
       , DOC_POSITION.C_POS_DELIVERY_TYP
       , DOC_POSITION.POS_BALANCED
       , DOC_POSITION.POS_IMF_TEXT_1
       , DOC_POSITION.POS_IMF_TEXT_2
       , DOC_POSITION.POS_IMF_TEXT_3
       , DOC_POSITION.POS_IMF_TEXT_4
       , DOC_POSITION.POS_IMF_TEXT_5
       , DOC_POSITION.POS_IMF_NUMBER_2
       , DOC_POSITION.POS_IMF_NUMBER_3
       , DOC_POSITION.POS_IMF_NUMBER_4
       , DOC_POSITION.POS_IMF_NUMBER_5
       , DOC_POSITION.DIC_IMP_FREE1_ID
       , DOC_POSITION.DIC_IMP_FREE2_ID
       , DOC_POSITION.DIC_IMP_FREE3_ID
       , DOC_POSITION.DIC_IMP_FREE4_ID
       , DOC_POSITION.DIC_IMP_FREE5_ID
       , DOC_POSITION.POS_PARTNER_NUMBER
       , DOC_POSITION.POS_PARTNER_REFERENCE
       , DOC_POSITION.POS_DATE_PARTNER_DOCUMENT
       , DOC_POSITION.POS_DATE_1
       , DOC_POSITION.POS_DATE_2
       , DOC_POSITION.POS_DATE_3
       , PC_CURR.CURRENCY
       , DOC_GAUGE_SIGNATORY.GAG_FUNCTION GAG_FUNCTION1
       , DOC_GAUGE_SIGNATORY.GAG_NAME GAG_NAME1
       , DOC_DOC_GAUGE_SIGNATORY.GAG_NAME GAG_NAME2
       , DOC_DOC_GAUGE_SIGNATORY.GAG_FUNCTION GAG_FUNCTION2
       , PAC_PERSON.PER_NAME
       , PAC_PERSON.PER_FORENAME
       , PAC_PERSON.PER_ACTIVITY
       , ACS_TAX_CODE.TAX_RATE
       , PC_LANG.LANID
       , PAC_REPRESENTATIVE.REP_DESCR
       , PAC_SENDING_CONDITION_TEXT.SEN_DESCR
    from DOC_DOCUMENT DOC_DOCUMENT
       , DOC_FOOT DOC_FOOT
       , DOC_GAUGE DOC_GAUGE
       , PAC_ADDRESS PAC_ADDRESS
       , PAC_PAYMENT_CONDITION PAC_PAYMENT_CONDITION
       , PCS.PC_APPLTXT PC_APPLTXT
       , DOC_POSITION DOC_POSITION
       , ACS_FINANCIAL_CURRENCY ACS_FINANCIAL_CURRENCY
       , PCS.PC_CURR PC_CURR
       , DOC_GAUGE_SIGNATORY DOC_GAUGE_SIGNATORY
       , DOC_GAUGE_SIGNATORY DOC_DOC_GAUGE_SIGNATORY
       , PAC_PERSON PAC_PERSON
       , ACS_TAX_CODE ACS_TAX_CODE
       , PCS.PC_LANG PC_LANG
       , PAC_REPRESENTATIVE
       , PAC_SENDING_CONDITION_TEXT
   where DOC_DOCUMENT.DOC_DOCUMENT_ID = DOC_FOOT.DOC_DOCUMENT_ID(+)
     and DOC_DOCUMENT.DOC_GAUGE_ID = DOC_GAUGE.DOC_GAUGE_ID
     and DOC_DOCUMENT.PAC_ADDRESS_ID = PAC_ADDRESS.PAC_ADDRESS_ID(+)
     and DOC_DOCUMENT.PAC_PAYMENT_CONDITION_ID = PAC_PAYMENT_CONDITION.PAC_PAYMENT_CONDITION_ID(+)
     and PAC_PAYMENT_CONDITION.PC_APPLTXT_ID = PC_APPLTXT.PC_APPLTXT_ID(+)
     and DOC_DOCUMENT.DOC_DOCUMENT_ID = DOC_POSITION.DOC_DOCUMENT_ID(+)
     and DOC_DOCUMENT.ACS_FINANCIAL_CURRENCY_ID = ACS_FINANCIAL_CURRENCY.ACS_FINANCIAL_CURRENCY_ID(+)
     and ACS_FINANCIAL_CURRENCY.PC_CURR_ID = PC_CURR.PC_CURR_ID(+)
     and DOC_GAUGE.DOC_GAUGE_SIGNATORY_ID = DOC_GAUGE_SIGNATORY.DOC_GAUGE_SIGNATORY_ID(+)
     and DOC_GAUGE.DOC_DOC_GAUGE_SIGNATORY_ID = DOC_DOC_GAUGE_SIGNATORY.DOC_GAUGE_SIGNATORY_ID(+)
     and PAC_ADDRESS.PAC_PERSON_ID = PAC_PERSON.PAC_PERSON_ID(+)
     and DOC_POSITION.ACS_TAX_CODE_ID = ACS_TAX_CODE.ACS_TAX_CODE_ID(+)
     and DOC_DOCUMENT.PC_LANG_ID = PC_LANG.PC_LANG_ID(+)
     and DOC_DOCUMENT.PAC_REPRESENTATIVE_ID = PAC_REPRESENTATIVE.PAC_REPRESENTATIVE_ID(+)
     and DOC_DOCUMENT.PAC_SENDING_CONDITION_ID = PAC_SENDING_CONDITION_TEXT.PAC_SENDING_CONDITION_ID(+)
     and DOC_DOCUMENT.PC_LANG_ID = PAC_SENDING_CONDITION_TEXT.PC_LANG_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PCH_IMPUTATION" ("DOC_POSITION_CHARGE_ID", "DOC_DOCUMENT_ID", "DOC_RECORD_ID", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "C_FAM_TRANSACTION_TYP", "FAM_FIXED_ASSETS_ID", "HRM_PERSON_ID", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "POI_AMOUNT", "POI_AMOUNT_B", "POI_AMOUNT_E", "POI_AMOUNT_V", "POI_VAT_AMOUNT", "POI_VAT_AMOUNT_B", "POI_VAT_AMOUNT_E", "POI_VAT_AMOUNT_V", "POI_IMF_NUMBER_1", "POI_IMF_NUMBER_2", "POI_IMF_NUMBER_3", "POI_IMF_NUMBER_4", "POI_IMF_NUMBER_5", "POI_IMF_TEXT_1", "POI_IMF_TEXT_2", "POI_IMF_TEXT_3", "POI_IMF_TEXT_4", "POI_IMF_TEXT_5", "POI_IMF_DATE_1", "POI_IMF_DATE_2", "POI_IMF_DATE_3", "POI_IMF_DATE_4", "POI_IMF_DATE_5", "POI_RATIO", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS") AS
  select POI.DOC_POSITION_CHARGE_ID
       , POI.DOC_DOCUMENT_ID
       , POI.DOC_RECORD_ID
       , POI.ACS_PJ_ACCOUNT_ID
       , POI.ACS_PF_ACCOUNT_ID
       , POI.ACS_FINANCIAL_ACCOUNT_ID
       , POI.DIC_IMP_FREE1_ID
       , POI.DIC_IMP_FREE2_ID
       , POI.DIC_IMP_FREE3_ID
       , POI.DIC_IMP_FREE4_ID
       , POI.DIC_IMP_FREE5_ID
       , POI.C_FAM_TRANSACTION_TYP
       , POI.FAM_FIXED_ASSETS_ID
       , POI.HRM_PERSON_ID
       , POI.ACS_CDA_ACCOUNT_ID
       , POI.ACS_CPN_ACCOUNT_ID
       , POI.ACS_DIVISION_ACCOUNT_ID
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_AMOUNT POI_AMOUNT
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_AMOUNT_B POI_AMOUNT_B
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_AMOUNT_E POI_AMOUNT_E
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_AMOUNT_V POI_AMOUNT_V
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_VAT_AMOUNT POI_VAT_AMOUNT
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_VAT_AMOUNT_B POI_VAT_AMOUNT_B
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_VAT_AMOUNT_E POI_VAT_AMOUNT_E
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * POI_VAT_AMOUNT_V POI_VAT_AMOUNT_V
       , POI_IMF_NUMBER_1
       , POI_IMF_NUMBER_2
       , POI_IMF_NUMBER_3
       , POI_IMF_NUMBER_4
       , POI_IMF_NUMBER_5
       , POI_IMF_TEXT_1
       , POI_IMF_TEXT_2
       , POI_IMF_TEXT_3
       , POI_IMF_TEXT_4
       , POI_IMF_TEXT_5
       , POI_IMF_DATE_1
       , POI_IMF_DATE_2
       , POI_IMF_DATE_3
       , POI_IMF_DATE_4
       , POI_IMF_DATE_5
       , POI_RATIO
       , POI.A_CONFIRM
       , POI.A_DATECRE
       , POI.A_DATEMOD
       , POI.A_IDCRE
       , POI.A_IDMOD
       , POI.A_RECLEVEL
       , POI.A_RECSTATUS
    from DOC_POSITION_IMPUTATION POI
       , DOC_POSITION_CHARGE PCH
   where POI.DOC_POSITION_CHARGE_ID = PCH.DOC_POSITION_CHARGE_ID
  union
  select PCH.DOC_POSITION_CHARGE_ID
       , PCH.DOC_DOCUMENT_ID
       , nvl(POS.DOC_DOC_RECORD_ID, POS.DOC_RECORD_ID) DOC_RECORD_ID
       , PCH.ACS_PJ_ACCOUNT_ID
       , PCH.ACS_PF_ACCOUNT_ID
       , PCH.ACS_FINANCIAL_ACCOUNT_ID
       , PCH.DIC_IMP_FREE1_ID
       , PCH.DIC_IMP_FREE2_ID
       , PCH.DIC_IMP_FREE3_ID
       , PCH.DIC_IMP_FREE4_ID
       , PCH.DIC_IMP_FREE5_ID
       , PCH.C_FAM_TRANSACTION_TYP
       , PCH.FAM_FIXED_ASSETS_ID
       , PCH.HRM_PERSON_ID
       , PCH.ACS_CDA_ACCOUNT_ID
       , PCH.ACS_CPN_ACCOUNT_ID
       , PCH.ACS_DIVISION_ACCOUNT_ID
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * PCH_AMOUNT POI_AMOUNT
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * PCH_AMOUNT_B POI_AMOUNT_B
       , decode(C_FINANCIAL_CHARGE, '02', -1, 1) * PCH_AMOUNT_E POI_AMOUNT_E
       , 0 POI_AMOUNT_V
       , 0 POI_VAT_AMOUNT
       , 0 POI_VAT_BASE_AMOUNT
       , 0 POI_VAT_AMOUNT_E
       , 0 POI_VAT_AMOUNT_V
       , PCH_IMP_NUMBER_1
       , PCH_IMP_NUMBER_2
       , PCH_IMP_NUMBER_3
       , PCH_IMP_NUMBER_4
       , PCH_IMP_NUMBER_5
       , PCH_IMP_TEXT_1
       , PCH_IMP_TEXT_2
       , PCH_IMP_TEXT_3
       , PCH_IMP_TEXT_4
       , PCH_IMP_TEXT_5
       , PCH_IMP_DATE_1
       , PCH_IMP_DATE_2
       , PCH_IMP_DATE_3
       , PCH_IMP_DATE_4
       , PCH_IMP_DATE_5
       , 100 POI_RATIO
       , PCH.A_CONFIRM
       , PCH.A_DATECRE
       , PCH.A_DATEMOD
       , PCH.A_IDCRE
       , PCH.A_IDMOD
       , PCH.A_RECLEVEL
       , PCH.A_RECSTATUS
    from DOC_POSITION_CHARGE PCH
       , DOC_POSITION POS
   where not exists(select DOC_POSITION_IMPUTATION_ID
                      from DOC_POSITION_IMPUTATION
                     where DOC_POSITION_CHARGE_ID = PCH.DOC_POSITION_CHARGE_ID)
     and POS.DOC_POSITION_ID = PCH.DOC_POSITION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POSITION" ("V_GOOD_ID", "V_THIRD_ID", "V_BASIS_QUANTITY", "V_NB_POS", "MIN_DATE_VALUE", "MAX_DATE_VALUE") AS
  SELECT
POS.GCO_GOOD_ID V_GOOD_ID,
POS.PAC_THIRD_ID V_THIRD_ID,
SUM(POS.POS_BASIS_QUANTITY) V_BASIS_QUANTITY,
COUNT(POS.DOC_POSITION_ID) V_NB_POS,
MIN(DOC.DMT_DATE_VALUE) MIN_DATE_VALUE,
MAX(DOC.DMT_DATE_VALUE) MAX_DATE_VALUE
FROM
DOC_POSITION POS,
DOC_DOCUMENT DOC,
DOC_GAUGE_STRUCTURED GAS
WHERE
POS.DOC_DOCUMENT_ID=DOC.DOC_DOCUMENT_ID AND
POS.DOC_GAUGE_ID=GAS.DOC_GAUGE_ID AND
GAS.C_GAUGE_TITLE='3'
GROUP BY
POS.GCO_GOOD_ID,POS.PAC_THIRD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POSITION_DETAIL_IO" ("DOC_POSITION_DETAIL_ID", "DOC_GAUGE_FLOW_ID", "DOC_POSITION_ID", "DOC_DOC_POSITION_DETAIL_ID", "DOC2_DOC_POSITION_DETAIL_ID", "PDE_BASIS_DELAY", "PDE_BASIS_DELAY_W", "PDE_BASIS_DELAY_M", "PDE_INTERMEDIATE_DELAY", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_DELAY_M", "PDE_FINAL_DELAY", "PDE_FINAL_DELAY_W", "PDE_FINAL_DELAY_M", "PDE_BASIS_QUANTITY", "PDE_INTERMEDIATE_QUANTITY", "PDE_FINAL_QUANTITY", "PDE_BALANCE_QUANTITY", "PDE_MOVEMENT_QUANTITY", "PDE_MOVEMENT_VALUE", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM", "PDE_BALANCE_QUANTITY_PARENT", "DIC_PDE_FREE_TABLE_1_ID", "DIC_PDE_FREE_TABLE_2_ID", "DIC_PDE_FREE_TABLE_3_ID", "PDE_DECIMAL_1", "PDE_DECIMAL_2", "PDE_DECIMAL_3", "PDE_TEXT_1", "PDE_TEXT_2", "PDE_TEXT_3", "FAL_SCHEDULE_STEP_ID", "DOC_DOCUMENT_ID", "PAC_THIRD_ID", "DOC_GAUGE_ID", "DOC_GAUGE_RECEIPT_ID", "DOC_GAUGE_COPY_ID", "DIC_DELAY_UPDATE_TYPE_ID", "PDE_DELAY_UPDATE_TEXT", "PDE_BASIS_QUANTITY_SU", "PDE_INTERMEDIATE_QUANTITY_SU", "PDE_FINAL_QUANTITY_SU", "PDE_GENERATE_MOVEMENT", "GCO_GOOD_ID", "PDE_PIECE", "PDE_SET", "PDE_VERSION", "PDE_CHRONOLOGICAL", "PDE_STD_CHAR_1", "PDE_STD_CHAR_2", "PDE_STD_CHAR_3", "PDE_STD_CHAR_4", "PDE_STD_CHAR_5", "PDE_BALANCE_PARENT", "FAL_NETWORK_LINK_ID", "PDE_DATE_1", "PDE_DATE_2", "PDE_DATE_3", "PDE_SQM_ACCEPTED_DELAY", "PDE_TRANSFERT_PROPRIETOR", "C_PDE_CREATE_MODE", "FAL_SUPPLY_REQUEST_ID", "GCO_GCO_GOOD_ID", "PDE_MOVEMENT_DATE", "DOC_RECORD_ID", "DOC_POSITION_SRC_ID", "DOC_DOCUMENT_SRC_ID", "CML_EVENTS_ID", "ACS_FINANCIAL_ACCOUNT_BS_ID", "ACS_FINANCIAL_ACCOUNT_PL_ID", "ACS_DIVISION_ACCOUNT_BS_ID", "ACS_DIVISION_ACCOUNT_PL_ID", "ACS_CPN_ACCOUNT_BS_ID", "ACS_CPN_ACCOUNT_PL_ID", "ACS_CDA_ACCOUNT_BS_ID", "ACS_CDA_ACCOUNT_PL_ID", "ACS_PF_ACCOUNT_BS_ID", "ACS_PF_ACCOUNT_PL_ID", "ACS_PJ_ACCOUNT_BS_ID", "ACS_PJ_ACCOUNT_PL_ID", "DOC_RECORD_BS_ID", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "PDE_IMF_NUMBER_1", "PDE_IMF_NUMBER_2", "PDE_IMF_NUMBER_3", "PDE_IMF_NUMBER_4", "PDE_IMF_NUMBER_5", "PDE_IMF_TEXT_1", "PDE_IMF_TEXT_2", "PDE_IMF_TEXT_3", "PDE_IMF_TEXT_4", "PDE_IMF_TEXT_5", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_THIRD_CDA_ID", "PAC_THIRD_VAT_ID", "PDE_ADDENDUM_QTY_BALANCED", "PDE_ADDENDUM_SRC_PDE_ID", "C_GAUGE_TYPE_POS", "PDE_GAP_PURCHASE_PRICE", "DOC_PDE_LITIG_ID", "FAL_LOT_ID", "GCO_MANUFACTURED_GOOD_ID", "PDE_ATTRIB_QUANTITY", "STM_STOCK_MOVEMENT_ID", "PDE_ST_PT_REJECT", "PDE_ST_CPT_REJECT", "PDE_IMF_DATE_1", "PDE_IMF_DATE_2", "PDE_IMF_DATE_3", "PDE_IMF_DATE_4", "PDE_IMF_DATE_5", "PDE_CURR_RISK_DISCHARGE_DONE", "GCO_QUALITY_STATUS_ID") AS
  select "DOC_POSITION_DETAIL_ID","DOC_GAUGE_FLOW_ID","DOC_POSITION_ID","DOC_DOC_POSITION_DETAIL_ID","DOC2_DOC_POSITION_DETAIL_ID","PDE_BASIS_DELAY","PDE_BASIS_DELAY_W","PDE_BASIS_DELAY_M","PDE_INTERMEDIATE_DELAY","PDE_INTERMEDIATE_DELAY_W","PDE_INTERMEDIATE_DELAY_M","PDE_FINAL_DELAY","PDE_FINAL_DELAY_W","PDE_FINAL_DELAY_M","PDE_BASIS_QUANTITY","PDE_INTERMEDIATE_QUANTITY","PDE_FINAL_QUANTITY","PDE_BALANCE_QUANTITY","PDE_MOVEMENT_QUANTITY","PDE_MOVEMENT_VALUE","PDE_CHARACTERIZATION_VALUE_1","PDE_CHARACTERIZATION_VALUE_2","PDE_CHARACTERIZATION_VALUE_3","PDE_CHARACTERIZATION_VALUE_4","PDE_CHARACTERIZATION_VALUE_5","GCO_CHARACTERIZATION_ID","GCO_GCO_CHARACTERIZATION_ID","GCO2_GCO_CHARACTERIZATION_ID","GCO3_GCO_CHARACTERIZATION_ID","GCO4_GCO_CHARACTERIZATION_ID","STM_LOCATION_ID","STM_STM_LOCATION_ID","A_DATECRE","A_DATEMOD","A_IDCRE","A_IDMOD","A_RECLEVEL","A_RECSTATUS","A_CONFIRM","PDE_BALANCE_QUANTITY_PARENT","DIC_PDE_FREE_TABLE_1_ID","DIC_PDE_FREE_TABLE_2_ID","DIC_PDE_FREE_TABLE_3_ID","PDE_DECIMAL_1","PDE_DECIMAL_2","PDE_DECIMAL_3","PDE_TEXT_1","PDE_TEXT_2","PDE_TEXT_3","FAL_SCHEDULE_STEP_ID","DOC_DOCUMENT_ID","PAC_THIRD_ID","DOC_GAUGE_ID","DOC_GAUGE_RECEIPT_ID","DOC_GAUGE_COPY_ID","DIC_DELAY_UPDATE_TYPE_ID","PDE_DELAY_UPDATE_TEXT","PDE_BASIS_QUANTITY_SU","PDE_INTERMEDIATE_QUANTITY_SU","PDE_FINAL_QUANTITY_SU","PDE_GENERATE_MOVEMENT","GCO_GOOD_ID","PDE_PIECE","PDE_SET","PDE_VERSION","PDE_CHRONOLOGICAL","PDE_STD_CHAR_1","PDE_STD_CHAR_2","PDE_STD_CHAR_3","PDE_STD_CHAR_4","PDE_STD_CHAR_5","PDE_BALANCE_PARENT","FAL_NETWORK_LINK_ID","PDE_DATE_1","PDE_DATE_2","PDE_DATE_3","PDE_SQM_ACCEPTED_DELAY","PDE_TRANSFERT_PROPRIETOR","C_PDE_CREATE_MODE","FAL_SUPPLY_REQUEST_ID","GCO_GCO_GOOD_ID","PDE_MOVEMENT_DATE","DOC_RECORD_ID","DOC_POSITION_SRC_ID","DOC_DOCUMENT_SRC_ID","CML_EVENTS_ID","ACS_FINANCIAL_ACCOUNT_BS_ID","ACS_FINANCIAL_ACCOUNT_PL_ID","ACS_DIVISION_ACCOUNT_BS_ID","ACS_DIVISION_ACCOUNT_PL_ID","ACS_CPN_ACCOUNT_BS_ID","ACS_CPN_ACCOUNT_PL_ID","ACS_CDA_ACCOUNT_BS_ID","ACS_CDA_ACCOUNT_PL_ID","ACS_PF_ACCOUNT_BS_ID","ACS_PF_ACCOUNT_PL_ID","ACS_PJ_ACCOUNT_BS_ID","ACS_PJ_ACCOUNT_PL_ID","DOC_RECORD_BS_ID","HRM_PERSON_ID","FAM_FIXED_ASSETS_ID","C_FAM_TRANSACTION_TYP","DIC_IMP_FREE1_ID","DIC_IMP_FREE2_ID","DIC_IMP_FREE3_ID","DIC_IMP_FREE4_ID","DIC_IMP_FREE5_ID","PDE_IMF_NUMBER_1","PDE_IMF_NUMBER_2","PDE_IMF_NUMBER_3","PDE_IMF_NUMBER_4","PDE_IMF_NUMBER_5","PDE_IMF_TEXT_1","PDE_IMF_TEXT_2","PDE_IMF_TEXT_3","PDE_IMF_TEXT_4","PDE_IMF_TEXT_5","PAC_THIRD_ACI_ID","PAC_THIRD_DELIVERY_ID","PAC_THIRD_TARIFF_ID","PAC_THIRD_CDA_ID","PAC_THIRD_VAT_ID","PDE_ADDENDUM_QTY_BALANCED","PDE_ADDENDUM_SRC_PDE_ID","C_GAUGE_TYPE_POS","PDE_GAP_PURCHASE_PRICE","DOC_PDE_LITIG_ID","FAL_LOT_ID","GCO_MANUFACTURED_GOOD_ID","PDE_ATTRIB_QUANTITY","STM_STOCK_MOVEMENT_ID","PDE_ST_PT_REJECT","PDE_ST_CPT_REJECT","PDE_IMF_DATE_1","PDE_IMF_DATE_2","PDE_IMF_DATE_3","PDE_IMF_DATE_4","PDE_IMF_DATE_5","PDE_CURR_RISK_DISCHARGE_DONE","GCO_QUALITY_STATUS_ID"
    from DOC_POSITION_DETAIL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POSITION_SUPPL" ("V_GOOD_ID", "V_THIRD_ID", "V_BASIS_QUANTITY", "V_NB_POS", "MIN_DATE_VALUE", "MAX_DATE_VALUE") AS
  SELECT
POS.GCO_GOOD_ID V_GOOD_ID,
POS.PAC_THIRD_ID V_THIRD_ID,
SUM(POS.POS_BASIS_QUANTITY) V_BASIS_QUANTITY,
COUNT(POS.DOC_POSITION_ID) V_NB_POS,
MIN(DOC.DMT_DATE_VALUE) MIN_DATE_VALUE,
MAX(DOC.DMT_DATE_VALUE) MAX_DATE_VALUE
FROM
DOC_POSITION POS,
DOC_DOCUMENT DOC,
DOC_GAUGE_STRUCTURED GAS
WHERE
POS.DOC_DOCUMENT_ID=DOC.DOC_DOCUMENT_ID AND
POS.DOC_GAUGE_ID=GAS.DOC_GAUGE_ID AND
GAS.C_GAUGE_TITLE='3'
GROUP BY
POS.GCO_GOOD_ID,POS.PAC_THIRD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_4_PRNT" ("DOC_DOCUMENT_ID", "DOCNUMBER", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_VALUE", "DMT_DATE_FALLING_DUE", "DMT_DATE_DELIVERY", "C_DOCUMENT_STATUS", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_DATE_PARTNER_DOCUMENT", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DIC_DOC_FREE_1_ID", "DIC_DOC_FREE_2_ID", "DIC_DOC_FREE_3_ID", "DIC_TYPE_SUBMISSION_ID", "DOC_DIC_POS_FREE_TABLE_1_ID", "DOC_DIC_POS_FREE_TABLE_2_ID", "DOC_DIC_POS_FREE_TABLE_3_ID", "DMT_DECIMAL_1", "DMT_DECIMAL_2", "DMT_DECIMAL_3", "DMT_TEXT_1", "DMT_TEXT_2", "DMT_TEXT_3", "DMT_DATE_1", "DMT_DATE_2", "DMT_DATE_3", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "DMT_GAU_FREE_NUMBER1", "DMT_GAU_FREE_NUMBER2", "DMT_GAU_FREE_DATE1", "DMT_GAU_FREE_DATE2", "DMT_GAU_FREE_TEXT_LONG", "DMT_GAU_FREE_TEXT_SHORT", "DMT_GAU_FREE_BOOL1", "DMT_GAU_FREE_BOOL2", "DIC_TARIFF_ID", "C_INCOTERMS", "DMT_INCOTERMS_PLACE", "PAC_REPRESENTATIVE_ID", "REP_DESCR", "DIC_ACCOUNTABLE_GROUP_ID", "RCO_TITLE", "RCO_DESCRIPTION", "PAC_THIRD_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_INTRA", "THI_NO_TVA", "THI_NO_SIREN", "THI_NO_SIRET", "THI_NO_FORMAT", "C_DELIVERY_TYP", "CUS_SUPPLIER_NUMBER", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "DIC_TYPE_PARTNER_ID", "CRE_CUSTOMER_NUMBER", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "DIC_TYPE_PARTNER_F_ID", "PAC_SENDING_CONDITION_ID", "SENDING_ADDRESS_ID", "SEN_PER_NAME", "SEN_PER_FORENAME", "SEN_PER_ACTIVITY", "SEN_PER_COMMENT", "SEN_PER_KEY1", "SEN_PER_KEY2", "SEN_ADD_ADDRESS1", "SEN_ADD_FORMAT", "ACS_PAYMENT_METHOD_ID", "CUSTOMER_ACCOUNT", "SUPPLIER_ACCOUNT", "PC_LANG_ID", "PAC_PAYMENT_CONDITION_ID", "PCO_DESCR", "PMT_PC_APPLTXT_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "CURRNAME", "LANID", "ADDRESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "PER_DPO_DESCR", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "DMT_TOWN1", "CNTID", "CNTNAME", "DIC_PC_CNTRY_GRP_ID", "CNT_CE_CODE", "CNT_CE_MEMBER", "ADDRESS2_ID", "PER2_NAME", "PER2_FORENAME", "PER2_ACTIVITY", "PER2_COMMENT", "PER2_KEY1", "PER2_KEY2", "PER2_DPO_DESCR", "DMT_ADDRESS2", "DMT_FORMAT_CITY2", "DMT_TOWN2", "CNTID2", "CNTNAME2", "DIC_PC_CNTRY_GRP_ID2", "CNT_CE_CODE2", "CNT_CE_MEMBER2", "ADDRESS3_ID", "PER3_NAME", "PER3_FORENAME", "PER3_ACTIVITY", "PER3_COMMENT", "PER3_KEY1", "PER3_KEY2", "PER3_DPO_DESCR", "DMT_ADDRESS3", "DMT_FORMAT_CITY3", "DMT_TOWN3", "CNTID3", "CNTNAME3", "DIC_PC_CNTRY_GRP_ID3", "CNT_CE_CODE3", "CNT_CE_MEMBER3", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "GAS_FINANCIAL_CHARGE", "C_ADMIN_DOMAIN", "DIC_GAUGE_TYPE_DOC_ID", "DIC_DOC_FREE_TABLE_1_ID", "DIC_DOC_FREE_TABLE_2_ID", "DIC_DOC_FREE_TABLE_3_ID", "DIC_DOC_FREE_TABLE_4_ID", "DIC_DOC_FREE_TABLE_5_ID", "FRD_ALPHA_SHORT_1", "FRD_ALPHA_SHORT_2", "FRD_ALPHA_SHORT_3", "FRD_ALPHA_SHORT_4", "FRD_ALPHA_SHORT_5", "FRD_ALPHA_LONG_1", "FRD_ALPHA_LONG_2", "FRD_ALPHA_LONG_3", "FRD_ALPHA_LONG_4", "FRD_ALPHA_LONG_5", "FRD_INTEGER_1", "FRD_INTEGER_2", "FRD_INTEGER_3", "FRD_INTEGER_4", "FRD_INTEGER_5", "FRD_DECIMAL_1", "FRD_DECIMAL_2", "FRD_DECIMAL_3", "FRD_DECIMAL_4", "FRD_DECIMAL_5", "FRD_BOOLEAN_1", "FRD_BOOLEAN_2", "FRD_BOOLEAN_3", "FRD_BOOLEAN_4", "FRD_BOOLEAN_5", "DOC_FOOT_ID", "DOC_GAUGE_SIGNATORY_ID", "GAG_NAME", "GAG_FUNCTION", "DOC_DOC_GAUGE_SIGNATORY_ID", "GAG2_NAME", "GAG2_FUNCTION", "FOO_FOOT_TEXT", "FOO_FOOT_TEXT2", "FOO_FOOT_TEXT3", "FOO_FOOT_TEXT4", "FOO_FOOT_TEXT5", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT", "FOO_TOTAL_VAT_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "FOO_REF_BVR_NUMBER", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_PAID_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "DIC_TYPE_DOC_CUSTOM_ID", "C_DIRECTION_NUMBER", "FOO_TOT_VAT_AMOUNT_V", "FOO_RECEIVED_AMOUNT", "FOO_PAID_BALANCED_AMOUNT", "DOC_POSITION_ID", "POS_NUMBER", "C_DOC_POS_STATUS", "C_GAUGE_TYPE_POS", "GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOOD_NUMBER_OF_DECIMAL", "GOO_NUMBER_OF_DECIMAL", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_MODEL_ID", "DIC_GOOD_GROUP_ID", "PDT_STOCK_MANAGEMENT", "C_GAUGE_SHOW_DELAY", "GAP_POS_DELAY", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "ASA_RECORD_ID", "ASA_RECORD_TASK_ID", "ASA_RECORD_COMP_ID", "TVA_ACC_NUMBER", "POS_RCO_TITLE", "POS_DIC_ACCOUNTABLE_GROUP_ID", "POS_RCO_DESCRIPTION", "POS_PAC_REPRESENTATIVE_ID", "POS_REP_DESCR", "CUS_CUSTONS_POSITION", "CUS_KEY_TARIFF", "CUS_LICENCE_NUMBER", "CUS_RATE_FOR_VALUE", "CUS_TRANSPORT_INFORMATION", "DIC_REPAYMENT_CODE_ID", "DIC_SUBJUGATED_LICENCE_ID", "CNTID_CUSTOMS", "CNTNAME_CUSTOMS", "DIC_PC_CNTRY_GRP_ID_CUSTOMS", "CNT_CE_CODE_CUSTOMS", "CNT_CE_MEMBER_CUSTOMS", "CNTID_ORIGIN", "CNTNAME_ORIGIN", "DIC_PC_CNTRY_GRP_ID_ORIGIN", "CNT_CE_CODE_ORIGIN", "CNT_CE_MEMBER_ORIGIN", "DATA_UNIT_PRICE_SALE", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_GROSS_UNIT_VALUE", "POS_GROSS_UNIT_VALUE_SU", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_REF_UNIT_VALUE", "POS_GROSS_VALUE", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_INCL", "POS_BASIS_QUANTITY", "POS_INTERMEDIATE_QUANTITY", "POS_FINAL_QUANTITY", "POS_BALANCE_QUANTITY", "POS_RATE_FACTOR", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "DIC_UNIT_OF_MEASURE_ID", "POS_NOM_TEXT", "POS_UNIT_COST_PRICE", "POS_EAN_CODE", "POS_EAN_UCC14_CODE", "POS_HIBC_PRIMARY_CODE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "POS_VALUE_QUANTITY", "POS_INCLUDE_TAX_TARIFF", "POS_GROSS_UNIT_VALUE_INCL", "POS_GROSS_UNIT_VALUE_INCL_SU", "POS_GROSS_VALUE_INCL", "POS_BALANCE_QTY_VALUE", "POS_UTIL_COEFF", "POS_GROSS_UNIT_VALUE2", "DIC_DIC_UNIT_OF_MEASURE_ID", "POS_CONVERT_FACTOR2", "POS_VAT_AMOUNT_V", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY_SU", "C_POS_DELIVERY_TYP", "POS_BALANCED", "DOC_POSITION_DETAIL_ID", "PERE_DOC_POSITION_DETAIL_ID", "PERE_DMT_NUMBER", "PERE_DMT_DATE_DOCUMENT", "PERE_C_GAUGE_TITLE", "PERE_DMT_PARTNER_NUMBER", "PERE_DMT_PARTNTER_REFERENCE", "PERE_DATE_PARTNER_DOCUMENT", "G_PERE_DOC_POSITION_DETAIL_ID", "G_PERE_DMT_NUMBER", "G_PERE_DMT_DATE_DOCUMENT", "G_PERE_C_GAUGE_TITLE", "G_PERE_DMT_PARTNER_NUMBER", "G_PERE_DMT_PARTNTER_REFERENCE", "G_PERE_DATE_PARTNER_DOCUMENT", "STM_LOCATION_ID", "LOC_DESCRIPTION", "STO_DESCRIPTION", "STM_STM_LOCATION_ID", "LOC_LOC_DESCRIPTION", "STO_STO_DESCRIPTION", "DIC_DELAY_UPDATE_TYPE_ID", "PDE_DELAY_UPDATE_TEXT", "GCO1_CHARACTERIZATION_ID", "GCO2_CHARACTERIZATION_ID", "GCO3_CHARACTERIZATION_ID", "GCO4_CHARACTERIZATION_ID", "GCO5_CHARACTERIZATION_ID", "GCO1_CHARAC_DESCR", "GCO2_CHARAC_DESCR", "GCO3_CHARAC_DESCR", "GCO4_CHARAC_DESCR", "GCO5_CHARAC_DESCR", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "PDE_PIECE", "PDE_SET", "PDE_VERSION", "PDE_CHRONOLOGICAL", "PDE_STD_CHAR_1", "PDE_STD_CHAR_2", "PDE_STD_CHAR_3", "PDE_STD_CHAR_4", "PDE_STD_CHAR_5", "PDE_BASIS_DELAY", "PDE_BASIS_DELAY_M", "PDE_BASIS_DELAY_W", "PDE_BASIS_QUANTITY", "PDE_BASIS_QUANTITY_SU", "PDE_INTERMEDIATE_DELAY", "PDE_INTERMEDIATE_DELAY_M", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_QUANTITY", "PDE_INTERMEDIATE_QUANTITY_SU", "PDE_FINAL_DELAY", "PDE_FINAL_DELAY_M", "PDE_FINAL_DELAY_W", "PDE_FINAL_QUANTITY", "PDE_FINAL_QUANTITY_SU", "PDE_BALANCE_QUANTITY", "P_PDE_BALANCE_QUANTITY", "P_PDE_BALANCE_QUANTITY_PARENT", "P_PDE_BASIS_QUANTITY", "P_PDE_BASIS_QUANTITY_SU", "P_PDE_INTERMEDIATE_QUANTITY", "P_PDE_INTERMEDIATE_QUANTITY_SU", "P_PDE_FINAL_QUANTITY", "P_PDE_FINAL_QUANTITY_SU", "NEED_FAN_EXCEED_QTY", "NEED_FAN_FREE_QTY", "NEED_FAN_FULL_QTY", "NEED_FAN_NETW_QTY", "NEED_FAN_PREV_QTY", "NEED_FAN_REALIZE_QTY", "NEED_FAN_RETURN_QTY", "NEED_FAN_STK_QTY", "NEED_FAL_NETWORK_NEED_ID", "SUPPLY_FAN_EXCEED_QTY", "SUPPLY_FAN_FREE_QTY", "SUPPLY_FAN_FULL_QTY", "SUPPLY_FAN_NETW_QTY", "SUPPLY_FAN_PREV_QTY", "SUPPLY_FAN_REALIZE_QTY", "SUPPLY_FAN_RETURN_QTY", "SUPPLY_FAN_STK_QTY", "SUPPLY_FAL_NETWORK_SUPPLY_ID", "LOT_REFCOMPL", "COMP_MAJOR_REFERENCE", "SCS_SHORT_DESCR", "SCS_LONG_DESCR", "SCS_FREE_DESCR", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "POS_TARIFF_SET", "DOC_RECORD_ID", "RCO_SUPPLIER_SERIAL_NUMBER", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_REPR_ACI_ID", "PAC_REPR_DELIVERY_ID", "PC_LANG_ACI_ID", "PC_LANG_DELIVERY_ID", "DMT_NAME1", "DMT_FORENAME1", "DMT_ACTIVITY1", "DMT_CARE_OF1", "DMT_PO_BOX1", "DMT_PO_BOX_NBR1", "DMT_COUNTY1", "DMT_CONTACT1", "DMT_NAME2", "DMT_FORENAME2", "DMT_ACTIVITY2", "DMT_CARE_OF2", "DMT_PO_BOX2", "DMT_PO_BOX_NBR2", "DMT_COUNTY2", "DMT_CONTACT2", "DMT_NAME3", "DMT_FORENAME3", "DMT_ACTIVITY3", "DMT_CARE_OF3", "DMT_PO_BOX3", "DMT_PO_BOX_NBR3", "DMT_COUNTY3", "DMT_CONTACT3", "ADR_DO_LIKE_LIVR", "ADR_DO_LIKE_FACT", "PDE_RCO_TITLE", "PDE_RCO_SUPPLIER_SERIAL_NUMBER", "CML_EVENTS_ID", "ASA_COUNTER_STATEMENT_ID", "CML_POSITION_SERVICE_DETAIL_ID", "CML_POSITION_MACHINE_DETAIL_ID", "CEV_COUNTER_BEGIN_QTY", "CEV_COUNTER_END_QTY", "CEV_COUNTER_BEGIN_DATE", "CEV_COUNTER_END_DATE", "CEV_FREE_QTY", "CEV_GROSS_CONSUMED_QTY", "CEV_NET_CONSUMED_QTY", "CEV_BALANCE_QTY", "CEV_INVOICING_QTY", "CEV_GLOBAL_EVENT", "CEV_RENEWAL_GENERATED", "CML_POSITION_ID", "CPO_SEQUENCE", "CCO_NUMBER", "POS_NEW", "PDE_NEW", "POS_BASIS_QTY_UPDATED", "POS_INTER_QTY_UPDATED", "POS_FINAL_QTY_UPDATED", "POS_PRICE_UPDATED", "POS_REF_UPDATED", "POS_SHORT_DES_UPDATED", "POS_LONG_DES_UPDATED", "POS_FREE_DES_UPDATED", "PDE_BASIS_DELAY_UPDATED", "PDE_INTER_DELAY_UPDATED", "PDE_FINAL_DELAY_UPDATED") AS
  select DMT.DOC_DOCUMENT_ID
       , DMT.DMT_NUMBER DOCNUMBER
       , DETAIL.DMT_NUMBER
       , DMT.DMT_DATE_DOCUMENT
       , DMT.DMT_DATE_VALUE
       , DMT.DMT_DATE_FALLING_DUE
       , DMT.DMT_DATE_DELIVERY
       , DMT.C_DOCUMENT_STATUS
       , DMT.DMT_PARTNER_NUMBER
       , DMT.DMT_PARTNER_REFERENCE
       , DMT.DMT_DATE_PARTNER_DOCUMENT
       , DMT.DMT_REFERENCE
       , DMT.DMT_TITLE_TEXT
       , DMT.DMT_HEADING_TEXT
       , DMT.DMT_DOCUMENT_TEXT
       , DMT.DIC_DOC_FREE_1_ID
       , DMT.DIC_DOC_FREE_2_ID
       , DMT.DIC_DOC_FREE_3_ID
       , DMT.DIC_TYPE_SUBMISSION_ID
       , DMT.DIC_POS_FREE_TABLE_1_ID DOC_DIC_POS_FREE_TABLE_1_ID
       , DMT.DIC_POS_FREE_TABLE_2_ID DOC_DIC_POS_FREE_TABLE_2_ID
       , DMT.DIC_POS_FREE_TABLE_3_ID DOC_DIC_POS_FREE_TABLE_3_ID
       , DMT.DMT_DECIMAL_1
       , DMT.DMT_DECIMAL_2
       , DMT.DMT_DECIMAL_3
       , DMT.DMT_TEXT_1
       , DMT.DMT_TEXT_2
       , DMT.DMT_TEXT_3
       , DMT.DMT_DATE_1
       , DMT.DMT_DATE_2
       , DMT.DMT_DATE_3
       , DMT.DIC_GAUGE_FREE_CODE_1_ID
       , DMT.DIC_GAUGE_FREE_CODE_2_ID
       , DMT.DIC_GAUGE_FREE_CODE_3_ID
       , DMT.DMT_GAU_FREE_NUMBER1
       , DMT.DMT_GAU_FREE_NUMBER2
       , DMT.DMT_GAU_FREE_DATE1
       , DMT.DMT_GAU_FREE_DATE2
       , DMT.DMT_GAU_FREE_TEXT_LONG
       , DMT.DMT_GAU_FREE_TEXT_SHORT
       , DMT.DMT_GAU_FREE_BOOL1
       , DMT.DMT_GAU_FREE_BOOL2
       , DMT.DIC_TARIFF_ID
       , DMT.C_INCOTERMS
       , DMT.DMT_INCOTERMS_PLACE
       , REP.PAC_REPRESENTATIVE_ID
       , REP.REP_DESCR
       , REC.DIC_ACCOUNTABLE_GROUP_ID
       , REC.RCO_TITLE
       , REC.RCO_DESCRIPTION
       , DMT.PAC_THIRD_ID
       , THI.DIC_THIRD_ACTIVITY_ID
       , THI.DIC_THIRD_AREA_ID
       , THI.THI_NO_INTRA
       , THI.THI_NO_TVA
       , THI.THI_NO_SIREN
       , THI.THI_NO_SIRET
       , THI.THI_NO_FORMAT
       , CUS.C_DELIVERY_TYP
       , CUS.CUS_SUPPLIER_NUMBER
       , CUS.CUS_FREE_ZONE1
       , CUS.CUS_FREE_ZONE2
       , CUS.CUS_FREE_ZONE3
       , CUS.CUS_FREE_ZONE4
       , CUS.CUS_FREE_ZONE5
       , CUS.DIC_STATISTIC_1_ID
       , CUS.DIC_STATISTIC_2_ID
       , CUS.DIC_STATISTIC_3_ID
       , CUS.DIC_STATISTIC_4_ID
       , CUS.DIC_STATISTIC_5_ID
       , CUS.DIC_TYPE_PARTNER_ID
       , SUP.CRE_CUSTOMER_NUMBER
       , SUP.CRE_FREE_ZONE1
       , SUP.CRE_FREE_ZONE2
       , SUP.CRE_FREE_ZONE3
       , SUP.CRE_FREE_ZONE4
       , SUP.CRE_FREE_ZONE5
       , SUP.DIC_STATISTIC_F1_ID
       , SUP.DIC_STATISTIC_F2_ID
       , SUP.DIC_STATISTIC_F3_ID
       , SUP.DIC_STATISTIC_F4_ID
       , SUP.DIC_STATISTIC_F5_ID
       , SUP.DIC_TYPE_PARTNER_F_ID
       , PSC.PAC_SENDING_CONDITION_ID
       , PSC.PAC_ADDRESS_ID SENDING_ADDRESS_ID
       , PER_SEN.PER_NAME SEN_PER_NAME
       , PER_SEN.PER_FORENAME SEN_PER_FORENAME
       , PER_SEN.PER_ACTIVITY SEN_PER_ACTIVITY
       , PER_SEN.PER_COMMENT SEN_PER_COMMENT
       , PER_SEN.PER_KEY1 SEN_PER_KEY1
       , PER_SEN.PER_KEY2 SEN_PER_KEY2
       , ADR_SEN.ADD_ADDRESS1 SEN_ADD_ADDRESS1
       , ADR_SEN.ADD_FORMAT SEN_ADD_FORMAT
       , APM.ACS_PAYMENT_METHOD_ID
       , ACCC.ACC_NUMBER CUSTOMER_ACCOUNT
       , ACCS.ACC_NUMBER SUPPLIER_ACCOUNT
       , DMT.PC_LANG_ID
       , PMT.PAC_PAYMENT_CONDITION_ID
       , PMT.PCO_DESCR
       , PMT.PC_APPLTXT_ID PMT_PC_APPLTXT_ID
       , AFC.ACS_FINANCIAL_CURRENCY_ID
       , CUR.CURRENCY
       , CUR.CURRNAME
       , LANG.LANID
       , DMT.PAC_ADDRESS_ID ADDRESS_ID
       , nvl(DMT.DMT_NAME1, PER.PER_NAME) PER_NAME
       , nvl(DMT.DMT_FORENAME1, PER.PER_FORENAME) PER_FORENAME
       , nvl(DMT.DMT_ACTIVITY1, PER.PER_ACTIVITY) PER_ACTIVITY
       , PER.PER_COMMENT
       , PER.PER_KEY1
       , PER.PER_KEY2
       , (select DPO_DESCR
            from DIC_PERSON_POLITNESS
           where DIC_PERSON_POLITNESS_ID = PER.DIC_PERSON_POLITNESS_ID) PER_DPO_DESCR
       , DMT.DMT_ADDRESS1
       , DMT.DMT_FORMAT_CITY1
       , DMT.DMT_TOWN1
       , CNT.CNTID
       , CNT.CNTNAME
       , CNT.DIC_PC_CNTRY_GRP_ID
       , CNT.CNT_CE_CODE
       , CNT.CNT_CE_MEMBER
       , DMT.PAC_PAC_ADDRESS_ID ADDRESS2_ID
       , nvl(DMT.DMT_NAME2, PER2.PER_NAME) PER2_NAME
       , nvl(DMT.DMT_FORENAME2, PER2.PER_FORENAME) PER2_FORENAME
       , nvl(DMT.DMT_ACTIVITY2, PER2.PER_ACTIVITY) PER2_ACTIVITY
       , PER2.PER_COMMENT PER2_COMMENT
       , PER2.PER_KEY1 PER2_KEY1
       , PER2.PER_KEY2 PER2_KEY2
       , (select DPO_DESCR
            from DIC_PERSON_POLITNESS
           where DIC_PERSON_POLITNESS_ID = PER2.DIC_PERSON_POLITNESS_ID) PER2_DPO_DESCR
       , DMT.DMT_ADDRESS2
       , DMT.DMT_FORMAT_CITY2
       , DMT.DMT_TOWN2
       , CNT2.CNTID CNTID2
       , CNT2.CNTNAME CNTNAME2
       , CNT2.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID2
       , CNT2.CNT_CE_CODE CNT_CE_CODE2
       , CNT2.CNT_CE_MEMBER CNT_CE_MEMBER2
       , DMT.PAC2_PAC_ADDRESS_ID ADDRESS3_ID
       , nvl(DMT.DMT_NAME3, PER3.PER_NAME) PER3_NAME
       , nvl(DMT.DMT_FORENAME3, PER3.PER_FORENAME) PER3_FORENAME
       , nvl(DMT.DMT_ACTIVITY3, PER3.PER_ACTIVITY) PER3_ACTIVITY
       , PER3.PER_COMMENT PER3_COMMENT
       , PER3.PER_KEY1 PER3_KEY1
       , PER3.PER_KEY2 PER3_KEY2
       , (select DPO_DESCR
            from DIC_PERSON_POLITNESS
           where DIC_PERSON_POLITNESS_ID = PER3.DIC_PERSON_POLITNESS_ID) PER3_DPO_DESCR
       , DMT.DMT_ADDRESS3
       , DMT.DMT_FORMAT_CITY3
       , DMT.DMT_TOWN3
       , CNT3.CNTID CNTID3
       , CNT3.CNTNAME CNTNAME3
       , CNT3.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID3
       , CNT3.CNT_CE_CODE CNT_CE_CODE3
       , CNT3.CNT_CE_MEMBER CNT_CE_MEMBER3
       , GAU.C_GAUGE_TYPE
       , GST.C_GAUGE_TITLE
       , GST.GAS_FINANCIAL_CHARGE
       , GAU.C_ADMIN_DOMAIN
       , GAU.DIC_GAUGE_TYPE_DOC_ID
       , DFD.DIC_DOC_FREE_TABLE_1_ID
       , DFD.DIC_DOC_FREE_TABLE_2_ID
       , DFD.DIC_DOC_FREE_TABLE_3_ID
       , DFD.DIC_DOC_FREE_TABLE_4_ID
       , DFD.DIC_DOC_FREE_TABLE_5_ID
       , DFD.FRD_ALPHA_SHORT_1
       , DFD.FRD_ALPHA_SHORT_2
       , DFD.FRD_ALPHA_SHORT_3
       , DFD.FRD_ALPHA_SHORT_4
       , DFD.FRD_ALPHA_SHORT_5
       , DFD.FRD_ALPHA_LONG_1
       , DFD.FRD_ALPHA_LONG_2
       , DFD.FRD_ALPHA_LONG_3
       , DFD.FRD_ALPHA_LONG_4
       , DFD.FRD_ALPHA_LONG_5
       , DFD.FRD_INTEGER_1
       , DFD.FRD_INTEGER_2
       , DFD.FRD_INTEGER_3
       , DFD.FRD_INTEGER_4
       , DFD.FRD_INTEGER_5
       , DFD.FRD_DECIMAL_1
       , DFD.FRD_DECIMAL_2
       , DFD.FRD_DECIMAL_3
       , DFD.FRD_DECIMAL_4
       , DFD.FRD_DECIMAL_5
       , DFD.FRD_BOOLEAN_1
       , DFD.FRD_BOOLEAN_2
       , DFD.FRD_BOOLEAN_3
       , DFD.FRD_BOOLEAN_4
       , DFD.FRD_BOOLEAN_5
       , FOO.DOC_FOOT_ID
       , FOO.DOC_GAUGE_SIGNATORY_ID
       , DGS.GAG_NAME
       , DGS.GAG_FUNCTION
       , FOO.DOC_DOC_GAUGE_SIGNATORY_ID
       , DGS2.GAG_NAME GAG2_NAME
       , DGS2.GAG_FUNCTION GAG2_FUNCTION
       , FOO.FOO_FOOT_TEXT
       , FOO.FOO_FOOT_TEXT2
       , FOO.FOO_FOOT_TEXT3
       , FOO.FOO_FOOT_TEXT4
       , FOO.FOO_FOOT_TEXT5
       , FOO.FOO_DOCUMENT_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOTAL_AMOUNT
       , FOO.FOO_TOTAL_VAT_AMOUNT
       , FOO.FOO_CHARGE_TOTAL_AMOUNT
       , FOO.FOO_DISCOUNT_TOTAL_AMOUNT
       , FOO.FOO_COST_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOT_AMOUNT_EXCL
       , FOO.FOO_CHARG_TOT_AMOUNT_EXCL
       , FOO.FOO_DISC_TOT_AMOUNT_EXCL
       , FOO.FOO_COST_TOT_AMOUNT_EXCL
       , FOO.FOO_TOTAL_NET_WEIGHT
       , FOO.FOO_TOTAL_GROSS_WEIGHT
       , FOO.FOO_TOTAL_BASIS_QUANTITY
       , FOO.FOO_TOTAL_INTERM_QUANTITY
       , FOO.FOO_TOTAL_FINAL_QUANTITY
       , FOO.C_BVR_GENERATION_METHOD
       , FOO.FOO_GENERATE_BVR_NUMBER
       , FOO.FOO_REF_BVR_NUMBER
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_B
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_E
       , FOO.FOO_PAID_AMOUNT
       , FOO.FOO_RETURN_AMOUNT
       , FOO.FOO_PACKAGING
       , FOO.FOO_MARKING
       , FOO.FOO_MEASURE
       , FOO.DIC_TYPE_DOC_CUSTOM_ID
       , FOO.C_DIRECTION_NUMBER
       , FOO.FOO_TOT_VAT_AMOUNT_V
       , FOO.FOO_RECEIVED_AMOUNT
       , FOO.FOO_PAID_BALANCED_AMOUNT
       , POS.DOC_POSITION_ID
       , POS.POS_NUMBER
       , POS.C_DOC_POS_STATUS
       , POS.C_GAUGE_TYPE_POS
       , GOO.GCO_GOOD_ID
       , GOO.GOO_MAJOR_REFERENCE
       , GOO.GOO_SECONDARY_REFERENCE
       , GOO.GOO_NUMBER_OF_DECIMAL GOOD_NUMBER_OF_DECIMAL
       , case GAU.C_ADMIN_DOMAIN
           when '1' then GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', THI.PAC_THIRD_ID)
           when '2' then GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', THI.PAC_THIRD_ID)
           else GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', THI.PAC_THIRD_ID)
         end GOO_NUMBER_OF_DECIMAL
       , GOO.DIC_GOOD_LINE_ID
       , GOO.DIC_GOOD_FAMILY_ID
       , GOO.DIC_GOOD_MODEL_ID
       , GOO.DIC_GOOD_GROUP_ID
       , PDT.PDT_STOCK_MANAGEMENT
       , DGP.C_GAUGE_SHOW_DELAY
       , DGP.GAP_POS_DELAY
       , POS.POS_REFERENCE
       , POS.POS_SHORT_DESCRIPTION
       , POS.POS_LONG_DESCRIPTION
       , POS.POS_FREE_DESCRIPTION
       , POS.POS_BODY_TEXT
       , POS.ASA_RECORD_ID
       , POS.ASA_RECORD_TASK_ID
       , POS.ASA_RECORD_COMP_ID
       , TVA.ACC_NUMBER TVA_ACC_NUMBER
       , REC_POS.RCO_TITLE POS_RCO_TITLE
       , REC_POS.DIC_ACCOUNTABLE_GROUP_ID POS_DIC_ACCOUNTABLE_GROUP_ID
       , REC_POS.RCO_DESCRIPTION POS_RCO_DESCRIPTION
       , REP_POS.PAC_REPRESENTATIVE_ID POS_PAC_REPRESENTATIVE_ID
       , REP_POS.REP_DESCR POS_REP_DESCR
       , GCE.CUS_CUSTONS_POSITION
       , GCE.CUS_KEY_TARIFF
       , GCE.CUS_LICENCE_NUMBER
       , GCE.CUS_RATE_FOR_VALUE
       , GCE.CUS_TRANSPORT_INFORMATION
       , GCE.DIC_REPAYMENT_CODE_ID
       , GCE.DIC_SUBJUGATED_LICENCE_ID
       , CNT_CUSTOMS.CNTID CNTID_CUSTOMS
       , CNT_CUSTOMS.CNTNAME CNTNAME_CUSTOMS
       , CNT_CUSTOMS.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID_CUSTOMS
       , CNT_CUSTOMS.CNT_CE_CODE CNT_CE_CODE_CUSTOMS
       , CNT_CUSTOMS.CNT_CE_MEMBER CNT_CE_MEMBER_CUSTOMS
       , CNT_ORIGIN.CNTID CNTID_ORIGIN
       , CNT_ORIGIN.CNTNAME CNTNAME_ORIGIN
       , CNT_ORIGIN.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID_ORIGIN
       , CNT_ORIGIN.CNT_CE_CODE CNT_CE_CODE_ORIGIN
       , CNT_ORIGIN.CNT_CE_MEMBER CNT_CE_MEMBER_ORIGIN
       , GFD.DATA_UNIT_PRICE_SALE
       , GFD.DIC_FREE_TABLE_1_ID
       , GFD.DIC_FREE_TABLE_2_ID
       , GFD.DIC_FREE_TABLE_3_ID
       , GFD.DIC_FREE_TABLE_4_ID
       , GFD.DIC_FREE_TABLE_5_ID
       , POS.POS_DISCOUNT_AMOUNT
       , POS.POS_CHARGE_AMOUNT
       , POS.POS_VAT_AMOUNT
       , POS.POS_VAT_BASE_AMOUNT
       , POS.POS_GROSS_UNIT_VALUE
       , POS.POS_GROSS_UNIT_VALUE_SU
       , POS.POS_NET_UNIT_VALUE
       , POS.POS_NET_UNIT_VALUE_INCL
       , POS.POS_REF_UNIT_VALUE
       , POS.POS_GROSS_VALUE
       , POS.POS_NET_VALUE_EXCL
       , POS.POS_NET_VALUE_INCL
       , POS.POS_BASIS_QUANTITY
       , POS.POS_INTERMEDIATE_QUANTITY
       , POS.POS_FINAL_QUANTITY
       , case
           when(DMT.DMT_ADDENDUM_INDEX is not null)
           and (POS.C_DOC_POS_STATUS = '04') then POS.POS_ADDENDUM_QTY_BALANCED
           else POS.POS_BALANCE_QUANTITY
         end POS_BALANCE_QUANTITY
       , POS.POS_RATE_FACTOR
       , POS.POS_NET_WEIGHT
       , POS.POS_GROSS_WEIGHT
       , POS.DIC_UNIT_OF_MEASURE_ID
       , POS.POS_NOM_TEXT
       , POS.POS_UNIT_COST_PRICE
       , POS.POS_EAN_CODE
       , POS.POS_EAN_UCC14_CODE
       , POS.POS_HIBC_PRIMARY_CODE
       , POS.DIC_POS_FREE_TABLE_1_ID
       , POS.DIC_POS_FREE_TABLE_2_ID
       , POS.DIC_POS_FREE_TABLE_3_ID
       , POS.POS_DECIMAL_1
       , POS.POS_DECIMAL_2
       , POS.POS_DECIMAL_3
       , POS.POS_TEXT_1
       , POS.POS_TEXT_2
       , POS.POS_TEXT_3
       , POS.POS_DATE_1
       , POS.POS_DATE_2
       , POS.POS_DATE_3
       , POS.POS_DISCOUNT_UNIT_VALUE
       , POS.POS_DISCOUNT_RATE
       , POS.POS_VALUE_QUANTITY
       , POS.POS_INCLUDE_TAX_TARIFF
       , POS.POS_GROSS_UNIT_VALUE_INCL
       , POS.POS_GROSS_UNIT_VALUE_INCL_SU
       , POS.POS_GROSS_VALUE_INCL
       , POS.POS_BALANCE_QTY_VALUE
       , POS.POS_UTIL_COEFF
       , POS.POS_GROSS_UNIT_VALUE2
       , POS.DIC_DIC_UNIT_OF_MEASURE_ID
       , POS.POS_CONVERT_FACTOR2
       , POS.POS_VAT_AMOUNT_V
       , POS.POS_NET_TARIFF
       , POS.POS_SPECIAL_TARIFF
       , POS.POS_FLAT_RATE
       , POS.POS_BASIS_QUANTITY_SU
       , POS.POS_INTERMEDIATE_QUANTITY_SU
       , POS.POS_FINAL_QUANTITY_SU
       , POS.C_POS_DELIVERY_TYP
       , POS.POS_BALANCED
       , DETAIL.DOC_POSITION_DETAIL_ID
       , DETAIL.PERE_DOC_POSITION_DETAIL_ID
       , DETAIL.PERE_DMT_NUMBER
       , DETAIL.PERE_DMT_DATE_DOCUMENT
       , DETAIL.PERE_C_GAUGE_TITLE
       , DETAIL.PERE_DMT_PARTNER_NUMBER
       , DETAIL.PERE_DMT_PARTNTER_REFERENCE
       , DETAIL.PERE_DATE_PARTNER_DOCUMENT
       , DETAIL.G_PERE_DOC_POSITION_DETAIL_ID
       , DETAIL.G_PERE_DMT_NUMBER
       , DETAIL.G_PERE_DMT_DATE_DOCUMENT
       , DETAIL.G_PERE_C_GAUGE_TITLE
       , DETAIL.G_PERE_DMT_PARTNER_NUMBER
       , DETAIL.G_PERE_DMT_PARTNTER_REFERENCE
       , DETAIL.G_PERE_DATE_PARTNER_DOCUMENT
       , DETAIL.STM_LOCATION_ID
       , LOC.LOC_DESCRIPTION
       , STM.STO_DESCRIPTION
       , DETAIL.STM_STM_LOCATION_ID
       , LOC_LOC.LOC_DESCRIPTION LOC_LOC_DESCRIPTION
       , STM_STM.STO_DESCRIPTION STO_STO_DESCRIPTION
       , DETAIL.DIC_DELAY_UPDATE_TYPE_ID
       , DETAIL.PDE_DELAY_UPDATE_TEXT
       , DETAIL.GCO1_CHARACTERIZATION_ID
       , DETAIL.GCO2_CHARACTERIZATION_ID
       , DETAIL.GCO3_CHARACTERIZATION_ID
       , DETAIL.GCO4_CHARACTERIZATION_ID
       , DETAIL.GCO5_CHARACTERIZATION_ID
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO1_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO1_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO2_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO2_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO3_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO3_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO4_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO4_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO5_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO5_CHARAC_DESCR
       , DETAIL.PDE_CHARACTERIZATION_VALUE_1
       , DETAIL.PDE_CHARACTERIZATION_VALUE_2
       , DETAIL.PDE_CHARACTERIZATION_VALUE_3
       , DETAIL.PDE_CHARACTERIZATION_VALUE_4
       , DETAIL.PDE_CHARACTERIZATION_VALUE_5
       , DETAIL.PDE_PIECE
       , DETAIL.PDE_SET
       , DETAIL.PDE_VERSION
       , DETAIL.PDE_CHRONOLOGICAL
       , DETAIL.PDE_STD_CHAR_1
       , DETAIL.PDE_STD_CHAR_2
       , DETAIL.PDE_STD_CHAR_3
       , DETAIL.PDE_STD_CHAR_4
       , DETAIL.PDE_STD_CHAR_5
       , DETAIL.PDE_BASIS_DELAY
       , DETAIL.PDE_BASIS_DELAY_M
       , DETAIL.PDE_BASIS_DELAY_W
       , DETAIL.PDE_BASIS_QUANTITY
       , DETAIL.PDE_BASIS_QUANTITY_SU
       , DETAIL.PDE_INTERMEDIATE_DELAY
       , DETAIL.PDE_INTERMEDIATE_DELAY_M
       , DETAIL.PDE_INTERMEDIATE_DELAY_W
       , DETAIL.PDE_INTERMEDIATE_QUANTITY
       , DETAIL.PDE_INTERMEDIATE_QUANTITY_SU
       , DETAIL.PDE_FINAL_DELAY
       , DETAIL.PDE_FINAL_DELAY_M
       , DETAIL.PDE_FINAL_DELAY_W
       , DETAIL.PDE_FINAL_QUANTITY
       , DETAIL.PDE_FINAL_QUANTITY_SU
       , DETAIL.PDE_BALANCE_QUANTITY
       , DETAIL.P_PDE_BALANCE_QUANTITY
       , DETAIL.P_PDE_BALANCE_QUANTITY_PARENT
       , DETAIL.P_PDE_BASIS_QUANTITY
       , DETAIL.P_PDE_BASIS_QUANTITY_SU
       , DETAIL.P_PDE_INTERMEDIATE_QUANTITY
       , DETAIL.P_PDE_INTERMEDIATE_QUANTITY_SU
       , DETAIL.P_PDE_FINAL_QUANTITY
       , DETAIL.P_PDE_FINAL_QUANTITY_SU
       , DETAIL.NEED_FAN_EXCEED_QTY
       , DETAIL.NEED_FAN_FREE_QTY
       , DETAIL.NEED_FAN_FULL_QTY
       , DETAIL.NEED_FAN_NETW_QTY
       , DETAIL.NEED_FAN_PREV_QTY
       , DETAIL.NEED_FAN_REALIZE_QTY
       , DETAIL.NEED_FAN_RETURN_QTY
       , DETAIL.NEED_FAN_STK_QTY
       , DETAIL.NEED_FAL_NETWORK_NEED_ID
       , DETAIL.SUPPLY_FAN_EXCEED_QTY
       , DETAIL.SUPPLY_FAN_FREE_QTY
       , DETAIL.SUPPLY_FAN_FULL_QTY
       , DETAIL.SUPPLY_FAN_NETW_QTY
       , DETAIL.SUPPLY_FAN_PREV_QTY
       , DETAIL.SUPPLY_FAN_REALIZE_QTY
       , DETAIL.SUPPLY_FAN_RETURN_QTY
       , DETAIL.SUPPLY_FAN_STK_QTY
       , DETAIL.SUPPLY_FAL_NETWORK_SUPPLY_ID
       , DETAIL.LOT_REFCOMPL
       , DETAIL.GOO_MAJOR_REFERENCE COMP_MAJOR_REFERENCE
       , DETAIL.SCS_SHORT_DESCR
       , DETAIL.SCS_LONG_DESCR
       , DETAIL.SCS_FREE_DESCR
       , FOO.FOO_TOTAL_NET_WEIGHT_MEAS
       , FOO.FOO_TOTAL_GROSS_WEIGHT_MEAS
       , POS.POS_TARIFF_SET
       , DMT.DOC_RECORD_ID
       , REC.RCO_SUPPLIER_SERIAL_NUMBER
       , DMT.PAC_THIRD_ACI_ID
       , DMT.PAC_THIRD_DELIVERY_ID
       , DMT.PAC_THIRD_TARIFF_ID
       , DMT.PAC_REPR_ACI_ID
       , DMT.PAC_REPR_DELIVERY_ID
       , DMT.PC_LANG_ACI_ID
       , DMT.PC_LANG_DELIVERY_ID
       , DMT.DMT_NAME1
       , DMT.DMT_FORENAME1
       , DMT.DMT_ACTIVITY1
       , DMT.DMT_CARE_OF1
       , DMT.DMT_PO_BOX1
       , DMT.DMT_PO_BOX_NBR1
       , DMT.DMT_COUNTY1
       , DMT.DMT_CONTACT1
       , DMT.DMT_NAME2
       , DMT.DMT_FORENAME2
       , DMT.DMT_ACTIVITY2
       , DMT.DMT_CARE_OF2
       , DMT.DMT_PO_BOX2
       , DMT.DMT_PO_BOX_NBR2
       , DMT.DMT_COUNTY2
       , DMT.DMT_CONTACT2
       , DMT.DMT_NAME3
       , DMT.DMT_FORENAME3
       , DMT.DMT_ACTIVITY3
       , DMT.DMT_CARE_OF3
       , DMT.DMT_PO_BOX3
       , DMT.DMT_PO_BOX_NBR3
       , DMT.DMT_COUNTY3
       , DMT.DMT_CONTACT3
       , case
           when nvl(DMT.DMT_PO_BOX2, nvl(DMT.DMT_PO_BOX1, 0) ) = nvl(DMT.DMT_PO_BOX1, 0)
           and nvl(DMT.DMT_PO_BOX_NBR2, nvl(DMT.DMT_PO_BOX_NBR1, 0) ) = nvl(DMT.DMT_PO_BOX_NBR1, 0)
           and nvl(DMT.DMT_COUNTY2, nvl(DMT.DMT_COUNTY1, 0) ) = nvl(DMT.DMT_COUNTY1, 0)
           and nvl(DMT.DMT_ADDRESS2, nvl(DMT.DMT_ADDRESS1, 0) ) = nvl(DMT.DMT_ADDRESS1, 0)
           and nvl(DMT.DMT_FORMAT_CITY2, nvl(DMT.DMT_FORMAT_CITY1, 0) ) = nvl(DMT.DMT_FORMAT_CITY1, 0)
           and nvl(DMT.DMT_TOWN2, nvl(DMT.DMT_TOWN1, 0) ) = nvl(DMT.DMT_TOWN1, 0)
           and nvl(CNT2.CNTID, nvl(CNT.CNTID, 0) ) = nvl(CNT.CNTID, 0) then 1
           else 0
         end ADR_DO_LIKE_LIVR
       , case
           when nvl(DMT.DMT_PO_BOX3, nvl(DMT.DMT_PO_BOX1, 0) ) = nvl(DMT.DMT_PO_BOX1, 0)
           and nvl(DMT.DMT_PO_BOX_NBR3, nvl(DMT.DMT_PO_BOX_NBR1, 0) ) = nvl(DMT.DMT_PO_BOX_NBR1, 0)
           and nvl(DMT.DMT_COUNTY3, nvl(DMT.DMT_COUNTY1, 0) ) = nvl(DMT.DMT_COUNTY1, 0)
           and nvl(DMT.DMT_ADDRESS3, nvl(DMT.DMT_ADDRESS1, 0) ) = nvl(DMT.DMT_ADDRESS1, 0)
           and nvl(DMT.DMT_FORMAT_CITY3, nvl(DMT.DMT_FORMAT_CITY1, 0) ) = nvl(DMT.DMT_FORMAT_CITY1, 0)
           and nvl(DMT.DMT_TOWN3, nvl(DMT.DMT_TOWN1, 0) ) = nvl(DMT.DMT_TOWN1, 0)
           and nvl(CNT3.CNTID, nvl(CNT.CNTID, 0) ) = nvl(CNT.CNTID, 0) then 1
           else 0
         end ADR_DO_LIKE_FACT
       , REC_PDE.RCO_TITLE PDE_RCO_TITLE
       , REC_PDE.RCO_SUPPLIER_SERIAL_NUMBER PDE_RCO_SUPPLIER_SERIAL_NUMBER
       , POS.CML_EVENTS_ID
       , CEV.ASA_COUNTER_STATEMENT_ID
       , CEV.CML_POSITION_SERVICE_DETAIL_ID
       , CEV.CML_POSITION_MACHINE_DETAIL_ID
       , CEV.CEV_COUNTER_BEGIN_QTY
       , CEV.CEV_COUNTER_END_QTY
       , CEV.CEV_COUNTER_BEGIN_DATE
       , CEV.CEV_COUNTER_END_DATE
       , CEV.CEV_FREE_QTY
       , CEV.CEV_GROSS_CONSUMED_QTY
       , CEV.CEV_NET_CONSUMED_QTY
       , CEV.CEV_BALANCE_QTY
       , CEV.CEV_INVOICING_QTY
       , CEV.CEV_GLOBAL_EVENT
       , CEV.CEV_RENEWAL_GENERATED
       , CPO.CML_POSITION_ID
       , CPO.CPO_SEQUENCE
       , CCO.CCO_NUMBER
       , case
           when POS.POS_ADDENDUM_SRC_POS_ID is null then 1
           else 0
         end POS_NEW
       , case
           when DETAIL.PDE_ADDENDUM_SRC_PDE_ID is null then 1
           else 0
         end PDE_NEW
       , case
           when POS_ADD.POS_BASIS_QUANTITY <> POS.POS_BASIS_QUANTITY then 1
           else 0
         end POS_BASIS_QTY_UPDATED
       , case
           when POS_ADD.POS_INTERMEDIATE_QUANTITY <> POS.POS_INTERMEDIATE_QUANTITY then 1
           else 0
         end POS_INTER_QTY_UPDATED
       , case
           when POS_ADD.POS_FINAL_QUANTITY <> POS.POS_FINAL_QUANTITY then 1
           else 0
         end POS_FINAL_QTY_UPDATED
       , case
           when POS_ADD.POS_NET_UNIT_VALUE <> POS.POS_NET_UNIT_VALUE then 1
           else 0
         end POS_PRICE_UPDATED
       , case
           when POS_ADD.POS_REFERENCE <> POS.POS_REFERENCE then 1
           else 0
         end POS_REF_UPDATED
       , case
           when POS_ADD.POS_SHORT_DESCRIPTION <> POS.POS_SHORT_DESCRIPTION then 1
           else 0
         end POS_SHORT_DES_UPDATED
       , case
           when POS_ADD.POS_LONG_DESCRIPTION <> POS.POS_LONG_DESCRIPTION then 1
           else 0
         end POS_LONG_DES_UPDATED
       , case
           when POS_ADD.POS_FREE_DESCRIPTION <> POS.POS_FREE_DESCRIPTION then 1
           else 0
         end POS_FREE_DES_UPDATED
       , case
           when PDE_ADD.PDE_BASIS_DELAY <> DETAIL.PDE_BASIS_DELAY then 1
           else 0
         end PDE_BASIS_DELAY_UPDATED
       , case
           when PDE_ADD.PDE_INTERMEDIATE_DELAY <> DETAIL.PDE_INTERMEDIATE_DELAY then 1
           else 0
         end PDE_INTER_DELAY_UPDATED
       , case
           when PDE_ADD.PDE_FINAL_DELAY <> DETAIL.PDE_FINAL_DELAY then 1
           else 0
         end PDE_FINAL_DELAY_UPDATED
    from PCS.PC_LANG LANG
       , STM_LOCATION LOC
       , STM_LOCATION LOC_LOC
       , ACS_FIN_ACC_S_PAYMENT AFA
       , ACS_PAYMENT_METHOD APM
       , ACS_ACCOUNT TVA
       , DOC_RECORD REC
       , DOC_RECORD REC_POS
       , DOC_RECORD REC_PDE
       , DOC_FOOT FOO
       , GCO_FREE_DATA GFD
       , GCO_CUSTOMS_ELEMENT GCE
       , PCS.PC_CNTRY CNT_CUSTOMS
       , PCS.PC_CNTRY CNT_ORIGIN
       , PAC_SENDING_CONDITION PSC
       , PAC_PAYMENT_CONDITION PMT
       , ACS_FINANCIAL_CURRENCY AFC
       , DOC_FREE_DATA DFD
       , DOC_GAUGE_SIGNATORY DGS
       , DOC_GAUGE_SIGNATORY DGS2
       , DOC_GAUGE_POSITION DGP
       , PAC_CUSTOM_PARTNER CUS
       , ACS_ACCOUNT ACCC
       , PAC_ADDRESS ADR
       , PAC_ADDRESS ADR2
       , PAC_ADDRESS ADR3
       , PAC_REPRESENTATIVE REP
       , PAC_REPRESENTATIVE REP_POS
       , PAC_ADDRESS ADR_SEN
       , PAC_PERSON PER_SEN
       , PAC_PERSON PER
       , PAC_PERSON PER2
       , PAC_PERSON PER3
       , PAC_SUPPLIER_PARTNER SUP
       , ACS_ACCOUNT ACCS
       , PAC_THIRD THI
       , ACS_TAX_CODE ATC
       , PCS.PC_CURR CUR
       , PCS.PC_CNTRY CNT
       , PCS.PC_CNTRY CNT2
       , PCS.PC_CNTRY CNT3
       , DOC_GAUGE GAU
       , DOC_GAUGE_STRUCTURED GST
       , STM_STOCK STM
       , STM_STOCK STM_STM
       , GCO_GOOD GOO
       , GCO_PRODUCT PDT
       , DOC_POSITION POS
       , DOC_DOCUMENT DMT
       , CML_EVENTS CEV
       , CML_POSITION CPO
       , CML_DOCUMENT CCO
       , DOC_POSITION POS_ADD
       , DOC_POSITION_DETAIL PDE_ADD
       , (select DMT.DMT_NUMBER
               , POS.DOC_POSITION_ID POSITIONID
               , PDE.DOC_POSITION_DETAIL_ID
               , (PDE.FAL_SCHEDULE_STEP_ID) FAL_SCHEDULE_STEP_ID
               , (DMT_PERE.DMT_NUMBER) PERE_DMT_NUMBER
               , (DMT_PERE.DMT_DATE_DOCUMENT) PERE_DMT_DATE_DOCUMENT
               , (GAU_PERE.C_GAUGE_TITLE) PERE_C_GAUGE_TITLE
               , (DMT_PERE.DMT_PARTNER_NUMBER) PERE_DMT_PARTNER_NUMBER
               , (DMT_PERE.DMT_PARTNER_REFERENCE) PERE_DMT_PARTNTER_REFERENCE
               , (DMT_PERE.DMT_DATE_PARTNER_DOCUMENT) PERE_DATE_PARTNER_DOCUMENT
               , (DMT_G_PERE.DMT_NUMBER) G_PERE_DMT_NUMBER
               , (DMT_G_PERE.DMT_DATE_DOCUMENT) G_PERE_DMT_DATE_DOCUMENT
               , (GAU_G_PERE.C_GAUGE_TITLE) G_PERE_C_GAUGE_TITLE
               , (DMT_G_PERE.DMT_PARTNER_NUMBER) G_PERE_DMT_PARTNER_NUMBER
               , (DMT_G_PERE.DMT_PARTNER_REFERENCE) G_PERE_DMT_PARTNTER_REFERENCE
               , (DMT_G_PERE.DMT_DATE_PARTNER_DOCUMENT) G_PERE_DATE_PARTNER_DOCUMENT
               , (PDE.STM_LOCATION_ID) STM_LOCATION_ID
               , (PDE.STM_STM_LOCATION_ID) STM_STM_LOCATION_ID
               , (PDE.DIC_DELAY_UPDATE_TYPE_ID) DIC_DELAY_UPDATE_TYPE_ID
               , (PDE.PDE_DELAY_UPDATE_TEXT) PDE_DELAY_UPDATE_TEXT
               , PDE.GCO_CHARACTERIZATION_ID GCO1_CHARACTERIZATION_ID
               , PDE.GCO_GCO_CHARACTERIZATION_ID GCO2_CHARACTERIZATION_ID
               , PDE.GCO2_GCO_CHARACTERIZATION_ID GCO3_CHARACTERIZATION_ID
               , PDE.GCO3_GCO_CHARACTERIZATION_ID GCO4_CHARACTERIZATION_ID
               , PDE.GCO4_GCO_CHARACTERIZATION_ID GCO5_CHARACTERIZATION_ID
               , (PDE.PDE_CHARACTERIZATION_VALUE_1) PDE_CHARACTERIZATION_VALUE_1
               , (PDE.PDE_CHARACTERIZATION_VALUE_2) PDE_CHARACTERIZATION_VALUE_2
               , (PDE.PDE_CHARACTERIZATION_VALUE_3) PDE_CHARACTERIZATION_VALUE_3
               , (PDE.PDE_CHARACTERIZATION_VALUE_4) PDE_CHARACTERIZATION_VALUE_4
               , (PDE.PDE_CHARACTERIZATION_VALUE_5) PDE_CHARACTERIZATION_VALUE_5
               , PDE.PDE_PIECE
               , PDE.PDE_SET
               , PDE.PDE_VERSION
               , PDE.PDE_CHRONOLOGICAL
               , PDE.PDE_STD_CHAR_1
               , PDE.PDE_STD_CHAR_2
               , PDE.PDE_STD_CHAR_3
               , PDE.PDE_STD_CHAR_4
               , PDE.PDE_STD_CHAR_5
               , (PDE.PDE_BASIS_DELAY) PDE_BASIS_DELAY
               , (PDE.PDE_BASIS_DELAY_M) PDE_BASIS_DELAY_M
               , (PDE.PDE_BASIS_DELAY_W) PDE_BASIS_DELAY_W
               , (PDE.PDE_BASIS_QUANTITY) PDE_BASIS_QUANTITY
               , (PDE.PDE_BASIS_QUANTITY_SU) PDE_BASIS_QUANTITY_SU
               , (PDE.PDE_INTERMEDIATE_DELAY) PDE_INTERMEDIATE_DELAY
               , (PDE.PDE_INTERMEDIATE_DELAY_M) PDE_INTERMEDIATE_DELAY_M
               , (PDE.PDE_INTERMEDIATE_DELAY_W) PDE_INTERMEDIATE_DELAY_W
               , (PDE.PDE_INTERMEDIATE_QUANTITY) PDE_INTERMEDIATE_QUANTITY
               , (PDE.PDE_INTERMEDIATE_QUANTITY_SU) PDE_INTERMEDIATE_QUANTITY_SU
               , (PDE.PDE_FINAL_DELAY) PDE_FINAL_DELAY
               , (PDE.PDE_FINAL_DELAY_M) PDE_FINAL_DELAY_M
               , (PDE.PDE_FINAL_DELAY_W) PDE_FINAL_DELAY_W
               , (PDE.PDE_FINAL_QUANTITY) PDE_FINAL_QUANTITY
               , (PDE.PDE_FINAL_QUANTITY_SU) PDE_FINAL_QUANTITY_SU
               , case
                   when(DMT.DMT_ADDENDUM_INDEX is not null)
                   and (POS.C_DOC_POS_STATUS = '04') then PDE.PDE_ADDENDUM_QTY_BALANCED
                   else PDE.PDE_BALANCE_QUANTITY
                 end PDE_BALANCE_QUANTITY
               , (PERE.DOC_POSITION_DETAIL_ID) PERE_DOC_POSITION_DETAIL_ID
               , (PERE.PDE_BALANCE_QUANTITY) P_PDE_BALANCE_QUANTITY
               , (PERE.PDE_BALANCE_QUANTITY_PARENT) P_PDE_BALANCE_QUANTITY_PARENT
               , (PERE.PDE_BASIS_QUANTITY) P_PDE_BASIS_QUANTITY
               , (PERE.PDE_BASIS_QUANTITY_SU) P_PDE_BASIS_QUANTITY_SU
               , (PERE.PDE_INTERMEDIATE_QUANTITY) P_PDE_INTERMEDIATE_QUANTITY
               , (PERE.PDE_INTERMEDIATE_QUANTITY_SU) P_PDE_INTERMEDIATE_QUANTITY_SU
               , (PERE.PDE_FINAL_QUANTITY) P_PDE_FINAL_QUANTITY
               , (PERE.PDE_FINAL_QUANTITY_SU) P_PDE_FINAL_QUANTITY_SU
               , (G_PERE.DOC_POSITION_DETAIL_ID) G_PERE_DOC_POSITION_DETAIL_ID
               , (NEE.FAN_EXCEED_QTY) NEED_FAN_EXCEED_QTY
               , (NEE.FAN_FREE_QTY) NEED_FAN_FREE_QTY
               , (NEE.FAN_FULL_QTY) NEED_FAN_FULL_QTY
               , (NEE.FAN_NETW_QTY) NEED_FAN_NETW_QTY
               , (NEE.FAN_PREV_QTY) NEED_FAN_PREV_QTY
               , (NEE.FAN_REALIZE_QTY) NEED_FAN_REALIZE_QTY
               , (NEE.FAN_RETURN_QTY) NEED_FAN_RETURN_QTY
               , (NEE.FAN_STK_QTY) NEED_FAN_STK_QTY
               , (NEE.FAL_NETWORK_NEED_ID) NEED_FAL_NETWORK_NEED_ID
               , (SUPP.FAN_EXCEED_QTY) SUPPLY_FAN_EXCEED_QTY
               , (SUPP.FAN_FREE_QTY) SUPPLY_FAN_FREE_QTY
               , (SUPP.FAN_FULL_QTY) SUPPLY_FAN_FULL_QTY
               , (SUPP.FAN_NETW_QTY) SUPPLY_FAN_NETW_QTY
               , (SUPP.FAN_PREV_QTY) SUPPLY_FAN_PREV_QTY
               , (SUPP.FAN_REALIZE_QTY) SUPPLY_FAN_REALIZE_QTY
               , (SUPP.FAN_RETURN_QTY) SUPPLY_FAN_RETURN_QTY
               , (SUPP.FAN_STK_QTY) SUPPLY_FAN_STK_QTY
               , (SUPP.FAL_NETWORK_SUPPLY_ID) SUPPLY_FAL_NETWORK_SUPPLY_ID
               , (LOT.LOT_REFCOMPL) LOT_REFCOMPL
               , (COMP.GOO_MAJOR_REFERENCE) GOO_MAJOR_REFERENCE
               , (LNK.SCS_SHORT_DESCR) SCS_SHORT_DESCR
               , (LNK.SCS_LONG_DESCR) SCS_LONG_DESCR
               , (LNK.SCS_FREE_DESCR) SCS_FREE_DESCR
               , PDE.DOC_RECORD_ID
               , PDE.PDE_ADDENDUM_SRC_PDE_ID
            from FAL_NETWORK_NEED NEE
               , FAL_NETWORK_SUPPLY SUPP
               , FAL_TASK_LINK LNK
               , FAL_LOT LOT
               , GCO_GOOD COMP
               , DOC_GAUGE_STRUCTURED GAU_G_PERE
               , DOC_GAUGE_STRUCTURED GAU_PERE
               , DOC_POSITION_DETAIL G_PERE
               , DOC_POSITION_DETAIL PERE
               , DOC_POSITION_DETAIL PDE
               , DOC_DOCUMENT DMT_G_PERE
               , DOC_DOCUMENT DMT_PERE
               , DOC_POSITION POS
               , DOC_DOCUMENT DMT
           where DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
             and POS.DOC_POSITION_ID = PDE.DOC_POSITION_ID(+)
             and PDE.DOC_DOC_POSITION_DETAIL_ID = PERE.DOC_POSITION_DETAIL_ID(+)
             and PERE.DOC_DOCUMENT_ID = DMT_PERE.DOC_DOCUMENT_ID(+)
             and PERE.DOC_DOC_POSITION_DETAIL_ID = G_PERE.DOC_POSITION_DETAIL_ID(+)
             and PDE.FAL_SCHEDULE_STEP_ID = LNK.FAL_SCHEDULE_STEP_ID(+)
             and LNK.FAL_LOT_ID = LOT.FAL_LOT_ID(+)
             and LOT.GCO_GOOD_ID = COMP.GCO_GOOD_ID(+)
             and PERE.DOC_GAUGE_ID = GAU_PERE.DOC_GAUGE_ID(+)
             and G_PERE.DOC_DOCUMENT_ID = DMT_G_PERE.DOC_DOCUMENT_ID(+)
             and G_PERE.DOC_GAUGE_ID = GAU_G_PERE.DOC_GAUGE_ID(+)
             and PDE.DOC_POSITION_DETAIL_ID = NEE.DOC_POSITION_DETAIL_ID(+)
             and PDE.DOC_POSITION_DETAIL_ID = SUPP.DOC_POSITION_DETAIL_ID(+)) DETAIL
   where DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
     and POS.DOC_POSITION_ID = DETAIL.POSITIONID(+)
     and DMT.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
     and GAU.DOC_GAUGE_ID = GST.DOC_GAUGE_ID
     and POS.DOC_GAUGE_POSITION_ID = DGP.DOC_GAUGE_POSITION_ID
     and DMT.PC_LANG_ID = LANG.PC_LANG_ID
     and POS.ACS_TAX_CODE_ID = TVA.ACS_ACCOUNT_ID(+)
     and DMT.ACS_FIN_ACC_S_PAYMENT_ID = AFA.ACS_FIN_ACC_S_PAYMENT_ID(+)
     and AFA.ACS_PAYMENT_METHOD_ID = APM.ACS_PAYMENT_METHOD_ID(+)
     and DMT.PAC_REPRESENTATIVE_ID = REP.PAC_REPRESENTATIVE_ID(+)
     and DMT.DOC_DOCUMENT_ID = DFD.DOC_DOCUMENT_ID(+)
     and DMT.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID(+)
     and POS.ACS_TAX_CODE_ID = ATC.ACS_TAX_CODE_ID(+)
     and POS.GCO_GOOD_ID = GCE.GCO_GOOD_ID(+)
     and GCE.PC_CNTRY_ID = CNT_CUSTOMS.PC_CNTRY_ID(+)
     and GCE.PC_ORIGIN_PC_CNTRY_ID = CNT_ORIGIN.PC_CNTRY_ID(+)
     and GCE.C_CUSTOMS_ELEMENT_TYPE(+) = 'EXPORT'
     and POS.PAC_REPRESENTATIVE_ID = REP_POS.PAC_REPRESENTATIVE_ID(+)
     and FOO.DOC_GAUGE_SIGNATORY_ID = DGS.DOC_GAUGE_SIGNATORY_ID(+)
     and FOO.DOC_DOC_GAUGE_SIGNATORY_ID = DGS2.DOC_GAUGE_SIGNATORY_ID(+)
     and DMT.DOC_RECORD_ID = REC.DOC_RECORD_ID(+)
     and POS.DOC_RECORD_ID = REC_POS.DOC_RECORD_ID(+)
     and DETAIL.DOC_RECORD_ID = REC_PDE.DOC_RECORD_ID(+)
     and DMT.PAC_SENDING_CONDITION_ID = PSC.PAC_SENDING_CONDITION_ID(+)
     and PSC.PAC_ADDRESS_ID = ADR_SEN.PAC_ADDRESS_ID(+)
     and ADR_SEN.PAC_PERSON_ID = PER_SEN.PAC_PERSON_ID(+)
     and DMT.PAC_THIRD_ID = THI.PAC_THIRD_ID(+)
     and DMT.PAC_THIRD_ID = CUS.PAC_CUSTOM_PARTNER_ID(+)
     and CUS.ACS_AUXILIARY_ACCOUNT_ID = ACCC.ACS_ACCOUNT_ID(+)
     and SUP.ACS_AUXILIARY_ACCOUNT_ID = ACCS.ACS_ACCOUNT_ID(+)
     and DMT.PAC_THIRD_ID = SUP.PAC_SUPPLIER_PARTNER_ID(+)
     and DMT.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID(+)
     and ADR.PAC_PERSON_ID = PER.PAC_PERSON_ID(+)
     and DMT.PAC_PAC_ADDRESS_ID = ADR2.PAC_ADDRESS_ID(+)
     and ADR2.PAC_PERSON_ID = PER2.PAC_PERSON_ID(+)
     and DMT.PAC2_PAC_ADDRESS_ID = ADR3.PAC_ADDRESS_ID(+)
     and ADR3.PAC_PERSON_ID = PER3.PAC_PERSON_ID(+)
     and DMT.PC_CNTRY_ID = CNT.PC_CNTRY_ID(+)
     and DMT.PC__PC_CNTRY_ID = CNT2.PC_CNTRY_ID(+)
     and DMT.PC_2_PC_CNTRY_ID = CNT3.PC_CNTRY_ID(+)
     and DMT.ACS_FINANCIAL_CURRENCY_ID = AFC.ACS_FINANCIAL_CURRENCY_ID(+)
     and AFC.PC_CURR_ID = CUR.PC_CURR_ID(+)
     and DMT.PAC_PAYMENT_CONDITION_ID = PMT.PAC_PAYMENT_CONDITION_ID(+)
     and DETAIL.STM_LOCATION_ID = LOC.STM_LOCATION_ID(+)
     and DETAIL.STM_STM_LOCATION_ID = LOC_LOC.STM_LOCATION_ID(+)
     and LOC.STM_STOCK_ID = STM.STM_STOCK_ID(+)
     and LOC_LOC.STM_STOCK_ID = STM_STM.STM_STOCK_ID(+)
     and POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID(+)
     and GOO.GCO_GOOD_ID = PDT.GCO_GOOD_ID(+)
     and GOO.GCO_GOOD_ID = GFD.GCO_GOOD_ID(+)
     and POS.CML_EVENTS_ID = CEV.CML_EVENTS_ID(+)
     and POS.CML_POSITION_ID = CPO.CML_POSITION_ID(+)
     and CPO.CML_DOCUMENT_ID = CCO.CML_DOCUMENT_ID(+)
     and POS.POS_ADDENDUM_SRC_POS_ID = POS_ADD.DOC_POSITION_ID(+)
     and PDE_ADD.DOC_POSITION_DETAIL_ID(+) = DETAIL.PDE_ADDENDUM_SRC_PDE_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_4_PRNT_NOENV" ("DOC_DOCUMENT_ID", "DOCNUMBER", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_VALUE", "DMT_DATE_FALLING_DUE", "DMT_DATE_DELIVERY", "C_DOCUMENT_STATUS", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_DATE_PARTNER_DOCUMENT", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DIC_DOC_FREE_1_ID", "DIC_DOC_FREE_2_ID", "DIC_DOC_FREE_3_ID", "DIC_TYPE_SUBMISSION_ID", "DOC_DIC_POS_FREE_TABLE_1_ID", "DOC_DIC_POS_FREE_TABLE_2_ID", "DOC_DIC_POS_FREE_TABLE_3_ID", "DMT_DECIMAL_1", "DMT_DECIMAL_2", "DMT_DECIMAL_3", "DMT_TEXT_1", "DMT_TEXT_2", "DMT_TEXT_3", "DMT_DATE_1", "DMT_DATE_2", "DMT_DATE_3", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "DMT_GAU_FREE_NUMBER1", "DMT_GAU_FREE_NUMBER2", "DMT_GAU_FREE_DATE1", "DMT_GAU_FREE_DATE2", "DMT_GAU_FREE_TEXT_LONG", "DMT_GAU_FREE_TEXT_SHORT", "DMT_GAU_FREE_BOOL1", "DMT_GAU_FREE_BOOL2", "DIC_TARIFF_ID", "C_INCOTERMS", "DMT_INCOTERMS_PLACE", "PAC_REPRESENTATIVE_ID", "REP_DESCR", "DIC_ACCOUNTABLE_GROUP_ID", "RCO_TITLE", "RCO_DESCRIPTION", "PAC_THIRD_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_INTRA", "THI_NO_TVA", "THI_NO_SIREN", "THI_NO_SIRET", "THI_NO_FORMAT", "C_DELIVERY_TYP", "CUS_SUPPLIER_NUMBER", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "DIC_TYPE_PARTNER_ID", "CRE_CUSTOMER_NUMBER", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "DIC_TYPE_PARTNER_F_ID", "PAC_SENDING_CONDITION_ID", "SENDING_ADDRESS_ID", "SEN_PER_NAME", "SEN_PER_FORENAME", "SEN_PER_ACTIVITY", "SEN_PER_COMMENT", "SEN_PER_KEY1", "SEN_PER_KEY2", "SEN_ADD_ADDRESS1", "SEN_ADD_FORMAT", "ACS_PAYMENT_METHOD_ID", "CUSTOMER_ACCOUNT", "SUPPLIER_ACCOUNT", "PC_LANG_ID", "PAC_PAYMENT_CONDITION_ID", "PCO_DESCR", "PMT_PC_APPLTXT_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "CURRNAME", "LANID", "ADDRESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "DMT_TOWN1", "CNTID", "CNTNAME", "DIC_PC_CNTRY_GRP_ID", "CNT_CE_CODE", "CNT_CE_MEMBER", "ADDRESS2_ID", "PER2_NAME", "PER2_FORENAME", "PER2_ACTIVITY", "PER2_COMMENT", "PER2_KEY1", "PER2_KEY2", "DMT_ADDRESS2", "DMT_FORMAT_CITY2", "DMT_TOWN2", "CNTID2", "CNTNAME2", "DIC_PC_CNTRY_GRP_ID2", "CNT_CE_CODE2", "CNT_CE_MEMBER2", "ADDRESS3_ID", "PER3_NAME", "PER3_FORENAME", "PER3_ACTIVITY", "PER3_COMMENT", "PER3_KEY1", "PER3_KEY2", "DMT_ADDRESS3", "DMT_FORMAT_CITY3", "DMT_TOWN3", "CNTID3", "CNTNAME3", "DIC_PC_CNTRY_GRP_ID3", "CNT_CE_CODE3", "CNT_CE_MEMBER3", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "C_ADMIN_DOMAIN", "DIC_GAUGE_TYPE_DOC_ID", "DIC_DOC_FREE_TABLE_1_ID", "DIC_DOC_FREE_TABLE_2_ID", "DIC_DOC_FREE_TABLE_3_ID", "DIC_DOC_FREE_TABLE_4_ID", "DIC_DOC_FREE_TABLE_5_ID", "FRD_ALPHA_SHORT_1", "FRD_ALPHA_SHORT_2", "FRD_ALPHA_SHORT_3", "FRD_ALPHA_SHORT_4", "FRD_ALPHA_SHORT_5", "FRD_ALPHA_LONG_1", "FRD_ALPHA_LONG_2", "FRD_ALPHA_LONG_3", "FRD_ALPHA_LONG_4", "FRD_ALPHA_LONG_5", "FRD_INTEGER_1", "FRD_INTEGER_2", "FRD_INTEGER_3", "FRD_INTEGER_4", "FRD_INTEGER_5", "FRD_DECIMAL_1", "FRD_DECIMAL_2", "FRD_DECIMAL_3", "FRD_DECIMAL_4", "FRD_DECIMAL_5", "FRD_BOOLEAN_1", "FRD_BOOLEAN_2", "FRD_BOOLEAN_3", "FRD_BOOLEAN_4", "FRD_BOOLEAN_5", "DOC_FOOT_ID", "DOC_GAUGE_SIGNATORY_ID", "GAG_NAME", "GAG_FUNCTION", "DOC_DOC_GAUGE_SIGNATORY_ID", "GAG2_NAME", "GAG2_FUNCTION", "FOO_FOOT_TEXT", "FOO_FOOT_TEXT2", "FOO_FOOT_TEXT3", "FOO_FOOT_TEXT4", "FOO_FOOT_TEXT5", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT", "FOO_TOTAL_VAT_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "FOO_REF_BVR_NUMBER", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_PAID_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "DIC_TYPE_DOC_CUSTOM_ID", "C_DIRECTION_NUMBER", "FOO_TOT_VAT_AMOUNT_V", "FOO_RECEIVED_AMOUNT", "FOO_PAID_BALANCED_AMOUNT", "DOC_POSITION_ID", "POS_NUMBER", "C_DOC_POS_STATUS", "C_GAUGE_TYPE_POS", "GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOOD_NUMBER_OF_DECIMAL", "GOO_NUMBER_OF_DECIMAL", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_MODEL_ID", "DIC_GOOD_GROUP_ID", "PDT_STOCK_MANAGEMENT", "C_GAUGE_SHOW_DELAY", "GAP_POS_DELAY", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "ASA_RECORD_ID", "ASA_RECORD_TASK_ID", "ASA_RECORD_COMP_ID", "TVA_ACC_NUMBER", "POS_RCO_TITLE", "POS_DIC_ACCOUNTABLE_GROUP_ID", "POS_RCO_DESCRIPTION", "POS_PAC_REPRESENTATIVE_ID", "POS_REP_DESCR", "CUS_CUSTONS_POSITION", "CUS_KEY_TARIFF", "CUS_LICENCE_NUMBER", "CUS_RATE_FOR_VALUE", "CUS_TRANSPORT_INFORMATION", "DIC_REPAYMENT_CODE_ID", "DIC_SUBJUGATED_LICENCE_ID", "CNTID_CUSTOMS", "CNTNAME_CUSTOMS", "DIC_PC_CNTRY_GRP_ID_CUSTOMS", "CNT_CE_CODE_CUSTOMS", "CNT_CE_MEMBER_CUSTOMS", "CNTID_ORIGIN", "CNTNAME_ORIGIN", "DIC_PC_CNTRY_GRP_ID_ORIGIN", "CNT_CE_CODE_ORIGIN", "CNT_CE_MEMBER_ORIGIN", "DATA_UNIT_PRICE_SALE", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_GROSS_UNIT_VALUE", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_REF_UNIT_VALUE", "POS_GROSS_VALUE", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_INCL", "POS_BASIS_QUANTITY", "POS_INTERMEDIATE_QUANTITY", "POS_FINAL_QUANTITY", "POS_BALANCE_QUANTITY", "POS_RATE_FACTOR", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "DIC_UNIT_OF_MEASURE_ID", "POS_NOM_TEXT", "POS_UNIT_COST_PRICE", "POS_EAN_CODE", "POS_EAN_UCC14_CODE", "POS_HIBC_PRIMARY_CODE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "POS_VALUE_QUANTITY", "POS_INCLUDE_TAX_TARIFF", "POS_GROSS_UNIT_VALUE_INCL", "POS_GROSS_VALUE_INCL", "POS_BALANCE_QTY_VALUE", "POS_UTIL_COEFF", "POS_GROSS_UNIT_VALUE2", "DIC_DIC_UNIT_OF_MEASURE_ID", "POS_CONVERT_FACTOR2", "POS_VAT_AMOUNT_V", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY_SU", "C_POS_DELIVERY_TYP", "POS_BALANCED", "PERE_DMT_NUMBER", "PERE_DMT_DATE_DOCUMENT", "PERE_C_GAUGE_TITLE", "PERE_DMT_PARTNER_NUMBER", "PERE_DMT_PARTNTER_REFERENCE", "PERE_DATE_PARTNER_DOCUMENT", "G_PERE_DMT_NUMBER", "G_PERE_DMT_DATE_DOCUMENT", "G_PERE_C_GAUGE_TITLE", "G_PERE_DMT_PARTNER_NUMBER", "G_PERE_DMT_PARTNTER_REFERENCE", "G_PERE_DATE_PARTNER_DOCUMENT", "STM_LOCATION_ID", "LOC_DESCRIPTION", "STO_DESCRIPTION", "STM_STM_LOCATION_ID", "LOC_LOC_DESCRIPTION", "STO_STO_DESCRIPTION", "DIC_DELAY_UPDATE_TYPE_ID", "PDE_DELAY_UPDATE_TEXT", "GCO1_CHARACTERIZATION_ID", "GCO2_CHARACTERIZATION_ID", "GCO3_CHARACTERIZATION_ID", "GCO4_CHARACTERIZATION_ID", "GCO5_CHARACTERIZATION_ID", "GCO1_CHARAC_DESCR", "GCO2_CHARAC_DESCR", "GCO3_CHARAC_DESCR", "GCO4_CHARAC_DESCR", "GCO5_CHARAC_DESCR", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "PDE_PIECE", "PDE_SET", "PDE_VERSION", "PDE_CHRONOLOGICAL", "PDE_STD_CHAR_1", "PDE_STD_CHAR_2", "PDE_STD_CHAR_3", "PDE_STD_CHAR_4", "PDE_STD_CHAR_5", "PDE_BASIS_DELAY", "PDE_BASIS_DELAY_M", "PDE_BASIS_DELAY_W", "PDE_BASIS_QUANTITY", "PDE_BASIS_QUANTITY_SU", "PDE_INTERMEDIATE_DELAY", "PDE_INTERMEDIATE_DELAY_M", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_QUANTITY", "PDE_INTERMEDIATE_QUANTITY_SU", "PDE_FINAL_DELAY", "PDE_FINAL_DELAY_M", "PDE_FINAL_DELAY_W", "PDE_FINAL_QUANTITY", "PDE_FINAL_QUANTITY_SU", "PDE_BALANCE_QUANTITY", "P_PDE_BALANCE_QUANTITY", "P_PDE_BALANCE_QUANTITY_PARENT", "P_PDE_BASIS_QUANTITY", "P_PDE_BASIS_QUANTITY_SU", "P_PDE_INTERMEDIATE_QUANTITY", "P_PDE_INTERMEDIATE_QUANTITY_SU", "P_PDE_FINAL_QUANTITY", "P_PDE_FINAL_QUANTITY_SU", "NEED_FAN_EXCEED_QTY", "NEED_FAN_FREE_QTY", "NEED_FAN_FULL_QTY", "NEED_FAN_NETW_QTY", "NEED_FAN_PREV_QTY", "NEED_FAN_REALIZE_QTY", "NEED_FAN_RETURN_QTY", "NEED_FAN_STK_QTY", "NEED_FAL_NETWORK_NEED_ID", "SUPPLY_FAN_EXCEED_QTY", "SUPPLY_FAN_FREE_QTY", "SUPPLY_FAN_FULL_QTY", "SUPPLY_FAN_NETW_QTY", "SUPPLY_FAN_PREV_QTY", "SUPPLY_FAN_REALIZE_QTY", "SUPPLY_FAN_RETURN_QTY", "SUPPLY_FAN_STK_QTY", "SUPPLY_FAL_NETWORK_SUPPLY_ID") AS
  select DMT.DOC_DOCUMENT_ID
       , DMT.DMT_NUMBER DOCNUMBER
       , DETAIL.DMT_NUMBER
       , DMT.DMT_DATE_DOCUMENT
       , DMT.DMT_DATE_VALUE
       , DMT.DMT_DATE_FALLING_DUE
       , DMT.DMT_DATE_DELIVERY
       , DMT.C_DOCUMENT_STATUS
       , DMT.DMT_PARTNER_NUMBER
       , DMT.DMT_PARTNER_REFERENCE
       , DMT.DMT_DATE_PARTNER_DOCUMENT
       , DMT.DMT_REFERENCE
       , DMT.DMT_TITLE_TEXT
       , DMT.DMT_HEADING_TEXT
       , DMT.DMT_DOCUMENT_TEXT
       , DMT.DIC_DOC_FREE_1_ID
       , DMT.DIC_DOC_FREE_2_ID
       , DMT.DIC_DOC_FREE_3_ID
       , DMT.DIC_TYPE_SUBMISSION_ID
       , DMT.DIC_POS_FREE_TABLE_1_ID DOC_DIC_POS_FREE_TABLE_1_ID
       , DMT.DIC_POS_FREE_TABLE_2_ID DOC_DIC_POS_FREE_TABLE_2_ID
       , DMT.DIC_POS_FREE_TABLE_3_ID DOC_DIC_POS_FREE_TABLE_3_ID
       , DMT.DMT_DECIMAL_1
       , DMT.DMT_DECIMAL_2
       , DMT.DMT_DECIMAL_3
       , DMT.DMT_TEXT_1
       , DMT.DMT_TEXT_2
       , DMT.DMT_TEXT_3
       , DMT.DMT_DATE_1
       , DMT.DMT_DATE_2
       , DMT.DMT_DATE_3
       , DMT.DIC_GAUGE_FREE_CODE_1_ID
       , DMT.DIC_GAUGE_FREE_CODE_2_ID
       , DMT.DIC_GAUGE_FREE_CODE_3_ID
       , DMT.DMT_GAU_FREE_NUMBER1
       , DMT.DMT_GAU_FREE_NUMBER2
       , DMT.DMT_GAU_FREE_DATE1
       , DMT.DMT_GAU_FREE_DATE2
       , DMT.DMT_GAU_FREE_TEXT_LONG
       , DMT.DMT_GAU_FREE_TEXT_SHORT
       , DMT.DMT_GAU_FREE_BOOL1
       , DMT.DMT_GAU_FREE_BOOL2
       , DMT.DIC_TARIFF_ID
       , DMT.C_INCOTERMS
       , DMT.DMT_INCOTERMS_PLACE
       , REP.PAC_REPRESENTATIVE_ID
       , REP.REP_DESCR
       , REC.DIC_ACCOUNTABLE_GROUP_ID
       , REC.RCO_TITLE
       , REC.RCO_DESCRIPTION
       , DMT.PAC_THIRD_ID
       , THI.DIC_THIRD_ACTIVITY_ID
       , THI.DIC_THIRD_AREA_ID
       , THI.THI_NO_INTRA
       , THI.THI_NO_TVA
       , THI.THI_NO_SIREN
       , THI.THI_NO_SIRET
       , THI.THI_NO_FORMAT
       , CUS.C_DELIVERY_TYP
       , CUS.CUS_SUPPLIER_NUMBER
       , CUS.CUS_FREE_ZONE1
       , CUS.CUS_FREE_ZONE2
       , CUS.CUS_FREE_ZONE3
       , CUS.CUS_FREE_ZONE4
       , CUS.CUS_FREE_ZONE5
       , CUS.DIC_STATISTIC_1_ID
       , CUS.DIC_STATISTIC_2_ID
       , CUS.DIC_STATISTIC_3_ID
       , CUS.DIC_STATISTIC_4_ID
       , CUS.DIC_STATISTIC_5_ID
       , CUS.DIC_TYPE_PARTNER_ID
       , SUP.CRE_CUSTOMER_NUMBER
       , SUP.CRE_FREE_ZONE1
       , SUP.CRE_FREE_ZONE2
       , SUP.CRE_FREE_ZONE3
       , SUP.CRE_FREE_ZONE4
       , SUP.CRE_FREE_ZONE5
       , SUP.DIC_STATISTIC_F1_ID
       , SUP.DIC_STATISTIC_F2_ID
       , SUP.DIC_STATISTIC_F3_ID
       , SUP.DIC_STATISTIC_F4_ID
       , SUP.DIC_STATISTIC_F5_ID
       , SUP.DIC_TYPE_PARTNER_F_ID
       , PSC.PAC_SENDING_CONDITION_ID
       , PSC.PAC_ADDRESS_ID SENDING_ADDRESS_ID
       , PER_SEN.PER_NAME SEN_PER_NAME
       , PER_SEN.PER_FORENAME SEN_PER_FORENAME
       , PER_SEN.PER_ACTIVITY SEN_PER_ACTIVITY
       , PER_SEN.PER_COMMENT SEN_PER_COMMENT
       , PER_SEN.PER_KEY1 SEN_PER_KEY1
       , PER_SEN.PER_KEY2 SEN_PER_KEY2
       , ADR_SEN.ADD_ADDRESS1 SEN_ADD_ADDRESS1
       , ADR_SEN.ADD_FORMAT SEN_ADD_FORMAT
       , APM.ACS_PAYMENT_METHOD_ID
       , ACCC.ACC_NUMBER CUSTOMER_ACCOUNT
       , ACCS.ACC_NUMBER SUPPLIER_ACCOUNT
       , DMT.PC_LANG_ID
       , PMT.PAC_PAYMENT_CONDITION_ID
       , PMT.PCO_DESCR
       , PMT.PC_APPLTXT_ID PMT_PC_APPLTXT_ID
       , AFC.ACS_FINANCIAL_CURRENCY_ID
       , CUR.CURRENCY
       , CUR.CURRNAME
       , LANG.LANID
       , DMT.PAC_ADDRESS_ID ADDRESS_ID
       , PER.PER_NAME
       , PER.PER_FORENAME
       , PER.PER_ACTIVITY
       , PER.PER_COMMENT
       , PER.PER_KEY1
       , PER.PER_KEY2
       , DMT.DMT_ADDRESS1
       , DMT.DMT_FORMAT_CITY1
       , DMT.DMT_TOWN1
       , CNT.CNTID
       , CNT.CNTNAME
       , CNT.DIC_PC_CNTRY_GRP_ID
       , CNT.CNT_CE_CODE
       , CNT.CNT_CE_MEMBER
       , DMT.PAC_PAC_ADDRESS_ID ADDRESS2_ID
       , PER2.PER_NAME PER2_NAME
       , PER2.PER_FORENAME PER2_FORENAME
       , PER2.PER_ACTIVITY PER2_ACTIVITY
       , PER2.PER_COMMENT PER2_COMMENT
       , PER2.PER_KEY1 PER2_KEY1
       , PER2.PER_KEY2 PER2_KEY2
       , DMT.DMT_ADDRESS2
       , DMT.DMT_FORMAT_CITY2
       , DMT.DMT_TOWN2
       , CNT2.CNTID CNTID2
       , CNT2.CNTNAME CNTNAME2
       , CNT2.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID2
       , CNT2.CNT_CE_CODE CNT_CE_CODE2
       , CNT2.CNT_CE_MEMBER CNT_CE_MEMBER2
       , DMT.PAC2_PAC_ADDRESS_ID ADDRESS3_ID
       , PER3.PER_NAME PER3_NAME
       , PER3.PER_FORENAME PER3_FORENAME
       , PER3.PER_ACTIVITY PER3_ACTIVITY
       , PER3.PER_COMMENT PER3_COMMENT
       , PER3.PER_KEY1 PER3_KEY1
       , PER3.PER_KEY2 PER3_KEY2
       , DMT.DMT_ADDRESS3
       , DMT.DMT_FORMAT_CITY3
       , DMT.DMT_TOWN3
       , CNT3.CNTID CNTID3
       , CNT3.CNTNAME CNTNAME3
       , CNT3.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID3
       , CNT3.CNT_CE_CODE CNT_CE_CODE3
       , CNT3.CNT_CE_MEMBER CNT_CE_MEMBER3
       , GAU.C_GAUGE_TYPE
       , GST.C_GAUGE_TITLE
       , GAU.C_ADMIN_DOMAIN
       , GAU.DIC_GAUGE_TYPE_DOC_ID
       , DFD.DIC_DOC_FREE_TABLE_1_ID
       , DFD.DIC_DOC_FREE_TABLE_2_ID
       , DFD.DIC_DOC_FREE_TABLE_3_ID
       , DFD.DIC_DOC_FREE_TABLE_4_ID
       , DFD.DIC_DOC_FREE_TABLE_5_ID
       , DFD.FRD_ALPHA_SHORT_1
       , DFD.FRD_ALPHA_SHORT_2
       , DFD.FRD_ALPHA_SHORT_3
       , DFD.FRD_ALPHA_SHORT_4
       , DFD.FRD_ALPHA_SHORT_5
       , DFD.FRD_ALPHA_LONG_1
       , DFD.FRD_ALPHA_LONG_2
       , DFD.FRD_ALPHA_LONG_3
       , DFD.FRD_ALPHA_LONG_4
       , DFD.FRD_ALPHA_LONG_5
       , DFD.FRD_INTEGER_1
       , DFD.FRD_INTEGER_2
       , DFD.FRD_INTEGER_3
       , DFD.FRD_INTEGER_4
       , DFD.FRD_INTEGER_5
       , DFD.FRD_DECIMAL_1
       , DFD.FRD_DECIMAL_2
       , DFD.FRD_DECIMAL_3
       , DFD.FRD_DECIMAL_4
       , DFD.FRD_DECIMAL_5
       , DFD.FRD_BOOLEAN_1
       , DFD.FRD_BOOLEAN_2
       , DFD.FRD_BOOLEAN_3
       , DFD.FRD_BOOLEAN_4
       , DFD.FRD_BOOLEAN_5
       , FOO.DOC_FOOT_ID
       , FOO.DOC_GAUGE_SIGNATORY_ID
       , DGS.GAG_NAME
       , DGS.GAG_FUNCTION
       , FOO.DOC_DOC_GAUGE_SIGNATORY_ID
       , DGS2.GAG_NAME GAG2_NAME
       , DGS2.GAG_FUNCTION GAG2_FUNCTION
       , FOO.FOO_FOOT_TEXT
       , FOO.FOO_FOOT_TEXT2
       , FOO.FOO_FOOT_TEXT3
       , FOO.FOO_FOOT_TEXT4
       , FOO.FOO_FOOT_TEXT5
       , FOO.FOO_DOCUMENT_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOTAL_AMOUNT
       , FOO.FOO_TOTAL_VAT_AMOUNT
       , FOO.FOO_CHARGE_TOTAL_AMOUNT
       , FOO.FOO_DISCOUNT_TOTAL_AMOUNT
       , FOO.FOO_COST_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOT_AMOUNT_EXCL
       , FOO.FOO_CHARG_TOT_AMOUNT_EXCL
       , FOO.FOO_DISC_TOT_AMOUNT_EXCL
       , FOO.FOO_COST_TOT_AMOUNT_EXCL
       , FOO.FOO_TOTAL_NET_WEIGHT
       , FOO.FOO_TOTAL_GROSS_WEIGHT
       , FOO.FOO_TOTAL_BASIS_QUANTITY
       , FOO.FOO_TOTAL_INTERM_QUANTITY
       , FOO.FOO_TOTAL_FINAL_QUANTITY
       , FOO.C_BVR_GENERATION_METHOD
       , FOO.FOO_GENERATE_BVR_NUMBER
       , FOO.FOO_REF_BVR_NUMBER
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_B
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_E
       , FOO.FOO_PAID_AMOUNT
       , FOO.FOO_RETURN_AMOUNT
       , FOO.FOO_PACKAGING
       , FOO.FOO_MARKING
       , FOO.FOO_MEASURE
       , FOO.DIC_TYPE_DOC_CUSTOM_ID
       , FOO.C_DIRECTION_NUMBER
       , FOO.FOO_TOT_VAT_AMOUNT_V
       , FOO.FOO_RECEIVED_AMOUNT
       , FOO.FOO_PAID_BALANCED_AMOUNT
       , POS.DOC_POSITION_ID
       , POS.POS_NUMBER
       , POS.C_DOC_POS_STATUS
       , POS.C_GAUGE_TYPE_POS
       , GOO.GCO_GOOD_ID
       , GOO.GOO_MAJOR_REFERENCE
       , GOO.GOO_SECONDARY_REFERENCE
       , GOO.GOO_NUMBER_OF_DECIMAL GOOD_NUMBER_OF_DECIMAL
       , decode(GAU.C_ADMIN_DOMAIN
              , '1', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', THI.PAC_THIRD_ID)
              , '2', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', THI.PAC_THIRD_ID)
              , GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', THI.PAC_THIRD_ID)
               ) GOO_NUMBER_OF_DECIMAL
       , GOO.DIC_GOOD_LINE_ID
       , GOO.DIC_GOOD_FAMILY_ID
       , GOO.DIC_GOOD_MODEL_ID
       , GOO.DIC_GOOD_GROUP_ID
       , PDT.PDT_STOCK_MANAGEMENT
       , DGP.C_GAUGE_SHOW_DELAY
       , DGP.GAP_POS_DELAY
       , POS.POS_REFERENCE
       , POS.POS_SHORT_DESCRIPTION
       , POS.POS_LONG_DESCRIPTION
       , POS.POS_FREE_DESCRIPTION
       , POS.POS_BODY_TEXT
       , POS.ASA_RECORD_ID
       , POS.ASA_RECORD_TASK_ID
       , POS.ASA_RECORD_COMP_ID
       , TVA.ACC_NUMBER TVA_ACC_NUMBER
       , REC_POS.RCO_TITLE POS_RCO_TITLE
       , REC_POS.DIC_ACCOUNTABLE_GROUP_ID POS_DIC_ACCOUNTABLE_GROUP_ID
       , REC_POS.RCO_DESCRIPTION POS_RCO_DESCRIPTION
       , REP_POS.PAC_REPRESENTATIVE_ID POS_PAC_REPRESENTATIVE_ID
       , REP_POS.REP_DESCR POS_REP_DESCR
       , GCE.CUS_CUSTONS_POSITION
       , GCE.CUS_KEY_TARIFF
       , GCE.CUS_LICENCE_NUMBER
       , GCE.CUS_RATE_FOR_VALUE
       , GCE.CUS_TRANSPORT_INFORMATION
       , GCE.DIC_REPAYMENT_CODE_ID
       , GCE.DIC_SUBJUGATED_LICENCE_ID
       , CNT_CUSTOMS.CNTID CNTID_CUSTOMS
       , CNT_CUSTOMS.CNTNAME CNTNAME_CUSTOMS
       , CNT_CUSTOMS.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID_CUSTOMS
       , CNT_CUSTOMS.CNT_CE_CODE CNT_CE_CODE_CUSTOMS
       , CNT_CUSTOMS.CNT_CE_MEMBER CNT_CE_MEMBER_CUSTOMS
       , CNT_ORIGIN.CNTID CNTID_ORIGIN
       , CNT_ORIGIN.CNTNAME CNTNAME_ORIGIN
       , CNT_ORIGIN.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID_ORIGIN
       , CNT_ORIGIN.CNT_CE_CODE CNT_CE_CODE_ORIGIN
       , CNT_ORIGIN.CNT_CE_MEMBER CNT_CE_MEMBER_ORIGIN
       , GFD.DATA_UNIT_PRICE_SALE
       , GFD.DIC_FREE_TABLE_1_ID
       , GFD.DIC_FREE_TABLE_2_ID
       , GFD.DIC_FREE_TABLE_3_ID
       , GFD.DIC_FREE_TABLE_4_ID
       , GFD.DIC_FREE_TABLE_5_ID
       , POS.POS_DISCOUNT_AMOUNT
       , POS.POS_CHARGE_AMOUNT
       , POS.POS_VAT_AMOUNT
       , POS.POS_VAT_BASE_AMOUNT
       , POS.POS_GROSS_UNIT_VALUE
       , POS.POS_NET_UNIT_VALUE
       , POS.POS_NET_UNIT_VALUE_INCL
       , POS.POS_REF_UNIT_VALUE
       , POS.POS_GROSS_VALUE
       , POS.POS_NET_VALUE_EXCL
       , POS.POS_NET_VALUE_INCL
       , POS.POS_BASIS_QUANTITY
       , POS.POS_INTERMEDIATE_QUANTITY
       , POS.POS_FINAL_QUANTITY
       , POS.POS_BALANCE_QUANTITY
       , POS.POS_RATE_FACTOR
       , POS.POS_NET_WEIGHT
       , POS.POS_GROSS_WEIGHT
       , POS.DIC_UNIT_OF_MEASURE_ID
       , POS.POS_NOM_TEXT
       , POS.POS_UNIT_COST_PRICE
       , POS.POS_EAN_CODE
       , POS.POS_EAN_UCC14_CODE
       , POS.POS_HIBC_PRIMARY_CODE
       , POS.DIC_POS_FREE_TABLE_1_ID
       , POS.DIC_POS_FREE_TABLE_2_ID
       , POS.DIC_POS_FREE_TABLE_3_ID
       , POS.POS_DECIMAL_1
       , POS.POS_DECIMAL_2
       , POS.POS_DECIMAL_3
       , POS.POS_TEXT_1
       , POS.POS_TEXT_2
       , POS.POS_TEXT_3
       , POS.POS_DATE_1
       , POS.POS_DATE_2
       , POS.POS_DATE_3
       , POS.POS_DISCOUNT_UNIT_VALUE
       , POS.POS_DISCOUNT_RATE
       , POS.POS_VALUE_QUANTITY
       , POS.POS_INCLUDE_TAX_TARIFF
       , POS.POS_GROSS_UNIT_VALUE_INCL
       , POS.POS_GROSS_VALUE_INCL
       , POS.POS_BALANCE_QTY_VALUE
       , POS.POS_UTIL_COEFF
       , POS.POS_GROSS_UNIT_VALUE2
       , POS.DIC_DIC_UNIT_OF_MEASURE_ID
       , POS.POS_CONVERT_FACTOR2
       , POS.POS_VAT_AMOUNT_V
       , POS.POS_NET_TARIFF
       , POS.POS_SPECIAL_TARIFF
       , POS.POS_FLAT_RATE
       , POS.POS_BASIS_QUANTITY_SU
       , POS.POS_INTERMEDIATE_QUANTITY_SU
       , POS.POS_FINAL_QUANTITY_SU
       , POS.C_POS_DELIVERY_TYP
       , POS.POS_BALANCED
       , DETAIL.PERE_DMT_NUMBER
       , DETAIL.PERE_DMT_DATE_DOCUMENT
       , DETAIL.PERE_C_GAUGE_TITLE
       , DETAIL.PERE_DMT_PARTNER_NUMBER
       , DETAIL.PERE_DMT_PARTNTER_REFERENCE
       , DETAIL.PERE_DATE_PARTNER_DOCUMENT
       , DETAIL.G_PERE_DMT_NUMBER
       , DETAIL.G_PERE_DMT_DATE_DOCUMENT
       , DETAIL.G_PERE_C_GAUGE_TITLE
       , DETAIL.G_PERE_DMT_PARTNER_NUMBER
       , DETAIL.G_PERE_DMT_PARTNTER_REFERENCE
       , DETAIL.G_PERE_DATE_PARTNER_DOCUMENT
       , DETAIL.STM_LOCATION_ID
       , LOC.LOC_DESCRIPTION
       , STM.STO_DESCRIPTION
       , DETAIL.STM_STM_LOCATION_ID
       , LOC_LOC.LOC_DESCRIPTION LOC_LOC_DESCRIPTION
       , STM_STM.STO_DESCRIPTION STO_STO_DESCRIPTION
       , DETAIL.DIC_DELAY_UPDATE_TYPE_ID
       , DETAIL.PDE_DELAY_UPDATE_TEXT
       , DETAIL.GCO1_CHARACTERIZATION_ID
       , DETAIL.GCO2_CHARACTERIZATION_ID
       , DETAIL.GCO3_CHARACTERIZATION_ID
       , DETAIL.GCO4_CHARACTERIZATION_ID
       , DETAIL.GCO5_CHARACTERIZATION_ID
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO1_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO1_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO2_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO2_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO3_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO3_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO4_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO4_CHARAC_DESCR
       , substr(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO5_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO5_CHARAC_DESCR
       , DETAIL.PDE_CHARACTERIZATION_VALUE_1
       , DETAIL.PDE_CHARACTERIZATION_VALUE_2
       , DETAIL.PDE_CHARACTERIZATION_VALUE_3
       , DETAIL.PDE_CHARACTERIZATION_VALUE_4
       , DETAIL.PDE_CHARACTERIZATION_VALUE_5
       , DETAIL.PDE_PIECE
       , DETAIL.PDE_SET
       , DETAIL.PDE_VERSION
       , DETAIL.PDE_CHRONOLOGICAL
       , DETAIL.PDE_STD_CHAR_1
       , DETAIL.PDE_STD_CHAR_2
       , DETAIL.PDE_STD_CHAR_3
       , DETAIL.PDE_STD_CHAR_4
       , DETAIL.PDE_STD_CHAR_5
       , DETAIL.PDE_BASIS_DELAY
       , DETAIL.PDE_BASIS_DELAY_M
       , DETAIL.PDE_BASIS_DELAY_W
       , DETAIL.PDE_BASIS_QUANTITY
       , DETAIL.PDE_BASIS_QUANTITY_SU
       , DETAIL.PDE_INTERMEDIATE_DELAY
       , DETAIL.PDE_INTERMEDIATE_DELAY_M
       , DETAIL.PDE_INTERMEDIATE_DELAY_W
       , DETAIL.PDE_INTERMEDIATE_QUANTITY
       , DETAIL.PDE_INTERMEDIATE_QUANTITY_SU
       , DETAIL.PDE_FINAL_DELAY
       , DETAIL.PDE_FINAL_DELAY_M
       , DETAIL.PDE_FINAL_DELAY_W
       , DETAIL.PDE_FINAL_QUANTITY
       , DETAIL.PDE_FINAL_QUANTITY_SU
       , DETAIL.PDE_BALANCE_QUANTITY
       , DETAIL.P_PDE_BALANCE_QUANTITY
       , DETAIL.P_PDE_BALANCE_QUANTITY_PARENT
       , DETAIL.P_PDE_BASIS_QUANTITY
       , DETAIL.P_PDE_BASIS_QUANTITY_SU
       , DETAIL.P_PDE_INTERMEDIATE_QUANTITY
       , DETAIL.P_PDE_INTERMEDIATE_QUANTITY_SU
       , DETAIL.P_PDE_FINAL_QUANTITY
       , DETAIL.P_PDE_FINAL_QUANTITY_SU
       , DETAIL.NEED_FAN_EXCEED_QTY
       , DETAIL.NEED_FAN_FREE_QTY
       , DETAIL.NEED_FAN_FULL_QTY
       , DETAIL.NEED_FAN_NETW_QTY
       , DETAIL.NEED_FAN_PREV_QTY
       , DETAIL.NEED_FAN_REALIZE_QTY
       , DETAIL.NEED_FAN_RETURN_QTY
       , DETAIL.NEED_FAN_STK_QTY
       , DETAIL.NEED_FAL_NETWORK_NEED_ID
       , DETAIL.SUPPLY_FAN_EXCEED_QTY
       , DETAIL.SUPPLY_FAN_FREE_QTY
       , DETAIL.SUPPLY_FAN_FULL_QTY
       , DETAIL.SUPPLY_FAN_NETW_QTY
       , DETAIL.SUPPLY_FAN_PREV_QTY
       , DETAIL.SUPPLY_FAN_REALIZE_QTY
       , DETAIL.SUPPLY_FAN_RETURN_QTY
       , DETAIL.SUPPLY_FAN_STK_QTY
       , DETAIL.SUPPLY_FAL_NETWORK_SUPPLY_ID
    from PCS.PC_LANG LANG
       , STM_LOCATION LOC
       , STM_LOCATION LOC_LOC
       , ACS_FIN_ACC_S_PAYMENT AFA
       , ACS_PAYMENT_METHOD APM
       , ACS_ACCOUNT TVA
       , DOC_RECORD REC
       , DOC_RECORD REC_POS
       , DOC_FOOT FOO
       , GCO_FREE_DATA GFD
       , GCO_CUSTOMS_ELEMENT GCE
       , PCS.PC_CNTRY CNT_CUSTOMS
       , PCS.PC_CNTRY CNT_ORIGIN
       , PAC_SENDING_CONDITION PSC
       , PAC_PAYMENT_CONDITION PMT
       , ACS_FINANCIAL_CURRENCY AFC
       , DOC_FREE_DATA DFD
       , DOC_GAUGE_SIGNATORY DGS
       , DOC_GAUGE_SIGNATORY DGS2
       , DOC_GAUGE_POSITION DGP
       , PAC_CUSTOM_PARTNER CUS
       , ACS_ACCOUNT ACCC
       , PAC_ADDRESS ADR
       , PAC_ADDRESS ADR2
       , PAC_ADDRESS ADR3
       , PAC_REPRESENTATIVE REP
       , PAC_REPRESENTATIVE REP_POS
       , PAC_ADDRESS ADR_SEN
       , PAC_PERSON PER_SEN
       , PAC_PERSON PER
       , PAC_PERSON PER2
       , PAC_PERSON PER3
       , PAC_SUPPLIER_PARTNER SUP
       , ACS_ACCOUNT ACCS
       , PAC_THIRD THI
       , ACS_TAX_CODE ATC
       , PCS.PC_CURR CUR
       , PCS.PC_CNTRY CNT
       , PCS.PC_CNTRY CNT2
       , PCS.PC_CNTRY CNT3
       , DOC_GAUGE GAU
       , DOC_GAUGE_STRUCTURED GST
       , STM_STOCK STM
       , STM_STOCK STM_STM
       , GCO_GOOD GOO
       , GCO_PRODUCT PDT
       , DOC_POSITION POS
       , DOC_DOCUMENT DMT
       , (select DMT.DMT_NUMBER
               , POS.DOC_POSITION_ID POSITIONID
               , (DMT_PERE.DMT_NUMBER) PERE_DMT_NUMBER
               , (DMT_PERE.DMT_DATE_DOCUMENT) PERE_DMT_DATE_DOCUMENT
               , (GAU_PERE.C_GAUGE_TITLE) PERE_C_GAUGE_TITLE
               , (DMT_PERE.DMT_PARTNER_NUMBER) PERE_DMT_PARTNER_NUMBER
               , (DMT_PERE.DMT_PARTNER_REFERENCE) PERE_DMT_PARTNTER_REFERENCE
               , (DMT_PERE.DMT_DATE_PARTNER_DOCUMENT) PERE_DATE_PARTNER_DOCUMENT
               , (DMT_G_PERE.DMT_NUMBER) G_PERE_DMT_NUMBER
               , (DMT_G_PERE.DMT_DATE_DOCUMENT) G_PERE_DMT_DATE_DOCUMENT
               , (GAU_G_PERE.C_GAUGE_TITLE) G_PERE_C_GAUGE_TITLE
               , (DMT_G_PERE.DMT_PARTNER_NUMBER) G_PERE_DMT_PARTNER_NUMBER
               , (DMT_G_PERE.DMT_PARTNER_REFERENCE) G_PERE_DMT_PARTNTER_REFERENCE
               , (DMT_G_PERE.DMT_DATE_PARTNER_DOCUMENT) G_PERE_DATE_PARTNER_DOCUMENT
               , (PDE.STM_LOCATION_ID) STM_LOCATION_ID
               , (PDE.STM_STM_LOCATION_ID) STM_STM_LOCATION_ID
               , (PDE.DIC_DELAY_UPDATE_TYPE_ID) DIC_DELAY_UPDATE_TYPE_ID
               , (PDE.PDE_DELAY_UPDATE_TEXT) PDE_DELAY_UPDATE_TEXT
               , PDE.GCO_CHARACTERIZATION_ID GCO1_CHARACTERIZATION_ID
               , PDE.GCO_GCO_CHARACTERIZATION_ID GCO2_CHARACTERIZATION_ID
               , PDE.GCO2_GCO_CHARACTERIZATION_ID GCO3_CHARACTERIZATION_ID
               , PDE.GCO3_GCO_CHARACTERIZATION_ID GCO4_CHARACTERIZATION_ID
               , PDE.GCO4_GCO_CHARACTERIZATION_ID GCO5_CHARACTERIZATION_ID
               , (PDE.PDE_CHARACTERIZATION_VALUE_1) PDE_CHARACTERIZATION_VALUE_1
               , (PDE.PDE_CHARACTERIZATION_VALUE_2) PDE_CHARACTERIZATION_VALUE_2
               , (PDE.PDE_CHARACTERIZATION_VALUE_3) PDE_CHARACTERIZATION_VALUE_3
               , (PDE.PDE_CHARACTERIZATION_VALUE_4) PDE_CHARACTERIZATION_VALUE_4
               , (PDE.PDE_CHARACTERIZATION_VALUE_5) PDE_CHARACTERIZATION_VALUE_5
               , PDE.PDE_PIECE
               , PDE.PDE_SET
               , PDE.PDE_VERSION
               , PDE.PDE_CHRONOLOGICAL
               , PDE.PDE_STD_CHAR_1
               , PDE.PDE_STD_CHAR_2
               , PDE.PDE_STD_CHAR_3
               , PDE.PDE_STD_CHAR_4
               , PDE.PDE_STD_CHAR_5
               , (PDE.PDE_BASIS_DELAY) PDE_BASIS_DELAY
               , (PDE.PDE_BASIS_DELAY_M) PDE_BASIS_DELAY_M
               , (PDE.PDE_BASIS_DELAY_W) PDE_BASIS_DELAY_W
               , (PDE.PDE_BASIS_QUANTITY) PDE_BASIS_QUANTITY
               , (PDE.PDE_BASIS_QUANTITY_SU) PDE_BASIS_QUANTITY_SU
               , (PDE.PDE_INTERMEDIATE_DELAY) PDE_INTERMEDIATE_DELAY
               , (PDE.PDE_INTERMEDIATE_DELAY_M) PDE_INTERMEDIATE_DELAY_M
               , (PDE.PDE_INTERMEDIATE_DELAY_W) PDE_INTERMEDIATE_DELAY_W
               , (PDE.PDE_INTERMEDIATE_QUANTITY) PDE_INTERMEDIATE_QUANTITY
               , (PDE.PDE_INTERMEDIATE_QUANTITY_SU) PDE_INTERMEDIATE_QUANTITY_SU
               , (PDE.PDE_FINAL_DELAY) PDE_FINAL_DELAY
               , (PDE.PDE_FINAL_DELAY_M) PDE_FINAL_DELAY_M
               , (PDE.PDE_FINAL_DELAY_W) PDE_FINAL_DELAY_W
               , (PDE.PDE_FINAL_QUANTITY) PDE_FINAL_QUANTITY
               , (PDE.PDE_FINAL_QUANTITY_SU) PDE_FINAL_QUANTITY_SU
               , (PDE.PDE_BALANCE_QUANTITY) PDE_BALANCE_QUANTITY
               , (PERE.PDE_BALANCE_QUANTITY) P_PDE_BALANCE_QUANTITY
               , (PERE.PDE_BALANCE_QUANTITY_PARENT) P_PDE_BALANCE_QUANTITY_PARENT
               , (PERE.PDE_BASIS_QUANTITY) P_PDE_BASIS_QUANTITY
               , (PERE.PDE_BASIS_QUANTITY_SU) P_PDE_BASIS_QUANTITY_SU
               , (PERE.PDE_INTERMEDIATE_QUANTITY) P_PDE_INTERMEDIATE_QUANTITY
               , (PERE.PDE_INTERMEDIATE_QUANTITY_SU) P_PDE_INTERMEDIATE_QUANTITY_SU
               , (PERE.PDE_FINAL_QUANTITY) P_PDE_FINAL_QUANTITY
               , (PERE.PDE_FINAL_QUANTITY_SU) P_PDE_FINAL_QUANTITY_SU
               , (NEE.FAN_EXCEED_QTY) NEED_FAN_EXCEED_QTY
               , (NEE.FAN_FREE_QTY) NEED_FAN_FREE_QTY
               , (NEE.FAN_FULL_QTY) NEED_FAN_FULL_QTY
               , (NEE.FAN_NETW_QTY) NEED_FAN_NETW_QTY
               , (NEE.FAN_PREV_QTY) NEED_FAN_PREV_QTY
               , (NEE.FAN_REALIZE_QTY) NEED_FAN_REALIZE_QTY
               , (NEE.FAN_RETURN_QTY) NEED_FAN_RETURN_QTY
               , (NEE.FAN_STK_QTY) NEED_FAN_STK_QTY
               , (NEE.FAL_NETWORK_NEED_ID) NEED_FAL_NETWORK_NEED_ID
               , (SUPP.FAN_EXCEED_QTY) SUPPLY_FAN_EXCEED_QTY
               , (SUPP.FAN_FREE_QTY) SUPPLY_FAN_FREE_QTY
               , (SUPP.FAN_FULL_QTY) SUPPLY_FAN_FULL_QTY
               , (SUPP.FAN_NETW_QTY) SUPPLY_FAN_NETW_QTY
               , (SUPP.FAN_PREV_QTY) SUPPLY_FAN_PREV_QTY
               , (SUPP.FAN_REALIZE_QTY) SUPPLY_FAN_REALIZE_QTY
               , (SUPP.FAN_RETURN_QTY) SUPPLY_FAN_RETURN_QTY
               , (SUPP.FAN_STK_QTY) SUPPLY_FAN_STK_QTY
               , (SUPP.FAL_NETWORK_SUPPLY_ID) SUPPLY_FAL_NETWORK_SUPPLY_ID
            from FAL_NETWORK_NEED NEE
               , FAL_NETWORK_SUPPLY SUPP
               , DOC_GAUGE_STRUCTURED GAU_G_PERE
               , DOC_GAUGE_STRUCTURED GAU_PERE
               , DOC_POSITION_DETAIL G_PERE
               , DOC_POSITION_DETAIL PERE
               , DOC_POSITION_DETAIL PDE
               , DOC_DOCUMENT DMT_G_PERE
               , DOC_DOCUMENT DMT_PERE
               , DOC_POSITION POS
               , DOC_DOCUMENT DMT
           where DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
             and POS.DOC_POSITION_ID = PDE.DOC_POSITION_ID
             and PDE.DOC_DOC_POSITION_DETAIL_ID = PERE.DOC_POSITION_DETAIL_ID(+)
             and PERE.DOC_DOCUMENT_ID = DMT_PERE.DOC_DOCUMENT_ID(+)
             and PERE.DOC_DOC_POSITION_DETAIL_ID = G_PERE.DOC_POSITION_DETAIL_ID(+)
             and PERE.DOC_GAUGE_ID = GAU_PERE.DOC_GAUGE_ID(+)
             and G_PERE.DOC_DOCUMENT_ID = DMT_G_PERE.DOC_DOCUMENT_ID(+)
             and G_PERE.DOC_GAUGE_ID = GAU_G_PERE.DOC_GAUGE_ID(+)
             and PDE.DOC_POSITION_DETAIL_ID = NEE.DOC_POSITION_DETAIL_ID(+)
             and PDE.DOC_POSITION_DETAIL_ID = SUPP.DOC_POSITION_DETAIL_ID(+)) DETAIL
   where DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
     and POS.DOC_POSITION_ID = DETAIL.POSITIONID
     and DMT.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
     and GAU.DOC_GAUGE_ID = GST.DOC_GAUGE_ID
     and POS.DOC_GAUGE_POSITION_ID = DGP.DOC_GAUGE_POSITION_ID
     and DMT.PC_LANG_ID = LANG.PC_LANG_ID
     and POS.ACS_TAX_CODE_ID = TVA.ACS_ACCOUNT_ID(+)
     and DMT.ACS_FIN_ACC_S_PAYMENT_ID = AFA.ACS_FIN_ACC_S_PAYMENT_ID(+)
     and AFA.ACS_PAYMENT_METHOD_ID = APM.ACS_PAYMENT_METHOD_ID(+)
     and DMT.PAC_REPRESENTATIVE_ID = REP.PAC_REPRESENTATIVE_ID(+)
     and DMT.DOC_DOCUMENT_ID = DFD.DOC_DOCUMENT_ID(+)
     and DMT.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID(+)
     and POS.ACS_TAX_CODE_ID = ATC.ACS_TAX_CODE_ID(+)
     and POS.GCO_GOOD_ID = GCE.GCO_GOOD_ID(+)
     and GCE.PC_CNTRY_ID = CNT_CUSTOMS.PC_CNTRY_ID(+)
     and GCE.PC_ORIGIN_PC_CNTRY_ID = CNT_ORIGIN.PC_CNTRY_ID(+)
     and POS.PAC_REPRESENTATIVE_ID = REP_POS.PAC_REPRESENTATIVE_ID(+)
     and FOO.DOC_GAUGE_SIGNATORY_ID = DGS.DOC_GAUGE_SIGNATORY_ID(+)
     and FOO.DOC_DOC_GAUGE_SIGNATORY_ID = DGS2.DOC_GAUGE_SIGNATORY_ID(+)
     and DMT.DOC_RECORD_ID = REC.DOC_RECORD_ID(+)
     and POS.DOC_RECORD_ID = REC_POS.DOC_RECORD_ID(+)
     and DMT.PAC_SENDING_CONDITION_ID = PSC.PAC_SENDING_CONDITION_ID(+)
     and PSC.PAC_ADDRESS_ID = ADR_SEN.PAC_ADDRESS_ID(+)
     and ADR_SEN.PAC_PERSON_ID = PER_SEN.PAC_PERSON_ID(+)
     and DMT.PAC_THIRD_ID = THI.PAC_THIRD_ID(+)
     and DMT.PAC_THIRD_ID = CUS.PAC_CUSTOM_PARTNER_ID(+)
     and CUS.ACS_AUXILIARY_ACCOUNT_ID = ACCC.ACS_ACCOUNT_ID(+)
     and SUP.ACS_AUXILIARY_ACCOUNT_ID = ACCS.ACS_ACCOUNT_ID(+)
     and DMT.PAC_THIRD_ID = SUP.PAC_SUPPLIER_PARTNER_ID(+)
     and DMT.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID(+)
     and ADR.PAC_PERSON_ID = PER.PAC_PERSON_ID(+)
     and DMT.PAC_PAC_ADDRESS_ID = ADR2.PAC_ADDRESS_ID(+)
     and ADR2.PAC_PERSON_ID = PER2.PAC_PERSON_ID(+)
     and DMT.PAC2_PAC_ADDRESS_ID = ADR3.PAC_ADDRESS_ID(+)
     and ADR3.PAC_PERSON_ID = PER3.PAC_PERSON_ID(+)
     and DMT.PC_CNTRY_ID = CNT.PC_CNTRY_ID(+)
     and DMT.PC__PC_CNTRY_ID = CNT2.PC_CNTRY_ID(+)
     and DMT.PC_2_PC_CNTRY_ID = CNT3.PC_CNTRY_ID(+)
     and DMT.ACS_FINANCIAL_CURRENCY_ID = AFC.ACS_FINANCIAL_CURRENCY_ID(+)
     and AFC.PC_CURR_ID = CUR.PC_CURR_ID(+)
     and DMT.PAC_PAYMENT_CONDITION_ID = PMT.PAC_PAYMENT_CONDITION_ID(+)
     and DETAIL.STM_LOCATION_ID = LOC.STM_LOCATION_ID(+)
     and DETAIL.STM_STM_LOCATION_ID = LOC_LOC.STM_LOCATION_ID(+)
     and LOC.STM_STOCK_ID = STM.STM_STOCK_ID(+)
     and LOC_LOC.STM_STOCK_ID = STM_STM.STM_STOCK_ID(+)
     and POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID(+)
     and GOO.GCO_GOOD_ID = PDT.GCO_GOOD_ID(+)
     and GOO.GCO_GOOD_ID = GFD.GCO_GOOD_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_4_PRNT_WEB" ("DOC_DOCUMENT_ID", "DOCNUMBER", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_VALUE", "DMT_DATE_FALLING_DUE", "DMT_DATE_DELIVERY", "C_DOCUMENT_STATUS", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_DATE_PARTNER_DOCUMENT", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DIC_DOC_FREE_1_ID", "DIC_DOC_FREE_2_ID", "DIC_DOC_FREE_3_ID", "DIC_TYPE_SUBMISSION_ID", "DOC_DIC_POS_FREE_TABLE_1_ID", "DOC_DIC_POS_FREE_TABLE_2_ID", "DOC_DIC_POS_FREE_TABLE_3_ID", "DMT_DECIMAL_1", "DMT_DECIMAL_2", "DMT_DECIMAL_3", "DMT_TEXT_1", "DMT_TEXT_2", "DMT_TEXT_3", "DMT_DATE_1", "DMT_DATE_2", "DMT_DATE_3", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "DMT_GAU_FREE_NUMBER1", "DMT_GAU_FREE_NUMBER2", "DMT_GAU_FREE_DATE1", "DMT_GAU_FREE_DATE2", "DMT_GAU_FREE_TEXT_LONG", "DMT_GAU_FREE_TEXT_SHORT", "DMT_GAU_FREE_BOOL1", "DMT_GAU_FREE_BOOL2", "DIC_TARIFF_ID", "C_INCOTERMS", "DMT_INCOTERMS_PLACE", "PAC_REPRESENTATIVE_ID", "REP_DESCR", "DIC_ACCOUNTABLE_GROUP_ID", "RCO_TITLE", "RCO_DESCRIPTION", "PAC_THIRD_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_INTRA", "THI_NO_TVA", "THI_NO_SIREN", "THI_NO_SIRET", "THI_NO_FORMAT", "C_DELIVERY_TYP", "CUS_SUPPLIER_NUMBER", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "DIC_TYPE_PARTNER_ID", "CRE_CUSTOMER_NUMBER", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "DIC_TYPE_PARTNER_F_ID", "PAC_SENDING_CONDITION_ID", "SENDING_ADDRESS_ID", "SEN_PER_NAME", "SEN_PER_FORENAME", "SEN_PER_ACTIVITY", "SEN_PER_COMMENT", "SEN_PER_KEY1", "SEN_PER_KEY2", "SEN_ADD_ADDRESS1", "SEN_ADD_FORMAT", "ACS_PAYMENT_METHOD_ID", "CUSTOMER_ACCOUNT", "SUPPLIER_ACCOUNT", "PC_LANG_ID", "PAC_PAYMENT_CONDITION_ID", "PCO_DESCR", "PMT_PC_APPLTXT_ID", "ACS_FINANCIAL_CURRENCY_ID", "CURRENCY", "CURRNAME", "LANID", "ADDRESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DMT_ADDRESS1", "DMT_FORMAT_CITY1", "DMT_TOWN1", "CNTID", "CNTNAME", "DIC_PC_CNTRY_GRP_ID", "CNT_CE_CODE", "CNT_CE_MEMBER", "ADDRESS2_ID", "PER2_NAME", "PER2_FORENAME", "PER2_ACTIVITY", "PER2_COMMENT", "PER2_KEY1", "PER2_KEY2", "DMT_ADDRESS2", "DMT_FORMAT_CITY2", "DMT_TOWN2", "CNTID2", "CNTNAME2", "DIC_PC_CNTRY_GRP_ID2", "CNT_CE_CODE2", "CNT_CE_MEMBER2", "ADDRESS3_ID", "PER3_NAME", "PER3_FORENAME", "PER3_ACTIVITY", "PER3_COMMENT", "PER3_KEY1", "PER3_KEY2", "DMT_ADDRESS3", "DMT_FORMAT_CITY3", "DMT_TOWN3", "CNTID3", "CNTNAME3", "DIC_PC_CNTRY_GRP_ID3", "CNT_CE_CODE3", "CNT_CE_MEMBER3", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "C_ADMIN_DOMAIN", "DIC_GAUGE_TYPE_DOC_ID", "DIC_DOC_FREE_TABLE_1_ID", "DIC_DOC_FREE_TABLE_2_ID", "DIC_DOC_FREE_TABLE_3_ID", "DIC_DOC_FREE_TABLE_4_ID", "DIC_DOC_FREE_TABLE_5_ID", "FRD_ALPHA_SHORT_1", "FRD_ALPHA_SHORT_2", "FRD_ALPHA_SHORT_3", "FRD_ALPHA_SHORT_4", "FRD_ALPHA_SHORT_5", "FRD_ALPHA_LONG_1", "FRD_ALPHA_LONG_2", "FRD_ALPHA_LONG_3", "FRD_ALPHA_LONG_4", "FRD_ALPHA_LONG_5", "FRD_INTEGER_1", "FRD_INTEGER_2", "FRD_INTEGER_3", "FRD_INTEGER_4", "FRD_INTEGER_5", "FRD_DECIMAL_1", "FRD_DECIMAL_2", "FRD_DECIMAL_3", "FRD_DECIMAL_4", "FRD_DECIMAL_5", "FRD_BOOLEAN_1", "FRD_BOOLEAN_2", "FRD_BOOLEAN_3", "FRD_BOOLEAN_4", "FRD_BOOLEAN_5", "DOC_FOOT_ID", "DOC_GAUGE_SIGNATORY_ID", "GAG_NAME", "GAG_FUNCTION", "DOC_DOC_GAUGE_SIGNATORY_ID", "GAG2_NAME", "GAG2_FUNCTION", "FOO_FOOT_TEXT", "FOO_FOOT_TEXT2", "FOO_FOOT_TEXT3", "FOO_FOOT_TEXT4", "FOO_FOOT_TEXT5", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT", "FOO_TOTAL_VAT_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "FOO_REF_BVR_NUMBER", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_PAID_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "DIC_TYPE_DOC_CUSTOM_ID", "C_DIRECTION_NUMBER", "FOO_TOT_VAT_AMOUNT_V", "FOO_RECEIVED_AMOUNT", "FOO_PAID_BALANCED_AMOUNT", "DOC_POSITION_ID", "POS_NUMBER", "C_DOC_POS_STATUS", "C_GAUGE_TYPE_POS", "GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOOD_NUMBER_OF_DECIMAL", "GOO_NUMBER_OF_DECIMAL", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_MODEL_ID", "DIC_GOOD_GROUP_ID", "PDT_STOCK_MANAGEMENT", "C_GAUGE_SHOW_DELAY", "GAP_POS_DELAY", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "ASA_RECORD_ID", "ASA_RECORD_TASK_ID", "ASA_RECORD_COMP_ID", "TVA_ACC_NUMBER", "POS_RCO_TITLE", "POS_DIC_ACCOUNTABLE_GROUP_ID", "POS_RCO_DESCRIPTION", "POS_PAC_REPRESENTATIVE_ID", "POS_REP_DESCR", "CUS_CUSTONS_POSITION", "CUS_KEY_TARIFF", "CUS_LICENCE_NUMBER", "CUS_RATE_FOR_VALUE", "CUS_TRANSPORT_INFORMATION", "DIC_REPAYMENT_CODE_ID", "DIC_SUBJUGATED_LICENCE_ID", "CNTID_CUSTOMS", "CNTNAME_CUSTOMS", "DIC_PC_CNTRY_GRP_ID_CUSTOMS", "CNT_CE_CODE_CUSTOMS", "CNT_CE_MEMBER_CUSTOMS", "CNTID_ORIGIN", "CNTNAME_ORIGIN", "DIC_PC_CNTRY_GRP_ID_ORIGIN", "CNT_CE_CODE_ORIGIN", "CNT_CE_MEMBER_ORIGIN", "DATA_UNIT_PRICE_SALE", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_GROSS_UNIT_VALUE", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_REF_UNIT_VALUE", "POS_GROSS_VALUE", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_INCL", "POS_BASIS_QUANTITY", "POS_INTERMEDIATE_QUANTITY", "POS_FINAL_QUANTITY", "POS_BALANCE_QUANTITY", "POS_RATE_FACTOR", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "DIC_UNIT_OF_MEASURE_ID", "POS_NOM_TEXT", "POS_UNIT_COST_PRICE", "POS_EAN_CODE", "POS_EAN_UCC14_CODE", "POS_HIBC_PRIMARY_CODE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "POS_VALUE_QUANTITY", "POS_INCLUDE_TAX_TARIFF", "POS_GROSS_UNIT_VALUE_INCL", "POS_GROSS_VALUE_INCL", "POS_BALANCE_QTY_VALUE", "POS_UTIL_COEFF", "POS_GROSS_UNIT_VALUE2", "DIC_DIC_UNIT_OF_MEASURE_ID", "POS_CONVERT_FACTOR2", "POS_VAT_AMOUNT_V", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY_SU", "C_POS_DELIVERY_TYP", "POS_BALANCED", "DOC_POSITION_DETAIL_ID", "PERE_DOC_POSITION_DETAIL_ID", "PERE_DMT_NUMBER", "PERE_DMT_DATE_DOCUMENT", "PERE_C_GAUGE_TITLE", "PERE_DMT_PARTNER_NUMBER", "PERE_DMT_PARTNTER_REFERENCE", "PERE_DATE_PARTNER_DOCUMENT", "G_PERE_DOC_POSITION_DETAIL_ID", "G_PERE_DMT_NUMBER", "G_PERE_DMT_DATE_DOCUMENT", "G_PERE_C_GAUGE_TITLE", "G_PERE_DMT_PARTNER_NUMBER", "G_PERE_DMT_PARTNTER_REFERENCE", "G_PERE_DATE_PARTNER_DOCUMENT", "STM_LOCATION_ID", "LOC_DESCRIPTION", "STO_DESCRIPTION", "STM_STM_LOCATION_ID", "LOC_LOC_DESCRIPTION", "STO_STO_DESCRIPTION", "DIC_DELAY_UPDATE_TYPE_ID", "PDE_DELAY_UPDATE_TEXT", "GCO1_CHARACTERIZATION_ID", "GCO2_CHARACTERIZATION_ID", "GCO3_CHARACTERIZATION_ID", "GCO4_CHARACTERIZATION_ID", "GCO5_CHARACTERIZATION_ID", "GCO1_CHARAC_DESCR", "GCO2_CHARAC_DESCR", "GCO3_CHARAC_DESCR", "GCO4_CHARAC_DESCR", "GCO5_CHARAC_DESCR", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "PDE_PIECE", "PDE_SET", "PDE_VERSION", "PDE_CHRONOLOGICAL", "PDE_STD_CHAR_1", "PDE_STD_CHAR_2", "PDE_STD_CHAR_3", "PDE_STD_CHAR_4", "PDE_STD_CHAR_5", "PDE_BASIS_DELAY", "PDE_BASIS_DELAY_M", "PDE_BASIS_DELAY_W", "PDE_BASIS_QUANTITY", "PDE_BASIS_QUANTITY_SU", "PDE_INTERMEDIATE_DELAY", "PDE_INTERMEDIATE_DELAY_M", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_QUANTITY", "PDE_INTERMEDIATE_QUANTITY_SU", "PDE_FINAL_DELAY", "PDE_FINAL_DELAY_M", "PDE_FINAL_DELAY_W", "PDE_FINAL_QUANTITY", "PDE_FINAL_QUANTITY_SU", "PDE_BALANCE_QUANTITY", "P_PDE_BALANCE_QUANTITY", "P_PDE_BALANCE_QUANTITY_PARENT", "P_PDE_BASIS_QUANTITY", "P_PDE_BASIS_QUANTITY_SU", "P_PDE_INTERMEDIATE_QUANTITY", "P_PDE_INTERMEDIATE_QUANTITY_SU", "P_PDE_FINAL_QUANTITY", "P_PDE_FINAL_QUANTITY_SU", "NEED_FAN_EXCEED_QTY", "NEED_FAN_FREE_QTY", "NEED_FAN_FULL_QTY", "NEED_FAN_NETW_QTY", "NEED_FAN_PREV_QTY", "NEED_FAN_REALIZE_QTY", "NEED_FAN_RETURN_QTY", "NEED_FAN_STK_QTY", "NEED_FAL_NETWORK_NEED_ID", "SUPPLY_FAN_EXCEED_QTY", "SUPPLY_FAN_FREE_QTY", "SUPPLY_FAN_FULL_QTY", "SUPPLY_FAN_NETW_QTY", "SUPPLY_FAN_PREV_QTY", "SUPPLY_FAN_REALIZE_QTY", "SUPPLY_FAN_RETURN_QTY", "SUPPLY_FAN_STK_QTY", "SUPPLY_FAL_NETWORK_SUPPLY_ID", "LOT_REFCOMPL", "COMP_MAJOR_REFERENCE", "SCS_SHORT_DESCR", "SCS_LONG_DESCR", "SCS_FREE_DESCR", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "POS_TARIFF_SET", "DIC_CATEGORY_FREE_1_ID") AS
  SELECT DMT.DOC_DOCUMENT_ID
       , DMT.DMT_NUMBER DOCNUMBER
       , DETAIL.DMT_NUMBER
       , DMT.DMT_DATE_DOCUMENT
       , DMT.DMT_DATE_VALUE
       , DMT.DMT_DATE_FALLING_DUE
       , DMT.DMT_DATE_DELIVERY
       , DMT.C_DOCUMENT_STATUS
       , DMT.DMT_PARTNER_NUMBER
       , DMT.DMT_PARTNER_REFERENCE
       , DMT.DMT_DATE_PARTNER_DOCUMENT
       , DMT.DMT_REFERENCE
       , DMT.DMT_TITLE_TEXT
       , DMT.DMT_HEADING_TEXT
       , DMT.DMT_DOCUMENT_TEXT
       , DMT.DIC_DOC_FREE_1_ID
       , DMT.DIC_DOC_FREE_2_ID
       , DMT.DIC_DOC_FREE_3_ID
       , DMT.DIC_TYPE_SUBMISSION_ID
       , DMT.DIC_POS_FREE_TABLE_1_ID DOC_DIC_POS_FREE_TABLE_1_ID
       , DMT.DIC_POS_FREE_TABLE_2_ID DOC_DIC_POS_FREE_TABLE_2_ID
       , DMT.DIC_POS_FREE_TABLE_3_ID DOC_DIC_POS_FREE_TABLE_3_ID
       , DMT.DMT_DECIMAL_1
       , DMT.DMT_DECIMAL_2
       , DMT.DMT_DECIMAL_3
       , DMT.DMT_TEXT_1
       , DMT.DMT_TEXT_2
       , DMT.DMT_TEXT_3
       , DMT.DMT_DATE_1
       , DMT.DMT_DATE_2
       , DMT.DMT_DATE_3
       , DMT.DIC_GAUGE_FREE_CODE_1_ID
       , DMT.DIC_GAUGE_FREE_CODE_2_ID
       , DMT.DIC_GAUGE_FREE_CODE_3_ID
       , DMT.DMT_GAU_FREE_NUMBER1
       , DMT.DMT_GAU_FREE_NUMBER2
       , DMT.DMT_GAU_FREE_DATE1
       , DMT.DMT_GAU_FREE_DATE2
       , DMT.DMT_GAU_FREE_TEXT_LONG
       , DMT.DMT_GAU_FREE_TEXT_SHORT
       , DMT.DMT_GAU_FREE_BOOL1
       , DMT.DMT_GAU_FREE_BOOL2
       , DMT.DIC_TARIFF_ID
       , DMT.C_INCOTERMS
       , DMT.DMT_INCOTERMS_PLACE
       , REP.PAC_REPRESENTATIVE_ID
       , REP.REP_DESCR
       , REC.DIC_ACCOUNTABLE_GROUP_ID
       , REC.RCO_TITLE
       , REC.RCO_DESCRIPTION
       , DMT.PAC_THIRD_ID
       , THI.DIC_THIRD_ACTIVITY_ID
       , THI.DIC_THIRD_AREA_ID
       , THI.THI_NO_INTRA
       , THI.THI_NO_TVA
       , THI.THI_NO_SIREN
       , THI.THI_NO_SIRET
       , THI.THI_NO_FORMAT
       , CUS.C_DELIVERY_TYP
       , CUS.CUS_SUPPLIER_NUMBER
       , CUS.CUS_FREE_ZONE1
       , CUS.CUS_FREE_ZONE2
       , CUS.CUS_FREE_ZONE3
       , CUS.CUS_FREE_ZONE4
       , CUS.CUS_FREE_ZONE5
       , CUS.DIC_STATISTIC_1_ID
       , CUS.DIC_STATISTIC_2_ID
       , CUS.DIC_STATISTIC_3_ID
       , CUS.DIC_STATISTIC_4_ID
       , CUS.DIC_STATISTIC_5_ID
       , CUS.DIC_TYPE_PARTNER_ID
       , SUP.CRE_CUSTOMER_NUMBER
       , SUP.CRE_FREE_ZONE1
       , SUP.CRE_FREE_ZONE2
       , SUP.CRE_FREE_ZONE3
       , SUP.CRE_FREE_ZONE4
       , SUP.CRE_FREE_ZONE5
       , SUP.DIC_STATISTIC_F1_ID
       , SUP.DIC_STATISTIC_F2_ID
       , SUP.DIC_STATISTIC_F3_ID
       , SUP.DIC_STATISTIC_F4_ID
       , SUP.DIC_STATISTIC_F5_ID
       , SUP.DIC_TYPE_PARTNER_F_ID
       , PSC.PAC_SENDING_CONDITION_ID
       , PSC.PAC_ADDRESS_ID SENDING_ADDRESS_ID
       , PER_SEN.PER_NAME SEN_PER_NAME
       , PER_SEN.PER_FORENAME SEN_PER_FORENAME
       , PER_SEN.PER_ACTIVITY SEN_PER_ACTIVITY
       , PER_SEN.PER_COMMENT SEN_PER_COMMENT
       , PER_SEN.PER_KEY1 SEN_PER_KEY1
       , PER_SEN.PER_KEY2 SEN_PER_KEY2
       , ADR_SEN.ADD_ADDRESS1 SEN_ADD_ADDRESS1
       , ADR_SEN.ADD_FORMAT SEN_ADD_FORMAT
       , APM.ACS_PAYMENT_METHOD_ID
       , ACCC.ACC_NUMBER CUSTOMER_ACCOUNT
       , ACCS.ACC_NUMBER SUPPLIER_ACCOUNT
       , DMT.PC_LANG_ID
       , PMT.PAC_PAYMENT_CONDITION_ID
       , PMT.PCO_DESCR
       , PMT.PC_APPLTXT_ID PMT_PC_APPLTXT_ID
       , AFC.ACS_FINANCIAL_CURRENCY_ID
       , CUR.CURRENCY
       , CUR.CURRNAME
       , LANG.LANID
       , DMT.PAC_ADDRESS_ID ADDRESS_ID
       , PER.PER_NAME
       , PER.PER_FORENAME
       , PER.PER_ACTIVITY
       , PER.PER_COMMENT
       , PER.PER_KEY1
       , PER.PER_KEY2
       , DMT.DMT_ADDRESS1
       , DMT.DMT_FORMAT_CITY1
       , DMT.DMT_TOWN1
       , CNT.CNTID
       , CNT.CNTNAME
       , CNT.DIC_PC_CNTRY_GRP_ID
       , CNT.CNT_CE_CODE
       , CNT.CNT_CE_MEMBER
       , DMT.PAC_PAC_ADDRESS_ID ADDRESS2_ID
       , PER2.PER_NAME PER2_NAME
       , PER2.PER_FORENAME PER2_FORENAME
       , PER2.PER_ACTIVITY PER2_ACTIVITY
       , PER2.PER_COMMENT PER2_COMMENT
       , PER2.PER_KEY1 PER2_KEY1
       , PER2.PER_KEY2 PER2_KEY2
       , DMT.DMT_ADDRESS2
       , DMT.DMT_FORMAT_CITY2
       , DMT.DMT_TOWN2
       , CNT2.CNTID CNTID2
       , CNT2.CNTNAME CNTNAME2
       , CNT2.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID2
       , CNT2.CNT_CE_CODE CNT_CE_CODE2
       , CNT2.CNT_CE_MEMBER CNT_CE_MEMBER2
       , DMT.PAC2_PAC_ADDRESS_ID ADDRESS3_ID
       , PER3.PER_NAME PER3_NAME
       , PER3.PER_FORENAME PER3_FORENAME
       , PER3.PER_ACTIVITY PER3_ACTIVITY
       , PER3.PER_COMMENT PER3_COMMENT
       , PER3.PER_KEY1 PER3_KEY1
       , PER3.PER_KEY2 PER3_KEY2
       , DMT.DMT_ADDRESS3
       , DMT.DMT_FORMAT_CITY3
       , DMT.DMT_TOWN3
       , CNT3.CNTID CNTID3
       , CNT3.CNTNAME CNTNAME3
       , CNT3.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID3
       , CNT3.CNT_CE_CODE CNT_CE_CODE3
       , CNT3.CNT_CE_MEMBER CNT_CE_MEMBER3
       , GAU.C_GAUGE_TYPE
       , GST.C_GAUGE_TITLE
       , GAU.C_ADMIN_DOMAIN
       , GAU.DIC_GAUGE_TYPE_DOC_ID
       , DFD.DIC_DOC_FREE_TABLE_1_ID
       , DFD.DIC_DOC_FREE_TABLE_2_ID
       , DFD.DIC_DOC_FREE_TABLE_3_ID
       , DFD.DIC_DOC_FREE_TABLE_4_ID
       , DFD.DIC_DOC_FREE_TABLE_5_ID
       , DFD.FRD_ALPHA_SHORT_1
       , DFD.FRD_ALPHA_SHORT_2
       , DFD.FRD_ALPHA_SHORT_3
       , DFD.FRD_ALPHA_SHORT_4
       , DFD.FRD_ALPHA_SHORT_5
       , DFD.FRD_ALPHA_LONG_1
       , DFD.FRD_ALPHA_LONG_2
       , DFD.FRD_ALPHA_LONG_3
       , DFD.FRD_ALPHA_LONG_4
       , DFD.FRD_ALPHA_LONG_5
       , DFD.FRD_INTEGER_1
       , DFD.FRD_INTEGER_2
       , DFD.FRD_INTEGER_3
       , DFD.FRD_INTEGER_4
       , DFD.FRD_INTEGER_5
       , DFD.FRD_DECIMAL_1
       , DFD.FRD_DECIMAL_2
       , DFD.FRD_DECIMAL_3
       , DFD.FRD_DECIMAL_4
       , DFD.FRD_DECIMAL_5
       , DFD.FRD_BOOLEAN_1
       , DFD.FRD_BOOLEAN_2
       , DFD.FRD_BOOLEAN_3
       , DFD.FRD_BOOLEAN_4
       , DFD.FRD_BOOLEAN_5
       , FOO.DOC_FOOT_ID
       , FOO.DOC_GAUGE_SIGNATORY_ID
       , DGS.GAG_NAME
       , DGS.GAG_FUNCTION
       , FOO.DOC_DOC_GAUGE_SIGNATORY_ID
       , DGS2.GAG_NAME GAG2_NAME
       , DGS2.GAG_FUNCTION GAG2_FUNCTION
       , FOO.FOO_FOOT_TEXT
       , FOO.FOO_FOOT_TEXT2
       , FOO.FOO_FOOT_TEXT3
       , FOO.FOO_FOOT_TEXT4
       , FOO.FOO_FOOT_TEXT5
       , FOO.FOO_DOCUMENT_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOTAL_AMOUNT
       , FOO.FOO_TOTAL_VAT_AMOUNT
       , FOO.FOO_CHARGE_TOTAL_AMOUNT
       , FOO.FOO_DISCOUNT_TOTAL_AMOUNT
       , FOO.FOO_COST_TOTAL_AMOUNT
       , FOO.FOO_GOOD_TOT_AMOUNT_EXCL
       , FOO.FOO_CHARG_TOT_AMOUNT_EXCL
       , FOO.FOO_DISC_TOT_AMOUNT_EXCL
       , FOO.FOO_COST_TOT_AMOUNT_EXCL
       , FOO.FOO_TOTAL_NET_WEIGHT
       , FOO.FOO_TOTAL_GROSS_WEIGHT
       , FOO.FOO_TOTAL_BASIS_QUANTITY
       , FOO.FOO_TOTAL_INTERM_QUANTITY
       , FOO.FOO_TOTAL_FINAL_QUANTITY
       , FOO.C_BVR_GENERATION_METHOD
       , FOO.FOO_GENERATE_BVR_NUMBER
       , FOO.FOO_REF_BVR_NUMBER
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_B
       , FOO.FOO_DOCUMENT_TOT_AMOUNT_E
       , FOO.FOO_PAID_AMOUNT
       , FOO.FOO_RETURN_AMOUNT
       , FOO.FOO_PACKAGING
       , FOO.FOO_MARKING
       , FOO.FOO_MEASURE
       , FOO.DIC_TYPE_DOC_CUSTOM_ID
       , FOO.C_DIRECTION_NUMBER
       , FOO.FOO_TOT_VAT_AMOUNT_V
       , FOO.FOO_RECEIVED_AMOUNT
       , FOO.FOO_PAID_BALANCED_AMOUNT
       , POS.DOC_POSITION_ID
       , POS.POS_NUMBER
       , POS.C_DOC_POS_STATUS
       , POS.C_GAUGE_TYPE_POS
       , GOO.GCO_GOOD_ID
       , GOO.GOO_MAJOR_REFERENCE
       , GOO.GOO_SECONDARY_REFERENCE
       , GOO.GOO_NUMBER_OF_DECIMAL GOOD_NUMBER_OF_DECIMAL
       , DECODE(GAU.C_ADMIN_DOMAIN
              , '1', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', THI.PAC_THIRD_ID)
              , '2', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', THI.PAC_THIRD_ID)
              , GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', THI.PAC_THIRD_ID)
               ) GOO_NUMBER_OF_DECIMAL
       , GOO.DIC_GOOD_LINE_ID
       , GOO.DIC_GOOD_FAMILY_ID
       , GOO.DIC_GOOD_MODEL_ID
       , GOO.DIC_GOOD_GROUP_ID
       , PDT.PDT_STOCK_MANAGEMENT
       , DGP.C_GAUGE_SHOW_DELAY
       , DGP.GAP_POS_DELAY
       , POS.POS_REFERENCE
       , POS.POS_SHORT_DESCRIPTION
       , POS.POS_LONG_DESCRIPTION
       , POS.POS_FREE_DESCRIPTION
       , POS.POS_BODY_TEXT
       , POS.ASA_RECORD_ID
       , POS.ASA_RECORD_TASK_ID
       , POS.ASA_RECORD_COMP_ID
       , TVA.ACC_NUMBER TVA_ACC_NUMBER
       , REC_POS.RCO_TITLE POS_RCO_TITLE
       , REC_POS.DIC_ACCOUNTABLE_GROUP_ID POS_DIC_ACCOUNTABLE_GROUP_ID
       , REC_POS.RCO_DESCRIPTION POS_RCO_DESCRIPTION
       , REP_POS.PAC_REPRESENTATIVE_ID POS_PAC_REPRESENTATIVE_ID
       , REP_POS.REP_DESCR POS_REP_DESCR
       , GCE.CUS_CUSTONS_POSITION
       , GCE.CUS_KEY_TARIFF
       , GCE.CUS_LICENCE_NUMBER
       , GCE.CUS_RATE_FOR_VALUE
       , GCE.CUS_TRANSPORT_INFORMATION
       , GCE.DIC_REPAYMENT_CODE_ID
       , GCE.DIC_SUBJUGATED_LICENCE_ID
       , CNT_CUSTOMS.CNTID CNTID_CUSTOMS
       , CNT_CUSTOMS.CNTNAME CNTNAME_CUSTOMS
       , CNT_CUSTOMS.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID_CUSTOMS
       , CNT_CUSTOMS.CNT_CE_CODE CNT_CE_CODE_CUSTOMS
       , CNT_CUSTOMS.CNT_CE_MEMBER CNT_CE_MEMBER_CUSTOMS
       , CNT_ORIGIN.CNTID CNTID_ORIGIN
       , CNT_ORIGIN.CNTNAME CNTNAME_ORIGIN
       , CNT_ORIGIN.DIC_PC_CNTRY_GRP_ID DIC_PC_CNTRY_GRP_ID_ORIGIN
       , CNT_ORIGIN.CNT_CE_CODE CNT_CE_CODE_ORIGIN
       , CNT_ORIGIN.CNT_CE_MEMBER CNT_CE_MEMBER_ORIGIN
       , GFD.DATA_UNIT_PRICE_SALE
       , GFD.DIC_FREE_TABLE_1_ID
       , GFD.DIC_FREE_TABLE_2_ID
       , GFD.DIC_FREE_TABLE_3_ID
       , GFD.DIC_FREE_TABLE_4_ID
       , GFD.DIC_FREE_TABLE_5_ID
       , POS.POS_DISCOUNT_AMOUNT
       , POS.POS_CHARGE_AMOUNT
       , POS.POS_VAT_AMOUNT
       , POS.POS_VAT_BASE_AMOUNT
       , POS.POS_GROSS_UNIT_VALUE
       , POS.POS_NET_UNIT_VALUE
       , POS.POS_NET_UNIT_VALUE_INCL
       , POS.POS_REF_UNIT_VALUE
       , POS.POS_GROSS_VALUE
       , POS.POS_NET_VALUE_EXCL
       , POS.POS_NET_VALUE_INCL
       , POS.POS_BASIS_QUANTITY
       , POS.POS_INTERMEDIATE_QUANTITY
       , POS.POS_FINAL_QUANTITY
       , POS.POS_BALANCE_QUANTITY
       , POS.POS_RATE_FACTOR
       , POS.POS_NET_WEIGHT
       , POS.POS_GROSS_WEIGHT
       , POS.DIC_UNIT_OF_MEASURE_ID
       , POS.POS_NOM_TEXT
       , POS.POS_UNIT_COST_PRICE
       , POS.POS_EAN_CODE
       , POS.POS_EAN_UCC14_CODE
       , POS.POS_HIBC_PRIMARY_CODE
       , POS.DIC_POS_FREE_TABLE_1_ID
       , POS.DIC_POS_FREE_TABLE_2_ID
       , POS.DIC_POS_FREE_TABLE_3_ID
       , POS.POS_DECIMAL_1
       , POS.POS_DECIMAL_2
       , POS.POS_DECIMAL_3
       , POS.POS_TEXT_1
       , POS.POS_TEXT_2
       , POS.POS_TEXT_3
       , POS.POS_DATE_1
       , POS.POS_DATE_2
       , POS.POS_DATE_3
       , POS.POS_DISCOUNT_UNIT_VALUE
       , POS.POS_DISCOUNT_RATE
       , POS.POS_VALUE_QUANTITY
       , POS.POS_INCLUDE_TAX_TARIFF
       , POS.POS_GROSS_UNIT_VALUE_INCL
       , POS.POS_GROSS_VALUE_INCL
       , POS.POS_BALANCE_QTY_VALUE
       , POS.POS_UTIL_COEFF
       , POS.POS_GROSS_UNIT_VALUE2
       , POS.DIC_DIC_UNIT_OF_MEASURE_ID
       , POS.POS_CONVERT_FACTOR2
       , POS.POS_VAT_AMOUNT_V
       , POS.POS_NET_TARIFF
       , POS.POS_SPECIAL_TARIFF
       , POS.POS_FLAT_RATE
       , POS.POS_BASIS_QUANTITY_SU
       , POS.POS_INTERMEDIATE_QUANTITY_SU
       , POS.POS_FINAL_QUANTITY_SU
       , POS.C_POS_DELIVERY_TYP
       , POS.POS_BALANCED
       , DETAIL.DOC_POSITION_DETAIL_ID
       , DETAIL.PERE_DOC_POSITION_DETAIL_ID
       , DETAIL.PERE_DMT_NUMBER
       , DETAIL.PERE_DMT_DATE_DOCUMENT
       , DETAIL.PERE_C_GAUGE_TITLE
       , DETAIL.PERE_DMT_PARTNER_NUMBER
       , DETAIL.PERE_DMT_PARTNTER_REFERENCE
       , DETAIL.PERE_DATE_PARTNER_DOCUMENT
       , DETAIL.G_PERE_DOC_POSITION_DETAIL_ID
       , DETAIL.G_PERE_DMT_NUMBER
       , DETAIL.G_PERE_DMT_DATE_DOCUMENT
       , DETAIL.G_PERE_C_GAUGE_TITLE
       , DETAIL.G_PERE_DMT_PARTNER_NUMBER
       , DETAIL.G_PERE_DMT_PARTNTER_REFERENCE
       , DETAIL.G_PERE_DATE_PARTNER_DOCUMENT
       , DETAIL.STM_LOCATION_ID
       , LOC.LOC_DESCRIPTION
       , STM.STO_DESCRIPTION
       , DETAIL.STM_STM_LOCATION_ID
       , LOC_LOC.LOC_DESCRIPTION LOC_LOC_DESCRIPTION
       , STM_STM.STO_DESCRIPTION STO_STO_DESCRIPTION
       , DETAIL.DIC_DELAY_UPDATE_TYPE_ID
       , DETAIL.PDE_DELAY_UPDATE_TEXT
       , DETAIL.GCO1_CHARACTERIZATION_ID
       , DETAIL.GCO2_CHARACTERIZATION_ID
       , DETAIL.GCO3_CHARACTERIZATION_ID
       , DETAIL.GCO4_CHARACTERIZATION_ID
       , DETAIL.GCO5_CHARACTERIZATION_ID
       , SUBSTR(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO1_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO1_CHARAC_DESCR
       , SUBSTR(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO2_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO2_CHARAC_DESCR
       , SUBSTR(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO3_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO3_CHARAC_DESCR
       , SUBSTR(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO4_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO4_CHARAC_DESCR
       , SUBSTR(GCO_FUNCTIONS.GetCharacDescr(DETAIL.GCO5_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO5_CHARAC_DESCR
       , DETAIL.PDE_CHARACTERIZATION_VALUE_1
       , DETAIL.PDE_CHARACTERIZATION_VALUE_2
       , DETAIL.PDE_CHARACTERIZATION_VALUE_3
       , DETAIL.PDE_CHARACTERIZATION_VALUE_4
       , DETAIL.PDE_CHARACTERIZATION_VALUE_5
       , DETAIL.PDE_PIECE
       , DETAIL.PDE_SET
       , DETAIL.PDE_VERSION
       , DETAIL.PDE_CHRONOLOGICAL
       , DETAIL.PDE_STD_CHAR_1
       , DETAIL.PDE_STD_CHAR_2
       , DETAIL.PDE_STD_CHAR_3
       , DETAIL.PDE_STD_CHAR_4
       , DETAIL.PDE_STD_CHAR_5
       , DETAIL.PDE_BASIS_DELAY
       , DETAIL.PDE_BASIS_DELAY_M
       , DETAIL.PDE_BASIS_DELAY_W
       , DETAIL.PDE_BASIS_QUANTITY
       , DETAIL.PDE_BASIS_QUANTITY_SU
       , DETAIL.PDE_INTERMEDIATE_DELAY
       , DETAIL.PDE_INTERMEDIATE_DELAY_M
       , DETAIL.PDE_INTERMEDIATE_DELAY_W
       , DETAIL.PDE_INTERMEDIATE_QUANTITY
       , DETAIL.PDE_INTERMEDIATE_QUANTITY_SU
       , DETAIL.PDE_FINAL_DELAY
       , DETAIL.PDE_FINAL_DELAY_M
       , DETAIL.PDE_FINAL_DELAY_W
       , DETAIL.PDE_FINAL_QUANTITY
       , DETAIL.PDE_FINAL_QUANTITY_SU
       , DETAIL.PDE_BALANCE_QUANTITY
       , DETAIL.P_PDE_BALANCE_QUANTITY
       , DETAIL.P_PDE_BALANCE_QUANTITY_PARENT
       , DETAIL.P_PDE_BASIS_QUANTITY
       , DETAIL.P_PDE_BASIS_QUANTITY_SU
       , DETAIL.P_PDE_INTERMEDIATE_QUANTITY
       , DETAIL.P_PDE_INTERMEDIATE_QUANTITY_SU
       , DETAIL.P_PDE_FINAL_QUANTITY
       , DETAIL.P_PDE_FINAL_QUANTITY_SU
       , DETAIL.NEED_FAN_EXCEED_QTY
       , DETAIL.NEED_FAN_FREE_QTY
       , DETAIL.NEED_FAN_FULL_QTY
       , DETAIL.NEED_FAN_NETW_QTY
       , DETAIL.NEED_FAN_PREV_QTY
       , DETAIL.NEED_FAN_REALIZE_QTY
       , DETAIL.NEED_FAN_RETURN_QTY
       , DETAIL.NEED_FAN_STK_QTY
       , DETAIL.NEED_FAL_NETWORK_NEED_ID
       , DETAIL.SUPPLY_FAN_EXCEED_QTY
       , DETAIL.SUPPLY_FAN_FREE_QTY
       , DETAIL.SUPPLY_FAN_FULL_QTY
       , DETAIL.SUPPLY_FAN_NETW_QTY
       , DETAIL.SUPPLY_FAN_PREV_QTY
       , DETAIL.SUPPLY_FAN_REALIZE_QTY
       , DETAIL.SUPPLY_FAN_RETURN_QTY
       , DETAIL.SUPPLY_FAN_STK_QTY
       , DETAIL.SUPPLY_FAL_NETWORK_SUPPLY_ID
       , DETAIL.LOT_REFCOMPL
       , DETAIL.GOO_MAJOR_REFERENCE COMP_MAJOR_REFERENCE
       , DETAIL.SCS_SHORT_DESCR
       , DETAIL.SCS_LONG_DESCR
       , DETAIL.SCS_FREE_DESCR
       , FOO.FOO_TOTAL_NET_WEIGHT_MEAS
       , FOO.FOO_TOTAL_GROSS_WEIGHT_MEAS
       , POS.POS_TARIFF_SET
	   , DIC_CATEGORY_FREE_1_ID
    FROM PCS.PC_LANG LANG
       , STM_LOCATION LOC
       , STM_LOCATION LOC_LOC
       , ACS_FIN_ACC_S_PAYMENT AFA
       , ACS_PAYMENT_METHOD APM
       , ACS_ACCOUNT TVA
       , DOC_RECORD REC
       , DOC_RECORD REC_POS
       , DOC_FOOT FOO
       , GCO_FREE_DATA GFD
       , GCO_CUSTOMS_ELEMENT GCE
       , PCS.PC_CNTRY CNT_CUSTOMS
       , PCS.PC_CNTRY CNT_ORIGIN
       , PAC_SENDING_CONDITION PSC
       , PAC_PAYMENT_CONDITION PMT
       , ACS_FINANCIAL_CURRENCY AFC
       , DOC_FREE_DATA DFD
       , DOC_GAUGE_SIGNATORY DGS
       , DOC_GAUGE_SIGNATORY DGS2
       , DOC_GAUGE_POSITION DGP
       , PAC_CUSTOM_PARTNER CUS
       , ACS_ACCOUNT ACCC
       , PAC_ADDRESS ADR
       , PAC_ADDRESS ADR2
       , PAC_ADDRESS ADR3
       , PAC_REPRESENTATIVE REP
       , PAC_REPRESENTATIVE REP_POS
       , PAC_ADDRESS ADR_SEN
       , PAC_PERSON PER_SEN
       , PAC_PERSON PER
       , PAC_PERSON PER2
       , PAC_PERSON PER3
       , PAC_SUPPLIER_PARTNER SUP
       , ACS_ACCOUNT ACCS
       , PAC_THIRD THI
       , ACS_TAX_CODE ATC
       , PCS.PC_CURR CUR
       , PCS.PC_CNTRY CNT
       , PCS.PC_CNTRY CNT2
       , PCS.PC_CNTRY CNT3
       , DOC_GAUGE GAU
       , DOC_GAUGE_STRUCTURED GST
       , STM_STOCK STM
       , STM_STOCK STM_STM
       , GCO_GOOD GOO
       , GCO_GOOD_CATEGORY CAT
       , GCO_PRODUCT PDT
       , DOC_POSITION POS
       , DOC_DOCUMENT DMT
       , (SELECT DMT.DMT_NUMBER
               , POS.DOC_POSITION_ID POSITIONID
               , PDE.DOC_POSITION_DETAIL_ID
               , (PDE.FAL_SCHEDULE_STEP_ID) FAL_SCHEDULE_STEP_ID
               , (DMT_PERE.DMT_NUMBER) PERE_DMT_NUMBER
               , (DMT_PERE.DMT_DATE_DOCUMENT) PERE_DMT_DATE_DOCUMENT
               , (GAU_PERE.C_GAUGE_TITLE) PERE_C_GAUGE_TITLE
               , (DMT_PERE.DMT_PARTNER_NUMBER) PERE_DMT_PARTNER_NUMBER
               , (DMT_PERE.DMT_PARTNER_REFERENCE) PERE_DMT_PARTNTER_REFERENCE
               , (DMT_PERE.DMT_DATE_PARTNER_DOCUMENT) PERE_DATE_PARTNER_DOCUMENT
               , (DMT_G_PERE.DMT_NUMBER) G_PERE_DMT_NUMBER
               , (DMT_G_PERE.DMT_DATE_DOCUMENT) G_PERE_DMT_DATE_DOCUMENT
               , (GAU_G_PERE.C_GAUGE_TITLE) G_PERE_C_GAUGE_TITLE
               , (DMT_G_PERE.DMT_PARTNER_NUMBER) G_PERE_DMT_PARTNER_NUMBER
               , (DMT_G_PERE.DMT_PARTNER_REFERENCE) G_PERE_DMT_PARTNTER_REFERENCE
               , (DMT_G_PERE.DMT_DATE_PARTNER_DOCUMENT) G_PERE_DATE_PARTNER_DOCUMENT
               , (PDE.STM_LOCATION_ID) STM_LOCATION_ID
               , (PDE.STM_STM_LOCATION_ID) STM_STM_LOCATION_ID
               , (PDE.DIC_DELAY_UPDATE_TYPE_ID) DIC_DELAY_UPDATE_TYPE_ID
               , (PDE.PDE_DELAY_UPDATE_TEXT) PDE_DELAY_UPDATE_TEXT
               , PDE.GCO_CHARACTERIZATION_ID GCO1_CHARACTERIZATION_ID
               , PDE.GCO_GCO_CHARACTERIZATION_ID GCO2_CHARACTERIZATION_ID
               , PDE.GCO2_GCO_CHARACTERIZATION_ID GCO3_CHARACTERIZATION_ID
               , PDE.GCO3_GCO_CHARACTERIZATION_ID GCO4_CHARACTERIZATION_ID
               , PDE.GCO4_GCO_CHARACTERIZATION_ID GCO5_CHARACTERIZATION_ID
               , (PDE.PDE_CHARACTERIZATION_VALUE_1) PDE_CHARACTERIZATION_VALUE_1
               , (PDE.PDE_CHARACTERIZATION_VALUE_2) PDE_CHARACTERIZATION_VALUE_2
               , (PDE.PDE_CHARACTERIZATION_VALUE_3) PDE_CHARACTERIZATION_VALUE_3
               , (PDE.PDE_CHARACTERIZATION_VALUE_4) PDE_CHARACTERIZATION_VALUE_4
               , (PDE.PDE_CHARACTERIZATION_VALUE_5) PDE_CHARACTERIZATION_VALUE_5
               , PDE.PDE_PIECE
               , PDE.PDE_SET
               , PDE.PDE_VERSION
               , PDE.PDE_CHRONOLOGICAL
               , PDE.PDE_STD_CHAR_1
               , PDE.PDE_STD_CHAR_2
               , PDE.PDE_STD_CHAR_3
               , PDE.PDE_STD_CHAR_4
               , PDE.PDE_STD_CHAR_5
               , (PDE.PDE_BASIS_DELAY) PDE_BASIS_DELAY
               , (PDE.PDE_BASIS_DELAY_M) PDE_BASIS_DELAY_M
               , (PDE.PDE_BASIS_DELAY_W) PDE_BASIS_DELAY_W
               , (PDE.PDE_BASIS_QUANTITY) PDE_BASIS_QUANTITY
               , (PDE.PDE_BASIS_QUANTITY_SU) PDE_BASIS_QUANTITY_SU
               , (PDE.PDE_INTERMEDIATE_DELAY) PDE_INTERMEDIATE_DELAY
               , (PDE.PDE_INTERMEDIATE_DELAY_M) PDE_INTERMEDIATE_DELAY_M
               , (PDE.PDE_INTERMEDIATE_DELAY_W) PDE_INTERMEDIATE_DELAY_W
               , (PDE.PDE_INTERMEDIATE_QUANTITY) PDE_INTERMEDIATE_QUANTITY
               , (PDE.PDE_INTERMEDIATE_QUANTITY_SU) PDE_INTERMEDIATE_QUANTITY_SU
               , (PDE.PDE_FINAL_DELAY) PDE_FINAL_DELAY
               , (PDE.PDE_FINAL_DELAY_M) PDE_FINAL_DELAY_M
               , (PDE.PDE_FINAL_DELAY_W) PDE_FINAL_DELAY_W
               , (PDE.PDE_FINAL_QUANTITY) PDE_FINAL_QUANTITY
               , (PDE.PDE_FINAL_QUANTITY_SU) PDE_FINAL_QUANTITY_SU
               , (PDE.PDE_BALANCE_QUANTITY) PDE_BALANCE_QUANTITY
               , (PERE.DOC_POSITION_DETAIL_ID) PERE_DOC_POSITION_DETAIL_ID
               , (PERE.PDE_BALANCE_QUANTITY) P_PDE_BALANCE_QUANTITY
               , (PERE.PDE_BALANCE_QUANTITY_PARENT) P_PDE_BALANCE_QUANTITY_PARENT
               , (PERE.PDE_BASIS_QUANTITY) P_PDE_BASIS_QUANTITY
               , (PERE.PDE_BASIS_QUANTITY_SU) P_PDE_BASIS_QUANTITY_SU
               , (PERE.PDE_INTERMEDIATE_QUANTITY) P_PDE_INTERMEDIATE_QUANTITY
               , (PERE.PDE_INTERMEDIATE_QUANTITY_SU) P_PDE_INTERMEDIATE_QUANTITY_SU
               , (PERE.PDE_FINAL_QUANTITY) P_PDE_FINAL_QUANTITY
               , (PERE.PDE_FINAL_QUANTITY_SU) P_PDE_FINAL_QUANTITY_SU
               , (G_PERE.DOC_POSITION_DETAIL_ID) G_PERE_DOC_POSITION_DETAIL_ID
               , (NEE.FAN_EXCEED_QTY) NEED_FAN_EXCEED_QTY
               , (NEE.FAN_FREE_QTY) NEED_FAN_FREE_QTY
               , (NEE.FAN_FULL_QTY) NEED_FAN_FULL_QTY
               , (NEE.FAN_NETW_QTY) NEED_FAN_NETW_QTY
               , (NEE.FAN_PREV_QTY) NEED_FAN_PREV_QTY
               , (NEE.FAN_REALIZE_QTY) NEED_FAN_REALIZE_QTY
               , (NEE.FAN_RETURN_QTY) NEED_FAN_RETURN_QTY
               , (NEE.FAN_STK_QTY) NEED_FAN_STK_QTY
               , (NEE.FAL_NETWORK_NEED_ID) NEED_FAL_NETWORK_NEED_ID
               , (SUPP.FAN_EXCEED_QTY) SUPPLY_FAN_EXCEED_QTY
               , (SUPP.FAN_FREE_QTY) SUPPLY_FAN_FREE_QTY
               , (SUPP.FAN_FULL_QTY) SUPPLY_FAN_FULL_QTY
               , (SUPP.FAN_NETW_QTY) SUPPLY_FAN_NETW_QTY
               , (SUPP.FAN_PREV_QTY) SUPPLY_FAN_PREV_QTY
               , (SUPP.FAN_REALIZE_QTY) SUPPLY_FAN_REALIZE_QTY
               , (SUPP.FAN_RETURN_QTY) SUPPLY_FAN_RETURN_QTY
               , (SUPP.FAN_STK_QTY) SUPPLY_FAN_STK_QTY
               , (SUPP.FAL_NETWORK_SUPPLY_ID) SUPPLY_FAL_NETWORK_SUPPLY_ID
               , (LOT.LOT_REFCOMPL) LOT_REFCOMPL
               , (COMP.GOO_MAJOR_REFERENCE) GOO_MAJOR_REFERENCE
               , (LNK.SCS_SHORT_DESCR) SCS_SHORT_DESCR
               , (LNK.SCS_LONG_DESCR) SCS_LONG_DESCR
               , (LNK.SCS_FREE_DESCR) SCS_FREE_DESCR
            FROM FAL_NETWORK_NEED NEE
               , FAL_NETWORK_SUPPLY SUPP
               , FAL_TASK_LINK LNK
               , FAL_LOT LOT
               , GCO_GOOD COMP
               , DOC_GAUGE_STRUCTURED GAU_G_PERE
               , DOC_GAUGE_STRUCTURED GAU_PERE
               , DOC_POSITION_DETAIL G_PERE
               , DOC_POSITION_DETAIL PERE
               , DOC_POSITION_DETAIL PDE
               , DOC_DOCUMENT DMT_G_PERE
               , DOC_DOCUMENT DMT_PERE
               , DOC_POSITION POS
               , DOC_DOCUMENT DMT
           WHERE DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
             AND POS.DOC_POSITION_ID = PDE.DOC_POSITION_ID
             AND PDE.DOC_DOC_POSITION_DETAIL_ID = PERE.DOC_POSITION_DETAIL_ID(+)
             AND PERE.DOC_DOCUMENT_ID = DMT_PERE.DOC_DOCUMENT_ID(+)
             AND PERE.DOC_DOC_POSITION_DETAIL_ID = G_PERE.DOC_POSITION_DETAIL_ID(+)
             AND PDE.FAL_SCHEDULE_STEP_ID = LNK.FAL_SCHEDULE_STEP_ID(+)
             AND LNK.FAL_LOT_ID = LOT.FAL_LOT_ID(+)
             AND LOT.GCO_GOOD_ID = COMP.GCO_GOOD_ID(+)
             AND PERE.DOC_GAUGE_ID = GAU_PERE.DOC_GAUGE_ID(+)
             AND G_PERE.DOC_DOCUMENT_ID = DMT_G_PERE.DOC_DOCUMENT_ID(+)
             AND G_PERE.DOC_GAUGE_ID = GAU_G_PERE.DOC_GAUGE_ID(+)
             AND PDE.DOC_POSITION_DETAIL_ID = NEE.DOC_POSITION_DETAIL_ID(+)
             AND PDE.DOC_POSITION_DETAIL_ID = SUPP.DOC_POSITION_DETAIL_ID(+)) DETAIL
   WHERE DMT.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID
     AND POS.DOC_POSITION_ID = DETAIL.POSITIONID
     AND DMT.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
     AND GAU.DOC_GAUGE_ID = GST.DOC_GAUGE_ID
     AND POS.DOC_GAUGE_POSITION_ID = DGP.DOC_GAUGE_POSITION_ID
     AND DMT.PC_LANG_ID = LANG.PC_LANG_ID
     AND POS.ACS_TAX_CODE_ID = TVA.ACS_ACCOUNT_ID(+)
     AND DMT.ACS_FIN_ACC_S_PAYMENT_ID = AFA.ACS_FIN_ACC_S_PAYMENT_ID(+)
     AND AFA.ACS_PAYMENT_METHOD_ID = APM.ACS_PAYMENT_METHOD_ID(+)
     AND DMT.PAC_REPRESENTATIVE_ID = REP.PAC_REPRESENTATIVE_ID(+)
     AND DMT.DOC_DOCUMENT_ID = DFD.DOC_DOCUMENT_ID(+)
     AND DMT.DOC_DOCUMENT_ID = FOO.DOC_DOCUMENT_ID(+)
     AND POS.ACS_TAX_CODE_ID = ATC.ACS_TAX_CODE_ID(+)
     AND POS.GCO_GOOD_ID = GCE.GCO_GOOD_ID(+)
     AND GCE.PC_CNTRY_ID = CNT_CUSTOMS.PC_CNTRY_ID(+)
     AND GCE.PC_ORIGIN_PC_CNTRY_ID = CNT_ORIGIN.PC_CNTRY_ID(+)
     AND POS.PAC_REPRESENTATIVE_ID = REP_POS.PAC_REPRESENTATIVE_ID(+)
     AND FOO.DOC_GAUGE_SIGNATORY_ID = DGS.DOC_GAUGE_SIGNATORY_ID(+)
     AND FOO.DOC_DOC_GAUGE_SIGNATORY_ID = DGS2.DOC_GAUGE_SIGNATORY_ID(+)
     AND DMT.DOC_RECORD_ID = REC.DOC_RECORD_ID(+)
     AND POS.DOC_RECORD_ID = REC_POS.DOC_RECORD_ID(+)
     AND DMT.PAC_SENDING_CONDITION_ID = PSC.PAC_SENDING_CONDITION_ID(+)
     AND PSC.PAC_ADDRESS_ID = ADR_SEN.PAC_ADDRESS_ID(+)
     AND ADR_SEN.PAC_PERSON_ID = PER_SEN.PAC_PERSON_ID(+)
     AND DMT.PAC_THIRD_ID = THI.PAC_THIRD_ID(+)
     AND DMT.PAC_THIRD_ID = CUS.PAC_CUSTOM_PARTNER_ID(+)
     AND CUS.ACS_AUXILIARY_ACCOUNT_ID = ACCC.ACS_ACCOUNT_ID(+)
     AND SUP.ACS_AUXILIARY_ACCOUNT_ID = ACCS.ACS_ACCOUNT_ID(+)
     AND DMT.PAC_THIRD_ID = SUP.PAC_SUPPLIER_PARTNER_ID(+)
     AND DMT.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID(+)
     AND ADR.PAC_PERSON_ID = PER.PAC_PERSON_ID(+)
     AND DMT.PAC_PAC_ADDRESS_ID = ADR2.PAC_ADDRESS_ID(+)
     AND ADR2.PAC_PERSON_ID = PER2.PAC_PERSON_ID(+)
     AND DMT.PAC2_PAC_ADDRESS_ID = ADR3.PAC_ADDRESS_ID(+)
     AND ADR3.PAC_PERSON_ID = PER3.PAC_PERSON_ID(+)
     AND DMT.PC_CNTRY_ID = CNT.PC_CNTRY_ID(+)
     AND DMT.PC__PC_CNTRY_ID = CNT2.PC_CNTRY_ID(+)
     AND DMT.PC_2_PC_CNTRY_ID = CNT3.PC_CNTRY_ID(+)
     AND DMT.ACS_FINANCIAL_CURRENCY_ID = AFC.ACS_FINANCIAL_CURRENCY_ID(+)
     AND AFC.PC_CURR_ID = CUR.PC_CURR_ID(+)
     AND DMT.PAC_PAYMENT_CONDITION_ID = PMT.PAC_PAYMENT_CONDITION_ID(+)
     AND DETAIL.STM_LOCATION_ID = LOC.STM_LOCATION_ID(+)
     AND DETAIL.STM_STM_LOCATION_ID = LOC_LOC.STM_LOCATION_ID(+)
     AND LOC.STM_STOCK_ID = STM.STM_STOCK_ID(+)
     AND LOC_LOC.STM_STOCK_ID = STM_STM.STM_STOCK_ID(+)
     AND POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID(+)
     AND GOO.GCO_GOOD_ID = PDT.GCO_GOOD_ID(+)
     AND GOO.GCO_GOOD_ID = GFD.GCO_GOOD_ID(+)
     AND GOO.GCO_GOOD_CATEGORY_ID = CAT.GCO_GOOD_CATEGORY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_DET_COPY_DISCHARGE" ("DOC_POS_DET_COPY_DISCHARGE_ID", "NEW_DOCUMENT_ID", "DOC_POSITION_DETAIL_ID", "DOC_POSITION_ID", "CRG_SELECT", "DOC_GAUGE_FLOW_ID", "DOC_DOC_POSITION_ID", "DOC_DOC_POSITION_DETAIL_ID", "DOC2_DOC_POSITION_DETAIL_ID", "GCO_GOOD_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "STM_STM_LOCATION_ID", "DIC_PDE_FREE_TABLE_1_ID", "DIC_PDE_FREE_TABLE_2_ID", "DIC_PDE_FREE_TABLE_3_ID", "FAL_SCHEDULE_STEP_ID", "DOC_DOCUMENT_ID", "PAC_THIRD_ID", "DOC_GAUGE_ID", "DOC_GAUGE_RECEIPT_ID", "DOC_GAUGE_COPY_ID", "C_GAUGE_TYPE_POS", "DIC_DELAY_UPDATE_TYPE_ID", "PDE_BASIS_DELAY", "PDE_BASIS_DELAY_W", "PDE_BASIS_DELAY_M", "PDE_INTERMEDIATE_DELAY", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_DELAY_M", "PDE_FINAL_DELAY", "PDE_FINAL_DELAY_W", "PDE_FINAL_DELAY_M", "PDE_BASIS_QUANTITY", "PDE_INTERMEDIATE_QUANTITY", "PDE_FINAL_QUANTITY", "PDE_BALANCE_QUANTITY", "PDE_BALANCE_QUANTITY_PARENT", "PDE_BASIS_QUANTITY_SU", "PDE_INTERMEDIATE_QUANTITY_SU", "PDE_FINAL_QUANTITY_SU", "PDE_MOVEMENT_QUANTITY", "PDE_MOVEMENT_VALUE", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "PDE_DELAY_UPDATE_TEXT", "PDE_DECIMAL_1", "PDE_DECIMAL_2", "PDE_DECIMAL_3", "PDE_TEXT_1", "PDE_TEXT_2", "PDE_TEXT_3", "PDE_GENERATE_MOVEMENT", "DCD_QUANTITY", "DCD_QUANTITY_SU", "POS_UNIT_OF_MEASURE_ID", "DCD_BALANCE_FLAG", "POS_CONVERT_FACTOR", "POS_CONVERT_FACTOR_CALC", "POS_GROSS_UNIT_VALUE", "POS_GROSS_UNIT_VALUE_INCL", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_UTIL_COEFF", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM", "DOC_GCO_GOOD_ID", "DCD_USE_PARENT_CHARACT", "DCD_USE_STOCK_LOCATION_ID", "DCD_VISIBLE", "DCD_DEPLOYED_COMPONENTS", "DCD_UPDATE_PARENT_DELAY", "PDE_PIECE", "PDE_SET", "PDE_VERSION", "PDE_CHRONOLOGICAL", "PDE_STD_CHAR_1", "PDE_STD_CHAR_2", "PDE_STD_CHAR_3", "PDE_STD_CHAR_4", "PDE_STD_CHAR_5", "PDE_BALANCE_PARENT", "FAL_NETWORK_LINK_ID", "PDE_DATE_1", "PDE_DATE_2", "PDE_DATE_3", "PDE_SQM_ACCEPTED_DELAY", "PDE_TRANSFERT_PROPRIETOR", "C_PDE_CREATE_MODE", "FAL_SUPPLY_REQUEST_ID", "GCO_GCO_GOOD_ID", "PDE_MOVEMENT_DATE", "DOC_RECORD_ID", "DOC_POSITION_SRC_ID", "DOC_DOCUMENT_SRC_ID", "CML_EVENTS_ID", "ACS_FINANCIAL_ACCOUNT_BS_ID", "ACS_FINANCIAL_ACCOUNT_PL_ID", "ACS_DIVISION_ACCOUNT_BS_ID", "ACS_DIVISION_ACCOUNT_PL_ID", "ACS_CPN_ACCOUNT_BS_ID", "ACS_CPN_ACCOUNT_PL_ID", "ACS_CDA_ACCOUNT_BS_ID", "ACS_CDA_ACCOUNT_PL_ID", "ACS_PF_ACCOUNT_BS_ID", "ACS_PF_ACCOUNT_PL_ID", "ACS_PJ_ACCOUNT_BS_ID", "ACS_PJ_ACCOUNT_PL_ID", "DOC_RECORD_BS_ID", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "PDE_IMF_NUMBER_1", "PDE_IMF_NUMBER_2", "PDE_IMF_NUMBER_3", "PDE_IMF_NUMBER_4", "PDE_IMF_NUMBER_5", "PDE_IMF_TEXT_1", "PDE_IMF_TEXT_2", "PDE_IMF_TEXT_3", "PDE_IMF_TEXT_4", "PDE_IMF_TEXT_5", "POS_GROSS_VALUE", "POS_NET_VALUE_EXCL", "DCD_FORCE_AMOUNT", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_THIRD_CDA_ID", "PAC_THIRD_VAT_ID", "DOC_INVOICE_EXPIRY_ID", "PDE_ADDENDUM_QTY_BALANCED", "PDE_ADDENDUM_SRC_PDE_ID", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "PDE_GAP_PURCHASE_PRICE", "DOC_PDE_LITIG_ID", "FAL_LOT_ID", "GCO_MANUFACTURED_GOOD_ID", "PDE_ATTRIB_QUANTITY", "STM_STOCK_MOVEMENT_ID", "PDE_ST_PT_REJECT", "PDE_ST_CPT_REJECT", "PDE_IMF_DATE_1", "PDE_IMF_DATE_2", "PDE_IMF_DATE_3", "PDE_IMF_DATE_4", "PDE_IMF_DATE_5", "PDE_CURR_RISK_DISCHARGE_DONE", "GCO_QUALITY_STATUS_ID") AS
  select "DOC_POS_DET_COPY_DISCHARGE_ID","NEW_DOCUMENT_ID","DOC_POSITION_DETAIL_ID","DOC_POSITION_ID","CRG_SELECT","DOC_GAUGE_FLOW_ID","DOC_DOC_POSITION_ID","DOC_DOC_POSITION_DETAIL_ID","DOC2_DOC_POSITION_DETAIL_ID","GCO_GOOD_ID","STM_LOCATION_ID","GCO_CHARACTERIZATION_ID","GCO_GCO_CHARACTERIZATION_ID","GCO2_GCO_CHARACTERIZATION_ID","GCO3_GCO_CHARACTERIZATION_ID","GCO4_GCO_CHARACTERIZATION_ID","STM_STM_LOCATION_ID","DIC_PDE_FREE_TABLE_1_ID","DIC_PDE_FREE_TABLE_2_ID","DIC_PDE_FREE_TABLE_3_ID","FAL_SCHEDULE_STEP_ID","DOC_DOCUMENT_ID","PAC_THIRD_ID","DOC_GAUGE_ID","DOC_GAUGE_RECEIPT_ID","DOC_GAUGE_COPY_ID","C_GAUGE_TYPE_POS","DIC_DELAY_UPDATE_TYPE_ID","PDE_BASIS_DELAY","PDE_BASIS_DELAY_W","PDE_BASIS_DELAY_M","PDE_INTERMEDIATE_DELAY","PDE_INTERMEDIATE_DELAY_W","PDE_INTERMEDIATE_DELAY_M","PDE_FINAL_DELAY","PDE_FINAL_DELAY_W","PDE_FINAL_DELAY_M","PDE_BASIS_QUANTITY","PDE_INTERMEDIATE_QUANTITY","PDE_FINAL_QUANTITY","PDE_BALANCE_QUANTITY","PDE_BALANCE_QUANTITY_PARENT","PDE_BASIS_QUANTITY_SU","PDE_INTERMEDIATE_QUANTITY_SU","PDE_FINAL_QUANTITY_SU","PDE_MOVEMENT_QUANTITY","PDE_MOVEMENT_VALUE","PDE_CHARACTERIZATION_VALUE_1","PDE_CHARACTERIZATION_VALUE_2","PDE_CHARACTERIZATION_VALUE_3","PDE_CHARACTERIZATION_VALUE_4","PDE_CHARACTERIZATION_VALUE_5","PDE_DELAY_UPDATE_TEXT","PDE_DECIMAL_1","PDE_DECIMAL_2","PDE_DECIMAL_3","PDE_TEXT_1","PDE_TEXT_2","PDE_TEXT_3","PDE_GENERATE_MOVEMENT","DCD_QUANTITY","DCD_QUANTITY_SU","POS_UNIT_OF_MEASURE_ID","DCD_BALANCE_FLAG","POS_CONVERT_FACTOR","POS_CONVERT_FACTOR_CALC","POS_GROSS_UNIT_VALUE","POS_GROSS_UNIT_VALUE_INCL","POS_NET_UNIT_VALUE","POS_NET_UNIT_VALUE_INCL","POS_UTIL_COEFF","A_DATECRE","A_DATEMOD","A_IDCRE","A_IDMOD","A_RECLEVEL","A_RECSTATUS","A_CONFIRM","DOC_GCO_GOOD_ID","DCD_USE_PARENT_CHARACT","DCD_USE_STOCK_LOCATION_ID","DCD_VISIBLE","DCD_DEPLOYED_COMPONENTS","DCD_UPDATE_PARENT_DELAY","PDE_PIECE","PDE_SET","PDE_VERSION","PDE_CHRONOLOGICAL","PDE_STD_CHAR_1","PDE_STD_CHAR_2","PDE_STD_CHAR_3","PDE_STD_CHAR_4","PDE_STD_CHAR_5","PDE_BALANCE_PARENT","FAL_NETWORK_LINK_ID","PDE_DATE_1","PDE_DATE_2","PDE_DATE_3","PDE_SQM_ACCEPTED_DELAY","PDE_TRANSFERT_PROPRIETOR","C_PDE_CREATE_MODE","FAL_SUPPLY_REQUEST_ID","GCO_GCO_GOOD_ID","PDE_MOVEMENT_DATE","DOC_RECORD_ID","DOC_POSITION_SRC_ID","DOC_DOCUMENT_SRC_ID","CML_EVENTS_ID","ACS_FINANCIAL_ACCOUNT_BS_ID","ACS_FINANCIAL_ACCOUNT_PL_ID","ACS_DIVISION_ACCOUNT_BS_ID","ACS_DIVISION_ACCOUNT_PL_ID","ACS_CPN_ACCOUNT_BS_ID","ACS_CPN_ACCOUNT_PL_ID","ACS_CDA_ACCOUNT_BS_ID","ACS_CDA_ACCOUNT_PL_ID","ACS_PF_ACCOUNT_BS_ID","ACS_PF_ACCOUNT_PL_ID","ACS_PJ_ACCOUNT_BS_ID","ACS_PJ_ACCOUNT_PL_ID","DOC_RECORD_BS_ID","HRM_PERSON_ID","FAM_FIXED_ASSETS_ID","C_FAM_TRANSACTION_TYP","DIC_IMP_FREE1_ID","DIC_IMP_FREE2_ID","DIC_IMP_FREE3_ID","DIC_IMP_FREE4_ID","DIC_IMP_FREE5_ID","PDE_IMF_NUMBER_1","PDE_IMF_NUMBER_2","PDE_IMF_NUMBER_3","PDE_IMF_NUMBER_4","PDE_IMF_NUMBER_5","PDE_IMF_TEXT_1","PDE_IMF_TEXT_2","PDE_IMF_TEXT_3","PDE_IMF_TEXT_4","PDE_IMF_TEXT_5","POS_GROSS_VALUE","POS_NET_VALUE_EXCL","DCD_FORCE_AMOUNT","PAC_THIRD_ACI_ID","PAC_THIRD_DELIVERY_ID","PAC_THIRD_TARIFF_ID","PAC_THIRD_CDA_ID","PAC_THIRD_VAT_ID","DOC_INVOICE_EXPIRY_ID","PDE_ADDENDUM_QTY_BALANCED","PDE_ADDENDUM_SRC_PDE_ID","POS_SHORT_DESCRIPTION","POS_LONG_DESCRIPTION","PDE_GAP_PURCHASE_PRICE","DOC_PDE_LITIG_ID","FAL_LOT_ID","GCO_MANUFACTURED_GOOD_ID","PDE_ATTRIB_QUANTITY","STM_STOCK_MOVEMENT_ID","PDE_ST_PT_REJECT","PDE_ST_CPT_REJECT","PDE_IMF_DATE_1","PDE_IMF_DATE_2","PDE_IMF_DATE_3","PDE_IMF_DATE_4","PDE_IMF_DATE_5","PDE_CURR_RISK_DISCHARGE_DONE","GCO_QUALITY_STATUS_ID"
    from DOC_POS_DET_COPY_DISCHARGE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_FATHER" ("DMT_NUMBER", "DOC_DOCUMENT_ID", "DOC_POSITION_ID", "POS_NUMBER", "DECH_DMT_NUMBER", "DECH_DOC_DOCUMENT_ID", "DECH_DOC_POSITION_ID", "DECH_POS_NUMBER") AS
  select distinct DOC_DOCUMENT.DMT_NUMBER
                , DOC_DOCUMENT.DOC_DOCUMENT_ID
                , DOC_POSITION.DOC_POSITION_ID
                , DOC_POSITION.POS_NUMBER
                , DECH_DOC_DOCUMENT.DMT_NUMBER DECH_DMT_NUMBER
                , DECH_DOC_DOCUMENT.DOC_DOCUMENT_ID DECH_DOC_DOCUMENT_ID
                , DECH_DOC_POSITION.DOC_POSITION_ID DECH_DOC_POSITION_ID
                , DECH_DOC_POSITION.POS_NUMBER DECH_POS_NUMBER
             from DOC_DOCUMENT DOC_DOCUMENT
                , DOC_POSITION DOC_POSITION
                , DOC_POSITION_DETAIL DOC_POSITION_DETAIL
                , DOC_POSITION_DETAIL DECH_DOC_POSITION_DETAIL
                , DOC_POSITION DECH_DOC_POSITION
                , DOC_DOCUMENT DECH_DOC_DOCUMENT
            where DOC_DOCUMENT."DOC_DOCUMENT_ID" = DOC_POSITION."DOC_DOCUMENT_ID"
              and DOC_POSITION."DOC_POSITION_ID" = DOC_POSITION_DETAIL."DOC_POSITION_ID"
              and DOC_POSITION_DETAIL."DOC_DOC_POSITION_DETAIL_ID" = DECH_DOC_POSITION_DETAIL."DOC_POSITION_DETAIL_ID"
              and DECH_DOC_POSITION_DETAIL."DOC_POSITION_ID" = DECH_DOC_POSITION."DOC_POSITION_ID"
              and DECH_DOC_POSITION."DOC_DOCUMENT_ID" = DECH_DOC_DOCUMENT."DOC_DOCUMENT_ID"


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_IMPUTATION" ("DOC_POSITION_ID", "DOC_DOCUMENT_ID", "DOC_RECORD_ID", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "C_FAM_TRANSACTION_TYP", "FAM_FIXED_ASSETS_ID", "HRM_PERSON_ID", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "POI_AMOUNT", "POI_AMOUNT_B", "POI_AMOUNT_E", "POI_AMOUNT_V", "POI_VAT_AMOUNT", "POI_VAT_AMOUNT_B", "POI_VAT_AMOUNT_E", "POI_VAT_AMOUNT_V", "POI_IMF_NUMBER_1", "POI_IMF_NUMBER_2", "POI_IMF_NUMBER_3", "POI_IMF_NUMBER_4", "POI_IMF_NUMBER_5", "POI_IMF_TEXT_1", "POI_IMF_TEXT_2", "POI_IMF_TEXT_3", "POI_IMF_TEXT_4", "POI_IMF_TEXT_5", "POI_IMF_DATE_1", "POI_IMF_DATE_2", "POI_IMF_DATE_3", "POI_IMF_DATE_4", "POI_IMF_DATE_5", "POI_RATIO", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS") AS
  select DOC_POSITION_ID
       , DOC_DOCUMENT_ID
       , DOC_RECORD_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , C_FAM_TRANSACTION_TYP
       , FAM_FIXED_ASSETS_ID
       , HRM_PERSON_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_DIVISION_ACCOUNT_ID
       , POI_AMOUNT
       , POI_AMOUNT_B
       , POI_AMOUNT_E
       , POI_AMOUNT_V
       , POI_VAT_AMOUNT
       , POI_VAT_AMOUNT_B
       , POI_VAT_AMOUNT_E
       , POI_VAT_AMOUNT_V
       , POI_IMF_NUMBER_1
       , POI_IMF_NUMBER_2
       , POI_IMF_NUMBER_3
       , POI_IMF_NUMBER_4
       , POI_IMF_NUMBER_5
       , POI_IMF_TEXT_1
       , POI_IMF_TEXT_2
       , POI_IMF_TEXT_3
       , POI_IMF_TEXT_4
       , POI_IMF_TEXT_5
       , POI_IMF_DATE_1
       , POI_IMF_DATE_2
       , POI_IMF_DATE_3
       , POI_IMF_DATE_4
       , POI_IMF_DATE_5
       , POI_RATIO
       , A_CONFIRM
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
    from DOC_POSITION_IMPUTATION
   where DOC_POSITION_ID is not null
  union
  select DOC_POSITION_ID
       , DOC_DOCUMENT_ID
       , nvl(DOC_DOC_RECORD_ID, DOC_RECORD_ID) DOC_RECORD_ID
       , ACS_PJ_ACCOUNT_ID
       , ACS_PF_ACCOUNT_ID
       , ACS_FINANCIAL_ACCOUNT_ID
       , DIC_IMP_FREE1_ID
       , DIC_IMP_FREE2_ID
       , DIC_IMP_FREE3_ID
       , DIC_IMP_FREE4_ID
       , DIC_IMP_FREE5_ID
       , C_FAM_TRANSACTION_TYP
       , FAM_FIXED_ASSETS_ID
       , HRM_PERSON_ID
       , ACS_CDA_ACCOUNT_ID
       , ACS_CPN_ACCOUNT_ID
       , ACS_DIVISION_ACCOUNT_ID
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE, POS_GROSS_VALUE_INCL) POS_AMOUNT
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE_B, POS_GROSS_VALUE_INCL_B) POS_AMOUNT_B
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE_E, POS_GROSS_VALUE_INCL_E) POS_AMOUNT_E
       , decode(POS_INCLUDE_TAX_TARIFF, 0, POS_GROSS_VALUE_V, POS_GROSS_VALUE_INCL_V) POS_AMOUNT_V
       , POS_VAT_AMOUNT
       , POS_VAT_BASE_AMOUNT
       , POS_VAT_AMOUNT_E
       , POS_VAT_AMOUNT_V
       , POS_NUMBER POS_IMF_NUMBER_1
       , POS_IMF_NUMBER_2
       , POS_IMF_NUMBER_3
       , POS_IMF_NUMBER_4
       , POS_IMF_NUMBER_5
       , POS_IMF_TEXT_1
       , POS_IMF_TEXT_2
       , POS_IMF_TEXT_3
       , POS_IMF_TEXT_4
       , POS_IMF_TEXT_5
       , POS_IMF_DATE_1
       , POS_IMF_DATE_2
       , POS_IMF_DATE_3
       , POS_IMF_DATE_4
       , POS_IMF_DATE_5
       , 100 POI_RATIO
       , A_CONFIRM
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
    from DOC_POSITION
   where not exists(select DOC_POSITION_IMPUTATION_ID
                      from DOC_POSITION_IMPUTATION
                     where DOC_POSITION_ID = DOC_POSITION.DOC_POSITION_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_TOT_INVOICE_EXPIRY" ("DOC_DOCUMENT_ID", "DOC_FOOT_ID", "DOC_INVOICE_EXPIRY_ID", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_GOOD_TOT_AMOUNT_EXCL_B", "FOO_GOOD_TOT_AMOUNT_EXCL_E", "FOO_TOT_POS_AMOUNT", "FOO_TOT_POS_AMOUNT_B", "FOO_TOT_POS_AMOUNT_E", "FOO_TOT_POS_AMOUNT_V", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "FOO_TOTAL_RATE_FACTOR") AS
  select   FOO.DOC_DOCUMENT_ID
         , FOO.DOC_FOOT_ID
         , POS.DOC_INVOICE_EXPIRY_ID
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL) ), 0) FOO_GOOD_TOTAL_AMOUNT
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL_B) ), 0) FOO_GOOD_TOTAL_AMOUNT_B
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL_E) ), 0) FOO_GOOD_TOTAL_AMOUNT_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL_B) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL_B
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL_E) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT) ), 0) FOO_TOT_POS_AMOUNT
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT_B) ), 0) FOO_TOT_POS_AMOUNT_B
         , 0 FOO_TOT_POS_AMOUNT_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT_V) ), 0) FOO_TOT_POS_AMOUNT_V
         , nvl(sum(case
                     when POS.C_GAUGE_TYPE_POS in('7', '8', '9', '10') then POS.POS_GROSS_WEIGHT
                     when POS.C_GAUGE_TYPE_POS = '1'
                     and POS.DOC_DOC_POSITION_ID is null then POS.POS_GROSS_WEIGHT
                     else 0
                   end
                  )
             , 0
              ) FOO_TOTAL_GROSS_WEIGHT
         , nvl(sum(case
                     when POS.C_GAUGE_TYPE_POS in('7', '8', '9', '10') then POS.POS_NET_WEIGHT
                     when POS.C_GAUGE_TYPE_POS = '1'
                     and POS.DOC_DOC_POSITION_ID is null then POS.POS_NET_WEIGHT
                     else 0
                   end
                  )
             , 0
              ) FOO_TOTAL_NET_WEIGHT
         , nvl(sum(POS.POS_BASIS_QUANTITY), 0) FOO_TOTAL_BASIS_QUANTITY
         , nvl(sum(POS.POS_INTERMEDIATE_QUANTITY), 0) FOO_TOTAL_INTERM_QUANTITY
         , nvl(sum(POS.POS_FINAL_QUANTITY), 0) FOO_TOTAL_FINAL_QUANTITY
         , nvl(sum(POS.POS_RATE_FACTOR), 0) FOO_TOTAL_RATE_FACTOR   -- ???
      from DOC_POSITION POS
         , DOC_FOOT FOO
     where POS.DOC_DOCUMENT_ID(+) = FOO.DOC_DOCUMENT_ID
       and POS.C_DOC_POS_STATUS <> '05'   -- Exclure le montants les positions annules du montant du document
  group by FOO.DOC_DOCUMENT_ID
         , FOO.DOC_FOOT_ID
         , POS.DOC_INVOICE_EXPIRY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_POS_TOT_INX_RET_AMOUNT" ("DOC_DOCUMENT_ID", "DOC_FOOT_ID", "DOC_INVOICE_EXPIRY_ID", "FOO_GOOD_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT_B", "FOO_GOOD_TOTAL_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_GOOD_TOT_AMOUNT_EXCL_B", "FOO_GOOD_TOT_AMOUNT_EXCL_E", "FOO_TOT_POS_AMOUNT", "FOO_TOT_POS_AMOUNT_B", "FOO_TOT_POS_AMOUNT_E", "FOO_TOT_POS_AMOUNT_V", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "FOO_TOTAL_RATE_FACTOR") AS
  select   FOO.DOC_DOCUMENT_ID
         , FOO.DOC_FOOT_ID
         , POS.DOC_INVOICE_EXPIRY_ID
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL) ), 0) FOO_GOOD_TOTAL_AMOUNT
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL_B) ), 0) FOO_GOOD_TOTAL_AMOUNT_B
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_INCL_E) ), 0) FOO_GOOD_TOTAL_AMOUNT_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL_B) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL_B
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_NET_VALUE_EXCL_E) ), 0) FOO_GOOD_TOT_AMOUNT_EXCL_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT) ), 0) FOO_TOT_POS_AMOUNT
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT_B) ), 0) FOO_TOT_POS_AMOUNT_B
         , 0 FOO_TOT_POS_AMOUNT_E
         , nvl(sum(decode(POS.C_GAUGE_TYPE_POS, '6', 0, POS.POS_VAT_TOTAL_AMOUNT_V) ), 0) FOO_TOT_POS_AMOUNT_V
         , nvl(sum(case
                     when POS.C_GAUGE_TYPE_POS in('7', '8', '9', '10') then POS.POS_GROSS_WEIGHT
                     when POS.C_GAUGE_TYPE_POS = '1'
                     and POS.DOC_DOC_POSITION_ID is null then POS.POS_GROSS_WEIGHT
                     else 0
                   end
                  )
             , 0
              ) FOO_TOTAL_GROSS_WEIGHT
         , nvl(sum(case
                     when POS.C_GAUGE_TYPE_POS in('7', '8', '9', '10') then POS.POS_NET_WEIGHT
                     when POS.C_GAUGE_TYPE_POS = '1'
                     and POS.DOC_DOC_POSITION_ID is null then POS.POS_NET_WEIGHT
                     else 0
                   end
                  )
             , 0
              ) FOO_TOTAL_NET_WEIGHT
         , nvl(sum(POS.POS_BASIS_QUANTITY), 0) FOO_TOTAL_BASIS_QUANTITY
         , nvl(sum(POS.POS_INTERMEDIATE_QUANTITY), 0) FOO_TOTAL_INTERM_QUANTITY
         , nvl(sum(POS.POS_FINAL_QUANTITY), 0) FOO_TOTAL_FINAL_QUANTITY
         , nvl(sum(POS.POS_RATE_FACTOR), 0) FOO_TOTAL_RATE_FACTOR   -- ???
      from DOC_POSITION POS
         , DOC_FOOT FOO
     where POS.DOC_DOCUMENT_ID(+) = FOO.DOC_DOCUMENT_ID
       and POS.C_DOC_POS_STATUS <> '05'   -- Exclure le montants les positions annules du montant du document
       and DOC_INVOICE_EXPIRY_FUNCTIONS.getDepositRootLink(POS.DOC_POSITION_ID) is not null
  group by FOO.DOC_DOCUMENT_ID
         , FOO.DOC_FOOT_ID
         , POS.DOC_INVOICE_EXPIRY_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PROV_TO_ADD" ("ACTION", "GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPR_PROVISORY_INPUT", "SPR_PROVISORY_OUTPUT", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT") AS
  select 'I' "ACTION"
       , SPR.GCO_GOOD_ID
       , SPR.STM_LOCATION_ID
       , SPR.PDE_CHARACTERIZATION_VALUE_1
       , SPR.PDE_CHARACTERIZATION_VALUE_2
       , SPR.PDE_CHARACTERIZATION_VALUE_3
       , SPR.PDE_CHARACTERIZATION_VALUE_4
       , SPR.PDE_CHARACTERIZATION_VALUE_5
       , SPR.GCO_CHARACTERIZATION_ID
       , SPR.GCO_GCO_CHARACTERIZATION_ID
       , SPR.GCO2_GCO_CHARACTERIZATION_ID
       , SPR.GCO3_GCO_CHARACTERIZATION_ID
       , SPR.GCO4_GCO_CHARACTERIZATION_ID
       , nvl(SPR.SPR_PROVISORY_INPUT,0) SPR_PROVISORY_INPUT
       , nvl(SPR.SPR_PROVISORY_OUTPUT,0) SPR_PROVISORY_OUTPUT
       , 0 SPO_PROVISORY_INPUT
       , 0 SPO_PROVISORY_OUTPUT
    from ( (select GCO_GOOD_ID
                 , STM_LOCATION_ID
                 , PDE_CHARACTERIZATION_VALUE_1
                 , PDE_CHARACTERIZATION_VALUE_2
                 , PDE_CHARACTERIZATION_VALUE_3
                 , PDE_CHARACTERIZATION_VALUE_4
                 , PDE_CHARACTERIZATION_VALUE_5
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
              from v_stm_stock_prov_qty spr
             where nvl(SPR_PROVISORY_INPUT, 0) <> 0
                or nvl(SPR_PROVISORY_OUTPUT, 0) <> 0)
          minus
          (select GCO_GOOD_ID
                , STM_LOCATION_ID
                , SPO_CHARACTERIZATION_VALUE_1 PDE_CHARACTERIZATION_VALUE_1
                , SPO_CHARACTERIZATION_VALUE_2 PDE_CHARACTERIZATION_VALUE_2
                , SPO_CHARACTERIZATION_VALUE_3 PDE_CHARACTERIZATION_VALUE_3
                , SPO_CHARACTERIZATION_VALUE_4 PDE_CHARACTERIZATION_VALUE_4
                , SPO_CHARACTERIZATION_VALUE_5 PDE_CHARACTERIZATION_VALUE_5
                , GCO_CHARACTERIZATION_ID
                , GCO_GCO_CHARACTERIZATION_ID
                , GCO2_GCO_CHARACTERIZATION_ID
                , GCO3_GCO_CHARACTERIZATION_ID
                , GCO4_GCO_CHARACTERIZATION_ID
             from stm_stock_position spo) ) SPO
       , v_stm_stock_prov_qty spr
   where SPR.GCO_GOOD_ID = SPO.GCO_GOOD_ID
     and SPR.STM_LOCATION_ID = SPO.STM_LOCATION_ID
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_1, 0) = nvl(SPO.PDE_CHARACTERIZATION_VALUE_1, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_2, 0) = nvl(SPO.PDE_CHARACTERIZATION_VALUE_2, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_3, 0) = nvl(SPO.PDE_CHARACTERIZATION_VALUE_3, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_4, 0) = nvl(SPO.PDE_CHARACTERIZATION_VALUE_4, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_5, 0) = nvl(SPO.PDE_CHARACTERIZATION_VALUE_5, 0)
     and nvl(SPR.GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO2_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO2_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO3_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO3_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO4_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO4_GCO_CHARACTERIZATION_ID, 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PROV_TO_ADD_LIGHT" ("GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID") AS
  (select GCO_GOOD_ID
        , STM_LOCATION_ID
        , PDE_CHARACTERIZATION_VALUE_1
        , PDE_CHARACTERIZATION_VALUE_2
        , PDE_CHARACTERIZATION_VALUE_3
        , PDE_CHARACTERIZATION_VALUE_4
        , PDE_CHARACTERIZATION_VALUE_5
        , GCO_CHARACTERIZATION_ID
        , GCO_GCO_CHARACTERIZATION_ID
        , GCO2_GCO_CHARACTERIZATION_ID
        , GCO3_GCO_CHARACTERIZATION_ID
        , GCO4_GCO_CHARACTERIZATION_ID
     from v_stm_stock_prov_qty spr
    where nvl(SPR_PROVISORY_INPUT, 0) <> 0
       or nvl(SPR_PROVISORY_OUTPUT, 0) <> 0)
  minus
  (select GCO_GOOD_ID
        , STM_LOCATION_ID
        , SPO_CHARACTERIZATION_VALUE_1 PDE_CHARACTERIZATION_VALUE_1
        , SPO_CHARACTERIZATION_VALUE_2 PDE_CHARACTERIZATION_VALUE_2
        , SPO_CHARACTERIZATION_VALUE_3 PDE_CHARACTERIZATION_VALUE_3
        , SPO_CHARACTERIZATION_VALUE_4 PDE_CHARACTERIZATION_VALUE_4
        , SPO_CHARACTERIZATION_VALUE_5 PDE_CHARACTERIZATION_VALUE_5
        , GCO_CHARACTERIZATION_ID
        , GCO_GCO_CHARACTERIZATION_ID
        , GCO2_GCO_CHARACTERIZATION_ID
        , GCO3_GCO_CHARACTERIZATION_ID
        , GCO4_GCO_CHARACTERIZATION_ID
     from stm_stock_position spo)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PROV_TO_DELETE" ("ACTION", "GCO_GOOD_ID", "STM_LOCATION_ID", "SPO_CHARACTERIZATION_VALUE_1", "SPO_CHARACTERIZATION_VALUE_2", "SPO_CHARACTERIZATION_VALUE_3", "SPO_CHARACTERIZATION_VALUE_4", "SPO_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPR_PROVISORY_INPUT", "SPR_PROVISORY_OUTPUT", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT") AS
  select 'D' "ACTION"
       , SPO.GCO_GOOD_ID
       , SPO.STM_LOCATION_ID
       , SPO.SPO_CHARACTERIZATION_VALUE_1
       , SPO.SPO_CHARACTERIZATION_VALUE_2
       , SPO.SPO_CHARACTERIZATION_VALUE_3
       , SPO.SPO_CHARACTERIZATION_VALUE_4
       , SPO.SPO_CHARACTERIZATION_VALUE_5
       , SPO.GCO_CHARACTERIZATION_ID
       , SPO.GCO_GCO_CHARACTERIZATION_ID
       , SPO.GCO2_GCO_CHARACTERIZATION_ID
       , SPO.GCO3_GCO_CHARACTERIZATION_ID
       , SPO.GCO4_GCO_CHARACTERIZATION_ID
       , 0 SPR_PROVISORY_INPUT
       , 0 SPR_PROVISORY_OUTPUT
       , nvl(SPO.SPO_PROVISORY_INPUT,0) SPO_PROVISORY_INPUT
       , nvl(SPO.SPO_PROVISORY_OUTPUT,0) SPO_PROVISORY_OUTPUT
    from ( (select GCO_GOOD_ID
                 , STM_LOCATION_ID
                 , SPO_CHARACTERIZATION_VALUE_1 PDE_CHARACTERIZATION_VALUE_1
                 , SPO_CHARACTERIZATION_VALUE_2 PDE_CHARACTERIZATION_VALUE_2
                 , SPO_CHARACTERIZATION_VALUE_3 PDE_CHARACTERIZATION_VALUE_3
                 , SPO_CHARACTERIZATION_VALUE_4 PDE_CHARACTERIZATION_VALUE_4
                 , SPO_CHARACTERIZATION_VALUE_5 PDE_CHARACTERIZATION_VALUE_5
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
              from stm_stock_position spo
             where nvl(SPO_PROVISORY_INPUT, 0) <> 0
                or nvl(SPO_PROVISORY_OUTPUT, 0) <> 0)
          minus
          (select GCO_GOOD_ID
                , STM_LOCATION_ID
                , PDE_CHARACTERIZATION_VALUE_1
                , PDE_CHARACTERIZATION_VALUE_2
                , PDE_CHARACTERIZATION_VALUE_3
                , PDE_CHARACTERIZATION_VALUE_4
                , PDE_CHARACTERIZATION_VALUE_5
                , GCO_CHARACTERIZATION_ID
                , GCO_GCO_CHARACTERIZATION_ID
                , GCO2_GCO_CHARACTERIZATION_ID
                , GCO3_GCO_CHARACTERIZATION_ID
                , GCO4_GCO_CHARACTERIZATION_ID
             from v_stm_stock_prov_qty spr
            where nvl(SPR_PROVISORY_INPUT, 0) <> 0
               or nvl(SPR_PROVISORY_OUTPUT, 0) <> 0) ) SPR
       , STM_STOCK_POSITION SPO
   where SPR.GCO_GOOD_ID = SPO.GCO_GOOD_ID
     and SPR.STM_LOCATION_ID = SPO.STM_LOCATION_ID
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_1, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_1, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_2, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_2, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_3, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_3, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_4, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_4, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_5, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_5, 0)
     and nvl(SPR.GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO2_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO2_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO3_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO3_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO4_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO4_GCO_CHARACTERIZATION_ID, 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PROV_TO_DELETE_LIGHT" ("GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID") AS
  (select GCO_GOOD_ID
        , STM_LOCATION_ID
        , SPO_CHARACTERIZATION_VALUE_1 PDE_CHARACTERIZATION_VALUE_1
        , SPO_CHARACTERIZATION_VALUE_2 PDE_CHARACTERIZATION_VALUE_2
        , SPO_CHARACTERIZATION_VALUE_3 PDE_CHARACTERIZATION_VALUE_3
        , SPO_CHARACTERIZATION_VALUE_4 PDE_CHARACTERIZATION_VALUE_4
        , SPO_CHARACTERIZATION_VALUE_5 PDE_CHARACTERIZATION_VALUE_5
        , GCO_CHARACTERIZATION_ID
        , GCO_GCO_CHARACTERIZATION_ID
        , GCO2_GCO_CHARACTERIZATION_ID
        , GCO3_GCO_CHARACTERIZATION_ID
        , GCO4_GCO_CHARACTERIZATION_ID
     from stm_stock_position spo
    where nvl(SPO_PROVISORY_INPUT, 0) <> 0
       or nvl(SPO_PROVISORY_OUTPUT, 0) <> 0)
  minus
  (select GCO_GOOD_ID
        , STM_LOCATION_ID
        , PDE_CHARACTERIZATION_VALUE_1
        , PDE_CHARACTERIZATION_VALUE_2
        , PDE_CHARACTERIZATION_VALUE_3
        , PDE_CHARACTERIZATION_VALUE_4
        , PDE_CHARACTERIZATION_VALUE_5
        , GCO_CHARACTERIZATION_ID
        , GCO_GCO_CHARACTERIZATION_ID
        , GCO2_GCO_CHARACTERIZATION_ID
        , GCO3_GCO_CHARACTERIZATION_ID
        , GCO4_GCO_CHARACTERIZATION_ID
     from v_stm_stock_prov_qty spr
    where nvl(SPR_PROVISORY_INPUT, 0) <> 0
       or nvl(SPR_PROVISORY_OUTPUT, 0) <> 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PROV_TO_UPDATE" ("ACTION", "GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPR_PROVISORY_INPUT", "SPR_PROVISORY_OUTPUT", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT") AS
  select 'U' "ACTION"
       , spr.GCO_GOOD_ID
       , spr.STM_LOCATION_ID
       , spr.PDE_CHARACTERIZATION_VALUE_1
       , spr.PDE_CHARACTERIZATION_VALUE_2
       , spr.PDE_CHARACTERIZATION_VALUE_3
       , spr.PDE_CHARACTERIZATION_VALUE_4
       , spr.PDE_CHARACTERIZATION_VALUE_5
       , spr.GCO_CHARACTERIZATION_ID
       , spr.GCO_GCO_CHARACTERIZATION_ID
       , spr.GCO2_GCO_CHARACTERIZATION_ID
       , spr.GCO3_GCO_CHARACTERIZATION_ID
       , spr.GCO4_GCO_CHARACTERIZATION_ID
       , nvl(spr.SPR_PROVISORY_INPUT,0) SPR_PROVISORY_INPUT
       , nvl(spr.SPR_PROVISORY_OUTPUT,0) SPR_PROVISORY_OUTPUT
       , nvl(spo.SPO_PROVISORY_INPUT,0) SPO_PROVISORY_INPUT
       , nvl(spo.SPO_PROVISORY_OUTPUT,0) SPO_PROVISORY_OUTPUT
    from v_stm_stock_prov_qty spr
       , stm_stock_position spo
   where SPR.GCO_GOOD_ID = SPO.GCO_GOOD_ID
     and SPR.STM_LOCATION_ID = SPO.STM_LOCATION_ID
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_1, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_1, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_2, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_2, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_3, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_3, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_4, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_4, 0)
     and nvl(SPR.PDE_CHARACTERIZATION_VALUE_5, 0) = nvl(SPO.SPO_CHARACTERIZATION_VALUE_5, 0)
     and nvl(SPR.GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO2_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO2_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO3_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO3_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPR.GCO4_GCO_CHARACTERIZATION_ID, 0) = nvl(SPO.GCO4_GCO_CHARACTERIZATION_ID, 0)
     and (   spo.SPO_PROVISORY_INPUT <> spr.SPR_PROVISORY_INPUT
          or spo.SPO_PROVISORY_OUTPUT <> spr.SPR_PROVISORY_OUTPUT)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_PURCHASE" ("GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GCO_GOOD_CATEGORY_WORDING", "GOO_PRECIOUS_MAT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "PER_KEY2", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_DOCUMENT_CHAR", "DMT_DATE_DOCUMENT_MONTH", "DMT_DATE_DOCUMENT_WEEK", "DMT_DATE_FALLING_DUE", "DMT_DATE_FALLING_DUE_CHAR", "DMT_DATE_FALLING_DUE_MONTH", "DMT_DATE_FALLING_DUE_WEEK", "POS_NUMBER", "C_GAUGE_TYPE", "GAU_DESCRIBE", "C_GAUGE_TITLE", "C_GAUGE_TITLE_DESCR", "C_DOCUMENT_STATUS", "C_DOCUMENT_STATUS_DESCR", "C_DOC_POS_STATUS", "C_DOC_POS_STATUS_DESCR", "POS_QUANTITY_BALANCED", "DIC_GAUGE_TYPE_DOC_ID", "DIC_GAUGE_CATEG_ID", "CURRENCY", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_TYPE_PARTNER_F_ID", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "DIC_COMPLEMENTARY_DATA_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_GROUP_ID", "DIC_GOOD_MODEL_ID", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GCO_STATISTIC_10_ID", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "DIC_UNIT_OF_MEASURE_ID", "DATA_ALPHA_COURT_1", "DATA_ALPHA_COURT_2", "DATA_ALPHA_COURT_3", "DATA_ALPHA_COURT_4", "DATA_ALPHA_COURT_5", "DATA_ALPHA_LONG_1", "DATA_ALPHA_LONG_2", "DATA_ALPHA_LONG_3", "DATA_ALPHA_LONG_4", "DATA_ALPHA_LONG_5", "DATA_INTEGER_1", "DATA_INTEGER_2", "DATA_INTEGER_3", "DATA_INTEGER_4", "DATA_INTEGER_5", "DATA_BOOLEAN_1", "DATA_BOOLEAN_2", "DATA_BOOLEAN_3", "DATA_BOOLEAN_4", "DATA_BOOLEAN_5", "DATA_DEC_1", "DATA_DEC_2", "DATA_DEC_3", "DATA_DEC_4", "DATA_DEC_5", "C_GAUGE_TYPE_POS", "POS_UNIT_COST_PRICE", "POS_NET_UNIT_VALUE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "DIC_PDE_FREE_TABLE_1_ID", "DIC_PDE_FREE_TABLE_2_ID", "DIC_PDE_FREE_TABLE_3_ID", "PDE_TEXT_1", "PDE_TEXT_2", "PDE_TEXT_3", "PDE_DECIMAL_1", "PDE_DECIMAL_2", "PDE_DECIMAL_3", "PDE_DATE_1", "PDE_DATE_2", "PDE_DATE_3", "PDE_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "PDE_VERSION", "PDE_PIECE", "PDE_SET", "PDE_CHRONOLOGICAL", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE_EXCL_MB", "PDE_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "PDE_BASIS_DELAY", "PDE_INTERMEDIATE_DELAY", "PDE_FINAL_DELAY", "PDE_BASIS_DELAY_CHAR", "PDE_INTERMEDIATE_DELAY_CHAR", "PDE_FINAL_DELAY_CHAR", "PDE_BASIS_DELAY_MONTH", "PDE_INTERMEDIATE_DELAY_MONTH", "PDE_FINAL_DELAY_MONTH", "PDE_BASIS_DELAY_WEEK", "PDE_INTERMEDIATE_DELAY_WEEK", "PDE_FINAL_DELAY_WEEK", "DIC_DELAY_UPDATE_TYPE_ID", "ACTUAL_PR_MANAGE_MODE", "PRF_DEFAULT_AT_DATE", "ACTUAL_PRCS", "PDT_STOCK_MANAGEMENT", "DOC_DOCUMENT_ID", "DOC_POSITION_ID", "DOC_POSITION_DETAIL_ID", "GCO_GOOD_ID", "DOC_GAUGE_ID", "PAC_PERSON_ID", "DOC_RECORD_ID", "ACS_FINANCIAL_CURRENCY_ID", "PC_CURR_ID", "GCO_GOOD_CATEGORY_ID", "STM_STOCK_ID", "STM_STM_STOCK_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID", "GAS_FINANCIAL_CHARGE", "MULTIPLY_FACTOR") AS
  select gco.goo_major_reference
       , gco.goo_secondary_reference
       , cat.gco_good_category_wording
       , gco.goo_precious_mat
       , dre.rco_title
       , per.per_name
       , per.per_key1
       , per.per_key2
       , doc.dmt_number
       , doc.dmt_date_document
       , to_char(dmt_date_document, 'yyyy.mm.dd') as dmt_date_document_char
       , to_char(dmt_date_document, 'yyyy.mm') as dmt_date_document_month
       , to_char(dmt_date_document, 'iyyy.iw') as dmt_date_document_week
       , doc.dmt_date_falling_due
       , to_char(doc.dmt_date_falling_due, 'yyyy.mm.dd') as dmt_date_falling_due_char
       , to_char(doc.dmt_date_falling_due, 'yyyy.mm') as dmt_date_falling_due_month
       , to_char(doc.dmt_date_falling_due, 'iyyy.iw') as dmt_date_falling_due_week
       , pos.pos_number
       , gau.c_gauge_type
       , gau.gau_describe
       , dgs.c_gauge_title
       , dgs.c_gauge_title || '-' || com_functions.getdescodedescr('C_GAUGE_TITLE', dgs.c_gauge_title) as c_gauge_title_descr
       , doc.c_document_status
       , doc.c_document_status || '-' || com_functions.getdescodedescr('C_DOCUMENT_STATUS', doc.c_document_status) as c_document_status_descr
       , pos.c_doc_pos_status
       , pos.c_doc_pos_status || '-' || com_functions.getdescodedescr('C_DOC_POS_STATUS', pos.c_doc_pos_status) as c_doc_pos_status_descr
       , pos.pos_quantity_balanced
       , gau.dic_gauge_type_doc_id
       , gau.dic_gauge_categ_id
       , cur.currency
       , dic_free_code1_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE1', per.dic_free_code1_id) as dic_free_code1_id
       , dic_free_code2_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE2', per.dic_free_code2_id) as dic_free_code2_id
       , dic_free_code3_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE3', per.dic_free_code3_id) as dic_free_code3_id
       , dic_free_code4_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE4', per.dic_free_code4_id) as dic_free_code4_id
       , dic_free_code5_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE5', per.dic_free_code5_id) as dic_free_code5_id
       , dic_free_code6_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE6', per.dic_free_code6_id) as dic_free_code6_id
       , dic_free_code7_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE7', per.dic_free_code7_id) as dic_free_code7_id
       , dic_free_code8_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE8', per.dic_free_code8_id) as dic_free_code8_id
       , dic_free_code9_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE9', per.dic_free_code9_id) as dic_free_code9_id
       , dic_free_code10_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE10', per.dic_free_code10_id) as dic_free_code10_id
       , pac.cre_free_zone1
       , pac.cre_free_zone2
       , pac.cre_free_zone3
       , pac.cre_free_zone4
       , pac.cre_free_zone5
       , pac.dic_type_partner_f_id || '-' || com_dic_functions.getdicodescr('DIC_TYPE_PARTNER_F', pac.dic_type_partner_f_id) as dic_type_partner_f_id
       , dic_statistic_f1_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_F1', pac.dic_statistic_f1_id) as dic_statistic_f1_id
       , dic_statistic_f2_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_F2', pac.dic_statistic_f2_id) as dic_statistic_f2_id
       , dic_statistic_f3_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_F3', pac.dic_statistic_f3_id) as dic_statistic_f3_id
       , dic_statistic_f4_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_F4', pac.dic_statistic_f4_id) as dic_statistic_f4_id
       , dic_statistic_f5_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_F5', pac.dic_statistic_f5_id) as dic_statistic_f5_id
       , dic_complementary_data_id || '-' || com_dic_functions.getdicodescr('DIC_COMPLEMENTARY_DATA', pac.dic_complementary_data_id)
                                                                                                                                   as dic_complementary_data_id
       , dic_third_activity_id || '-' || com_dic_functions.getdicodescr('DIC_THIRD_ACTIVITY', thi.dic_third_activity_id) as dic_third_activity_id
       , dic_third_area_id || '-' || com_dic_functions.getdicodescr('DIC_THIRD_AREA', thi.dic_third_area_id) as dic_third_area_id
       , gco.dic_good_line_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_LINE', gco.dic_good_line_id) as dic_good_line_id
       , gco.dic_good_family_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_FAMILY', gco.dic_good_family_id) as dic_good_family_id
       , gco.dic_good_group_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_GROUP', gco.dic_good_group_id) as dic_good_group_id
       , gco.dic_good_model_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_MODEL', gco.dic_good_model_id) as dic_good_model_id
       , gco.dic_accountable_group_id || '-' || com_dic_functions.getdicodescr('DIC_ACCOUNTABLE_GROUP', gco.dic_accountable_group_id)
                                                                                                                                    as dic_accountable_group_id
       , gco.dic_gco_statistic_1_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_1', gco.dic_gco_statistic_1_id) as dic_gco_statistic_1_id
       , gco.dic_gco_statistic_2_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_2', gco.dic_gco_statistic_2_id) as dic_gco_statistic_2_id
       , gco.dic_gco_statistic_3_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_3', gco.dic_gco_statistic_3_id) as dic_gco_statistic_3_id
       , gco.dic_gco_statistic_4_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_4', gco.dic_gco_statistic_4_id) as dic_gco_statistic_4_id
       , gco.dic_gco_statistic_5_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_5', gco.dic_gco_statistic_5_id) as dic_gco_statistic_5_id
       , gco.dic_gco_statistic_6_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_6', gco.dic_gco_statistic_6_id) as dic_gco_statistic_6_id
       , gco.dic_gco_statistic_7_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_7', gco.dic_gco_statistic_7_id) as dic_gco_statistic_7_id
       , gco.dic_gco_statistic_8_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_8', gco.dic_gco_statistic_8_id) as dic_gco_statistic_8_id
       , gco.dic_gco_statistic_9_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_9', gco.dic_gco_statistic_9_id) as dic_gco_statistic_9_id
       , gco.dic_gco_statistic_10_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_10', gco.dic_gco_statistic_10_id) as dic_gco_statistic_10_id
       , gfr.dic_free_table_1_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_1', gfr.dic_free_table_1_id) as dic_free_table_1_id
       , gfr.dic_free_table_2_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_2', gfr.dic_free_table_2_id) as dic_free_table_2_id
       , gfr.dic_free_table_3_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_3', gfr.dic_free_table_3_id) as dic_free_table_3_id
       , gfr.dic_free_table_4_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_4', gfr.dic_free_table_4_id) as dic_free_table_4_id
       , gfr.dic_free_table_5_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_5', gfr.dic_free_table_5_id) as dic_free_table_5_id
       , pos.dic_unit_of_measure_id || '-' || com_dic_functions.getdicodescr('DIC_UNIT_OF_MEASURE', pos.dic_unit_of_measure_id) as dic_unit_of_measure_id
       , gfr.data_alpha_court_1
       , gfr.data_alpha_court_2
       , gfr.data_alpha_court_3
       , gfr.data_alpha_court_4
       , gfr.data_alpha_court_5
       , gfr.data_alpha_long_1
       , gfr.data_alpha_long_2
       , gfr.data_alpha_long_3
       , gfr.data_alpha_long_4
       , gfr.data_alpha_long_5
       , gfr.data_integer_1
       , gfr.data_integer_2
       , gfr.data_integer_3
       , gfr.data_integer_4
       , gfr.data_integer_5
       , gfr.data_boolean_1
       , gfr.data_boolean_2
       , gfr.data_boolean_3
       , gfr.data_boolean_4
       , gfr.data_boolean_5
       , gfr.data_dec_1
       , gfr.data_dec_2
       , gfr.data_dec_3
       , gfr.data_dec_4
       , gfr.data_dec_5
       , pos.c_gauge_type_pos
       , pos.pos_unit_cost_price
       , pos.pos_net_unit_value
       , pos.dic_pos_free_table_1_id || '-' || com_dic_functions.getdicodescr('DIC_POS_FREE_TABLE_1', pos.dic_pos_free_table_1_id) as dic_pos_free_table_1_id
       , pos.dic_pos_free_table_2_id || '-' || com_dic_functions.getdicodescr('DIC_POS_FREE_TABLE_2', pos.dic_pos_free_table_2_id) as dic_pos_free_table_2_id
       , pos.dic_pos_free_table_3_id || '-' || com_dic_functions.getdicodescr('DIC_POS_FREE_TABLE_3', pos.dic_pos_free_table_3_id) as dic_pos_free_table_3_id
       , pos.pos_text_1
       , pos.pos_text_2
       , pos.pos_text_3
       , pos.pos_decimal_1
       , pos.pos_decimal_2
       , pos.pos_decimal_3
       , pos.pos_date_1
       , pos.pos_date_2
       , pos.pos_date_3
       , pde.dic_pde_free_table_1_id || '-' || com_dic_functions.getdicodescr('DIC_PDE_FREE_TABLE_1', pde.dic_pde_free_table_1_id) as dic_pde_free_table_1_id
       , pde.dic_pde_free_table_2_id || '-' || com_dic_functions.getdicodescr('DIC_PDE_FREE_TABLE_2', pde.dic_pde_free_table_2_id) as dic_pde_free_table_2_id
       , pde.dic_pde_free_table_3_id || '-' || com_dic_functions.getdicodescr('DIC_PDE_FREE_TABLE_3', pde.dic_pde_free_table_3_id) as dic_pde_free_table_3_id
       , pde.pde_text_1
       , pde.pde_text_2
       , pde.pde_text_3
       , pde.pde_decimal_1
       , pde.pde_decimal_2
       , pde.pde_decimal_3
       , pde.pde_date_1
       , pde.pde_date_2
       , pde.pde_date_3
       , pde.pde_balance_quantity
       , pde.pde_balance_quantity * pos.pos_net_unit_value as pos_net_value_balance
       , pde.pde_version
       , pde.pde_piece
       , pde.pde_set
       , pde.pde_chronological
       , case
           when pos.pos_final_quantity = 0 then 0
           else pde.pde_balance_quantity *(pos.pos_net_value_excl_b / pos.pos_final_quantity)
         end as pos_net_value_balance_mb
       , case
           when pos.pos_final_quantity = 0 then 0
           else dgs.multiply_factor *(pos_net_value_excl_b / pos_final_quantity)
         end as pos_net_unit_value_excl_mb
       , dgs.multiply_factor * pde.pde_final_quantity as pde_final_quantity
       , case
           when pos.pos_final_quantity = 0 then 0
           else dgs.multiply_factor *(pos_net_value_excl / pos_final_quantity)
         end as pos_net_value_excl
       , pde.pde_basis_delay
       , pde.pde_intermediate_delay
       , pde.pde_final_delay
       , to_char(pde.pde_basis_delay, 'YYYY.MM.DD') as pde_basis_delay_char
       , to_char(pde.pde_intermediate_delay, 'YYYY.MM.DD') as pde_intermediate_delay_char
       , to_char(pde.pde_final_delay, 'YYYY.MM.DD') as pde_final_delay_char
       , to_char(pde.pde_basis_delay, 'YYYY.MM') as pde_basis_delay_month
       , to_char(pde.pde_intermediate_delay, 'YYYY.MM') pde_intermediate_delay_month
       , to_char(pde.pde_final_delay, 'YYYY.MM') as pde_final_delay_month
       , to_char(pde.pde_basis_delay, 'IYYY.IW') as pde_basis_delay_week
       , to_char(pde.pde_intermediate_delay, 'IYYY.IW') as pde_intermediate_delay_week
       , to_char(pde.pde_final_delay, 'IYYY.IW') as pde_final_delay_week
       , pde.dic_delay_update_type_id || '-' || com_dic_functions.getdicodescr('DIC_DELAY_UPDATE_TYPE', pde.dic_delay_update_type_id) as dic_del_update_type_id
       , gco_functions.getcostpricewithmanagementmode(pos.gco_good_id, null, null, sysdate) as actual_pr_manage_mode
       , gco_functions.getcostpricewithmanagementmode(pos.gco_good_id, null, '3', doc.dmt_date_document) as prf_default_at_date
       , gco_functions.getcostpricewithmanagementmode(pos.gco_good_id, null, '1', null) as actual_prcs
       , case
           when gpr.pdt_stock_management = 1 then 'YES'
           when gpr.pdt_stock_management = 0 then 'NO'
           else 'INV'
         end as pdt_stock_management
       , doc.doc_document_id
       , pos.doc_position_id
       , pde.doc_position_detail_id
       , gco.gco_good_id
       , gau.doc_gauge_id
       , per.pac_person_id
       , dre.doc_record_id
       , acs.acs_financial_currency_id
       , cur.pc_curr_id
       , cat.gco_good_category_id
       , pos.stm_stock_id
       , pos.stm_stm_stock_id
       , pde.stm_location_id
       , pde.stm_stm_location_id
       , dgs.gas_financial_charge
       , dgs.multiply_factor as multiply_factor
    from doc_document doc
       , doc_position pos
       , doc_position_detail pde
       , gco_good gco
       , gco_product gpr
       , gco_free_data gfr
       , doc_gauge gau
       , (select doc_gauge_id
               , c_gauge_title
               , gas_financial_charge
               , case
                   when c_gauge_title = '5' then -1
                   else 1
                 end as multiply_factor
            from doc_gauge_structured) dgs
       , pac_supplier_partner pac
       , pac_third thi
       , pac_person per
       , doc_record dre
       , acs_financial_currency acs
       , pcs.pc_curr cur
       , gco_good_category cat
   where doc.doc_document_id = pos.doc_document_id
     and pos.doc_position_id = pde.doc_position_id
     and pos.gco_good_id = gco.gco_good_id(+)
     and gco.gco_good_id = gpr.gco_good_id(+)
     and gco.gco_good_id = gfr.gco_good_id(+)
     and doc.doc_gauge_id = gau.doc_gauge_id
     and gau.doc_gauge_id = dgs.doc_gauge_id
     and doc.pac_third_id = per.pac_person_id
     and doc.pac_third_id = thi.pac_third_id
     and doc.pac_third_id = pac.pac_supplier_partner_id
     and pos.doc_record_id = dre.doc_record_id(+)
     and doc.acs_financial_currency_id = acs.acs_financial_currency_id
     and acs.pc_curr_id = cur.pc_curr_id
     and gco.gco_good_category_id = cat.gco_good_category_id
     and pos.c_doc_pos_status <> '05'
     and pos.c_gauge_type_pos in('1', '7', '8', '91', '10', '21')
     and gau.c_admin_domain in ('1','5')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_REC_MGM_IMPUTATION" ("CPN_NUMBER", "DIC_CPN_FREECODE1_ID", "DIC_CPN_FREECODE2_ID", "DIC_CPN_FREECODE3_ID", "CPN_DESCRIPTION", "CDA_NUMBER", "CDA_DESCRIPTION", "ACT_MGM_IMPUTATION_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_PERIOD_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACT_DOCUMENT_ID", "ACT_FINANCIAL_IMPUTATION_ID", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "IMM_NUMBER", "IMM_NUMBER2", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "FAM_FIXED_ASSETS_ID", "PAC_PERSON_ID", "GK_AMOUNT", "VVGK_AMOUNT", "GRENZ_AMOUNT", "GK_SATZ", "VVGK_SATZ", "GRENZ_SATZ", "RCO_DATE1", "RCO_DATE2", "RCO_DECIMAL1", "RCO_TITLE", "PER_FULLNAME", "PER_TITLE", "PER_FIRST_NAME", "PER_LAST_NAME", "PER_INITIALS", "PER_NO_PERIOD", "FYE_NO_EXERCICE", "ACS_FINANCIAL_YEAR_ID", "PER_NAME", "PC_LANG_ID") AS
  select
  CPN.ACC_NUMBER CPN_NUMBER,
  ACP.DIC_CPN_FREECODE1_ID,
  ACP.DIC_CPN_FREECODE2_ID,
  ACP.DIC_CPN_FREECODE3_ID,
  DCPN.DES_DESCRIPTION_SUMMARY CPN_DESCRIPTION,
  CDA.ACC_NUMBER CDA_NUMBER,
  DCDA.DES_DESCRIPTION_SUMMARY CDA_DESCRIPTION,
  IMM.ACT_MGM_IMPUTATION_ID,
  IMM.ACS_FINANCIAL_CURRENCY_ID,
  IMM.ACS_ACS_FINANCIAL_CURRENCY_ID,
  IMM.ACS_PERIOD_ID,
  IMM.ACS_CPN_ACCOUNT_ID,
  IMM.ACS_CDA_ACCOUNT_ID,
  IMM.ACS_PF_ACCOUNT_ID,
  IMM.ACT_DOCUMENT_ID,
  IMM.ACT_FINANCIAL_IMPUTATION_ID,
  IMM.IMM_TYPE,
  IMM.IMM_GENRE,
  IMM.IMM_PRIMARY,
  IMM.IMM_DESCRIPTION, IMM.IMM_AMOUNT_LC_D, IMM.IMM_AMOUNT_LC_C,
  IMM.IMM_EXCHANGE_RATE, IMM.IMM_BASE_PRICE, IMM.IMM_AMOUNT_FC_D,
  IMM.IMM_AMOUNT_FC_C, IMM.IMM_VALUE_DATE, IMM.IMM_TRANSACTION_DATE,
  IMM.A_CONFIRM, IMM.A_DATECRE, IMM.A_DATEMOD, IMM.A_IDCRE, IMM.A_IDMOD,
  IMM.A_RECLEVEL, IMM.A_RECSTATUS, IMM.ACS_QTY_UNIT_ID, IMM.IMM_QUANTITY_D,
  IMM_QUANTITY_C, IMM.IMM_AMOUNT_EUR_D, IMM.IMM_AMOUNT_EUR_C, IMM.IMM_NUMBER,
  IMM.IMM_NUMBER2, IMM.IMM_TEXT1, IMM.IMM_TEXT2, IMM.IMM_TEXT3, IMM.IMM_TEXT4,
  IMM.IMM_TEXT5, IMM.DIC_IMP_FREE1_ID, IMM.DIC_IMP_FREE2_ID, IMM.DIC_IMP_FREE3_ID,
  IMM.DIC_IMP_FREE4_ID, IMM.DIC_IMP_FREE5_ID, IMM.HRM_PERSON_ID, IMM.GCO_GOOD_ID,
  IMM.DOC_RECORD_ID, IMM.IMM_NUMBER3, IMM.IMM_NUMBER4, IMM.IMM_NUMBER5, IMM.FAM_FIXED_ASSETS_ID, IMM.PAC_PERSON_ID,
  (IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)*GKSA.GKSA GK_AMOUNT,
  ((IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)+((IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)*GKSA.GKSA))*VVGKSA.GKSA VVGK_AMOUNT,
  ((IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)+ --BASE
  ((IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)*GKSA.GKSA)+ --GK
  (((IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)+((IMM.IMM_AMOUNT_LC_D-IMM.IMM_AMOUNT_LC_C)*GKSA.GKSA))*VVGKSA.GKSA))*GRENZSA.GKSA GRENZ,
  GKSA.GKSA*100 GK_SATZ,
  VVGKSA.GKSA*100 VVGK_SATZ,
  GRENZSA.GKSA*100 GRENZ_SATZ,
  RCO.RCO_DATE1,
  RCO.RCO_DATE2,
  RCO.RCO_DECIMAL1,
  RCO.RCO_TITLE,
  HRM.PER_FULLNAME,
  HRM.PER_TITLE,
  HRM.PER_FIRST_NAME,
  HRM.PER_LAST_NAME,
  HRM.PER_INITIALS,
  PER.PER_NO_PERIOD,
  FYE.FYE_NO_EXERCICE,
  FYE.ACS_FINANCIAL_YEAR_ID,
  PAC.PER_NAME,
  DCPN.PC_LANG_ID
from
  ACT_PART_IMPUTATION PAR,
  ACT_FINANCIAL_IMPUTATION IMP,
  ACT_MGM_IMPUTATION IMM,
  ACS_DESCRIPTION DCPN,
  ACS_DESCRIPTION DCDA,
  PAC_PERSON PAC,
  HRM_PERSON HRM,
  ACS_CPN_ACCOUNT ACP,
  ACS_ACCOUNT CPN,
  ACS_ACCOUNT CDA,
  ACS_PERIOD PER,
  (select (GK.QTA_QUANTITY/100) GKSA,
  imm.act_mgm_imputation_id
  from ACS_QTY_S_CPN_ACOUNT GK,
  ACS_ACCOUNT QTY,
  ACT_MGM_IMPUTATION IMM,
  ACS_CPN_ACCOUNT ACP
  WHERE IMM.ACS_CPN_ACCOUNT_ID=ACP.ACS_CPN_ACCOUNT_ID
  AND ACP.DIC_CPN_FREECODE1_ID=QTY.ACC_NUMBER
  AND QTY.ACS_ACCOUNT_ID=GK.ACS_QTY_UNIT_ID
  AND trunc(GK.QTA_FROM) <= trunc(IMM.IMM_VALUE_DATE)
  AND trunc(GK.QTA_TO) >= trunc(IMM.IMM_VALUE_DATE)) GKSA,
  (select (GK.QTA_QUANTITY/100) GKSA,
  imm.act_mgm_imputation_id
  from ACS_QTY_S_CPN_ACOUNT GK,
  ACS_ACCOUNT QTY,
  ACT_MGM_IMPUTATION IMM,
  ACS_CPN_ACCOUNT ACP
  WHERE GK.ACS_QTY_UNIT_ID=QTY.ACS_ACCOUNT_ID
  AND IMM.ACS_CPN_ACCOUNT_ID=ACP.ACS_CPN_ACCOUNT_ID
  AND QTY.ACC_NUMBER = '950'
  AND trunc(GK.QTA_FROM) <= trunc(IMM.IMM_VALUE_DATE)
  AND trunc(GK.QTA_TO) >= trunc(IMM.IMM_VALUE_DATE)) VVGKSA,
  (select (GK.QTA_QUANTITY/100) GKSA,
  imm.act_mgm_imputation_id
  from ACS_QTY_S_CPN_ACOUNT GK,
  ACS_ACCOUNT QTY,
  ACT_MGM_IMPUTATION IMM,
  ACS_CPN_ACCOUNT ACP
  WHERE GK.ACS_QTY_UNIT_ID=QTY.ACS_ACCOUNT_ID (+)
  AND IMM.ACS_CPN_ACCOUNT_ID=ACP.ACS_CPN_ACCOUNT_ID
  AND QTY.ACC_NUMBER = '960'
  AND trunc(GK.QTA_FROM) <= trunc(IMM.IMM_VALUE_DATE)
  AND trunc(GK.QTA_TO) >= trunc(IMM.IMM_VALUE_DATE) ) GRENZSA,
  DOC_RECORD RCO,
  ACS_FINANCIAL_YEAR FYE
where
  IMM.DOC_RECORD_ID = RCO.DOC_RECORD_ID AND
  IMM.ACS_PERIOD_ID = PER.ACS_PERIOD_ID AND
  PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID AND
  IMM.ACS_CPN_ACCOUNT_ID = CPN.ACS_ACCOUNT_ID AND
  IMM.ACS_CDA_ACCOUNT_ID = CDA.ACS_ACCOUNT_ID (+) AND
  CPN.ACS_ACCOUNT_ID = ACP.ACS_CPN_ACCOUNT_ID AND
  IMM.HRM_PERSON_ID = HRM.HRM_PERSON_ID(+) AND
  IMM.ACT_FINANCIAL_IMPUTATION_ID = IMP.ACT_FINANCIAL_IMPUTATION_ID(+) AND
  IMP.ACT_PART_IMPUTATION_ID = PAR.ACT_PART_IMPUTATION_ID(+) AND
  NVL(PAR.PAC_CUSTOM_PARTNER_ID,PAR.PAC_SUPPLIER_PARTNER_ID) = PAC.PAC_PERSON_ID(+) AND
  CPN.ACS_ACCOUNT_ID = DCPN.ACS_ACCOUNT_ID (+)AND
  DCPN.PC_LANG_ID=ACP.DIC_CPN_FREECODE2_ID AND
  CDA.ACS_ACCOUNT_ID = DCDA.ACS_ACCOUNT_ID (+)AND
  DCDA.PC_LANG_ID=ACP.DIC_CPN_FREECODE2_ID AND
  IMM.ACT_MGM_IMPUTATION_ID = GKSA.ACT_MGM_IMPUTATION_ID AND
  IMM.ACT_MGM_IMPUTATION_ID = VVGKSA.ACT_MGM_IMPUTATION_ID AND
  IMM.ACT_MGM_IMPUTATION_ID = GRENZSA.ACT_MGM_IMPUTATION_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_REC_MGM_IMP_TOT" ("DOC_RECORD_ID", "DIC_CPN_FREECODE1_ID", "DIC_CPN_FREECODE3_ID", "ACC_NUMBER", "DIC_DESCR_CPN_DICO", "QTY_QUANTITY", "QTY_AMOUNT", "PC_LANG_ID") AS
  select
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID DIC_CPN_FREECODE3_ID,
  '' ACC_NUMBER,
  DES.DIT_DESCR DIC_DESCR_CPN_DICO,
  NVL(SUM(MGM.IMM_QUANTITY_D-MGM.IMM_QUANTITY_C),0) QTY_QUANTITY,
  NVL(SUM(MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C),0) QTY_AMOUNT,
  DES.PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  DICO_DESCRIPTION DES,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  DES.DIT_TABLE='DIC_CPN_FREECODE1' AND
  DES.DIT_CODE=DIC.DIC_CPN_FREECODE1_ID AND
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID,
  DES.DIT_DESCR,
  DES.PC_LANG_ID
union all
--CALCUL DES GK SUR CPN
select
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID||'1' DIC_CPN_FREECODE3_ID,
  '' ACC_NUMBER,
  DECODE(DES.PC_LANG_ID,1,'Ch. ind. ',2,'GK ',3,'GK')||DES.DIT_DESCR||' '||MGM.GK_SATZ||' % sur '||NVL(SUM(MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C),0),
  0 QTY_QUANTITY,
  NVL(SUM(MGM.GK_AMOUNT),0) QTY_AMOUNT,
  DES.PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  DICO_DESCRIPTION DES,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DES.DIT_CODE=DIC.DIC_CPN_FREECODE1_ID AND
  DES.DIT_TABLE='DIC_CPN_FREECODE1' AND
  DIC.DIC_CPN_FREECODE1_ID<=939
group by
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID,
  DES.DIT_DESCR,
  MGM.GK_SATZ,
  DES.PC_LANG_ID
union all
--CALCUL DES TOTAUX PAR CPN (CPN + GK)
select
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID||'2' DIC_CPN_FREECODE1_ID,
  '' ACC_NUMBER,
  'TOTAL '||DES.DIT_DESCR,
  NVL(SUM(MGM.IMM_QUANTITY_D-MGM.IMM_QUANTITY_C),0) QTY_QUANTITY,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT),0) QTY_AMOUNT,
  DES.PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  DICO_DESCRIPTION DES,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DES.DIT_CODE=DIC.DIC_CPN_FREECODE1_ID AND
  DES.DIT_TABLE='DIC_CPN_FREECODE1' AND
  DIC.DIC_CPN_FREECODE1_ID<=939
group by
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID,
  'TOTAL '||DES.DIT_DESCR,
  DES.PC_LANG_ID
union all
--LIGNE VIERGE ENTRE LES DIFFERENTES SECTION
select
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID||'3' DIC_CPN_FREECODE1_ID,
  '' ACC_NUMBER,
  '',
  0,
  0,
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID,
  ' ',
  ' ',
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '150' DIC_CPN_FREECODE3_ID,
  '' ACC_NUMBER,
  '',
  0,
  0,
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '250' DIC_CPN_FREECODE3_ID,
  '' ACC_NUMBER,
  '',
  0,
  0,
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '350' DIC_CPN_FREECODE3_ID,
  '' ACC_NUMBER,
  '',
  0,
  0,
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '450' DIC_CPN_FREECODE3_ID,
  '' ACC_NUMBER,
  '',
  0,
  0,
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
--DETAIL DES CPN
select
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID||'0',
  MGM.CPN_NUMBER,
  MGM.CPN_DESCRIPTION DIC_DESCR_CPN_DICO,
  NVL(SUM(MGM.IMM_QUANTITY_D-MGM.IMM_QUANTITY_C),0) QTY_QUANTITY,
  NVL(SUM(MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C),0) QTY_AMOUNT,
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID
group by
  MGM.DOC_RECORD_ID,
  MGM.DIC_CPN_FREECODE1_ID,
  MGM.DIC_CPN_FREECODE3_ID,
  MGM.CPN_NUMBER,
  MGM.CPN_DESCRIPTION,
  MGM.PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  ''DIC_CPN_FREECODE1_ID,
  '15' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'NIVEAU I',2,'HERSTELLKOSTEN I',3,'LEVEL I') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='909'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
--CALCUL TOTAL FREMDLEISTUNGEN
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '25' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'TOTAL PREST. EXTERNES',2,'TOTAL FREMDLEISTUNGEN',3,'TOTAL PREST.EXTERNES') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID>='920' AND
  DIC.DIC_CPN_FREECODE1_ID<='929'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '35' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'NIVEAU II',2,'HERSTELLKOSTEN II',3,'LEVEL II') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='929'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '45' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'NIVEAU III',2,'HERSTELLKOSTEN III',3,'LEVEL III') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='939'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '55' DIC_CPN_FREECODE3_ID,
  '',
  'VVGK '||MGM.VVGK_SATZ||' %' DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM(MGM.VVGK_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='939'
group by
  MGM.DOC_RECORD_ID,
  MGM.VVGK_SATZ,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '56' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'SK NIVEAU I',2,'SELBSTKOSTEN I',3,'SK LEVEL I') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT+VVGK_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='939'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '57' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'Grenzkosten FR',2,'Grenzkosten GE',3,'Grenzkosten EN')||' '||MGM.GRENZ_SATZ||' %' DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM(MGM.GRENZ_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='939'
group by
  MGM.DOC_RECORD_ID,
  MGM.GRENZ_SATZ,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '58' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'SK NIVEAU II',2,'SELBSTKOSTEN II',3,'SK LEVEL II') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT+VVGK_AMOUNT+GRENZ_AMOUNT),0),
  PC_LANG_ID
from
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='939'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID
union all
select
  MGM.DOC_RECORD_ID,
  '' DIC_CPN_FREECODE1_ID,
  '60' DIC_CPN_FREECODE3_ID,
  '',
  DECODE(PC_LANG_ID,1,'Rsultat',2,'BETRIEGSERFOLG',3,'RESULT') DIC_DESCR_CPN_DICO,
  0,
  NVL(SUM((MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C)+MGM.GK_AMOUNT+VVGK_AMOUNT+GRENZ_AMOUNT),0) + NVL(max(VERKAUFERLOS.VERKAUF),0),
  PC_LANG_ID
from
  (SELECT
  MGM.DOC_RECORD_ID,
  NVL(SUM(MGM.IMM_AMOUNT_LC_D-MGM.IMM_AMOUNT_LC_C),0) VERKAUF
  FROM
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
  WHERE
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID='940'
  GROUP BY
  MGM.DOC_RECORD_ID) VERKAUFERLOS,
  DIC_CPN_FREECODE1 DIC,
  V_DOC_REC_MGM_IMPUTATION MGM
where
  VERKAUFERLOS.DOC_RECORD_ID (+) = MGM.DOC_RECORD_ID AND
  MGM.DIC_CPN_FREECODE1_ID = DIC.DIC_CPN_FREECODE1_ID AND
  DIC.DIC_CPN_FREECODE1_ID<='939'
group by
  MGM.DOC_RECORD_ID,
  PC_LANG_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_SALE" ("GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GCO_GOOD_CATEGORY_WORDING", "GOO_PRECIOUS_MAT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "PER_KEY2", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_DOCUMENT_CHAR", "DMT_DATE_DOCUMENT_MONTH", "DMT_DATE_DOCUMENT_WEEK", "DMT_DATE_FALLING_DUE", "DMT_DATE_FALLING_DUE_CHAR", "DMT_DATE_FALLING_DUE_MONTH", "DMT_DATE_FALLING_DUE_WEEK", "POS_NUMBER", "C_GAUGE_TYPE", "GAU_DESCRIBE", "C_GAUGE_TITLE", "C_GAUGE_TITLE_DESCR", "C_DOCUMENT_STATUS", "C_DOCUMENT_STATUS_DESCR", "C_DOC_POS_STATUS", "C_DOC_POS_STATUS_DESCR", "POS_QUANTITY_BALANCED", "DIC_GAUGE_TYPE_DOC_ID", "DIC_GAUGE_CATEG_ID", "CURRENCY", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_TYPE_PARTNER_ID", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "DIC_COMPLEMENTARY_DATA_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_GROUP_ID", "DIC_GOOD_MODEL_ID", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GCO_STATISTIC_10_ID", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "DIC_UNIT_OF_MEASURE_ID", "DATA_ALPHA_COURT_1", "DATA_ALPHA_COURT_2", "DATA_ALPHA_COURT_3", "DATA_ALPHA_COURT_4", "DATA_ALPHA_COURT_5", "DATA_ALPHA_LONG_1", "DATA_ALPHA_LONG_2", "DATA_ALPHA_LONG_3", "DATA_ALPHA_LONG_4", "DATA_ALPHA_LONG_5", "DATA_INTEGER_1", "DATA_INTEGER_2", "DATA_INTEGER_3", "DATA_INTEGER_4", "DATA_INTEGER_5", "DATA_BOOLEAN_1", "DATA_BOOLEAN_2", "DATA_BOOLEAN_3", "DATA_BOOLEAN_4", "DATA_BOOLEAN_5", "DATA_DEC_1", "DATA_DEC_2", "DATA_DEC_3", "DATA_DEC_4", "DATA_DEC_5", "C_GAUGE_TYPE_POS", "POS_UNIT_COST_PRICE", "POS_NET_UNIT_VALUE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "DIC_PDE_FREE_TABLE_1_ID", "DIC_PDE_FREE_TABLE_2_ID", "DIC_PDE_FREE_TABLE_3_ID", "PDE_TEXT_1", "PDE_TEXT_2", "PDE_TEXT_3", "PDE_DECIMAL_1", "PDE_DECIMAL_2", "PDE_DECIMAL_3", "PDE_DATE_1", "PDE_DATE_2", "PDE_DATE_3", "PDE_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "PDE_VERSION", "PDE_PIECE", "PDE_SET", "PDE_CHRONOLOGICAL", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE_EXCL_MB", "PDE_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "PDE_BASIS_DELAY", "PDE_INTERMEDIATE_DELAY", "PDE_FINAL_DELAY", "PDE_BASIS_DELAY_CHAR", "PDE_INTERMEDIATE_DELAY_CHAR", "PDE_FINAL_DELAY_CHAR", "PDE_BASIS_DELAY_MONTH", "PDE_INTERMEDIATE_DELAY_MONTH", "PDE_FINAL_DELAY_MONTH", "PDE_BASIS_DELAY_WEEK", "PDE_INTERMEDIATE_DELAY_WEEK", "PDE_FINAL_DELAY_WEEK", "DIC_DELAY_UPDATE_TYPE_ID", "ACTUAL_PR_MANAGE_MODE", "PRF_DEFAULT_AT_DATE", "ACTUAL_PRCS", "PDT_STOCK_MANAGEMENT", "DOC_DOCUMENT_ID", "DOC_POSITION_ID", "DOC_POSITION_DETAIL_ID", "GCO_GOOD_ID", "DOC_GAUGE_ID", "PAC_PERSON_ID", "DOC_RECORD_ID", "ACS_FINANCIAL_CURRENCY_ID", "PC_CURR_ID", "GCO_GOOD_CATEGORY_ID", "STM_STOCK_ID", "STM_STM_STOCK_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID", "REP_DESCR", "MULTIPLY_FACTOR") AS
  select gco.goo_major_reference
       , gco.goo_secondary_reference
       , cat.gco_good_category_wording
       , gco.goo_precious_mat
       , dre.rco_title
       , per.per_name
       , per.per_key1
       , per.per_key2
       , doc.dmt_number
       , doc.dmt_date_document
       , to_char(dmt_date_document, 'yyyy.mm.dd') as dmt_date_document_char
       , to_char(dmt_date_document, 'yyyy.mm') as dmt_date_document_month
       , to_char(dmt_date_document, 'iyyy.iw') as dmt_date_document_week
       , doc.dmt_date_falling_due
       , to_char(doc.dmt_date_falling_due, 'yyyy.mm.dd') as dmt_date_falling_due_char
       , to_char(doc.dmt_date_falling_due, 'yyyy.mm') as dmt_date_falling_due_month
       , to_char(doc.dmt_date_falling_due, 'iyyy.iw') as dmt_date_falling_due_week
       , pos.pos_number
       , gau.c_gauge_type
       , gau.gau_describe
       , dgs.c_gauge_title
       , dgs.c_gauge_title || '-' || com_functions.getdescodedescr('C_GAUGE_TITLE', dgs.c_gauge_title) as c_gauge_title_descr
       , doc.c_document_status
       , c_document_status || '-' || com_functions.getdescodedescr('C_DOCUMENT_STATUS', doc.c_document_status) as c_document_status_descr
       , pos.c_doc_pos_status
       , pos.c_doc_pos_status || '-' || com_functions.getdescodedescr('C_DOC_POS_STATUS', pos.c_doc_pos_status) as c_doc_pos_status_descr
       , pos.pos_quantity_balanced
       , gau.dic_gauge_type_doc_id
       , gau.dic_gauge_categ_id
       , cur.currency
       , dic_free_code1_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE1', per.dic_free_code1_id) as dic_free_code1_id
       , dic_free_code2_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE2', per.dic_free_code2_id) as dic_free_code2_id
       , dic_free_code3_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE3', per.dic_free_code3_id) as dic_free_code3_id
       , dic_free_code4_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE4', per.dic_free_code4_id) as dic_free_code4_id
       , dic_free_code5_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE5', per.dic_free_code5_id) as dic_free_code5_id
       , dic_free_code6_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE6', per.dic_free_code6_id) as dic_free_code6_id
       , dic_free_code7_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE7', per.dic_free_code7_id) as dic_free_code7_id
       , dic_free_code8_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE8', per.dic_free_code8_id) as dic_free_code8_id
       , dic_free_code9_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE9', per.dic_free_code9_id) as dic_free_code9_id
       , dic_free_code10_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_CODE10', per.dic_free_code10_id) as dic_free_code10_id
       , pac.cus_free_zone1
       , pac.cus_free_zone2
       , pac.cus_free_zone3
       , pac.cus_free_zone4
       , pac.cus_free_zone5
       , pac.dic_type_partner_id || '-' || com_dic_functions.getdicodescr('DIC_TYPE_PARTNER', pac.dic_type_partner_id) as dic_type_partner_id
       , dic_statistic_1_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_1', pac.dic_statistic_1_id) as dic_statistic_1_id
       , dic_statistic_2_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_2', pac.dic_statistic_2_id) as dic_statistic_2_id
       , dic_statistic_3_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_3', pac.dic_statistic_3_id) as dic_statistic_3_id
       , dic_statistic_4_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_4', pac.dic_statistic_4_id) as dic_statistic_4_id
       , dic_statistic_5_id || '-' || com_dic_functions.getdicodescr('DIC_STATISTIC_5', pac.dic_statistic_5_id) as dic_statistic_5_id
       , dic_complementary_data_id || '-' || com_dic_functions.getdicodescr('DIC_COMPLEMENTARY_DATA', pac.dic_complementary_data_id)
                                                                                                                                   as dic_complementary_data_id
       , dic_third_activity_id || '-' || com_dic_functions.getdicodescr('DIC_THIRD_ACTIVITY', thi.dic_third_activity_id) as dic_third_activity_id
       , dic_third_area_id || '-' || com_dic_functions.getdicodescr('DIC_THIRD_AREA', thi.dic_third_area_id) as dic_third_area_id
       , gco.dic_good_line_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_LINE', gco.dic_good_line_id) as dic_good_line_id
       , gco.dic_good_family_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_FAMILY', gco.dic_good_family_id) as dic_good_family_id
       , gco.dic_good_group_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_GROUP', gco.dic_good_group_id) as dic_good_group_id
       , gco.dic_good_model_id || '-' || com_dic_functions.getdicodescr('DIC_GOOD_MODEL', gco.dic_good_model_id) as dic_good_model_id
       , gco.dic_accountable_group_id || '-' || com_dic_functions.getdicodescr('DIC_ACCOUNTABLE_GROUP', gco.dic_accountable_group_id)
                                                                                                                                    as dic_accountable_group_id
       , gco.dic_gco_statistic_1_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_1', gco.dic_gco_statistic_1_id) as dic_gco_statistic_1_id
       , gco.dic_gco_statistic_2_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_2', gco.dic_gco_statistic_2_id) as dic_gco_statistic_2_id
       , gco.dic_gco_statistic_3_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_3', gco.dic_gco_statistic_3_id) as dic_gco_statistic_3_id
       , gco.dic_gco_statistic_4_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_4', gco.dic_gco_statistic_4_id) as dic_gco_statistic_4_id
       , gco.dic_gco_statistic_5_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_5', gco.dic_gco_statistic_5_id) as dic_gco_statistic_5_id
       , gco.dic_gco_statistic_6_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_6', gco.dic_gco_statistic_6_id) as dic_gco_statistic_6_id
       , gco.dic_gco_statistic_7_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_7', gco.dic_gco_statistic_7_id) as dic_gco_statistic_7_id
       , gco.dic_gco_statistic_8_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_8', gco.dic_gco_statistic_8_id) as dic_gco_statistic_8_id
       , gco.dic_gco_statistic_9_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_9', gco.dic_gco_statistic_9_id) as dic_gco_statistic_9_id
       , gco.dic_gco_statistic_10_id || '-' || com_dic_functions.getdicodescr('DIC_GCO_STATISTIC_10', gco.dic_gco_statistic_10_id) as dic_gco_statistic_10_id
       , gfr.dic_free_table_1_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_1', gfr.dic_free_table_1_id) as dic_free_table_1_id
       , gfr.dic_free_table_2_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_2', gfr.dic_free_table_2_id) as dic_free_table_2_id
       , gfr.dic_free_table_3_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_3', gfr.dic_free_table_3_id) as dic_free_table_3_id
       , gfr.dic_free_table_4_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_4', gfr.dic_free_table_4_id) as dic_free_table_4_id
       , gfr.dic_free_table_5_id || '-' || com_dic_functions.getdicodescr('DIC_FREE_TABLE_5', gfr.dic_free_table_5_id) as dic_free_table_5_id
       , pos.dic_unit_of_measure_id || '-' || com_dic_functions.getdicodescr('DIC_UNIT_OF_MEASURE', pos.dic_unit_of_measure_id) as dic_unit_of_measure_id
       , gfr.data_alpha_court_1
       , gfr.data_alpha_court_2
       , gfr.data_alpha_court_3
       , gfr.data_alpha_court_4
       , gfr.data_alpha_court_5
       , gfr.data_alpha_long_1
       , gfr.data_alpha_long_2
       , gfr.data_alpha_long_3
       , gfr.data_alpha_long_4
       , gfr.data_alpha_long_5
       , gfr.data_integer_1
       , gfr.data_integer_2
       , gfr.data_integer_3
       , gfr.data_integer_4
       , gfr.data_integer_5
       , gfr.data_boolean_1
       , gfr.data_boolean_2
       , gfr.data_boolean_3
       , gfr.data_boolean_4
       , gfr.data_boolean_5
       , gfr.data_dec_1
       , gfr.data_dec_2
       , gfr.data_dec_3
       , gfr.data_dec_4
       , gfr.data_dec_5
       , pos.c_gauge_type_pos
       , pos.pos_unit_cost_price
       , pos.pos_net_unit_value
       , pos.dic_pos_free_table_1_id || '-' || com_dic_functions.getdicodescr('DIC_POS_FREE_TABLE_1', pos.dic_pos_free_table_1_id) as dic_pos_free_table_1_id
       , pos.dic_pos_free_table_2_id || '-' || com_dic_functions.getdicodescr('DIC_POS_FREE_TABLE_2', pos.dic_pos_free_table_2_id) as dic_pos_free_table_2_id
       , pos.dic_pos_free_table_3_id || '-' || com_dic_functions.getdicodescr('DIC_POS_FREE_TABLE_3', pos.dic_pos_free_table_3_id) as dic_pos_free_table_3_id
       , pos.pos_text_1
       , pos.pos_text_2
       , pos.pos_text_3
       , pos.pos_decimal_1
       , pos.pos_decimal_2
       , pos.pos_decimal_3
       , pos.pos_date_1
       , pos.pos_date_2
       , pos.pos_date_3
       , pde.dic_pde_free_table_1_id || '-' || com_dic_functions.getdicodescr('DIC_PDE_FREE_TABLE_1', pde.dic_pde_free_table_1_id) as dic_pde_free_table_1_id
       , pde.dic_pde_free_table_2_id || '-' || com_dic_functions.getdicodescr('DIC_PDE_FREE_TABLE_2', pde.dic_pde_free_table_2_id) as dic_pde_free_table_2_id
       , pde.dic_pde_free_table_3_id || '-' || com_dic_functions.getdicodescr('DIC_PDE_FREE_TABLE_3', pde.dic_pde_free_table_3_id) as dic_pde_free_table_3_id
       , pde.pde_text_1
       , pde.pde_text_2
       , pde.pde_text_3
       , pde.pde_decimal_1
       , pde.pde_decimal_2
       , pde.pde_decimal_3
       , pde.pde_date_1
       , pde.pde_date_2
       , pde.pde_date_3
       , pde.pde_balance_quantity
       , pde.pde_balance_quantity * pos.pos_net_unit_value as pos_net_value_balance
       , pde.pde_version
       , pde.pde_piece
       , pde.pde_set
       , pde.pde_chronological
       , case
           when pos.pos_final_quantity = 0 then 0
           else pde.pde_balance_quantity *(pos.pos_net_value_excl_b / pos.pos_final_quantity)
         end as pos_net_value_balance_mb
       , case
           when pos_final_quantity = 0 then 0
           else dgs.multiply_factor *(pos_net_value_excl_b / pos_final_quantity)
         end as pos_net_unit_value_excl_mb
       , dgs.multiply_factor * pde.pde_final_quantity as pde_final_quantity
       , case
           when pos_final_quantity = 0 then 0
           else dgs.multiply_factor *(pos_net_value_excl / pos_final_quantity)
         end as pos_net_value_excl
       , pde.pde_basis_delay
       , pde.pde_intermediate_delay
       , pde.pde_final_delay
       , to_char(pde.pde_basis_delay, 'YYYY.MM.DD') as pde_basis_delay_char
       , to_char(pde.pde_intermediate_delay, 'YYYY.MM.DD') as pde_intermediate_delay_char
       , to_char(pde.pde_final_delay, 'YYYY.MM.DD') as pde_final_delay_char
       , to_char(pde.pde_basis_delay, 'YYYY.MM') as pde_basis_delay_month
       , to_char(pde.pde_intermediate_delay, 'YYYY.MM') as pde_intermediate_delay_month
       , to_char(pde.pde_final_delay, 'YYYY.MM') as pde_final_delay_month
       , to_char(pde.pde_basis_delay, 'IYYY.IW') as pde_basis_delay_week
       , to_char(pde.pde_intermediate_delay, 'IYYY.IW') as pde_intermediate_delay_week
       , to_char(pde.pde_final_delay, 'IYYY.IW') as pde_final_delay_week
       , pde.dic_delay_update_type_id || '-' || com_dic_functions.getdicodescr('DIC_DELAY_UPDATE_TYPE', pde.dic_delay_update_type_id)
                                                                                                                                    as dic_delay_update_type_id
       , gco_functions.getcostpricewithmanagementmode(pos.gco_good_id, null, null, sysdate) as actual_pr_manage_mode
       , gco_functions.getcostpricewithmanagementmode(pos.gco_good_id, null, '3', doc.dmt_date_document) as prf_default_at_date
       , gco_functions.getcostpricewithmanagementmode(pos.gco_good_id, null, '1', null) as actual_prcs
       , case
           when gpr.pdt_stock_management = 1 then 'YES'
           when gpr.pdt_stock_management = 0 then 'NO'
           else 'INV'
         end as pdt_stock_management
       , doc.doc_document_id
       , pos.doc_position_id
       , pde.doc_position_detail_id
       , gco.gco_good_id
       , gau.doc_gauge_id
       , per.pac_person_id
       , dre.doc_record_id
       , acs.acs_financial_currency_id
       , cur.pc_curr_id
       , cat.gco_good_category_id
       , pos.stm_stock_id
       , pos.stm_stm_stock_id
       , pde.stm_location_id
       , pde.stm_stm_location_id
       , rep.rep_descr
       , dgs.multiply_factor as multiply_factor
    from doc_document doc
       , doc_position pos
       , doc_position_detail pde
       , gco_good gco
       , gco_product gpr
       , gco_free_data gfr
       , doc_gauge gau
       , (select doc_gauge_id
               , c_gauge_title
               , gas_financial_charge
               , case
                   when c_gauge_title = '9' then -1
                   else 1
                 end as multiply_factor
            from doc_gauge_structured) dgs
       , pac_custom_partner pac
       , pac_third thi
       , pac_person per
       , doc_record dre
       , acs_financial_currency acs
       , pcs.pc_curr cur
       , gco_good_category cat
       , pac_representative rep
   where doc.doc_document_id = pos.doc_document_id
     and pos.doc_position_id = pde.doc_position_id
     and pos.gco_good_id = gco.gco_good_id
     and gco.gco_good_id = gpr.gco_good_id(+)
     and gco.gco_good_id = gfr.gco_good_id(+)
     and doc.doc_gauge_id = gau.doc_gauge_id
     and gau.doc_gauge_id = dgs.doc_gauge_id
     and doc.pac_third_id = per.pac_person_id
     and doc.pac_third_id = thi.pac_third_id
     and doc.pac_third_id = pac.pac_custom_partner_id
     and pos.doc_record_id = dre.doc_record_id(+)
     and doc.acs_financial_currency_id = acs.acs_financial_currency_id
     and acs.pc_curr_id = cur.pc_curr_id
     and gco.gco_good_category_id = cat.gco_good_category_id
     and pos.pac_representative_id = rep.pac_representative_id(+)
     --AND pos.c_gauge_type_pos IN ('1','7','8','71','81')
     and pos.c_gauge_type_pos in('1', '7', '8', '10', '91')
     and gau.c_admin_domain = '2'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_SITUATION_FATHER_SON" ("FATHER", "SON", "CDE", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "C_DOCUMENT_STATUS", "PC_LANG_ID", "LANID", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "C_ADMIN_DOMAIN", "C_GAUGE_SHOW_DELAY", "GAP_POS_DELAY", "POS_NUMBER", "C_DOC_POS_STATUS", "C_GAUGE_TYPE_POS", "DIC_UNIT_OF_MEASURE_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOOD_GOO_NUMBER_OF_DECIMAL", "GOO_NUMBER_OF_DECIMAL", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_MODEL_ID", "DIC_GOOD_GROUP_ID", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "PDE_FINAL_DELAY", "PDE_INTERMEDIATE_DELAY", "PDE_BASIS_DELAY", "C_PRODUCT_DELIVERY_TYP", "DIC_DEL_TYP_EXPLAIN_ID", "STOCK", "STOCK_TRANSFERT", "LOCATION", "TRANSFERT_LOCATION", "BALANCE_FATHER", "FINAL_FATHER", "FINAL_SON", "PDE_BALANCE_QUANTITY_PARENT", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "GCO1_CHARAC_DESCR", "GCO2_CHARAC_DESCR", "GCO3_CHARAC_DESCR", "GCO4_CHARAC_DESCR", "GCO5_CHARAC_DESCR", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5") AS
  select   PERE.FATHER
         , PERE.SON
         , PERE.CDE
         , DMT.DMT_NUMBER
         , DMT.DMT_DATE_DOCUMENT
         , DMT.C_DOCUMENT_STATUS
         , DMT.PC_LANG_ID
         , LANG.LANID
         , GAU.C_GAUGE_TYPE
         , GST.C_GAUGE_TITLE
         , GAU.C_ADMIN_DOMAIN
         , DGP.C_GAUGE_SHOW_DELAY
         , DGP.GAP_POS_DELAY
         , POS.POS_NUMBER
         , POS.C_DOC_POS_STATUS
         , POS.C_GAUGE_TYPE_POS
         , POS.DIC_UNIT_OF_MEASURE_ID
         , GOO.GOO_MAJOR_REFERENCE
         , GOO.GOO_SECONDARY_REFERENCE
         , GOO.GOO_NUMBER_OF_DECIMAL GOOD_GOO_NUMBER_OF_DECIMAL
         , decode(GAU.C_ADMIN_DOMAIN
                , '1', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', DMT.PAC_THIRD_ID)
                , '2', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', DMT.PAC_THIRD_DELIVERY_ID)
                , GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', DMT.PAC_THIRD_ID)
                 ) GOO_NUMBER_OF_DECIMAL
         , GOO.DIC_GOOD_LINE_ID
         , GOO.DIC_GOOD_FAMILY_ID
         , GOO.DIC_GOOD_MODEL_ID
         , GOO.DIC_GOOD_GROUP_ID
         , POS.POS_REFERENCE
         , POS.POS_SHORT_DESCRIPTION
         , POS.POS_LONG_DESCRIPTION
         , POS.POS_FREE_DESCRIPTION
         , POS.POS_BODY_TEXT
         , PDE.PDE_FINAL_DELAY
         , PDE.PDE_INTERMEDIATE_DELAY
         , PDE.PDE_BASIS_DELAY
         , PDT.C_PRODUCT_DELIVERY_TYP
         , PDT.DIC_DEL_TYP_EXPLAIN_ID
         , STM.STO_DESCRIPTION STOCK
         , STM_STM.STO_DESCRIPTION STOCK_TRANSFERT
         , LOC.LOC_DESCRIPTION location
         , LOC_LOC.LOC_DESCRIPTION TRANSFERT_LOCATION
         , sum(PDE.PDE_BALANCE_QUANTITY) BALANCE_FATHER
         , sum(PDE.PDE_FINAL_QUANTITY) FINAL_FATHER
         , DOC_FUNCTIONS.DocSituationFinalQtySon(PDE.DOC_POSITION_DETAIL_ID) FINAL_SON
         , DOC_FUNCTIONS.DocSituationBalanceParent(PDE.DOC_POSITION_DETAIL_ID) PDE_BALANCE_QUANTITY_PARENT
         , PDE.GCO_CHARACTERIZATION_ID
         , PDE.GCO_GCO_CHARACTERIZATION_ID
         , PDE.GCO2_GCO_CHARACTERIZATION_ID
         , PDE.GCO3_GCO_CHARACTERIZATION_ID
         , PDE.GCO4_GCO_CHARACTERIZATION_ID
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO1_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO2_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO2_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO3_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO3_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO4_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO4_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO5_CHARAC_DESCR
         , PDE.PDE_CHARACTERIZATION_VALUE_1
         , PDE.PDE_CHARACTERIZATION_VALUE_2
         , PDE.PDE_CHARACTERIZATION_VALUE_3
         , PDE.PDE_CHARACTERIZATION_VALUE_4
         , PDE.PDE_CHARACTERIZATION_VALUE_5
      from PCS.PC_LANG LANG
         , STM_LOCATION LOC
         , STM_LOCATION LOC_LOC
         , DOC_GAUGE GAU
         , DOC_GAUGE_STRUCTURED GST
         , DOC_GAUGE_POSITION DGP
         , STM_STOCK STM
         , STM_STOCK STM_STM
         , GCO_GOOD GOO
         , GCO_PRODUCT PDT
         , DOC_POSITION_DETAIL PDE
         , DOC_POSITION POS
         , DOC_DOCUMENT DMT
         , (select distinct FILS.DMT_NUMBER SON
                          , PERE.DMT_NUMBER FATHER
                          , decode(P_GAU.C_GAUGE_TITLE
                                 , '1', PERE.DMT_NUMBER
                                 , '6', PERE.DMT_NUMBER
                                 , decode(ARP_GAU.C_GAUGE_TITLE, '1', ARPE.DMT_NUMBER, '6', ARPE.DMT_NUMBER, null)
                                  ) CDE
                       from DOC_POSITION_DETAIL PDE_FILS
                          , DOC_POSITION_DETAIL PDE_PERE
                          , DOC_POSITION_DETAIL PDE_ARPE
                          , DOC_GAUGE_STRUCTURED P_GAU
                          , DOC_GAUGE_STRUCTURED ARP_GAU
                          , DOC_DOCUMENT PERE
                          , DOC_DOCUMENT ARPE
                          , DOC_DOCUMENT FILS
                      where FILS.DOC_DOCUMENT_ID = PDE_FILS.DOC_DOCUMENT_ID
                        and PDE_FILS.DOC_DOC_POSITION_DETAIL_ID = PDE_PERE.DOC_POSITION_DETAIL_ID
                        and PDE_PERE.DOC_DOCUMENT_ID = PERE.DOC_DOCUMENT_ID
                        and PERE.DOC_GAUGE_ID = P_GAU.DOC_GAUGE_ID
                        and PDE_PERE.DOC_DOC_POSITION_DETAIL_ID = PDE_ARPE.DOC_POSITION_DETAIL_ID(+)
                        and PDE_ARPE.DOC_DOCUMENT_ID = ARPE.DOC_DOCUMENT_ID(+)
                        and ARPE.DOC_GAUGE_ID = ARP_GAU.DOC_GAUGE_ID(+)
                   group by FILS.DMT_NUMBER
                          , PERE.DMT_NUMBER
                          , decode(P_GAU.C_GAUGE_TITLE
                                 , '1', PERE.DMT_NUMBER
                                 , '6', PERE.DMT_NUMBER
                                 , decode(ARP_GAU.C_GAUGE_TITLE, '1', ARPE.DMT_NUMBER, '6', ARPE.DMT_NUMBER, null)
                                  ) ) PERE
     where PERE.CDE = DMT.DMT_NUMBER
       and PDE.DOC_POSITION_ID = POS.DOC_POSITION_ID
       and POS.DOC_DOCUMENT_ID = DMT.DOC_DOCUMENT_ID
       and POS.DOC_GAUGE_POSITION_ID = DGP.DOC_GAUGE_POSITION_ID
       and DMT.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
       and GAU.DOC_GAUGE_ID = GST.DOC_GAUGE_ID
       and DMT.PC_LANG_ID = LANG.PC_LANG_ID
       and POS.C_GAUGE_TYPE_POS in('1', '3', '7', '8', '9', '10', '21')
       and PDE.STM_LOCATION_ID = LOC.STM_LOCATION_ID(+)
       and PDE.STM_STM_LOCATION_ID = LOC_LOC.STM_LOCATION_ID(+)
       and LOC.STM_STOCK_ID = STM.STM_STOCK_ID(+)
       and LOC_LOC.STM_STOCK_ID = STM_STM.STM_STOCK_ID(+)
       and POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID(+)
       and GOO.GCO_GOOD_ID = PDT.GCO_GOOD_ID(+)
  group by PERE.FATHER
         , PERE.SON
         , PERE.CDE
         , DMT.DMT_NUMBER
         , DMT.DMT_DATE_DOCUMENT
         , DMT.C_DOCUMENT_STATUS
         , DMT.PC_LANG_ID
         , LANG.LANID
         , POS.POS_NUMBER
         , POS.C_DOC_POS_STATUS
         , POS.C_GAUGE_TYPE_POS
         , GAU.C_GAUGE_TYPE
         , GST.C_GAUGE_TITLE
         , GAU.C_ADMIN_DOMAIN
         , DGP.C_GAUGE_SHOW_DELAY
         , DGP.GAP_POS_DELAY
         , POS.DIC_UNIT_OF_MEASURE_ID
         , GOO.GOO_MAJOR_REFERENCE
         , GOO.GOO_SECONDARY_REFERENCE
         , GOO.GOO_NUMBER_OF_DECIMAL
         , decode(GAU.C_ADMIN_DOMAIN
                , '1', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', DMT.PAC_THIRD_ID)
                , '2', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', DMT.PAC_THIRD_DELIVERY_ID)
                , GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', DMT.PAC_THIRD_ID)
                 )
         , GOO.DIC_GOOD_LINE_ID
         , GOO.DIC_GOOD_FAMILY_ID
         , GOO.DIC_GOOD_MODEL_ID
         , GOO.DIC_GOOD_GROUP_ID
         , POS.POS_REFERENCE
         , POS.POS_SHORT_DESCRIPTION
         , POS.POS_LONG_DESCRIPTION
         , POS.POS_FREE_DESCRIPTION
         , POS.POS_BODY_TEXT
         , POS.POS_BALANCE_QUANTITY
         , POS.POS_FINAL_QUANTITY
         , PDE.PDE_FINAL_DELAY
         , PDE.PDE_INTERMEDIATE_DELAY
         , PDE.PDE_BASIS_DELAY
         , PDT.C_PRODUCT_DELIVERY_TYP
         , PDT.DIC_DEL_TYP_EXPLAIN_ID
         , STM.STO_DESCRIPTION
         , STM_STM.STO_DESCRIPTION
         , LOC.LOC_DESCRIPTION
         , LOC_LOC.LOC_DESCRIPTION
         , DOC_FUNCTIONS.DocSituationFinalQtySon(PDE.DOC_POSITION_DETAIL_ID)
         , DOC_FUNCTIONS.DocSituationBalanceParent(PDE.DOC_POSITION_DETAIL_ID)
         , PDE.GCO_CHARACTERIZATION_ID
         , PDE.GCO_GCO_CHARACTERIZATION_ID
         , PDE.GCO2_GCO_CHARACTERIZATION_ID
         , PDE.GCO3_GCO_CHARACTERIZATION_ID
         , PDE.GCO4_GCO_CHARACTERIZATION_ID
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO2_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO3_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO4_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , PDE.PDE_CHARACTERIZATION_VALUE_1
         , PDE.PDE_CHARACTERIZATION_VALUE_2
         , PDE.PDE_CHARACTERIZATION_VALUE_3
         , PDE.PDE_CHARACTERIZATION_VALUE_4
         , PDE.PDE_CHARACTERIZATION_VALUE_5


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_SITUATION_FATHER_SON_OLD" ("FATHER", "SON", "AR_FATHER", "CDE", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "C_DOCUMENT_STATUS", "PC_LANG_ID", "LANID", "C_GAUGE_TYPE", "C_GAUGE_TITLE", "C_ADMIN_DOMAIN", "C_GAUGE_SHOW_DELAY", "GAP_POS_DELAY", "POS_NUMBER", "C_DOC_POS_STATUS", "C_GAUGE_TYPE_POS", "DIC_UNIT_OF_MEASURE_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOOD_GOO_NUMBER_OF_DECIMAL", "GOO_NUMBER_OF_DECIMAL", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_MODEL_ID", "DIC_GOOD_GROUP_ID", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "PDE_FINAL_DELAY", "PDE_INTERMEDIATE_DELAY", "PDE_BASIS_DELAY", "C_PRODUCT_DELIVERY_TYP", "DIC_DEL_TYP_EXPLAIN_ID", "STOCK", "STOCK_TRANSFERT", "LOCATION", "TRANSFERT_LOCATION", "BALANCE_FATHER", "FINAL_FATHER", "FINAL_SON", "PDE_BALANCE_QUANTITY_PARENT", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "GCO1_CHARAC_DESCR", "GCO2_CHARAC_DESCR", "GCO3_CHARAC_DESCR", "GCO4_CHARAC_DESCR", "GCO5_CHARAC_DESCR", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5") AS
  select   PERE.FATHER
         , PERE.SON
         , PERE.AR_FATHER
         , PERE.CDE
         , DMT.DMT_NUMBER
         , DMT.DMT_DATE_DOCUMENT
         , DMT.C_DOCUMENT_STATUS
         , DMT.PC_LANG_ID
         , LANG.LANID
         , GAU.C_GAUGE_TYPE
         , GST.C_GAUGE_TITLE
         , GAU.C_ADMIN_DOMAIN
         , DGP.C_GAUGE_SHOW_DELAY
         , DGP.GAP_POS_DELAY
         , POS.POS_NUMBER
         , POS.C_DOC_POS_STATUS
         , POS.C_GAUGE_TYPE_POS
         , POS.DIC_UNIT_OF_MEASURE_ID
         , GOO.GOO_MAJOR_REFERENCE
         , GOO.GOO_SECONDARY_REFERENCE
         , GOO.GOO_NUMBER_OF_DECIMAL GOOD_GOO_NUMBER_OF_DECIMAL
         , decode(GAU.C_ADMIN_DOMAIN
                , '1', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', DMT.PAC_THIRD_ID)
                , '2', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', DMT.PAC_THIRD_DELIVERY_ID)
                , GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', DMT.PAC_THIRD_ID)
                 ) GOO_NUMBER_OF_DECIMAL
         , GOO.DIC_GOOD_LINE_ID
         , GOO.DIC_GOOD_FAMILY_ID
         , GOO.DIC_GOOD_MODEL_ID
         , GOO.DIC_GOOD_GROUP_ID
         , POS.POS_REFERENCE
         , POS.POS_SHORT_DESCRIPTION
         , POS.POS_LONG_DESCRIPTION
         , POS.POS_FREE_DESCRIPTION
         , POS.POS_BODY_TEXT
         , PDE.PDE_FINAL_DELAY
         , PDE.PDE_INTERMEDIATE_DELAY
         , PDE.PDE_BASIS_DELAY
         , PDT.C_PRODUCT_DELIVERY_TYP
         , PDT.DIC_DEL_TYP_EXPLAIN_ID
         , STM.STO_DESCRIPTION STOCK
         , STM_STM.STO_DESCRIPTION STOCK_TRANSFERT
         , LOC.LOC_DESCRIPTION location
         , LOC_LOC.LOC_DESCRIPTION TRANSFERT_LOCATION
         , sum(PDE.PDE_BALANCE_QUANTITY) BALANCE_FATHER
         , sum(PDE.PDE_FINAL_QUANTITY) FINAL_FATHER
         , DOC_FUNCTIONS.DocSituationFinalQtySon(PDE.DOC_POSITION_DETAIL_ID) FINAL_SON
         , DOC_FUNCTIONS.DocSituationBalanceParent(PDE.DOC_POSITION_DETAIL_ID) PDE_BALANCE_QUANTITY_PARENT
         , PDE.GCO_CHARACTERIZATION_ID
         , PDE.GCO_GCO_CHARACTERIZATION_ID
         , PDE.GCO2_GCO_CHARACTERIZATION_ID
         , PDE.GCO3_GCO_CHARACTERIZATION_ID
         , PDE.GCO4_GCO_CHARACTERIZATION_ID
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30) GCO1_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO2_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO2_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO3_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO3_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO4_CHARAC_DESCR
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO4_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
                                                                                                      GCO5_CHARAC_DESCR
         , PDE.PDE_CHARACTERIZATION_VALUE_1
         , PDE.PDE_CHARACTERIZATION_VALUE_2
         , PDE.PDE_CHARACTERIZATION_VALUE_3
         , PDE.PDE_CHARACTERIZATION_VALUE_4
         , PDE.PDE_CHARACTERIZATION_VALUE_5
      from PCS.PC_LANG LANG
         , STM_LOCATION LOC
         , STM_LOCATION LOC_LOC
         , DOC_GAUGE GAU
         , DOC_GAUGE_STRUCTURED GST
         , DOC_GAUGE_POSITION DGP
         , STM_STOCK STM
         , STM_STOCK STM_STM
         , GCO_GOOD GOO
         , GCO_PRODUCT PDT
         , DOC_POSITION_DETAIL PDE
         , DOC_POSITION POS
         , DOC_DOCUMENT DMT
         , (select distinct FILS.DMT_NUMBER SON
                          , PERE.DMT_NUMBER FATHER
                          , ARPE.DMT_NUMBER AR_FATHER
                          , decode(P_GAU.C_GAUGE_TITLE
                                 , '1', PERE.DMT_NUMBER
                                 , '6', PERE.DMT_NUMBER
                                 , decode(ARP_GAU.C_GAUGE_TITLE, '1', ARPE.DMT_NUMBER, '6', ARPE.DMT_NUMBER, null)
                                  ) CDE
                          , P_GAU.C_GAUGE_TITLE
                          , ARP_GAU.C_GAUGE_TITLE
                       from DOC_POSITION_DETAIL PDE_FILS
                          , DOC_POSITION_DETAIL PDE_PERE
                          , DOC_POSITION_DETAIL PDE_ARPE
                          , DOC_GAUGE_STRUCTURED P_GAU
                          , DOC_GAUGE_STRUCTURED ARP_GAU
                          , DOC_DOCUMENT PERE
                          , DOC_DOCUMENT ARPE
                          , DOC_DOCUMENT FILS
                      where FILS.DOC_DOCUMENT_ID = PDE_FILS.DOC_DOCUMENT_ID
                        and PDE_FILS.DOC_DOC_POSITION_DETAIL_ID = PDE_PERE.DOC_POSITION_DETAIL_ID
                        and PDE_PERE.DOC_DOCUMENT_ID = PERE.DOC_DOCUMENT_ID
                        and PERE.DOC_GAUGE_ID = P_GAU.DOC_GAUGE_ID
                        and PDE_PERE.DOC_DOC_POSITION_DETAIL_ID = PDE_ARPE.DOC_POSITION_DETAIL_ID(+)
                        and PDE_ARPE.DOC_DOCUMENT_ID = ARPE.DOC_DOCUMENT_ID(+)
                        and ARPE.DOC_GAUGE_ID = ARP_GAU.DOC_GAUGE_ID(+)) PERE
     where PERE.CDE = DMT.DMT_NUMBER
       and PDE.DOC_POSITION_ID = POS.DOC_POSITION_ID
       and POS.DOC_DOCUMENT_ID = DMT.DOC_DOCUMENT_ID
       and POS.DOC_GAUGE_POSITION_ID = DGP.DOC_GAUGE_POSITION_ID
       and DMT.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
       and GAU.DOC_GAUGE_ID = GST.DOC_GAUGE_ID
       and DMT.PC_LANG_ID = LANG.PC_LANG_ID
       and POS.C_GAUGE_TYPE_POS in('1', '3', '7', '8', '9', '10')
       and PDE.STM_LOCATION_ID = LOC.STM_LOCATION_ID(+)
       and PDE.STM_STM_LOCATION_ID = LOC_LOC.STM_LOCATION_ID(+)
       and LOC.STM_STOCK_ID = STM.STM_STOCK_ID(+)
       and LOC_LOC.STM_STOCK_ID = STM_STM.STM_STOCK_ID(+)
       and POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID(+)
       and GOO.GCO_GOOD_ID = PDT.GCO_GOOD_ID(+)
  group by PERE.FATHER
         , PERE.SON
         , PERE.AR_FATHER
         , PERE.CDE
         , DMT.DMT_NUMBER
         , DMT.DMT_DATE_DOCUMENT
         , DMT.C_DOCUMENT_STATUS
         , DMT.PC_LANG_ID
         , LANG.LANID
         , POS.POS_NUMBER
         , POS.C_DOC_POS_STATUS
         , POS.C_GAUGE_TYPE_POS
         , GAU.C_GAUGE_TYPE
         , GST.C_GAUGE_TITLE
         , GAU.C_ADMIN_DOMAIN
         , DGP.C_GAUGE_SHOW_DELAY
         , DGP.GAP_POS_DELAY
         , POS.DIC_UNIT_OF_MEASURE_ID
         , GOO.GOO_MAJOR_REFERENCE
         , GOO.GOO_SECONDARY_REFERENCE
         , GOO.GOO_NUMBER_OF_DECIMAL
         , decode(GAU.C_ADMIN_DOMAIN
                , '1', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'PURCHASE', DMT.PAC_THIRD_ID)
                , '2', GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, 'SALE', DMT.PAC_THIRD_DELIVERY_ID)
                , GCO_FUNCTIONS.GETCDADECIMAL(POS.GCO_GOOD_ID, ' ', DMT.PAC_THIRD_ID)
                 )
         , GOO.DIC_GOOD_LINE_ID
         , GOO.DIC_GOOD_FAMILY_ID
         , GOO.DIC_GOOD_MODEL_ID
         , GOO.DIC_GOOD_GROUP_ID
         , POS.POS_REFERENCE
         , POS.POS_SHORT_DESCRIPTION
         , POS.POS_LONG_DESCRIPTION
         , POS.POS_FREE_DESCRIPTION
         , POS.POS_BODY_TEXT
         , POS.POS_BALANCE_QUANTITY
         , POS.POS_FINAL_QUANTITY
         , PDE.PDE_FINAL_DELAY
         , PDE.PDE_INTERMEDIATE_DELAY
         , PDE.PDE_BASIS_DELAY
         , PDT.C_PRODUCT_DELIVERY_TYP
         , PDT.DIC_DEL_TYP_EXPLAIN_ID
         , STM.STO_DESCRIPTION
         , STM_STM.STO_DESCRIPTION
         , LOC.LOC_DESCRIPTION
         , LOC_LOC.LOC_DESCRIPTION
         , DOC_FUNCTIONS.DocSituationFinalQtySon(PDE.DOC_POSITION_DETAIL_ID)
         , DOC_FUNCTIONS.DocSituationBalanceParent(PDE.DOC_POSITION_DETAIL_ID)
         , PDE.GCO_CHARACTERIZATION_ID
         , PDE.GCO_GCO_CHARACTERIZATION_ID
         , PDE.GCO2_GCO_CHARACTERIZATION_ID
         , PDE.GCO3_GCO_CHARACTERIZATION_ID
         , PDE.GCO4_GCO_CHARACTERIZATION_ID
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO2_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO3_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , substr(GCO_FUNCTIONS.GetCharacDescr(PDE.GCO4_GCO_CHARACTERIZATION_ID, DMT.PC_LANG_ID), 1, 30)
         , PDE.PDE_CHARACTERIZATION_VALUE_1
         , PDE.PDE_CHARACTERIZATION_VALUE_2
         , PDE.PDE_CHARACTERIZATION_VALUE_3
         , PDE.PDE_CHARACTERIZATION_VALUE_4
         , PDE.PDE_CHARACTERIZATION_VALUE_5




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_STAT_DELAY" ("V_GAUGE", "V_NAME", "V_PAYS", "V_ACT", "V_ARE", "V_DOC", "TYP_RET", "V_MOI", "DHI_BASIS_DELAY", "V_J_RETARD", "V_REF", "V_CAT", "V_LIGNE", "V_MODEL", "V_FAMILY", "V_GRP") AS
  select GAU.GAU_DESCRIBE V_GAUGE
       , PER.PER_NAME V_NAME
       , CNY.CNTNAME V_PAYS
       , DAC.ACT_DESCR V_ACT
       , DAE.ARE_DESCR V_ARE
       , DOC.DMT_NUMBER V_DOC
       , decode(dic.DDU_DESCR, null, '(none)', dic.DDU_DESCR) Typ_ret
       , decode(abs(months_between(his.DHI_BASIS_DELAY, sysdate) + 12) -
                (months_between(his.DHI_BASIS_DELAY, sysdate) + 12
                )
              , 0, to_char(his.DHI_BASIS_DELAY, 'YYYY.MM')
              , '-12 Month'
               ) V_MOI
       , his.DHI_BASIS_DELAY
       , his.DHI_BASIS_DELAY - his1.DHI_BASIS_DELAY V_J_RETARD
       , GCO.GOO_MAJOR_REFERENCE V_REF
       , GCA.GCO_GOOD_CATEGORY_WORDING V_CAT
       , LIN.DIC_GOOD_LINE_WORDING V_LIGNE
       , mod.DIC_GOOD_MODEL_WORDING V_MODEL
       , FAM.DIC_GOOD_FAMILY_WORDING V_FAMILY
       , GRP.DIC_GOOD_GROUP_WORDING V_GRP
    from doc_delay_history his
       , doc_delay_history his1
       , DIC_DELAY_UPDATE_TYPE dic
       , DOC_GAUGE GAU
       , PAC_PERSON PER
       , PAC_ADDRESS ADR
       , PCS.PC_CNTRY CNY
       , PAC_THIRD PAT
       , DIC_THIRD_ACTIVITY DAC
       , DIC_THIRD_AREA DAE
       , DOC_GAUGE_STRUCTURED GST
       , DOC_POSITION_DETAIL DET
       , DOC_POSITION POS
       , gco_good gco
       , DOC_DOCUMENT DOC
       , GCO_GOOD_CATEGORY GCA
       , DIC_GOOD_LINE LIN
       , DIC_GOOD_MODEL mod
       , DIC_GOOD_GROUP GRP
       , DIC_GOOD_FAMILY FAM
   where his1.DOC_DELAY_HISTORY_ID = doc_functions.Delay_Before(his.DOC_POSITION_DETAIL_ID, his.DOC_DELAY_HISTORY_ID)
     and dic.DIC_DELAY_UPDATE_TYPE_ID(+) = his.DIC_DELAY_UPDATE_TYPE_ID
     and det.DOC_POSITION_DETAIL_ID = his.DOC_POSITION_DETAIL_ID
     and pos.DOC_POSITION_ID = det.DOC_POSITION_ID
     and doc.DOC_DOCUMENT_ID = pos.DOC_DOCUMENT_ID
     and gco.GCO_GOOD_ID = pos.GCO_GOOD_ID
     and GST.DOC_GAUGE_ID = DOC.DOC_GAUGE_ID
     and GST.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
     and PER.PAC_PERSON_ID = ADR.PAC_PERSON_ID
     and PER.PAC_PERSON_ID = PAT.PAC_THIRD_ID
     and ADR.PAC_ADDRESS_ID = DOC.PAC_ADDRESS_ID
     and CNY.PC_CNTRY_ID = ADR.PC_CNTRY_ID
     and PAT.DIC_THIRD_ACTIVITY_ID = DAC.DIC_THIRD_ACTIVITY_ID (+)
     and PAT.DIC_THIRD_AREA_ID = DAE.DIC_THIRD_AREA_ID (+)
     and GCA.GCO_GOOD_CATEGORY_ID = GCO.GCO_GOOD_CATEGORY_ID
     and GCO.DIC_GOOD_LINE_ID = LIN.DIC_GOOD_LINE_ID(+)
     and GCO.DIC_GOOD_MODEL_ID = mod.DIC_GOOD_MODEL_ID(+)
     and GCO.DIC_GOOD_GROUP_ID = GRP.DIC_GOOD_GROUP_ID(+)
     and GCO.DIC_GOOD_FAMILY_ID = FAM.DIC_GOOD_FAMILY_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_STOCK" ("GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GCO_GOOD_CATEGORY_WORDING", "GOO_PRECIOUS_MAT", "RCO_TITLE", "DMT_NUMBER", "DMT_DATE_DOCUMENT", "DMT_DATE_DOCUMENT_CHAR", "DMT_DATE_DOCUMENT_MONTH", "DMT_DATE_DOCUMENT_WEEK", "DMT_DATE_FALLING_DUE", "DMT_DATE_FALLING_DUE_CHAR", "DMT_DATE_FALLING_DUE_MONTH", "DMT_DATE_FALLING_DUE_WEEK", "POS_NUMBER", "C_GAUGE_TYPE", "GAU_DESCRIBE", "C_GAUGE_TITLE", "C_GAUGE_TITLE_DESCR", "C_DOCUMENT_STATUS", "C_DOCUMENT_STATUS_DESCR", "C_DOC_POS_STATUS", "C_DOC_POS_STATUS_DESCR", "POS_QUANTITY_BALANCED", "DIC_GAUGE_TYPE_DOC_ID", "DIC_GAUGE_CATEG_ID", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_GROUP_ID", "DIC_GOOD_MODEL_ID", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GCO_STATISTIC_10_ID", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "DIC_UNIT_OF_MEASURE_ID", "DATA_ALPHA_COURT_1", "DATA_ALPHA_COURT_2", "DATA_ALPHA_COURT_3", "DATA_ALPHA_COURT_4", "DATA_ALPHA_COURT_5", "DATA_ALPHA_LONG_1", "DATA_ALPHA_LONG_2", "DATA_ALPHA_LONG_3", "DATA_ALPHA_LONG_4", "DATA_ALPHA_LONG_5", "DATA_INTEGER_1", "DATA_INTEGER_2", "DATA_INTEGER_3", "DATA_INTEGER_4", "DATA_INTEGER_5", "DATA_BOOLEAN_1", "DATA_BOOLEAN_2", "DATA_BOOLEAN_3", "DATA_BOOLEAN_4", "DATA_BOOLEAN_5", "DATA_DEC_1", "DATA_DEC_2", "DATA_DEC_3", "DATA_DEC_4", "DATA_DEC_5", "C_GAUGE_TYPE_POS", "POS_UNIT_COST_PRICE", "POS_NET_UNIT_VALUE", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "DIC_PDE_FREE_TABLE_1_ID", "DIC_PDE_FREE_TABLE_2_ID", "DIC_PDE_FREE_TABLE_3_ID", "PDE_TEXT_1", "PDE_TEXT_2", "PDE_TEXT_3", "PDE_DECIMAL_1", "PDE_DECIMAL_2", "PDE_DECIMAL_3", "PDE_DATE_1", "PDE_DATE_2", "PDE_DATE_3", "PDE_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "PDE_VERSION", "PDE_PIECE", "PDE_SET", "PDE_CHRONOLOGICAL", "POS_NET_VALUE_BALANCE_MB", "PDE_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "PDE_BASIS_DELAY", "PDE_INTERMEDIATE_DELAY", "PDE_FINAL_DELAY", "PDE_BASIS_DELAY_CHAR", "PDE_INTERMEDIATE_DELAY_CHAR", "PDE_FINAL_DELAY_CHAR", "PDE_BASIS_DELAY_MONTH", "PDE_INTERMEDIATE_DELAY_MONTH", "PDE_FINAL_DELAY_MONTH", "PDE_BASIS_DELAY_WEEK", "PDE_INTERMEDIATE_DELAY_WEEK", "PDE_FINAL_DELAY_WEEK", "DIC_DELAY_UPDATE_TYPE_ID", "ACTUAL_PR_MANAGE_MODE", "PRF_DEFAULT_AT_DATE", "ACTUAL_PRCS", "PDT_STOCK_MANAGEMENT", "DOC_DOCUMENT_ID", "DOC_POSITION_ID", "DOC_POSITION_DETAIL_ID", "GCO_GOOD_ID", "DOC_GAUGE_ID", "DOC_RECORD_ID", "GCO_GOOD_CATEGORY_ID", "STM_STOCK_ID", "STM_STM_STOCK_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID") AS
  SELECT gco.goo_major_reference, gco.goo_secondary_reference,
          cat.gco_good_category_wording, gco.goo_precious_mat, dre.rco_title,
          doc.dmt_number, doc.dmt_date_document,
          TO_CHAR (dmt_date_document, 'yyyy.mm.dd') dmt_date_document_char,
          TO_CHAR (dmt_date_document, 'yyyy.mm') dmt_date_document_month,
          TO_CHAR (dmt_date_document, 'iyyy.iw') dmt_date_document_week,
          doc.dmt_date_falling_due,
          TO_CHAR (doc.dmt_date_falling_due,
                   'yyyy.mm.dd'
                  ) dmt_date_falling_due_char,
          TO_CHAR (doc.dmt_date_falling_due,
                   'yyyy.mm'
                  ) dmt_date_falling_due_month,
          TO_CHAR (doc.dmt_date_falling_due,
                   'iyyy.iw'
                  ) dmt_date_falling_due_week,
          pos.pos_number, gau.c_gauge_type, gau.gau_describe,
          dgs.c_gauge_title,
             dgs.c_gauge_title
          || '-'
          || com_functions.getdescodedescr ('C_GAUGE_TITLE',
                                            dgs.c_gauge_title)
                                                          c_gauge_title_descr,
          doc.c_document_status,
             c_document_status
          || '-'
          || com_functions.getdescodedescr ('C_DOCUMENT_STATUS',
                                            doc.c_document_status
                                           ) c_document_status_descr,
          pos.c_doc_pos_status,
             pos.c_doc_pos_status
          || '-'
          || com_functions.getdescodedescr ('C_DOC_POS_STATUS',
                                            pos.c_doc_pos_status
                                           ) c_doc_pos_status_descr,
          pos.pos_quantity_balanced, gau.dic_gauge_type_doc_id,
          gau.dic_gauge_categ_id,
             gco.dic_good_line_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GOOD_LINE',
                                             gco.dic_good_line_id
                                            ) dic_good_line_id,
             gco.dic_good_family_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GOOD_FAMILY',
                                             gco.dic_good_family_id
                                            ) dic_good_family_id,
             gco.dic_good_group_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GOOD_GROUP',
                                             gco.dic_good_group_id
                                            ) dic_good_group_id,
             gco.dic_good_model_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GOOD_MODEL',
                                             gco.dic_good_model_id
                                            ) dic_good_model_id,
             gco.dic_accountable_group_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_ACCOUNTABLE_GROUP',
                                             gco.dic_accountable_group_id
                                            ) dic_accountable_group_id,
             gco.dic_gco_statistic_1_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_1',
                                             gco.dic_gco_statistic_1_id
                                            ) dic_gco_statistic_1_id,
             gco.dic_gco_statistic_2_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_2',
                                             gco.dic_gco_statistic_2_id
                                            ) dic_gco_statistic_2_id,
             gco.dic_gco_statistic_3_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_3',
                                             gco.dic_gco_statistic_3_id
                                            ) dic_gco_statistic_3_id,
             gco.dic_gco_statistic_4_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_4',
                                             gco.dic_gco_statistic_4_id
                                            ) dic_gco_statistic_4_id,
             gco.dic_gco_statistic_5_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_5',
                                             gco.dic_gco_statistic_5_id
                                            ) dic_gco_statistic_5_id,
             gco.dic_gco_statistic_6_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_6',
                                             gco.dic_gco_statistic_6_id
                                            ) dic_gco_statistic_6_id,
             gco.dic_gco_statistic_7_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_7',
                                             gco.dic_gco_statistic_7_id
                                            ) dic_gco_statistic_7_id,
             gco.dic_gco_statistic_8_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_8',
                                             gco.dic_gco_statistic_8_id
                                            ) dic_gco_statistic_8_id,
             gco.dic_gco_statistic_9_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_9',
                                             gco.dic_gco_statistic_9_id
                                            ) dic_gco_statistic_9_id,
             gco.dic_gco_statistic_10_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_GCO_STATISTIC_10',
                                             gco.dic_gco_statistic_10_id
                                            ) dic_gco_statistic_10_id,
             gfr.dic_free_table_1_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_FREE_TABLE_1',
                                             gfr.dic_free_table_1_id
                                            ) dic_free_table_1_id,
             gfr.dic_free_table_2_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_FREE_TABLE_2',
                                             gfr.dic_free_table_2_id
                                            ) dic_free_table_2_id,
             gfr.dic_free_table_3_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_FREE_TABLE_3',
                                             gfr.dic_free_table_3_id
                                            ) dic_free_table_3_id,
             gfr.dic_free_table_4_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_FREE_TABLE_4',
                                             gfr.dic_free_table_4_id
                                            ) dic_free_table_4_id,
             gfr.dic_free_table_5_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_FREE_TABLE_5',
                                             gfr.dic_free_table_5_id
                                            ) dic_free_table_5_id,
             pos.dic_unit_of_measure_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_UNIT_OF_MEASURE',
                                             pos.dic_unit_of_measure_id
                                            ) dic_unit_of_measure_id,
          gfr.data_alpha_court_1, gfr.data_alpha_court_2,
          gfr.data_alpha_court_3, gfr.data_alpha_court_4,
          gfr.data_alpha_court_5, gfr.data_alpha_long_1,
          gfr.data_alpha_long_2, gfr.data_alpha_long_3, gfr.data_alpha_long_4,
          gfr.data_alpha_long_5, gfr.data_integer_1, gfr.data_integer_2,
          gfr.data_integer_3, gfr.data_integer_4, gfr.data_integer_5,
          gfr.data_boolean_1, gfr.data_boolean_2, gfr.data_boolean_3,
          gfr.data_boolean_4, gfr.data_boolean_5, gfr.data_dec_1,
          gfr.data_dec_2, gfr.data_dec_3, gfr.data_dec_4, gfr.data_dec_5,
          pos.c_gauge_type_pos, pos.pos_unit_cost_price,
          pos.pos_net_unit_value,
             pos.dic_pos_free_table_1_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_POS_FREE_TABLE_1',
                                             pos.dic_pos_free_table_1_id
                                            ) dic_pos_free_table_1_id,
             pos.dic_pos_free_table_2_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_POS_FREE_TABLE_2',
                                             pos.dic_pos_free_table_2_id
                                            ) dic_pos_free_table_2_id,
             pos.dic_pos_free_table_3_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_POS_FREE_TABLE_3',
                                             pos.dic_pos_free_table_3_id
                                            ) dic_pos_free_table_3_id,
          pos.pos_text_1, pos.pos_text_2, pos.pos_text_3, pos.pos_decimal_1,
          pos.pos_decimal_2, pos.pos_decimal_3, pos.pos_date_1,
          pos.pos_date_2, pos.pos_date_3,
             pde.dic_pde_free_table_1_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_PDE_FREE_TABLE_1',
                                             pde.dic_pde_free_table_1_id
                                            ) dic_pde_free_table_1_id,
             pde.dic_pde_free_table_2_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_PDE_FREE_TABLE_2',
                                             pde.dic_pde_free_table_2_id
                                            ) dic_pde_free_table_2_id,
             pde.dic_pde_free_table_3_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_PDE_FREE_TABLE_3',
                                             pde.dic_pde_free_table_3_id
                                            ) dic_pde_free_table_3_id,
          pde.pde_text_1, pde.pde_text_2, pde.pde_text_3, pde.pde_decimal_1,
          pde.pde_decimal_2, pde.pde_decimal_3, pde.pde_date_1,
          pde.pde_date_2, pde.pde_date_3, pde.pde_balance_quantity,
            pde.pde_balance_quantity
          * pos.pos_net_unit_value pos_net_value_balance,
          pde.pde_version, pde.pde_piece, pde.pde_set, pde.pde_chronological,
          CASE
             WHEN pos.pos_final_quantity = 0
                THEN 0
             ELSE   pde.pde_balance_quantity
                  * (pos.pos_net_value_excl_b / pos.pos_final_quantity)
          END pos_net_value_balance_mb,
          pde_final_quantity,
          CASE
             WHEN pos_final_quantity = 0
                THEN 0
             WHEN dgs.c_gauge_title <> '9'
                THEN (pos_net_value_excl / pos_final_quantity
                     )
             ELSE -1 * (pos_net_value_excl / pos_final_quantity)
          END pos_net_value_excl,
          CASE
             WHEN pos_final_quantity = 0
                THEN 0
             WHEN dgs.c_gauge_title <> '9'
                THEN (pos_net_value_excl_b / pos_final_quantity
                     )
             ELSE -1 * (pos_net_value_excl_b / pos_final_quantity)
          END pos_net_value_excl_mb,
          pde.pde_basis_delay, pde.pde_intermediate_delay,
          pde.pde_final_delay,
          TO_CHAR (pde.pde_basis_delay, 'YYYY.MM.DD') pde_basis_delay_char,
          TO_CHAR (pde.pde_intermediate_delay,
                   'YYYY.MM.DD'
                  ) pde_intermediate_delay_char,
          TO_CHAR (pde.pde_final_delay, 'YYYY.MM.DD') pde_final_delay_char,
          TO_CHAR (pde.pde_basis_delay, 'YYYY.MM') pde_basis_delay_month,
          TO_CHAR (pde.pde_intermediate_delay,
                   'YYYY.MM'
                  ) pde_intermediate_delay_month,
          TO_CHAR (pde.pde_final_delay, 'YYYY.MM') pde_final_delay_month,
          TO_CHAR (pde.pde_basis_delay, 'IYYY.IW') pde_basis_delay_week,
          TO_CHAR (pde.pde_intermediate_delay,
                   'IYYY.IW'
                  ) pde_intermediate_delay_week,
          TO_CHAR (pde.pde_final_delay, 'IYYY.IW') pde_final_delay_week,
             pde.dic_delay_update_type_id
          || '-'
          || com_dic_functions.getdicodescr ('DIC_DELAY_UPDATE_TYPE',
                                             pde.dic_delay_update_type_id
                                            ) dic_delay_update_type_id,
          gco_functions.getcostpricewithmanagementmode
                                      (pos.gco_good_id,
                                       NULL,
                                       NULL,
                                       SYSDATE
                                      ) actual_pr_manage_mode,
          gco_functions.getcostpricewithmanagementmode
                                   (pos.gco_good_id,
                                    NULL,
                                    '3',
                                    doc.dmt_date_document
                                   ) prf_default_at_date,
          gco_functions.getcostpricewithmanagementmode
                                                (pos.gco_good_id,
                                                 NULL,
                                                 '1',
                                                 NULL
                                                ) actual_prcs,
          CASE
             WHEN gpr.pdt_stock_management = 1
                THEN 'YES'
             WHEN gpr.pdt_stock_management = 0
                THEN 'NO'
             ELSE 'INV'
          END pdt_stock_management,
          doc.doc_document_id, pos.doc_position_id,
          pde.doc_position_detail_id, gco.gco_good_id, gau.doc_gauge_id,
          dre.doc_record_id, cat.gco_good_category_id, pos.stm_stock_id,
          pos.stm_stm_stock_id, pde.stm_location_id, pde.stm_stm_location_id
     FROM doc_document doc,
          doc_position pos,
          doc_position_detail pde,
          gco_good gco,
          gco_product gpr,
          gco_free_data gfr,
          doc_gauge gau,
          doc_gauge_structured dgs,
          doc_record dre,
          gco_good_category cat
    WHERE doc.doc_document_id = pos.doc_document_id
      AND pos.doc_position_id = pde.doc_position_id
      AND pos.gco_good_id = gco.gco_good_id
      AND gco.gco_good_id = gpr.gco_good_id(+)
      AND gco.gco_good_id = gfr.gco_good_id(+)
      AND doc.doc_gauge_id = gau.doc_gauge_id
      AND gau.doc_gauge_id = dgs.doc_gauge_id
      AND pos.doc_record_id = dre.doc_record_id(+)
      AND gco.gco_good_category_id = cat.gco_good_category_id
      AND gau.c_admin_domain = '3'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_TGB_CE" ("V_CUSTOM_NUMBER", "V_CNT", "V_FINANCIAL_CURRENCY_ID", "V_DMT_NUMBER", "V_DATE_DOCUMENT", "V_VALUE", "V_TAX", "V_NET_WEIGHT", "V_QTY", "V_TRANS", "V_INCOTERMS", "V_CONDITION_MODE", "V_CNT_ORG", "V_INTRA", "V_DATE", "V_YEAR", "V_MONTH", "V_FLUX") AS
  select nvl(CUS.CUS_CUSTONS_POSITION, 0) V_CUSTOM_NUMBER
       , nvl(CTY.CNTID, 0) V_CNT
       , DOC.ACS_FINANCIAL_CURRENCY_ID V_FINANCIAL_CURRENCY_ID
       , DOC.DMT_NUMBER V_DMT_NUMBER
       , DOC.DMT_DATE_DOCUMENT V_DATE_DOCUMENT
       , decode(GAU.C_GAUGE_TITLE, '9', POS.POS_NET_VALUE_EXCL_B * -1, decode(GAU.C_GAUGE_TITLE, '5', POS.POS_NET_VALUE_EXCL_B * -1, POS.POS_NET_VALUE_EXCL_B) )
                                                                                                                                                        V_VALUE
       , nvl(decode(DOC.DIC_GAUGE_FREE_CODE_2_ID
                  , null, decode(GAU.C_GAUGE_TITLE, '4', '11', decode(GAU.C_GAUGE_TITLE, '5', '11', '21') )
                  , DOC.DIC_GAUGE_FREE_CODE_2_ID
                   )
           , 0
            ) V_TAX
       , POS.POS_NET_weight V_NET_WEIGHT
       , POS.POS_FINAL_QUANTITY V_QTY
       , nvl(decode(DOC.DIC_GAUGE_FREE_CODE_3_ID, null, '11', DOC.DIC_GAUGE_FREE_CODE_3_ID), 0) V_TRANS
       , nvl(decode(length(DOC.C_INCOTERMS), 4, DOC.C_INCOTERMS, DOC.C_INCOTERMS || decode(DOC.DMT_GAU_FREE_NUMBER1, null, '1', DOC.DMT_GAU_FREE_NUMBER1) ), 0)
                                                                                                                                                    V_INCOTERMS
       , nvl(SEN.C_CONDITION_MODE, 0) V_CONDITION_MODE
       , nvl(ORG.CNTID, 0) V_CNT_ORG
       , nvl(THI.THI_NO_INTRA, 0) V_INTRA
       , DOC.DMT_DATE_DOCUMENT
       , to_char(DOC.DMT_DATE_DOCUMENT, 'YYYY') V_YEAR
       , to_char(DOC.DMT_DATE_DOCUMENT, 'MM') V_MONTH
       , nvl(decode(GAU.C_GAUGE_TITLE, 4, 'I', decode(GAU.C_GAUGE_TITLE, 5, 'I', 'E') ), 0) V_FLUX
    from DOC_DOCUMENT DOC
       , DOC_POSITION POS
       , GCO_CUSTOMS_ELEMENT CUS
       , DOC_GAUGE_STRUCTURED GAU
       , PAC_ADDRESS ADR
       , PAC_THIRD THI
       , PCS.PC_CNTRY CTY
       , PCS.PC_CNTRY ORG
       , PAC_SENDING_CONDITION SEN
   where DOC.PAC_SENDING_CONDITION_ID = SEN.PAC_SENDING_CONDITION_ID(+)
     and POS.DOC_DOCUMENT_ID = DOC.DOC_DOCUMENT_ID
     and POS.GCO_GOOD_ID = CUS.GCO_GOOD_ID(+)
     and ORG.PC_CNTRY_ID(+) = CUS.PC_CNTRY_ID
     and DOC.DOC_GAUGE_ID = GAU.DOC_GAUGE_ID
     and DOC.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID
     and ADR.PAC_PERSON_ID = THI.PAC_THIRD_ID
     and ADR.PC_CNTRY_ID = CTY.PC_CNTRY_ID
     and DOC.C_DOCUMENT_STATUS = '04'
     and (   GAU.C_GAUGE_TITLE = '4'
          or GAU.C_GAUGE_TITLE = '5'
          or GAU.C_GAUGE_TITLE = '8'
          or GAU.C_GAUGE_TITLE = '9'
          or GAU.C_GAUGE_TITLE = '30')
     and CTY.CNT_CE_MEMBER = 1
     and CUS.C_CUSTOMS_ELEMENT_TYPE = 'EXPORT'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DOC_VAT_DET_ACCOUNT" ("DOC_DOCUMENT_ID", "ACS_TAX_CODE_ID", "VDA_NET_AMOUNT_EXCL", "VDA_LIABLED_RATE", "VDA_LIABLE_AMOUNT", "VDA_VAT_RATE", "VDA_VAT_TOTAL_AMOUNT", "VDA_VAT_DEDUCTIBLE_RATE", "VDA_VAT_AMOUNT", "VDA_LIABLE_AMOUNT_B", "VDA_VAT_TOTAL_AMOUNT_B", "VDA_VAT_BASE_AMOUNT", "VDA_LIABLE_AMOUNT_V", "VDA_VAT_TOTAL_AMOUNT_V", "VDA_VAT_AMOUNT_V") AS
  select   doc_document_id
         , acs_tax_code_id
         , sum(vda_net_amount_excl) vda_net_amount_excl
         , vda_liabled_rate vda_liabled_rate
         , sum(vda_liable_amount) vda_liable_amount
         , vda_vat_rate
         , sum(vda_vat_total_amount) vda_vat_total_amount
         , vda_vat_deductible_rate vda_vat_deductible_rate
         , sum(vda_vat_amount) vda_vat_amount
         , sum(vda_liable_amount_b) vda_liable_amount_b
         , sum(vda_vat_total_amount_b) vda_vat_total_amount_b
         , sum(vda_vat_base_amount) vda_vat_base_amount
         , sum(vda_liable_amount_v) vda_liable_amount_v
         , sum(vda_vat_total_amount_v) vda_vat_total_amount_v
         , sum(vda_vat_amount_v) vda_vat_amount_v
      from (select   doc_document_id
                   , acs_tax_code_id
                   , sum(pos_net_value_excl) vda_net_amount_excl
                   , pos_vat_liabled_rate vda_liabled_rate
                   , sum(pos_vat_liabled_amount) vda_liable_amount
                   , pos_vat_rate vda_vat_rate
                   , sum(pos_vat_total_amount) vda_vat_total_amount
                   , pos_vat_deductible_rate vda_vat_deductible_rate
                   , sum(pos_vat_amount) vda_vat_amount
                   , (sum(pos_net_value_excl_b) * pos_vat_liabled_rate / 100) vda_liable_amount_b
                   , sum(pos_vat_total_amount_b) vda_vat_total_amount_b
                   , sum(pos_vat_base_amount) vda_vat_base_amount
                   , (sum(pos_net_value_excl_v) * pos_vat_liabled_rate / 100) vda_liable_amount_v
                   , sum(pos_vat_total_amount_v) vda_vat_total_amount_v
                   , sum(pos_vat_amount_v) vda_vat_amount_v
                from doc_position
               where acs_tax_code_id is not null
                 and c_doc_pos_status <> '05'
            group by doc_document_id
                   , acs_tax_code_id
                   , pos_vat_liabled_rate
                   , pos_vat_rate
                   , pos_vat_deductible_rate
            union all
            select   doc_foot_id doc_document_id
                   , acs_tax_code_id
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_excl_amount) vda_net_amount_excl
                   , fch_vat_liabled_rate vda_liabled_rate
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_liabled_amount) vda_liable_amount
                   , fch_vat_rate vda_vat_rate
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_total_amount) vda_vat_total_amount
                   , fch_vat_deductible_rate vda_vat_deductible_rate
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_amount) vda_vat_amount
                   , (sum(decode(c_financial_charge, '02', -1, 1) * fch_excl_amount_b) * fch_vat_liabled_rate / 100) vda_liable_amount_b
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_total_amount_b) vda_vat_total_amount_b
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_base_amount) vda_vat_base_amount
                   , (sum(decode(c_financial_charge, '02', -1, 1) * fch_excl_amount_v) * fch_vat_liabled_rate / 100) vda_liable_amount_v
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_total_amount_v) vda_vat_total_amount_v
                   , sum(decode(c_financial_charge, '02', -1, 1) * fch_vat_amount_v) vda_vat_amount_v
                from doc_foot_charge
               where acs_tax_code_id is not null
            group by doc_foot_id
                   , acs_tax_code_id
                   , fch_vat_liabled_rate
                   , fch_vat_rate
                   , fch_vat_deductible_rate)
  group by doc_document_id
         , acs_tax_code_id
         , vda_liabled_rate
         , vda_vat_rate
         , vda_vat_deductible_rate


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_CONSTS" ("NAME", "VALUE", "DESCRIPTION") AS
  select 'not_applicable' NAME, 'DWH_NA' VALUE, 'The dictionary or descode value is not applicable' DESCRIPTION
  from DUAL
  union all
  select 'is_null' NAME, 'DWH_ISNULL' VALUE, 'The dictionary or descode value is null' DESCRIPTION
  from DUAL
  union all
  select 'foreign_key_na' NAME, '-1' VALUE, 'The foreign key is not applicable' DESCRIPTION
  from DUAL
  union all
  select 'foreign_key_is_null' NAME, '-2' VALUE, 'The foreing key is null' DESCRIPTION
  from DUAL
  union all
  select 'bool_true' NAME, 'DWH_TRUE' VALUE, 'Represents the boolean value true' DESCRIPTION
  from DUAL
  union all
  select 'bool_false' NAME, 'DWH_FALSE' VALUE, 'Represents the boolean false value' DESCRIPTION
  from DUAL
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACB_BUDGET_VERSION" ("ACB_BUDGET_VERSION_ID", "ACB_BUDGET_ID", "C_BUDGET_STATUS", "VER_NUMBER", "VER_COMMENT", "VER_DEFAULT", "VER_CASH_FLOW", "VER_FIX_ASSETS") AS
  select ACB_BUDGET_VERSION_ID
       , Nvl(ACB_BUDGET_ID, -2) ACB_BUDGET_ID
       , Nvl(C_BUDGET_STATUS, 'DWH_ISNULL') C_BUDGET_STATUS
       , Nvl(VER_NUMBER, '_') VER_NUMBER
       , Nvl(VER_COMMENT, '_') VER_COMMENT
       , Nvl2(VER_DEFAULT, case
                when(VER_DEFAULT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VER_DEFAULT
       , Nvl2(VER_CASH_FLOW, case
                when(VER_CASH_FLOW = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VER_CASH_FLOW
       , Nvl2(VER_FIX_ASSETS, case
                when(VER_FIX_ASSETS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VER_FIX_ASSETS
  from ACB_BUDGET_VERSION
  union all
  select -1 ACB_BUDGET_VERSION_ID
       , -1 ACB_BUDGET_ID
       , 'DWH_NA' C_BUDGET_STATUS
       , 'N/A' VER_NUMBER
       , 'N/A' VER_COMMENT
       , '-1' VER_DEFAULT
       , '-1' VER_CASH_FLOW
       , '-1' VER_FIX_ASSETS
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACB_GLOBAL_BUDGET" ("ACB_GLOBAL_BUDGET_ID", "C_BUDGET_TYPE", "C_BUDGET_KIND", "DIC_UPDATE_REASON_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_BUDGET_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_QTY_UNIT_ID", "GLO_DESCR", "GLO_AMOUNT_D", "GLO_AMOUNT_C", "GLO_QTY_D", "GLO_QTY_C", "GLO_RATE", "GLO_ROUNDED_AMOUNT", "ACB_BUDGET_VERSION_ID", "GCO_GOOD_ID", "PAC_PERSON_ID", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "DOC_RECORD_ID", "C_FAM_TRANSACTION_TYP", "ACB_DIST_METHOD_ID", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "GLO_FAM_SIMULATION") AS
  select ACB_GLOBAL_BUDGET_ID
       , Nvl(C_BUDGET_TYPE, 'DWH_ISNULL') C_BUDGET_TYPE
       , Nvl(C_BUDGET_KIND, 'DWH_ISNULL') C_BUDGET_KIND
       , Nvl(DIC_UPDATE_REASON_ID, 'DWH_ISNULL') DIC_UPDATE_REASON_ID
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_BUDGET_ACCOUNT_ID, -2) ACS_BUDGET_ACCOUNT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_QTY_UNIT_ID, -2) ACS_QTY_UNIT_ID
       , Nvl(GLO_DESCR, '_') GLO_DESCR
       , GLO_AMOUNT_D
       , GLO_AMOUNT_C
       , GLO_QTY_D
       , GLO_QTY_C
       , GLO_RATE
       , GLO_ROUNDED_AMOUNT
       , Nvl(ACB_BUDGET_VERSION_ID, -2) ACB_BUDGET_VERSION_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(ACB_DIST_METHOD_ID, -2) ACB_DIST_METHOD_ID
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , IMF_NUMBER
       , IMF_NUMBER2
       , IMF_NUMBER3
       , IMF_NUMBER4
       , IMF_NUMBER5
       , Nvl(IMF_TEXT1, '_') IMF_TEXT1
       , Nvl(IMF_TEXT2, '_') IMF_TEXT2
       , Nvl(IMF_TEXT3, '_') IMF_TEXT3
       , Nvl(IMF_TEXT4, '_') IMF_TEXT4
       , Nvl(IMF_TEXT5, '_') IMF_TEXT5
       , Nvl2(GLO_FAM_SIMULATION, case
                when(GLO_FAM_SIMULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GLO_FAM_SIMULATION
  from ACB_GLOBAL_BUDGET
  union all
  select -1 ACB_GLOBAL_BUDGET_ID
       , 'DWH_NA' C_BUDGET_TYPE
       , 'DWH_NA' C_BUDGET_KIND
       , 'DWH_NA' DIC_UPDATE_REASON_ID
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_BUDGET_ACCOUNT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_QTY_UNIT_ID
       , 'N/A' GLO_DESCR
       , null GLO_AMOUNT_D
       , null GLO_AMOUNT_C
       , null GLO_QTY_D
       , null GLO_QTY_C
       , null GLO_RATE
       , null GLO_ROUNDED_AMOUNT
       , -1 ACB_BUDGET_VERSION_ID
       , -1 GCO_GOOD_ID
       , -1 PAC_PERSON_ID
       , -1 HRM_PERSON_ID
       , -1 FAM_FIXED_ASSETS_ID
       , -1 DOC_RECORD_ID
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , -1 ACB_DIST_METHOD_ID
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , null IMF_NUMBER
       , null IMF_NUMBER2
       , null IMF_NUMBER3
       , null IMF_NUMBER4
       , null IMF_NUMBER5
       , 'N/A' IMF_TEXT1
       , 'N/A' IMF_TEXT2
       , 'N/A' IMF_TEXT3
       , 'N/A' IMF_TEXT4
       , 'N/A' IMF_TEXT5
       , '-1' GLO_FAM_SIMULATION
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACB_PERIOD_AMOUNT" ("ACB_PERIOD_AMOUNT_ID", "ACB_GLOBAL_BUDGET_ID", "ACS_PERIOD_ID", "PER_AMOUNT_D", "PER_AMOUNT_C", "PER_QTY_D", "PER_QTY_C") AS
  select ACB_PERIOD_AMOUNT_ID
       , Nvl(ACB_GLOBAL_BUDGET_ID, -2) ACB_GLOBAL_BUDGET_ID
       , Nvl(ACS_PERIOD_ID, -2) ACS_PERIOD_ID
       , PER_AMOUNT_D
       , PER_AMOUNT_C
       , PER_QTY_D
       , PER_QTY_C
  from ACB_PERIOD_AMOUNT
  union all
  select -1 ACB_PERIOD_AMOUNT_ID
       , -1 ACB_GLOBAL_BUDGET_ID
       , -1 ACS_PERIOD_ID
       , null PER_AMOUNT_D
       , null PER_AMOUNT_C
       , null PER_QTY_D
       , null PER_QTY_C
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_ACCOUNT" ("ACS_ACCOUNT_ID", "ACS_SUB_SET_ID", "C_VALID", "ACC_NUMBER", "ACC_DETAIL_PRINTING", "ACC_BLOCKED", "ACC_INTEREST", "ACC_VALID_SINCE", "ACC_VALID_TO", "ACS_SUB_ACCOUNT_ID", "ACC_TRANSACTION", "ACC_BUDGET", "PAC_PERSON_ID", "ACS_ACCOUNT_CATEG_ID") AS
  select ACS_ACCOUNT_ID
       , Nvl(ACS_SUB_SET_ID, -2) ACS_SUB_SET_ID
       , Nvl(C_VALID, 'DWH_ISNULL') C_VALID
       , Nvl(ACC_NUMBER, '_') ACC_NUMBER
       , Nvl2(ACC_DETAIL_PRINTING, case
                when(ACC_DETAIL_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ACC_DETAIL_PRINTING
       , Nvl2(ACC_BLOCKED, case
                when(ACC_BLOCKED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ACC_BLOCKED
       , Nvl2(ACC_INTEREST, case
                when(ACC_INTEREST = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ACC_INTEREST
       , Nvl(ACC_VALID_SINCE, to_date('40000101', 'YYYYMMDD') ) ACC_VALID_SINCE
       , Nvl(ACC_VALID_TO, to_date('40000101', 'YYYYMMDD') ) ACC_VALID_TO
       , Nvl(ACS_SUB_ACCOUNT_ID, -2) ACS_SUB_ACCOUNT_ID
       , Nvl2(ACC_TRANSACTION, case
                when(ACC_TRANSACTION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ACC_TRANSACTION
       , Nvl2(ACC_BUDGET, case
                when(ACC_BUDGET = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ACC_BUDGET
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(ACS_ACCOUNT_CATEG_ID, -2) ACS_ACCOUNT_CATEG_ID
  from ACS_ACCOUNT
  union all
  select -1 ACS_ACCOUNT_ID
       , -1 ACS_SUB_SET_ID
       , 'DWH_NA' C_VALID
       , 'N/A' ACC_NUMBER
       , '-1' ACC_DETAIL_PRINTING
       , '-1' ACC_BLOCKED
       , '-1' ACC_INTEREST
       , to_date('00010101', 'YYYYMMDD') ACC_VALID_SINCE
       , to_date('00010101', 'YYYYMMDD') ACC_VALID_TO
       , -1 ACS_SUB_ACCOUNT_ID
       , '-1' ACC_TRANSACTION
       , '-1' ACC_BUDGET
       , -1 PAC_PERSON_ID
       , -1 ACS_ACCOUNT_CATEG_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_ALT_DESCRIPTION" ("ACS_ALT_DESCRIPTION_ID", "ACS_SYNONYM_DATA_ID", "ACS_ALTERNATIVE_ID", "PC_LANG_ID", "ALT_DESCRIPTION", "ALT_LONG_DESCRIPTION", "ALT_TEXT") AS
  select ACS_ALT_DESCRIPTION_ID
       , Nvl(ACS_SYNONYM_DATA_ID, -2) ACS_SYNONYM_DATA_ID
       , Nvl(ACS_ALTERNATIVE_ID, -2) ACS_ALTERNATIVE_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(ALT_DESCRIPTION, '_') ALT_DESCRIPTION
       , Nvl(ALT_LONG_DESCRIPTION, '_') ALT_LONG_DESCRIPTION
       , Nvl(ALT_TEXT, '_') ALT_TEXT
  from ACS_ALT_DESCRIPTION
  union all
  select -1 ACS_ALT_DESCRIPTION_ID
       , -1 ACS_SYNONYM_DATA_ID
       , -1 ACS_ALTERNATIVE_ID
       , -1 PC_LANG_ID
       , 'N/A' ALT_DESCRIPTION
       , 'N/A' ALT_LONG_DESCRIPTION
       , 'N/A' ALT_TEXT
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_CDA_ACCOUNT" ("ACS_CDA_ACCOUNT_ID", "C_CENTER_TYPE", "DIC_CDA_FREECODE1_ID", "DIC_CDA_FREECODE2_ID", "DIC_CDA_FREECODE3_ID", "DIC_CDA_FREECODE4_ID", "DIC_CDA_FREECODE5_ID", "HRM_EMPLOYEE_ID", "DIC_CDA_FREECODE6_ID", "DIC_CDA_FREECODE7_ID", "DIC_CDA_FREECODE8_ID", "DIC_CDA_FREECODE9_ID", "DIC_CDA_FREECODE10_ID", "MGM_RATE1", "MGM_RATE2", "MGM_RATE3", "MGM_RATE4", "MGM_RATE5", "MGM_RATE6", "MGM_RATE7", "MGM_RATE8", "MGM_RATE9", "MGM_RATE10", "MGM_AMOUNT1", "MGM_AMOUNT2", "MGM_AMOUNT3", "MGM_AMOUNT4", "MGM_AMOUNT5", "MGM_AMOUNT6", "MGM_AMOUNT7", "MGM_AMOUNT8", "MGM_AMOUNT9", "MGM_AMOUNT10") AS
  select ACS_CDA_ACCOUNT_ID
       , Nvl(C_CENTER_TYPE, 'DWH_ISNULL') C_CENTER_TYPE
       , Nvl(DIC_CDA_FREECODE1_ID, 'DWH_ISNULL') DIC_CDA_FREECODE1_ID
       , Nvl(DIC_CDA_FREECODE2_ID, 'DWH_ISNULL') DIC_CDA_FREECODE2_ID
       , Nvl(DIC_CDA_FREECODE3_ID, 'DWH_ISNULL') DIC_CDA_FREECODE3_ID
       , Nvl(DIC_CDA_FREECODE4_ID, 'DWH_ISNULL') DIC_CDA_FREECODE4_ID
       , Nvl(DIC_CDA_FREECODE5_ID, 'DWH_ISNULL') DIC_CDA_FREECODE5_ID
       , Nvl(HRM_EMPLOYEE_ID, -2) HRM_EMPLOYEE_ID
       , Nvl(DIC_CDA_FREECODE6_ID, 'DWH_ISNULL') DIC_CDA_FREECODE6_ID
       , Nvl(DIC_CDA_FREECODE7_ID, 'DWH_ISNULL') DIC_CDA_FREECODE7_ID
       , Nvl(DIC_CDA_FREECODE8_ID, 'DWH_ISNULL') DIC_CDA_FREECODE8_ID
       , Nvl(DIC_CDA_FREECODE9_ID, 'DWH_ISNULL') DIC_CDA_FREECODE9_ID
       , Nvl(DIC_CDA_FREECODE10_ID, 'DWH_ISNULL') DIC_CDA_FREECODE10_ID
       , MGM_RATE1
       , MGM_RATE2
       , MGM_RATE3
       , MGM_RATE4
       , MGM_RATE5
       , MGM_RATE6
       , MGM_RATE7
       , MGM_RATE8
       , MGM_RATE9
       , MGM_RATE10
       , MGM_AMOUNT1
       , MGM_AMOUNT2
       , MGM_AMOUNT3
       , MGM_AMOUNT4
       , MGM_AMOUNT5
       , MGM_AMOUNT6
       , MGM_AMOUNT7
       , MGM_AMOUNT8
       , MGM_AMOUNT9
       , MGM_AMOUNT10
  from ACS_CDA_ACCOUNT
  union all
  select -1 ACS_CDA_ACCOUNT_ID
       , 'DWH_NA' C_CENTER_TYPE
       , 'DWH_NA' DIC_CDA_FREECODE1_ID
       , 'DWH_NA' DIC_CDA_FREECODE2_ID
       , 'DWH_NA' DIC_CDA_FREECODE3_ID
       , 'DWH_NA' DIC_CDA_FREECODE4_ID
       , 'DWH_NA' DIC_CDA_FREECODE5_ID
       , -1 HRM_EMPLOYEE_ID
       , 'DWH_NA' DIC_CDA_FREECODE6_ID
       , 'DWH_NA' DIC_CDA_FREECODE7_ID
       , 'DWH_NA' DIC_CDA_FREECODE8_ID
       , 'DWH_NA' DIC_CDA_FREECODE9_ID
       , 'DWH_NA' DIC_CDA_FREECODE10_ID
       , null MGM_RATE1
       , null MGM_RATE2
       , null MGM_RATE3
       , null MGM_RATE4
       , null MGM_RATE5
       , null MGM_RATE6
       , null MGM_RATE7
       , null MGM_RATE8
       , null MGM_RATE9
       , null MGM_RATE10
       , null MGM_AMOUNT1
       , null MGM_AMOUNT2
       , null MGM_AMOUNT3
       , null MGM_AMOUNT4
       , null MGM_AMOUNT5
       , null MGM_AMOUNT6
       , null MGM_AMOUNT7
       , null MGM_AMOUNT8
       , null MGM_AMOUNT9
       , null MGM_AMOUNT10
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_CPN_ACCOUNT" ("ACS_CPN_ACCOUNT_ID", "HRM_EMPLOYEE_ID", "DIC_CPN_FREECODE1_ID", "DIC_CPN_FREECODE2_ID", "DIC_CPN_FREECODE3_ID", "DIC_CPN_FREECODE4_ID", "DIC_CPN_FREECODE5_ID", "DIC_CPN_FREECODE6_ID", "DIC_CPN_FREECODE7_ID", "DIC_CPN_FREECODE8_ID", "DIC_CPN_FREECODE9_ID", "DIC_CPN_FREECODE10_ID", "C_CDA_IMPUTATION", "C_PF_IMPUTATION", "C_PJ_IMPUTATION", "MGM_RATE1", "MGM_RATE2", "MGM_RATE3", "MGM_RATE4", "MGM_RATE5", "MGM_RATE6", "MGM_RATE7", "MGM_RATE8", "MGM_RATE9", "MGM_RATE10", "MGM_AMOUNT1", "MGM_AMOUNT2", "MGM_AMOUNT3", "MGM_AMOUNT4", "MGM_AMOUNT5", "MGM_AMOUNT6", "MGM_AMOUNT7", "MGM_AMOUNT8", "MGM_AMOUNT9", "MGM_AMOUNT10", "C_EXPENSE_RECEIPT") AS
  select ACS_CPN_ACCOUNT_ID
       , Nvl(HRM_EMPLOYEE_ID, -2) HRM_EMPLOYEE_ID
       , Nvl(DIC_CPN_FREECODE1_ID, 'DWH_ISNULL') DIC_CPN_FREECODE1_ID
       , Nvl(DIC_CPN_FREECODE2_ID, 'DWH_ISNULL') DIC_CPN_FREECODE2_ID
       , Nvl(DIC_CPN_FREECODE3_ID, 'DWH_ISNULL') DIC_CPN_FREECODE3_ID
       , Nvl(DIC_CPN_FREECODE4_ID, 'DWH_ISNULL') DIC_CPN_FREECODE4_ID
       , Nvl(DIC_CPN_FREECODE5_ID, 'DWH_ISNULL') DIC_CPN_FREECODE5_ID
       , Nvl(DIC_CPN_FREECODE6_ID, 'DWH_ISNULL') DIC_CPN_FREECODE6_ID
       , Nvl(DIC_CPN_FREECODE7_ID, 'DWH_ISNULL') DIC_CPN_FREECODE7_ID
       , Nvl(DIC_CPN_FREECODE8_ID, 'DWH_ISNULL') DIC_CPN_FREECODE8_ID
       , Nvl(DIC_CPN_FREECODE9_ID, 'DWH_ISNULL') DIC_CPN_FREECODE9_ID
       , Nvl(DIC_CPN_FREECODE10_ID, 'DWH_ISNULL') DIC_CPN_FREECODE10_ID
       , Nvl(C_CDA_IMPUTATION, 'DWH_ISNULL') C_CDA_IMPUTATION
       , Nvl(C_PF_IMPUTATION, 'DWH_ISNULL') C_PF_IMPUTATION
       , Nvl(C_PJ_IMPUTATION, 'DWH_ISNULL') C_PJ_IMPUTATION
       , MGM_RATE1
       , MGM_RATE2
       , MGM_RATE3
       , MGM_RATE4
       , MGM_RATE5
       , MGM_RATE6
       , MGM_RATE7
       , MGM_RATE8
       , MGM_RATE9
       , MGM_RATE10
       , MGM_AMOUNT1
       , MGM_AMOUNT2
       , MGM_AMOUNT3
       , MGM_AMOUNT4
       , MGM_AMOUNT5
       , MGM_AMOUNT6
       , MGM_AMOUNT7
       , MGM_AMOUNT8
       , MGM_AMOUNT9
       , MGM_AMOUNT10
       , Nvl(C_EXPENSE_RECEIPT, 'DWH_ISNULL') C_EXPENSE_RECEIPT
  from ACS_CPN_ACCOUNT
  union all
  select -1 ACS_CPN_ACCOUNT_ID
       , -1 HRM_EMPLOYEE_ID
       , 'DWH_NA' DIC_CPN_FREECODE1_ID
       , 'DWH_NA' DIC_CPN_FREECODE2_ID
       , 'DWH_NA' DIC_CPN_FREECODE3_ID
       , 'DWH_NA' DIC_CPN_FREECODE4_ID
       , 'DWH_NA' DIC_CPN_FREECODE5_ID
       , 'DWH_NA' DIC_CPN_FREECODE6_ID
       , 'DWH_NA' DIC_CPN_FREECODE7_ID
       , 'DWH_NA' DIC_CPN_FREECODE8_ID
       , 'DWH_NA' DIC_CPN_FREECODE9_ID
       , 'DWH_NA' DIC_CPN_FREECODE10_ID
       , 'DWH_NA' C_CDA_IMPUTATION
       , 'DWH_NA' C_PF_IMPUTATION
       , 'DWH_NA' C_PJ_IMPUTATION
       , null MGM_RATE1
       , null MGM_RATE2
       , null MGM_RATE3
       , null MGM_RATE4
       , null MGM_RATE5
       , null MGM_RATE6
       , null MGM_RATE7
       , null MGM_RATE8
       , null MGM_RATE9
       , null MGM_RATE10
       , null MGM_AMOUNT1
       , null MGM_AMOUNT2
       , null MGM_AMOUNT3
       , null MGM_AMOUNT4
       , null MGM_AMOUNT5
       , null MGM_AMOUNT6
       , null MGM_AMOUNT7
       , null MGM_AMOUNT8
       , null MGM_AMOUNT9
       , null MGM_AMOUNT10
       , 'DWH_NA' C_EXPENSE_RECEIPT
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_DESCRIPTION" ("ACS_DESCRIPTION_ID", "ACS_ACCOUNTING_ID", "ACS_SUB_SET_ID", "ACS_ACCOUNT_ID", "ACS_PICTURE_ID", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DES_DESCRIPTION_LARGE", "ACS_FINANCIAL_YEAR_ID", "ACS_PERIOD_ID", "ACS_PAYMENT_METHOD_ID", "ACS_VAT_DET_ACCOUNT_ID", "DES_TEXT", "ACS_BVR_REFERENCE_ID", "ACS_ACCOUNT_CATEG_ID") AS
  select ACS_DESCRIPTION_ID
       , Nvl(ACS_ACCOUNTING_ID, -2) ACS_ACCOUNTING_ID
       , Nvl(ACS_SUB_SET_ID, -2) ACS_SUB_SET_ID
       , Nvl(ACS_ACCOUNT_ID, -2) ACS_ACCOUNT_ID
       , Nvl(ACS_PICTURE_ID, -2) ACS_PICTURE_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(DES_DESCRIPTION_SUMMARY, '_') DES_DESCRIPTION_SUMMARY
       , Nvl(DES_DESCRIPTION_LARGE, '_') DES_DESCRIPTION_LARGE
       , Nvl(ACS_FINANCIAL_YEAR_ID, -2) ACS_FINANCIAL_YEAR_ID
       , Nvl(ACS_PERIOD_ID, -2) ACS_PERIOD_ID
       , Nvl(ACS_PAYMENT_METHOD_ID, -2) ACS_PAYMENT_METHOD_ID
       , Nvl(ACS_VAT_DET_ACCOUNT_ID, -2) ACS_VAT_DET_ACCOUNT_ID
       , Nvl(DES_TEXT, '_') DES_TEXT
       , Nvl(ACS_BVR_REFERENCE_ID, -2) ACS_BVR_REFERENCE_ID
       , Nvl(ACS_ACCOUNT_CATEG_ID, -2) ACS_ACCOUNT_CATEG_ID
  from ACS_DESCRIPTION
  union all
  select -1 ACS_DESCRIPTION_ID
       , -1 ACS_ACCOUNTING_ID
       , -1 ACS_SUB_SET_ID
       , -1 ACS_ACCOUNT_ID
       , -1 ACS_PICTURE_ID
       , -1 PC_LANG_ID
       , 'N/A' DES_DESCRIPTION_SUMMARY
       , 'N/A' DES_DESCRIPTION_LARGE
       , -1 ACS_FINANCIAL_YEAR_ID
       , -1 ACS_PERIOD_ID
       , -1 ACS_PAYMENT_METHOD_ID
       , -1 ACS_VAT_DET_ACCOUNT_ID
       , 'N/A' DES_TEXT
       , -1 ACS_BVR_REFERENCE_ID
       , -1 ACS_ACCOUNT_CATEG_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_DIVISION_ACCOUNT" ("ACS_DIVISION_ACCOUNT_ID", "DIC_DIV_ACC_CODE_1_ID", "DIC_DIV_ACC_CODE_2_ID", "DIC_DIV_ACC_CODE_3_ID", "DIC_DIV_ACC_CODE_4_ID", "DIC_DIV_ACC_CODE_5_ID", "DIC_DIV_ACC_CODE_6_ID", "DIC_DIV_ACC_CODE_7_ID", "DIC_DIV_ACC_CODE_8_ID", "DIC_DIV_ACC_CODE_9_ID", "DIC_DIV_ACC_CODE_10_ID", "DIV_DEFAULT_ACCOUNT") AS
  select ACS_DIVISION_ACCOUNT_ID
       , Nvl(DIC_DIV_ACC_CODE_1_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_1_ID
       , Nvl(DIC_DIV_ACC_CODE_2_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_2_ID
       , Nvl(DIC_DIV_ACC_CODE_3_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_3_ID
       , Nvl(DIC_DIV_ACC_CODE_4_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_4_ID
       , Nvl(DIC_DIV_ACC_CODE_5_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_5_ID
       , Nvl(DIC_DIV_ACC_CODE_6_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_6_ID
       , Nvl(DIC_DIV_ACC_CODE_7_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_7_ID
       , Nvl(DIC_DIV_ACC_CODE_8_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_8_ID
       , Nvl(DIC_DIV_ACC_CODE_9_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_9_ID
       , Nvl(DIC_DIV_ACC_CODE_10_ID, 'DWH_ISNULL') DIC_DIV_ACC_CODE_10_ID
       , Nvl2(DIV_DEFAULT_ACCOUNT, case
                when(DIV_DEFAULT_ACCOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DIV_DEFAULT_ACCOUNT
  from ACS_DIVISION_ACCOUNT
  union all
  select -1 ACS_DIVISION_ACCOUNT_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_1_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_2_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_3_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_4_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_5_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_6_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_7_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_8_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_9_ID
       , 'DWH_NA' DIC_DIV_ACC_CODE_10_ID
       , '-1' DIV_DEFAULT_ACCOUNT
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_FINANCIAL_ACCOUNT" ("ACS_FINANCIAL_ACCOUNT_ID", "C_BALANCE_SHEET_PROFIT_LOSS", "C_DEBIT_CREDIT", "FIN_COLLECTIVE", "FIN_ETAB_ACCOUNT", "FIN_VAT_POSSIBLE", "PC_BANK_ID", "ACS_LIMIT_CURR_ID", "DIC_FIN_ACC_CODE_2_ID", "DIC_FIN_ACC_CODE_1_ID", "DIC_FIN_ACC_CODE_3_ID", "DIC_FIN_ACC_CODE_5_ID", "DIC_FIN_ACC_CODE_4_ID", "DIC_FIN_ACC_CODE_6_ID", "DIC_FIN_ACC_CODE_7_ID", "DIC_FIN_ACC_CODE_8_ID", "DIC_FIN_ACC_CODE_9_ID", "DIC_FIN_ACC_CODE_10_ID", "DIC_TYPE_LIMIT_ID", "FIN_CREDIT_LIMIT", "FIN_EXPIRATION_LIMIT", "ACS_DEF_VAT_CODE_ID", "ACS_CPN_ACCOUNT_ID", "FIN_ACCOUNT_CONTROL", "FIN_LIQUIDITY", "C_MOVEMENT_FILE_TYPE", "FIN_IBAN_FORMAT", "FIN_BIC_NUMBER", "FIN_MOVEMENT_FILE", "C_BALANCE_DISPLAY", "FIN_PORTFOLIO", "DIC_TYPE_VAT_GOOD_ID", "C_DAS2_BREAKDOWN") AS
  select ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(C_BALANCE_SHEET_PROFIT_LOSS, 'DWH_ISNULL') C_BALANCE_SHEET_PROFIT_LOSS
       , Nvl(C_DEBIT_CREDIT, 'DWH_ISNULL') C_DEBIT_CREDIT
       , Nvl2(FIN_COLLECTIVE, case
                when(FIN_COLLECTIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_COLLECTIVE
       , Nvl(FIN_ETAB_ACCOUNT, '_') FIN_ETAB_ACCOUNT
       , Nvl2(FIN_VAT_POSSIBLE, case
                when(FIN_VAT_POSSIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_VAT_POSSIBLE
       , Nvl(PC_BANK_ID, -2) PC_BANK_ID
       , Nvl(ACS_LIMIT_CURR_ID, -2) ACS_LIMIT_CURR_ID
       , Nvl(DIC_FIN_ACC_CODE_2_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_2_ID
       , Nvl(DIC_FIN_ACC_CODE_1_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_1_ID
       , Nvl(DIC_FIN_ACC_CODE_3_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_3_ID
       , Nvl(DIC_FIN_ACC_CODE_5_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_5_ID
       , Nvl(DIC_FIN_ACC_CODE_4_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_4_ID
       , Nvl(DIC_FIN_ACC_CODE_6_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_6_ID
       , Nvl(DIC_FIN_ACC_CODE_7_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_7_ID
       , Nvl(DIC_FIN_ACC_CODE_8_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_8_ID
       , Nvl(DIC_FIN_ACC_CODE_9_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_9_ID
       , Nvl(DIC_FIN_ACC_CODE_10_ID, 'DWH_ISNULL') DIC_FIN_ACC_CODE_10_ID
       , Nvl(DIC_TYPE_LIMIT_ID, 'DWH_ISNULL') DIC_TYPE_LIMIT_ID
       , FIN_CREDIT_LIMIT
       , Nvl(FIN_EXPIRATION_LIMIT, to_date('40000101', 'YYYYMMDD') ) FIN_EXPIRATION_LIMIT
       , Nvl(ACS_DEF_VAT_CODE_ID, -2) ACS_DEF_VAT_CODE_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(FIN_ACCOUNT_CONTROL, '_') FIN_ACCOUNT_CONTROL
       , Nvl2(FIN_LIQUIDITY, case
                when(FIN_LIQUIDITY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_LIQUIDITY
       , Nvl(C_MOVEMENT_FILE_TYPE, 'DWH_ISNULL') C_MOVEMENT_FILE_TYPE
       , Nvl2(FIN_IBAN_FORMAT, case
                when(FIN_IBAN_FORMAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_IBAN_FORMAT
       , Nvl(FIN_BIC_NUMBER, '_') FIN_BIC_NUMBER
       , Nvl(FIN_MOVEMENT_FILE, '_') FIN_MOVEMENT_FILE
       , Nvl(C_BALANCE_DISPLAY, 'DWH_ISNULL') C_BALANCE_DISPLAY
       , Nvl2(FIN_PORTFOLIO, case
                when(FIN_PORTFOLIO = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_PORTFOLIO
       , Nvl(DIC_TYPE_VAT_GOOD_ID, 'DWH_ISNULL') DIC_TYPE_VAT_GOOD_ID
       , Nvl(C_DAS2_BREAKDOWN, 'DWH_ISNULL') C_DAS2_BREAKDOWN
  from ACS_FINANCIAL_ACCOUNT
  union all
  select -1 ACS_FINANCIAL_ACCOUNT_ID
       , 'DWH_NA' C_BALANCE_SHEET_PROFIT_LOSS
       , 'DWH_NA' C_DEBIT_CREDIT
       , '-1' FIN_COLLECTIVE
       , 'N/A' FIN_ETAB_ACCOUNT
       , '-1' FIN_VAT_POSSIBLE
       , -1 PC_BANK_ID
       , -1 ACS_LIMIT_CURR_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_2_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_1_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_3_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_5_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_4_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_6_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_7_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_8_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_9_ID
       , 'DWH_NA' DIC_FIN_ACC_CODE_10_ID
       , 'DWH_NA' DIC_TYPE_LIMIT_ID
       , null FIN_CREDIT_LIMIT
       , to_date('00010101', 'YYYYMMDD') FIN_EXPIRATION_LIMIT
       , -1 ACS_DEF_VAT_CODE_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , 'N/A' FIN_ACCOUNT_CONTROL
       , '-1' FIN_LIQUIDITY
       , 'DWH_NA' C_MOVEMENT_FILE_TYPE
       , '-1' FIN_IBAN_FORMAT
       , 'N/A' FIN_BIC_NUMBER
       , 'N/A' FIN_MOVEMENT_FILE
       , 'DWH_NA' C_BALANCE_DISPLAY
       , '-1' FIN_PORTFOLIO
       , 'DWH_NA' DIC_TYPE_VAT_GOOD_ID
       , 'DWH_NA' C_DAS2_BREAKDOWN
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_FINANCIAL_CURRENCY" ("ACS_FINANCIAL_CURRENCY_ID", "PC_CURR_ID", "ACS_LOSS_EXCH_EFFECT_ID", "ACS_GAIN_EXCH_EFFECT_ID", "ACS_LOSS_EXCH_COMP_ID", "ACS_GAIN_EXCH_COMP_ID", "FIN_LOCAL_CURRENCY", "FIN_HRM_CURRENCY", "FIN_BASE_PRICE", "FIN_ROUNDED_AMOUNT", "C_ROUND_TYPE", "C_PRICE_METHOD", "ACS_PJ_COMP_LOSS_ID", "ACS_PJ_EFF_GAIN_ID", "ACS_PJ_COMP_GAIN_ID", "ACS_PF_EFF_GAIN_ID", "ACS_PF_COMP_LOSS_ID", "ACS_PF_COMP_GAIN_ID", "ACS_CDA_EFF_LOSS_ID", "ACS_CDA_EFF_GAIN_ID", "ACS_CDA_COMP_LOSS_ID", "ACS_PJ_EFF_LOSS_ID", "ACS_PF_EFF_LOSS_ID", "ACS_CDA_COMP_GAIN_ID", "FIN_EURO_FROM", "FIN_EURO_RATE", "ACS_PAY_EFF_GAIN_ID", "ACS_PAY_EFF_LOSS_ID", "ACS_PAY_PJ_EFF_LOSS_ID", "ACS_PAY_PJ_EFF_GAIN_ID", "ACS_PAY_PF_EFF_LOSS_ID", "ACS_PAY_PF_EFF_GAIN_ID", "ACS_PAY_CDA_EFF_LOSS_ID", "ACS_PAY_CDA_EFF_GAIN_ID", "C_ROUND_TYPE_DOC", "FIN_ROUNDED_AMOUNT_DOC", "ACS_GAIN_EXCH_DEBT_ID", "ACS_LOSS_EXCH_DEBT_ID", "ACS_PJ_LOSS_EXCH_DEBT_ID", "ACS_PJ_GAIN_EXCH_DEBT_ID", "ACS_PF_GAIN_EXCH_DEBT_ID", "ACS_PF_LOSS_EXCH_DEBT_ID", "ACS_CDA_GAIN_EXCH_DEBT_ID", "ACS_CDA_LOSS_EXCH_DEBT_ID", "FIN_VALID_TO") AS
  select ACS_FINANCIAL_CURRENCY_ID
       , Nvl(PC_CURR_ID, -2) PC_CURR_ID
       , Nvl(ACS_LOSS_EXCH_EFFECT_ID, -2) ACS_LOSS_EXCH_EFFECT_ID
       , Nvl(ACS_GAIN_EXCH_EFFECT_ID, -2) ACS_GAIN_EXCH_EFFECT_ID
       , Nvl(ACS_LOSS_EXCH_COMP_ID, -2) ACS_LOSS_EXCH_COMP_ID
       , Nvl(ACS_GAIN_EXCH_COMP_ID, -2) ACS_GAIN_EXCH_COMP_ID
       , Nvl2(FIN_LOCAL_CURRENCY, case
                when(FIN_LOCAL_CURRENCY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_LOCAL_CURRENCY
       , Nvl2(FIN_HRM_CURRENCY, case
                when(FIN_HRM_CURRENCY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FIN_HRM_CURRENCY
       , FIN_BASE_PRICE
       , FIN_ROUNDED_AMOUNT
       , Nvl(C_ROUND_TYPE, 'DWH_ISNULL') C_ROUND_TYPE
       , Nvl(C_PRICE_METHOD, 'DWH_ISNULL') C_PRICE_METHOD
       , Nvl(ACS_PJ_COMP_LOSS_ID, -2) ACS_PJ_COMP_LOSS_ID
       , Nvl(ACS_PJ_EFF_GAIN_ID, -2) ACS_PJ_EFF_GAIN_ID
       , Nvl(ACS_PJ_COMP_GAIN_ID, -2) ACS_PJ_COMP_GAIN_ID
       , Nvl(ACS_PF_EFF_GAIN_ID, -2) ACS_PF_EFF_GAIN_ID
       , Nvl(ACS_PF_COMP_LOSS_ID, -2) ACS_PF_COMP_LOSS_ID
       , Nvl(ACS_PF_COMP_GAIN_ID, -2) ACS_PF_COMP_GAIN_ID
       , Nvl(ACS_CDA_EFF_LOSS_ID, -2) ACS_CDA_EFF_LOSS_ID
       , Nvl(ACS_CDA_EFF_GAIN_ID, -2) ACS_CDA_EFF_GAIN_ID
       , Nvl(ACS_CDA_COMP_LOSS_ID, -2) ACS_CDA_COMP_LOSS_ID
       , Nvl(ACS_PJ_EFF_LOSS_ID, -2) ACS_PJ_EFF_LOSS_ID
       , Nvl(ACS_PF_EFF_LOSS_ID, -2) ACS_PF_EFF_LOSS_ID
       , Nvl(ACS_CDA_COMP_GAIN_ID, -2) ACS_CDA_COMP_GAIN_ID
       , Nvl(FIN_EURO_FROM, to_date('40000101', 'YYYYMMDD') ) FIN_EURO_FROM
       , FIN_EURO_RATE
       , Nvl(ACS_PAY_EFF_GAIN_ID, -2) ACS_PAY_EFF_GAIN_ID
       , Nvl(ACS_PAY_EFF_LOSS_ID, -2) ACS_PAY_EFF_LOSS_ID
       , Nvl(ACS_PAY_PJ_EFF_LOSS_ID, -2) ACS_PAY_PJ_EFF_LOSS_ID
       , Nvl(ACS_PAY_PJ_EFF_GAIN_ID, -2) ACS_PAY_PJ_EFF_GAIN_ID
       , Nvl(ACS_PAY_PF_EFF_LOSS_ID, -2) ACS_PAY_PF_EFF_LOSS_ID
       , Nvl(ACS_PAY_PF_EFF_GAIN_ID, -2) ACS_PAY_PF_EFF_GAIN_ID
       , Nvl(ACS_PAY_CDA_EFF_LOSS_ID, -2) ACS_PAY_CDA_EFF_LOSS_ID
       , Nvl(ACS_PAY_CDA_EFF_GAIN_ID, -2) ACS_PAY_CDA_EFF_GAIN_ID
       , Nvl(C_ROUND_TYPE_DOC, 'DWH_ISNULL') C_ROUND_TYPE_DOC
       , FIN_ROUNDED_AMOUNT_DOC
       , Nvl(ACS_GAIN_EXCH_DEBT_ID, -2) ACS_GAIN_EXCH_DEBT_ID
       , Nvl(ACS_LOSS_EXCH_DEBT_ID, -2) ACS_LOSS_EXCH_DEBT_ID
       , Nvl(ACS_PJ_LOSS_EXCH_DEBT_ID, -2) ACS_PJ_LOSS_EXCH_DEBT_ID
       , Nvl(ACS_PJ_GAIN_EXCH_DEBT_ID, -2) ACS_PJ_GAIN_EXCH_DEBT_ID
       , Nvl(ACS_PF_GAIN_EXCH_DEBT_ID, -2) ACS_PF_GAIN_EXCH_DEBT_ID
       , Nvl(ACS_PF_LOSS_EXCH_DEBT_ID, -2) ACS_PF_LOSS_EXCH_DEBT_ID
       , Nvl(ACS_CDA_GAIN_EXCH_DEBT_ID, -2) ACS_CDA_GAIN_EXCH_DEBT_ID
       , Nvl(ACS_CDA_LOSS_EXCH_DEBT_ID, -2) ACS_CDA_LOSS_EXCH_DEBT_ID
       , Nvl(FIN_VALID_TO, to_date('40000101', 'YYYYMMDD') ) FIN_VALID_TO
  from ACS_FINANCIAL_CURRENCY
  union all
  select -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 PC_CURR_ID
       , -1 ACS_LOSS_EXCH_EFFECT_ID
       , -1 ACS_GAIN_EXCH_EFFECT_ID
       , -1 ACS_LOSS_EXCH_COMP_ID
       , -1 ACS_GAIN_EXCH_COMP_ID
       , '-1' FIN_LOCAL_CURRENCY
       , '-1' FIN_HRM_CURRENCY
       , null FIN_BASE_PRICE
       , null FIN_ROUNDED_AMOUNT
       , 'DWH_NA' C_ROUND_TYPE
       , 'DWH_NA' C_PRICE_METHOD
       , -1 ACS_PJ_COMP_LOSS_ID
       , -1 ACS_PJ_EFF_GAIN_ID
       , -1 ACS_PJ_COMP_GAIN_ID
       , -1 ACS_PF_EFF_GAIN_ID
       , -1 ACS_PF_COMP_LOSS_ID
       , -1 ACS_PF_COMP_GAIN_ID
       , -1 ACS_CDA_EFF_LOSS_ID
       , -1 ACS_CDA_EFF_GAIN_ID
       , -1 ACS_CDA_COMP_LOSS_ID
       , -1 ACS_PJ_EFF_LOSS_ID
       , -1 ACS_PF_EFF_LOSS_ID
       , -1 ACS_CDA_COMP_GAIN_ID
       , to_date('00010101', 'YYYYMMDD') FIN_EURO_FROM
       , null FIN_EURO_RATE
       , -1 ACS_PAY_EFF_GAIN_ID
       , -1 ACS_PAY_EFF_LOSS_ID
       , -1 ACS_PAY_PJ_EFF_LOSS_ID
       , -1 ACS_PAY_PJ_EFF_GAIN_ID
       , -1 ACS_PAY_PF_EFF_LOSS_ID
       , -1 ACS_PAY_PF_EFF_GAIN_ID
       , -1 ACS_PAY_CDA_EFF_LOSS_ID
       , -1 ACS_PAY_CDA_EFF_GAIN_ID
       , 'DWH_NA' C_ROUND_TYPE_DOC
       , null FIN_ROUNDED_AMOUNT_DOC
       , -1 ACS_GAIN_EXCH_DEBT_ID
       , -1 ACS_LOSS_EXCH_DEBT_ID
       , -1 ACS_PJ_LOSS_EXCH_DEBT_ID
       , -1 ACS_PJ_GAIN_EXCH_DEBT_ID
       , -1 ACS_PF_GAIN_EXCH_DEBT_ID
       , -1 ACS_PF_LOSS_EXCH_DEBT_ID
       , -1 ACS_CDA_GAIN_EXCH_DEBT_ID
       , -1 ACS_CDA_LOSS_EXCH_DEBT_ID
       , to_date('00010101', 'YYYYMMDD') FIN_VALID_TO
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_FINANCIAL_YEAR" ("ACS_FINANCIAL_YEAR_ID", "C_STATE_FINANCIAL_YEAR", "FYE_NO_EXERCICE", "FYE_START_DATE", "FYE_END_DATE", "FYE_PLAN_REFERENCE") AS
  select ACS_FINANCIAL_YEAR_ID
       , Nvl(C_STATE_FINANCIAL_YEAR, 'DWH_ISNULL') C_STATE_FINANCIAL_YEAR
       , FYE_NO_EXERCICE
       , Nvl(FYE_START_DATE, to_date('40000101', 'YYYYMMDD') ) FYE_START_DATE
       , Nvl(FYE_END_DATE, to_date('40000101', 'YYYYMMDD') ) FYE_END_DATE
       , Nvl2(FYE_PLAN_REFERENCE, case
                when(FYE_PLAN_REFERENCE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FYE_PLAN_REFERENCE
  from ACS_FINANCIAL_YEAR
  union all
  select -1 ACS_FINANCIAL_YEAR_ID
       , 'DWH_NA' C_STATE_FINANCIAL_YEAR
       , null FYE_NO_EXERCICE
       , to_date('00010101', 'YYYYMMDD') FYE_START_DATE
       , to_date('00010101', 'YYYYMMDD') FYE_END_DATE
       , '-1' FYE_PLAN_REFERENCE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_PERIOD" ("ACS_PERIOD_ID", "ACS_FINANCIAL_YEAR_ID", "PER_NO_PERIOD", "C_STATE_PERIOD", "C_TYPE_PERIOD", "PER_START_DATE", "PER_END_DATE") AS
  select ACS_PERIOD_ID
       , Nvl(ACS_FINANCIAL_YEAR_ID, -2) ACS_FINANCIAL_YEAR_ID
       , PER_NO_PERIOD
       , Nvl(C_STATE_PERIOD, 'DWH_ISNULL') C_STATE_PERIOD
       , Nvl(C_TYPE_PERIOD, 'DWH_ISNULL') C_TYPE_PERIOD
       , Nvl(PER_START_DATE, to_date('40000101', 'YYYYMMDD') ) PER_START_DATE
       , Nvl(PER_END_DATE, to_date('40000101', 'YYYYMMDD') ) PER_END_DATE
  from ACS_PERIOD
  union all
  select -1 ACS_PERIOD_ID
       , -1 ACS_FINANCIAL_YEAR_ID
       , null PER_NO_PERIOD
       , 'DWH_NA' C_STATE_PERIOD
       , 'DWH_NA' C_TYPE_PERIOD
       , to_date('00010101', 'YYYYMMDD') PER_START_DATE
       , to_date('00010101', 'YYYYMMDD') PER_END_DATE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_PF_ACCOUNT" ("ACS_PF_ACCOUNT_ID", "HRM_EMPLOYEE_ID", "DIC_PF_FREECODE1_ID", "DIC_PF_FREECODE2_ID", "DIC_PF_FREECODE3_ID", "DIC_PF_FREECODE4_ID", "DIC_PF_FREECODE5_ID", "DIC_PF_FREECODE6_ID", "DIC_PF_FREECODE7_ID", "DIC_PF_FREECODE8_ID", "DIC_PF_FREECODE9_ID", "DIC_PF_FREECODE10_ID", "MGM_RATE1", "MGM_RATE2", "MGM_RATE3", "MGM_RATE4", "MGM_RATE5", "MGM_RATE6", "MGM_RATE7", "MGM_RATE8", "MGM_RATE9", "MGM_RATE10", "MGM_AMOUNT1", "MGM_AMOUNT2", "MGM_AMOUNT3", "MGM_AMOUNT4", "MGM_AMOUNT5", "MGM_AMOUNT6", "MGM_AMOUNT7", "MGM_AMOUNT8", "MGM_AMOUNT9", "MGM_AMOUNT10") AS
  select ACS_PF_ACCOUNT_ID
       , Nvl(HRM_EMPLOYEE_ID, -2) HRM_EMPLOYEE_ID
       , Nvl(DIC_PF_FREECODE1_ID, 'DWH_ISNULL') DIC_PF_FREECODE1_ID
       , Nvl(DIC_PF_FREECODE2_ID, 'DWH_ISNULL') DIC_PF_FREECODE2_ID
       , Nvl(DIC_PF_FREECODE3_ID, 'DWH_ISNULL') DIC_PF_FREECODE3_ID
       , Nvl(DIC_PF_FREECODE4_ID, 'DWH_ISNULL') DIC_PF_FREECODE4_ID
       , Nvl(DIC_PF_FREECODE5_ID, 'DWH_ISNULL') DIC_PF_FREECODE5_ID
       , Nvl(DIC_PF_FREECODE6_ID, 'DWH_ISNULL') DIC_PF_FREECODE6_ID
       , Nvl(DIC_PF_FREECODE7_ID, 'DWH_ISNULL') DIC_PF_FREECODE7_ID
       , Nvl(DIC_PF_FREECODE8_ID, 'DWH_ISNULL') DIC_PF_FREECODE8_ID
       , Nvl(DIC_PF_FREECODE9_ID, 'DWH_ISNULL') DIC_PF_FREECODE9_ID
       , Nvl(DIC_PF_FREECODE10_ID, 'DWH_ISNULL') DIC_PF_FREECODE10_ID
       , MGM_RATE1
       , MGM_RATE2
       , MGM_RATE3
       , MGM_RATE4
       , MGM_RATE5
       , MGM_RATE6
       , MGM_RATE7
       , MGM_RATE8
       , MGM_RATE9
       , MGM_RATE10
       , MGM_AMOUNT1
       , MGM_AMOUNT2
       , MGM_AMOUNT3
       , MGM_AMOUNT4
       , MGM_AMOUNT5
       , MGM_AMOUNT6
       , MGM_AMOUNT7
       , MGM_AMOUNT8
       , MGM_AMOUNT9
       , MGM_AMOUNT10
  from ACS_PF_ACCOUNT
  union all
  select -1 ACS_PF_ACCOUNT_ID
       , -1 HRM_EMPLOYEE_ID
       , 'DWH_NA' DIC_PF_FREECODE1_ID
       , 'DWH_NA' DIC_PF_FREECODE2_ID
       , 'DWH_NA' DIC_PF_FREECODE3_ID
       , 'DWH_NA' DIC_PF_FREECODE4_ID
       , 'DWH_NA' DIC_PF_FREECODE5_ID
       , 'DWH_NA' DIC_PF_FREECODE6_ID
       , 'DWH_NA' DIC_PF_FREECODE7_ID
       , 'DWH_NA' DIC_PF_FREECODE8_ID
       , 'DWH_NA' DIC_PF_FREECODE9_ID
       , 'DWH_NA' DIC_PF_FREECODE10_ID
       , null MGM_RATE1
       , null MGM_RATE2
       , null MGM_RATE3
       , null MGM_RATE4
       , null MGM_RATE5
       , null MGM_RATE6
       , null MGM_RATE7
       , null MGM_RATE8
       , null MGM_RATE9
       , null MGM_RATE10
       , null MGM_AMOUNT1
       , null MGM_AMOUNT2
       , null MGM_AMOUNT3
       , null MGM_AMOUNT4
       , null MGM_AMOUNT5
       , null MGM_AMOUNT6
       , null MGM_AMOUNT7
       , null MGM_AMOUNT8
       , null MGM_AMOUNT9
       , null MGM_AMOUNT10
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_PJ_ACCOUNT" ("ACS_PJ_ACCOUNT_ID", "HRM_EMPLOYEE_ID", "PAC_PERSON_ID", "DIC_PJ_FREECODE6_ID", "DIC_PJ_FREECODE7_ID", "DIC_PJ_FREECODE8_ID", "DIC_PJ_FREECODE9_ID", "DIC_PJ_FREECODE10_ID", "DIC_PJ_FREECODE1_ID", "DIC_PJ_FREECODE2_ID", "DIC_PJ_FREECODE3_ID", "DIC_PJ_FREECODE4_ID", "DIC_PJ_FREECODE5_ID", "MGM_RATE1", "MGM_RATE2", "MGM_RATE3", "MGM_RATE4", "MGM_RATE5", "MGM_RATE6", "MGM_RATE7", "MGM_RATE8", "MGM_RATE9", "MGM_RATE10", "MGM_AMOUNT1", "MGM_AMOUNT2", "MGM_AMOUNT3", "MGM_AMOUNT4", "MGM_AMOUNT5", "MGM_AMOUNT6", "MGM_AMOUNT7", "MGM_AMOUNT8", "MGM_AMOUNT9", "MGM_AMOUNT10", "MGM_TRANSFER") AS
  select ACS_PJ_ACCOUNT_ID
       , Nvl(HRM_EMPLOYEE_ID, -2) HRM_EMPLOYEE_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(DIC_PJ_FREECODE6_ID, 'DWH_ISNULL') DIC_PJ_FREECODE6_ID
       , Nvl(DIC_PJ_FREECODE7_ID, 'DWH_ISNULL') DIC_PJ_FREECODE7_ID
       , Nvl(DIC_PJ_FREECODE8_ID, 'DWH_ISNULL') DIC_PJ_FREECODE8_ID
       , Nvl(DIC_PJ_FREECODE9_ID, 'DWH_ISNULL') DIC_PJ_FREECODE9_ID
       , Nvl(DIC_PJ_FREECODE10_ID, 'DWH_ISNULL') DIC_PJ_FREECODE10_ID
       , Nvl(DIC_PJ_FREECODE1_ID, 'DWH_ISNULL') DIC_PJ_FREECODE1_ID
       , Nvl(DIC_PJ_FREECODE2_ID, 'DWH_ISNULL') DIC_PJ_FREECODE2_ID
       , Nvl(DIC_PJ_FREECODE3_ID, 'DWH_ISNULL') DIC_PJ_FREECODE3_ID
       , Nvl(DIC_PJ_FREECODE4_ID, 'DWH_ISNULL') DIC_PJ_FREECODE4_ID
       , Nvl(DIC_PJ_FREECODE5_ID, 'DWH_ISNULL') DIC_PJ_FREECODE5_ID
       , MGM_RATE1
       , MGM_RATE2
       , MGM_RATE3
       , MGM_RATE4
       , MGM_RATE5
       , MGM_RATE6
       , MGM_RATE7
       , MGM_RATE8
       , MGM_RATE9
       , MGM_RATE10
       , MGM_AMOUNT1
       , MGM_AMOUNT2
       , MGM_AMOUNT3
       , MGM_AMOUNT4
       , MGM_AMOUNT5
       , MGM_AMOUNT6
       , MGM_AMOUNT7
       , MGM_AMOUNT8
       , MGM_AMOUNT9
       , MGM_AMOUNT10
       , Nvl2(MGM_TRANSFER, case
                when(MGM_TRANSFER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MGM_TRANSFER
  from ACS_PJ_ACCOUNT
  union all
  select -1 ACS_PJ_ACCOUNT_ID
       , -1 HRM_EMPLOYEE_ID
       , -1 PAC_PERSON_ID
       , 'DWH_NA' DIC_PJ_FREECODE6_ID
       , 'DWH_NA' DIC_PJ_FREECODE7_ID
       , 'DWH_NA' DIC_PJ_FREECODE8_ID
       , 'DWH_NA' DIC_PJ_FREECODE9_ID
       , 'DWH_NA' DIC_PJ_FREECODE10_ID
       , 'DWH_NA' DIC_PJ_FREECODE1_ID
       , 'DWH_NA' DIC_PJ_FREECODE2_ID
       , 'DWH_NA' DIC_PJ_FREECODE3_ID
       , 'DWH_NA' DIC_PJ_FREECODE4_ID
       , 'DWH_NA' DIC_PJ_FREECODE5_ID
       , null MGM_RATE1
       , null MGM_RATE2
       , null MGM_RATE3
       , null MGM_RATE4
       , null MGM_RATE5
       , null MGM_RATE6
       , null MGM_RATE7
       , null MGM_RATE8
       , null MGM_RATE9
       , null MGM_RATE10
       , null MGM_AMOUNT1
       , null MGM_AMOUNT2
       , null MGM_AMOUNT3
       , null MGM_AMOUNT4
       , null MGM_AMOUNT5
       , null MGM_AMOUNT6
       , null MGM_AMOUNT7
       , null MGM_AMOUNT8
       , null MGM_AMOUNT9
       , null MGM_AMOUNT10
       , '-1' MGM_TRANSFER
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACS_SYNONYM_DATA" ("ACS_SYNONYM_DATA_ID", "ACS_ALTERNATIVE_ID", "ACS_ACCOUNT_ID", "ACS_FINANCIAL_YEAR_ID", "SYN_NUMBER") AS
  select ACS_SYNONYM_DATA_ID
       , Nvl(ACS_ALTERNATIVE_ID, -2) ACS_ALTERNATIVE_ID
       , Nvl(ACS_ACCOUNT_ID, -2) ACS_ACCOUNT_ID
       , Nvl(ACS_FINANCIAL_YEAR_ID, -2) ACS_FINANCIAL_YEAR_ID
       , Nvl(SYN_NUMBER, '_') SYN_NUMBER
  from ACS_SYNONYM_DATA
  union all
  select -1 ACS_SYNONYM_DATA_ID
       , -1 ACS_ALTERNATIVE_ID
       , -1 ACS_ACCOUNT_ID
       , -1 ACS_FINANCIAL_YEAR_ID
       , 'N/A' SYN_NUMBER
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACT_DOCUMENT" ("ACT_DOCUMENT_ID", "ACT_JOB_ID", "PC_USER_ID", "DOC_NUMBER", "DOC_TOTAL_AMOUNT_DC", "DOC_DOCUMENT_DATE", "ACS_FINANCIAL_CURRENCY_ID", "ACJ_CATALOGUE_DOCUMENT_ID", "ACT_JOURNAL_ID", "ACT_ACT_JOURNAL_ID", "ACS_FINANCIAL_ACCOUNT_ID", "DOC_CHARGES_LC", "ACS_FINANCIAL_YEAR_ID", "DOC_COMMENT", "DOC_CCP_TAX", "DOC_ORDER_NO", "DOC_EFFECTIVE_DATE", "DOC_EXECUTIVE_DATE", "DOC_ESTABL_DATE", "C_STATUS_DOCUMENT", "COM_OLE_ID", "DIC_DOC_SOURCE_ID", "DIC_DOC_DESTINATION_ID", "ACS_FIN_ACC_S_PAYMENT_ID", "DOC_ACCOUNT_ID", "DOC_TOTAL_AMOUNT_EUR", "DOC_OK", "DOC_PRE_ENTRY_EXPIRY", "DOC_PRE_ENTRY_VALIDATION", "DOC_PRE_ENTRY_INI", "ACT_COVER_INFORMATION_ID", "DOC_DOCUMENT_ID", "STM_STOCK_MOVEMENT_ID", "DOC_PRE_ENTRY_NUMBER", "ACT_DOCUMENT_EXT_ID", "COM_NAME_DOC", "COM_NAME_ACT", "DIC_ACT_DOC_FREE_CODE1_ID", "DIC_ACT_DOC_FREE_CODE2_ID", "DIC_ACT_DOC_FREE_CODE3_ID", "DIC_ACT_DOC_FREE_CODE4_ID", "DIC_ACT_DOC_FREE_CODE5_ID", "DOC_FREE_TEXT1", "DOC_FREE_TEXT2", "DOC_FREE_TEXT3", "DOC_FREE_TEXT4", "DOC_FREE_TEXT5", "DOC_FREE_NUMBER1", "DOC_FREE_NUMBER2", "DOC_FREE_NUMBER3", "DOC_FREE_NUMBER4", "DOC_FREE_NUMBER5", "DOC_FREE_DATE1", "DOC_FREE_DATE2", "DOC_FREE_DATE3", "DOC_FREE_DATE4", "DOC_FREE_DATE5", "DOC_FREE_MEMO1", "DOC_FREE_MEMO2", "DOC_FREE_MEMO3", "DOC_FREE_MEMO4", "DOC_FREE_MEMO5", "PC_EXCHANGE_DATA_IN_ID") AS
  select ACT_DOCUMENT_ID
       , Nvl(ACT_JOB_ID, -2) ACT_JOB_ID
       , Nvl(PC_USER_ID, -2) PC_USER_ID
       , Nvl(DOC_NUMBER, '_') DOC_NUMBER
       , DOC_TOTAL_AMOUNT_DC
       , Nvl(DOC_DOCUMENT_DATE, to_date('40000101', 'YYYYMMDD') ) DOC_DOCUMENT_DATE
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACJ_CATALOGUE_DOCUMENT_ID, -2) ACJ_CATALOGUE_DOCUMENT_ID
       , Nvl(ACT_JOURNAL_ID, -2) ACT_JOURNAL_ID
       , Nvl(ACT_ACT_JOURNAL_ID, -2) ACT_ACT_JOURNAL_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , DOC_CHARGES_LC
       , Nvl(ACS_FINANCIAL_YEAR_ID, -2) ACS_FINANCIAL_YEAR_ID
       , Nvl(DOC_COMMENT, '_') DOC_COMMENT
       , Nvl(DOC_CCP_TAX, '_') DOC_CCP_TAX
       , DOC_ORDER_NO
       , Nvl(DOC_EFFECTIVE_DATE, to_date('40000101', 'YYYYMMDD') ) DOC_EFFECTIVE_DATE
       , Nvl(DOC_EXECUTIVE_DATE, to_date('40000101', 'YYYYMMDD') ) DOC_EXECUTIVE_DATE
       , Nvl(DOC_ESTABL_DATE, to_date('40000101', 'YYYYMMDD') ) DOC_ESTABL_DATE
       , Nvl(C_STATUS_DOCUMENT, 'DWH_ISNULL') C_STATUS_DOCUMENT
       , Nvl(COM_OLE_ID, -2) COM_OLE_ID
       , Nvl(DIC_DOC_SOURCE_ID, 'DWH_ISNULL') DIC_DOC_SOURCE_ID
       , Nvl(DIC_DOC_DESTINATION_ID, 'DWH_ISNULL') DIC_DOC_DESTINATION_ID
       , Nvl(ACS_FIN_ACC_S_PAYMENT_ID, -2) ACS_FIN_ACC_S_PAYMENT_ID
       , Nvl(DOC_ACCOUNT_ID, -2) DOC_ACCOUNT_ID
       , DOC_TOTAL_AMOUNT_EUR
       , Nvl2(DOC_OK, case
                when(DOC_OK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DOC_OK
       , Nvl(DOC_PRE_ENTRY_EXPIRY, to_date('40000101', 'YYYYMMDD') ) DOC_PRE_ENTRY_EXPIRY
       , Nvl(DOC_PRE_ENTRY_VALIDATION, to_date('40000101', 'YYYYMMDD') ) DOC_PRE_ENTRY_VALIDATION
       , Nvl(DOC_PRE_ENTRY_INI, '_') DOC_PRE_ENTRY_INI
       , Nvl(ACT_COVER_INFORMATION_ID, -2) ACT_COVER_INFORMATION_ID
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , Nvl(STM_STOCK_MOVEMENT_ID, -2) STM_STOCK_MOVEMENT_ID
       , Nvl(DOC_PRE_ENTRY_NUMBER, '_') DOC_PRE_ENTRY_NUMBER
       , Nvl(ACT_DOCUMENT_EXT_ID, -2) ACT_DOCUMENT_EXT_ID
       , Nvl(COM_NAME_DOC, '_') COM_NAME_DOC
       , Nvl(COM_NAME_ACT, '_') COM_NAME_ACT
       , Nvl(DIC_ACT_DOC_FREE_CODE1_ID, 'DWH_ISNULL') DIC_ACT_DOC_FREE_CODE1_ID
       , Nvl(DIC_ACT_DOC_FREE_CODE2_ID, 'DWH_ISNULL') DIC_ACT_DOC_FREE_CODE2_ID
       , Nvl(DIC_ACT_DOC_FREE_CODE3_ID, 'DWH_ISNULL') DIC_ACT_DOC_FREE_CODE3_ID
       , Nvl(DIC_ACT_DOC_FREE_CODE4_ID, 'DWH_ISNULL') DIC_ACT_DOC_FREE_CODE4_ID
       , Nvl(DIC_ACT_DOC_FREE_CODE5_ID, 'DWH_ISNULL') DIC_ACT_DOC_FREE_CODE5_ID
       , Nvl(DOC_FREE_TEXT1, '_') DOC_FREE_TEXT1
       , Nvl(DOC_FREE_TEXT2, '_') DOC_FREE_TEXT2
       , Nvl(DOC_FREE_TEXT3, '_') DOC_FREE_TEXT3
       , Nvl(DOC_FREE_TEXT4, '_') DOC_FREE_TEXT4
       , Nvl(DOC_FREE_TEXT5, '_') DOC_FREE_TEXT5
       , DOC_FREE_NUMBER1
       , DOC_FREE_NUMBER2
       , DOC_FREE_NUMBER3
       , DOC_FREE_NUMBER4
       , DOC_FREE_NUMBER5
       , Nvl(DOC_FREE_DATE1, to_date('40000101', 'YYYYMMDD') ) DOC_FREE_DATE1
       , Nvl(DOC_FREE_DATE2, to_date('40000101', 'YYYYMMDD') ) DOC_FREE_DATE2
       , Nvl(DOC_FREE_DATE3, to_date('40000101', 'YYYYMMDD') ) DOC_FREE_DATE3
       , Nvl(DOC_FREE_DATE4, to_date('40000101', 'YYYYMMDD') ) DOC_FREE_DATE4
       , Nvl(DOC_FREE_DATE5, to_date('40000101', 'YYYYMMDD') ) DOC_FREE_DATE5
       , Nvl(DOC_FREE_MEMO1, '_') DOC_FREE_MEMO1
       , Nvl(DOC_FREE_MEMO2, '_') DOC_FREE_MEMO2
       , Nvl(DOC_FREE_MEMO3, '_') DOC_FREE_MEMO3
       , Nvl(DOC_FREE_MEMO4, '_') DOC_FREE_MEMO4
       , Nvl(DOC_FREE_MEMO5, '_') DOC_FREE_MEMO5
       -- DOC_XML_INFO cannot be used with CLOB
       , Nvl(PC_EXCHANGE_DATA_IN_ID, -2) PC_EXCHANGE_DATA_IN_ID
  from ACT_DOCUMENT
  union all
  select -1 ACT_DOCUMENT_ID
       , -1 ACT_JOB_ID
       , -1 PC_USER_ID
       , 'N/A' DOC_NUMBER
       , null DOC_TOTAL_AMOUNT_DC
       , to_date('00010101', 'YYYYMMDD') DOC_DOCUMENT_DATE
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACJ_CATALOGUE_DOCUMENT_ID
       , -1 ACT_JOURNAL_ID
       , -1 ACT_ACT_JOURNAL_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , null DOC_CHARGES_LC
       , -1 ACS_FINANCIAL_YEAR_ID
       , 'N/A' DOC_COMMENT
       , 'N/A' DOC_CCP_TAX
       , null DOC_ORDER_NO
       , to_date('00010101', 'YYYYMMDD') DOC_EFFECTIVE_DATE
       , to_date('00010101', 'YYYYMMDD') DOC_EXECUTIVE_DATE
       , to_date('00010101', 'YYYYMMDD') DOC_ESTABL_DATE
       , 'DWH_NA' C_STATUS_DOCUMENT
       , -1 COM_OLE_ID
       , 'DWH_NA' DIC_DOC_SOURCE_ID
       , 'DWH_NA' DIC_DOC_DESTINATION_ID
       , -1 ACS_FIN_ACC_S_PAYMENT_ID
       , -1 DOC_ACCOUNT_ID
       , null DOC_TOTAL_AMOUNT_EUR
       , '-1' DOC_OK
       , to_date('00010101', 'YYYYMMDD') DOC_PRE_ENTRY_EXPIRY
       , to_date('00010101', 'YYYYMMDD') DOC_PRE_ENTRY_VALIDATION
       , 'N/A' DOC_PRE_ENTRY_INI
       , -1 ACT_COVER_INFORMATION_ID
       , -1 DOC_DOCUMENT_ID
       , -1 STM_STOCK_MOVEMENT_ID
       , 'N/A' DOC_PRE_ENTRY_NUMBER
       , -1 ACT_DOCUMENT_EXT_ID
       , 'N/A' COM_NAME_DOC
       , 'N/A' COM_NAME_ACT
       , 'DWH_NA' DIC_ACT_DOC_FREE_CODE1_ID
       , 'DWH_NA' DIC_ACT_DOC_FREE_CODE2_ID
       , 'DWH_NA' DIC_ACT_DOC_FREE_CODE3_ID
       , 'DWH_NA' DIC_ACT_DOC_FREE_CODE4_ID
       , 'DWH_NA' DIC_ACT_DOC_FREE_CODE5_ID
       , 'N/A' DOC_FREE_TEXT1
       , 'N/A' DOC_FREE_TEXT2
       , 'N/A' DOC_FREE_TEXT3
       , 'N/A' DOC_FREE_TEXT4
       , 'N/A' DOC_FREE_TEXT5
       , null DOC_FREE_NUMBER1
       , null DOC_FREE_NUMBER2
       , null DOC_FREE_NUMBER3
       , null DOC_FREE_NUMBER4
       , null DOC_FREE_NUMBER5
       , to_date('00010101', 'YYYYMMDD') DOC_FREE_DATE1
       , to_date('00010101', 'YYYYMMDD') DOC_FREE_DATE2
       , to_date('00010101', 'YYYYMMDD') DOC_FREE_DATE3
       , to_date('00010101', 'YYYYMMDD') DOC_FREE_DATE4
       , to_date('00010101', 'YYYYMMDD') DOC_FREE_DATE5
       , 'N/A' DOC_FREE_MEMO1
       , 'N/A' DOC_FREE_MEMO2
       , 'N/A' DOC_FREE_MEMO3
       , 'N/A' DOC_FREE_MEMO4
       , 'N/A' DOC_FREE_MEMO5
       -- DOC_XML_INFO cannot be used with CLOB
       , -1 PC_EXCHANGE_DATA_IN_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACT_FINANCI_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_TYPE", "IMF_PRIMARY", "IMF_DESCRIPTION", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "IMF_NUMBER", "ACT_PART_IMPUTATION_ID", "IMF_NUMBER2", "IMF_TEXT1", "IMF_TEXT2", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_COMPARE_DATE", "IMF_CONTROL_DATE", "IMF_COMPARE_TEXT", "IMF_CONTROL_TEXT", "IMF_COMPARE_USE_INI", "IMF_CONTROL_USE_INI", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "DOC_RECORD_ID", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "FAM_FIXED_ASSETS_ID", "PAC_PERSON_ID", "C_FAM_TRANSACTION_TYP", "IMF_ACS_DIVISION_ACCOUNT_ID", "IMF_ACS_FINANCIAL_YEAR_ID", "IMF_PAC_SUPPLIER_PARTNER_ID", "IMF_ACS_AUX_ACCOUNT_SUPP_ID", "IMF_PAC_CUSTOM_PARTNER_ID", "IMF_ACS_AUX_ACCOUNT_CUST_ID", "IMF_CHARGES_SBVR", "IMF_CHARGES_SBVR_EUR") AS
  select ACT_FINANCIAL_IMPUTATION_ID
       , Nvl(ACS_PERIOD_ID, -2) ACS_PERIOD_ID
       , Nvl(ACT_DOCUMENT_ID, -2) ACT_DOCUMENT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(IMF_TYPE, '_') IMF_TYPE
       , Nvl2(IMF_PRIMARY, case
                when(IMF_PRIMARY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') IMF_PRIMARY
       , Nvl(IMF_DESCRIPTION, '_') IMF_DESCRIPTION
       , IMF_AMOUNT_LC_D
       , IMF_AMOUNT_LC_C
       , IMF_EXCHANGE_RATE
       , IMF_AMOUNT_FC_D
       , IMF_AMOUNT_FC_C
       , Nvl(IMF_VALUE_DATE, to_date('40000101', 'YYYYMMDD') ) IMF_VALUE_DATE
       , Nvl(ACS_TAX_CODE_ID, -2) ACS_TAX_CODE_ID
       , Nvl(IMF_TRANSACTION_DATE, to_date('40000101', 'YYYYMMDD') ) IMF_TRANSACTION_DATE
       , Nvl(ACS_AUXILIARY_ACCOUNT_ID, -2) ACS_AUXILIARY_ACCOUNT_ID
       , Nvl(ACT_DET_PAYMENT_ID, -2) ACT_DET_PAYMENT_ID
       , Nvl(IMF_GENRE, '_') IMF_GENRE
       , IMF_BASE_PRICE
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_ACS_FINANCIAL_CURRENCY_ID, -2) ACS_ACS_FINANCIAL_CURRENCY_ID
       , Nvl(C_GENRE_TRANSACTION, 'DWH_ISNULL') C_GENRE_TRANSACTION
       , IMF_NUMBER
       , Nvl(ACT_PART_IMPUTATION_ID, -2) ACT_PART_IMPUTATION_ID
       , IMF_NUMBER2
       , Nvl(IMF_TEXT1, '_') IMF_TEXT1
       , Nvl(IMF_TEXT2, '_') IMF_TEXT2
       , IMF_AMOUNT_EUR_D
       , IMF_AMOUNT_EUR_C
       , Nvl(IMF_COMPARE_DATE, to_date('40000101', 'YYYYMMDD') ) IMF_COMPARE_DATE
       , Nvl(IMF_CONTROL_DATE, to_date('40000101', 'YYYYMMDD') ) IMF_CONTROL_DATE
       , Nvl(IMF_COMPARE_TEXT, '_') IMF_COMPARE_TEXT
       , Nvl(IMF_CONTROL_TEXT, '_') IMF_CONTROL_TEXT
       , Nvl(IMF_COMPARE_USE_INI, '_') IMF_COMPARE_USE_INI
       , Nvl(IMF_CONTROL_USE_INI, '_') IMF_CONTROL_USE_INI
       , Nvl(IMF_TEXT3, '_') IMF_TEXT3
       , Nvl(IMF_TEXT4, '_') IMF_TEXT4
       , Nvl(IMF_TEXT5, '_') IMF_TEXT5
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , IMF_NUMBER3
       , IMF_NUMBER4
       , IMF_NUMBER5
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(IMF_ACS_DIVISION_ACCOUNT_ID, -2) IMF_ACS_DIVISION_ACCOUNT_ID
       , Nvl(IMF_ACS_FINANCIAL_YEAR_ID, -2) IMF_ACS_FINANCIAL_YEAR_ID
       , Nvl(IMF_PAC_SUPPLIER_PARTNER_ID, -2) IMF_PAC_SUPPLIER_PARTNER_ID
       , Nvl(IMF_ACS_AUX_ACCOUNT_SUPP_ID, -2) IMF_ACS_AUX_ACCOUNT_SUPP_ID
       , Nvl(IMF_PAC_CUSTOM_PARTNER_ID, -2) IMF_PAC_CUSTOM_PARTNER_ID
       , Nvl(IMF_ACS_AUX_ACCOUNT_CUST_ID, -2) IMF_ACS_AUX_ACCOUNT_CUST_ID
       , IMF_CHARGES_SBVR
       , IMF_CHARGES_SBVR_EUR
  from ACT_FINANCIAL_IMPUTATION
  union all
  select -1 ACT_FINANCIAL_IMPUTATION_ID
       , -1 ACS_PERIOD_ID
       , -1 ACT_DOCUMENT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , 'N/A' IMF_TYPE
       , '-1' IMF_PRIMARY
       , 'N/A' IMF_DESCRIPTION
       , null IMF_AMOUNT_LC_D
       , null IMF_AMOUNT_LC_C
       , null IMF_EXCHANGE_RATE
       , null IMF_AMOUNT_FC_D
       , null IMF_AMOUNT_FC_C
       , to_date('00010101', 'YYYYMMDD') IMF_VALUE_DATE
       , -1 ACS_TAX_CODE_ID
       , to_date('00010101', 'YYYYMMDD') IMF_TRANSACTION_DATE
       , -1 ACS_AUXILIARY_ACCOUNT_ID
       , -1 ACT_DET_PAYMENT_ID
       , 'N/A' IMF_GENRE
       , null IMF_BASE_PRICE
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_ACS_FINANCIAL_CURRENCY_ID
       , 'DWH_NA' C_GENRE_TRANSACTION
       , null IMF_NUMBER
       , -1 ACT_PART_IMPUTATION_ID
       , null IMF_NUMBER2
       , 'N/A' IMF_TEXT1
       , 'N/A' IMF_TEXT2
       , null IMF_AMOUNT_EUR_D
       , null IMF_AMOUNT_EUR_C
       , to_date('00010101', 'YYYYMMDD') IMF_COMPARE_DATE
       , to_date('00010101', 'YYYYMMDD') IMF_CONTROL_DATE
       , 'N/A' IMF_COMPARE_TEXT
       , 'N/A' IMF_CONTROL_TEXT
       , 'N/A' IMF_COMPARE_USE_INI
       , 'N/A' IMF_CONTROL_USE_INI
       , 'N/A' IMF_TEXT3
       , 'N/A' IMF_TEXT4
       , 'N/A' IMF_TEXT5
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , -1 GCO_GOOD_ID
       , -1 HRM_PERSON_ID
       , -1 DOC_RECORD_ID
       , null IMF_NUMBER3
       , null IMF_NUMBER4
       , null IMF_NUMBER5
       , -1 FAM_FIXED_ASSETS_ID
       , -1 PAC_PERSON_ID
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , -1 IMF_ACS_DIVISION_ACCOUNT_ID
       , -1 IMF_ACS_FINANCIAL_YEAR_ID
       , -1 IMF_PAC_SUPPLIER_PARTNER_ID
       , -1 IMF_ACS_AUX_ACCOUNT_SUPP_ID
       , -1 IMF_PAC_CUSTOM_PARTNER_ID
       , -1 IMF_ACS_AUX_ACCOUNT_CUST_ID
       , null IMF_CHARGES_SBVR
       , null IMF_CHARGES_SBVR_EUR
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACT_MGM_DISTRIBUTION" ("ACT_MGM_DISTRIBUTION_ID", "ACT_MGM_IMPUTATION_ID", "ACS_PJ_ACCOUNT_ID", "ACS_SUB_SET_ID", "MGM_DESCRIPTION", "MGM_AMOUNT_LC_D", "MGM_AMOUNT_FC_D", "MGM_AMOUNT_LC_C", "MGM_AMOUNT_FC_C", "MGM_QUANTITY_D", "MGM_QUANTITY_C", "MGM_AMOUNT_EUR_D", "MGM_AMOUNT_EUR_C", "MGM_NUMBER", "MGM_NUMBER2", "MGM_TEXT1", "MGM_TEXT2", "MGM_TEXT3", "MGM_TEXT4", "MGM_TEXT5", "MGM_NUMBER3", "MGM_NUMBER4", "MGM_NUMBER5") AS
  select ACT_MGM_DISTRIBUTION_ID
       , Nvl(ACT_MGM_IMPUTATION_ID, -2) ACT_MGM_IMPUTATION_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_SUB_SET_ID, -2) ACS_SUB_SET_ID
       , Nvl(MGM_DESCRIPTION, '_') MGM_DESCRIPTION
       , MGM_AMOUNT_LC_D
       , MGM_AMOUNT_FC_D
       , MGM_AMOUNT_LC_C
       , MGM_AMOUNT_FC_C
       , MGM_QUANTITY_D
       , MGM_QUANTITY_C
       , MGM_AMOUNT_EUR_D
       , MGM_AMOUNT_EUR_C
       , MGM_NUMBER
       , MGM_NUMBER2
       , Nvl(MGM_TEXT1, '_') MGM_TEXT1
       , Nvl(MGM_TEXT2, '_') MGM_TEXT2
       , Nvl(MGM_TEXT3, '_') MGM_TEXT3
       , Nvl(MGM_TEXT4, '_') MGM_TEXT4
       , Nvl(MGM_TEXT5, '_') MGM_TEXT5
       , MGM_NUMBER3
       , MGM_NUMBER4
       , MGM_NUMBER5
  from ACT_MGM_DISTRIBUTION
  union all
  select -1 ACT_MGM_DISTRIBUTION_ID
       , -1 ACT_MGM_IMPUTATION_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_SUB_SET_ID
       , 'N/A' MGM_DESCRIPTION
       , null MGM_AMOUNT_LC_D
       , null MGM_AMOUNT_FC_D
       , null MGM_AMOUNT_LC_C
       , null MGM_AMOUNT_FC_C
       , null MGM_QUANTITY_D
       , null MGM_QUANTITY_C
       , null MGM_AMOUNT_EUR_D
       , null MGM_AMOUNT_EUR_C
       , null MGM_NUMBER
       , null MGM_NUMBER2
       , 'N/A' MGM_TEXT1
       , 'N/A' MGM_TEXT2
       , 'N/A' MGM_TEXT3
       , 'N/A' MGM_TEXT4
       , 'N/A' MGM_TEXT5
       , null MGM_NUMBER3
       , null MGM_NUMBER4
       , null MGM_NUMBER5
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACT_MGM_IMPUTATION" ("ACT_MGM_IMPUTATION_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_PERIOD_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACT_DOCUMENT_ID", "ACT_FINANCIAL_IMPUTATION_ID", "IMM_TYPE", "IMM_GENRE", "IMM_PRIMARY", "IMM_DESCRIPTION", "IMM_AMOUNT_LC_D", "IMM_AMOUNT_LC_C", "IMM_EXCHANGE_RATE", "IMM_BASE_PRICE", "IMM_AMOUNT_FC_D", "IMM_AMOUNT_FC_C", "IMM_VALUE_DATE", "IMM_TRANSACTION_DATE", "ACS_QTY_UNIT_ID", "IMM_QUANTITY_D", "IMM_QUANTITY_C", "IMM_AMOUNT_EUR_D", "IMM_AMOUNT_EUR_C", "IMM_NUMBER", "IMM_NUMBER2", "IMM_TEXT1", "IMM_TEXT2", "IMM_TEXT3", "IMM_TEXT4", "IMM_TEXT5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "HRM_PERSON_ID", "GCO_GOOD_ID", "DOC_RECORD_ID", "IMM_NUMBER3", "IMM_NUMBER4", "IMM_NUMBER5", "FAM_FIXED_ASSETS_ID", "PAC_PERSON_ID", "C_FAM_TRANSACTION_TYP") AS
  select ACT_MGM_IMPUTATION_ID
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_ACS_FINANCIAL_CURRENCY_ID, -2) ACS_ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_PERIOD_ID, -2) ACS_PERIOD_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACT_DOCUMENT_ID, -2) ACT_DOCUMENT_ID
       , Nvl(ACT_FINANCIAL_IMPUTATION_ID, -2) ACT_FINANCIAL_IMPUTATION_ID
       , Nvl(IMM_TYPE, '_') IMM_TYPE
       , Nvl(IMM_GENRE, '_') IMM_GENRE
       , Nvl2(IMM_PRIMARY, case
                when(IMM_PRIMARY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') IMM_PRIMARY
       , Nvl(IMM_DESCRIPTION, '_') IMM_DESCRIPTION
       , IMM_AMOUNT_LC_D
       , IMM_AMOUNT_LC_C
       , IMM_EXCHANGE_RATE
       , IMM_BASE_PRICE
       , IMM_AMOUNT_FC_D
       , IMM_AMOUNT_FC_C
       , Nvl(IMM_VALUE_DATE, to_date('40000101', 'YYYYMMDD') ) IMM_VALUE_DATE
       , Nvl(IMM_TRANSACTION_DATE, to_date('40000101', 'YYYYMMDD') ) IMM_TRANSACTION_DATE
       , Nvl(ACS_QTY_UNIT_ID, -2) ACS_QTY_UNIT_ID
       , IMM_QUANTITY_D
       , IMM_QUANTITY_C
       , IMM_AMOUNT_EUR_D
       , IMM_AMOUNT_EUR_C
       , IMM_NUMBER
       , IMM_NUMBER2
       , Nvl(IMM_TEXT1, '_') IMM_TEXT1
       , Nvl(IMM_TEXT2, '_') IMM_TEXT2
       , Nvl(IMM_TEXT3, '_') IMM_TEXT3
       , Nvl(IMM_TEXT4, '_') IMM_TEXT4
       , Nvl(IMM_TEXT5, '_') IMM_TEXT5
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , IMM_NUMBER3
       , IMM_NUMBER4
       , IMM_NUMBER5
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
  from ACT_MGM_IMPUTATION
  union all
  select -1 ACT_MGM_IMPUTATION_ID
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_PERIOD_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACT_DOCUMENT_ID
       , -1 ACT_FINANCIAL_IMPUTATION_ID
       , 'N/A' IMM_TYPE
       , 'N/A' IMM_GENRE
       , '-1' IMM_PRIMARY
       , 'N/A' IMM_DESCRIPTION
       , null IMM_AMOUNT_LC_D
       , null IMM_AMOUNT_LC_C
       , null IMM_EXCHANGE_RATE
       , null IMM_BASE_PRICE
       , null IMM_AMOUNT_FC_D
       , null IMM_AMOUNT_FC_C
       , to_date('00010101', 'YYYYMMDD') IMM_VALUE_DATE
       , to_date('00010101', 'YYYYMMDD') IMM_TRANSACTION_DATE
       , -1 ACS_QTY_UNIT_ID
       , null IMM_QUANTITY_D
       , null IMM_QUANTITY_C
       , null IMM_AMOUNT_EUR_D
       , null IMM_AMOUNT_EUR_C
       , null IMM_NUMBER
       , null IMM_NUMBER2
       , 'N/A' IMM_TEXT1
       , 'N/A' IMM_TEXT2
       , 'N/A' IMM_TEXT3
       , 'N/A' IMM_TEXT4
       , 'N/A' IMM_TEXT5
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , -1 HRM_PERSON_ID
       , -1 GCO_GOOD_ID
       , -1 DOC_RECORD_ID
       , null IMM_NUMBER3
       , null IMM_NUMBER4
       , null IMM_NUMBER5
       , -1 FAM_FIXED_ASSETS_ID
       , -1 PAC_PERSON_ID
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACT_MGM_TOT_BY_PERIOD" ("ACT_MGM_TOT_BY_PERIOD_ID", "ACS_PERIOD_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "C_TYPE_CUMUL", "MTO_DEBIT_LC", "MTO_CREDIT_LC", "MTO_DEBIT_FC", "MTO_CREDIT_FC", "ACS_QTY_UNIT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "MTO_QUANTITY_D", "MTO_QUANTITY_C", "MTO_DEBIT_EUR", "MTO_CREDIT_EUR", "DOC_RECORD_ID", "ACS_DIVISION_ACCOUNT_ID") AS
  select ACT_MGM_TOT_BY_PERIOD_ID
       , Nvl(ACS_PERIOD_ID, -2) ACS_PERIOD_ID
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_ACS_FINANCIAL_CURRENCY_ID, -2) ACS_ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(C_TYPE_CUMUL, 'DWH_ISNULL') C_TYPE_CUMUL
       , MTO_DEBIT_LC
       , MTO_CREDIT_LC
       , MTO_DEBIT_FC
       , MTO_CREDIT_FC
       , Nvl(ACS_QTY_UNIT_ID, -2) ACS_QTY_UNIT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , MTO_QUANTITY_D
       , MTO_QUANTITY_C
       , MTO_DEBIT_EUR
       , MTO_CREDIT_EUR
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
  from ACT_MGM_TOT_BY_PERIOD
  union all
  select -1 ACT_MGM_TOT_BY_PERIOD_ID
       , -1 ACS_PERIOD_ID
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , 'DWH_NA' C_TYPE_CUMUL
       , null MTO_DEBIT_LC
       , null MTO_CREDIT_LC
       , null MTO_DEBIT_FC
       , null MTO_CREDIT_FC
       , -1 ACS_QTY_UNIT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , null MTO_QUANTITY_D
       , null MTO_QUANTITY_C
       , null MTO_DEBIT_EUR
       , null MTO_CREDIT_EUR
       , -1 DOC_RECORD_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ACT_TOTAL_BY_PERIOD" ("ACT_TOTAL_BY_PERIOD_ID", "ACS_PERIOD_ID", "TOT_DEBIT_LC", "TOT_CREDIT_LC", "TOT_DEBIT_FC", "TOT_CREDIT_FC", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACS_ACS_AUXILIARY_ACCOUNT_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "C_TYPE_PERIOD", "C_TYPE_CUMUL", "ACS_DIVISION_ACCOUNT_ID", "TOT_DEBIT_EUR", "TOT_CREDIT_EUR") AS
  select ACT_TOTAL_BY_PERIOD_ID
       , Nvl(ACS_PERIOD_ID, -2) ACS_PERIOD_ID
       , TOT_DEBIT_LC
       , TOT_CREDIT_LC
       , TOT_DEBIT_FC
       , TOT_CREDIT_FC
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_AUXILIARY_ACCOUNT_ID, -2) ACS_AUXILIARY_ACCOUNT_ID
       , Nvl(ACS_ACS_AUXILIARY_ACCOUNT_ID, -2) ACS_ACS_AUXILIARY_ACCOUNT_ID
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_ACS_FINANCIAL_CURRENCY_ID, -2) ACS_ACS_FINANCIAL_CURRENCY_ID
       , Nvl(C_TYPE_PERIOD, 'DWH_ISNULL') C_TYPE_PERIOD
       , Nvl(C_TYPE_CUMUL, 'DWH_ISNULL') C_TYPE_CUMUL
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , TOT_DEBIT_EUR
       , TOT_CREDIT_EUR
  from ACT_TOTAL_BY_PERIOD
  union all
  select -1 ACT_TOTAL_BY_PERIOD_ID
       , -1 ACS_PERIOD_ID
       , null TOT_DEBIT_LC
       , null TOT_CREDIT_LC
       , null TOT_DEBIT_FC
       , null TOT_CREDIT_FC
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_AUXILIARY_ACCOUNT_ID
       , -1 ACS_ACS_AUXILIARY_ACCOUNT_ID
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_ACS_FINANCIAL_CURRENCY_ID
       , 'DWH_NA' C_TYPE_PERIOD
       , 'DWH_NA' C_TYPE_CUMUL
       , -1 ACS_DIVISION_ACCOUNT_ID
       , null TOT_DEBIT_EUR
       , null TOT_CREDIT_EUR
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ASA_FREE_DATA" ("ASA_FREE_DATA_ID", "ASA_REP_TYPE_ID", "ASA_RECORD_ID", "ARD_ALPHA_SHORT_1", "ARD_ALPHA_SHORT_2", "ARD_ALPHA_SHORT_3", "ARD_ALPHA_SHORT_4", "ARD_ALPHA_SHORT_5", "ARD_ALPHA_LONG_1", "ARD_ALPHA_LONG_2", "ARD_ALPHA_LONG_3", "ARD_ALPHA_LONG_4", "ARD_ALPHA_LONG_5", "ARD_INTEGER_1", "ARD_INTEGER_2", "ARD_INTEGER_3", "ARD_INTEGER_4", "ARD_INTEGER_5", "ARD_DECIMAL_1", "ARD_DECIMAL_2", "ARD_DECIMAL_3", "ARD_DECIMAL_4", "ARD_DECIMAL_5", "ARD_BOOLEAN_1", "ARD_BOOLEAN_2", "ARD_BOOLEAN_3", "ARD_BOOLEAN_4", "ARD_BOOLEAN_5", "DIC_ASA_REC_FREE5_ID", "DIC_ASA_REC_FREE4_ID", "DIC_ASA_REC_FREE3_ID", "DIC_ASA_REC_FREE2_ID", "DIC_ASA_REC_FREE1_ID") AS
  select ASA_FREE_DATA_ID
       , nvl(ASA_REP_TYPE_ID, -2) ASA_REP_TYPE_ID
       , nvl(ASA_RECORD_ID, -2) ASA_RECORD_ID
       , nvl(ARD_ALPHA_SHORT_1, '_') ARD_ALPHA_SHORT_1
       , nvl(ARD_ALPHA_SHORT_2, '_') ARD_ALPHA_SHORT_2
       , nvl(ARD_ALPHA_SHORT_3, '_') ARD_ALPHA_SHORT_3
       , nvl(ARD_ALPHA_SHORT_4, '_') ARD_ALPHA_SHORT_4
       , nvl(ARD_ALPHA_SHORT_5, '_') ARD_ALPHA_SHORT_5
       , nvl(ARD_ALPHA_LONG_1, '_') ARD_ALPHA_LONG_1
       , nvl(ARD_ALPHA_LONG_2, '_') ARD_ALPHA_LONG_2
       , nvl(ARD_ALPHA_LONG_3, '_') ARD_ALPHA_LONG_3
       , nvl(ARD_ALPHA_LONG_4, '_') ARD_ALPHA_LONG_4
       , nvl(ARD_ALPHA_LONG_5, '_') ARD_ALPHA_LONG_5
       , ARD_INTEGER_1
       , ARD_INTEGER_2
       , ARD_INTEGER_3
       , ARD_INTEGER_4
       , ARD_INTEGER_5
       , ARD_DECIMAL_1
       , ARD_DECIMAL_2
       , ARD_DECIMAL_3
       , ARD_DECIMAL_4
       , ARD_DECIMAL_5
       , nvl2(ARD_BOOLEAN_1, case
                when(ARD_BOOLEAN_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARD_BOOLEAN_1
       , nvl2(ARD_BOOLEAN_2, case
                when(ARD_BOOLEAN_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARD_BOOLEAN_2
       , nvl2(ARD_BOOLEAN_3, case
                when(ARD_BOOLEAN_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARD_BOOLEAN_3
       , nvl2(ARD_BOOLEAN_4, case
                when(ARD_BOOLEAN_4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARD_BOOLEAN_4
       , nvl2(ARD_BOOLEAN_5, case
                when(ARD_BOOLEAN_5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARD_BOOLEAN_5
       , nvl(DIC_ASA_REC_FREE5_ID, 'DWH_ISNULL') DIC_ASA_REC_FREE5_ID
       , nvl(DIC_ASA_REC_FREE4_ID, 'DWH_ISNULL') DIC_ASA_REC_FREE4_ID
       , nvl(DIC_ASA_REC_FREE3_ID, 'DWH_ISNULL') DIC_ASA_REC_FREE3_ID
       , nvl(DIC_ASA_REC_FREE2_ID, 'DWH_ISNULL') DIC_ASA_REC_FREE2_ID
       , nvl(DIC_ASA_REC_FREE1_ID, 'DWH_ISNULL') DIC_ASA_REC_FREE1_ID
    from ASA_FREE_DATA
  union all
  select -1 ASA_FREE_DATA_ID
       , -1 ASA_REP_TYPE_ID
       , -1 ASA_RECORD_ID
       , 'N/A' ARD_ALPHA_SHORT_1
       , 'N/A' ARD_ALPHA_SHORT_2
       , 'N/A' ARD_ALPHA_SHORT_3
       , 'N/A' ARD_ALPHA_SHORT_4
       , 'N/A' ARD_ALPHA_SHORT_5
       , 'N/A' ARD_ALPHA_LONG_1
       , 'N/A' ARD_ALPHA_LONG_2
       , 'N/A' ARD_ALPHA_LONG_3
       , 'N/A' ARD_ALPHA_LONG_4
       , 'N/A' ARD_ALPHA_LONG_5
       , null ARD_INTEGER_1
       , null ARD_INTEGER_2
       , null ARD_INTEGER_3
       , null ARD_INTEGER_4
       , null ARD_INTEGER_5
       , null ARD_DECIMAL_1
       , null ARD_DECIMAL_2
       , null ARD_DECIMAL_3
       , null ARD_DECIMAL_4
       , null ARD_DECIMAL_5
       , '-1' ARD_BOOLEAN_1
       , '-1' ARD_BOOLEAN_2
       , '-1' ARD_BOOLEAN_3
       , '-1' ARD_BOOLEAN_4
       , '-1' ARD_BOOLEAN_5
       , 'DWH_NA' DIC_ASA_REC_FREE5_ID
       , 'DWH_NA' DIC_ASA_REC_FREE4_ID
       , 'DWH_NA' DIC_ASA_REC_FREE3_ID
       , 'DWH_NA' DIC_ASA_REC_FREE2_ID
       , 'DWH_NA' DIC_ASA_REC_FREE1_ID
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ASA_RECORD" ("ASA_RECORD_ID", "ARE_NUMBER", "ASA_REP_TYPE_ID", "DOC_GAUGE_ID", "C_ASA_REP_TYPE_KIND", "C_ASA_REP_STATUS", "ARE_DATECRE", "ARE_UPDATE_STATUS", "ARE_PRINT_STATUS", "DOC_RECORD_ID", "PAC_REPRESENTATIVE_ID", "ACS_FINANCIAL_CURRENCY_ID", "ARE_CURR_BASE_PRICE", "ARE_CURR_RATE_OF_EXCH", "ARE_CURR_RATE_EURO", "ARE_EURO_CURRENCY", "ARE_COST_PRICE_S", "ARE_COST_PRICE_W", "ARE_COST_PRICE_C", "ARE_COST_PRICE_T", "ARE_SALE_PRICE_S", "ARE_SALE_PRICE_W", "ARE_SALE_PRICE_C", "ARE_SALE_PRICE_T_MB", "ARE_SALE_PRICE_T_ME", "ARE_SALE_PRICE_T_EURO", "PAC_CUSTOM_PARTNER_ID", "PC_ASA_CUST_LANG_ID", "PAC_ASA_ADDR1_ID", "ARE_ADDRESS1", "ARE_POSTCODE1", "ARE_TOWN1", "ARE_STATE1", "ARE_FORMAT_CITY1", "PC_ASA_CNTRY1_ID", "PAC_ASA_ADDR2_ID", "ARE_ADDRESS2", "ARE_POSTCODE2", "ARE_TOWN2", "ARE_STATE2", "ARE_FORMAT_CITY2", "PC_ASA_CNTRY2_ID", "PAC_ASA_ADDR3_ID", "ARE_ADDRESS3", "ARE_POSTCODE3", "ARE_TOWN3", "ARE_STATE3", "ARE_FORMAT_CITY3", "PC_ASA_CNTRY3_ID", "PAC_ASA_FIN_CUST_ID", "PAC_ASA_FIN_CUST_ADDR_ID", "ARE_ADDRESS_FIN_CUST", "ARE_POSTCODE_FIN_CUST", "ARE_TOWN_FIN_CUST", "ARE_STATE_FIN_CUST", "ARE_FORMAT_CITY_FIN_CUST", "PC_ASA_FIN_CUST_CNTRY_ID", "PAC_SUPPLIER_PARTNER_ID", "ACS_ASA_SUP_FIN_CURR_ID", "PC_ASA_SUP_LANG_ID", "PAC_ASA_SUPPLIER_ADDR_ID", "ARE_ADDRESS_SUPPLIER", "ARE_POSTCODE_SUPPLIER", "ARE_TOWN_SUPPLIER", "ARE_STATE_SUPPLIER", "PC_ASA_SUPPLIER_CNTRY_ID", "ARE_FORMAT_CITY_SUPPLIER", "GCO_SUPPLIER_GOOD_ID", "GCO_ASA_TO_REPAIR_ID", "GCO_CHAR1_ID", "GCO_CHAR2_ID", "GCO_CHAR3_ID", "GCO_CHAR4_ID", "GCO_CHAR5_ID", "ARE_CHAR1_VALUE", "ARE_CHAR2_VALUE", "ARE_CHAR3_VALUE", "ARE_CHAR4_VALUE", "ARE_CHAR5_VALUE", "ARE_CUSTOMER_REF", "ARE_GOOD_REF_1", "ARE_GOOD_REF_2", "ARE_GOOD_REF_3", "ARE_GOOD_NEW_REF", "STM_ASA_DEFECT_LOC_ID", "STM_ASA_DEFECT_STK_ID", "ARE_SALE_DATE", "ARE_SALE_DATE_TEXT", "PC_ORIGIN_CNTRY_ID", "ARE_GUARANTY", "ARE_END_GUARANTY_DATE", "ARE_GUARANTY_CODE", "ARE_CUSTOMER_ERROR", "ARE_OFFERED_CODE", "ARE_GENERATE_BILL", "C_ASA_DEVIS_CODE", "ARE_MIN_DEVIS_MB", "ARE_MIN_DEVIS_ME", "ARE_MIN_DEVIS_EURO", "ARE_VAL_DEVIS_DATE", "GCO_ASA_EXCHANGE_ID", "GCO_EXCH_CHAR1_ID", "GCO_EXCH_CHAR2_ID", "GCO_EXCH_CHAR3_ID", "GCO_EXCH_CHAR4_ID", "GCO_EXCH_CHAR5_ID", "ARE_EXCH_CHAR1_VALUE", "ARE_EXCH_CHAR2_VALUE", "ARE_EXCH_CHAR3_VALUE", "ARE_EXCH_CHAR4_VALUE", "ARE_EXCH_CHAR5_VALUE", "STM_ASA_EXCH_LOC_ID", "STM_ASA_EXCH_STK_ID", "ASA_LAST_RECORD_ID", "DOC_ORIGIN_POSITION_ID", "ARE_NB_DAYS", "ARE_REQ_DATE_C", "ARE_CONF_DATE_C", "ARE_UPD_DATE_C", "ARE_REQ_DATE_S", "ARE_CONF_DATE_S", "ARE_UPD_DATE_S", "ARE_GCO_SHORT_DESCR", "ARE_GCO_LONG_DESCR", "ARE_GCO_FREE_DESCR", "ARE_GCO_SHORT_DESCR_EX", "ARE_GCO_LONG_DESCR_EX", "ARE_GCO_FREE_DESCR_EX", "PAC_SENDING_CONDITION_ID", "ARE_RECALC_SALE_PRICE_2", "ARE_RECALC_COST_PRICE_2", "ASA_RECORD_EVENTS_ID", "ARE_USE_COMP", "ARE_USE_TASK", "GCO_BILL_GOOD_ID", "ARE_LPOS_COMP_TASK", "STM_ASA_DEFECT_MVT_ID", "STM_ASA_EXCH_MVT_ID", "STM_REPAIR_MVT_KIND_ID", "ARE_REPAIR_QTY", "ARE_EXCH_QTY", "STM_EXCH_MVT_KIND_ID", "GCO_NEW_GOOD_ID", "GCO_NEW_CHAR1_ID", "GCO_NEW_CHAR2_ID", "GCO_NEW_CHAR3_ID", "GCO_NEW_CHAR4_ID", "GCO_NEW_CHAR5_ID", "ARE_NEW_CHAR1_VALUE", "ARE_NEW_CHAR2_VALUE", "ARE_NEW_CHAR3_VALUE", "ARE_NEW_CHAR4_VALUE", "ARE_NEW_CHAR5_VALUE", "ARE_BEGIN_GUARANTY_DATE", "C_ASA_GUARANTY_UNIT", "ASA_STOLEN_GOODS_ID", "ASA_GUARANTY_CARDS_ID", "ARE_REP_BEGIN_GUAR_DATE", "ARE_REP_GUAR", "C_ASA_REP_GUAR_UNIT", "ARE_REP_END_GUAR_DATE", "ARE_PRICE_DEVIS_MB", "ARE_PRICE_DEVIS_ME", "ARE_PRICE_DEVIS_EURO", "GCO_DEVIS_BILL_GOOD_ID", "ARE_FIN_SALE_DATE", "DIC_TARIFF_ID", "ARE_MIN_SALE_PRICE_MB", "ARE_MIN_SALE_PRICE_ME", "ARE_MIN_SALE_PRICE_EURO", "ARE_MAX_SALE_PRICE_MB", "ARE_MAX_SALE_PRICE_ME", "ARE_MAX_SALE_PRICE_EURO", "DIC_GARANTY_CODE_ID", "DIC_TARIFF2_ID", "PAC_PAYMENT_CONDITION_ID", "ACS_FIN_ACC_S_PAYMENT_ID", "PAC_ASA_AGENT_ID", "PC_ASA_AGENT_LANG_ID", "PAC_ASA_AGENT_ADDR_ID", "ARE_ADDRESS_AGENT", "ARE_POSTCODE_AGENT", "ARE_TOWN_AGENT", "ARE_STATE_AGENT", "PC_ASA_AGENT_CNTRY_ID", "ARE_FORMAT_CITY_AGENT", "PAC_ASA_DISTRIB_ID", "PC_ASA_DISTRIB_LANG_ID", "PAC_ASA_DISTRIB_ADDR_ID", "ARE_ADDRESS_DISTRIB", "ARE_POSTCODE_DISTRIB", "ARE_TOWN_DISTRIB", "ARE_STATE_DISTRIB", "PC_ASA_DISTRIB_CNTRY_ID", "ARE_FORMAT_CITY_DISTRIB", "PC_ASA_FIN_CUST_LANG_ID", "ARE_DET_SALE_DATE", "ARE_DET_SALE_DATE_TEXT", "ARE_FIN_SALE_DATE_TEXT", "C_ASA_SELECT_PRICE", "ARE_DATE_REG_REP", "ARE_NB_DAYS_WAIT", "ARE_NB_DAYS_WAIT_COMP", "ARE_NB_DAYS_WAIT_MAX", "ARE_DATE_START_REP", "ARE_DATE_END_REP", "ARE_NB_DAYS_CTRL", "ARE_DATE_END_CTRL", "ARE_NB_DAYS_EXP", "ARE_DATE_START_EXP", "ARE_NB_DAYS_SENDING", "ARE_DATE_END_SENDING", "DIC_TYPE_SUBMISSION_ID", "DOC_ATTRIB_DOCUMENT_ID", "ARE_PIECE", "ARE_SET", "ARE_VERSION", "ARE_CHRONOLOGICAL", "ARE_STD_CHAR_1", "ARE_STD_CHAR_2", "ARE_STD_CHAR_3", "ARE_STD_CHAR_4", "ARE_STD_CHAR_5", "ARE_CARE_OF_AGENT", "ARE_PO_BOX_AGENT", "ARE_PO_BOX_NBR_AGENT", "ARE_COUNTY_AGENT", "ARE_CARE_OF_DET", "ARE_PO_BOX_DET", "ARE_PO_BOX_NBR_DET", "ARE_COUNTY_DET", "ARE_CARE_OF_CUST", "ARE_PO_BOX_CUST", "ARE_PO_BOX_NBR_CUST", "ARE_COUNTY_CUST", "ARE_CARE_OF1", "ARE_PO_BOX1", "ARE_PO_BOX_NBR1", "ARE_COUNTY1", "ARE_CARE_OF2", "ARE_PO_BOX2", "ARE_PO_BOX_NBR2", "ARE_COUNTY2", "ARE_CARE_OF3", "ARE_PO_BOX3", "ARE_PO_BOX_NBR3", "ARE_COUNTY3", "ARE_CARE_OF_SUP", "ARE_PO_BOX_SUP", "ARE_PO_BOX_NBR_SUP", "ARE_COUNTY_SUP", "ARE_PROTECTED", "PAC_THIRD_TARIFF_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_ACI_ID", "C_PRIORITY", "PAC_COMMUNICATION_ID", "DIC_RECEPTION_MODE_ID", "ARE_CONTACT1", "ARE_CONTACT2", "ARE_CONTACT3", "ARE_CONTACT_COMMENT", "ARE_INTERNAL_REMARK", "ARE_CUSTOMER_REMARK", "ARE_ADDITIONAL_ITEMS", "ARE_CUSTOMS_VALUE", "ACS_CUSTOM_FIN_CURR_ID", "ARE_REQ_DATE_TEXT") AS
  select ASA_RECORD_ID
       , nvl(ARE_NUMBER, '_') ARE_NUMBER
       , nvl(ASA_REP_TYPE_ID, -2) ASA_REP_TYPE_ID
       , nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , nvl(C_ASA_REP_TYPE_KIND, 'DWH_ISNULL') C_ASA_REP_TYPE_KIND
       , nvl(C_ASA_REP_STATUS, 'DWH_ISNULL') C_ASA_REP_STATUS
       , nvl(ARE_DATECRE, to_date('40000101', 'YYYYMMDD') ) ARE_DATECRE
       , nvl(ARE_UPDATE_STATUS, to_date('40000101', 'YYYYMMDD') ) ARE_UPDATE_STATUS
       , nvl(ARE_PRINT_STATUS, to_date('40000101', 'YYYYMMDD') ) ARE_PRINT_STATUS
       , nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , nvl(PAC_REPRESENTATIVE_ID, -2) PAC_REPRESENTATIVE_ID
       , nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , ARE_CURR_BASE_PRICE
       , ARE_CURR_RATE_OF_EXCH
       , ARE_CURR_RATE_EURO
       , nvl2(ARE_EURO_CURRENCY, case
                when(ARE_EURO_CURRENCY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_EURO_CURRENCY
       , ARE_COST_PRICE_S
       , ARE_COST_PRICE_W
       , ARE_COST_PRICE_C
       , ARE_COST_PRICE_T
       , ARE_SALE_PRICE_S
       , ARE_SALE_PRICE_W
       , ARE_SALE_PRICE_C
       , ARE_SALE_PRICE_T_MB
       , ARE_SALE_PRICE_T_ME
       , ARE_SALE_PRICE_T_EURO
       , nvl(PAC_CUSTOM_PARTNER_ID, -2) PAC_CUSTOM_PARTNER_ID
       , nvl(PC_ASA_CUST_LANG_ID, -2) PC_ASA_CUST_LANG_ID
       , nvl(PAC_ASA_ADDR1_ID, -2) PAC_ASA_ADDR1_ID
       , nvl(ARE_ADDRESS1, '_') ARE_ADDRESS1
       , nvl(ARE_POSTCODE1, '_') ARE_POSTCODE1
       , nvl(ARE_TOWN1, '_') ARE_TOWN1
       , nvl(ARE_STATE1, '_') ARE_STATE1
       , nvl(ARE_FORMAT_CITY1, '_') ARE_FORMAT_CITY1
       , nvl(PC_ASA_CNTRY1_ID, -2) PC_ASA_CNTRY1_ID
       , nvl(PAC_ASA_ADDR2_ID, -2) PAC_ASA_ADDR2_ID
       , nvl(ARE_ADDRESS2, '_') ARE_ADDRESS2
       , nvl(ARE_POSTCODE2, '_') ARE_POSTCODE2
       , nvl(ARE_TOWN2, '_') ARE_TOWN2
       , nvl(ARE_STATE2, '_') ARE_STATE2
       , nvl(ARE_FORMAT_CITY2, '_') ARE_FORMAT_CITY2
       , nvl(PC_ASA_CNTRY2_ID, -2) PC_ASA_CNTRY2_ID
       , nvl(PAC_ASA_ADDR3_ID, -2) PAC_ASA_ADDR3_ID
       , nvl(ARE_ADDRESS3, '_') ARE_ADDRESS3
       , nvl(ARE_POSTCODE3, '_') ARE_POSTCODE3
       , nvl(ARE_TOWN3, '_') ARE_TOWN3
       , nvl(ARE_STATE3, '_') ARE_STATE3
       , nvl(ARE_FORMAT_CITY3, '_') ARE_FORMAT_CITY3
       , nvl(PC_ASA_CNTRY3_ID, -2) PC_ASA_CNTRY3_ID
       , nvl(PAC_ASA_FIN_CUST_ID, -2) PAC_ASA_FIN_CUST_ID
       , nvl(PAC_ASA_FIN_CUST_ADDR_ID, -2) PAC_ASA_FIN_CUST_ADDR_ID
       , nvl(ARE_ADDRESS_FIN_CUST, '_') ARE_ADDRESS_FIN_CUST
       , nvl(ARE_POSTCODE_FIN_CUST, '_') ARE_POSTCODE_FIN_CUST
       , nvl(ARE_TOWN_FIN_CUST, '_') ARE_TOWN_FIN_CUST
       , nvl(ARE_STATE_FIN_CUST, '_') ARE_STATE_FIN_CUST
       , nvl(ARE_FORMAT_CITY_FIN_CUST, '_') ARE_FORMAT_CITY_FIN_CUST
       , nvl(PC_ASA_FIN_CUST_CNTRY_ID, -2) PC_ASA_FIN_CUST_CNTRY_ID
       , nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , nvl(ACS_ASA_SUP_FIN_CURR_ID, -2) ACS_ASA_SUP_FIN_CURR_ID
       , nvl(PC_ASA_SUP_LANG_ID, -2) PC_ASA_SUP_LANG_ID
       , nvl(PAC_ASA_SUPPLIER_ADDR_ID, -2) PAC_ASA_SUPPLIER_ADDR_ID
       , nvl(ARE_ADDRESS_SUPPLIER, '_') ARE_ADDRESS_SUPPLIER
       , nvl(ARE_POSTCODE_SUPPLIER, '_') ARE_POSTCODE_SUPPLIER
       , nvl(ARE_TOWN_SUPPLIER, '_') ARE_TOWN_SUPPLIER
       , nvl(ARE_STATE_SUPPLIER, '_') ARE_STATE_SUPPLIER
       , nvl(PC_ASA_SUPPLIER_CNTRY_ID, -2) PC_ASA_SUPPLIER_CNTRY_ID
       , nvl(ARE_FORMAT_CITY_SUPPLIER, '_') ARE_FORMAT_CITY_SUPPLIER
       , nvl(GCO_SUPPLIER_GOOD_ID, -2) GCO_SUPPLIER_GOOD_ID
       , nvl(GCO_ASA_TO_REPAIR_ID, -2) GCO_ASA_TO_REPAIR_ID
       , nvl(GCO_CHAR1_ID, -2) GCO_CHAR1_ID
       , nvl(GCO_CHAR2_ID, -2) GCO_CHAR2_ID
       , nvl(GCO_CHAR3_ID, -2) GCO_CHAR3_ID
       , nvl(GCO_CHAR4_ID, -2) GCO_CHAR4_ID
       , nvl(GCO_CHAR5_ID, -2) GCO_CHAR5_ID
       , nvl(ARE_CHAR1_VALUE, '_') ARE_CHAR1_VALUE
       , nvl(ARE_CHAR2_VALUE, '_') ARE_CHAR2_VALUE
       , nvl(ARE_CHAR3_VALUE, '_') ARE_CHAR3_VALUE
       , nvl(ARE_CHAR4_VALUE, '_') ARE_CHAR4_VALUE
       , nvl(ARE_CHAR5_VALUE, '_') ARE_CHAR5_VALUE
       , nvl(ARE_CUSTOMER_REF, '_') ARE_CUSTOMER_REF
       , nvl(ARE_GOOD_REF_1, '_') ARE_GOOD_REF_1
       , nvl(ARE_GOOD_REF_2, '_') ARE_GOOD_REF_2
       , nvl(ARE_GOOD_REF_3, '_') ARE_GOOD_REF_3
       , nvl(ARE_GOOD_NEW_REF, '_') ARE_GOOD_NEW_REF
       , nvl(STM_ASA_DEFECT_LOC_ID, -2) STM_ASA_DEFECT_LOC_ID
       , nvl(STM_ASA_DEFECT_STK_ID, -2) STM_ASA_DEFECT_STK_ID
       , nvl(ARE_SALE_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_SALE_DATE
       , nvl(ARE_SALE_DATE_TEXT, '_') ARE_SALE_DATE_TEXT
       , nvl(PC_ORIGIN_CNTRY_ID, -2) PC_ORIGIN_CNTRY_ID
       , ARE_GUARANTY
       , nvl(ARE_END_GUARANTY_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_END_GUARANTY_DATE
       , nvl2(ARE_GUARANTY_CODE, case
                when(ARE_GUARANTY_CODE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_GUARANTY_CODE
       , nvl2(ARE_CUSTOMER_ERROR, case
                when(ARE_CUSTOMER_ERROR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_CUSTOMER_ERROR
       , nvl2(ARE_OFFERED_CODE, case
                when(ARE_OFFERED_CODE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_OFFERED_CODE
       , nvl2(ARE_GENERATE_BILL, case
                when(ARE_GENERATE_BILL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_GENERATE_BILL
       , nvl(C_ASA_DEVIS_CODE, 'DWH_ISNULL') C_ASA_DEVIS_CODE
       , ARE_MIN_DEVIS_MB
       , ARE_MIN_DEVIS_ME
       , ARE_MIN_DEVIS_EURO
       , nvl(ARE_VAL_DEVIS_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_VAL_DEVIS_DATE
       , nvl(GCO_ASA_EXCHANGE_ID, -2) GCO_ASA_EXCHANGE_ID
       , nvl(GCO_EXCH_CHAR1_ID, -2) GCO_EXCH_CHAR1_ID
       , nvl(GCO_EXCH_CHAR2_ID, -2) GCO_EXCH_CHAR2_ID
       , nvl(GCO_EXCH_CHAR3_ID, -2) GCO_EXCH_CHAR3_ID
       , nvl(GCO_EXCH_CHAR4_ID, -2) GCO_EXCH_CHAR4_ID
       , nvl(GCO_EXCH_CHAR5_ID, -2) GCO_EXCH_CHAR5_ID
       , nvl(ARE_EXCH_CHAR1_VALUE, '_') ARE_EXCH_CHAR1_VALUE
       , nvl(ARE_EXCH_CHAR2_VALUE, '_') ARE_EXCH_CHAR2_VALUE
       , nvl(ARE_EXCH_CHAR3_VALUE, '_') ARE_EXCH_CHAR3_VALUE
       , nvl(ARE_EXCH_CHAR4_VALUE, '_') ARE_EXCH_CHAR4_VALUE
       , nvl(ARE_EXCH_CHAR5_VALUE, '_') ARE_EXCH_CHAR5_VALUE
       , nvl(STM_ASA_EXCH_LOC_ID, -2) STM_ASA_EXCH_LOC_ID
       , nvl(STM_ASA_EXCH_STK_ID, -2) STM_ASA_EXCH_STK_ID
       , nvl(ASA_LAST_RECORD_ID, -2) ASA_LAST_RECORD_ID
       , nvl(DOC_ORIGIN_POSITION_ID, -2) DOC_ORIGIN_POSITION_ID
       , ARE_NB_DAYS
       , nvl(ARE_REQ_DATE_C, to_date('40000101', 'YYYYMMDD') ) ARE_REQ_DATE_C
       , nvl(ARE_CONF_DATE_C, to_date('40000101', 'YYYYMMDD') ) ARE_CONF_DATE_C
       , nvl(ARE_UPD_DATE_C, to_date('40000101', 'YYYYMMDD') ) ARE_UPD_DATE_C
       , nvl(ARE_REQ_DATE_S, to_date('40000101', 'YYYYMMDD') ) ARE_REQ_DATE_S
       , nvl(ARE_CONF_DATE_S, to_date('40000101', 'YYYYMMDD') ) ARE_CONF_DATE_S
       , nvl(ARE_UPD_DATE_S, to_date('40000101', 'YYYYMMDD') ) ARE_UPD_DATE_S
       , nvl(ARE_GCO_SHORT_DESCR, '_') ARE_GCO_SHORT_DESCR
       , nvl(ARE_GCO_LONG_DESCR, '_') ARE_GCO_LONG_DESCR
       , nvl(ARE_GCO_FREE_DESCR, '_') ARE_GCO_FREE_DESCR
       , nvl(ARE_GCO_SHORT_DESCR_EX, '_') ARE_GCO_SHORT_DESCR_EX
       , nvl(ARE_GCO_LONG_DESCR_EX, '_') ARE_GCO_LONG_DESCR_EX
       , nvl(ARE_GCO_FREE_DESCR_EX, '_') ARE_GCO_FREE_DESCR_EX
       , nvl(PAC_SENDING_CONDITION_ID, -2) PAC_SENDING_CONDITION_ID
       , nvl2(ARE_RECALC_SALE_PRICE_2, case
                when(ARE_RECALC_SALE_PRICE_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_RECALC_SALE_PRICE_2
       , nvl2(ARE_RECALC_COST_PRICE_2, case
                when(ARE_RECALC_COST_PRICE_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_RECALC_COST_PRICE_2
       , nvl(ASA_RECORD_EVENTS_ID, -2) ASA_RECORD_EVENTS_ID
       , nvl2(ARE_USE_COMP, case
                when(ARE_USE_COMP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_USE_COMP
       , nvl2(ARE_USE_TASK, case
                when(ARE_USE_TASK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_USE_TASK
       , nvl(GCO_BILL_GOOD_ID, -2) GCO_BILL_GOOD_ID
       , nvl2(ARE_LPOS_COMP_TASK, case
                when(ARE_LPOS_COMP_TASK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_LPOS_COMP_TASK
       , nvl(STM_ASA_DEFECT_MVT_ID, -2) STM_ASA_DEFECT_MVT_ID
       , nvl(STM_ASA_EXCH_MVT_ID, -2) STM_ASA_EXCH_MVT_ID
       , nvl(STM_REPAIR_MVT_KIND_ID, -2) STM_REPAIR_MVT_KIND_ID
       , ARE_REPAIR_QTY
       , ARE_EXCH_QTY
       , nvl(STM_EXCH_MVT_KIND_ID, -2) STM_EXCH_MVT_KIND_ID
       , nvl(GCO_NEW_GOOD_ID, -2) GCO_NEW_GOOD_ID
       , nvl(GCO_NEW_CHAR1_ID, -2) GCO_NEW_CHAR1_ID
       , nvl(GCO_NEW_CHAR2_ID, -2) GCO_NEW_CHAR2_ID
       , nvl(GCO_NEW_CHAR3_ID, -2) GCO_NEW_CHAR3_ID
       , nvl(GCO_NEW_CHAR4_ID, -2) GCO_NEW_CHAR4_ID
       , nvl(GCO_NEW_CHAR5_ID, -2) GCO_NEW_CHAR5_ID
       , nvl(ARE_NEW_CHAR1_VALUE, '_') ARE_NEW_CHAR1_VALUE
       , nvl(ARE_NEW_CHAR2_VALUE, '_') ARE_NEW_CHAR2_VALUE
       , nvl(ARE_NEW_CHAR3_VALUE, '_') ARE_NEW_CHAR3_VALUE
       , nvl(ARE_NEW_CHAR4_VALUE, '_') ARE_NEW_CHAR4_VALUE
       , nvl(ARE_NEW_CHAR5_VALUE, '_') ARE_NEW_CHAR5_VALUE
       , nvl(ARE_BEGIN_GUARANTY_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_BEGIN_GUARANTY_DATE
       , nvl(C_ASA_GUARANTY_UNIT, 'DWH_ISNULL') C_ASA_GUARANTY_UNIT
       , nvl(ASA_STOLEN_GOODS_ID, -2) ASA_STOLEN_GOODS_ID
       , nvl(ASA_GUARANTY_CARDS_ID, -2) ASA_GUARANTY_CARDS_ID
       , nvl(ARE_REP_BEGIN_GUAR_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_REP_BEGIN_GUAR_DATE
       , ARE_REP_GUAR
       , nvl(C_ASA_REP_GUAR_UNIT, 'DWH_ISNULL') C_ASA_REP_GUAR_UNIT
       , nvl(ARE_REP_END_GUAR_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_REP_END_GUAR_DATE
       , ARE_PRICE_DEVIS_MB
       , ARE_PRICE_DEVIS_ME
       , ARE_PRICE_DEVIS_EURO
       , nvl(GCO_DEVIS_BILL_GOOD_ID, -2) GCO_DEVIS_BILL_GOOD_ID
       , nvl(ARE_FIN_SALE_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_FIN_SALE_DATE
       , nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , ARE_MIN_SALE_PRICE_MB
       , ARE_MIN_SALE_PRICE_ME
       , ARE_MIN_SALE_PRICE_EURO
       , ARE_MAX_SALE_PRICE_MB
       , ARE_MAX_SALE_PRICE_ME
       , ARE_MAX_SALE_PRICE_EURO
       , nvl(DIC_GARANTY_CODE_ID, 'DWH_ISNULL') DIC_GARANTY_CODE_ID
       , nvl(DIC_TARIFF2_ID, 'DWH_ISNULL') DIC_TARIFF2_ID
       , nvl(PAC_PAYMENT_CONDITION_ID, -2) PAC_PAYMENT_CONDITION_ID
       , nvl(ACS_FIN_ACC_S_PAYMENT_ID, -2) ACS_FIN_ACC_S_PAYMENT_ID
       , nvl(PAC_ASA_AGENT_ID, -2) PAC_ASA_AGENT_ID
       , nvl(PC_ASA_AGENT_LANG_ID, -2) PC_ASA_AGENT_LANG_ID
       , nvl(PAC_ASA_AGENT_ADDR_ID, -2) PAC_ASA_AGENT_ADDR_ID
       , nvl(ARE_ADDRESS_AGENT, '_') ARE_ADDRESS_AGENT
       , nvl(ARE_POSTCODE_AGENT, '_') ARE_POSTCODE_AGENT
       , nvl(ARE_TOWN_AGENT, '_') ARE_TOWN_AGENT
       , nvl(ARE_STATE_AGENT, '_') ARE_STATE_AGENT
       , nvl(PC_ASA_AGENT_CNTRY_ID, -2) PC_ASA_AGENT_CNTRY_ID
       , nvl(ARE_FORMAT_CITY_AGENT, '_') ARE_FORMAT_CITY_AGENT
       , nvl(PAC_ASA_DISTRIB_ID, -2) PAC_ASA_DISTRIB_ID
       , nvl(PC_ASA_DISTRIB_LANG_ID, -2) PC_ASA_DISTRIB_LANG_ID
       , nvl(PAC_ASA_DISTRIB_ADDR_ID, -2) PAC_ASA_DISTRIB_ADDR_ID
       , nvl(ARE_ADDRESS_DISTRIB, '_') ARE_ADDRESS_DISTRIB
       , nvl(ARE_POSTCODE_DISTRIB, '_') ARE_POSTCODE_DISTRIB
       , nvl(ARE_TOWN_DISTRIB, '_') ARE_TOWN_DISTRIB
       , nvl(ARE_STATE_DISTRIB, '_') ARE_STATE_DISTRIB
       , nvl(PC_ASA_DISTRIB_CNTRY_ID, -2) PC_ASA_DISTRIB_CNTRY_ID
       , nvl(ARE_FORMAT_CITY_DISTRIB, '_') ARE_FORMAT_CITY_DISTRIB
       , nvl(PC_ASA_FIN_CUST_LANG_ID, -2) PC_ASA_FIN_CUST_LANG_ID
       , nvl(ARE_DET_SALE_DATE, to_date('40000101', 'YYYYMMDD') ) ARE_DET_SALE_DATE
       , nvl(ARE_DET_SALE_DATE_TEXT, '_') ARE_DET_SALE_DATE_TEXT
       , nvl(ARE_FIN_SALE_DATE_TEXT, '_') ARE_FIN_SALE_DATE_TEXT
       , nvl(C_ASA_SELECT_PRICE, 'DWH_ISNULL') C_ASA_SELECT_PRICE
       , nvl(ARE_DATE_REG_REP, to_date('40000101', 'YYYYMMDD') ) ARE_DATE_REG_REP
       , ARE_NB_DAYS_WAIT
       , ARE_NB_DAYS_WAIT_COMP
       , ARE_NB_DAYS_WAIT_MAX
       , nvl(ARE_DATE_START_REP, to_date('40000101', 'YYYYMMDD') ) ARE_DATE_START_REP
       , nvl(ARE_DATE_END_REP, to_date('40000101', 'YYYYMMDD') ) ARE_DATE_END_REP
       , ARE_NB_DAYS_CTRL
       , nvl(ARE_DATE_END_CTRL, to_date('40000101', 'YYYYMMDD') ) ARE_DATE_END_CTRL
       , ARE_NB_DAYS_EXP
       , nvl(ARE_DATE_START_EXP, to_date('40000101', 'YYYYMMDD') ) ARE_DATE_START_EXP
       , ARE_NB_DAYS_SENDING
       , nvl(ARE_DATE_END_SENDING, to_date('40000101', 'YYYYMMDD') ) ARE_DATE_END_SENDING
       , nvl(DIC_TYPE_SUBMISSION_ID, 'DWH_ISNULL') DIC_TYPE_SUBMISSION_ID
       , nvl(DOC_ATTRIB_DOCUMENT_ID, -2) DOC_ATTRIB_DOCUMENT_ID
       , nvl(ARE_PIECE, '_') ARE_PIECE
       , nvl(ARE_SET, '_') ARE_SET
       , nvl(ARE_VERSION, '_') ARE_VERSION
       , nvl(ARE_CHRONOLOGICAL, '_') ARE_CHRONOLOGICAL
       , nvl(ARE_STD_CHAR_1, '_') ARE_STD_CHAR_1
       , nvl(ARE_STD_CHAR_2, '_') ARE_STD_CHAR_2
       , nvl(ARE_STD_CHAR_3, '_') ARE_STD_CHAR_3
       , nvl(ARE_STD_CHAR_4, '_') ARE_STD_CHAR_4
       , nvl(ARE_STD_CHAR_5, '_') ARE_STD_CHAR_5
       , nvl(ARE_CARE_OF_AGENT, '_') ARE_CARE_OF_AGENT
       , nvl(ARE_PO_BOX_AGENT, '_') ARE_PO_BOX_AGENT
       , ARE_PO_BOX_NBR_AGENT
       , nvl(ARE_COUNTY_AGENT, '_') ARE_COUNTY_AGENT
       , nvl(ARE_CARE_OF_DET, '_') ARE_CARE_OF_DET
       , nvl(ARE_PO_BOX_DET, '_') ARE_PO_BOX_DET
       , ARE_PO_BOX_NBR_DET
       , nvl(ARE_COUNTY_DET, '_') ARE_COUNTY_DET
       , nvl(ARE_CARE_OF_CUST, '_') ARE_CARE_OF_CUST
       , nvl(ARE_PO_BOX_CUST, '_') ARE_PO_BOX_CUST
       , ARE_PO_BOX_NBR_CUST
       , nvl(ARE_COUNTY_CUST, '_') ARE_COUNTY_CUST
       , nvl(ARE_CARE_OF1, '_') ARE_CARE_OF1
       , nvl(ARE_PO_BOX1, '_') ARE_PO_BOX1
       , ARE_PO_BOX_NBR1
       , nvl(ARE_COUNTY1, '_') ARE_COUNTY1
       , nvl(ARE_CARE_OF2, '_') ARE_CARE_OF2
       , nvl(ARE_PO_BOX2, '_') ARE_PO_BOX2
       , ARE_PO_BOX_NBR2
       , nvl(ARE_COUNTY2, '_') ARE_COUNTY2
       , nvl(ARE_CARE_OF3, '_') ARE_CARE_OF3
       , nvl(ARE_PO_BOX3, '_') ARE_PO_BOX3
       , ARE_PO_BOX_NBR3
       , nvl(ARE_COUNTY3, '_') ARE_COUNTY3
       , nvl(ARE_CARE_OF_SUP, '_') ARE_CARE_OF_SUP
       , nvl(ARE_PO_BOX_SUP, '_') ARE_PO_BOX_SUP
       , ARE_PO_BOX_NBR_SUP
       , nvl(ARE_COUNTY_SUP, '_') ARE_COUNTY_SUP
       , nvl2(ARE_PROTECTED, case
                when(ARE_PROTECTED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARE_PROTECTED
       , nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , nvl(C_PRIORITY, 'DWH_ISNULL') C_PRIORITY
       , nvl(PAC_COMMUNICATION_ID, -2) PAC_COMMUNICATION_ID
       , nvl(DIC_RECEPTION_MODE_ID, 'DWH_ISNULL') DIC_RECEPTION_MODE_ID
       , nvl(ARE_CONTACT1, '_') ARE_CONTACT1
       , nvl(ARE_CONTACT2, '_') ARE_CONTACT2
       , nvl(ARE_CONTACT3, '_') ARE_CONTACT3
       , nvl(ARE_CONTACT_COMMENT, '_') ARE_CONTACT_COMMENT
       , nvl(ARE_INTERNAL_REMARK, '_') ARE_INTERNAL_REMARK
       , nvl(ARE_CUSTOMER_REMARK, '_') ARE_CUSTOMER_REMARK
       , nvl(ARE_ADDITIONAL_ITEMS, '_') ARE_ADDITIONAL_ITEMS
       , ARE_CUSTOMS_VALUE
       , nvl(ACS_CUSTOM_FIN_CURR_ID, -2) ACS_CUSTOM_FIN_CURR_ID
       , nvl(ARE_REQ_DATE_TEXT, '_') ARE_REQ_DATE_TEXT
    from ASA_RECORD
  union all
  select -1 ASA_RECORD_ID
       , 'N/A' ARE_NUMBER
       , -1 ASA_REP_TYPE_ID
       , -1 DOC_GAUGE_ID
       , 'DWH_NA' C_ASA_REP_TYPE_KIND
       , 'DWH_NA' C_ASA_REP_STATUS
       , to_date('00010101', 'YYYYMMDD') ARE_DATECRE
       , to_date('00010101', 'YYYYMMDD') ARE_UPDATE_STATUS
       , to_date('00010101', 'YYYYMMDD') ARE_PRINT_STATUS
       , -1 DOC_RECORD_ID
       , -1 PAC_REPRESENTATIVE_ID
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , null ARE_CURR_BASE_PRICE
       , null ARE_CURR_RATE_OF_EXCH
       , null ARE_CURR_RATE_EURO
       , '-1' ARE_EURO_CURRENCY
       , null ARE_COST_PRICE_S
       , null ARE_COST_PRICE_W
       , null ARE_COST_PRICE_C
       , null ARE_COST_PRICE_T
       , null ARE_SALE_PRICE_S
       , null ARE_SALE_PRICE_W
       , null ARE_SALE_PRICE_C
       , null ARE_SALE_PRICE_T_MB
       , null ARE_SALE_PRICE_T_ME
       , null ARE_SALE_PRICE_T_EURO
       , -1 PAC_CUSTOM_PARTNER_ID
       , -1 PC_ASA_CUST_LANG_ID
       , -1 PAC_ASA_ADDR1_ID
       , 'N/A' ARE_ADDRESS1
       , 'N/A' ARE_POSTCODE1
       , 'N/A' ARE_TOWN1
       , 'N/A' ARE_STATE1
       , 'N/A' ARE_FORMAT_CITY1
       , -1 PC_ASA_CNTRY1_ID
       , -1 PAC_ASA_ADDR2_ID
       , 'N/A' ARE_ADDRESS2
       , 'N/A' ARE_POSTCODE2
       , 'N/A' ARE_TOWN2
       , 'N/A' ARE_STATE2
       , 'N/A' ARE_FORMAT_CITY2
       , -1 PC_ASA_CNTRY2_ID
       , -1 PAC_ASA_ADDR3_ID
       , 'N/A' ARE_ADDRESS3
       , 'N/A' ARE_POSTCODE3
       , 'N/A' ARE_TOWN3
       , 'N/A' ARE_STATE3
       , 'N/A' ARE_FORMAT_CITY3
       , -1 PC_ASA_CNTRY3_ID
       , -1 PAC_ASA_FIN_CUST_ID
       , -1 PAC_ASA_FIN_CUST_ADDR_ID
       , 'N/A' ARE_ADDRESS_FIN_CUST
       , 'N/A' ARE_POSTCODE_FIN_CUST
       , 'N/A' ARE_TOWN_FIN_CUST
       , 'N/A' ARE_STATE_FIN_CUST
       , 'N/A' ARE_FORMAT_CITY_FIN_CUST
       , -1 PC_ASA_FIN_CUST_CNTRY_ID
       , -1 PAC_SUPPLIER_PARTNER_ID
       , -1 ACS_ASA_SUP_FIN_CURR_ID
       , -1 PC_ASA_SUP_LANG_ID
       , -1 PAC_ASA_SUPPLIER_ADDR_ID
       , 'N/A' ARE_ADDRESS_SUPPLIER
       , 'N/A' ARE_POSTCODE_SUPPLIER
       , 'N/A' ARE_TOWN_SUPPLIER
       , 'N/A' ARE_STATE_SUPPLIER
       , -1 PC_ASA_SUPPLIER_CNTRY_ID
       , 'N/A' ARE_FORMAT_CITY_SUPPLIER
       , -1 GCO_SUPPLIER_GOOD_ID
       , -1 GCO_ASA_TO_REPAIR_ID
       , -1 GCO_CHAR1_ID
       , -1 GCO_CHAR2_ID
       , -1 GCO_CHAR3_ID
       , -1 GCO_CHAR4_ID
       , -1 GCO_CHAR5_ID
       , 'N/A' ARE_CHAR1_VALUE
       , 'N/A' ARE_CHAR2_VALUE
       , 'N/A' ARE_CHAR3_VALUE
       , 'N/A' ARE_CHAR4_VALUE
       , 'N/A' ARE_CHAR5_VALUE
       , 'N/A' ARE_CUSTOMER_REF
       , 'N/A' ARE_GOOD_REF_1
       , 'N/A' ARE_GOOD_REF_2
       , 'N/A' ARE_GOOD_REF_3
       , 'N/A' ARE_GOOD_NEW_REF
       , -1 STM_ASA_DEFECT_LOC_ID
       , -1 STM_ASA_DEFECT_STK_ID
       , to_date('00010101', 'YYYYMMDD') ARE_SALE_DATE
       , 'N/A' ARE_SALE_DATE_TEXT
       , -1 PC_ORIGIN_CNTRY_ID
       , null ARE_GUARANTY
       , to_date('00010101', 'YYYYMMDD') ARE_END_GUARANTY_DATE
       , '-1' ARE_GUARANTY_CODE
       , '-1' ARE_CUSTOMER_ERROR
       , '-1' ARE_OFFERED_CODE
       , '-1' ARE_GENERATE_BILL
       , 'DWH_NA' C_ASA_DEVIS_CODE
       , null ARE_MIN_DEVIS_MB
       , null ARE_MIN_DEVIS_ME
       , null ARE_MIN_DEVIS_EURO
       , to_date('00010101', 'YYYYMMDD') ARE_VAL_DEVIS_DATE
       , -1 GCO_ASA_EXCHANGE_ID
       , -1 GCO_EXCH_CHAR1_ID
       , -1 GCO_EXCH_CHAR2_ID
       , -1 GCO_EXCH_CHAR3_ID
       , -1 GCO_EXCH_CHAR4_ID
       , -1 GCO_EXCH_CHAR5_ID
       , 'N/A' ARE_EXCH_CHAR1_VALUE
       , 'N/A' ARE_EXCH_CHAR2_VALUE
       , 'N/A' ARE_EXCH_CHAR3_VALUE
       , 'N/A' ARE_EXCH_CHAR4_VALUE
       , 'N/A' ARE_EXCH_CHAR5_VALUE
       , -1 STM_ASA_EXCH_LOC_ID
       , -1 STM_ASA_EXCH_STK_ID
       , -1 ASA_LAST_RECORD_ID
       , -1 DOC_ORIGIN_POSITION_ID
       , null ARE_NB_DAYS
       , to_date('00010101', 'YYYYMMDD') ARE_REQ_DATE_C
       , to_date('00010101', 'YYYYMMDD') ARE_CONF_DATE_C
       , to_date('00010101', 'YYYYMMDD') ARE_UPD_DATE_C
       , to_date('00010101', 'YYYYMMDD') ARE_REQ_DATE_S
       , to_date('00010101', 'YYYYMMDD') ARE_CONF_DATE_S
       , to_date('00010101', 'YYYYMMDD') ARE_UPD_DATE_S
       , 'N/A' ARE_GCO_SHORT_DESCR
       , 'N/A' ARE_GCO_LONG_DESCR
       , 'N/A' ARE_GCO_FREE_DESCR
       , 'N/A' ARE_GCO_SHORT_DESCR_EX
       , 'N/A' ARE_GCO_LONG_DESCR_EX
       , 'N/A' ARE_GCO_FREE_DESCR_EX
       , -1 PAC_SENDING_CONDITION_ID
       , '-1' ARE_RECALC_SALE_PRICE_2
       , '-1' ARE_RECALC_COST_PRICE_2
       , -1 ASA_RECORD_EVENTS_ID
       , '-1' ARE_USE_COMP
       , '-1' ARE_USE_TASK
       , -1 GCO_BILL_GOOD_ID
       , '-1' ARE_LPOS_COMP_TASK
       , -1 STM_ASA_DEFECT_MVT_ID
       , -1 STM_ASA_EXCH_MVT_ID
       , -1 STM_REPAIR_MVT_KIND_ID
       , null ARE_REPAIR_QTY
       , null ARE_EXCH_QTY
       , -1 STM_EXCH_MVT_KIND_ID
       , -1 GCO_NEW_GOOD_ID
       , -1 GCO_NEW_CHAR1_ID
       , -1 GCO_NEW_CHAR2_ID
       , -1 GCO_NEW_CHAR3_ID
       , -1 GCO_NEW_CHAR4_ID
       , -1 GCO_NEW_CHAR5_ID
       , 'N/A' ARE_NEW_CHAR1_VALUE
       , 'N/A' ARE_NEW_CHAR2_VALUE
       , 'N/A' ARE_NEW_CHAR3_VALUE
       , 'N/A' ARE_NEW_CHAR4_VALUE
       , 'N/A' ARE_NEW_CHAR5_VALUE
       , to_date('00010101', 'YYYYMMDD') ARE_BEGIN_GUARANTY_DATE
       , 'DWH_NA' C_ASA_GUARANTY_UNIT
       , -1 ASA_STOLEN_GOODS_ID
       , -1 ASA_GUARANTY_CARDS_ID
       , to_date('00010101', 'YYYYMMDD') ARE_REP_BEGIN_GUAR_DATE
       , null ARE_REP_GUAR
       , 'DWH_NA' C_ASA_REP_GUAR_UNIT
       , to_date('00010101', 'YYYYMMDD') ARE_REP_END_GUAR_DATE
       , null ARE_PRICE_DEVIS_MB
       , null ARE_PRICE_DEVIS_ME
       , null ARE_PRICE_DEVIS_EURO
       , -1 GCO_DEVIS_BILL_GOOD_ID
       , to_date('00010101', 'YYYYMMDD') ARE_FIN_SALE_DATE
       , 'DWH_NA' DIC_TARIFF_ID
       , null ARE_MIN_SALE_PRICE_MB
       , null ARE_MIN_SALE_PRICE_ME
       , null ARE_MIN_SALE_PRICE_EURO
       , null ARE_MAX_SALE_PRICE_MB
       , null ARE_MAX_SALE_PRICE_ME
       , null ARE_MAX_SALE_PRICE_EURO
       , 'DWH_NA' DIC_GARANTY_CODE_ID
       , 'DWH_NA' DIC_TARIFF2_ID
       , -1 PAC_PAYMENT_CONDITION_ID
       , -1 ACS_FIN_ACC_S_PAYMENT_ID
       , -1 PAC_ASA_AGENT_ID
       , -1 PC_ASA_AGENT_LANG_ID
       , -1 PAC_ASA_AGENT_ADDR_ID
       , 'N/A' ARE_ADDRESS_AGENT
       , 'N/A' ARE_POSTCODE_AGENT
       , 'N/A' ARE_TOWN_AGENT
       , 'N/A' ARE_STATE_AGENT
       , -1 PC_ASA_AGENT_CNTRY_ID
       , 'N/A' ARE_FORMAT_CITY_AGENT
       , -1 PAC_ASA_DISTRIB_ID
       , -1 PC_ASA_DISTRIB_LANG_ID
       , -1 PAC_ASA_DISTRIB_ADDR_ID
       , 'N/A' ARE_ADDRESS_DISTRIB
       , 'N/A' ARE_POSTCODE_DISTRIB
       , 'N/A' ARE_TOWN_DISTRIB
       , 'N/A' ARE_STATE_DISTRIB
       , -1 PC_ASA_DISTRIB_CNTRY_ID
       , 'N/A' ARE_FORMAT_CITY_DISTRIB
       , -1 PC_ASA_FIN_CUST_LANG_ID
       , to_date('00010101', 'YYYYMMDD') ARE_DET_SALE_DATE
       , 'N/A' ARE_DET_SALE_DATE_TEXT
       , 'N/A' ARE_FIN_SALE_DATE_TEXT
       , 'DWH_NA' C_ASA_SELECT_PRICE
       , to_date('00010101', 'YYYYMMDD') ARE_DATE_REG_REP
       , null ARE_NB_DAYS_WAIT
       , null ARE_NB_DAYS_WAIT_COMP
       , null ARE_NB_DAYS_WAIT_MAX
       , to_date('00010101', 'YYYYMMDD') ARE_DATE_START_REP
       , to_date('00010101', 'YYYYMMDD') ARE_DATE_END_REP
       , null ARE_NB_DAYS_CTRL
       , to_date('00010101', 'YYYYMMDD') ARE_DATE_END_CTRL
       , null ARE_NB_DAYS_EXP
       , to_date('00010101', 'YYYYMMDD') ARE_DATE_START_EXP
       , null ARE_NB_DAYS_SENDING
       , to_date('00010101', 'YYYYMMDD') ARE_DATE_END_SENDING
       , 'DWH_NA' DIC_TYPE_SUBMISSION_ID
       , -1 DOC_ATTRIB_DOCUMENT_ID
       , 'N/A' ARE_PIECE
       , 'N/A' ARE_SET
       , 'N/A' ARE_VERSION
       , 'N/A' ARE_CHRONOLOGICAL
       , 'N/A' ARE_STD_CHAR_1
       , 'N/A' ARE_STD_CHAR_2
       , 'N/A' ARE_STD_CHAR_3
       , 'N/A' ARE_STD_CHAR_4
       , 'N/A' ARE_STD_CHAR_5
       , 'N/A' ARE_CARE_OF_AGENT
       , 'N/A' ARE_PO_BOX_AGENT
       , null ARE_PO_BOX_NBR_AGENT
       , 'N/A' ARE_COUNTY_AGENT
       , 'N/A' ARE_CARE_OF_DET
       , 'N/A' ARE_PO_BOX_DET
       , null ARE_PO_BOX_NBR_DET
       , 'N/A' ARE_COUNTY_DET
       , 'N/A' ARE_CARE_OF_CUST
       , 'N/A' ARE_PO_BOX_CUST
       , null ARE_PO_BOX_NBR_CUST
       , 'N/A' ARE_COUNTY_CUST
       , 'N/A' ARE_CARE_OF1
       , 'N/A' ARE_PO_BOX1
       , null ARE_PO_BOX_NBR1
       , 'N/A' ARE_COUNTY1
       , 'N/A' ARE_CARE_OF2
       , 'N/A' ARE_PO_BOX2
       , null ARE_PO_BOX_NBR2
       , 'N/A' ARE_COUNTY2
       , 'N/A' ARE_CARE_OF3
       , 'N/A' ARE_PO_BOX3
       , null ARE_PO_BOX_NBR3
       , 'N/A' ARE_COUNTY3
       , 'N/A' ARE_CARE_OF_SUP
       , 'N/A' ARE_PO_BOX_SUP
       , null ARE_PO_BOX_NBR_SUP
       , 'N/A' ARE_COUNTY_SUP
       , '-1' ARE_PROTECTED
       , -1 PAC_THIRD_TARIFF_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_ACI_ID
       , 'DWH_NA' C_PRIORITY
       , -1 PAC_COMMUNICATION_ID
       , 'DWH_NA' DIC_RECEPTION_MODE_ID
       , 'N/A' ARE_CONTACT1
       , 'N/A' ARE_CONTACT2
       , 'N/A' ARE_CONTACT3
       , 'N/A' ARE_CONTACT_COMMENT
       , 'N/A' ARE_INTERNAL_REMARK
       , 'N/A' ARE_CUSTOMER_REMARK
       , 'N/A' ARE_ADDITIONAL_ITEMS
       , null ARE_CUSTOMS_VALUE
       , -1 ACS_CUSTOM_FIN_CURR_ID
       , 'N/A' ARE_REQ_DATE_TEXT
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ASA_RECORD_COMP" ("ASA_RECORD_COMP_ID", "ASA_RECORD_ID", "ARC_POSITION", "GCO_COMPONENT_ID", "GCO_CHAR1_ID", "GCO_CHAR2_ID", "GCO_CHAR3_ID", "GCO_CHAR4_ID", "GCO_CHAR5_ID", "ARC_CHAR1_VALUE", "ARC_CHAR2_VALUE", "ARC_CHAR3_VALUE", "ARC_CHAR4_VALUE", "ARC_CHAR5_VALUE", "ARC_COST_PRICE", "ARC_SALE_PRICE", "ARC_QUANTITY", "ARC_CDMVT", "STM_COMP_LOCATION_ID", "STM_COMP_STOCK_ID", "STM_COMP_MVT_KIND_ID", "ARC_DESCR", "STM_COMP_STOCK_MVT_ID", "ARC_OPTIONAL", "ASA_RECORD_EVENTS_ID", "ARC_GUARANTY_CODE", "DIC_GARANTY_CODE_ID", "C_ASA_GEN_DOC_POS", "ARC_DESCR2", "ARC_SALE_PRICE2", "ARC_FREE_NUM1", "ARC_FREE_NUM2", "ARC_FREE_CHAR1", "ARC_FREE_CHAR2", "DIC_ASA_FREE_DICO_COMP1_ID", "DIC_ASA_FREE_DICO_COMP2_ID", "C_ASA_ACCEPT_OPTION", "ARC_SALE_PRICE_ME", "ARC_SALE_PRICE_EURO", "ARC_SALE_PRICE2_ME", "ARC_SALE_PRICE2_EURO", "ARC_NB_DAYS_APPRO", "ARC_DESCR3", "STM_WORK_STOCK_ID", "STM_WORK_LOCATION_ID", "STM_WORK_STOCK_MOVEMENT_ID", "DOC_ATTRIB_POSITION_ID", "ARC_PIECE", "ARC_SET", "ARC_VERSION", "ARC_CHRONOLOGICAL", "ARC_STD_CHAR_1", "ARC_STD_CHAR_2", "ARC_STD_CHAR_3", "ARC_STD_CHAR_4", "ARC_STD_CHAR_5", "ARC_MOVEMENT_DATE", "FAL_FACTORY_OUT_ID", "ASA_RECORD_DETAIL_ID", "ARC_PROTECTED", "DIC_ASA_OPTION_ID", "ARC_FREE_NUM3", "ARC_FREE_NUM4", "ARC_FREE_NUM5", "ARC_FREE_CHAR3", "ARC_FREE_CHAR4", "ARC_FREE_CHAR5") AS
  select ASA_RECORD_COMP_ID
       , nvl(ASA_RECORD_ID, -2) ASA_RECORD_ID
       , ARC_POSITION
       , nvl(GCO_COMPONENT_ID, -2) GCO_COMPONENT_ID
       , nvl(GCO_CHAR1_ID, -2) GCO_CHAR1_ID
       , nvl(GCO_CHAR2_ID, -2) GCO_CHAR2_ID
       , nvl(GCO_CHAR3_ID, -2) GCO_CHAR3_ID
       , nvl(GCO_CHAR4_ID, -2) GCO_CHAR4_ID
       , nvl(GCO_CHAR5_ID, -2) GCO_CHAR5_ID
       , nvl(ARC_CHAR1_VALUE, '_') ARC_CHAR1_VALUE
       , nvl(ARC_CHAR2_VALUE, '_') ARC_CHAR2_VALUE
       , nvl(ARC_CHAR3_VALUE, '_') ARC_CHAR3_VALUE
       , nvl(ARC_CHAR4_VALUE, '_') ARC_CHAR4_VALUE
       , nvl(ARC_CHAR5_VALUE, '_') ARC_CHAR5_VALUE
       , ARC_COST_PRICE
       , ARC_SALE_PRICE
       , ARC_QUANTITY
       , nvl2(ARC_CDMVT, case
                when(ARC_CDMVT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARC_CDMVT
       , nvl(STM_COMP_LOCATION_ID, -2) STM_COMP_LOCATION_ID
       , nvl(STM_COMP_STOCK_ID, -2) STM_COMP_STOCK_ID
       , nvl(STM_COMP_MVT_KIND_ID, -2) STM_COMP_MVT_KIND_ID
       , nvl(ARC_DESCR, '_') ARC_DESCR
       , nvl(STM_COMP_STOCK_MVT_ID, -2) STM_COMP_STOCK_MVT_ID
       , nvl2(ARC_OPTIONAL, case
                when(ARC_OPTIONAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARC_OPTIONAL
       , nvl(ASA_RECORD_EVENTS_ID, -2) ASA_RECORD_EVENTS_ID
       , nvl2(ARC_GUARANTY_CODE, case
                when(ARC_GUARANTY_CODE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARC_GUARANTY_CODE
       , nvl(DIC_GARANTY_CODE_ID, 'DWH_ISNULL') DIC_GARANTY_CODE_ID
       , nvl(C_ASA_GEN_DOC_POS, 'DWH_ISNULL') C_ASA_GEN_DOC_POS
       , nvl(ARC_DESCR2, '_') ARC_DESCR2
       , ARC_SALE_PRICE2
       , ARC_FREE_NUM1
       , ARC_FREE_NUM2
       , nvl(ARC_FREE_CHAR1, '_') ARC_FREE_CHAR1
       , nvl(ARC_FREE_CHAR2, '_') ARC_FREE_CHAR2
       , nvl(DIC_ASA_FREE_DICO_COMP1_ID, 'DWH_ISNULL') DIC_ASA_FREE_DICO_COMP1_ID
       , nvl(DIC_ASA_FREE_DICO_COMP2_ID, 'DWH_ISNULL') DIC_ASA_FREE_DICO_COMP2_ID
       , nvl(C_ASA_ACCEPT_OPTION, 'DWH_ISNULL') C_ASA_ACCEPT_OPTION
       , ARC_SALE_PRICE_ME
       , ARC_SALE_PRICE_EURO
       , ARC_SALE_PRICE2_ME
       , ARC_SALE_PRICE2_EURO
       , ARC_NB_DAYS_APPRO
       , nvl(ARC_DESCR3, '_') ARC_DESCR3
       , nvl(STM_WORK_STOCK_ID, -2) STM_WORK_STOCK_ID
       , nvl(STM_WORK_LOCATION_ID, -2) STM_WORK_LOCATION_ID
       , nvl(STM_WORK_STOCK_MOVEMENT_ID, -2) STM_WORK_STOCK_MOVEMENT_ID
       , nvl(DOC_ATTRIB_POSITION_ID, -2) DOC_ATTRIB_POSITION_ID
       , nvl(ARC_PIECE, '_') ARC_PIECE
       , nvl(ARC_SET, '_') ARC_SET
       , nvl(ARC_VERSION, '_') ARC_VERSION
       , nvl(ARC_CHRONOLOGICAL, '_') ARC_CHRONOLOGICAL
       , nvl(ARC_STD_CHAR_1, '_') ARC_STD_CHAR_1
       , nvl(ARC_STD_CHAR_2, '_') ARC_STD_CHAR_2
       , nvl(ARC_STD_CHAR_3, '_') ARC_STD_CHAR_3
       , nvl(ARC_STD_CHAR_4, '_') ARC_STD_CHAR_4
       , nvl(ARC_STD_CHAR_5, '_') ARC_STD_CHAR_5
       , nvl(ARC_MOVEMENT_DATE, to_date('40000101', 'YYYYMMDD') ) ARC_MOVEMENT_DATE
       , nvl(FAL_FACTORY_OUT_ID, -2) FAL_FACTORY_OUT_ID
       , nvl(ASA_RECORD_DETAIL_ID, -2) ASA_RECORD_DETAIL_ID
       , nvl2(ARC_PROTECTED, case
                when(ARC_PROTECTED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ARC_PROTECTED
       , nvl(DIC_ASA_OPTION_ID, 'DWH_ISNULL') DIC_ASA_OPTION_ID
       , ARC_FREE_NUM3
       , ARC_FREE_NUM4
       , ARC_FREE_NUM5
       , nvl(ARC_FREE_CHAR3, '_') ARC_FREE_CHAR3
       , nvl(ARC_FREE_CHAR4, '_') ARC_FREE_CHAR4
       , nvl(ARC_FREE_CHAR5, '_') ARC_FREE_CHAR5
    from ASA_RECORD_COMP
  union all
  select -1 ASA_RECORD_COMP_ID
       , -1 ASA_RECORD_ID
       , null ARC_POSITION
       , -1 GCO_COMPONENT_ID
       , -1 GCO_CHAR1_ID
       , -1 GCO_CHAR2_ID
       , -1 GCO_CHAR3_ID
       , -1 GCO_CHAR4_ID
       , -1 GCO_CHAR5_ID
       , 'N/A' ARC_CHAR1_VALUE
       , 'N/A' ARC_CHAR2_VALUE
       , 'N/A' ARC_CHAR3_VALUE
       , 'N/A' ARC_CHAR4_VALUE
       , 'N/A' ARC_CHAR5_VALUE
       , null ARC_COST_PRICE
       , null ARC_SALE_PRICE
       , null ARC_QUANTITY
       , '-1' ARC_CDMVT
       , -1 STM_COMP_LOCATION_ID
       , -1 STM_COMP_STOCK_ID
       , -1 STM_COMP_MVT_KIND_ID
       , 'N/A' ARC_DESCR
       , -1 STM_COMP_STOCK_MVT_ID
       , '-1' ARC_OPTIONAL
       , -1 ASA_RECORD_EVENTS_ID
       , '-1' ARC_GUARANTY_CODE
       , 'DWH_NA' DIC_GARANTY_CODE_ID
       , 'DWH_NA' C_ASA_GEN_DOC_POS
       , 'N/A' ARC_DESCR2
       , null ARC_SALE_PRICE2
       , null ARC_FREE_NUM1
       , null ARC_FREE_NUM2
       , 'N/A' ARC_FREE_CHAR1
       , 'N/A' ARC_FREE_CHAR2
       , 'DWH_NA' DIC_ASA_FREE_DICO_COMP1_ID
       , 'DWH_NA' DIC_ASA_FREE_DICO_COMP2_ID
       , 'DWH_NA' C_ASA_ACCEPT_OPTION
       , null ARC_SALE_PRICE_ME
       , null ARC_SALE_PRICE_EURO
       , null ARC_SALE_PRICE2_ME
       , null ARC_SALE_PRICE2_EURO
       , null ARC_NB_DAYS_APPRO
       , 'N/A' ARC_DESCR3
       , -1 STM_WORK_STOCK_ID
       , -1 STM_WORK_LOCATION_ID
       , -1 STM_WORK_STOCK_MOVEMENT_ID
       , -1 DOC_ATTRIB_POSITION_ID
       , 'N/A' ARC_PIECE
       , 'N/A' ARC_SET
       , 'N/A' ARC_VERSION
       , 'N/A' ARC_CHRONOLOGICAL
       , 'N/A' ARC_STD_CHAR_1
       , 'N/A' ARC_STD_CHAR_2
       , 'N/A' ARC_STD_CHAR_3
       , 'N/A' ARC_STD_CHAR_4
       , 'N/A' ARC_STD_CHAR_5
       , to_date('00010101', 'YYYYMMDD') ARC_MOVEMENT_DATE
       , -1 FAL_FACTORY_OUT_ID
       , -1 ASA_RECORD_DETAIL_ID
       , '-1' ARC_PROTECTED
       , 'DWH_NA' DIC_ASA_OPTION_ID
       , null ARC_FREE_NUM3
       , null ARC_FREE_NUM4
       , null ARC_FREE_NUM5
       , 'N/A' ARC_FREE_CHAR3
       , 'N/A' ARC_FREE_CHAR4
       , 'N/A' ARC_FREE_CHAR5
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ASA_RECORD_EVENTS" ("ASA_RECORD_EVENTS_ID", "RRE_SEQ", "ASA_RECORD_ID", "C_ASA_REP_STATUS", "RRE_DOCUMENT", "RRE_DATE", "RRE_MAIN_PRINTING", "RRE_ALT1_PRINTING", "RRE_ALT2_PRINTING", "RRE_ALT3_PRINTING", "RRE_ALT4_PRINTING", "RRE_ALT5_PRINTING", "RRE_DATE_MAIN_PRINTING", "RRE_DATE_ALT1_PRINTING", "RRE_DATE_ALT2_PRINTING", "RRE_DATE_ALT3_PRINTING", "RRE_DATE_ALT4_PRINTING", "RRE_DATE_ALT5_PRINTING", "DOC_POSITION_ID", "RRE_DOC_POSITION_UPD_STAT", "RRE_FREE_NUM1", "RRE_FREE_NUM2", "RRE_FREE_CHAR1", "RRE_FREE_CHAR2", "RRE_FREE_MEMO1", "RRE_FREE_MEMO2", "RRE_FREE_DATE1", "RRE_FREE_DATE2", "DIC_ASA_FREE_DICO_EVENTS2_ID", "DIC_ASA_FREE_DICO_EVENTS1_ID", "RRE_ALT6_PRINTING", "RRE_ALT7_PRINTING", "RRE_ALT8_PRINTING", "RRE_ALT9_PRINTING", "RRE_ALT10_PRINTING", "RRE_DATE_ALT6_PRINTING", "RRE_DATE_ALT7_PRINTING", "RRE_DATE_ALT8_PRINTING", "RRE_DATE_ALT9_PRINTING", "RRE_DATE_ALT10_PRINTING", "DOC_DOCUMENT_ID", "FAL_LOT_ID") AS
  select ASA_RECORD_EVENTS_ID
       , RRE_SEQ
       , nvl(ASA_RECORD_ID, -2) ASA_RECORD_ID
       , nvl(C_ASA_REP_STATUS, 'DWH_ISNULL') C_ASA_REP_STATUS
       , nvl(RRE_DOCUMENT, '_') RRE_DOCUMENT
       , nvl(RRE_DATE, to_date('40000101', 'YYYYMMDD') ) RRE_DATE
       , nvl2(RRE_MAIN_PRINTING, case
                when(RRE_MAIN_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_MAIN_PRINTING
       , nvl2(RRE_ALT1_PRINTING, case
                when(RRE_ALT1_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT1_PRINTING
       , nvl2(RRE_ALT2_PRINTING, case
                when(RRE_ALT2_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT2_PRINTING
       , nvl2(RRE_ALT3_PRINTING, case
                when(RRE_ALT3_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT3_PRINTING
       , nvl2(RRE_ALT4_PRINTING, case
                when(RRE_ALT4_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT4_PRINTING
       , nvl2(RRE_ALT5_PRINTING, case
                when(RRE_ALT5_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT5_PRINTING
       , nvl(RRE_DATE_MAIN_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_MAIN_PRINTING
       , nvl(RRE_DATE_ALT1_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT1_PRINTING
       , nvl(RRE_DATE_ALT2_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT2_PRINTING
       , nvl(RRE_DATE_ALT3_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT3_PRINTING
       , nvl(RRE_DATE_ALT4_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT4_PRINTING
       , nvl(RRE_DATE_ALT5_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT5_PRINTING
       , nvl(DOC_POSITION_ID, -2) DOC_POSITION_ID
       , nvl2(RRE_DOC_POSITION_UPD_STAT, case
                when(RRE_DOC_POSITION_UPD_STAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_DOC_POSITION_UPD_STAT
       , RRE_FREE_NUM1
       , RRE_FREE_NUM2
       , nvl(RRE_FREE_CHAR1, '_') RRE_FREE_CHAR1
       , nvl(RRE_FREE_CHAR2, '_') RRE_FREE_CHAR2
       , nvl(RRE_FREE_MEMO1, '_') RRE_FREE_MEMO1
       , nvl(RRE_FREE_MEMO2, '_') RRE_FREE_MEMO2
       , nvl(RRE_FREE_DATE1, to_date('40000101', 'YYYYMMDD') ) RRE_FREE_DATE1
       , nvl(RRE_FREE_DATE2, to_date('40000101', 'YYYYMMDD') ) RRE_FREE_DATE2
       , nvl(DIC_ASA_FREE_DICO_EVENTS2_ID, 'DWH_ISNULL') DIC_ASA_FREE_DICO_EVENTS2_ID
       , nvl(DIC_ASA_FREE_DICO_EVENTS1_ID, 'DWH_ISNULL') DIC_ASA_FREE_DICO_EVENTS1_ID
       , nvl2(RRE_ALT6_PRINTING, case
                when(RRE_ALT6_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT6_PRINTING
       , nvl2(RRE_ALT7_PRINTING, case
                when(RRE_ALT7_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT7_PRINTING
       , nvl2(RRE_ALT8_PRINTING, case
                when(RRE_ALT8_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT8_PRINTING
       , nvl2(RRE_ALT9_PRINTING, case
                when(RRE_ALT9_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT9_PRINTING
       , nvl2(RRE_ALT10_PRINTING, case
                when(RRE_ALT10_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RRE_ALT10_PRINTING
       , nvl(RRE_DATE_ALT6_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT6_PRINTING
       , nvl(RRE_DATE_ALT7_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT7_PRINTING
       , nvl(RRE_DATE_ALT8_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT8_PRINTING
       , nvl(RRE_DATE_ALT9_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT9_PRINTING
       , nvl(RRE_DATE_ALT10_PRINTING, to_date('40000101', 'YYYYMMDD') ) RRE_DATE_ALT10_PRINTING
       , nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , nvl(FAL_LOT_ID, -2) FAL_LOT_ID
    from ASA_RECORD_EVENTS
  union all
  select -1 ASA_RECORD_EVENTS_ID
       , null RRE_SEQ
       , -1 ASA_RECORD_ID
       , 'DWH_NA' C_ASA_REP_STATUS
       , 'N/A' RRE_DOCUMENT
       , to_date('00010101', 'YYYYMMDD') RRE_DATE
       , '-1' RRE_MAIN_PRINTING
       , '-1' RRE_ALT1_PRINTING
       , '-1' RRE_ALT2_PRINTING
       , '-1' RRE_ALT3_PRINTING
       , '-1' RRE_ALT4_PRINTING
       , '-1' RRE_ALT5_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_MAIN_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT1_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT2_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT3_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT4_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT5_PRINTING
       , -1 DOC_POSITION_ID
       , '-1' RRE_DOC_POSITION_UPD_STAT
       , null RRE_FREE_NUM1
       , null RRE_FREE_NUM2
       , 'N/A' RRE_FREE_CHAR1
       , 'N/A' RRE_FREE_CHAR2
       , 'N/A' RRE_FREE_MEMO1
       , 'N/A' RRE_FREE_MEMO2
       , to_date('00010101', 'YYYYMMDD') RRE_FREE_DATE1
       , to_date('00010101', 'YYYYMMDD') RRE_FREE_DATE2
       , 'DWH_NA' DIC_ASA_FREE_DICO_EVENTS2_ID
       , 'DWH_NA' DIC_ASA_FREE_DICO_EVENTS1_ID
       , '-1' RRE_ALT6_PRINTING
       , '-1' RRE_ALT7_PRINTING
       , '-1' RRE_ALT8_PRINTING
       , '-1' RRE_ALT9_PRINTING
       , '-1' RRE_ALT10_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT6_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT7_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT8_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT9_PRINTING
       , to_date('00010101', 'YYYYMMDD') RRE_DATE_ALT10_PRINTING
       , -1 DOC_DOCUMENT_ID
       , -1 FAL_LOT_ID
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ASA_RECORD_TASK" ("ASA_RECORD_TASK_ID", "ASA_RECORD_ID", "RET_POSITION", "RET_OPTIONAL", "RET_GUARANTY_CODE", "RET_FINISHED", "RET_TIME", "RET_TIME_USED", "RET_DESCR", "FAL_TASK_ID", "DIC_OPERATOR_ID", "FAL_FACTORY_FLOOR_ID", "RET_WORK_RATE", "RET_SALE_AMOUNT", "GCO_BILL_GOOD_ID", "RET_COST_PRICE", "RET_AMOUNT", "ASA_RECORD_EVENTS_ID", "DIC_GARANTY_CODE_ID", "C_ASA_GEN_DOC_POS", "RET_DESCR2", "RET_SALE_AMOUNT2", "RET_FREE_NUM1", "RET_FREE_NUM2", "RET_FREE_CHAR1", "RET_FREE_CHAR2", "DIC_ASA_FREE_DICO_TASK1_ID", "DIC_ASA_FREE_DICO_TASK2_ID", "C_ASA_ACCEPT_OPTION", "RET_SALE_AMOUNT_ME", "RET_SALE_AMOUNT_EURO", "RET_SALE_AMOUNT2_ME", "RET_SALE_AMOUNT2_EURO", "RET_AMOUNT_ME", "RET_AMOUNT_EURO", "RET_DESCR3", "RET_EXTERNAL", "FAL_LOT_PROGRESS_ID", "PAC_SUPPLIER_PARTNER_ID", "RET_DURATION", "RET_BEGIN_DATE", "RET_END_DATE", "RET_CHAR1_VALUE", "RET_CHAR2_VALUE", "RET_CHAR3_VALUE", "RET_CHAR4_VALUE", "RET_CHAR5_VALUE", "DIC_ASA_OPTION_ID", "FAL_FACTORY_OUT_ID", "GCO_ASA_TO_REPAIR_ID", "RET_FREE_NUM3", "RET_FREE_NUM4", "RET_FREE_NUM5", "RET_FREE_CHAR3", "RET_FREE_CHAR4", "RET_FREE_CHAR5") AS
  select ASA_RECORD_TASK_ID
       , nvl(ASA_RECORD_ID, -2) ASA_RECORD_ID
       , RET_POSITION
       , nvl2(RET_OPTIONAL, case
                when(RET_OPTIONAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_OPTIONAL
       , nvl2(RET_GUARANTY_CODE, case
                when(RET_GUARANTY_CODE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_GUARANTY_CODE
       , nvl2(RET_FINISHED, case
                when(RET_FINISHED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_FINISHED
       , RET_TIME
       , RET_TIME_USED
       , nvl(RET_DESCR, '_') RET_DESCR
       , nvl(FAL_TASK_ID, -2) FAL_TASK_ID
       , nvl(DIC_OPERATOR_ID, 'DWH_ISNULL') DIC_OPERATOR_ID
       , nvl(FAL_FACTORY_FLOOR_ID, -2) FAL_FACTORY_FLOOR_ID
       , RET_WORK_RATE
       , RET_SALE_AMOUNT
       , nvl(GCO_BILL_GOOD_ID, -2) GCO_BILL_GOOD_ID
       , RET_COST_PRICE
       , RET_AMOUNT
       , nvl(ASA_RECORD_EVENTS_ID, -2) ASA_RECORD_EVENTS_ID
       , nvl(DIC_GARANTY_CODE_ID, 'DWH_ISNULL') DIC_GARANTY_CODE_ID
       , nvl(C_ASA_GEN_DOC_POS, 'DWH_ISNULL') C_ASA_GEN_DOC_POS
       , nvl(RET_DESCR2, '_') RET_DESCR2
       , RET_SALE_AMOUNT2
       , RET_FREE_NUM1
       , RET_FREE_NUM2
       , nvl(RET_FREE_CHAR1, '_') RET_FREE_CHAR1
       , nvl(RET_FREE_CHAR2, '_') RET_FREE_CHAR2
       , nvl(DIC_ASA_FREE_DICO_TASK1_ID, 'DWH_ISNULL') DIC_ASA_FREE_DICO_TASK1_ID
       , nvl(DIC_ASA_FREE_DICO_TASK2_ID, 'DWH_ISNULL') DIC_ASA_FREE_DICO_TASK2_ID
       , nvl(C_ASA_ACCEPT_OPTION, 'DWH_ISNULL') C_ASA_ACCEPT_OPTION
       , RET_SALE_AMOUNT_ME
       , RET_SALE_AMOUNT_EURO
       , RET_SALE_AMOUNT2_ME
       , RET_SALE_AMOUNT2_EURO
       , RET_AMOUNT_ME
       , RET_AMOUNT_EURO
       , nvl(RET_DESCR3, '_') RET_DESCR3
       , nvl2(RET_EXTERNAL, case
                when(RET_EXTERNAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_EXTERNAL
       , nvl(FAL_LOT_PROGRESS_ID, -2) FAL_LOT_PROGRESS_ID
       , nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , RET_DURATION
       , nvl(RET_BEGIN_DATE, to_date('40000101', 'YYYYMMDD') ) RET_BEGIN_DATE
       , nvl(RET_END_DATE, to_date('40000101', 'YYYYMMDD') ) RET_END_DATE
       , nvl(RET_CHAR1_VALUE, '_') RET_CHAR1_VALUE
       , nvl(RET_CHAR2_VALUE, '_') RET_CHAR2_VALUE
       , nvl(RET_CHAR3_VALUE, '_') RET_CHAR3_VALUE
       , nvl(RET_CHAR4_VALUE, '_') RET_CHAR4_VALUE
       , nvl(RET_CHAR5_VALUE, '_') RET_CHAR5_VALUE
       , nvl(DIC_ASA_OPTION_ID, 'DWH_ISNULL') DIC_ASA_OPTION_ID
       , nvl(FAL_FACTORY_OUT_ID, -2) FAL_FACTORY_OUT_ID
       , nvl(GCO_ASA_TO_REPAIR_ID, -2) GCO_ASA_TO_REPAIR_ID
       , RET_FREE_NUM3
       , RET_FREE_NUM4
       , RET_FREE_NUM5
       , nvl(RET_FREE_CHAR3, '_') RET_FREE_CHAR3
       , nvl(RET_FREE_CHAR4, '_') RET_FREE_CHAR4
       , nvl(RET_FREE_CHAR5, '_') RET_FREE_CHAR5
    from ASA_RECORD_TASK
  union all
  select -1 ASA_RECORD_TASK_ID
       , -1 ASA_RECORD_ID
       , null RET_POSITION
       , '-1' RET_OPTIONAL
       , '-1' RET_GUARANTY_CODE
       , '-1' RET_FINISHED
       , null RET_TIME
       , null RET_TIME_USED
       , 'N/A' RET_DESCR
       , -1 FAL_TASK_ID
       , 'DWH_NA' DIC_OPERATOR_ID
       , -1 FAL_FACTORY_FLOOR_ID
       , null RET_WORK_RATE
       , null RET_SALE_AMOUNT
       , -1 GCO_BILL_GOOD_ID
       , null RET_COST_PRICE
       , null RET_AMOUNT
       , -1 ASA_RECORD_EVENTS_ID
       , 'DWH_NA' DIC_GARANTY_CODE_ID
       , 'DWH_NA' C_ASA_GEN_DOC_POS
       , 'N/A' RET_DESCR2
       , null RET_SALE_AMOUNT2
       , null RET_FREE_NUM1
       , null RET_FREE_NUM2
       , 'N/A' RET_FREE_CHAR1
       , 'N/A' RET_FREE_CHAR2
       , 'DWH_NA' DIC_ASA_FREE_DICO_TASK1_ID
       , 'DWH_NA' DIC_ASA_FREE_DICO_TASK2_ID
       , 'DWH_NA' C_ASA_ACCEPT_OPTION
       , null RET_SALE_AMOUNT_ME
       , null RET_SALE_AMOUNT_EURO
       , null RET_SALE_AMOUNT2_ME
       , null RET_SALE_AMOUNT2_EURO
       , null RET_AMOUNT_ME
       , null RET_AMOUNT_EURO
       , 'N/A' RET_DESCR3
       , '-1' RET_EXTERNAL
       , -1 FAL_LOT_PROGRESS_ID
       , -1 PAC_SUPPLIER_PARTNER_ID
       , null RET_DURATION
       , to_date('00010101', 'YYYYMMDD') RET_BEGIN_DATE
       , to_date('00010101', 'YYYYMMDD') RET_END_DATE
       , 'N/A' RET_CHAR1_VALUE
       , 'N/A' RET_CHAR2_VALUE
       , 'N/A' RET_CHAR3_VALUE
       , 'N/A' RET_CHAR4_VALUE
       , 'N/A' RET_CHAR5_VALUE
       , 'DWH_NA' DIC_ASA_OPTION_ID
       , -1 FAL_FACTORY_OUT_ID
       , -1 GCO_ASA_TO_REPAIR_ID
       , null RET_FREE_NUM3
       , null RET_FREE_NUM4
       , null RET_FREE_NUM5
       , 'N/A' RET_FREE_CHAR3
       , 'N/A' RET_FREE_CHAR4
       , 'N/A' RET_FREE_CHAR5
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_ASA_REP_TYPE" ("ASA_REP_TYPE_ID", "RET_REP_TYPE", "C_ASA_REP_TYPE_STATUS", "C_ASA_REP_TYPE_KIND", "PAC_SUPPLIER_PARTNER_ID", "DOC_RECORD_ID", "GCO_BILL_GOOD_ID", "DIC_ASA_REP_TYPE_CAT_ID", "RET_COST_PRICE_W", "RET_COST_PRICE_C", "RET_COST_PRICE_T", "RET_SALE_PRICE_W", "RET_SALE_PRICE_C", "RET_SALE_PRICE_T", "RET_FREE_TEXT1", "RET_FREE_TEXT2", "RET_FREE_TEXT3", "RET_FREE_TEXT4", "RET_FREE_TEXT5", "RET_FREE_BOOLEAN1", "RET_FREE_BOOLEAN2", "RET_FREE_BOOLEAN3", "RET_FREE_BOOLEAN4", "RET_FREE_BOOLEAN5", "RET_FREE_MEMO1", "RET_FREE_MEMO2", "RET_FREE_MEMO3", "RET_FREE_MEMO4", "RET_FREE_MEMO5", "RET_FREE_INTEGER1", "RET_FREE_INTEGER2", "RET_FREE_INTEGER3", "RET_FREE_INTEGER4", "RET_FREE_INTEGER5", "RET_FREE_CURRENCY1", "RET_FREE_CURRENCY2", "RET_FREE_CURRENCY3", "RET_FREE_CURRENCY4", "RET_FREE_CURRENCY5", "DIC_ASA_TYPE_FREE1_ID", "DIC_ASA_TYPE_FREE2_ID", "DIC_ASA_TYPE_FREE3_ID", "DIC_ASA_TYPE_FREE4_ID", "DIC_ASA_TYPE_FREE5_ID", "RET_COST_PRICE_S", "RET_SALE_PRICE_S", "GCO_SUPPLIER_GOOD_ID", "RET_NB_DAYS", "RET_RECALC_SALE_PRICE", "RET_RECALC_COST_PRICE", "RET_RECALC_SALE_PRICE_2", "RET_RECALC_COST_PRICE_2", "RET_USE_COMP", "RET_USE_TASK", "RET_LPOS_COMP_TASK", "C_ASA_GUARANTY_UNIT", "RET_GUARANTY", "C_ASA_DEVIS_CODE", "RET_MIN_DEVIS", "RET_PRICE_DEVIS", "GCO_DEVIS_BILL_GOOD_ID", "GCO_DEF_NOM_ID", "C_TYPE_NOM", "DIC_TARIFF_ID", "RET_MIN_SALE_PRICE", "RET_MAX_SALE_PRICE", "RET_NOM_VERSION", "DIC_TARIFF2_ID", "C_ASA_GEN_DOC_POS_COMP", "C_ASA_GEN_DOC_POS_TASK", "C_ASA_SELECT_PRICE", "DIC_DELAY_UPDATE_TYPE_ID", "RET_NB_DAYS_WAIT", "RET_NB_DAYS_CTRL", "RET_NB_DAYS_EXP", "RET_NB_DAYS_SENDING", "RET_QTY_MGM", "RET_INIT_BASE_DATA", "RET_INIT_PRICE", "RET_INIT_PRODUCT_DATA", "RET_INIT_EXTERNAL_DESCR", "RET_INIT_INTERNAL_DESCR", "RET_INIT_COMPONENT", "RET_INIT_TASK", "RET_INIT_FREE_DATA") AS
  select ASA_REP_TYPE_ID
       , nvl(RET_REP_TYPE, '_') RET_REP_TYPE
       , nvl(C_ASA_REP_TYPE_STATUS, 'DWH_ISNULL') C_ASA_REP_TYPE_STATUS
       , nvl(C_ASA_REP_TYPE_KIND, 'DWH_ISNULL') C_ASA_REP_TYPE_KIND
       , nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , nvl(GCO_BILL_GOOD_ID, -2) GCO_BILL_GOOD_ID
       , nvl(DIC_ASA_REP_TYPE_CAT_ID, 'DWH_ISNULL') DIC_ASA_REP_TYPE_CAT_ID
       , RET_COST_PRICE_W
       , RET_COST_PRICE_C
       , RET_COST_PRICE_T
       , RET_SALE_PRICE_W
       , RET_SALE_PRICE_C
       , RET_SALE_PRICE_T
       , nvl(RET_FREE_TEXT1, '_') RET_FREE_TEXT1
       , nvl(RET_FREE_TEXT2, '_') RET_FREE_TEXT2
       , nvl(RET_FREE_TEXT3, '_') RET_FREE_TEXT3
       , nvl(RET_FREE_TEXT4, '_') RET_FREE_TEXT4
       , nvl(RET_FREE_TEXT5, '_') RET_FREE_TEXT5
       , nvl2(RET_FREE_BOOLEAN1, case
                when(RET_FREE_BOOLEAN1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_FREE_BOOLEAN1
       , nvl2(RET_FREE_BOOLEAN2, case
                when(RET_FREE_BOOLEAN2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_FREE_BOOLEAN2
       , nvl2(RET_FREE_BOOLEAN3, case
                when(RET_FREE_BOOLEAN3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_FREE_BOOLEAN3
       , nvl2(RET_FREE_BOOLEAN4, case
                when(RET_FREE_BOOLEAN4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_FREE_BOOLEAN4
       , nvl2(RET_FREE_BOOLEAN5, case
                when(RET_FREE_BOOLEAN5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_FREE_BOOLEAN5
       , nvl(RET_FREE_MEMO1, '_') RET_FREE_MEMO1
       , nvl(RET_FREE_MEMO2, '_') RET_FREE_MEMO2
       , nvl(RET_FREE_MEMO3, '_') RET_FREE_MEMO3
       , nvl(RET_FREE_MEMO4, '_') RET_FREE_MEMO4
       , nvl(RET_FREE_MEMO5, '_') RET_FREE_MEMO5
       , RET_FREE_INTEGER1
       , RET_FREE_INTEGER2
       , RET_FREE_INTEGER3
       , RET_FREE_INTEGER4
       , RET_FREE_INTEGER5
       , RET_FREE_CURRENCY1
       , RET_FREE_CURRENCY2
       , RET_FREE_CURRENCY3
       , RET_FREE_CURRENCY4
       , RET_FREE_CURRENCY5
       , nvl(DIC_ASA_TYPE_FREE1_ID, 'DWH_ISNULL') DIC_ASA_TYPE_FREE1_ID
       , nvl(DIC_ASA_TYPE_FREE2_ID, 'DWH_ISNULL') DIC_ASA_TYPE_FREE2_ID
       , nvl(DIC_ASA_TYPE_FREE3_ID, 'DWH_ISNULL') DIC_ASA_TYPE_FREE3_ID
       , nvl(DIC_ASA_TYPE_FREE4_ID, 'DWH_ISNULL') DIC_ASA_TYPE_FREE4_ID
       , nvl(DIC_ASA_TYPE_FREE5_ID, 'DWH_ISNULL') DIC_ASA_TYPE_FREE5_ID
       , RET_COST_PRICE_S
       , RET_SALE_PRICE_S
       , nvl(GCO_SUPPLIER_GOOD_ID, -2) GCO_SUPPLIER_GOOD_ID
       , RET_NB_DAYS
       , nvl2(RET_RECALC_SALE_PRICE, case
                when(RET_RECALC_SALE_PRICE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_RECALC_SALE_PRICE
       , nvl2(RET_RECALC_COST_PRICE, case
                when(RET_RECALC_COST_PRICE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_RECALC_COST_PRICE
       , nvl2(RET_RECALC_SALE_PRICE_2, case
                when(RET_RECALC_SALE_PRICE_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_RECALC_SALE_PRICE_2
       , nvl2(RET_RECALC_COST_PRICE_2, case
                when(RET_RECALC_COST_PRICE_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_RECALC_COST_PRICE_2
       , nvl2(RET_USE_COMP, case
                when(RET_USE_COMP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_USE_COMP
       , nvl2(RET_USE_TASK, case
                when(RET_USE_TASK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_USE_TASK
       , nvl2(RET_LPOS_COMP_TASK, case
                when(RET_LPOS_COMP_TASK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_LPOS_COMP_TASK
       , nvl(C_ASA_GUARANTY_UNIT, 'DWH_ISNULL') C_ASA_GUARANTY_UNIT
       , RET_GUARANTY
       , nvl(C_ASA_DEVIS_CODE, 'DWH_ISNULL') C_ASA_DEVIS_CODE
       , RET_MIN_DEVIS
       , RET_PRICE_DEVIS
       , nvl(GCO_DEVIS_BILL_GOOD_ID, -2) GCO_DEVIS_BILL_GOOD_ID
       , nvl(GCO_DEF_NOM_ID, -2) GCO_DEF_NOM_ID
       , nvl(C_TYPE_NOM, 'DWH_ISNULL') C_TYPE_NOM
       , nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , RET_MIN_SALE_PRICE
       , RET_MAX_SALE_PRICE
       , nvl(RET_NOM_VERSION, '_') RET_NOM_VERSION
       , nvl(DIC_TARIFF2_ID, 'DWH_ISNULL') DIC_TARIFF2_ID
       , nvl(C_ASA_GEN_DOC_POS_COMP, 'DWH_ISNULL') C_ASA_GEN_DOC_POS_COMP
       , nvl(C_ASA_GEN_DOC_POS_TASK, 'DWH_ISNULL') C_ASA_GEN_DOC_POS_TASK
       , nvl(C_ASA_SELECT_PRICE, 'DWH_ISNULL') C_ASA_SELECT_PRICE
       , nvl(DIC_DELAY_UPDATE_TYPE_ID, 'DWH_ISNULL') DIC_DELAY_UPDATE_TYPE_ID
       , RET_NB_DAYS_WAIT
       , RET_NB_DAYS_CTRL
       , RET_NB_DAYS_EXP
       , RET_NB_DAYS_SENDING
       , nvl2(RET_QTY_MGM, case
                when(RET_QTY_MGM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_QTY_MGM
       , nvl2(RET_INIT_BASE_DATA, case
                when(RET_INIT_BASE_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_BASE_DATA
       , nvl2(RET_INIT_PRICE, case
                when(RET_INIT_PRICE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_PRICE
       , nvl2(RET_INIT_PRODUCT_DATA, case
                when(RET_INIT_PRODUCT_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_PRODUCT_DATA
       , nvl2(RET_INIT_EXTERNAL_DESCR, case
                when(RET_INIT_EXTERNAL_DESCR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_EXTERNAL_DESCR
       , nvl2(RET_INIT_INTERNAL_DESCR, case
                when(RET_INIT_INTERNAL_DESCR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_INTERNAL_DESCR
       , nvl2(RET_INIT_COMPONENT, case
                when(RET_INIT_COMPONENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_COMPONENT
       , nvl2(RET_INIT_TASK, case
                when(RET_INIT_TASK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_TASK
       , nvl2(RET_INIT_FREE_DATA, case
                when(RET_INIT_FREE_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RET_INIT_FREE_DATA
    from ASA_REP_TYPE
  union all
  select -1 ASA_REP_TYPE_ID
       , 'N/A' RET_REP_TYPE
       , 'DWH_NA' C_ASA_REP_TYPE_STATUS
       , 'DWH_NA' C_ASA_REP_TYPE_KIND
       , -1 PAC_SUPPLIER_PARTNER_ID
       , -1 DOC_RECORD_ID
       , -1 GCO_BILL_GOOD_ID
       , 'DWH_NA' DIC_ASA_REP_TYPE_CAT_ID
       , null RET_COST_PRICE_W
       , null RET_COST_PRICE_C
       , null RET_COST_PRICE_T
       , null RET_SALE_PRICE_W
       , null RET_SALE_PRICE_C
       , null RET_SALE_PRICE_T
       , 'N/A' RET_FREE_TEXT1
       , 'N/A' RET_FREE_TEXT2
       , 'N/A' RET_FREE_TEXT3
       , 'N/A' RET_FREE_TEXT4
       , 'N/A' RET_FREE_TEXT5
       , '-1' RET_FREE_BOOLEAN1
       , '-1' RET_FREE_BOOLEAN2
       , '-1' RET_FREE_BOOLEAN3
       , '-1' RET_FREE_BOOLEAN4
       , '-1' RET_FREE_BOOLEAN5
       , 'N/A' RET_FREE_MEMO1
       , 'N/A' RET_FREE_MEMO2
       , 'N/A' RET_FREE_MEMO3
       , 'N/A' RET_FREE_MEMO4
       , 'N/A' RET_FREE_MEMO5
       , null RET_FREE_INTEGER1
       , null RET_FREE_INTEGER2
       , null RET_FREE_INTEGER3
       , null RET_FREE_INTEGER4
       , null RET_FREE_INTEGER5
       , null RET_FREE_CURRENCY1
       , null RET_FREE_CURRENCY2
       , null RET_FREE_CURRENCY3
       , null RET_FREE_CURRENCY4
       , null RET_FREE_CURRENCY5
       , 'DWH_NA' DIC_ASA_TYPE_FREE1_ID
       , 'DWH_NA' DIC_ASA_TYPE_FREE2_ID
       , 'DWH_NA' DIC_ASA_TYPE_FREE3_ID
       , 'DWH_NA' DIC_ASA_TYPE_FREE4_ID
       , 'DWH_NA' DIC_ASA_TYPE_FREE5_ID
       , null RET_COST_PRICE_S
       , null RET_SALE_PRICE_S
       , -1 GCO_SUPPLIER_GOOD_ID
       , null RET_NB_DAYS
       , '-1' RET_RECALC_SALE_PRICE
       , '-1' RET_RECALC_COST_PRICE
       , '-1' RET_RECALC_SALE_PRICE_2
       , '-1' RET_RECALC_COST_PRICE_2
       , '-1' RET_USE_COMP
       , '-1' RET_USE_TASK
       , '-1' RET_LPOS_COMP_TASK
       , 'DWH_NA' C_ASA_GUARANTY_UNIT
       , null RET_GUARANTY
       , 'DWH_NA' C_ASA_DEVIS_CODE
       , null RET_MIN_DEVIS
       , null RET_PRICE_DEVIS
       , -1 GCO_DEVIS_BILL_GOOD_ID
       , -1 GCO_DEF_NOM_ID
       , 'DWH_NA' C_TYPE_NOM
       , 'DWH_NA' DIC_TARIFF_ID
       , null RET_MIN_SALE_PRICE
       , null RET_MAX_SALE_PRICE
       , 'N/A' RET_NOM_VERSION
       , 'DWH_NA' DIC_TARIFF2_ID
       , 'DWH_NA' C_ASA_GEN_DOC_POS_COMP
       , 'DWH_NA' C_ASA_GEN_DOC_POS_TASK
       , 'DWH_NA' C_ASA_SELECT_PRICE
       , 'DWH_NA' DIC_DELAY_UPDATE_TYPE_ID
       , null RET_NB_DAYS_WAIT
       , null RET_NB_DAYS_CTRL
       , null RET_NB_DAYS_EXP
       , null RET_NB_DAYS_SENDING
       , '-1' RET_QTY_MGM
       , '-1' RET_INIT_BASE_DATA
       , '-1' RET_INIT_PRICE
       , '-1' RET_INIT_PRODUCT_DATA
       , '-1' RET_INIT_EXTERNAL_DESCR
       , '-1' RET_INIT_INTERNAL_DESCR
       , '-1' RET_INIT_COMPONENT
       , '-1' RET_INIT_TASK
       , '-1' RET_INIT_FREE_DATA
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_CLASSIFICATION" ("CLASSIFICATION_ID", "CLA_DESCR", "CLA_MULTIPLE_LEAVES_INSTANCES", "CLA_MULTIPLE_NODES_INSTANCES", "CLA_LEVEL_DISPLAY", "CLA_MULTI_TABLES", "CLA_TRANSLATED", "CLA_USES_CODE", "CLA_CODE_FORMAT", "CLA_MODIFIED_CLASSIF", "CLA_LAST_FLAT_DATE", "CLA_FLAT_CLASSIF", "PC_OBJECT_ID", "C_CLASSIF_TYPE", "CLA_KEY", "CLA_TABLENAME", "CLA_UNIQUE_KEY") AS
  select CLASSIFICATION_ID
       , Nvl(CLA_DESCR, '_') CLA_DESCR
       , Nvl2(CLA_MULTIPLE_LEAVES_INSTANCES
            , case
                when(CLA_MULTIPLE_LEAVES_INSTANCES = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end
            , '-2'
             ) CLA_MULTIPLE_LEAVES_INSTANCES
       , Nvl2(CLA_MULTIPLE_NODES_INSTANCES, case
                when(CLA_MULTIPLE_NODES_INSTANCES = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_MULTIPLE_NODES_INSTANCES
       , Nvl2(CLA_LEVEL_DISPLAY, case
                when(CLA_LEVEL_DISPLAY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_LEVEL_DISPLAY
       , Nvl2(CLA_MULTI_TABLES, case
                when(CLA_MULTI_TABLES = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_MULTI_TABLES
       , Nvl2(CLA_TRANSLATED, case
                when(CLA_TRANSLATED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_TRANSLATED
       , Nvl2(CLA_USES_CODE, case
                when(CLA_USES_CODE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_USES_CODE
       , Nvl(CLA_CODE_FORMAT, '_') CLA_CODE_FORMAT
       , Nvl2(CLA_MODIFIED_CLASSIF, case
                when(CLA_MODIFIED_CLASSIF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_MODIFIED_CLASSIF
       , Nvl(CLA_LAST_FLAT_DATE, to_date('40000101', 'YYYYMMDD') ) CLA_LAST_FLAT_DATE
       , Nvl2(CLA_FLAT_CLASSIF, case
                when(CLA_FLAT_CLASSIF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CLA_FLAT_CLASSIF
       , Nvl(PC_OBJECT_ID, -2) PC_OBJECT_ID
       , Nvl(C_CLASSIF_TYPE, 'DWH_ISNULL') C_CLASSIF_TYPE
       , Nvl(CLA_KEY, '_') CLA_KEY
       , Nvl(CLA_TABLENAME, '_') CLA_TABLENAME
       , Nvl(CLA_UNIQUE_KEY, '_') CLA_UNIQUE_KEY
  from CLASSIFICATION
  union all
  select -1 CLASSIFICATION_ID
       , 'N/A' CLA_DESCR
       , '-1' CLA_MULTIPLE_LEAVES_INSTANCES
       , '-1' CLA_MULTIPLE_NODES_INSTANCES
       , '-1' CLA_LEVEL_DISPLAY
       , '-1' CLA_MULTI_TABLES
       , '-1' CLA_TRANSLATED
       , '-1' CLA_USES_CODE
       , 'N/A' CLA_CODE_FORMAT
       , '-1' CLA_MODIFIED_CLASSIF
       , to_date('00010101', 'YYYYMMDD') CLA_LAST_FLAT_DATE
       , '-1' CLA_FLAT_CLASSIF
       , -1 PC_OBJECT_ID
       , 'DWH_NA' C_CLASSIF_TYPE
       , 'N/A' CLA_KEY
       , 'N/A' CLA_TABLENAME
       , 'N/A' CLA_UNIQUE_KEY
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_CLASSIF_FLAT" ("CLASSIF_FLAT_ID", "CLASSIFICATION_ID", "NODE01", "NODE02", "NODE03", "NODE04", "NODE05", "NODE06", "NODE07", "NODE08", "NODE09", "NODE10", "NODE11", "NODE12", "NODE13", "NODE14", "NODE15", "NODE16", "NODE17", "NODE18", "NODE19", "NODE20", "CLASSIF_LEAF_ID", "CFL_NODE_ID", "PC_LANG_ID", "LEAF_DESCR") AS
  select CLASSIF_FLAT_ID
       , Nvl(CLASSIFICATION_ID, -2) CLASSIFICATION_ID
       , Nvl(NODE01, '_') NODE01
       , Nvl(NODE02, '_') NODE02
       , Nvl(NODE03, '_') NODE03
       , Nvl(NODE04, '_') NODE04
       , Nvl(NODE05, '_') NODE05
       , Nvl(NODE06, '_') NODE06
       , Nvl(NODE07, '_') NODE07
       , Nvl(NODE08, '_') NODE08
       , Nvl(NODE09, '_') NODE09
       , Nvl(NODE10, '_') NODE10
       , Nvl(NODE11, '_') NODE11
       , Nvl(NODE12, '_') NODE12
       , Nvl(NODE13, '_') NODE13
       , Nvl(NODE14, '_') NODE14
       , Nvl(NODE15, '_') NODE15
       , Nvl(NODE16, '_') NODE16
       , Nvl(NODE17, '_') NODE17
       , Nvl(NODE18, '_') NODE18
       , Nvl(NODE19, '_') NODE19
       , Nvl(NODE20, '_') NODE20
       , Nvl(CLASSIF_LEAF_ID, -2) CLASSIF_LEAF_ID
       , Nvl(CFL_NODE_ID, -2) CFL_NODE_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(LEAF_DESCR, '_') LEAF_DESCR
  from CLASSIF_FLAT
  union all
  select -1 CLASSIF_FLAT_ID
       , -1 CLASSIFICATION_ID
       , 'N/A' NODE01
       , 'N/A' NODE02
       , 'N/A' NODE03
       , 'N/A' NODE04
       , 'N/A' NODE05
       , 'N/A' NODE06
       , 'N/A' NODE07
       , 'N/A' NODE08
       , 'N/A' NODE09
       , 'N/A' NODE10
       , 'N/A' NODE11
       , 'N/A' NODE12
       , 'N/A' NODE13
       , 'N/A' NODE14
       , 'N/A' NODE15
       , 'N/A' NODE16
       , 'N/A' NODE17
       , 'N/A' NODE18
       , 'N/A' NODE19
       , 'N/A' NODE20
       , -1 CLASSIF_LEAF_ID
       , -1 CFL_NODE_ID
       , -1 PC_LANG_ID
       , 'N/A' LEAF_DESCR
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_COM_VFIELDS_RECORD" ("COM_VFIELDS_RECORD_ID", "VFI_TABNAME", "VFI_REC_ID", "VFI_INTEGER_01", "VFI_INTEGER_02", "VFI_INTEGER_03", "VFI_INTEGER_04", "VFI_INTEGER_05", "VFI_INTEGER_06", "VFI_INTEGER_07", "VFI_INTEGER_08", "VFI_INTEGER_09", "VFI_INTEGER_10", "VFI_INTEGER_11", "VFI_INTEGER_12", "VFI_INTEGER_13", "VFI_INTEGER_14", "VFI_INTEGER_15", "VFI_INTEGER_16", "VFI_INTEGER_17", "VFI_INTEGER_18", "VFI_INTEGER_19", "VFI_INTEGER_20", "VFI_INTEGER_21", "VFI_INTEGER_22", "VFI_INTEGER_23", "VFI_INTEGER_24", "VFI_INTEGER_25", "VFI_INTEGER_26", "VFI_INTEGER_27", "VFI_INTEGER_28", "VFI_INTEGER_29", "VFI_INTEGER_30", "VFI_FLOAT_01", "VFI_FLOAT_02", "VFI_FLOAT_03", "VFI_FLOAT_04", "VFI_FLOAT_05", "VFI_FLOAT_06", "VFI_FLOAT_07", "VFI_FLOAT_08", "VFI_FLOAT_09", "VFI_FLOAT_10", "VFI_FLOAT_11", "VFI_FLOAT_12", "VFI_FLOAT_13", "VFI_FLOAT_14", "VFI_FLOAT_15", "VFI_FLOAT_16", "VFI_FLOAT_17", "VFI_FLOAT_18", "VFI_FLOAT_19", "VFI_FLOAT_20", "VFI_FLOAT_21", "VFI_FLOAT_22", "VFI_FLOAT_23", "VFI_FLOAT_24", "VFI_FLOAT_25", "VFI_FLOAT_26", "VFI_FLOAT_27", "VFI_FLOAT_28", "VFI_FLOAT_29", "VFI_FLOAT_30", "VFI_BOOLEAN_01", "VFI_BOOLEAN_02", "VFI_BOOLEAN_03", "VFI_BOOLEAN_04", "VFI_BOOLEAN_05", "VFI_BOOLEAN_06", "VFI_BOOLEAN_07", "VFI_BOOLEAN_08", "VFI_BOOLEAN_09", "VFI_BOOLEAN_10", "VFI_BOOLEAN_11", "VFI_BOOLEAN_12", "VFI_BOOLEAN_13", "VFI_BOOLEAN_14", "VFI_BOOLEAN_15", "VFI_BOOLEAN_16", "VFI_BOOLEAN_17", "VFI_BOOLEAN_18", "VFI_BOOLEAN_19", "VFI_BOOLEAN_20", "VFI_BOOLEAN_21", "VFI_BOOLEAN_22", "VFI_BOOLEAN_23", "VFI_BOOLEAN_24", "VFI_BOOLEAN_25", "VFI_BOOLEAN_26", "VFI_BOOLEAN_27", "VFI_BOOLEAN_28", "VFI_BOOLEAN_29", "VFI_BOOLEAN_30", "VFI_CHAR_01", "VFI_CHAR_02", "VFI_CHAR_03", "VFI_CHAR_04", "VFI_CHAR_05", "VFI_CHAR_06", "VFI_CHAR_07", "VFI_CHAR_08", "VFI_CHAR_09", "VFI_CHAR_10", "VFI_CHAR_11", "VFI_CHAR_12", "VFI_CHAR_13", "VFI_CHAR_14", "VFI_CHAR_15", "VFI_CHAR_16", "VFI_CHAR_17", "VFI_CHAR_18", "VFI_CHAR_19", "VFI_CHAR_20", "VFI_CHAR_21", "VFI_CHAR_22", "VFI_CHAR_23", "VFI_CHAR_24", "VFI_CHAR_25", "VFI_CHAR_26", "VFI_CHAR_27", "VFI_CHAR_28", "VFI_CHAR_29", "VFI_CHAR_30", "VFI_MEMO_01", "VFI_MEMO_02", "VFI_MEMO_03", "VFI_MEMO_04", "VFI_MEMO_05", "VFI_MEMO_06", "VFI_MEMO_07", "VFI_MEMO_08", "VFI_MEMO_09", "VFI_MEMO_10", "VFI_MEMO_11", "VFI_MEMO_12", "VFI_MEMO_13", "VFI_MEMO_14", "VFI_MEMO_15", "VFI_MEMO_16", "VFI_MEMO_17", "VFI_MEMO_18", "VFI_MEMO_19", "VFI_MEMO_20", "VFI_MEMO_21", "VFI_MEMO_22", "VFI_MEMO_23", "VFI_MEMO_24", "VFI_MEMO_25", "VFI_MEMO_26", "VFI_MEMO_27", "VFI_MEMO_28", "VFI_MEMO_29", "VFI_MEMO_30", "VFI_DATE_01", "VFI_DATE_02", "VFI_DATE_03", "VFI_DATE_04", "VFI_DATE_05", "VFI_DATE_06", "VFI_DATE_07", "VFI_DATE_08", "VFI_DATE_09", "VFI_DATE_10", "VFI_DATE_11", "VFI_DATE_12", "VFI_DATE_13", "VFI_DATE_14", "VFI_DATE_15", "VFI_DATE_16", "VFI_DATE_17", "VFI_DATE_18", "VFI_DATE_19", "VFI_DATE_20", "VFI_DATE_21", "VFI_DATE_22", "VFI_DATE_23", "VFI_DATE_24", "VFI_DATE_25", "VFI_DATE_26", "VFI_DATE_27", "VFI_DATE_28", "VFI_DATE_29", "VFI_DATE_30", "VFI_DESCODES_01", "VFI_DESCODES_02", "VFI_DESCODES_03", "VFI_DESCODES_04", "VFI_DESCODES_05", "VFI_DESCODES_06", "VFI_DESCODES_07", "VFI_DESCODES_08", "VFI_DESCODES_09", "VFI_DESCODES_10", "VFI_DESCODES_11", "VFI_DESCODES_12", "VFI_DESCODES_13", "VFI_DESCODES_14", "VFI_DESCODES_15", "VFI_DESCODES_16", "VFI_DESCODES_17", "VFI_DESCODES_18", "VFI_DESCODES_19", "VFI_DESCODES_20", "VFI_DESCODES_21", "VFI_DESCODES_22", "VFI_DESCODES_23", "VFI_DESCODES_24", "VFI_DESCODES_25", "VFI_DESCODES_26", "VFI_DESCODES_27", "VFI_DESCODES_28", "VFI_DESCODES_29", "VFI_DESCODES_30", "VFI_INTEGER_31", "VFI_INTEGER_32", "VFI_INTEGER_33", "VFI_INTEGER_34", "VFI_INTEGER_35", "VFI_INTEGER_36", "VFI_INTEGER_37", "VFI_INTEGER_38", "VFI_INTEGER_39", "VFI_INTEGER_40", "VFI_FLOAT_31", "VFI_FLOAT_32", "VFI_FLOAT_33", "VFI_FLOAT_34", "VFI_FLOAT_35", "VFI_FLOAT_36", "VFI_FLOAT_37", "VFI_FLOAT_38", "VFI_FLOAT_39", "VFI_FLOAT_40", "VFI_BOOLEAN_31", "VFI_BOOLEAN_32", "VFI_BOOLEAN_33", "VFI_BOOLEAN_34", "VFI_BOOLEAN_35", "VFI_BOOLEAN_36", "VFI_BOOLEAN_37", "VFI_BOOLEAN_38", "VFI_BOOLEAN_39", "VFI_BOOLEAN_40", "VFI_CHAR_31", "VFI_CHAR_32", "VFI_CHAR_33", "VFI_CHAR_34", "VFI_CHAR_35", "VFI_CHAR_36", "VFI_CHAR_37", "VFI_CHAR_38", "VFI_CHAR_39", "VFI_CHAR_40", "VFI_MEMO_31", "VFI_MEMO_32", "VFI_MEMO_33", "VFI_MEMO_34", "VFI_MEMO_35", "VFI_MEMO_36", "VFI_MEMO_37", "VFI_MEMO_38", "VFI_MEMO_39", "VFI_MEMO_40", "VFI_DATE_31", "VFI_DATE_32", "VFI_DATE_33", "VFI_DATE_34", "VFI_DATE_35", "VFI_DATE_36", "VFI_DATE_37", "VFI_DATE_38", "VFI_DATE_39", "VFI_DATE_40", "VFI_DESCODES_31", "VFI_DESCODES_32", "VFI_DESCODES_33", "VFI_DESCODES_34", "VFI_DESCODES_35", "VFI_DESCODES_36", "VFI_DESCODES_37", "VFI_DESCODES_38", "VFI_DESCODES_39", "VFI_DESCODES_40") AS
  select COM_VFIELDS_RECORD_ID
       , nvl(VFI_TABNAME, '_') VFI_TABNAME
       , nvl(VFI_REC_ID, -2) VFI_REC_ID
       , VFI_INTEGER_01
       , VFI_INTEGER_02
       , VFI_INTEGER_03
       , VFI_INTEGER_04
       , VFI_INTEGER_05
       , VFI_INTEGER_06
       , VFI_INTEGER_07
       , VFI_INTEGER_08
       , VFI_INTEGER_09
       , VFI_INTEGER_10
       , VFI_INTEGER_11
       , VFI_INTEGER_12
       , VFI_INTEGER_13
       , VFI_INTEGER_14
       , VFI_INTEGER_15
       , VFI_INTEGER_16
       , VFI_INTEGER_17
       , VFI_INTEGER_18
       , VFI_INTEGER_19
       , VFI_INTEGER_20
       , VFI_INTEGER_21
       , VFI_INTEGER_22
       , VFI_INTEGER_23
       , VFI_INTEGER_24
       , VFI_INTEGER_25
       , VFI_INTEGER_26
       , VFI_INTEGER_27
       , VFI_INTEGER_28
       , VFI_INTEGER_29
       , VFI_INTEGER_30
       , VFI_FLOAT_01
       , VFI_FLOAT_02
       , VFI_FLOAT_03
       , VFI_FLOAT_04
       , VFI_FLOAT_05
       , VFI_FLOAT_06
       , VFI_FLOAT_07
       , VFI_FLOAT_08
       , VFI_FLOAT_09
       , VFI_FLOAT_10
       , VFI_FLOAT_11
       , VFI_FLOAT_12
       , VFI_FLOAT_13
       , VFI_FLOAT_14
       , VFI_FLOAT_15
       , VFI_FLOAT_16
       , VFI_FLOAT_17
       , VFI_FLOAT_18
       , VFI_FLOAT_19
       , VFI_FLOAT_20
       , VFI_FLOAT_21
       , VFI_FLOAT_22
       , VFI_FLOAT_23
       , VFI_FLOAT_24
       , VFI_FLOAT_25
       , VFI_FLOAT_26
       , VFI_FLOAT_27
       , VFI_FLOAT_28
       , VFI_FLOAT_29
       , VFI_FLOAT_30
       , nvl2(VFI_BOOLEAN_01, case
                when(VFI_BOOLEAN_01 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_01
       , nvl2(VFI_BOOLEAN_02, case
                when(VFI_BOOLEAN_02 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_02
       , nvl2(VFI_BOOLEAN_03, case
                when(VFI_BOOLEAN_03 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_03
       , nvl2(VFI_BOOLEAN_04, case
                when(VFI_BOOLEAN_04 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_04
       , nvl2(VFI_BOOLEAN_05, case
                when(VFI_BOOLEAN_05 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_05
       , nvl2(VFI_BOOLEAN_06, case
                when(VFI_BOOLEAN_06 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_06
       , nvl2(VFI_BOOLEAN_07, case
                when(VFI_BOOLEAN_07 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_07
       , nvl2(VFI_BOOLEAN_08, case
                when(VFI_BOOLEAN_08 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_08
       , nvl2(VFI_BOOLEAN_09, case
                when(VFI_BOOLEAN_09 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_09
       , nvl2(VFI_BOOLEAN_10, case
                when(VFI_BOOLEAN_10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_10
       , nvl2(VFI_BOOLEAN_11, case
                when(VFI_BOOLEAN_11 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_11
       , nvl2(VFI_BOOLEAN_12, case
                when(VFI_BOOLEAN_12 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_12
       , nvl2(VFI_BOOLEAN_13, case
                when(VFI_BOOLEAN_13 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_13
       , nvl2(VFI_BOOLEAN_14, case
                when(VFI_BOOLEAN_14 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_14
       , nvl2(VFI_BOOLEAN_15, case
                when(VFI_BOOLEAN_15 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_15
       , nvl2(VFI_BOOLEAN_16, case
                when(VFI_BOOLEAN_16 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_16
       , nvl2(VFI_BOOLEAN_17, case
                when(VFI_BOOLEAN_17 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_17
       , nvl2(VFI_BOOLEAN_18, case
                when(VFI_BOOLEAN_18 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_18
       , nvl2(VFI_BOOLEAN_19, case
                when(VFI_BOOLEAN_19 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_19
       , nvl2(VFI_BOOLEAN_20, case
                when(VFI_BOOLEAN_20 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_20
       , nvl2(VFI_BOOLEAN_21, case
                when(VFI_BOOLEAN_21 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_21
       , nvl2(VFI_BOOLEAN_22, case
                when(VFI_BOOLEAN_22 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_22
       , nvl2(VFI_BOOLEAN_23, case
                when(VFI_BOOLEAN_23 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_23
       , nvl2(VFI_BOOLEAN_24, case
                when(VFI_BOOLEAN_24 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_24
       , nvl2(VFI_BOOLEAN_25, case
                when(VFI_BOOLEAN_25 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_25
       , nvl2(VFI_BOOLEAN_26, case
                when(VFI_BOOLEAN_26 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_26
       , nvl2(VFI_BOOLEAN_27, case
                when(VFI_BOOLEAN_27 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_27
       , nvl2(VFI_BOOLEAN_28, case
                when(VFI_BOOLEAN_28 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_28
       , nvl2(VFI_BOOLEAN_29, case
                when(VFI_BOOLEAN_29 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_29
       , nvl2(VFI_BOOLEAN_30, case
                when(VFI_BOOLEAN_30 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_30
       , nvl(VFI_CHAR_01, '_') VFI_CHAR_01
       , nvl(VFI_CHAR_02, '_') VFI_CHAR_02
       , nvl(VFI_CHAR_03, '_') VFI_CHAR_03
       , nvl(VFI_CHAR_04, '_') VFI_CHAR_04
       , nvl(VFI_CHAR_05, '_') VFI_CHAR_05
       , nvl(VFI_CHAR_06, '_') VFI_CHAR_06
       , nvl(VFI_CHAR_07, '_') VFI_CHAR_07
       , nvl(VFI_CHAR_08, '_') VFI_CHAR_08
       , nvl(VFI_CHAR_09, '_') VFI_CHAR_09
       , nvl(VFI_CHAR_10, '_') VFI_CHAR_10
       , nvl(VFI_CHAR_11, '_') VFI_CHAR_11
       , nvl(VFI_CHAR_12, '_') VFI_CHAR_12
       , nvl(VFI_CHAR_13, '_') VFI_CHAR_13
       , nvl(VFI_CHAR_14, '_') VFI_CHAR_14
       , nvl(VFI_CHAR_15, '_') VFI_CHAR_15
       , nvl(VFI_CHAR_16, '_') VFI_CHAR_16
       , nvl(VFI_CHAR_17, '_') VFI_CHAR_17
       , nvl(VFI_CHAR_18, '_') VFI_CHAR_18
       , nvl(VFI_CHAR_19, '_') VFI_CHAR_19
       , nvl(VFI_CHAR_20, '_') VFI_CHAR_20
       , nvl(VFI_CHAR_21, '_') VFI_CHAR_21
       , nvl(VFI_CHAR_22, '_') VFI_CHAR_22
       , nvl(VFI_CHAR_23, '_') VFI_CHAR_23
       , nvl(VFI_CHAR_24, '_') VFI_CHAR_24
       , nvl(VFI_CHAR_25, '_') VFI_CHAR_25
       , nvl(VFI_CHAR_26, '_') VFI_CHAR_26
       , nvl(VFI_CHAR_27, '_') VFI_CHAR_27
       , nvl(VFI_CHAR_28, '_') VFI_CHAR_28
       , nvl(VFI_CHAR_29, '_') VFI_CHAR_29
       , nvl(VFI_CHAR_30, '_') VFI_CHAR_30
       , nvl(VFI_MEMO_01, '_') VFI_MEMO_01
       , nvl(VFI_MEMO_02, '_') VFI_MEMO_02
       , nvl(VFI_MEMO_03, '_') VFI_MEMO_03
       , nvl(VFI_MEMO_04, '_') VFI_MEMO_04
       , nvl(VFI_MEMO_05, '_') VFI_MEMO_05
       , nvl(VFI_MEMO_06, '_') VFI_MEMO_06
       , nvl(VFI_MEMO_07, '_') VFI_MEMO_07
       , nvl(VFI_MEMO_08, '_') VFI_MEMO_08
       , nvl(VFI_MEMO_09, '_') VFI_MEMO_09
       , nvl(VFI_MEMO_10, '_') VFI_MEMO_10
       , nvl(VFI_MEMO_11, '_') VFI_MEMO_11
       , nvl(VFI_MEMO_12, '_') VFI_MEMO_12
       , nvl(VFI_MEMO_13, '_') VFI_MEMO_13
       , nvl(VFI_MEMO_14, '_') VFI_MEMO_14
       , nvl(VFI_MEMO_15, '_') VFI_MEMO_15
       , nvl(VFI_MEMO_16, '_') VFI_MEMO_16
       , nvl(VFI_MEMO_17, '_') VFI_MEMO_17
       , nvl(VFI_MEMO_18, '_') VFI_MEMO_18
       , nvl(VFI_MEMO_19, '_') VFI_MEMO_19
       , nvl(VFI_MEMO_20, '_') VFI_MEMO_20
       , nvl(VFI_MEMO_21, '_') VFI_MEMO_21
       , nvl(VFI_MEMO_22, '_') VFI_MEMO_22
       , nvl(VFI_MEMO_23, '_') VFI_MEMO_23
       , nvl(VFI_MEMO_24, '_') VFI_MEMO_24
       , nvl(VFI_MEMO_25, '_') VFI_MEMO_25
       , nvl(VFI_MEMO_26, '_') VFI_MEMO_26
       , nvl(VFI_MEMO_27, '_') VFI_MEMO_27
       , nvl(VFI_MEMO_28, '_') VFI_MEMO_28
       , nvl(VFI_MEMO_29, '_') VFI_MEMO_29
       , nvl(VFI_MEMO_30, '_') VFI_MEMO_30
       , nvl(VFI_DATE_01, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_01
       , nvl(VFI_DATE_02, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_02
       , nvl(VFI_DATE_03, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_03
       , nvl(VFI_DATE_04, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_04
       , nvl(VFI_DATE_05, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_05
       , nvl(VFI_DATE_06, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_06
       , nvl(VFI_DATE_07, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_07
       , nvl(VFI_DATE_08, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_08
       , nvl(VFI_DATE_09, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_09
       , nvl(VFI_DATE_10, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_10
       , nvl(VFI_DATE_11, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_11
       , nvl(VFI_DATE_12, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_12
       , nvl(VFI_DATE_13, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_13
       , nvl(VFI_DATE_14, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_14
       , nvl(VFI_DATE_15, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_15
       , nvl(VFI_DATE_16, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_16
       , nvl(VFI_DATE_17, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_17
       , nvl(VFI_DATE_18, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_18
       , nvl(VFI_DATE_19, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_19
       , nvl(VFI_DATE_20, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_20
       , nvl(VFI_DATE_21, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_21
       , nvl(VFI_DATE_22, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_22
       , nvl(VFI_DATE_23, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_23
       , nvl(VFI_DATE_24, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_24
       , nvl(VFI_DATE_25, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_25
       , nvl(VFI_DATE_26, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_26
       , nvl(VFI_DATE_27, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_27
       , nvl(VFI_DATE_28, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_28
       , nvl(VFI_DATE_29, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_29
       , nvl(VFI_DATE_30, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_30
       , nvl(VFI_DESCODES_01, '_') VFI_DESCODES_01
       , nvl(VFI_DESCODES_02, '_') VFI_DESCODES_02
       , nvl(VFI_DESCODES_03, '_') VFI_DESCODES_03
       , nvl(VFI_DESCODES_04, '_') VFI_DESCODES_04
       , nvl(VFI_DESCODES_05, '_') VFI_DESCODES_05
       , nvl(VFI_DESCODES_06, '_') VFI_DESCODES_06
       , nvl(VFI_DESCODES_07, '_') VFI_DESCODES_07
       , nvl(VFI_DESCODES_08, '_') VFI_DESCODES_08
       , nvl(VFI_DESCODES_09, '_') VFI_DESCODES_09
       , nvl(VFI_DESCODES_10, '_') VFI_DESCODES_10
       , nvl(VFI_DESCODES_11, '_') VFI_DESCODES_11
       , nvl(VFI_DESCODES_12, '_') VFI_DESCODES_12
       , nvl(VFI_DESCODES_13, '_') VFI_DESCODES_13
       , nvl(VFI_DESCODES_14, '_') VFI_DESCODES_14
       , nvl(VFI_DESCODES_15, '_') VFI_DESCODES_15
       , nvl(VFI_DESCODES_16, '_') VFI_DESCODES_16
       , nvl(VFI_DESCODES_17, '_') VFI_DESCODES_17
       , nvl(VFI_DESCODES_18, '_') VFI_DESCODES_18
       , nvl(VFI_DESCODES_19, '_') VFI_DESCODES_19
       , nvl(VFI_DESCODES_20, '_') VFI_DESCODES_20
       , nvl(VFI_DESCODES_21, '_') VFI_DESCODES_21
       , nvl(VFI_DESCODES_22, '_') VFI_DESCODES_22
       , nvl(VFI_DESCODES_23, '_') VFI_DESCODES_23
       , nvl(VFI_DESCODES_24, '_') VFI_DESCODES_24
       , nvl(VFI_DESCODES_25, '_') VFI_DESCODES_25
       , nvl(VFI_DESCODES_26, '_') VFI_DESCODES_26
       , nvl(VFI_DESCODES_27, '_') VFI_DESCODES_27
       , nvl(VFI_DESCODES_28, '_') VFI_DESCODES_28
       , nvl(VFI_DESCODES_29, '_') VFI_DESCODES_29
       , nvl(VFI_DESCODES_30, '_') VFI_DESCODES_30
       , VFI_INTEGER_31
       , VFI_INTEGER_32
       , VFI_INTEGER_33
       , VFI_INTEGER_34
       , VFI_INTEGER_35
       , VFI_INTEGER_36
       , VFI_INTEGER_37
       , VFI_INTEGER_38
       , VFI_INTEGER_39
       , VFI_INTEGER_40
       , VFI_FLOAT_31
       , VFI_FLOAT_32
       , VFI_FLOAT_33
       , VFI_FLOAT_34
       , VFI_FLOAT_35
       , VFI_FLOAT_36
       , VFI_FLOAT_37
       , VFI_FLOAT_38
       , VFI_FLOAT_39
       , VFI_FLOAT_40
       , nvl2(VFI_BOOLEAN_31, case
                when(VFI_BOOLEAN_31 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_31
       , nvl2(VFI_BOOLEAN_32, case
                when(VFI_BOOLEAN_32 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_32
       , nvl2(VFI_BOOLEAN_33, case
                when(VFI_BOOLEAN_33 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_33
       , nvl2(VFI_BOOLEAN_34, case
                when(VFI_BOOLEAN_34 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_34
       , nvl2(VFI_BOOLEAN_35, case
                when(VFI_BOOLEAN_35 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_35
       , nvl2(VFI_BOOLEAN_36, case
                when(VFI_BOOLEAN_36 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_36
       , nvl2(VFI_BOOLEAN_37, case
                when(VFI_BOOLEAN_37 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_37
       , nvl2(VFI_BOOLEAN_38, case
                when(VFI_BOOLEAN_38 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_38
       , nvl2(VFI_BOOLEAN_39, case
                when(VFI_BOOLEAN_39 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_39
       , nvl2(VFI_BOOLEAN_40, case
                when(VFI_BOOLEAN_40 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') VFI_BOOLEAN_40
       , nvl(VFI_CHAR_31, '_') VFI_CHAR_31
       , nvl(VFI_CHAR_32, '_') VFI_CHAR_32
       , nvl(VFI_CHAR_33, '_') VFI_CHAR_33
       , nvl(VFI_CHAR_34, '_') VFI_CHAR_34
       , nvl(VFI_CHAR_35, '_') VFI_CHAR_35
       , nvl(VFI_CHAR_36, '_') VFI_CHAR_36
       , nvl(VFI_CHAR_37, '_') VFI_CHAR_37
       , nvl(VFI_CHAR_38, '_') VFI_CHAR_38
       , nvl(VFI_CHAR_39, '_') VFI_CHAR_39
       , nvl(VFI_CHAR_40, '_') VFI_CHAR_40
       , nvl(VFI_MEMO_31, '_') VFI_MEMO_31
       , nvl(VFI_MEMO_32, '_') VFI_MEMO_32
       , nvl(VFI_MEMO_33, '_') VFI_MEMO_33
       , nvl(VFI_MEMO_34, '_') VFI_MEMO_34
       , nvl(VFI_MEMO_35, '_') VFI_MEMO_35
       , nvl(VFI_MEMO_36, '_') VFI_MEMO_36
       , nvl(VFI_MEMO_37, '_') VFI_MEMO_37
       , nvl(VFI_MEMO_38, '_') VFI_MEMO_38
       , nvl(VFI_MEMO_39, '_') VFI_MEMO_39
       , nvl(VFI_MEMO_40, '_') VFI_MEMO_40
       , nvl(VFI_DATE_31, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_31
       , nvl(VFI_DATE_32, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_32
       , nvl(VFI_DATE_33, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_33
       , nvl(VFI_DATE_34, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_34
       , nvl(VFI_DATE_35, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_35
       , nvl(VFI_DATE_36, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_36
       , nvl(VFI_DATE_37, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_37
       , nvl(VFI_DATE_38, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_38
       , nvl(VFI_DATE_39, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_39
       , nvl(VFI_DATE_40, to_date('40000101', 'YYYYMMDD') ) VFI_DATE_40
       , nvl(VFI_DESCODES_31, '_') VFI_DESCODES_31
       , nvl(VFI_DESCODES_32, '_') VFI_DESCODES_32
       , nvl(VFI_DESCODES_33, '_') VFI_DESCODES_33
       , nvl(VFI_DESCODES_34, '_') VFI_DESCODES_34
       , nvl(VFI_DESCODES_35, '_') VFI_DESCODES_35
       , nvl(VFI_DESCODES_36, '_') VFI_DESCODES_36
       , nvl(VFI_DESCODES_37, '_') VFI_DESCODES_37
       , nvl(VFI_DESCODES_38, '_') VFI_DESCODES_38
       , nvl(VFI_DESCODES_39, '_') VFI_DESCODES_39
       , nvl(VFI_DESCODES_40, '_') VFI_DESCODES_40
    from COM_VFIELDS_RECORD
  union all
  select -1 COM_VFIELDS_RECORD_ID
       , 'N/A' VFI_TABNAME
       , -1 VFI_REC_ID
       , null VFI_INTEGER_01
       , null VFI_INTEGER_02
       , null VFI_INTEGER_03
       , null VFI_INTEGER_04
       , null VFI_INTEGER_05
       , null VFI_INTEGER_06
       , null VFI_INTEGER_07
       , null VFI_INTEGER_08
       , null VFI_INTEGER_09
       , null VFI_INTEGER_10
       , null VFI_INTEGER_11
       , null VFI_INTEGER_12
       , null VFI_INTEGER_13
       , null VFI_INTEGER_14
       , null VFI_INTEGER_15
       , null VFI_INTEGER_16
       , null VFI_INTEGER_17
       , null VFI_INTEGER_18
       , null VFI_INTEGER_19
       , null VFI_INTEGER_20
       , null VFI_INTEGER_21
       , null VFI_INTEGER_22
       , null VFI_INTEGER_23
       , null VFI_INTEGER_24
       , null VFI_INTEGER_25
       , null VFI_INTEGER_26
       , null VFI_INTEGER_27
       , null VFI_INTEGER_28
       , null VFI_INTEGER_29
       , null VFI_INTEGER_30
       , null VFI_FLOAT_01
       , null VFI_FLOAT_02
       , null VFI_FLOAT_03
       , null VFI_FLOAT_04
       , null VFI_FLOAT_05
       , null VFI_FLOAT_06
       , null VFI_FLOAT_07
       , null VFI_FLOAT_08
       , null VFI_FLOAT_09
       , null VFI_FLOAT_10
       , null VFI_FLOAT_11
       , null VFI_FLOAT_12
       , null VFI_FLOAT_13
       , null VFI_FLOAT_14
       , null VFI_FLOAT_15
       , null VFI_FLOAT_16
       , null VFI_FLOAT_17
       , null VFI_FLOAT_18
       , null VFI_FLOAT_19
       , null VFI_FLOAT_20
       , null VFI_FLOAT_21
       , null VFI_FLOAT_22
       , null VFI_FLOAT_23
       , null VFI_FLOAT_24
       , null VFI_FLOAT_25
       , null VFI_FLOAT_26
       , null VFI_FLOAT_27
       , null VFI_FLOAT_28
       , null VFI_FLOAT_29
       , null VFI_FLOAT_30
       , '-1' VFI_BOOLEAN_01
       , '-1' VFI_BOOLEAN_02
       , '-1' VFI_BOOLEAN_03
       , '-1' VFI_BOOLEAN_04
       , '-1' VFI_BOOLEAN_05
       , '-1' VFI_BOOLEAN_06
       , '-1' VFI_BOOLEAN_07
       , '-1' VFI_BOOLEAN_08
       , '-1' VFI_BOOLEAN_09
       , '-1' VFI_BOOLEAN_10
       , '-1' VFI_BOOLEAN_11
       , '-1' VFI_BOOLEAN_12
       , '-1' VFI_BOOLEAN_13
       , '-1' VFI_BOOLEAN_14
       , '-1' VFI_BOOLEAN_15
       , '-1' VFI_BOOLEAN_16
       , '-1' VFI_BOOLEAN_17
       , '-1' VFI_BOOLEAN_18
       , '-1' VFI_BOOLEAN_19
       , '-1' VFI_BOOLEAN_20
       , '-1' VFI_BOOLEAN_21
       , '-1' VFI_BOOLEAN_22
       , '-1' VFI_BOOLEAN_23
       , '-1' VFI_BOOLEAN_24
       , '-1' VFI_BOOLEAN_25
       , '-1' VFI_BOOLEAN_26
       , '-1' VFI_BOOLEAN_27
       , '-1' VFI_BOOLEAN_28
       , '-1' VFI_BOOLEAN_29
       , '-1' VFI_BOOLEAN_30
       , 'N/A' VFI_CHAR_01
       , 'N/A' VFI_CHAR_02
       , 'N/A' VFI_CHAR_03
       , 'N/A' VFI_CHAR_04
       , 'N/A' VFI_CHAR_05
       , 'N/A' VFI_CHAR_06
       , 'N/A' VFI_CHAR_07
       , 'N/A' VFI_CHAR_08
       , 'N/A' VFI_CHAR_09
       , 'N/A' VFI_CHAR_10
       , 'N/A' VFI_CHAR_11
       , 'N/A' VFI_CHAR_12
       , 'N/A' VFI_CHAR_13
       , 'N/A' VFI_CHAR_14
       , 'N/A' VFI_CHAR_15
       , 'N/A' VFI_CHAR_16
       , 'N/A' VFI_CHAR_17
       , 'N/A' VFI_CHAR_18
       , 'N/A' VFI_CHAR_19
       , 'N/A' VFI_CHAR_20
       , 'N/A' VFI_CHAR_21
       , 'N/A' VFI_CHAR_22
       , 'N/A' VFI_CHAR_23
       , 'N/A' VFI_CHAR_24
       , 'N/A' VFI_CHAR_25
       , 'N/A' VFI_CHAR_26
       , 'N/A' VFI_CHAR_27
       , 'N/A' VFI_CHAR_28
       , 'N/A' VFI_CHAR_29
       , 'N/A' VFI_CHAR_30
       , 'N/A' VFI_MEMO_01
       , 'N/A' VFI_MEMO_02
       , 'N/A' VFI_MEMO_03
       , 'N/A' VFI_MEMO_04
       , 'N/A' VFI_MEMO_05
       , 'N/A' VFI_MEMO_06
       , 'N/A' VFI_MEMO_07
       , 'N/A' VFI_MEMO_08
       , 'N/A' VFI_MEMO_09
       , 'N/A' VFI_MEMO_10
       , 'N/A' VFI_MEMO_11
       , 'N/A' VFI_MEMO_12
       , 'N/A' VFI_MEMO_13
       , 'N/A' VFI_MEMO_14
       , 'N/A' VFI_MEMO_15
       , 'N/A' VFI_MEMO_16
       , 'N/A' VFI_MEMO_17
       , 'N/A' VFI_MEMO_18
       , 'N/A' VFI_MEMO_19
       , 'N/A' VFI_MEMO_20
       , 'N/A' VFI_MEMO_21
       , 'N/A' VFI_MEMO_22
       , 'N/A' VFI_MEMO_23
       , 'N/A' VFI_MEMO_24
       , 'N/A' VFI_MEMO_25
       , 'N/A' VFI_MEMO_26
       , 'N/A' VFI_MEMO_27
       , 'N/A' VFI_MEMO_28
       , 'N/A' VFI_MEMO_29
       , 'N/A' VFI_MEMO_30
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_01
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_02
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_03
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_04
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_05
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_06
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_07
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_08
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_09
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_10
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_11
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_12
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_13
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_14
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_15
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_16
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_17
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_18
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_19
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_20
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_21
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_22
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_23
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_24
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_25
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_26
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_27
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_28
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_29
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_30
       , 'N/A' VFI_DESCODES_01
       , 'N/A' VFI_DESCODES_02
       , 'N/A' VFI_DESCODES_03
       , 'N/A' VFI_DESCODES_04
       , 'N/A' VFI_DESCODES_05
       , 'N/A' VFI_DESCODES_06
       , 'N/A' VFI_DESCODES_07
       , 'N/A' VFI_DESCODES_08
       , 'N/A' VFI_DESCODES_09
       , 'N/A' VFI_DESCODES_10
       , 'N/A' VFI_DESCODES_11
       , 'N/A' VFI_DESCODES_12
       , 'N/A' VFI_DESCODES_13
       , 'N/A' VFI_DESCODES_14
       , 'N/A' VFI_DESCODES_15
       , 'N/A' VFI_DESCODES_16
       , 'N/A' VFI_DESCODES_17
       , 'N/A' VFI_DESCODES_18
       , 'N/A' VFI_DESCODES_19
       , 'N/A' VFI_DESCODES_20
       , 'N/A' VFI_DESCODES_21
       , 'N/A' VFI_DESCODES_22
       , 'N/A' VFI_DESCODES_23
       , 'N/A' VFI_DESCODES_24
       , 'N/A' VFI_DESCODES_25
       , 'N/A' VFI_DESCODES_26
       , 'N/A' VFI_DESCODES_27
       , 'N/A' VFI_DESCODES_28
       , 'N/A' VFI_DESCODES_29
       , 'N/A' VFI_DESCODES_30
       , null VFI_INTEGER_31
       , null VFI_INTEGER_32
       , null VFI_INTEGER_33
       , null VFI_INTEGER_34
       , null VFI_INTEGER_35
       , null VFI_INTEGER_36
       , null VFI_INTEGER_37
       , null VFI_INTEGER_38
       , null VFI_INTEGER_39
       , null VFI_INTEGER_40
       , null VFI_FLOAT_31
       , null VFI_FLOAT_32
       , null VFI_FLOAT_33
       , null VFI_FLOAT_34
       , null VFI_FLOAT_35
       , null VFI_FLOAT_36
       , null VFI_FLOAT_37
       , null VFI_FLOAT_38
       , null VFI_FLOAT_39
       , null VFI_FLOAT_40
       , '-1' VFI_BOOLEAN_31
       , '-1' VFI_BOOLEAN_32
       , '-1' VFI_BOOLEAN_33
       , '-1' VFI_BOOLEAN_34
       , '-1' VFI_BOOLEAN_35
       , '-1' VFI_BOOLEAN_36
       , '-1' VFI_BOOLEAN_37
       , '-1' VFI_BOOLEAN_38
       , '-1' VFI_BOOLEAN_39
       , '-1' VFI_BOOLEAN_40
       , 'N/A' VFI_CHAR_31
       , 'N/A' VFI_CHAR_32
       , 'N/A' VFI_CHAR_33
       , 'N/A' VFI_CHAR_34
       , 'N/A' VFI_CHAR_35
       , 'N/A' VFI_CHAR_36
       , 'N/A' VFI_CHAR_37
       , 'N/A' VFI_CHAR_38
       , 'N/A' VFI_CHAR_39
       , 'N/A' VFI_CHAR_40
       , 'N/A' VFI_MEMO_31
       , 'N/A' VFI_MEMO_32
       , 'N/A' VFI_MEMO_33
       , 'N/A' VFI_MEMO_34
       , 'N/A' VFI_MEMO_35
       , 'N/A' VFI_MEMO_36
       , 'N/A' VFI_MEMO_37
       , 'N/A' VFI_MEMO_38
       , 'N/A' VFI_MEMO_39
       , 'N/A' VFI_MEMO_40
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_31
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_32
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_33
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_34
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_35
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_36
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_37
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_38
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_39
       , to_date('00010101', 'YYYYMMDD') VFI_DATE_40
       , 'N/A' VFI_DESCODES_31
       , 'N/A' VFI_DESCODES_32
       , 'N/A' VFI_DESCODES_33
       , 'N/A' VFI_DESCODES_34
       , 'N/A' VFI_DESCODES_35
       , 'N/A' VFI_DESCODES_36
       , 'N/A' VFI_DESCODES_37
       , 'N/A' VFI_DESCODES_38
       , 'N/A' VFI_DESCODES_39
       , 'N/A' VFI_DESCODES_40
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_DOCUMENT" ("DOC_DOCUMENT_ID", "DOC_GAUGE_ID", "ACS_FINANCIAL_CURRENCY_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "PAC_PAYMENT_CONDITION_ID", "PAC_ADDRESS_ID", "PAC_PAC_ADDRESS_ID", "PAC2_PAC_ADDRESS_ID", "DIC_GAUGE_TYPE_DOC_ID", "C_DOCUMENT_STATUS", "DOC_RECORD_ID", "PAC_THIRD_ID", "PAC_REPRESENTATIVE_ID", "PAC_FINANCIAL_REFERENCE_ID", "DMT_NUMBER", "DMT_PARTNER_NUMBER", "DMT_PARTNER_REFERENCE", "DMT_REFERENCE", "DMT_TITLE_TEXT", "DMT_HEADING_TEXT", "DMT_DOCUMENT_TEXT", "DMT_MAIN_EDITING", "DMT_ALT1_EDITING", "DMT_ALT2_EDITING", "DMT_ALT3_EDITING", "DMT_ALT4_EDITING", "DMT_ALT5_EDITING", "DMT_MAIN_PRINTING", "DMT_ALT1_PRINTING", "DMT_ALT2_PRINTING", "DMT_ALT3_PRINTING", "DMT_ALT4_PRINTING", "DMT_ALT5_PRINTING", "DMT_DATE_MAIN_PRINTING", "DMT_DATE_ALT1_PRINTING", "DMT_DATE_ALT2_PRINTING", "DMT_DATE_ALT3_PRINTING", "DMT_DATE_ALT4_PRINTING", "DMT_DATE_ALT5_PRINTING", "DMT_DATE_FALLING_DUE", "DMT_LAST_USED_POS_NUMBER", "DMT_BASE_PRICE", "DMT_RATE_FACTOR", "DMT_RATE_OF_EXCHANGE", "DMT_DATE_DOCUMENT", "DMT_DATE_PARTNER_DOCUMENT", "DMT_DATE_VALUE", "PC_LANG_ID", "DMT_ADDRESS1", "DMT_POSTCODE1", "DMT_TOWN1", "DMT_STATE1", "PC_CNTRY_ID", "DMT_ADDRESS2", "DMT_POSTCODE2", "DMT_TOWN2", "DMT_STATE2", "PC__PC_CNTRY_ID", "DMT_ADDRESS3", "DMT_POSTCODE3", "DMT_TOWN3", "DMT_STATE3", "PC_2_PC_CNTRY_ID", "DMT_FORMAT_CITY1", "DMT_FORMAT_CITY2", "DMT_FORMAT_CITY3", "DMT_EXPORTED", "DMT_FINANCIAL_CHARGING", "DMT_PROTECTED", "PC_APPLTXT_ID", "PC__PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "PAC_SENDING_CONDITION_ID", "ACS_FIN_ACC_S_PAYMENT_ID", "DIC_TYPE_SUBMISSION_ID", "DMT_RATE_EURO", "DMT_DATE_DELIVERY", "DIC_DOC_FREE_1_ID", "DIC_DOC_FREE_2_ID", "DIC_DIC_DOC_FREE_3_ID", "DMT_DECIMAL_1", "DMT_DECIMAL_2", "DMT_DECIMAL_3", "DMT_TEXT_1", "DMT_TEXT_2", "DMT_TEXT_3", "DIC_DOC_FREE_3_ID", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "DMT_COMMISSION_EXTRACTED", "ACS_VAT_DET_ACCOUNT_ID", "DMT_BALANCED", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "DMT_GAU_FREE_NUMBER1", "DMT_GAU_FREE_NUMBER2", "DMT_GAU_FREE_DATE1", "DMT_GAU_FREE_DATE2", "DMT_GAU_FREE_TEXT_LONG", "DMT_GAU_FREE_TEXT_SHORT", "DMT_GAU_FREE_BOOL1", "DMT_GAU_FREE_BOOL2", "ACS_ACS_FINANCIAL_CURRENCY_ID", "DMT_VAT_BASE_PRICE", "DMT_VAT_EXCHANGE_RATE", "ACT_DOCUMENT_ID", "DMT_PRE_ENTRY", "DIC_TARIFF_ID", "C_CONFIRM_FAIL_REASON", "C_CREDIT_LIMIT_CHECK", "C_INCOTERMS", "DMT_CREDIT_LIMIT_TEXT", "DMT_CREDIT_LIMIT_IDMOD", "DMT_CREDIT_LIMIT_DATEMOD", "DMT_INCOTERMS_PLACE", "DMT_EDI_EXPORTED", "DMT_EDI_DATE", "DMT_DOI_NUMBER", "C_DMT_DELIVERY_TYP", "DMT_ERROR_MESSAGE", "DMT_RECALC_TOTAL", "DMT_REDO_PAYMENT_DATE", "DMT_REDO_PAYMENT_BVR", "DMT_CREATE_FOOT_CHARGE", "DMT_RECALC_FOOT_CHARGE", "CML_POSITION_ID", "DMT_CHARACTERIZATION_MISSING", "ASA_RECORD_ID", "DMT_DATE_1", "DMT_DATE_2", "DMT_DATE_3", "DMT_SESSION_ID", "DMT_CREATE_FOOT_MAT", "DMT_RECALC_FOOT_MAT", "DMT_ALT6_EDITING", "DMT_ALT7_EDITING", "DMT_ALT8_EDITING", "DMT_ALT9_EDITING", "DMT_ALT10_EDITING", "DMT_ALT6_PRINTING", "DMT_ALT7_PRINTING", "DMT_ALT8_PRINTING", "DMT_ALT9_PRINTING", "DMT_ALT10_PRINTING", "DMT_DATE_ALT6_PRINTING", "DMT_DATE_ALT7_PRINTING", "DMT_DATE_ALT8_PRINTING", "DMT_DATE_ALT9_PRINTING", "DMT_DATE_ALT10_PRINTING", "DOC_GRP_KEY", "C_DOC_CREATE_MODE", "DMT_TARIFF_DATE", "DMT_PM_RATE_DATE", "DMT_REVALUATION_DATE", "DMT_REVALUATION_RATE", "DOC_DOCUMENT_SRC_ID", "DMT_DISCHARGE_FOOT_CHARGE", "COM_NAME_ACI", "PAC_SALE_TERRITORY_ID", "PAC_DISTRIBUTION_CHANNEL_ID", "DMT_LOCKED_PAYMENT", "DMT_DATE_BALANCED", "CML_INVOICING_JOB_ID", "DIC_BLOCKED_REASON_ID", "DMT_FIN_DOC_BLOCKED", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_REPR_ACI_ID", "PAC_REPR_DELIVERY_ID", "PC_LANG_ACI_ID", "PC_LANG_DELIVERY_ID", "DMT_NAME1", "DMT_FORENAME1", "DMT_ACTIVITY1", "DMT_CARE_OF1", "DMT_PO_BOX1", "DMT_PO_BOX_NBR1", "DMT_COUNTY1", "DMT_CONTACT1", "DMT_NAME2", "DMT_FORENAME2", "DMT_ACTIVITY2", "DMT_CARE_OF2", "DMT_PO_BOX2", "DMT_PO_BOX_NBR2", "DMT_COUNTY2", "DMT_CONTACT2", "DMT_NAME3", "DMT_FORENAME3", "DMT_ACTIVITY3", "DMT_CARE_OF3", "DMT_PO_BOX3", "DMT_PO_BOX_NBR3", "DMT_COUNTY3", "DMT_CONTACT3", "PAC_THIRD_VAT_ID", "PAC_THIRD_CDA_ID", "C_GAU_THIRD_VAT", "DOC_INVOICE_EXPIRY_ID", "DMT_INVOICE_EXPIRY", "DMT_CREATE_INVOICE_EXPIRY", "C_INVOICE_EXPIRY_INPUT_TYPE", "DMT_ONLY_AMOUNT_BILL_BOOK", "DMT_ADDENDUM_OF_DOC_ID", "DMT_ADDENDUM_SRC_DOC_ID", "DMT_ADDENDUM_INDEX", "DMT_ADDENDUM_NUMBER", "DMT_CONFIRMED", "DMT_ADDENDUM_COMMENT", "PAC_EBPP_REFERENCE_ID", "PC_EXCHANGE_SYSTEM_ID", "C_THIRD_MATERIAL_RELATION_TYPE", "PC_EXCHANGE_DATA_IN_ID") AS
  select DOC_DOCUMENT_ID
       , Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(PAC_PAYMENT_CONDITION_ID, -2) PAC_PAYMENT_CONDITION_ID
       , Nvl(PAC_ADDRESS_ID, -2) PAC_ADDRESS_ID
       , Nvl(PAC_PAC_ADDRESS_ID, -2) PAC_PAC_ADDRESS_ID
       , Nvl(PAC2_PAC_ADDRESS_ID, -2) PAC2_PAC_ADDRESS_ID
       , Nvl(DIC_GAUGE_TYPE_DOC_ID, 'DWH_ISNULL') DIC_GAUGE_TYPE_DOC_ID
       , Nvl(C_DOCUMENT_STATUS, 'DWH_ISNULL') C_DOCUMENT_STATUS
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(PAC_REPRESENTATIVE_ID, -2) PAC_REPRESENTATIVE_ID
       , Nvl(PAC_FINANCIAL_REFERENCE_ID, -2) PAC_FINANCIAL_REFERENCE_ID
       , Nvl(DMT_NUMBER, '_') DMT_NUMBER
       , Nvl(DMT_PARTNER_NUMBER, '_') DMT_PARTNER_NUMBER
       , Nvl(DMT_PARTNER_REFERENCE, '_') DMT_PARTNER_REFERENCE
       , Nvl(DMT_REFERENCE, '_') DMT_REFERENCE
       , Nvl(DMT_TITLE_TEXT, '_') DMT_TITLE_TEXT
       , Nvl(DMT_HEADING_TEXT, '_') DMT_HEADING_TEXT
       , Nvl(DMT_DOCUMENT_TEXT, '_') DMT_DOCUMENT_TEXT
       , Nvl2(DMT_MAIN_EDITING, case
                when(DMT_MAIN_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_MAIN_EDITING
       , Nvl2(DMT_ALT1_EDITING, case
                when(DMT_ALT1_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT1_EDITING
       , Nvl2(DMT_ALT2_EDITING, case
                when(DMT_ALT2_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT2_EDITING
       , Nvl2(DMT_ALT3_EDITING, case
                when(DMT_ALT3_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT3_EDITING
       , Nvl2(DMT_ALT4_EDITING, case
                when(DMT_ALT4_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT4_EDITING
       , Nvl2(DMT_ALT5_EDITING, case
                when(DMT_ALT5_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT5_EDITING
       , Nvl2(DMT_MAIN_PRINTING, case
                when(DMT_MAIN_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_MAIN_PRINTING
       , Nvl2(DMT_ALT1_PRINTING, case
                when(DMT_ALT1_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT1_PRINTING
       , Nvl2(DMT_ALT2_PRINTING, case
                when(DMT_ALT2_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT2_PRINTING
       , Nvl2(DMT_ALT3_PRINTING, case
                when(DMT_ALT3_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT3_PRINTING
       , Nvl2(DMT_ALT4_PRINTING, case
                when(DMT_ALT4_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT4_PRINTING
       , Nvl2(DMT_ALT5_PRINTING, case
                when(DMT_ALT5_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT5_PRINTING
       , Nvl(DMT_DATE_MAIN_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_MAIN_PRINTING
       , Nvl(DMT_DATE_ALT1_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT1_PRINTING
       , Nvl(DMT_DATE_ALT2_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT2_PRINTING
       , Nvl(DMT_DATE_ALT3_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT3_PRINTING
       , Nvl(DMT_DATE_ALT4_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT4_PRINTING
       , Nvl(DMT_DATE_ALT5_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT5_PRINTING
       , Nvl(DMT_DATE_FALLING_DUE, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_FALLING_DUE
       , DMT_LAST_USED_POS_NUMBER
       , DMT_BASE_PRICE
       , DMT_RATE_FACTOR
       , DMT_RATE_OF_EXCHANGE
       , Nvl(DMT_DATE_DOCUMENT, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_DOCUMENT
       , Nvl(DMT_DATE_PARTNER_DOCUMENT, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_PARTNER_DOCUMENT
       , Nvl(DMT_DATE_VALUE, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_VALUE
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(DMT_ADDRESS1, '_') DMT_ADDRESS1
       , Nvl(DMT_POSTCODE1, '_') DMT_POSTCODE1
       , Nvl(DMT_TOWN1, '_') DMT_TOWN1
       , Nvl(DMT_STATE1, '_') DMT_STATE1
       , Nvl(PC_CNTRY_ID, -2) PC_CNTRY_ID
       , Nvl(DMT_ADDRESS2, '_') DMT_ADDRESS2
       , Nvl(DMT_POSTCODE2, '_') DMT_POSTCODE2
       , Nvl(DMT_TOWN2, '_') DMT_TOWN2
       , Nvl(DMT_STATE2, '_') DMT_STATE2
       , Nvl(PC__PC_CNTRY_ID, -2) PC__PC_CNTRY_ID
       , Nvl(DMT_ADDRESS3, '_') DMT_ADDRESS3
       , Nvl(DMT_POSTCODE3, '_') DMT_POSTCODE3
       , Nvl(DMT_TOWN3, '_') DMT_TOWN3
       , Nvl(DMT_STATE3, '_') DMT_STATE3
       , Nvl(PC_2_PC_CNTRY_ID, -2) PC_2_PC_CNTRY_ID
       , Nvl(DMT_FORMAT_CITY1, '_') DMT_FORMAT_CITY1
       , Nvl(DMT_FORMAT_CITY2, '_') DMT_FORMAT_CITY2
       , Nvl(DMT_FORMAT_CITY3, '_') DMT_FORMAT_CITY3
       , Nvl2(DMT_EXPORTED, case
                when(DMT_EXPORTED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_EXPORTED
       , Nvl2(DMT_FINANCIAL_CHARGING, case
                when(DMT_FINANCIAL_CHARGING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_FINANCIAL_CHARGING
       , Nvl2(DMT_PROTECTED, case
                when(DMT_PROTECTED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_PROTECTED
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl(PC__PC_APPLTXT_ID, -2) PC__PC_APPLTXT_ID
       , Nvl(PC_2_PC_APPLTXT_ID, -2) PC_2_PC_APPLTXT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(PAC_SENDING_CONDITION_ID, -2) PAC_SENDING_CONDITION_ID
       , Nvl(ACS_FIN_ACC_S_PAYMENT_ID, -2) ACS_FIN_ACC_S_PAYMENT_ID
       , Nvl(DIC_TYPE_SUBMISSION_ID, 'DWH_ISNULL') DIC_TYPE_SUBMISSION_ID
       , DMT_RATE_EURO
       , Nvl(DMT_DATE_DELIVERY, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_DELIVERY
       , Nvl(DIC_DOC_FREE_1_ID, 'DWH_ISNULL') DIC_DOC_FREE_1_ID
       , Nvl(DIC_DOC_FREE_2_ID, 'DWH_ISNULL') DIC_DOC_FREE_2_ID
       , Nvl(DIC_DIC_DOC_FREE_3_ID, 'DWH_ISNULL') DIC_DIC_DOC_FREE_3_ID
       , DMT_DECIMAL_1
       , DMT_DECIMAL_2
       , DMT_DECIMAL_3
       , Nvl(DMT_TEXT_1, '_') DMT_TEXT_1
       , Nvl(DMT_TEXT_2, '_') DMT_TEXT_2
       , Nvl(DMT_TEXT_3, '_') DMT_TEXT_3
       , Nvl(DIC_DOC_FREE_3_ID, 'DWH_ISNULL') DIC_DOC_FREE_3_ID
       , Nvl(DIC_POS_FREE_TABLE_1_ID, 'DWH_ISNULL') DIC_POS_FREE_TABLE_1_ID
       , Nvl(DIC_POS_FREE_TABLE_2_ID, 'DWH_ISNULL') DIC_POS_FREE_TABLE_2_ID
       , Nvl(DIC_POS_FREE_TABLE_3_ID, 'DWH_ISNULL') DIC_POS_FREE_TABLE_3_ID
       , Nvl2(DMT_COMMISSION_EXTRACTED, case
                when(DMT_COMMISSION_EXTRACTED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_COMMISSION_EXTRACTED
       , Nvl(ACS_VAT_DET_ACCOUNT_ID, -2) ACS_VAT_DET_ACCOUNT_ID
       , Nvl2(DMT_BALANCED, case
                when(DMT_BALANCED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_BALANCED
       , Nvl(DIC_GAUGE_FREE_CODE_1_ID, 'DWH_ISNULL') DIC_GAUGE_FREE_CODE_1_ID
       , Nvl(DIC_GAUGE_FREE_CODE_2_ID, 'DWH_ISNULL') DIC_GAUGE_FREE_CODE_2_ID
       , Nvl(DIC_GAUGE_FREE_CODE_3_ID, 'DWH_ISNULL') DIC_GAUGE_FREE_CODE_3_ID
       , DMT_GAU_FREE_NUMBER1
       , DMT_GAU_FREE_NUMBER2
       , Nvl(DMT_GAU_FREE_DATE1, to_date('40000101', 'YYYYMMDD') ) DMT_GAU_FREE_DATE1
       , Nvl(DMT_GAU_FREE_DATE2, to_date('40000101', 'YYYYMMDD') ) DMT_GAU_FREE_DATE2
       , Nvl(DMT_GAU_FREE_TEXT_LONG, '_') DMT_GAU_FREE_TEXT_LONG
       , Nvl(DMT_GAU_FREE_TEXT_SHORT, '_') DMT_GAU_FREE_TEXT_SHORT
       , Nvl2(DMT_GAU_FREE_BOOL1, case
                when(DMT_GAU_FREE_BOOL1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_GAU_FREE_BOOL1
       , Nvl2(DMT_GAU_FREE_BOOL2, case
                when(DMT_GAU_FREE_BOOL2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_GAU_FREE_BOOL2
       , Nvl(ACS_ACS_FINANCIAL_CURRENCY_ID, -2) ACS_ACS_FINANCIAL_CURRENCY_ID
       , DMT_VAT_BASE_PRICE
       , DMT_VAT_EXCHANGE_RATE
       , Nvl(ACT_DOCUMENT_ID, -2) ACT_DOCUMENT_ID
       , Nvl2(DMT_PRE_ENTRY, case
                when(DMT_PRE_ENTRY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_PRE_ENTRY
       , Nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , Nvl(C_CONFIRM_FAIL_REASON, 'DWH_ISNULL') C_CONFIRM_FAIL_REASON
       , Nvl(C_CREDIT_LIMIT_CHECK, 'DWH_ISNULL') C_CREDIT_LIMIT_CHECK
       , Nvl(C_INCOTERMS, 'DWH_ISNULL') C_INCOTERMS
       , Nvl(DMT_CREDIT_LIMIT_TEXT, '_') DMT_CREDIT_LIMIT_TEXT
       , Nvl(DMT_CREDIT_LIMIT_IDMOD, '_') DMT_CREDIT_LIMIT_IDMOD
       , Nvl(DMT_CREDIT_LIMIT_DATEMOD, to_date('40000101', 'YYYYMMDD') ) DMT_CREDIT_LIMIT_DATEMOD
       , Nvl(DMT_INCOTERMS_PLACE, '_') DMT_INCOTERMS_PLACE
       , Nvl(DMT_EDI_EXPORTED, '_') DMT_EDI_EXPORTED
       , Nvl(DMT_EDI_DATE, to_date('40000101', 'YYYYMMDD') ) DMT_EDI_DATE
       , Nvl(DMT_DOI_NUMBER, '_') DMT_DOI_NUMBER
       , Nvl(C_DMT_DELIVERY_TYP, 'DWH_ISNULL') C_DMT_DELIVERY_TYP
       , Nvl(DMT_ERROR_MESSAGE, '_') DMT_ERROR_MESSAGE
       , Nvl2(DMT_RECALC_TOTAL, case
                when(DMT_RECALC_TOTAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_RECALC_TOTAL
       , Nvl2(DMT_REDO_PAYMENT_DATE, case
                when(DMT_REDO_PAYMENT_DATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_REDO_PAYMENT_DATE
       , Nvl2(DMT_REDO_PAYMENT_BVR, case
                when(DMT_REDO_PAYMENT_BVR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_REDO_PAYMENT_BVR
       , Nvl2(DMT_CREATE_FOOT_CHARGE, case
                when(DMT_CREATE_FOOT_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_CREATE_FOOT_CHARGE
       , Nvl2(DMT_RECALC_FOOT_CHARGE, case
                when(DMT_RECALC_FOOT_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_RECALC_FOOT_CHARGE
       , Nvl(CML_POSITION_ID, -2) CML_POSITION_ID
       , Nvl2(DMT_CHARACTERIZATION_MISSING, case
                when(DMT_CHARACTERIZATION_MISSING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_CHARACTERIZATION_MISSING
       , Nvl(ASA_RECORD_ID, -2) ASA_RECORD_ID
       , Nvl(DMT_DATE_1, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_1
       , Nvl(DMT_DATE_2, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_2
       , Nvl(DMT_DATE_3, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_3
       , Nvl(DMT_SESSION_ID, '_') DMT_SESSION_ID
       , Nvl2(DMT_CREATE_FOOT_MAT, case
                when(DMT_CREATE_FOOT_MAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_CREATE_FOOT_MAT
       , Nvl2(DMT_RECALC_FOOT_MAT, case
                when(DMT_RECALC_FOOT_MAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_RECALC_FOOT_MAT
       , Nvl2(DMT_ALT6_EDITING, case
                when(DMT_ALT6_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT6_EDITING
       , Nvl2(DMT_ALT7_EDITING, case
                when(DMT_ALT7_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT7_EDITING
       , Nvl2(DMT_ALT8_EDITING, case
                when(DMT_ALT8_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT8_EDITING
       , Nvl2(DMT_ALT9_EDITING, case
                when(DMT_ALT9_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT9_EDITING
       , Nvl2(DMT_ALT10_EDITING, case
                when(DMT_ALT10_EDITING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT10_EDITING
       , Nvl2(DMT_ALT6_PRINTING, case
                when(DMT_ALT6_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT6_PRINTING
       , Nvl2(DMT_ALT7_PRINTING, case
                when(DMT_ALT7_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT7_PRINTING
       , Nvl2(DMT_ALT8_PRINTING, case
                when(DMT_ALT8_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT8_PRINTING
       , Nvl2(DMT_ALT9_PRINTING, case
                when(DMT_ALT9_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT9_PRINTING
       , Nvl2(DMT_ALT10_PRINTING, case
                when(DMT_ALT10_PRINTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ALT10_PRINTING
       , Nvl(DMT_DATE_ALT6_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT6_PRINTING
       , Nvl(DMT_DATE_ALT7_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT7_PRINTING
       , Nvl(DMT_DATE_ALT8_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT8_PRINTING
       , Nvl(DMT_DATE_ALT9_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT9_PRINTING
       , Nvl(DMT_DATE_ALT10_PRINTING, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_ALT10_PRINTING
       , Nvl(DOC_GRP_KEY, '_') DOC_GRP_KEY
       , Nvl(C_DOC_CREATE_MODE, 'DWH_ISNULL') C_DOC_CREATE_MODE
       , Nvl(DMT_TARIFF_DATE, to_date('40000101', 'YYYYMMDD') ) DMT_TARIFF_DATE
       , Nvl(DMT_PM_RATE_DATE, to_date('40000101', 'YYYYMMDD') ) DMT_PM_RATE_DATE
       , Nvl(DMT_REVALUATION_DATE, to_date('40000101', 'YYYYMMDD') ) DMT_REVALUATION_DATE
       , Nvl2(DMT_REVALUATION_RATE, case
                when(DMT_REVALUATION_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_REVALUATION_RATE
       , Nvl(DOC_DOCUMENT_SRC_ID, -2) DOC_DOCUMENT_SRC_ID
       , Nvl2(DMT_DISCHARGE_FOOT_CHARGE, case
                when(DMT_DISCHARGE_FOOT_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_DISCHARGE_FOOT_CHARGE
       , Nvl(COM_NAME_ACI, '_') COM_NAME_ACI
       , Nvl(PAC_SALE_TERRITORY_ID, -2) PAC_SALE_TERRITORY_ID
       , Nvl(PAC_DISTRIBUTION_CHANNEL_ID, -2) PAC_DISTRIBUTION_CHANNEL_ID
       , Nvl2(DMT_LOCKED_PAYMENT, case
                when(DMT_LOCKED_PAYMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_LOCKED_PAYMENT
       , Nvl(DMT_DATE_BALANCED, to_date('40000101', 'YYYYMMDD') ) DMT_DATE_BALANCED
       , Nvl(CML_INVOICING_JOB_ID, -2) CML_INVOICING_JOB_ID
       , Nvl(DIC_BLOCKED_REASON_ID, 'DWH_ISNULL') DIC_BLOCKED_REASON_ID
       , Nvl2(DMT_FIN_DOC_BLOCKED, case
                when(DMT_FIN_DOC_BLOCKED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_FIN_DOC_BLOCKED
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl(PAC_REPR_ACI_ID, -2) PAC_REPR_ACI_ID
       , Nvl(PAC_REPR_DELIVERY_ID, -2) PAC_REPR_DELIVERY_ID
       , Nvl(PC_LANG_ACI_ID, -2) PC_LANG_ACI_ID
       , Nvl(PC_LANG_DELIVERY_ID, -2) PC_LANG_DELIVERY_ID
       , Nvl(DMT_NAME1, '_') DMT_NAME1
       , Nvl(DMT_FORENAME1, '_') DMT_FORENAME1
       , Nvl(DMT_ACTIVITY1, '_') DMT_ACTIVITY1
       , Nvl(DMT_CARE_OF1, '_') DMT_CARE_OF1
       , Nvl(DMT_PO_BOX1, '_') DMT_PO_BOX1
       , DMT_PO_BOX_NBR1
       , Nvl(DMT_COUNTY1, '_') DMT_COUNTY1
       , Nvl(DMT_CONTACT1, '_') DMT_CONTACT1
       , Nvl(DMT_NAME2, '_') DMT_NAME2
       , Nvl(DMT_FORENAME2, '_') DMT_FORENAME2
       , Nvl(DMT_ACTIVITY2, '_') DMT_ACTIVITY2
       , Nvl(DMT_CARE_OF2, '_') DMT_CARE_OF2
       , Nvl(DMT_PO_BOX2, '_') DMT_PO_BOX2
       , DMT_PO_BOX_NBR2
       , Nvl(DMT_COUNTY2, '_') DMT_COUNTY2
       , Nvl(DMT_CONTACT2, '_') DMT_CONTACT2
       , Nvl(DMT_NAME3, '_') DMT_NAME3
       , Nvl(DMT_FORENAME3, '_') DMT_FORENAME3
       , Nvl(DMT_ACTIVITY3, '_') DMT_ACTIVITY3
       , Nvl(DMT_CARE_OF3, '_') DMT_CARE_OF3
       , Nvl(DMT_PO_BOX3, '_') DMT_PO_BOX3
       , DMT_PO_BOX_NBR3
       , Nvl(DMT_COUNTY3, '_') DMT_COUNTY3
       , Nvl(DMT_CONTACT3, '_') DMT_CONTACT3
       , Nvl(PAC_THIRD_VAT_ID, -2) PAC_THIRD_VAT_ID
       , Nvl(PAC_THIRD_CDA_ID, -2) PAC_THIRD_CDA_ID
       , Nvl(C_GAU_THIRD_VAT, 'DWH_ISNULL') C_GAU_THIRD_VAT
       , Nvl(DOC_INVOICE_EXPIRY_ID, -2) DOC_INVOICE_EXPIRY_ID
       , Nvl2(DMT_INVOICE_EXPIRY, case
                when(DMT_INVOICE_EXPIRY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_INVOICE_EXPIRY
       , Nvl2(DMT_CREATE_INVOICE_EXPIRY, case
                when(DMT_CREATE_INVOICE_EXPIRY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_CREATE_INVOICE_EXPIRY
       , Nvl(C_INVOICE_EXPIRY_INPUT_TYPE, 'DWH_ISNULL') C_INVOICE_EXPIRY_INPUT_TYPE
       , Nvl2(DMT_ONLY_AMOUNT_BILL_BOOK, case
                when(DMT_ONLY_AMOUNT_BILL_BOOK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_ONLY_AMOUNT_BILL_BOOK
       , Nvl(DMT_ADDENDUM_OF_DOC_ID, -2) DMT_ADDENDUM_OF_DOC_ID
       , Nvl(DMT_ADDENDUM_SRC_DOC_ID, -2) DMT_ADDENDUM_SRC_DOC_ID
       , DMT_ADDENDUM_INDEX
       , Nvl(DMT_ADDENDUM_NUMBER, '_') DMT_ADDENDUM_NUMBER
       , Nvl2(DMT_CONFIRMED, case
                when(DMT_CONFIRMED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DMT_CONFIRMED
       , Nvl(DMT_ADDENDUM_COMMENT, '_') DMT_ADDENDUM_COMMENT
       , Nvl(PAC_EBPP_REFERENCE_ID, -2) PAC_EBPP_REFERENCE_ID
       , Nvl(PC_EXCHANGE_SYSTEM_ID, -2) PC_EXCHANGE_SYSTEM_ID
       , Nvl(C_THIRD_MATERIAL_RELATION_TYPE, 'DWH_ISNULL') C_THIRD_MATERIAL_RELATION_TYPE
       , Nvl(PC_EXCHANGE_DATA_IN_ID, -2) PC_EXCHANGE_DATA_IN_ID
  from DOC_DOCUMENT
  union all
  select -1 DOC_DOCUMENT_ID
       , -1 DOC_GAUGE_ID
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 PAC_PAYMENT_CONDITION_ID
       , -1 PAC_ADDRESS_ID
       , -1 PAC_PAC_ADDRESS_ID
       , -1 PAC2_PAC_ADDRESS_ID
       , 'DWH_NA' DIC_GAUGE_TYPE_DOC_ID
       , 'DWH_NA' C_DOCUMENT_STATUS
       , -1 DOC_RECORD_ID
       , -1 PAC_THIRD_ID
       , -1 PAC_REPRESENTATIVE_ID
       , -1 PAC_FINANCIAL_REFERENCE_ID
       , 'N/A' DMT_NUMBER
       , 'N/A' DMT_PARTNER_NUMBER
       , 'N/A' DMT_PARTNER_REFERENCE
       , 'N/A' DMT_REFERENCE
       , 'N/A' DMT_TITLE_TEXT
       , 'N/A' DMT_HEADING_TEXT
       , 'N/A' DMT_DOCUMENT_TEXT
       , '-1' DMT_MAIN_EDITING
       , '-1' DMT_ALT1_EDITING
       , '-1' DMT_ALT2_EDITING
       , '-1' DMT_ALT3_EDITING
       , '-1' DMT_ALT4_EDITING
       , '-1' DMT_ALT5_EDITING
       , '-1' DMT_MAIN_PRINTING
       , '-1' DMT_ALT1_PRINTING
       , '-1' DMT_ALT2_PRINTING
       , '-1' DMT_ALT3_PRINTING
       , '-1' DMT_ALT4_PRINTING
       , '-1' DMT_ALT5_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_MAIN_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT1_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT2_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT3_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT4_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT5_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_FALLING_DUE
       , null DMT_LAST_USED_POS_NUMBER
       , null DMT_BASE_PRICE
       , null DMT_RATE_FACTOR
       , null DMT_RATE_OF_EXCHANGE
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_DOCUMENT
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_PARTNER_DOCUMENT
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_VALUE
       , -1 PC_LANG_ID
       , 'N/A' DMT_ADDRESS1
       , 'N/A' DMT_POSTCODE1
       , 'N/A' DMT_TOWN1
       , 'N/A' DMT_STATE1
       , -1 PC_CNTRY_ID
       , 'N/A' DMT_ADDRESS2
       , 'N/A' DMT_POSTCODE2
       , 'N/A' DMT_TOWN2
       , 'N/A' DMT_STATE2
       , -1 PC__PC_CNTRY_ID
       , 'N/A' DMT_ADDRESS3
       , 'N/A' DMT_POSTCODE3
       , 'N/A' DMT_TOWN3
       , 'N/A' DMT_STATE3
       , -1 PC_2_PC_CNTRY_ID
       , 'N/A' DMT_FORMAT_CITY1
       , 'N/A' DMT_FORMAT_CITY2
       , 'N/A' DMT_FORMAT_CITY3
       , '-1' DMT_EXPORTED
       , '-1' DMT_FINANCIAL_CHARGING
       , '-1' DMT_PROTECTED
       , -1 PC_APPLTXT_ID
       , -1 PC__PC_APPLTXT_ID
       , -1 PC_2_PC_APPLTXT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 PAC_SENDING_CONDITION_ID
       , -1 ACS_FIN_ACC_S_PAYMENT_ID
       , 'DWH_NA' DIC_TYPE_SUBMISSION_ID
       , null DMT_RATE_EURO
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_DELIVERY
       , 'DWH_NA' DIC_DOC_FREE_1_ID
       , 'DWH_NA' DIC_DOC_FREE_2_ID
       , 'DWH_NA' DIC_DIC_DOC_FREE_3_ID
       , null DMT_DECIMAL_1
       , null DMT_DECIMAL_2
       , null DMT_DECIMAL_3
       , 'N/A' DMT_TEXT_1
       , 'N/A' DMT_TEXT_2
       , 'N/A' DMT_TEXT_3
       , 'DWH_NA' DIC_DOC_FREE_3_ID
       , 'DWH_NA' DIC_POS_FREE_TABLE_1_ID
       , 'DWH_NA' DIC_POS_FREE_TABLE_2_ID
       , 'DWH_NA' DIC_POS_FREE_TABLE_3_ID
       , '-1' DMT_COMMISSION_EXTRACTED
       , -1 ACS_VAT_DET_ACCOUNT_ID
       , '-1' DMT_BALANCED
       , 'DWH_NA' DIC_GAUGE_FREE_CODE_1_ID
       , 'DWH_NA' DIC_GAUGE_FREE_CODE_2_ID
       , 'DWH_NA' DIC_GAUGE_FREE_CODE_3_ID
       , null DMT_GAU_FREE_NUMBER1
       , null DMT_GAU_FREE_NUMBER2
       , to_date('00010101', 'YYYYMMDD') DMT_GAU_FREE_DATE1
       , to_date('00010101', 'YYYYMMDD') DMT_GAU_FREE_DATE2
       , 'N/A' DMT_GAU_FREE_TEXT_LONG
       , 'N/A' DMT_GAU_FREE_TEXT_SHORT
       , '-1' DMT_GAU_FREE_BOOL1
       , '-1' DMT_GAU_FREE_BOOL2
       , -1 ACS_ACS_FINANCIAL_CURRENCY_ID
       , null DMT_VAT_BASE_PRICE
       , null DMT_VAT_EXCHANGE_RATE
       , -1 ACT_DOCUMENT_ID
       , '-1' DMT_PRE_ENTRY
       , 'DWH_NA' DIC_TARIFF_ID
       , 'DWH_NA' C_CONFIRM_FAIL_REASON
       , 'DWH_NA' C_CREDIT_LIMIT_CHECK
       , 'DWH_NA' C_INCOTERMS
       , 'N/A' DMT_CREDIT_LIMIT_TEXT
       , 'N/A' DMT_CREDIT_LIMIT_IDMOD
       , to_date('00010101', 'YYYYMMDD') DMT_CREDIT_LIMIT_DATEMOD
       , 'N/A' DMT_INCOTERMS_PLACE
       , 'N/A' DMT_EDI_EXPORTED
       , to_date('00010101', 'YYYYMMDD') DMT_EDI_DATE
       , 'N/A' DMT_DOI_NUMBER
       , 'DWH_NA' C_DMT_DELIVERY_TYP
       , 'N/A' DMT_ERROR_MESSAGE
       , '-1' DMT_RECALC_TOTAL
       , '-1' DMT_REDO_PAYMENT_DATE
       , '-1' DMT_REDO_PAYMENT_BVR
       , '-1' DMT_CREATE_FOOT_CHARGE
       , '-1' DMT_RECALC_FOOT_CHARGE
       , -1 CML_POSITION_ID
       , '-1' DMT_CHARACTERIZATION_MISSING
       , -1 ASA_RECORD_ID
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_1
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_2
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_3
       , 'N/A' DMT_SESSION_ID
       , '-1' DMT_CREATE_FOOT_MAT
       , '-1' DMT_RECALC_FOOT_MAT
       , '-1' DMT_ALT6_EDITING
       , '-1' DMT_ALT7_EDITING
       , '-1' DMT_ALT8_EDITING
       , '-1' DMT_ALT9_EDITING
       , '-1' DMT_ALT10_EDITING
       , '-1' DMT_ALT6_PRINTING
       , '-1' DMT_ALT7_PRINTING
       , '-1' DMT_ALT8_PRINTING
       , '-1' DMT_ALT9_PRINTING
       , '-1' DMT_ALT10_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT6_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT7_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT8_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT9_PRINTING
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_ALT10_PRINTING
       , 'N/A' DOC_GRP_KEY
       , 'DWH_NA' C_DOC_CREATE_MODE
       , to_date('00010101', 'YYYYMMDD') DMT_TARIFF_DATE
       , to_date('00010101', 'YYYYMMDD') DMT_PM_RATE_DATE
       , to_date('00010101', 'YYYYMMDD') DMT_REVALUATION_DATE
       , '-1' DMT_REVALUATION_RATE
       , -1 DOC_DOCUMENT_SRC_ID
       , '-1' DMT_DISCHARGE_FOOT_CHARGE
       , 'N/A' COM_NAME_ACI
       , -1 PAC_SALE_TERRITORY_ID
       , -1 PAC_DISTRIBUTION_CHANNEL_ID
       , '-1' DMT_LOCKED_PAYMENT
       , to_date('00010101', 'YYYYMMDD') DMT_DATE_BALANCED
       , -1 CML_INVOICING_JOB_ID
       , 'DWH_NA' DIC_BLOCKED_REASON_ID
       , '-1' DMT_FIN_DOC_BLOCKED
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , -1 PAC_REPR_ACI_ID
       , -1 PAC_REPR_DELIVERY_ID
       , -1 PC_LANG_ACI_ID
       , -1 PC_LANG_DELIVERY_ID
       , 'N/A' DMT_NAME1
       , 'N/A' DMT_FORENAME1
       , 'N/A' DMT_ACTIVITY1
       , 'N/A' DMT_CARE_OF1
       , 'N/A' DMT_PO_BOX1
       , null DMT_PO_BOX_NBR1
       , 'N/A' DMT_COUNTY1
       , 'N/A' DMT_CONTACT1
       , 'N/A' DMT_NAME2
       , 'N/A' DMT_FORENAME2
       , 'N/A' DMT_ACTIVITY2
       , 'N/A' DMT_CARE_OF2
       , 'N/A' DMT_PO_BOX2
       , null DMT_PO_BOX_NBR2
       , 'N/A' DMT_COUNTY2
       , 'N/A' DMT_CONTACT2
       , 'N/A' DMT_NAME3
       , 'N/A' DMT_FORENAME3
       , 'N/A' DMT_ACTIVITY3
       , 'N/A' DMT_CARE_OF3
       , 'N/A' DMT_PO_BOX3
       , null DMT_PO_BOX_NBR3
       , 'N/A' DMT_COUNTY3
       , 'N/A' DMT_CONTACT3
       , -1 PAC_THIRD_VAT_ID
       , -1 PAC_THIRD_CDA_ID
       , 'DWH_NA' C_GAU_THIRD_VAT
       , -1 DOC_INVOICE_EXPIRY_ID
       , '-1' DMT_INVOICE_EXPIRY
       , '-1' DMT_CREATE_INVOICE_EXPIRY
       , 'DWH_NA' C_INVOICE_EXPIRY_INPUT_TYPE
       , '-1' DMT_ONLY_AMOUNT_BILL_BOOK
       , -1 DMT_ADDENDUM_OF_DOC_ID
       , -1 DMT_ADDENDUM_SRC_DOC_ID
       , null DMT_ADDENDUM_INDEX
       , 'N/A' DMT_ADDENDUM_NUMBER
       , '-1' DMT_CONFIRMED
       , 'N/A' DMT_ADDENDUM_COMMENT
       , -1 PAC_EBPP_REFERENCE_ID
       , -1 PC_EXCHANGE_SYSTEM_ID
       , 'DWH_NA' C_THIRD_MATERIAL_RELATION_TYPE
       , -1 PC_EXCHANGE_DATA_IN_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_FOOT" ("DOC_FOOT_ID", "DOC_DOCUMENT_ID", "DOC_GAUGE_SIGNATORY_ID", "DOC_DOC_GAUGE_SIGNATORY_ID", "FOO_FOOT_TEXT", "FOO_DOCUMENT_TOTAL_AMOUNT", "FOO_GOOD_TOTAL_AMOUNT", "FOO_TOTAL_VAT_AMOUNT", "FOO_CHARGE_TOTAL_AMOUNT", "FOO_DISCOUNT_TOTAL_AMOUNT", "FOO_COST_TOTAL_AMOUNT", "FOO_GOOD_TOT_AMOUNT_EXCL", "FOO_CHARG_TOT_AMOUNT_EXCL", "FOO_DISC_TOT_AMOUNT_EXCL", "FOO_COST_TOT_AMOUNT_EXCL", "FOO_TOTAL_NET_WEIGHT", "FOO_TOTAL_GROSS_WEIGHT", "FOO_TOTAL_RATE_FACTOR", "FOO_TOTAL_BASIS_QUANTITY", "FOO_TOTAL_INTERM_QUANTITY", "FOO_TOTAL_FINAL_QUANTITY", "C_BVR_GENERATION_METHOD", "FOO_GENERATE_BVR_NUMBER", "FOO_REF_BVR_NUMBER", "PC_APPLTXT_ID", "FOO_DOCUMENT_TOT_AMOUNT_B", "FOO_DOCUMENT_TOT_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_B", "FOO_GOOD_TOT_AMOUNT_E", "FOO_TOT_VAT_AMOUNT_B", "FOO_TOT_VAT_AMOUNT_E", "FOO_CHARGE_TOT_AMOUNT_B", "FOO_CHARGE_TOT_AMOUNT_E", "FOO_DISCOUNT_TOT_AMOUNT_B", "FOO_DISCOUNT_TOT_AMOUNT_E", "FOO_COST_TOT_AMOUNT_B", "FOO_COST_TOT_AMOUNT_E", "FOO_GOOD_TOT_AMOUNT_EX_B", "FOO_GOOD_TOT_AMOUNT_EX_E", "FOO_CHARG_TOT_AMOUNT_EX_B", "FOO_CHARG_TOT_AMOUNT_EX_E", "FOO_DISC_TOT_AMOUNT_EX_B", "FOO_DISC_TOT_AMOUNT_EX_E", "FOO_COST_TOT_AMOUNT_EX_B", "FOO_COST_TOT_AMOUNT_EX_E", "FOO_PAID_AMOUNT", "FOO_RETURN_AMOUNT", "FOO_PACKAGING", "FOO_MARKING", "FOO_MEASURE", "DIC_TYPE_DOC_CUSTOM_ID", "C_DIRECTION_NUMBER", "PAC_THIRD_ID", "FOO_DOC_TOT_AMT_COR_B", "DOC_POSITION_ID", "FOO_TOT_VAT_AMOUNT_V", "DOC_FOOT_CHARGE_ID", "ACJ_JOB_TYPE_S_CAT_PMT_ID", "FOO_PAID_AMOUNT_B", "FOO_RECEIVED_AMOUNT", "FOO_MODIFY_RATE", "FOO_PAID_BALANCED_AMOUNT", "FOO_PAID_AMOUNT_EUR", "FOO_TOTAL_NET_WEIGHT_MEAS", "FOO_TOTAL_GROSS_WEIGHT_MEAS", "PC__PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "PC_3_PC_APPLTXT_ID", "PC_4_PC_APPLTXT_ID", "FOO_FOOT_TEXT2", "FOO_FOOT_TEXT3", "FOO_FOOT_TEXT4", "FOO_FOOT_TEXT5", "FOO_PARCEL_QTY", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_THIRD_CDA_ID", "PAC_THIRD_VAT_ID") AS
  select DOC_FOOT_ID
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , Nvl(DOC_GAUGE_SIGNATORY_ID, -2) DOC_GAUGE_SIGNATORY_ID
       , Nvl(DOC_DOC_GAUGE_SIGNATORY_ID, -2) DOC_DOC_GAUGE_SIGNATORY_ID
       , Nvl(FOO_FOOT_TEXT, '_') FOO_FOOT_TEXT
       , FOO_DOCUMENT_TOTAL_AMOUNT
       , FOO_GOOD_TOTAL_AMOUNT
       , FOO_TOTAL_VAT_AMOUNT
       , FOO_CHARGE_TOTAL_AMOUNT
       , FOO_DISCOUNT_TOTAL_AMOUNT
       , FOO_COST_TOTAL_AMOUNT
       , FOO_GOOD_TOT_AMOUNT_EXCL
       , FOO_CHARG_TOT_AMOUNT_EXCL
       , FOO_DISC_TOT_AMOUNT_EXCL
       , FOO_COST_TOT_AMOUNT_EXCL
       , FOO_TOTAL_NET_WEIGHT
       , FOO_TOTAL_GROSS_WEIGHT
       , FOO_TOTAL_RATE_FACTOR
       , FOO_TOTAL_BASIS_QUANTITY
       , FOO_TOTAL_INTERM_QUANTITY
       , FOO_TOTAL_FINAL_QUANTITY
       , Nvl(C_BVR_GENERATION_METHOD, 'DWH_ISNULL') C_BVR_GENERATION_METHOD
       , FOO_GENERATE_BVR_NUMBER
       , Nvl(FOO_REF_BVR_NUMBER, '_') FOO_REF_BVR_NUMBER
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , FOO_DOCUMENT_TOT_AMOUNT_B
       , FOO_DOCUMENT_TOT_AMOUNT_E
       , FOO_GOOD_TOT_AMOUNT_B
       , FOO_GOOD_TOT_AMOUNT_E
       , FOO_TOT_VAT_AMOUNT_B
       , FOO_TOT_VAT_AMOUNT_E
       , FOO_CHARGE_TOT_AMOUNT_B
       , FOO_CHARGE_TOT_AMOUNT_E
       , FOO_DISCOUNT_TOT_AMOUNT_B
       , FOO_DISCOUNT_TOT_AMOUNT_E
       , FOO_COST_TOT_AMOUNT_B
       , FOO_COST_TOT_AMOUNT_E
       , FOO_GOOD_TOT_AMOUNT_EX_B
       , FOO_GOOD_TOT_AMOUNT_EX_E
       , FOO_CHARG_TOT_AMOUNT_EX_B
       , FOO_CHARG_TOT_AMOUNT_EX_E
       , FOO_DISC_TOT_AMOUNT_EX_B
       , FOO_DISC_TOT_AMOUNT_EX_E
       , FOO_COST_TOT_AMOUNT_EX_B
       , FOO_COST_TOT_AMOUNT_EX_E
       , FOO_PAID_AMOUNT
       , FOO_RETURN_AMOUNT
       , Nvl(FOO_PACKAGING, '_') FOO_PACKAGING
       , Nvl(FOO_MARKING, '_') FOO_MARKING
       , Nvl(FOO_MEASURE, '_') FOO_MEASURE
       , Nvl(DIC_TYPE_DOC_CUSTOM_ID, 'DWH_ISNULL') DIC_TYPE_DOC_CUSTOM_ID
       , Nvl(C_DIRECTION_NUMBER, 'DWH_ISNULL') C_DIRECTION_NUMBER
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , FOO_DOC_TOT_AMT_COR_B
       , Nvl(DOC_POSITION_ID, -2) DOC_POSITION_ID
       , FOO_TOT_VAT_AMOUNT_V
       , Nvl(DOC_FOOT_CHARGE_ID, -2) DOC_FOOT_CHARGE_ID
       , Nvl(ACJ_JOB_TYPE_S_CAT_PMT_ID, -2) ACJ_JOB_TYPE_S_CAT_PMT_ID
       , FOO_PAID_AMOUNT_B
       , FOO_RECEIVED_AMOUNT
       , Nvl2(FOO_MODIFY_RATE, case
                when(FOO_MODIFY_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FOO_MODIFY_RATE
       , FOO_PAID_BALANCED_AMOUNT
       , FOO_PAID_AMOUNT_EUR
       , FOO_TOTAL_NET_WEIGHT_MEAS
       , FOO_TOTAL_GROSS_WEIGHT_MEAS
       , Nvl(PC__PC_APPLTXT_ID, -2) PC__PC_APPLTXT_ID
       , Nvl(PC_2_PC_APPLTXT_ID, -2) PC_2_PC_APPLTXT_ID
       , Nvl(PC_3_PC_APPLTXT_ID, -2) PC_3_PC_APPLTXT_ID
       , Nvl(PC_4_PC_APPLTXT_ID, -2) PC_4_PC_APPLTXT_ID
       , Nvl(FOO_FOOT_TEXT2, '_') FOO_FOOT_TEXT2
       , Nvl(FOO_FOOT_TEXT3, '_') FOO_FOOT_TEXT3
       , Nvl(FOO_FOOT_TEXT4, '_') FOO_FOOT_TEXT4
       , Nvl(FOO_FOOT_TEXT5, '_') FOO_FOOT_TEXT5
       , FOO_PARCEL_QTY
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl(PAC_THIRD_CDA_ID, -2) PAC_THIRD_CDA_ID
       , Nvl(PAC_THIRD_VAT_ID, -2) PAC_THIRD_VAT_ID
  from DOC_FOOT
  union all
  select -1 DOC_FOOT_ID
       , -1 DOC_DOCUMENT_ID
       , -1 DOC_GAUGE_SIGNATORY_ID
       , -1 DOC_DOC_GAUGE_SIGNATORY_ID
       , 'N/A' FOO_FOOT_TEXT
       , null FOO_DOCUMENT_TOTAL_AMOUNT
       , null FOO_GOOD_TOTAL_AMOUNT
       , null FOO_TOTAL_VAT_AMOUNT
       , null FOO_CHARGE_TOTAL_AMOUNT
       , null FOO_DISCOUNT_TOTAL_AMOUNT
       , null FOO_COST_TOTAL_AMOUNT
       , null FOO_GOOD_TOT_AMOUNT_EXCL
       , null FOO_CHARG_TOT_AMOUNT_EXCL
       , null FOO_DISC_TOT_AMOUNT_EXCL
       , null FOO_COST_TOT_AMOUNT_EXCL
       , null FOO_TOTAL_NET_WEIGHT
       , null FOO_TOTAL_GROSS_WEIGHT
       , null FOO_TOTAL_RATE_FACTOR
       , null FOO_TOTAL_BASIS_QUANTITY
       , null FOO_TOTAL_INTERM_QUANTITY
       , null FOO_TOTAL_FINAL_QUANTITY
       , 'DWH_NA' C_BVR_GENERATION_METHOD
       , null FOO_GENERATE_BVR_NUMBER
       , 'N/A' FOO_REF_BVR_NUMBER
       , -1 PC_APPLTXT_ID
       , null FOO_DOCUMENT_TOT_AMOUNT_B
       , null FOO_DOCUMENT_TOT_AMOUNT_E
       , null FOO_GOOD_TOT_AMOUNT_B
       , null FOO_GOOD_TOT_AMOUNT_E
       , null FOO_TOT_VAT_AMOUNT_B
       , null FOO_TOT_VAT_AMOUNT_E
       , null FOO_CHARGE_TOT_AMOUNT_B
       , null FOO_CHARGE_TOT_AMOUNT_E
       , null FOO_DISCOUNT_TOT_AMOUNT_B
       , null FOO_DISCOUNT_TOT_AMOUNT_E
       , null FOO_COST_TOT_AMOUNT_B
       , null FOO_COST_TOT_AMOUNT_E
       , null FOO_GOOD_TOT_AMOUNT_EX_B
       , null FOO_GOOD_TOT_AMOUNT_EX_E
       , null FOO_CHARG_TOT_AMOUNT_EX_B
       , null FOO_CHARG_TOT_AMOUNT_EX_E
       , null FOO_DISC_TOT_AMOUNT_EX_B
       , null FOO_DISC_TOT_AMOUNT_EX_E
       , null FOO_COST_TOT_AMOUNT_EX_B
       , null FOO_COST_TOT_AMOUNT_EX_E
       , null FOO_PAID_AMOUNT
       , null FOO_RETURN_AMOUNT
       , 'N/A' FOO_PACKAGING
       , 'N/A' FOO_MARKING
       , 'N/A' FOO_MEASURE
       , 'DWH_NA' DIC_TYPE_DOC_CUSTOM_ID
       , 'DWH_NA' C_DIRECTION_NUMBER
       , -1 PAC_THIRD_ID
       , null FOO_DOC_TOT_AMT_COR_B
       , -1 DOC_POSITION_ID
       , null FOO_TOT_VAT_AMOUNT_V
       , -1 DOC_FOOT_CHARGE_ID
       , -1 ACJ_JOB_TYPE_S_CAT_PMT_ID
       , null FOO_PAID_AMOUNT_B
       , null FOO_RECEIVED_AMOUNT
       , '-1' FOO_MODIFY_RATE
       , null FOO_PAID_BALANCED_AMOUNT
       , null FOO_PAID_AMOUNT_EUR
       , null FOO_TOTAL_NET_WEIGHT_MEAS
       , null FOO_TOTAL_GROSS_WEIGHT_MEAS
       , -1 PC__PC_APPLTXT_ID
       , -1 PC_2_PC_APPLTXT_ID
       , -1 PC_3_PC_APPLTXT_ID
       , -1 PC_4_PC_APPLTXT_ID
       , 'N/A' FOO_FOOT_TEXT2
       , 'N/A' FOO_FOOT_TEXT3
       , 'N/A' FOO_FOOT_TEXT4
       , 'N/A' FOO_FOOT_TEXT5
       , null FOO_PARCEL_QTY
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , -1 PAC_THIRD_CDA_ID
       , -1 PAC_THIRD_VAT_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_FOOT_CHARGE" ("DOC_FOOT_CHARGE_ID", "DOC_FOOT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_TAX_CODE_ID", "PTC_CHARGE_ID", "PTC_DISCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "DOC_DOC_FOOT_CHARGE_ID", "C_FINANCIAL_CHARGE", "C_ROUND_TYPE", "C_CALCULATION_MODE", "FCH_DESCRIPTION", "FCH_EXCL_AMOUNT", "FCH_VAT_AMOUNT", "FCH_VAT_BASE_AMOUNT", "FCH_INCL_AMOUNT", "FCH_RATE", "FCH_EXPRESS_IN", "FCH_EXCL_AMOUNT_B", "FCH_EXCL_AMOUNT_E", "FCH_VAT_AMOUNT_E", "FCH_INCL_AMOUNT_B", "FCH_INCL_AMOUNT_E", "FCH_TRANSFERT_PROP", "FCH_MODIFY", "FCH_IN_SERIES_CALCULATION", "FCH_BALANCE_AMOUNT", "FCH_NAME", "FCH_CALC_AMOUNT", "FCH_CALC_AMOUNT_B", "FCH_CALC_AMOUNT_E", "FCH_LIABLED_AMOUNT", "FCH_LIABLED_AMOUNT_B", "FCH_LIABLED_AMOUNT_E", "FCH_FIXED_AMOUNT", "FCH_FIXED_AMOUNT_B", "FCH_FIXED_AMOUNT_E", "FCH_EXCEEDED_AMOUNT_FROM", "FCH_EXCEEDED_AMOUNT_TO", "FCH_MIN_AMOUNT", "FCH_MAX_AMOUNT", "FCH_IS_MULTIPLICATOR", "FCH_ROUND_AMOUNT", "FCH_STORED_PROC", "FCH_AUTOMATIC_CALC", "FCH_SQL_EXTERN_ITEM", "PAC_THIRD_ID", "FCH_MODIFY_RATE", "FCH_EXCL_AMOUNT_V", "FCH_VAT_AMOUNT_V", "FCH_INCL_AMOUNT_V", "FCH_LIABLED_AMOUNT_V", "FAM_FIXED_ASSETS_ID", "HRM_PERSON_ID", "FCH_IMP_TEXT_1", "FCH_IMP_TEXT_2", "FCH_IMP_TEXT_3", "FCH_IMP_TEXT_4", "FCH_IMP_TEXT_5", "FCH_IMP_NUMBER_1", "FCH_IMP_NUMBER_2", "FCH_IMP_NUMBER_3", "FCH_IMP_NUMBER_4", "FCH_IMP_NUMBER_5", "C_FAM_TRANSACTION_TYP", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "FCH_EXCLUSIVE", "C_CHARGE_ORIGIN", "DOC_FOOT_CHARGE_SRC_ID", "FCH_DISCHARGED", "FCH_VAT_LIABLED_RATE", "FCH_VAT_LIABLED_AMOUNT", "FCH_VAT_RATE", "FCH_VAT_TOTAL_AMOUNT", "FCH_VAT_TOTAL_AMOUNT_B", "FCH_VAT_TOTAL_AMOUNT_V", "FCH_VAT_DEDUCTIBLE_RATE", "DOC_POSITION_COST_ID", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "FCH_IMPUTATION", "FCH_FROZEN", "DOC_INVOICE_EXPIRY_ID") AS
  select DOC_FOOT_CHARGE_ID
       , Nvl(DOC_FOOT_ID, -2) DOC_FOOT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_TAX_CODE_ID, -2) ACS_TAX_CODE_ID
       , Nvl(PTC_CHARGE_ID, -2) PTC_CHARGE_ID
       , Nvl(PTC_DISCOUNT_ID, -2) PTC_DISCOUNT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(DOC_DOC_FOOT_CHARGE_ID, -2) DOC_DOC_FOOT_CHARGE_ID
       , Nvl(C_FINANCIAL_CHARGE, 'DWH_ISNULL') C_FINANCIAL_CHARGE
       , Nvl(C_ROUND_TYPE, 'DWH_ISNULL') C_ROUND_TYPE
       , Nvl(C_CALCULATION_MODE, 'DWH_ISNULL') C_CALCULATION_MODE
       , Nvl(FCH_DESCRIPTION, '_') FCH_DESCRIPTION
       , FCH_EXCL_AMOUNT
       , FCH_VAT_AMOUNT
       , FCH_VAT_BASE_AMOUNT
       , FCH_INCL_AMOUNT
       , FCH_RATE
       , FCH_EXPRESS_IN
       , FCH_EXCL_AMOUNT_B
       , FCH_EXCL_AMOUNT_E
       , FCH_VAT_AMOUNT_E
       , FCH_INCL_AMOUNT_B
       , FCH_INCL_AMOUNT_E
       , Nvl2(FCH_TRANSFERT_PROP, case
                when(FCH_TRANSFERT_PROP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_TRANSFERT_PROP
       , Nvl2(FCH_MODIFY, case
                when(FCH_MODIFY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_MODIFY
       , Nvl2(FCH_IN_SERIES_CALCULATION, case
                when(FCH_IN_SERIES_CALCULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_IN_SERIES_CALCULATION
       , FCH_BALANCE_AMOUNT
       , Nvl(FCH_NAME, '_') FCH_NAME
       , FCH_CALC_AMOUNT
       , FCH_CALC_AMOUNT_B
       , FCH_CALC_AMOUNT_E
       , FCH_LIABLED_AMOUNT
       , FCH_LIABLED_AMOUNT_B
       , FCH_LIABLED_AMOUNT_E
       , FCH_FIXED_AMOUNT
       , FCH_FIXED_AMOUNT_B
       , FCH_FIXED_AMOUNT_E
       , FCH_EXCEEDED_AMOUNT_FROM
       , FCH_EXCEEDED_AMOUNT_TO
       , FCH_MIN_AMOUNT
       , FCH_MAX_AMOUNT
       , Nvl2(FCH_IS_MULTIPLICATOR, case
                when(FCH_IS_MULTIPLICATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_IS_MULTIPLICATOR
       , FCH_ROUND_AMOUNT
       , Nvl(FCH_STORED_PROC, '_') FCH_STORED_PROC
       , Nvl2(FCH_AUTOMATIC_CALC, case
                when(FCH_AUTOMATIC_CALC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_AUTOMATIC_CALC
       , Nvl(FCH_SQL_EXTERN_ITEM, '_') FCH_SQL_EXTERN_ITEM
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl2(FCH_MODIFY_RATE, case
                when(FCH_MODIFY_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_MODIFY_RATE
       , FCH_EXCL_AMOUNT_V
       , FCH_VAT_AMOUNT_V
       , FCH_INCL_AMOUNT_V
       , FCH_LIABLED_AMOUNT_V
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(FCH_IMP_TEXT_1, '_') FCH_IMP_TEXT_1
       , Nvl(FCH_IMP_TEXT_2, '_') FCH_IMP_TEXT_2
       , Nvl(FCH_IMP_TEXT_3, '_') FCH_IMP_TEXT_3
       , Nvl(FCH_IMP_TEXT_4, '_') FCH_IMP_TEXT_4
       , Nvl(FCH_IMP_TEXT_5, '_') FCH_IMP_TEXT_5
       , FCH_IMP_NUMBER_1
       , FCH_IMP_NUMBER_2
       , FCH_IMP_NUMBER_3
       , FCH_IMP_NUMBER_4
       , FCH_IMP_NUMBER_5
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , Nvl2(FCH_EXCLUSIVE, case
                when(FCH_EXCLUSIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_EXCLUSIVE
       , Nvl(C_CHARGE_ORIGIN, 'DWH_ISNULL') C_CHARGE_ORIGIN
       , Nvl(DOC_FOOT_CHARGE_SRC_ID, -2) DOC_FOOT_CHARGE_SRC_ID
       , Nvl2(FCH_DISCHARGED, case
                when(FCH_DISCHARGED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_DISCHARGED
       , FCH_VAT_LIABLED_RATE
       , FCH_VAT_LIABLED_AMOUNT
       , FCH_VAT_RATE
       , FCH_VAT_TOTAL_AMOUNT
       , FCH_VAT_TOTAL_AMOUNT_B
       , FCH_VAT_TOTAL_AMOUNT_V
       , FCH_VAT_DEDUCTIBLE_RATE
       , Nvl(DOC_POSITION_COST_ID, -2) DOC_POSITION_COST_ID
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl2(FCH_IMPUTATION, case
                when(FCH_IMPUTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_IMPUTATION
       , Nvl2(FCH_FROZEN, case
                when(FCH_FROZEN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FCH_FROZEN
       , Nvl(DOC_INVOICE_EXPIRY_ID, -2) DOC_INVOICE_EXPIRY_ID
  from DOC_FOOT_CHARGE
  union all
  select -1 DOC_FOOT_CHARGE_ID
       , -1 DOC_FOOT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_TAX_CODE_ID
       , -1 PTC_CHARGE_ID
       , -1 PTC_DISCOUNT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 DOC_DOC_FOOT_CHARGE_ID
       , 'DWH_NA' C_FINANCIAL_CHARGE
       , 'DWH_NA' C_ROUND_TYPE
       , 'DWH_NA' C_CALCULATION_MODE
       , 'N/A' FCH_DESCRIPTION
       , null FCH_EXCL_AMOUNT
       , null FCH_VAT_AMOUNT
       , null FCH_VAT_BASE_AMOUNT
       , null FCH_INCL_AMOUNT
       , null FCH_RATE
       , null FCH_EXPRESS_IN
       , null FCH_EXCL_AMOUNT_B
       , null FCH_EXCL_AMOUNT_E
       , null FCH_VAT_AMOUNT_E
       , null FCH_INCL_AMOUNT_B
       , null FCH_INCL_AMOUNT_E
       , '-1' FCH_TRANSFERT_PROP
       , '-1' FCH_MODIFY
       , '-1' FCH_IN_SERIES_CALCULATION
       , null FCH_BALANCE_AMOUNT
       , 'N/A' FCH_NAME
       , null FCH_CALC_AMOUNT
       , null FCH_CALC_AMOUNT_B
       , null FCH_CALC_AMOUNT_E
       , null FCH_LIABLED_AMOUNT
       , null FCH_LIABLED_AMOUNT_B
       , null FCH_LIABLED_AMOUNT_E
       , null FCH_FIXED_AMOUNT
       , null FCH_FIXED_AMOUNT_B
       , null FCH_FIXED_AMOUNT_E
       , null FCH_EXCEEDED_AMOUNT_FROM
       , null FCH_EXCEEDED_AMOUNT_TO
       , null FCH_MIN_AMOUNT
       , null FCH_MAX_AMOUNT
       , '-1' FCH_IS_MULTIPLICATOR
       , null FCH_ROUND_AMOUNT
       , 'N/A' FCH_STORED_PROC
       , '-1' FCH_AUTOMATIC_CALC
       , 'N/A' FCH_SQL_EXTERN_ITEM
       , -1 PAC_THIRD_ID
       , '-1' FCH_MODIFY_RATE
       , null FCH_EXCL_AMOUNT_V
       , null FCH_VAT_AMOUNT_V
       , null FCH_INCL_AMOUNT_V
       , null FCH_LIABLED_AMOUNT_V
       , -1 FAM_FIXED_ASSETS_ID
       , -1 HRM_PERSON_ID
       , 'N/A' FCH_IMP_TEXT_1
       , 'N/A' FCH_IMP_TEXT_2
       , 'N/A' FCH_IMP_TEXT_3
       , 'N/A' FCH_IMP_TEXT_4
       , 'N/A' FCH_IMP_TEXT_5
       , null FCH_IMP_NUMBER_1
       , null FCH_IMP_NUMBER_2
       , null FCH_IMP_NUMBER_3
       , null FCH_IMP_NUMBER_4
       , null FCH_IMP_NUMBER_5
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , '-1' FCH_EXCLUSIVE
       , 'DWH_NA' C_CHARGE_ORIGIN
       , -1 DOC_FOOT_CHARGE_SRC_ID
       , '-1' FCH_DISCHARGED
       , null FCH_VAT_LIABLED_RATE
       , null FCH_VAT_LIABLED_AMOUNT
       , null FCH_VAT_RATE
       , null FCH_VAT_TOTAL_AMOUNT
       , null FCH_VAT_TOTAL_AMOUNT_B
       , null FCH_VAT_TOTAL_AMOUNT_V
       , null FCH_VAT_DEDUCTIBLE_RATE
       , -1 DOC_POSITION_COST_ID
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , '-1' FCH_IMPUTATION
       , '-1' FCH_FROZEN
       , -1 DOC_INVOICE_EXPIRY_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_GAUGE" ("DOC_GAUGE_ID", "C_ADMIN_DOMAIN", "C_GAUGE_TYPE", "DIC_ADDRESS_TYPE_ID", "DIC_ADDRESS_TYPE1_ID", "DIC_ADDRESS_TYPE2_ID", "DIC_TYPE_DOC_CUSTOM_ID", "C_GAUGE_STATUS", "DIC_GAUGE_CATEG_ID", "DIC_GAUGE_TYPE_DOC_ID", "DIC_GAUGE_GROUP_ID", "PAC_THIRD_ID", "DOC_GAUGE_NUMBERING_ID", "DOC_GAUGE_SIGNATORY_ID", "DOC_DOC_GAUGE_SIGNATORY_ID", "PC_APPLTXT_ID", "PC_3_PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "PC__PC_APPLTXT_ID", "C_DIRECTION_NUMBER", "C_GAUGE_RECORD_VERIFY", "C_GAU_AUTO_CREATE_RECORD", "GAU_NUMBERING", "GAU_REF_PARTNER", "GAU_TRAVELLER", "GAU_DOSSIER", "GAU_CONFIRM_STATUS", "GAU_HISTORY", "GAU_EXPIRY", "GAU_SECOND_ADRESS", "GAU_DESCRIBE", "GAU_EDIFACT", "GAU_EDIT_NAME", "GAU_THIRD_ADRESS", "GAU_LOGO", "GAU_EDIT_NAME1", "GAU_EDIT_NAME2", "GAU_EDIT_NAME3", "GAU_EDIT_NAME4", "GAU_EDIT_NAME5", "GAU_EXPIRY_NBR", "GAU_EDIT_TEXT", "GAU_EDIT_TEXT1", "GAU_EDIT_TEXT2", "GAU_EDIT_TEXT3", "GAU_EDIT_TEXT4", "GAU_EDIT_TEXT5", "GAU_EDIT_BOOL1", "GAU_EDIT_BOOL2", "GAU_EDIT_BOOL3", "GAU_EDIT_BOOL4", "GAU_EDIT_BOOL5", "C_GAUGE_FORM_TYPE", "GAUGE_FORM_TYPE1", "GAUGE_FORM_TYPE2", "GAUGE_FORM_TYPE3", "GAUGE_FORM_TYPE4", "GAUGE_FORM_TYPE5", "C_APPLI_COPY_SUPP", "APPLI_COPY_SUPP1", "APPLI_COPY_SUPP2", "APPLI_COPY_SUPP3", "APPLI_COPY_SUPP4", "APPLI_COPY_SUPP5", "GAU_COLLATE_COPIES", "GAU_COLLATE_COPIES1", "GAU_COLLATE_COPIES2", "GAU_COLLATE_COPIES3", "GAU_COLLATE_COPIES4", "GAU_COLLATE_COPIES5", "GAU_CONFIRM_CANCEL", "GAU_SHOW_FORMS_ON_INSERT", "GAU_SHOW_FORMS_ON_UPDATE", "GAU_COPY_SOURCE_FREE_DATA", "GAU_INIT_DMT_DATE_DOCUMENT", "GAU_INIT_DMT_DATE_VALUE", "GAU_INIT_DMT_DATE_FALLING_DUE", "DIC_GAUGE_FREE_CODE_1_ID", "DIC_GAUGE_FREE_CODE_2_ID", "DIC_GAUGE_FREE_CODE_3_ID", "GAU_FREE_DATA_USE", "GAU_USE_MANAGED_DATA", "GAU_FREE_NUMBER1", "GAU_FREE_NUMBER2", "GAU_FREE_DATE1", "GAU_FREE_DATE2", "GAU_FREE_TEXT_LONG", "GAU_FREE_TEXT_SHORT", "GAU_FREE_BOOL1", "GAU_FREE_BOOL2", "C_PACKING_TYPE", "GAU_PAR_EDIT_NAME_1", "GAU_PAR_EDIT_NAME_2", "GAU_PAR_EDIT_NAME_3", "GAU_PAR_EDIT_NAME_4", "GAU_PAR_EDIT_NAME_5", "GAU_PAR_EDIT_NAME_6", "GAU_PAR_EDIT_TEXT_1", "GAU_PAR_EDIT_TEXT_2", "GAU_PAR_EDIT_TEXT_3", "GAU_PAR_EDIT_TEXT_4", "GAU_PAR_EDIT_TEXT_5", "GAU_PAR_EDIT_TEXT_6", "GAU_PAR_COPY_SUP_1", "GAU_PAR_COPY_SUP_2", "GAU_PAR_COPY_SUP_3", "GAU_PAR_COPY_SUP_4", "GAU_PAR_COPY_SUP_5", "GAU_PAR_COPY_SUP_6", "GAU_PAR_COLLATES_COPIES_1", "GAU_PAR_COLLATES_COPIES_2", "GAU_PAR_COLLATES_COPIES_3", "GAU_PAR_COLLATES_COPIES_4", "GAU_PAR_COLLATES_COPIES_5", "GAU_PAR_COLLATES_COPIES_6", "GAU_INCOTERMS", "GAU_COLLATE_PRINTED_REPORTS", "GAU_EDIT_BOOL", "GAU_REPORT_PRINT_TEST", "GAU_REPORT_PRINT_TEST1", "GAU_REPORT_PRINT_TEST2", "GAU_REPORT_PRINT_TEST3", "GAU_REPORT_PRINT_TEST4", "GAU_REPORT_PRINT_TEST5", "GAU_PAR_EDIT_BOOL1", "GAU_PAR_EDIT_BOOL2", "GAU_PAR_EDIT_BOOL3", "GAU_PAR_EDIT_BOOL4", "GAU_PAR_EDIT_BOOL5", "GAU_PAR_EDIT_BOOL6", "C_GAUGE_TYPE_COMMENT_VISIBLE", "GAU_ALWAYS_SHOW_COMMENT", "GAU_ADDR1_COMMENT_VISIBLE", "GAU_ADDR2_COMMENT_VISIBLE", "GAU_ADDR3_COMMENT_VISIBLE", "DIC_GAU_STATISTIC_1_ID", "DIC_GAU_STATISTIC_2_ID", "DIC_GAU_STATISTIC_3_ID", "GAU_BOOLEAN_1", "GAU_BOOLEAN_2", "GAU_BOOLEAN_3", "GAU_NUMERIC_1", "GAU_NUMERIC_2", "GAU_NUMERIC_3", "GAU_SHOW_FORMS_ON_CONFIRM", "GAU_CANCEL_STATUS", "GAU_ASA_RECORD", "PC_4_PC_APPLTXT_ID", "PC_5_PC_APPLTXT_ID", "PC_6_PC_APPLTXT_ID", "PC_7_PC_APPLTXT_ID", "GAU_APPLTXT_3", "GAU_APPLTXT_4", "GAU_APPLTXT_5", "GAU_APPLTXT_6", "GAU_APPLTXT_7", "GAU_PAR_EDIT_NAME_7", "GAU_PAR_EDIT_NAME_8", "GAU_PAR_EDIT_NAME_9", "GAU_PAR_EDIT_NAME_10", "GAU_PAR_EDIT_NAME_11", "GAU_PAR_EDIT_TEXT_7", "GAU_PAR_EDIT_TEXT_8", "GAU_PAR_EDIT_TEXT_9", "GAU_PAR_EDIT_TEXT_10", "GAU_PAR_EDIT_TEXT_11", "GAU_PAR_COPY_SUP_7", "GAU_PAR_COPY_SUP_8", "GAU_PAR_COPY_SUP_9", "GAU_PAR_COPY_SUP_10", "GAU_PAR_COPY_SUP_11", "GAU_PAR_COLLATES_COPIES_7", "GAU_PAR_COLLATES_COPIES_8", "GAU_PAR_COLLATES_COPIES_9", "GAU_PAR_COLLATES_COPIES_10", "GAU_PAR_COLLATES_COPIES_11", "GAU_PAR_EDIT_BOOL7", "GAU_PAR_EDIT_BOOL8", "GAU_PAR_EDIT_BOOL9", "GAU_PAR_EDIT_BOOL10", "GAU_PAR_EDIT_BOOL11", "GAUGE_FORM_TYPE6", "GAUGE_FORM_TYPE7", "GAUGE_FORM_TYPE8", "GAUGE_FORM_TYPE9", "GAUGE_FORM_TYPE10", "APPLI_COPY_SUPP6", "APPLI_COPY_SUPP7", "APPLI_COPY_SUPP8", "APPLI_COPY_SUPP9", "APPLI_COPY_SUPP10", "GAU_EDIT_NAME6", "GAU_EDIT_NAME7", "GAU_EDIT_NAME8", "GAU_EDIT_NAME9", "GAU_EDIT_NAME10", "GAU_EDIT_TEXT6", "GAU_EDIT_TEXT7", "GAU_EDIT_TEXT8", "GAU_EDIT_TEXT9", "GAU_EDIT_TEXT10", "GAU_EDIT_BOOL6", "GAU_EDIT_BOOL7", "GAU_EDIT_BOOL8", "GAU_EDIT_BOOL9", "GAU_EDIT_BOOL10", "GAU_COLLATE_COPIES6", "GAU_COLLATE_COPIES7", "GAU_COLLATE_COPIES8", "GAU_COLLATE_COPIES9", "GAU_COLLATE_COPIES10", "GAU_REPORT_PRINT_TEST6", "GAU_REPORT_PRINT_TEST7", "GAU_REPORT_PRINT_TEST8", "GAU_REPORT_PRINT_TEST9", "GAU_REPORT_PRINT_TEST10", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_ACI_ID", "C_GAU_THIRD_VAT", "C_GAU_INCOTERMS", "GAU_DISPLAY_SEQ1", "GAU_DISPLAY_SEQ2", "GAU_DISPLAY_SEQ3", "GAU_QAS_CONTROL", "DOC_RECORD_CATEGORY_ID") AS
  select DOC_GAUGE_ID
       , Nvl(C_ADMIN_DOMAIN, 'DWH_ISNULL') C_ADMIN_DOMAIN
       , Nvl(C_GAUGE_TYPE, 'DWH_ISNULL') C_GAUGE_TYPE
       , Nvl(DIC_ADDRESS_TYPE_ID, 'DWH_ISNULL') DIC_ADDRESS_TYPE_ID
       , Nvl(DIC_ADDRESS_TYPE1_ID, 'DWH_ISNULL') DIC_ADDRESS_TYPE1_ID
       , Nvl(DIC_ADDRESS_TYPE2_ID, 'DWH_ISNULL') DIC_ADDRESS_TYPE2_ID
       , Nvl(DIC_TYPE_DOC_CUSTOM_ID, 'DWH_ISNULL') DIC_TYPE_DOC_CUSTOM_ID
       , Nvl(C_GAUGE_STATUS, 'DWH_ISNULL') C_GAUGE_STATUS
       , Nvl(DIC_GAUGE_CATEG_ID, 'DWH_ISNULL') DIC_GAUGE_CATEG_ID
       , Nvl(DIC_GAUGE_TYPE_DOC_ID, 'DWH_ISNULL') DIC_GAUGE_TYPE_DOC_ID
       , Nvl(DIC_GAUGE_GROUP_ID, 'DWH_ISNULL') DIC_GAUGE_GROUP_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(DOC_GAUGE_NUMBERING_ID, -2) DOC_GAUGE_NUMBERING_ID
       , Nvl(DOC_GAUGE_SIGNATORY_ID, -2) DOC_GAUGE_SIGNATORY_ID
       , Nvl(DOC_DOC_GAUGE_SIGNATORY_ID, -2) DOC_DOC_GAUGE_SIGNATORY_ID
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl(PC_3_PC_APPLTXT_ID, -2) PC_3_PC_APPLTXT_ID
       , Nvl(PC_2_PC_APPLTXT_ID, -2) PC_2_PC_APPLTXT_ID
       , Nvl(PC__PC_APPLTXT_ID, -2) PC__PC_APPLTXT_ID
       , Nvl(C_DIRECTION_NUMBER, 'DWH_ISNULL') C_DIRECTION_NUMBER
       , Nvl(C_GAUGE_RECORD_VERIFY, 'DWH_ISNULL') C_GAUGE_RECORD_VERIFY
       , Nvl(C_GAU_AUTO_CREATE_RECORD, 'DWH_ISNULL') C_GAU_AUTO_CREATE_RECORD
       , Nvl2(GAU_NUMBERING, case
                when(GAU_NUMBERING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_NUMBERING
       , Nvl2(GAU_REF_PARTNER, case
                when(GAU_REF_PARTNER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_REF_PARTNER
       , Nvl2(GAU_TRAVELLER, case
                when(GAU_TRAVELLER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_TRAVELLER
       , Nvl2(GAU_DOSSIER, case
                when(GAU_DOSSIER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_DOSSIER
       , Nvl2(GAU_CONFIRM_STATUS, case
                when(GAU_CONFIRM_STATUS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_CONFIRM_STATUS
       , Nvl2(GAU_HISTORY, case
                when(GAU_HISTORY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_HISTORY
       , Nvl2(GAU_EXPIRY, case
                when(GAU_EXPIRY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EXPIRY
       , Nvl2(GAU_SECOND_ADRESS, case
                when(GAU_SECOND_ADRESS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_SECOND_ADRESS
       , Nvl(GAU_DESCRIBE, '_') GAU_DESCRIBE
       , Nvl(GAU_EDIFACT, '_') GAU_EDIFACT
       , Nvl(GAU_EDIT_NAME, '_') GAU_EDIT_NAME
       , Nvl2(GAU_THIRD_ADRESS, case
                when(GAU_THIRD_ADRESS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_THIRD_ADRESS
       , Nvl(GAU_LOGO, '_') GAU_LOGO
       , Nvl(GAU_EDIT_NAME1, '_') GAU_EDIT_NAME1
       , Nvl(GAU_EDIT_NAME2, '_') GAU_EDIT_NAME2
       , Nvl(GAU_EDIT_NAME3, '_') GAU_EDIT_NAME3
       , Nvl(GAU_EDIT_NAME4, '_') GAU_EDIT_NAME4
       , Nvl(GAU_EDIT_NAME5, '_') GAU_EDIT_NAME5
       , GAU_EXPIRY_NBR
       , Nvl(GAU_EDIT_TEXT, '_') GAU_EDIT_TEXT
       , Nvl(GAU_EDIT_TEXT1, '_') GAU_EDIT_TEXT1
       , Nvl(GAU_EDIT_TEXT2, '_') GAU_EDIT_TEXT2
       , Nvl(GAU_EDIT_TEXT3, '_') GAU_EDIT_TEXT3
       , Nvl(GAU_EDIT_TEXT4, '_') GAU_EDIT_TEXT4
       , Nvl(GAU_EDIT_TEXT5, '_') GAU_EDIT_TEXT5
       , Nvl2(GAU_EDIT_BOOL1, case
                when(GAU_EDIT_BOOL1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL1
       , Nvl2(GAU_EDIT_BOOL2, case
                when(GAU_EDIT_BOOL2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL2
       , Nvl2(GAU_EDIT_BOOL3, case
                when(GAU_EDIT_BOOL3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL3
       , Nvl2(GAU_EDIT_BOOL4, case
                when(GAU_EDIT_BOOL4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL4
       , Nvl2(GAU_EDIT_BOOL5, case
                when(GAU_EDIT_BOOL5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL5
       , Nvl(C_GAUGE_FORM_TYPE, 'DWH_ISNULL') C_GAUGE_FORM_TYPE
       , Nvl(GAUGE_FORM_TYPE1, '_') GAUGE_FORM_TYPE1
       , Nvl(GAUGE_FORM_TYPE2, '_') GAUGE_FORM_TYPE2
       , Nvl(GAUGE_FORM_TYPE3, '_') GAUGE_FORM_TYPE3
       , Nvl(GAUGE_FORM_TYPE4, '_') GAUGE_FORM_TYPE4
       , Nvl(GAUGE_FORM_TYPE5, '_') GAUGE_FORM_TYPE5
       , Nvl(C_APPLI_COPY_SUPP, 'DWH_ISNULL') C_APPLI_COPY_SUPP
       , Nvl(APPLI_COPY_SUPP1, '_') APPLI_COPY_SUPP1
       , Nvl(APPLI_COPY_SUPP2, '_') APPLI_COPY_SUPP2
       , Nvl(APPLI_COPY_SUPP3, '_') APPLI_COPY_SUPP3
       , Nvl(APPLI_COPY_SUPP4, '_') APPLI_COPY_SUPP4
       , Nvl(APPLI_COPY_SUPP5, '_') APPLI_COPY_SUPP5
       , Nvl2(GAU_COLLATE_COPIES, case
                when(GAU_COLLATE_COPIES = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES
       , Nvl2(GAU_COLLATE_COPIES1, case
                when(GAU_COLLATE_COPIES1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES1
       , Nvl2(GAU_COLLATE_COPIES2, case
                when(GAU_COLLATE_COPIES2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES2
       , Nvl2(GAU_COLLATE_COPIES3, case
                when(GAU_COLLATE_COPIES3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES3
       , Nvl2(GAU_COLLATE_COPIES4, case
                when(GAU_COLLATE_COPIES4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES4
       , Nvl2(GAU_COLLATE_COPIES5, case
                when(GAU_COLLATE_COPIES5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES5
       , Nvl2(GAU_CONFIRM_CANCEL, case
                when(GAU_CONFIRM_CANCEL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_CONFIRM_CANCEL
       , Nvl2(GAU_SHOW_FORMS_ON_INSERT, case
                when(GAU_SHOW_FORMS_ON_INSERT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_SHOW_FORMS_ON_INSERT
       , Nvl2(GAU_SHOW_FORMS_ON_UPDATE, case
                when(GAU_SHOW_FORMS_ON_UPDATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_SHOW_FORMS_ON_UPDATE
       , Nvl2(GAU_COPY_SOURCE_FREE_DATA, case
                when(GAU_COPY_SOURCE_FREE_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COPY_SOURCE_FREE_DATA
       , Nvl2(GAU_INIT_DMT_DATE_DOCUMENT, case
                when(GAU_INIT_DMT_DATE_DOCUMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_INIT_DMT_DATE_DOCUMENT
       , Nvl2(GAU_INIT_DMT_DATE_VALUE, case
                when(GAU_INIT_DMT_DATE_VALUE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_INIT_DMT_DATE_VALUE
       , Nvl2(GAU_INIT_DMT_DATE_FALLING_DUE
            , case
                when(GAU_INIT_DMT_DATE_FALLING_DUE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end
            , '-2'
             ) GAU_INIT_DMT_DATE_FALLING_DUE
       , Nvl(DIC_GAUGE_FREE_CODE_1_ID, 'DWH_ISNULL') DIC_GAUGE_FREE_CODE_1_ID
       , Nvl(DIC_GAUGE_FREE_CODE_2_ID, 'DWH_ISNULL') DIC_GAUGE_FREE_CODE_2_ID
       , Nvl(DIC_GAUGE_FREE_CODE_3_ID, 'DWH_ISNULL') DIC_GAUGE_FREE_CODE_3_ID
       , Nvl2(GAU_FREE_DATA_USE, case
                when(GAU_FREE_DATA_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_FREE_DATA_USE
       , Nvl2(GAU_USE_MANAGED_DATA, case
                when(GAU_USE_MANAGED_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_USE_MANAGED_DATA
       , GAU_FREE_NUMBER1
       , GAU_FREE_NUMBER2
       , Nvl(GAU_FREE_DATE1, to_date('40000101', 'YYYYMMDD') ) GAU_FREE_DATE1
       , Nvl(GAU_FREE_DATE2, to_date('40000101', 'YYYYMMDD') ) GAU_FREE_DATE2
       , Nvl(GAU_FREE_TEXT_LONG, '_') GAU_FREE_TEXT_LONG
       , Nvl(GAU_FREE_TEXT_SHORT, '_') GAU_FREE_TEXT_SHORT
       , Nvl2(GAU_FREE_BOOL1, case
                when(GAU_FREE_BOOL1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_FREE_BOOL1
       , Nvl2(GAU_FREE_BOOL2, case
                when(GAU_FREE_BOOL2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_FREE_BOOL2
       , Nvl(C_PACKING_TYPE, 'DWH_ISNULL') C_PACKING_TYPE
       , Nvl(GAU_PAR_EDIT_NAME_1, '_') GAU_PAR_EDIT_NAME_1
       , Nvl(GAU_PAR_EDIT_NAME_2, '_') GAU_PAR_EDIT_NAME_2
       , Nvl(GAU_PAR_EDIT_NAME_3, '_') GAU_PAR_EDIT_NAME_3
       , Nvl(GAU_PAR_EDIT_NAME_4, '_') GAU_PAR_EDIT_NAME_4
       , Nvl(GAU_PAR_EDIT_NAME_5, '_') GAU_PAR_EDIT_NAME_5
       , Nvl(GAU_PAR_EDIT_NAME_6, '_') GAU_PAR_EDIT_NAME_6
       , Nvl(GAU_PAR_EDIT_TEXT_1, '_') GAU_PAR_EDIT_TEXT_1
       , Nvl(GAU_PAR_EDIT_TEXT_2, '_') GAU_PAR_EDIT_TEXT_2
       , Nvl(GAU_PAR_EDIT_TEXT_3, '_') GAU_PAR_EDIT_TEXT_3
       , Nvl(GAU_PAR_EDIT_TEXT_4, '_') GAU_PAR_EDIT_TEXT_4
       , Nvl(GAU_PAR_EDIT_TEXT_5, '_') GAU_PAR_EDIT_TEXT_5
       , Nvl(GAU_PAR_EDIT_TEXT_6, '_') GAU_PAR_EDIT_TEXT_6
       , Nvl(GAU_PAR_COPY_SUP_1, '_') GAU_PAR_COPY_SUP_1
       , Nvl(GAU_PAR_COPY_SUP_2, '_') GAU_PAR_COPY_SUP_2
       , Nvl(GAU_PAR_COPY_SUP_3, '_') GAU_PAR_COPY_SUP_3
       , Nvl(GAU_PAR_COPY_SUP_4, '_') GAU_PAR_COPY_SUP_4
       , Nvl(GAU_PAR_COPY_SUP_5, '_') GAU_PAR_COPY_SUP_5
       , Nvl(GAU_PAR_COPY_SUP_6, '_') GAU_PAR_COPY_SUP_6
       , Nvl2(GAU_PAR_COLLATES_COPIES_1, case
                when(GAU_PAR_COLLATES_COPIES_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_1
       , Nvl2(GAU_PAR_COLLATES_COPIES_2, case
                when(GAU_PAR_COLLATES_COPIES_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_2
       , Nvl2(GAU_PAR_COLLATES_COPIES_3, case
                when(GAU_PAR_COLLATES_COPIES_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_3
       , Nvl2(GAU_PAR_COLLATES_COPIES_4, case
                when(GAU_PAR_COLLATES_COPIES_4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_4
       , Nvl2(GAU_PAR_COLLATES_COPIES_5, case
                when(GAU_PAR_COLLATES_COPIES_5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_5
       , Nvl2(GAU_PAR_COLLATES_COPIES_6, case
                when(GAU_PAR_COLLATES_COPIES_6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_6
       , Nvl2(GAU_INCOTERMS, case
                when(GAU_INCOTERMS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_INCOTERMS
       , Nvl2(GAU_COLLATE_PRINTED_REPORTS, case
                when(GAU_COLLATE_PRINTED_REPORTS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_PRINTED_REPORTS
       , Nvl2(GAU_EDIT_BOOL, case
                when(GAU_EDIT_BOOL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL
       , Nvl(GAU_REPORT_PRINT_TEST, '_') GAU_REPORT_PRINT_TEST
       , Nvl(GAU_REPORT_PRINT_TEST1, '_') GAU_REPORT_PRINT_TEST1
       , Nvl(GAU_REPORT_PRINT_TEST2, '_') GAU_REPORT_PRINT_TEST2
       , Nvl(GAU_REPORT_PRINT_TEST3, '_') GAU_REPORT_PRINT_TEST3
       , Nvl(GAU_REPORT_PRINT_TEST4, '_') GAU_REPORT_PRINT_TEST4
       , Nvl(GAU_REPORT_PRINT_TEST5, '_') GAU_REPORT_PRINT_TEST5
       , Nvl2(GAU_PAR_EDIT_BOOL1, case
                when(GAU_PAR_EDIT_BOOL1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL1
       , Nvl2(GAU_PAR_EDIT_BOOL2, case
                when(GAU_PAR_EDIT_BOOL2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL2
       , Nvl2(GAU_PAR_EDIT_BOOL3, case
                when(GAU_PAR_EDIT_BOOL3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL3
       , Nvl2(GAU_PAR_EDIT_BOOL4, case
                when(GAU_PAR_EDIT_BOOL4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL4
       , Nvl2(GAU_PAR_EDIT_BOOL5, case
                when(GAU_PAR_EDIT_BOOL5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL5
       , Nvl2(GAU_PAR_EDIT_BOOL6, case
                when(GAU_PAR_EDIT_BOOL6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL6
       , Nvl(C_GAUGE_TYPE_COMMENT_VISIBLE, 'DWH_ISNULL') C_GAUGE_TYPE_COMMENT_VISIBLE
       , Nvl2(GAU_ALWAYS_SHOW_COMMENT, case
                when(GAU_ALWAYS_SHOW_COMMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_ALWAYS_SHOW_COMMENT
       , Nvl2(GAU_ADDR1_COMMENT_VISIBLE, case
                when(GAU_ADDR1_COMMENT_VISIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_ADDR1_COMMENT_VISIBLE
       , Nvl2(GAU_ADDR2_COMMENT_VISIBLE, case
                when(GAU_ADDR2_COMMENT_VISIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_ADDR2_COMMENT_VISIBLE
       , Nvl2(GAU_ADDR3_COMMENT_VISIBLE, case
                when(GAU_ADDR3_COMMENT_VISIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_ADDR3_COMMENT_VISIBLE
       , Nvl(DIC_GAU_STATISTIC_1_ID, 'DWH_ISNULL') DIC_GAU_STATISTIC_1_ID
       , Nvl(DIC_GAU_STATISTIC_2_ID, 'DWH_ISNULL') DIC_GAU_STATISTIC_2_ID
       , Nvl(DIC_GAU_STATISTIC_3_ID, 'DWH_ISNULL') DIC_GAU_STATISTIC_3_ID
       , Nvl2(GAU_BOOLEAN_1, case
                when(GAU_BOOLEAN_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_BOOLEAN_1
       , Nvl2(GAU_BOOLEAN_2, case
                when(GAU_BOOLEAN_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_BOOLEAN_2
       , Nvl2(GAU_BOOLEAN_3, case
                when(GAU_BOOLEAN_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_BOOLEAN_3
       , GAU_NUMERIC_1
       , GAU_NUMERIC_2
       , GAU_NUMERIC_3
       , Nvl2(GAU_SHOW_FORMS_ON_CONFIRM, case
                when(GAU_SHOW_FORMS_ON_CONFIRM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_SHOW_FORMS_ON_CONFIRM
       , Nvl2(GAU_CANCEL_STATUS, case
                when(GAU_CANCEL_STATUS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_CANCEL_STATUS
       , Nvl2(GAU_ASA_RECORD, case
                when(GAU_ASA_RECORD = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_ASA_RECORD
       , Nvl(PC_4_PC_APPLTXT_ID, -2) PC_4_PC_APPLTXT_ID
       , Nvl(PC_5_PC_APPLTXT_ID, -2) PC_5_PC_APPLTXT_ID
       , Nvl(PC_6_PC_APPLTXT_ID, -2) PC_6_PC_APPLTXT_ID
       , Nvl(PC_7_PC_APPLTXT_ID, -2) PC_7_PC_APPLTXT_ID
       , Nvl2(GAU_APPLTXT_3, case
                when(GAU_APPLTXT_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_APPLTXT_3
       , Nvl2(GAU_APPLTXT_4, case
                when(GAU_APPLTXT_4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_APPLTXT_4
       , Nvl2(GAU_APPLTXT_5, case
                when(GAU_APPLTXT_5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_APPLTXT_5
       , Nvl2(GAU_APPLTXT_6, case
                when(GAU_APPLTXT_6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_APPLTXT_6
       , Nvl2(GAU_APPLTXT_7, case
                when(GAU_APPLTXT_7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_APPLTXT_7
       , Nvl(GAU_PAR_EDIT_NAME_7, '_') GAU_PAR_EDIT_NAME_7
       , Nvl(GAU_PAR_EDIT_NAME_8, '_') GAU_PAR_EDIT_NAME_8
       , Nvl(GAU_PAR_EDIT_NAME_9, '_') GAU_PAR_EDIT_NAME_9
       , Nvl(GAU_PAR_EDIT_NAME_10, '_') GAU_PAR_EDIT_NAME_10
       , Nvl(GAU_PAR_EDIT_NAME_11, '_') GAU_PAR_EDIT_NAME_11
       , Nvl(GAU_PAR_EDIT_TEXT_7, '_') GAU_PAR_EDIT_TEXT_7
       , Nvl(GAU_PAR_EDIT_TEXT_8, '_') GAU_PAR_EDIT_TEXT_8
       , Nvl(GAU_PAR_EDIT_TEXT_9, '_') GAU_PAR_EDIT_TEXT_9
       , Nvl(GAU_PAR_EDIT_TEXT_10, '_') GAU_PAR_EDIT_TEXT_10
       , Nvl(GAU_PAR_EDIT_TEXT_11, '_') GAU_PAR_EDIT_TEXT_11
       , Nvl(GAU_PAR_COPY_SUP_7, '_') GAU_PAR_COPY_SUP_7
       , Nvl(GAU_PAR_COPY_SUP_8, '_') GAU_PAR_COPY_SUP_8
       , Nvl(GAU_PAR_COPY_SUP_9, '_') GAU_PAR_COPY_SUP_9
       , Nvl(GAU_PAR_COPY_SUP_10, '_') GAU_PAR_COPY_SUP_10
       , Nvl(GAU_PAR_COPY_SUP_11, '_') GAU_PAR_COPY_SUP_11
       , Nvl2(GAU_PAR_COLLATES_COPIES_7, case
                when(GAU_PAR_COLLATES_COPIES_7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_7
       , Nvl2(GAU_PAR_COLLATES_COPIES_8, case
                when(GAU_PAR_COLLATES_COPIES_8 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_8
       , Nvl2(GAU_PAR_COLLATES_COPIES_9, case
                when(GAU_PAR_COLLATES_COPIES_9 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_9
       , Nvl2(GAU_PAR_COLLATES_COPIES_10, case
                when(GAU_PAR_COLLATES_COPIES_10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_10
       , Nvl2(GAU_PAR_COLLATES_COPIES_11, case
                when(GAU_PAR_COLLATES_COPIES_11 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_COLLATES_COPIES_11
       , Nvl2(GAU_PAR_EDIT_BOOL7, case
                when(GAU_PAR_EDIT_BOOL7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL7
       , Nvl2(GAU_PAR_EDIT_BOOL8, case
                when(GAU_PAR_EDIT_BOOL8 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL8
       , Nvl2(GAU_PAR_EDIT_BOOL9, case
                when(GAU_PAR_EDIT_BOOL9 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL9
       , Nvl2(GAU_PAR_EDIT_BOOL10, case
                when(GAU_PAR_EDIT_BOOL10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL10
       , Nvl2(GAU_PAR_EDIT_BOOL11, case
                when(GAU_PAR_EDIT_BOOL11 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_PAR_EDIT_BOOL11
       , Nvl(GAUGE_FORM_TYPE6, '_') GAUGE_FORM_TYPE6
       , Nvl(GAUGE_FORM_TYPE7, '_') GAUGE_FORM_TYPE7
       , Nvl(GAUGE_FORM_TYPE8, '_') GAUGE_FORM_TYPE8
       , Nvl(GAUGE_FORM_TYPE9, '_') GAUGE_FORM_TYPE9
       , Nvl(GAUGE_FORM_TYPE10, '_') GAUGE_FORM_TYPE10
       , Nvl(APPLI_COPY_SUPP6, '_') APPLI_COPY_SUPP6
       , Nvl(APPLI_COPY_SUPP7, '_') APPLI_COPY_SUPP7
       , Nvl(APPLI_COPY_SUPP8, '_') APPLI_COPY_SUPP8
       , Nvl(APPLI_COPY_SUPP9, '_') APPLI_COPY_SUPP9
       , Nvl(APPLI_COPY_SUPP10, '_') APPLI_COPY_SUPP10
       , Nvl(GAU_EDIT_NAME6, '_') GAU_EDIT_NAME6
       , Nvl(GAU_EDIT_NAME7, '_') GAU_EDIT_NAME7
       , Nvl(GAU_EDIT_NAME8, '_') GAU_EDIT_NAME8
       , Nvl(GAU_EDIT_NAME9, '_') GAU_EDIT_NAME9
       , Nvl(GAU_EDIT_NAME10, '_') GAU_EDIT_NAME10
       , Nvl(GAU_EDIT_TEXT6, '_') GAU_EDIT_TEXT6
       , Nvl(GAU_EDIT_TEXT7, '_') GAU_EDIT_TEXT7
       , Nvl(GAU_EDIT_TEXT8, '_') GAU_EDIT_TEXT8
       , Nvl(GAU_EDIT_TEXT9, '_') GAU_EDIT_TEXT9
       , Nvl(GAU_EDIT_TEXT10, '_') GAU_EDIT_TEXT10
       , Nvl2(GAU_EDIT_BOOL6, case
                when(GAU_EDIT_BOOL6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL6
       , Nvl2(GAU_EDIT_BOOL7, case
                when(GAU_EDIT_BOOL7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL7
       , Nvl2(GAU_EDIT_BOOL8, case
                when(GAU_EDIT_BOOL8 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL8
       , Nvl2(GAU_EDIT_BOOL9, case
                when(GAU_EDIT_BOOL9 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL9
       , Nvl2(GAU_EDIT_BOOL10, case
                when(GAU_EDIT_BOOL10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_EDIT_BOOL10
       , Nvl2(GAU_COLLATE_COPIES6, case
                when(GAU_COLLATE_COPIES6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES6
       , Nvl2(GAU_COLLATE_COPIES7, case
                when(GAU_COLLATE_COPIES7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES7
       , Nvl2(GAU_COLLATE_COPIES8, case
                when(GAU_COLLATE_COPIES8 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES8
       , Nvl2(GAU_COLLATE_COPIES9, case
                when(GAU_COLLATE_COPIES9 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES9
       , Nvl2(GAU_COLLATE_COPIES10, case
                when(GAU_COLLATE_COPIES10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_COLLATE_COPIES10
       , Nvl(GAU_REPORT_PRINT_TEST6, '_') GAU_REPORT_PRINT_TEST6
       , Nvl(GAU_REPORT_PRINT_TEST7, '_') GAU_REPORT_PRINT_TEST7
       , Nvl(GAU_REPORT_PRINT_TEST8, '_') GAU_REPORT_PRINT_TEST8
       , Nvl(GAU_REPORT_PRINT_TEST9, '_') GAU_REPORT_PRINT_TEST9
       , Nvl(GAU_REPORT_PRINT_TEST10, '_') GAU_REPORT_PRINT_TEST10
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(C_GAU_THIRD_VAT, 'DWH_ISNULL') C_GAU_THIRD_VAT
       , Nvl(C_GAU_INCOTERMS, 'DWH_ISNULL') C_GAU_INCOTERMS
       , GAU_DISPLAY_SEQ1
       , GAU_DISPLAY_SEQ2
       , GAU_DISPLAY_SEQ3
       , Nvl2(GAU_QAS_CONTROL, case
                when(GAU_QAS_CONTROL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAU_QAS_CONTROL
       , Nvl(DOC_RECORD_CATEGORY_ID, -2) DOC_RECORD_CATEGORY_ID
  from DOC_GAUGE
  union all
  select -1 DOC_GAUGE_ID
       , 'DWH_NA' C_ADMIN_DOMAIN
       , 'DWH_NA' C_GAUGE_TYPE
       , 'DWH_NA' DIC_ADDRESS_TYPE_ID
       , 'DWH_NA' DIC_ADDRESS_TYPE1_ID
       , 'DWH_NA' DIC_ADDRESS_TYPE2_ID
       , 'DWH_NA' DIC_TYPE_DOC_CUSTOM_ID
       , 'DWH_NA' C_GAUGE_STATUS
       , 'DWH_NA' DIC_GAUGE_CATEG_ID
       , 'DWH_NA' DIC_GAUGE_TYPE_DOC_ID
       , 'DWH_NA' DIC_GAUGE_GROUP_ID
       , -1 PAC_THIRD_ID
       , -1 DOC_GAUGE_NUMBERING_ID
       , -1 DOC_GAUGE_SIGNATORY_ID
       , -1 DOC_DOC_GAUGE_SIGNATORY_ID
       , -1 PC_APPLTXT_ID
       , -1 PC_3_PC_APPLTXT_ID
       , -1 PC_2_PC_APPLTXT_ID
       , -1 PC__PC_APPLTXT_ID
       , 'DWH_NA' C_DIRECTION_NUMBER
       , 'DWH_NA' C_GAUGE_RECORD_VERIFY
       , 'DWH_NA' C_GAU_AUTO_CREATE_RECORD
       , '-1' GAU_NUMBERING
       , '-1' GAU_REF_PARTNER
       , '-1' GAU_TRAVELLER
       , '-1' GAU_DOSSIER
       , '-1' GAU_CONFIRM_STATUS
       , '-1' GAU_HISTORY
       , '-1' GAU_EXPIRY
       , '-1' GAU_SECOND_ADRESS
       , 'N/A' GAU_DESCRIBE
       , 'N/A' GAU_EDIFACT
       , 'N/A' GAU_EDIT_NAME
       , '-1' GAU_THIRD_ADRESS
       , 'N/A' GAU_LOGO
       , 'N/A' GAU_EDIT_NAME1
       , 'N/A' GAU_EDIT_NAME2
       , 'N/A' GAU_EDIT_NAME3
       , 'N/A' GAU_EDIT_NAME4
       , 'N/A' GAU_EDIT_NAME5
       , null GAU_EXPIRY_NBR
       , 'N/A' GAU_EDIT_TEXT
       , 'N/A' GAU_EDIT_TEXT1
       , 'N/A' GAU_EDIT_TEXT2
       , 'N/A' GAU_EDIT_TEXT3
       , 'N/A' GAU_EDIT_TEXT4
       , 'N/A' GAU_EDIT_TEXT5
       , '-1' GAU_EDIT_BOOL1
       , '-1' GAU_EDIT_BOOL2
       , '-1' GAU_EDIT_BOOL3
       , '-1' GAU_EDIT_BOOL4
       , '-1' GAU_EDIT_BOOL5
       , 'DWH_NA' C_GAUGE_FORM_TYPE
       , 'N/A' GAUGE_FORM_TYPE1
       , 'N/A' GAUGE_FORM_TYPE2
       , 'N/A' GAUGE_FORM_TYPE3
       , 'N/A' GAUGE_FORM_TYPE4
       , 'N/A' GAUGE_FORM_TYPE5
       , 'DWH_NA' C_APPLI_COPY_SUPP
       , 'N/A' APPLI_COPY_SUPP1
       , 'N/A' APPLI_COPY_SUPP2
       , 'N/A' APPLI_COPY_SUPP3
       , 'N/A' APPLI_COPY_SUPP4
       , 'N/A' APPLI_COPY_SUPP5
       , '-1' GAU_COLLATE_COPIES
       , '-1' GAU_COLLATE_COPIES1
       , '-1' GAU_COLLATE_COPIES2
       , '-1' GAU_COLLATE_COPIES3
       , '-1' GAU_COLLATE_COPIES4
       , '-1' GAU_COLLATE_COPIES5
       , '-1' GAU_CONFIRM_CANCEL
       , '-1' GAU_SHOW_FORMS_ON_INSERT
       , '-1' GAU_SHOW_FORMS_ON_UPDATE
       , '-1' GAU_COPY_SOURCE_FREE_DATA
       , '-1' GAU_INIT_DMT_DATE_DOCUMENT
       , '-1' GAU_INIT_DMT_DATE_VALUE
       , '-1' GAU_INIT_DMT_DATE_FALLING_DUE
       , 'DWH_NA' DIC_GAUGE_FREE_CODE_1_ID
       , 'DWH_NA' DIC_GAUGE_FREE_CODE_2_ID
       , 'DWH_NA' DIC_GAUGE_FREE_CODE_3_ID
       , '-1' GAU_FREE_DATA_USE
       , '-1' GAU_USE_MANAGED_DATA
       , null GAU_FREE_NUMBER1
       , null GAU_FREE_NUMBER2
       , to_date('00010101', 'YYYYMMDD') GAU_FREE_DATE1
       , to_date('00010101', 'YYYYMMDD') GAU_FREE_DATE2
       , 'N/A' GAU_FREE_TEXT_LONG
       , 'N/A' GAU_FREE_TEXT_SHORT
       , '-1' GAU_FREE_BOOL1
       , '-1' GAU_FREE_BOOL2
       , 'DWH_NA' C_PACKING_TYPE
       , 'N/A' GAU_PAR_EDIT_NAME_1
       , 'N/A' GAU_PAR_EDIT_NAME_2
       , 'N/A' GAU_PAR_EDIT_NAME_3
       , 'N/A' GAU_PAR_EDIT_NAME_4
       , 'N/A' GAU_PAR_EDIT_NAME_5
       , 'N/A' GAU_PAR_EDIT_NAME_6
       , 'N/A' GAU_PAR_EDIT_TEXT_1
       , 'N/A' GAU_PAR_EDIT_TEXT_2
       , 'N/A' GAU_PAR_EDIT_TEXT_3
       , 'N/A' GAU_PAR_EDIT_TEXT_4
       , 'N/A' GAU_PAR_EDIT_TEXT_5
       , 'N/A' GAU_PAR_EDIT_TEXT_6
       , 'N/A' GAU_PAR_COPY_SUP_1
       , 'N/A' GAU_PAR_COPY_SUP_2
       , 'N/A' GAU_PAR_COPY_SUP_3
       , 'N/A' GAU_PAR_COPY_SUP_4
       , 'N/A' GAU_PAR_COPY_SUP_5
       , 'N/A' GAU_PAR_COPY_SUP_6
       , '-1' GAU_PAR_COLLATES_COPIES_1
       , '-1' GAU_PAR_COLLATES_COPIES_2
       , '-1' GAU_PAR_COLLATES_COPIES_3
       , '-1' GAU_PAR_COLLATES_COPIES_4
       , '-1' GAU_PAR_COLLATES_COPIES_5
       , '-1' GAU_PAR_COLLATES_COPIES_6
       , '-1' GAU_INCOTERMS
       , '-1' GAU_COLLATE_PRINTED_REPORTS
       , '-1' GAU_EDIT_BOOL
       , 'N/A' GAU_REPORT_PRINT_TEST
       , 'N/A' GAU_REPORT_PRINT_TEST1
       , 'N/A' GAU_REPORT_PRINT_TEST2
       , 'N/A' GAU_REPORT_PRINT_TEST3
       , 'N/A' GAU_REPORT_PRINT_TEST4
       , 'N/A' GAU_REPORT_PRINT_TEST5
       , '-1' GAU_PAR_EDIT_BOOL1
       , '-1' GAU_PAR_EDIT_BOOL2
       , '-1' GAU_PAR_EDIT_BOOL3
       , '-1' GAU_PAR_EDIT_BOOL4
       , '-1' GAU_PAR_EDIT_BOOL5
       , '-1' GAU_PAR_EDIT_BOOL6
       , 'DWH_NA' C_GAUGE_TYPE_COMMENT_VISIBLE
       , '-1' GAU_ALWAYS_SHOW_COMMENT
       , '-1' GAU_ADDR1_COMMENT_VISIBLE
       , '-1' GAU_ADDR2_COMMENT_VISIBLE
       , '-1' GAU_ADDR3_COMMENT_VISIBLE
       , 'DWH_NA' DIC_GAU_STATISTIC_1_ID
       , 'DWH_NA' DIC_GAU_STATISTIC_2_ID
       , 'DWH_NA' DIC_GAU_STATISTIC_3_ID
       , '-1' GAU_BOOLEAN_1
       , '-1' GAU_BOOLEAN_2
       , '-1' GAU_BOOLEAN_3
       , null GAU_NUMERIC_1
       , null GAU_NUMERIC_2
       , null GAU_NUMERIC_3
       , '-1' GAU_SHOW_FORMS_ON_CONFIRM
       , '-1' GAU_CANCEL_STATUS
       , '-1' GAU_ASA_RECORD
       , -1 PC_4_PC_APPLTXT_ID
       , -1 PC_5_PC_APPLTXT_ID
       , -1 PC_6_PC_APPLTXT_ID
       , -1 PC_7_PC_APPLTXT_ID
       , '-1' GAU_APPLTXT_3
       , '-1' GAU_APPLTXT_4
       , '-1' GAU_APPLTXT_5
       , '-1' GAU_APPLTXT_6
       , '-1' GAU_APPLTXT_7
       , 'N/A' GAU_PAR_EDIT_NAME_7
       , 'N/A' GAU_PAR_EDIT_NAME_8
       , 'N/A' GAU_PAR_EDIT_NAME_9
       , 'N/A' GAU_PAR_EDIT_NAME_10
       , 'N/A' GAU_PAR_EDIT_NAME_11
       , 'N/A' GAU_PAR_EDIT_TEXT_7
       , 'N/A' GAU_PAR_EDIT_TEXT_8
       , 'N/A' GAU_PAR_EDIT_TEXT_9
       , 'N/A' GAU_PAR_EDIT_TEXT_10
       , 'N/A' GAU_PAR_EDIT_TEXT_11
       , 'N/A' GAU_PAR_COPY_SUP_7
       , 'N/A' GAU_PAR_COPY_SUP_8
       , 'N/A' GAU_PAR_COPY_SUP_9
       , 'N/A' GAU_PAR_COPY_SUP_10
       , 'N/A' GAU_PAR_COPY_SUP_11
       , '-1' GAU_PAR_COLLATES_COPIES_7
       , '-1' GAU_PAR_COLLATES_COPIES_8
       , '-1' GAU_PAR_COLLATES_COPIES_9
       , '-1' GAU_PAR_COLLATES_COPIES_10
       , '-1' GAU_PAR_COLLATES_COPIES_11
       , '-1' GAU_PAR_EDIT_BOOL7
       , '-1' GAU_PAR_EDIT_BOOL8
       , '-1' GAU_PAR_EDIT_BOOL9
       , '-1' GAU_PAR_EDIT_BOOL10
       , '-1' GAU_PAR_EDIT_BOOL11
       , 'N/A' GAUGE_FORM_TYPE6
       , 'N/A' GAUGE_FORM_TYPE7
       , 'N/A' GAUGE_FORM_TYPE8
       , 'N/A' GAUGE_FORM_TYPE9
       , 'N/A' GAUGE_FORM_TYPE10
       , 'N/A' APPLI_COPY_SUPP6
       , 'N/A' APPLI_COPY_SUPP7
       , 'N/A' APPLI_COPY_SUPP8
       , 'N/A' APPLI_COPY_SUPP9
       , 'N/A' APPLI_COPY_SUPP10
       , 'N/A' GAU_EDIT_NAME6
       , 'N/A' GAU_EDIT_NAME7
       , 'N/A' GAU_EDIT_NAME8
       , 'N/A' GAU_EDIT_NAME9
       , 'N/A' GAU_EDIT_NAME10
       , 'N/A' GAU_EDIT_TEXT6
       , 'N/A' GAU_EDIT_TEXT7
       , 'N/A' GAU_EDIT_TEXT8
       , 'N/A' GAU_EDIT_TEXT9
       , 'N/A' GAU_EDIT_TEXT10
       , '-1' GAU_EDIT_BOOL6
       , '-1' GAU_EDIT_BOOL7
       , '-1' GAU_EDIT_BOOL8
       , '-1' GAU_EDIT_BOOL9
       , '-1' GAU_EDIT_BOOL10
       , '-1' GAU_COLLATE_COPIES6
       , '-1' GAU_COLLATE_COPIES7
       , '-1' GAU_COLLATE_COPIES8
       , '-1' GAU_COLLATE_COPIES9
       , '-1' GAU_COLLATE_COPIES10
       , 'N/A' GAU_REPORT_PRINT_TEST6
       , 'N/A' GAU_REPORT_PRINT_TEST7
       , 'N/A' GAU_REPORT_PRINT_TEST8
       , 'N/A' GAU_REPORT_PRINT_TEST9
       , 'N/A' GAU_REPORT_PRINT_TEST10
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_ACI_ID
       , 'DWH_NA' C_GAU_THIRD_VAT
       , 'DWH_NA' C_GAU_INCOTERMS
       , null GAU_DISPLAY_SEQ1
       , null GAU_DISPLAY_SEQ2
       , null GAU_DISPLAY_SEQ3
       , '-1' GAU_QAS_CONTROL
       , -1 DOC_RECORD_CATEGORY_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_GAUGE_DESCRIPTION" ("DOC_GAUGE_DESCRIPTION_ID", "DOC_GAUGE_ID", "PC_LANG_ID", "GAD_DESCRIBE", "GAD_FREE_DESCRIPTION") AS
  select DOC_GAUGE_DESCRIPTION_ID
       , Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(GAD_DESCRIBE, '_') GAD_DESCRIBE
       , Nvl(GAD_FREE_DESCRIPTION, '_') GAD_FREE_DESCRIPTION
  from DOC_GAUGE_DESCRIPTION
  union all
  select -1 DOC_GAUGE_DESCRIPTION_ID
       , -1 DOC_GAUGE_ID
       , -1 PC_LANG_ID
       , 'N/A' GAD_DESCRIBE
       , 'N/A' GAD_FREE_DESCRIPTION
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_GAUGE_POSITION" ("DOC_GAUGE_POSITION_ID", "C_GAUGE_TYPE_POS", "C_GAUGE_INIT_PRICE_POS", "STM_MOVEMENT_KIND_ID", "GCO_GOOD_ID", "DOC_GAUGE_ID", "PC_APPLTXT_ID", "GAP_VALUE", "GAP_BLOC_ACCESS_VALUE", "GAP_DELAY", "GAP_INIT_FIRST_DELAY", "GAP_INIT_MIDDLE_DELAY", "GAP_INIT_FINAL_DELAY", "GAP_INIT_FIRST_QTY", "GAP_INIT_MIDDLE_QTY", "GAP_INIT_FINAL_QTY", "C_GAUGE_SHOW_DELAY", "C_ROUND_APPLICATION", "GAP_POS_DELAY", "GAP_PCENT", "GAP_TXT", "GAP_DEFAULT", "GAP_STOCK_ACCESS", "GAP_MVT_UTILITY", "GAP_TRANS_ACCESS", "GAP_INIT_STOCK_PLACE", "GAP_DIRECT_REMIS", "GAP_DESIGNATION", "GAP_DELAY_COPY_PREV_POS", "GAP_VALUE_QUANTITY", "GAP_INCLUDE_TAX_TARIFF", "DIC_TARIFF_ID", "GAP_FORCED_TARIFF", "GAP_STOCK_MVT", "GAP_WEIGHT", "DIC_DELAY_UPDATE_TYPE_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GAP_GEN_CML_EVENTS", "DOC_DOC_GAUGE_POSITION_ID", "GAP_MRP", "GAP_SQM_SHOW_DFLT", "C_SQM_EVAL_TYPE", "GAP_TRANSFERT_PROPRIETOR", "GAP_ASA_TASK_IMPUT", "DIC_TYPE_MOVEMENT_ID", "STM_MA_MOVEMENT_KIND_ID") AS
  select DOC_GAUGE_POSITION_ID
       , Nvl(C_GAUGE_TYPE_POS, 'DWH_ISNULL') C_GAUGE_TYPE_POS
       , Nvl(C_GAUGE_INIT_PRICE_POS, 'DWH_ISNULL') C_GAUGE_INIT_PRICE_POS
       , Nvl(STM_MOVEMENT_KIND_ID, -2) STM_MOVEMENT_KIND_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl2(GAP_VALUE, case
                when(GAP_VALUE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_VALUE
       , Nvl2(GAP_BLOC_ACCESS_VALUE, case
                when(GAP_BLOC_ACCESS_VALUE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_BLOC_ACCESS_VALUE
       , Nvl2(GAP_DELAY, case
                when(GAP_DELAY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_DELAY
       , Nvl(GAP_INIT_FIRST_DELAY, '_') GAP_INIT_FIRST_DELAY
       , Nvl(GAP_INIT_MIDDLE_DELAY, '_') GAP_INIT_MIDDLE_DELAY
       , Nvl(GAP_INIT_FINAL_DELAY, '_') GAP_INIT_FINAL_DELAY
       , Nvl(GAP_INIT_FIRST_QTY, '_') GAP_INIT_FIRST_QTY
       , Nvl(GAP_INIT_MIDDLE_QTY, '_') GAP_INIT_MIDDLE_QTY
       , Nvl(GAP_INIT_FINAL_QTY, '_') GAP_INIT_FINAL_QTY
       , Nvl(C_GAUGE_SHOW_DELAY, 'DWH_ISNULL') C_GAUGE_SHOW_DELAY
       , Nvl(C_ROUND_APPLICATION, 'DWH_ISNULL') C_ROUND_APPLICATION
       , GAP_POS_DELAY
       , Nvl2(GAP_PCENT, case
                when(GAP_PCENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_PCENT
       , Nvl(GAP_TXT, '_') GAP_TXT
       , Nvl2(GAP_DEFAULT, case
                when(GAP_DEFAULT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_DEFAULT
       , Nvl2(GAP_STOCK_ACCESS, case
                when(GAP_STOCK_ACCESS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_STOCK_ACCESS
       , Nvl2(GAP_MVT_UTILITY, case
                when(GAP_MVT_UTILITY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_MVT_UTILITY
       , Nvl2(GAP_TRANS_ACCESS, case
                when(GAP_TRANS_ACCESS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_TRANS_ACCESS
       , Nvl2(GAP_INIT_STOCK_PLACE, case
                when(GAP_INIT_STOCK_PLACE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_INIT_STOCK_PLACE
       , Nvl2(GAP_DIRECT_REMIS, case
                when(GAP_DIRECT_REMIS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_DIRECT_REMIS
       , Nvl(GAP_DESIGNATION, '_') GAP_DESIGNATION
       , Nvl2(GAP_DELAY_COPY_PREV_POS, case
                when(GAP_DELAY_COPY_PREV_POS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_DELAY_COPY_PREV_POS
       , Nvl2(GAP_VALUE_QUANTITY, case
                when(GAP_VALUE_QUANTITY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_VALUE_QUANTITY
       , Nvl2(GAP_INCLUDE_TAX_TARIFF, case
                when(GAP_INCLUDE_TAX_TARIFF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_INCLUDE_TAX_TARIFF
       , Nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , Nvl2(GAP_FORCED_TARIFF, case
                when(GAP_FORCED_TARIFF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_FORCED_TARIFF
       , Nvl2(GAP_STOCK_MVT, case
                when(GAP_STOCK_MVT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_STOCK_MVT
       , Nvl2(GAP_WEIGHT, case
                when(GAP_WEIGHT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_WEIGHT
       , Nvl(DIC_DELAY_UPDATE_TYPE_ID, 'DWH_ISNULL') DIC_DELAY_UPDATE_TYPE_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl2(GAP_GEN_CML_EVENTS, case
                when(GAP_GEN_CML_EVENTS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_GEN_CML_EVENTS
       , Nvl(DOC_DOC_GAUGE_POSITION_ID, -2) DOC_DOC_GAUGE_POSITION_ID
       , Nvl2(GAP_MRP, case
                when(GAP_MRP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_MRP
       , Nvl2(GAP_SQM_SHOW_DFLT, case
                when(GAP_SQM_SHOW_DFLT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_SQM_SHOW_DFLT
       , Nvl(C_SQM_EVAL_TYPE, 'DWH_ISNULL') C_SQM_EVAL_TYPE
       , Nvl2(GAP_TRANSFERT_PROPRIETOR, case
                when(GAP_TRANSFERT_PROPRIETOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_TRANSFERT_PROPRIETOR
       , Nvl2(GAP_ASA_TASK_IMPUT, case
                when(GAP_ASA_TASK_IMPUT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAP_ASA_TASK_IMPUT
       , Nvl(DIC_TYPE_MOVEMENT_ID, 'DWH_ISNULL') DIC_TYPE_MOVEMENT_ID
       , Nvl(STM_MA_MOVEMENT_KIND_ID, -2) STM_MA_MOVEMENT_KIND_ID
  from DOC_GAUGE_POSITION
  union all
  select -1 DOC_GAUGE_POSITION_ID
       , 'DWH_NA' C_GAUGE_TYPE_POS
       , 'DWH_NA' C_GAUGE_INIT_PRICE_POS
       , -1 STM_MOVEMENT_KIND_ID
       , -1 GCO_GOOD_ID
       , -1 DOC_GAUGE_ID
       , -1 PC_APPLTXT_ID
       , '-1' GAP_VALUE
       , '-1' GAP_BLOC_ACCESS_VALUE
       , '-1' GAP_DELAY
       , 'N/A' GAP_INIT_FIRST_DELAY
       , 'N/A' GAP_INIT_MIDDLE_DELAY
       , 'N/A' GAP_INIT_FINAL_DELAY
       , 'N/A' GAP_INIT_FIRST_QTY
       , 'N/A' GAP_INIT_MIDDLE_QTY
       , 'N/A' GAP_INIT_FINAL_QTY
       , 'DWH_NA' C_GAUGE_SHOW_DELAY
       , 'DWH_NA' C_ROUND_APPLICATION
       , null GAP_POS_DELAY
       , '-1' GAP_PCENT
       , 'N/A' GAP_TXT
       , '-1' GAP_DEFAULT
       , '-1' GAP_STOCK_ACCESS
       , '-1' GAP_MVT_UTILITY
       , '-1' GAP_TRANS_ACCESS
       , '-1' GAP_INIT_STOCK_PLACE
       , '-1' GAP_DIRECT_REMIS
       , 'N/A' GAP_DESIGNATION
       , '-1' GAP_DELAY_COPY_PREV_POS
       , '-1' GAP_VALUE_QUANTITY
       , '-1' GAP_INCLUDE_TAX_TARIFF
       , 'DWH_NA' DIC_TARIFF_ID
       , '-1' GAP_FORCED_TARIFF
       , '-1' GAP_STOCK_MVT
       , '-1' GAP_WEIGHT
       , 'DWH_NA' DIC_DELAY_UPDATE_TYPE_ID
       , -1 STM_STOCK_ID
       , -1 STM_LOCATION_ID
       , '-1' GAP_GEN_CML_EVENTS
       , -1 DOC_DOC_GAUGE_POSITION_ID
       , '-1' GAP_MRP
       , '-1' GAP_SQM_SHOW_DFLT
       , 'DWH_NA' C_SQM_EVAL_TYPE
       , '-1' GAP_TRANSFERT_PROPRIETOR
       , '-1' GAP_ASA_TASK_IMPUT
       , 'DWH_NA' DIC_TYPE_MOVEMENT_ID
       , -1 STM_MA_MOVEMENT_KIND_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_GAUGE_STRUCTURED" ("DOC_GAUGE_ID", "C_GAUGE_TITLE", "DIC_TYPE_MOVEMENT_ID", "GAS_FIRST_NO", "GAS_INCREMENT_NBR", "GAS_INCREMENT", "GAS_MODIFY_NUMBERING", "GAS_POSITION__NUMBERING", "GAS_TOTAL_DOC", "GAS_PAY_CONDITION", "GAS_FINANCIAL_CHARGE", "GAS_BALANCE_STATUS", "GAS_CHARACTERIZATION", "GAS_DISCOUNT", "GAS_CHARGE", "GAS_TAXE", "GAS_VAT", "GAS_GOOD_THIRD", "GAS_SUBSTITUTE", "GAS_CORRELATION", "GAS_WEIGHT", "GAS_PCENT", "C_ROUND_TYPE", "GAS_ROUND_AMOUNT", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "GAS_FINANCIAL_REF", "ACJ_JOB_TYPE_S_CATALOGUE_ID", "ACS_FIN_ACC_S_PAYMENT_ID", "C_TYPE_EDI", "C_CONTROLE_DATE_DOCUM", "GAS_ANAL_CHARGE", "GAS_SENDING_CONDITION", "GAS_CHANGE_ACC_S_PAYMENT", "GAS_VISIBLE_COUNT", "C_CREDIT_LIMIT", "GAS_COMMISSION_MANAGEMENT", "GAS_CALCULATE_COMMISSION", "GAS_CASH_REGISTER", "GAS_FORM_CASH_REGISTER", "GAS_VAT_DET_ACCOUNT_VISIBLE", "GAS_INIT_FREE_DATA", "GAS_AUTO_ATTRIBUTION", "GAS_DIFFERED_CONFIRMATION", "PAC_PAYMENT_CONDITION_ID", "C_BVR_GENERATION_METHOD", "C_START_CONTROL_DATE", "C_DOC_PRE_ENTRY", "C_DOC_PRE_ENTRY_THIRD", "GAS_CALCUL_CREDIT_LIMIT", "GAS_DOC_STATUS_CREDIT_LIMIT", "GAS_CREDIT_LIMIT_STATUS_01", "GAS_CREDIT_LIMIT_STATUS_02", "GAS_CREDIT_LIMIT_STATUS_03", "GAS_CREDIT_LIMIT_STATUS_04", "ACJ_JOB_TYPE_S_CAT_PMT_ID", "GAS_EDI_EXPORT_METHOD", "GAS_UNIT_PRICE_DECIMAL", "GAS_POS_QTY_DECIMAL", "GAS_STORED_PROC_VALIDATE", "GAS_STORED_PROC_CONFIRM", "GAS_ALL_CHARACTERIZATION", "GAS_CPN_ACCOUNT_MODIFY", "GAS_STORED_PROC_EDIT", "GAS_STORED_PROC_AFTER_VALIDATE", "GAS_STORED_PROC_AFTER_CONFIRM", "GAS_STORED_PROC_AFTER_EDIT", "GAS_STORED_PROC_DELETE", "GAS_STORED_PROC_AFTER_DELETE", "GAS_AUTH_BALANCE_NO_RETURN", "GAS_AUTH_BALANCE_RETURN", "GAS_PROC_VALIDATE_POS", "GAS_PROC_EDIT_POS", "GAS_PROC_DELETE_POS", "GAS_PROC_AFTER_VALIDATE_POS", "GAS_PROC_AFTER_EDIT_POS", "GAS_PROC_AFTER_DELETE_POS", "GAS_AUTO_MRP", "C_DOC_CREDITLIMIT_MODE", "GAS_WEIGHING_MGM", "GAS_USE_PARTNER_DATE", "GAS_WEIGHT_MAT", "GAS_COST", "GAS_CASH_MULTIPLE_TRANSACTION", "GAS_MULTISOURCING_MGM", "C_PIC_FORECAST_CONTROL", "GAS_PREVIOUS_PERIODS_NB", "GAS_FOLLOWING_PERIODS_NB", "GAS_METAL_ACCOUNT_MGM", "GAS_DOC_JOURNALIZING", "C_PROJECT_CONSOLIDATION", "DIC_DOC_JOURNAL_1_ID", "DIC_DOC_JOURNAL_2_ID", "DIC_DOC_JOURNAL_3_ID", "DIC_DOC_JOURNAL_4_ID", "DIC_DOC_JOURNAL_5_ID", "DIC_PROJECT_CONSOL_1_ID", "C_DOC_JOURNAL_CALCULATION", "COM_NAME_ACI", "GAS_SALE_TERRITORY", "GAS_DISTRIBUTION_CHANNEL", "GAS_INSTALLATION_MGM", "GAS_INSTALLATION_AUTO_GEN", "GAS_INSTALLATION_REQUIRED", "C_BUDGET_CONTROL", "C_BUDGET_CALCULATION_MODE", "C_BUDGET_CONSUMPTION_TYPE", "GAS_INCLUDE_BUDGET_CONTROL", "GAS_DOC_STATUS_BUDGET_CONTROL", "GAS_BUDGET_CONTROL_STATUS_01", "GAS_BUDGET_CONTROL_STATUS_02", "GAS_BUDGET_CONTROL_STATUS_03", "GAS_BUDGET_CONTROL_STATUS_04", "DIC_GAU_NATURE_CODE_ID", "GAS_POSITION_COST", "GAS_POSITION_COST_GAUGE", "GAS_RECORD_IMPUTATION", "GAS_INVOICE_EXPIRY", "GAS_ADDENDUM_NUMBERING_ID", "GAS_ADDENDUM", "GAS_CHECK_INVOICE_EXPIRY_LINK", "GAS_EBPP_REFERENCE", "GAS_UPDATE_PIC_ORDER_QTY", "C_GAUGE_COLL_ACCOUNT", "GAS_USE_PARTNER_NUMBER", "GAS_AUTO_CHARACTERIZATION", "GAS_EDI_DOCUMENT_TYPE") AS
  select Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(C_GAUGE_TITLE, 'DWH_ISNULL') C_GAUGE_TITLE
       , Nvl(DIC_TYPE_MOVEMENT_ID, 'DWH_ISNULL') DIC_TYPE_MOVEMENT_ID
       , GAS_FIRST_NO
       , GAS_INCREMENT_NBR
       , Nvl2(GAS_INCREMENT, case
                when(GAS_INCREMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INCREMENT
       , Nvl2(GAS_MODIFY_NUMBERING, case
                when(GAS_MODIFY_NUMBERING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_MODIFY_NUMBERING
       , Nvl2(GAS_POSITION__NUMBERING, case
                when(GAS_POSITION__NUMBERING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_POSITION__NUMBERING
       , Nvl2(GAS_TOTAL_DOC, case
                when(GAS_TOTAL_DOC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_TOTAL_DOC
       , Nvl2(GAS_PAY_CONDITION, case
                when(GAS_PAY_CONDITION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_PAY_CONDITION
       , Nvl2(GAS_FINANCIAL_CHARGE, case
                when(GAS_FINANCIAL_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_FINANCIAL_CHARGE
       , Nvl2(GAS_BALANCE_STATUS, case
                when(GAS_BALANCE_STATUS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_BALANCE_STATUS
       , Nvl2(GAS_CHARACTERIZATION, case
                when(GAS_CHARACTERIZATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CHARACTERIZATION
       , Nvl2(GAS_DISCOUNT, case
                when(GAS_DISCOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_DISCOUNT
       , Nvl2(GAS_CHARGE, case
                when(GAS_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CHARGE
       , Nvl2(GAS_TAXE, case
                when(GAS_TAXE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_TAXE
       , Nvl2(GAS_VAT, case
                when(GAS_VAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_VAT
       , Nvl2(GAS_GOOD_THIRD, case
                when(GAS_GOOD_THIRD = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_GOOD_THIRD
       , Nvl2(GAS_SUBSTITUTE, case
                when(GAS_SUBSTITUTE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_SUBSTITUTE
       , Nvl2(GAS_CORRELATION, case
                when(GAS_CORRELATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CORRELATION
       , Nvl2(GAS_WEIGHT, case
                when(GAS_WEIGHT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_WEIGHT
       , Nvl2(GAS_PCENT, case
                when(GAS_PCENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_PCENT
       , Nvl(C_ROUND_TYPE, 'DWH_ISNULL') C_ROUND_TYPE
       , GAS_ROUND_AMOUNT
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl2(GAS_FINANCIAL_REF, case
                when(GAS_FINANCIAL_REF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_FINANCIAL_REF
       , Nvl(ACJ_JOB_TYPE_S_CATALOGUE_ID, -2) ACJ_JOB_TYPE_S_CATALOGUE_ID
       , Nvl(ACS_FIN_ACC_S_PAYMENT_ID, -2) ACS_FIN_ACC_S_PAYMENT_ID
       , Nvl(C_TYPE_EDI, 'DWH_ISNULL') C_TYPE_EDI
       , Nvl(C_CONTROLE_DATE_DOCUM, 'DWH_ISNULL') C_CONTROLE_DATE_DOCUM
       , Nvl2(GAS_ANAL_CHARGE, case
                when(GAS_ANAL_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_ANAL_CHARGE
       , Nvl2(GAS_SENDING_CONDITION, case
                when(GAS_SENDING_CONDITION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_SENDING_CONDITION
       , Nvl2(GAS_CHANGE_ACC_S_PAYMENT, case
                when(GAS_CHANGE_ACC_S_PAYMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CHANGE_ACC_S_PAYMENT
       , Nvl2(GAS_VISIBLE_COUNT, case
                when(GAS_VISIBLE_COUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_VISIBLE_COUNT
       , Nvl(C_CREDIT_LIMIT, 'DWH_ISNULL') C_CREDIT_LIMIT
       , Nvl2(GAS_COMMISSION_MANAGEMENT, case
                when(GAS_COMMISSION_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_COMMISSION_MANAGEMENT
       , Nvl2(GAS_CALCULATE_COMMISSION, case
                when(GAS_CALCULATE_COMMISSION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CALCULATE_COMMISSION
       , Nvl2(GAS_CASH_REGISTER, case
                when(GAS_CASH_REGISTER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CASH_REGISTER
       , Nvl(GAS_FORM_CASH_REGISTER, '_') GAS_FORM_CASH_REGISTER
       , Nvl2(GAS_VAT_DET_ACCOUNT_VISIBLE, case
                when(GAS_VAT_DET_ACCOUNT_VISIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_VAT_DET_ACCOUNT_VISIBLE
       , Nvl2(GAS_INIT_FREE_DATA, case
                when(GAS_INIT_FREE_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INIT_FREE_DATA
       , Nvl2(GAS_AUTO_ATTRIBUTION, case
                when(GAS_AUTO_ATTRIBUTION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_AUTO_ATTRIBUTION
       , Nvl2(GAS_DIFFERED_CONFIRMATION, case
                when(GAS_DIFFERED_CONFIRMATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_DIFFERED_CONFIRMATION
       , Nvl(PAC_PAYMENT_CONDITION_ID, -2) PAC_PAYMENT_CONDITION_ID
       , Nvl(C_BVR_GENERATION_METHOD, 'DWH_ISNULL') C_BVR_GENERATION_METHOD
       , Nvl(C_START_CONTROL_DATE, 'DWH_ISNULL') C_START_CONTROL_DATE
       , Nvl(C_DOC_PRE_ENTRY, 'DWH_ISNULL') C_DOC_PRE_ENTRY
       , Nvl(C_DOC_PRE_ENTRY_THIRD, 'DWH_ISNULL') C_DOC_PRE_ENTRY_THIRD
       , Nvl2(GAS_CALCUL_CREDIT_LIMIT, case
                when(GAS_CALCUL_CREDIT_LIMIT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CALCUL_CREDIT_LIMIT
       , Nvl(GAS_DOC_STATUS_CREDIT_LIMIT, '_') GAS_DOC_STATUS_CREDIT_LIMIT
       , Nvl2(GAS_CREDIT_LIMIT_STATUS_01, case
                when(GAS_CREDIT_LIMIT_STATUS_01 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CREDIT_LIMIT_STATUS_01
       , Nvl2(GAS_CREDIT_LIMIT_STATUS_02, case
                when(GAS_CREDIT_LIMIT_STATUS_02 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CREDIT_LIMIT_STATUS_02
       , Nvl2(GAS_CREDIT_LIMIT_STATUS_03, case
                when(GAS_CREDIT_LIMIT_STATUS_03 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CREDIT_LIMIT_STATUS_03
       , Nvl2(GAS_CREDIT_LIMIT_STATUS_04, case
                when(GAS_CREDIT_LIMIT_STATUS_04 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CREDIT_LIMIT_STATUS_04
       , Nvl(ACJ_JOB_TYPE_S_CAT_PMT_ID, -2) ACJ_JOB_TYPE_S_CAT_PMT_ID
       , Nvl(GAS_EDI_EXPORT_METHOD, '_') GAS_EDI_EXPORT_METHOD
       , Nvl2(GAS_UNIT_PRICE_DECIMAL, case
                when(GAS_UNIT_PRICE_DECIMAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_UNIT_PRICE_DECIMAL
       , Nvl2(GAS_POS_QTY_DECIMAL, case
                when(GAS_POS_QTY_DECIMAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_POS_QTY_DECIMAL
       , Nvl(GAS_STORED_PROC_VALIDATE, '_') GAS_STORED_PROC_VALIDATE
       , Nvl(GAS_STORED_PROC_CONFIRM, '_') GAS_STORED_PROC_CONFIRM
       , Nvl2(GAS_ALL_CHARACTERIZATION, case
                when(GAS_ALL_CHARACTERIZATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_ALL_CHARACTERIZATION
       , Nvl2(GAS_CPN_ACCOUNT_MODIFY, case
                when(GAS_CPN_ACCOUNT_MODIFY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_CPN_ACCOUNT_MODIFY
       , Nvl(GAS_STORED_PROC_EDIT, '_') GAS_STORED_PROC_EDIT
       , Nvl(GAS_STORED_PROC_AFTER_VALIDATE, '_') GAS_STORED_PROC_AFTER_VALIDATE
       , Nvl(GAS_STORED_PROC_AFTER_CONFIRM, '_') GAS_STORED_PROC_AFTER_CONFIRM
       , Nvl(GAS_STORED_PROC_AFTER_EDIT, '_') GAS_STORED_PROC_AFTER_EDIT
       , Nvl(GAS_STORED_PROC_DELETE, '_') GAS_STORED_PROC_DELETE
       , Nvl(GAS_STORED_PROC_AFTER_DELETE, '_') GAS_STORED_PROC_AFTER_DELETE
       , Nvl2(GAS_AUTH_BALANCE_NO_RETURN, case
                when(GAS_AUTH_BALANCE_NO_RETURN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_AUTH_BALANCE_NO_RETURN
       , Nvl2(GAS_AUTH_BALANCE_RETURN, case
                when(GAS_AUTH_BALANCE_RETURN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_AUTH_BALANCE_RETURN
       , Nvl(GAS_PROC_VALIDATE_POS, '_') GAS_PROC_VALIDATE_POS
       , Nvl(GAS_PROC_EDIT_POS, '_') GAS_PROC_EDIT_POS
       , Nvl(GAS_PROC_DELETE_POS, '_') GAS_PROC_DELETE_POS
       , Nvl(GAS_PROC_AFTER_VALIDATE_POS, '_') GAS_PROC_AFTER_VALIDATE_POS
       , Nvl(GAS_PROC_AFTER_EDIT_POS, '_') GAS_PROC_AFTER_EDIT_POS
       , Nvl(GAS_PROC_AFTER_DELETE_POS, '_') GAS_PROC_AFTER_DELETE_POS
       , Nvl2(GAS_AUTO_MRP, case
                when(GAS_AUTO_MRP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_AUTO_MRP
       , Nvl(C_DOC_CREDITLIMIT_MODE, 'DWH_ISNULL') C_DOC_CREDITLIMIT_MODE
       , Nvl2(GAS_WEIGHING_MGM, case
                when(GAS_WEIGHING_MGM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_WEIGHING_MGM
       , Nvl2(GAS_USE_PARTNER_DATE, case
                when(GAS_USE_PARTNER_DATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_USE_PARTNER_DATE
       , Nvl2(GAS_WEIGHT_MAT, case
                when(GAS_WEIGHT_MAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_WEIGHT_MAT
       , Nvl2(GAS_COST, case
                when(GAS_COST = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_COST
       , Nvl2(GAS_CASH_MULTIPLE_TRANSACTION
            , case
                when(GAS_CASH_MULTIPLE_TRANSACTION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end
            , '-2'
             ) GAS_CASH_MULTIPLE_TRANSACTION
       , Nvl2(GAS_MULTISOURCING_MGM, case
                when(GAS_MULTISOURCING_MGM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_MULTISOURCING_MGM
       , Nvl(C_PIC_FORECAST_CONTROL, 'DWH_ISNULL') C_PIC_FORECAST_CONTROL
       , GAS_PREVIOUS_PERIODS_NB
       , GAS_FOLLOWING_PERIODS_NB
       , Nvl2(GAS_METAL_ACCOUNT_MGM, case
                when(GAS_METAL_ACCOUNT_MGM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_METAL_ACCOUNT_MGM
       , Nvl2(GAS_DOC_JOURNALIZING, case
                when(GAS_DOC_JOURNALIZING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_DOC_JOURNALIZING
       , Nvl(C_PROJECT_CONSOLIDATION, 'DWH_ISNULL') C_PROJECT_CONSOLIDATION
       , Nvl(DIC_DOC_JOURNAL_1_ID, 'DWH_ISNULL') DIC_DOC_JOURNAL_1_ID
       , Nvl(DIC_DOC_JOURNAL_2_ID, 'DWH_ISNULL') DIC_DOC_JOURNAL_2_ID
       , Nvl(DIC_DOC_JOURNAL_3_ID, 'DWH_ISNULL') DIC_DOC_JOURNAL_3_ID
       , Nvl(DIC_DOC_JOURNAL_4_ID, 'DWH_ISNULL') DIC_DOC_JOURNAL_4_ID
       , Nvl(DIC_DOC_JOURNAL_5_ID, 'DWH_ISNULL') DIC_DOC_JOURNAL_5_ID
       , Nvl(DIC_PROJECT_CONSOL_1_ID, 'DWH_ISNULL') DIC_PROJECT_CONSOL_1_ID
       , Nvl(C_DOC_JOURNAL_CALCULATION, 'DWH_ISNULL') C_DOC_JOURNAL_CALCULATION
       , Nvl(COM_NAME_ACI, '_') COM_NAME_ACI
       , Nvl2(GAS_SALE_TERRITORY, case
                when(GAS_SALE_TERRITORY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_SALE_TERRITORY
       , Nvl2(GAS_DISTRIBUTION_CHANNEL, case
                when(GAS_DISTRIBUTION_CHANNEL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_DISTRIBUTION_CHANNEL
       , Nvl2(GAS_INSTALLATION_MGM, case
                when(GAS_INSTALLATION_MGM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INSTALLATION_MGM
       , Nvl2(GAS_INSTALLATION_AUTO_GEN, case
                when(GAS_INSTALLATION_AUTO_GEN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INSTALLATION_AUTO_GEN
       , Nvl2(GAS_INSTALLATION_REQUIRED, case
                when(GAS_INSTALLATION_REQUIRED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INSTALLATION_REQUIRED
       , Nvl(C_BUDGET_CONTROL, 'DWH_ISNULL') C_BUDGET_CONTROL
       , Nvl(C_BUDGET_CALCULATION_MODE, 'DWH_ISNULL') C_BUDGET_CALCULATION_MODE
       , Nvl(C_BUDGET_CONSUMPTION_TYPE, 'DWH_ISNULL') C_BUDGET_CONSUMPTION_TYPE
       , Nvl2(GAS_INCLUDE_BUDGET_CONTROL, case
                when(GAS_INCLUDE_BUDGET_CONTROL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INCLUDE_BUDGET_CONTROL
       , Nvl(GAS_DOC_STATUS_BUDGET_CONTROL, '_') GAS_DOC_STATUS_BUDGET_CONTROL
       , Nvl2(GAS_BUDGET_CONTROL_STATUS_01, case
                when(GAS_BUDGET_CONTROL_STATUS_01 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_BUDGET_CONTROL_STATUS_01
       , Nvl2(GAS_BUDGET_CONTROL_STATUS_02, case
                when(GAS_BUDGET_CONTROL_STATUS_02 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_BUDGET_CONTROL_STATUS_02
       , Nvl2(GAS_BUDGET_CONTROL_STATUS_03, case
                when(GAS_BUDGET_CONTROL_STATUS_03 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_BUDGET_CONTROL_STATUS_03
       , Nvl2(GAS_BUDGET_CONTROL_STATUS_04, case
                when(GAS_BUDGET_CONTROL_STATUS_04 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_BUDGET_CONTROL_STATUS_04
       , Nvl(DIC_GAU_NATURE_CODE_ID, 'DWH_ISNULL') DIC_GAU_NATURE_CODE_ID
       , Nvl2(GAS_POSITION_COST, case
                when(GAS_POSITION_COST = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_POSITION_COST
       , Nvl2(GAS_POSITION_COST_GAUGE, case
                when(GAS_POSITION_COST_GAUGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_POSITION_COST_GAUGE
       , Nvl2(GAS_RECORD_IMPUTATION, case
                when(GAS_RECORD_IMPUTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_RECORD_IMPUTATION
       , Nvl2(GAS_INVOICE_EXPIRY, case
                when(GAS_INVOICE_EXPIRY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_INVOICE_EXPIRY
       , Nvl(GAS_ADDENDUM_NUMBERING_ID, -2) GAS_ADDENDUM_NUMBERING_ID
       , Nvl2(GAS_ADDENDUM, case
                when(GAS_ADDENDUM = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_ADDENDUM
       , Nvl2(GAS_CHECK_INVOICE_EXPIRY_LINK
            , case
                when(GAS_CHECK_INVOICE_EXPIRY_LINK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end
            , '-2'
             ) GAS_CHECK_INVOICE_EXPIRY_LINK
       , Nvl2(GAS_EBPP_REFERENCE, case
                when(GAS_EBPP_REFERENCE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_EBPP_REFERENCE
       , Nvl2(GAS_UPDATE_PIC_ORDER_QTY, case
                when(GAS_UPDATE_PIC_ORDER_QTY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_UPDATE_PIC_ORDER_QTY
       , Nvl(C_GAUGE_COLL_ACCOUNT, 'DWH_ISNULL') C_GAUGE_COLL_ACCOUNT
       , Nvl2(GAS_USE_PARTNER_NUMBER, case
                when(GAS_USE_PARTNER_NUMBER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_USE_PARTNER_NUMBER
       , Nvl2(GAS_AUTO_CHARACTERIZATION, case
                when(GAS_AUTO_CHARACTERIZATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GAS_AUTO_CHARACTERIZATION
       , Nvl(GAS_EDI_DOCUMENT_TYPE, '_') GAS_EDI_DOCUMENT_TYPE
  from DOC_GAUGE_STRUCTURED
  union all
  select -1 DOC_GAUGE_ID
       , 'DWH_NA' C_GAUGE_TITLE
       , 'DWH_NA' DIC_TYPE_MOVEMENT_ID
       , null GAS_FIRST_NO
       , null GAS_INCREMENT_NBR
       , '-1' GAS_INCREMENT
       , '-1' GAS_MODIFY_NUMBERING
       , '-1' GAS_POSITION__NUMBERING
       , '-1' GAS_TOTAL_DOC
       , '-1' GAS_PAY_CONDITION
       , '-1' GAS_FINANCIAL_CHARGE
       , '-1' GAS_BALANCE_STATUS
       , '-1' GAS_CHARACTERIZATION
       , '-1' GAS_DISCOUNT
       , '-1' GAS_CHARGE
       , '-1' GAS_TAXE
       , '-1' GAS_VAT
       , '-1' GAS_GOOD_THIRD
       , '-1' GAS_SUBSTITUTE
       , '-1' GAS_CORRELATION
       , '-1' GAS_WEIGHT
       , '-1' GAS_PCENT
       , 'DWH_NA' C_ROUND_TYPE
       , null GAS_ROUND_AMOUNT
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , '-1' GAS_FINANCIAL_REF
       , -1 ACJ_JOB_TYPE_S_CATALOGUE_ID
       , -1 ACS_FIN_ACC_S_PAYMENT_ID
       , 'DWH_NA' C_TYPE_EDI
       , 'DWH_NA' C_CONTROLE_DATE_DOCUM
       , '-1' GAS_ANAL_CHARGE
       , '-1' GAS_SENDING_CONDITION
       , '-1' GAS_CHANGE_ACC_S_PAYMENT
       , '-1' GAS_VISIBLE_COUNT
       , 'DWH_NA' C_CREDIT_LIMIT
       , '-1' GAS_COMMISSION_MANAGEMENT
       , '-1' GAS_CALCULATE_COMMISSION
       , '-1' GAS_CASH_REGISTER
       , 'N/A' GAS_FORM_CASH_REGISTER
       , '-1' GAS_VAT_DET_ACCOUNT_VISIBLE
       , '-1' GAS_INIT_FREE_DATA
       , '-1' GAS_AUTO_ATTRIBUTION
       , '-1' GAS_DIFFERED_CONFIRMATION
       , -1 PAC_PAYMENT_CONDITION_ID
       , 'DWH_NA' C_BVR_GENERATION_METHOD
       , 'DWH_NA' C_START_CONTROL_DATE
       , 'DWH_NA' C_DOC_PRE_ENTRY
       , 'DWH_NA' C_DOC_PRE_ENTRY_THIRD
       , '-1' GAS_CALCUL_CREDIT_LIMIT
       , 'N/A' GAS_DOC_STATUS_CREDIT_LIMIT
       , '-1' GAS_CREDIT_LIMIT_STATUS_01
       , '-1' GAS_CREDIT_LIMIT_STATUS_02
       , '-1' GAS_CREDIT_LIMIT_STATUS_03
       , '-1' GAS_CREDIT_LIMIT_STATUS_04
       , -1 ACJ_JOB_TYPE_S_CAT_PMT_ID
       , 'N/A' GAS_EDI_EXPORT_METHOD
       , '-1' GAS_UNIT_PRICE_DECIMAL
       , '-1' GAS_POS_QTY_DECIMAL
       , 'N/A' GAS_STORED_PROC_VALIDATE
       , 'N/A' GAS_STORED_PROC_CONFIRM
       , '-1' GAS_ALL_CHARACTERIZATION
       , '-1' GAS_CPN_ACCOUNT_MODIFY
       , 'N/A' GAS_STORED_PROC_EDIT
       , 'N/A' GAS_STORED_PROC_AFTER_VALIDATE
       , 'N/A' GAS_STORED_PROC_AFTER_CONFIRM
       , 'N/A' GAS_STORED_PROC_AFTER_EDIT
       , 'N/A' GAS_STORED_PROC_DELETE
       , 'N/A' GAS_STORED_PROC_AFTER_DELETE
       , '-1' GAS_AUTH_BALANCE_NO_RETURN
       , '-1' GAS_AUTH_BALANCE_RETURN
       , 'N/A' GAS_PROC_VALIDATE_POS
       , 'N/A' GAS_PROC_EDIT_POS
       , 'N/A' GAS_PROC_DELETE_POS
       , 'N/A' GAS_PROC_AFTER_VALIDATE_POS
       , 'N/A' GAS_PROC_AFTER_EDIT_POS
       , 'N/A' GAS_PROC_AFTER_DELETE_POS
       , '-1' GAS_AUTO_MRP
       , 'DWH_NA' C_DOC_CREDITLIMIT_MODE
       , '-1' GAS_WEIGHING_MGM
       , '-1' GAS_USE_PARTNER_DATE
       , '-1' GAS_WEIGHT_MAT
       , '-1' GAS_COST
       , '-1' GAS_CASH_MULTIPLE_TRANSACTION
       , '-1' GAS_MULTISOURCING_MGM
       , 'DWH_NA' C_PIC_FORECAST_CONTROL
       , null GAS_PREVIOUS_PERIODS_NB
       , null GAS_FOLLOWING_PERIODS_NB
       , '-1' GAS_METAL_ACCOUNT_MGM
       , '-1' GAS_DOC_JOURNALIZING
       , 'DWH_NA' C_PROJECT_CONSOLIDATION
       , 'DWH_NA' DIC_DOC_JOURNAL_1_ID
       , 'DWH_NA' DIC_DOC_JOURNAL_2_ID
       , 'DWH_NA' DIC_DOC_JOURNAL_3_ID
       , 'DWH_NA' DIC_DOC_JOURNAL_4_ID
       , 'DWH_NA' DIC_DOC_JOURNAL_5_ID
       , 'DWH_NA' DIC_PROJECT_CONSOL_1_ID
       , 'DWH_NA' C_DOC_JOURNAL_CALCULATION
       , 'N/A' COM_NAME_ACI
       , '-1' GAS_SALE_TERRITORY
       , '-1' GAS_DISTRIBUTION_CHANNEL
       , '-1' GAS_INSTALLATION_MGM
       , '-1' GAS_INSTALLATION_AUTO_GEN
       , '-1' GAS_INSTALLATION_REQUIRED
       , 'DWH_NA' C_BUDGET_CONTROL
       , 'DWH_NA' C_BUDGET_CALCULATION_MODE
       , 'DWH_NA' C_BUDGET_CONSUMPTION_TYPE
       , '-1' GAS_INCLUDE_BUDGET_CONTROL
       , 'N/A' GAS_DOC_STATUS_BUDGET_CONTROL
       , '-1' GAS_BUDGET_CONTROL_STATUS_01
       , '-1' GAS_BUDGET_CONTROL_STATUS_02
       , '-1' GAS_BUDGET_CONTROL_STATUS_03
       , '-1' GAS_BUDGET_CONTROL_STATUS_04
       , 'DWH_NA' DIC_GAU_NATURE_CODE_ID
       , '-1' GAS_POSITION_COST
       , '-1' GAS_POSITION_COST_GAUGE
       , '-1' GAS_RECORD_IMPUTATION
       , '-1' GAS_INVOICE_EXPIRY
       , -1 GAS_ADDENDUM_NUMBERING_ID
       , '-1' GAS_ADDENDUM
       , '-1' GAS_CHECK_INVOICE_EXPIRY_LINK
       , '-1' GAS_EBPP_REFERENCE
       , '-1' GAS_UPDATE_PIC_ORDER_QTY
       , 'DWH_NA' C_GAUGE_COLL_ACCOUNT
       , '-1' GAS_USE_PARTNER_NUMBER
       , '-1' GAS_AUTO_CHARACTERIZATION
       , 'N/A' GAS_EDI_DOCUMENT_TYPE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_POSITION" ("DOC_POSITION_ID", "DOC_DOCUMENT_ID", "C_GAUGE_TYPE_POS", "C_DOC_POS_STATUS", "GCO_GOOD_ID", "DOC_GAUGE_POSITION_ID", "DOC_RECORD_ID", "STM_STOCK_ID", "STM_STM_STOCK_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID", "STM_MOVEMENT_KIND_ID", "ACS_TAX_CODE_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "POS_NUMBER", "POS_REFERENCE", "POS_SHORT_DESCRIPTION", "POS_LONG_DESCRIPTION", "POS_FREE_DESCRIPTION", "POS_BODY_TEXT", "POS_GENERATE_MOVEMENT", "POS_STOCK_OUTAGE", "POS_DISCOUNT_AMOUNT", "POS_CHARGE_AMOUNT", "POS_VAT_AMOUNT", "POS_VAT_BASE_AMOUNT", "POS_GROSS_UNIT_VALUE", "POS_NET_UNIT_VALUE", "POS_NET_UNIT_VALUE_INCL", "POS_REF_UNIT_VALUE", "POS_GROSS_VALUE", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_INCL", "POS_BASIS_QUANTITY", "POS_INTERMEDIATE_QUANTITY", "POS_FINAL_QUANTITY", "POS_BALANCE_QUANTITY", "POS_RATE_FACTOR", "POS_NET_WEIGHT", "POS_GROSS_WEIGHT", "DIC_UNIT_OF_MEASURE_ID", "POS_CONVERT_FACTOR", "POS_NOM_TEXT", "POS_UNIT_COST_PRICE", "POS_EAN_CODE", "PC_APPLTXT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "DIC_POS_FREE_TABLE_1_ID", "DIC_POS_FREE_TABLE_2_ID", "DIC_POS_FREE_TABLE_3_ID", "POS_DECIMAL_1", "POS_DECIMAL_2", "POS_DECIMAL_3", "POS_TEXT_1", "POS_TEXT_2", "POS_TEXT_3", "POS_DISCOUNT_UNIT_VALUE", "POS_DISCOUNT_RATE", "PAC_REPRESENTATIVE_ID", "DOC_EXTRACT_COMMISSION_ID", "POS_VALUE_QUANTITY", "POS_INCLUDE_TAX_TARIFF", "POS_GROSS_UNIT_VALUE_INCL", "POS_GROSS_VALUE_INCL", "POS_BALANCE_QTY_VALUE", "CML_POSITION_ID", "DOC_DOC_POSITION_ID", "POS_UTIL_COEFF", "POS_GROSS_UNIT_VALUE2", "PAC_THIRD_ID", "DOC_GAUGE_ID", "DIC_DIC_UNIT_OF_MEASURE_ID", "POS_CONVERT_FACTOR2", "POS_VAT_AMOUNT_E", "POS_GROSS_VALUE_B", "POS_GROSS_VALUE_E", "POS_GROSS_VALUE_INCL_B", "POS_GROSS_VALUE_INCL_E", "POS_NET_VALUE_EXCL_B", "POS_NET_VALUE_EXCL_E", "POS_NET_VALUE_INCL_B", "POS_NET_VALUE_INCL_E", "POS_MODIFY_RATE", "POS_VAT_AMOUNT_V", "POS_GROSS_VALUE_V", "POS_GROSS_VALUE_INCL_V", "POS_NET_VALUE_EXCL_V", "POS_NET_VALUE_INCL_V", "ASA_RECORD_ID", "POS_NET_TARIFF", "POS_SPECIAL_TARIFF", "POS_FLAT_RATE", "POS_BASIS_QUANTITY_SU", "POS_INTERMEDIATE_QUANTITY_SU", "POS_FINAL_QUANTITY_SU", "C_POS_DELIVERY_TYP", "ASA_RECORD_COMP_ID", "ASA_RECORD_TASK_ID", "POS_BALANCED", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "POS_IMF_TEXT_1", "POS_IMF_TEXT_2", "POS_IMF_TEXT_3", "POS_IMF_TEXT_4", "POS_IMF_TEXT_5", "POS_IMF_NUMBER_2", "POS_IMF_NUMBER_3", "POS_IMF_NUMBER_4", "POS_IMF_NUMBER_5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "POS_CREATE_POSITION_CHARGE", "FAL_SUPPLY_REQUEST_ID", "PAC_PERSON_ID", "DOC_DOC_RECORD_ID", "POS_GEN_CML_EVENTS", "POS_UPDATE_POSITION_CHARGE", "CML_EVENTS_ID", "POS_PARTNER_NUMBER", "POS_PARTNER_REFERENCE", "POS_DATE_PARTNER_DOCUMENT", "POS_CUMULATIVE_CHARGE", "POS_RECALC_AMOUNTS", "POS_PARENT_CHARGE", "POS_DATE_1", "POS_DATE_2", "POS_DATE_3", "DIC_TARIFF_ID", "POS_UPDATE_TARIFF", "POS_TARIFF_UNIT", "POS_TARIFF_INITIALIZED", "POS_UPDATE_QTY_PRICE", "POS_TRANSFERT_PROPRIETOR", "POS_CREATE_MAT", "POS_EAN_UCC14_CODE", "POS_HIBC_PRIMARY_CODE", "ASA_RECORD_TASK_IMPUT_ID", "C_POS_CREATE_MODE", "POS_TARIFF_SET", "POS_PRICE_TRANSFERED", "POS_SECONDARY_REFERENCE", "POS_TARIFF_DATE", "POS_GROSS_UNIT_VALUE_SU", "POS_GROSS_UNIT_VALUE_INCL_SU", "POS_DATE_DELIVERY", "POS_VAT_RATE", "POS_VAT_LIABLED_RATE", "POS_VAT_LIABLED_AMOUNT", "POS_VAT_TOTAL_AMOUNT", "POS_VAT_DEDUCTIBLE_RATE", "POS_VAT_TOTAL_AMOUNT_B", "POS_VAT_TOTAL_AMOUNT_V", "POS_DATE_BALANCED", "POS_QUANTITY_BALANCED", "POS_CALC_BUDGET_AMOUNT_MB", "POS_EFFECT_BUDGET_AMOUNT_MB", "ASA_INTERVENTION_DETAIL_ID", "POS_BUDGET_EXCEEDED", "POS_BUDGET_COMMENT", "POS_BUDGET_USER_ID", "POS_BUDGET_ACCEPT_DATE", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_REPR_ACI_ID", "PAC_REPR_DELIVERY_ID", "POS_IMPUTATION", "PAC_THIRD_CDA_ID", "PAC_THIRD_VAT_ID", "DOC_INVOICE_EXPIRY_ID", "POS_INVOICE_EXPIRY", "C_INVOICE_EXPIRY_INPUT_TYPE", "DOC_INVOICE_EXPIRY_DETAIL_ID", "POS_ADDENDUM_SRC_POS_ID", "POS_ADDENDUM_QTY_BALANCED", "POS_ADDENDUM_VALUE_QTY", "POS_UPDATE_OP", "FAL_SCHEDULE_STEP_ID", "POS_EFFECTIVE_DIC_TARIFF_ID", "POS_PARTNER_POS_NUMBER", "DOC_POS_LITIG_ID", "POS_UPDATE_ATTRIB") AS
  select DOC_POSITION_ID
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , Nvl(C_GAUGE_TYPE_POS, 'DWH_ISNULL') C_GAUGE_TYPE_POS
       , Nvl(C_DOC_POS_STATUS, 'DWH_ISNULL') C_DOC_POS_STATUS
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(DOC_GAUGE_POSITION_ID, -2) DOC_GAUGE_POSITION_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(STM_STM_STOCK_ID, -2) STM_STM_STOCK_ID
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl(STM_STM_LOCATION_ID, -2) STM_STM_LOCATION_ID
       , Nvl(STM_MOVEMENT_KIND_ID, -2) STM_MOVEMENT_KIND_ID
       , Nvl(ACS_TAX_CODE_ID, -2) ACS_TAX_CODE_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , POS_NUMBER
       , Nvl(POS_REFERENCE, '_') POS_REFERENCE
       , Nvl(POS_SHORT_DESCRIPTION, '_') POS_SHORT_DESCRIPTION
       , Nvl(POS_LONG_DESCRIPTION, '_') POS_LONG_DESCRIPTION
       , Nvl(POS_FREE_DESCRIPTION, '_') POS_FREE_DESCRIPTION
       , Nvl(POS_BODY_TEXT, '_') POS_BODY_TEXT
       , Nvl2(POS_GENERATE_MOVEMENT, case
                when(POS_GENERATE_MOVEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_GENERATE_MOVEMENT
       , Nvl2(POS_STOCK_OUTAGE, case
                when(POS_STOCK_OUTAGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_STOCK_OUTAGE
       , POS_DISCOUNT_AMOUNT
       , POS_CHARGE_AMOUNT
       , POS_VAT_AMOUNT
       , POS_VAT_BASE_AMOUNT
       , POS_GROSS_UNIT_VALUE
       , POS_NET_UNIT_VALUE
       , POS_NET_UNIT_VALUE_INCL
       , POS_REF_UNIT_VALUE
       , POS_GROSS_VALUE
       , POS_NET_VALUE_EXCL
       , POS_NET_VALUE_INCL
       , POS_BASIS_QUANTITY
       , POS_INTERMEDIATE_QUANTITY
       , POS_FINAL_QUANTITY
       , POS_BALANCE_QUANTITY
       , POS_RATE_FACTOR
       , POS_NET_WEIGHT
       , POS_GROSS_WEIGHT
       , Nvl(DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE_ID
       , POS_CONVERT_FACTOR
       , Nvl2(POS_NOM_TEXT, case
                when(POS_NOM_TEXT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_NOM_TEXT
       , POS_UNIT_COST_PRICE
       , Nvl(POS_EAN_CODE, '_') POS_EAN_CODE
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(DIC_POS_FREE_TABLE_1_ID, 'DWH_ISNULL') DIC_POS_FREE_TABLE_1_ID
       , Nvl(DIC_POS_FREE_TABLE_2_ID, 'DWH_ISNULL') DIC_POS_FREE_TABLE_2_ID
       , Nvl(DIC_POS_FREE_TABLE_3_ID, 'DWH_ISNULL') DIC_POS_FREE_TABLE_3_ID
       , POS_DECIMAL_1
       , POS_DECIMAL_2
       , POS_DECIMAL_3
       , Nvl(POS_TEXT_1, '_') POS_TEXT_1
       , Nvl(POS_TEXT_2, '_') POS_TEXT_2
       , Nvl(POS_TEXT_3, '_') POS_TEXT_3
       , POS_DISCOUNT_UNIT_VALUE
       , POS_DISCOUNT_RATE
       , Nvl(PAC_REPRESENTATIVE_ID, -2) PAC_REPRESENTATIVE_ID
       , Nvl(DOC_EXTRACT_COMMISSION_ID, -2) DOC_EXTRACT_COMMISSION_ID
       , POS_VALUE_QUANTITY
       , Nvl2(POS_INCLUDE_TAX_TARIFF, case
                when(POS_INCLUDE_TAX_TARIFF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_INCLUDE_TAX_TARIFF
       , POS_GROSS_UNIT_VALUE_INCL
       , POS_GROSS_VALUE_INCL
       , POS_BALANCE_QTY_VALUE
       , Nvl(CML_POSITION_ID, -2) CML_POSITION_ID
       , Nvl(DOC_DOC_POSITION_ID, -2) DOC_DOC_POSITION_ID
       , POS_UTIL_COEFF
       , POS_GROSS_UNIT_VALUE2
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(DIC_DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_DIC_UNIT_OF_MEASURE_ID
       , POS_CONVERT_FACTOR2
       , POS_VAT_AMOUNT_E
       , POS_GROSS_VALUE_B
       , POS_GROSS_VALUE_E
       , POS_GROSS_VALUE_INCL_B
       , POS_GROSS_VALUE_INCL_E
       , POS_NET_VALUE_EXCL_B
       , POS_NET_VALUE_EXCL_E
       , POS_NET_VALUE_INCL_B
       , POS_NET_VALUE_INCL_E
       , Nvl2(POS_MODIFY_RATE, case
                when(POS_MODIFY_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_MODIFY_RATE
       , POS_VAT_AMOUNT_V
       , POS_GROSS_VALUE_V
       , POS_GROSS_VALUE_INCL_V
       , POS_NET_VALUE_EXCL_V
       , POS_NET_VALUE_INCL_V
       , Nvl(ASA_RECORD_ID, -2) ASA_RECORD_ID
       , Nvl2(POS_NET_TARIFF, case
                when(POS_NET_TARIFF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_NET_TARIFF
       , Nvl2(POS_SPECIAL_TARIFF, case
                when(POS_SPECIAL_TARIFF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_SPECIAL_TARIFF
       , Nvl2(POS_FLAT_RATE, case
                when(POS_FLAT_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_FLAT_RATE
       , POS_BASIS_QUANTITY_SU
       , POS_INTERMEDIATE_QUANTITY_SU
       , POS_FINAL_QUANTITY_SU
       , Nvl(C_POS_DELIVERY_TYP, 'DWH_ISNULL') C_POS_DELIVERY_TYP
       , Nvl(ASA_RECORD_COMP_ID, -2) ASA_RECORD_COMP_ID
       , Nvl(ASA_RECORD_TASK_ID, -2) ASA_RECORD_TASK_ID
       , Nvl2(POS_BALANCED, case
                when(POS_BALANCED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_BALANCED
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(POS_IMF_TEXT_1, '_') POS_IMF_TEXT_1
       , Nvl(POS_IMF_TEXT_2, '_') POS_IMF_TEXT_2
       , Nvl(POS_IMF_TEXT_3, '_') POS_IMF_TEXT_3
       , Nvl(POS_IMF_TEXT_4, '_') POS_IMF_TEXT_4
       , Nvl(POS_IMF_TEXT_5, '_') POS_IMF_TEXT_5
       , POS_IMF_NUMBER_2
       , POS_IMF_NUMBER_3
       , POS_IMF_NUMBER_4
       , POS_IMF_NUMBER_5
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , Nvl2(POS_CREATE_POSITION_CHARGE, case
                when(POS_CREATE_POSITION_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_CREATE_POSITION_CHARGE
       , Nvl(FAL_SUPPLY_REQUEST_ID, -2) FAL_SUPPLY_REQUEST_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(DOC_DOC_RECORD_ID, -2) DOC_DOC_RECORD_ID
       , Nvl2(POS_GEN_CML_EVENTS, case
                when(POS_GEN_CML_EVENTS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_GEN_CML_EVENTS
       , Nvl2(POS_UPDATE_POSITION_CHARGE, case
                when(POS_UPDATE_POSITION_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_UPDATE_POSITION_CHARGE
       , Nvl(CML_EVENTS_ID, -2) CML_EVENTS_ID
       , Nvl(POS_PARTNER_NUMBER, '_') POS_PARTNER_NUMBER
       , Nvl(POS_PARTNER_REFERENCE, '_') POS_PARTNER_REFERENCE
       , Nvl(POS_DATE_PARTNER_DOCUMENT, to_date('40000101', 'YYYYMMDD') ) POS_DATE_PARTNER_DOCUMENT
       , Nvl2(POS_CUMULATIVE_CHARGE, case
                when(POS_CUMULATIVE_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_CUMULATIVE_CHARGE
       , Nvl2(POS_RECALC_AMOUNTS, case
                when(POS_RECALC_AMOUNTS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_RECALC_AMOUNTS
       , Nvl2(POS_PARENT_CHARGE, case
                when(POS_PARENT_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_PARENT_CHARGE
       , Nvl(POS_DATE_1, to_date('40000101', 'YYYYMMDD') ) POS_DATE_1
       , Nvl(POS_DATE_2, to_date('40000101', 'YYYYMMDD') ) POS_DATE_2
       , Nvl(POS_DATE_3, to_date('40000101', 'YYYYMMDD') ) POS_DATE_3
       , Nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , Nvl2(POS_UPDATE_TARIFF, case
                when(POS_UPDATE_TARIFF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_UPDATE_TARIFF
       , POS_TARIFF_UNIT
       , POS_TARIFF_INITIALIZED
       , Nvl2(POS_UPDATE_QTY_PRICE, case
                when(POS_UPDATE_QTY_PRICE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_UPDATE_QTY_PRICE
       , Nvl2(POS_TRANSFERT_PROPRIETOR, case
                when(POS_TRANSFERT_PROPRIETOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_TRANSFERT_PROPRIETOR
       , Nvl2(POS_CREATE_MAT, case
                when(POS_CREATE_MAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_CREATE_MAT
       , Nvl(POS_EAN_UCC14_CODE, '_') POS_EAN_UCC14_CODE
       , Nvl(POS_HIBC_PRIMARY_CODE, '_') POS_HIBC_PRIMARY_CODE
       , Nvl(ASA_RECORD_TASK_IMPUT_ID, -2) ASA_RECORD_TASK_IMPUT_ID
       , Nvl(C_POS_CREATE_MODE, 'DWH_ISNULL') C_POS_CREATE_MODE
       , Nvl(POS_TARIFF_SET, '_') POS_TARIFF_SET
       , Nvl2(POS_PRICE_TRANSFERED, case
                when(POS_PRICE_TRANSFERED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_PRICE_TRANSFERED
       , Nvl(POS_SECONDARY_REFERENCE, '_') POS_SECONDARY_REFERENCE
       , Nvl(POS_TARIFF_DATE, to_date('40000101', 'YYYYMMDD') ) POS_TARIFF_DATE
       , POS_GROSS_UNIT_VALUE_SU
       , POS_GROSS_UNIT_VALUE_INCL_SU
       , Nvl(POS_DATE_DELIVERY, to_date('40000101', 'YYYYMMDD') ) POS_DATE_DELIVERY
       , POS_VAT_RATE
       , POS_VAT_LIABLED_RATE
       , POS_VAT_LIABLED_AMOUNT
       , POS_VAT_TOTAL_AMOUNT
       , POS_VAT_DEDUCTIBLE_RATE
       , POS_VAT_TOTAL_AMOUNT_B
       , POS_VAT_TOTAL_AMOUNT_V
       , Nvl(POS_DATE_BALANCED, to_date('40000101', 'YYYYMMDD') ) POS_DATE_BALANCED
       , POS_QUANTITY_BALANCED
       , POS_CALC_BUDGET_AMOUNT_MB
       , POS_EFFECT_BUDGET_AMOUNT_MB
       , Nvl(ASA_INTERVENTION_DETAIL_ID, -2) ASA_INTERVENTION_DETAIL_ID
       , Nvl2(POS_BUDGET_EXCEEDED, case
                when(POS_BUDGET_EXCEEDED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_BUDGET_EXCEEDED
       , Nvl(POS_BUDGET_COMMENT, '_') POS_BUDGET_COMMENT
       , Nvl(POS_BUDGET_USER_ID, '_') POS_BUDGET_USER_ID
       , Nvl(POS_BUDGET_ACCEPT_DATE, to_date('40000101', 'YYYYMMDD') ) POS_BUDGET_ACCEPT_DATE
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl(PAC_REPR_ACI_ID, -2) PAC_REPR_ACI_ID
       , Nvl(PAC_REPR_DELIVERY_ID, -2) PAC_REPR_DELIVERY_ID
       , Nvl2(POS_IMPUTATION, case
                when(POS_IMPUTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_IMPUTATION
       , Nvl(PAC_THIRD_CDA_ID, -2) PAC_THIRD_CDA_ID
       , Nvl(PAC_THIRD_VAT_ID, -2) PAC_THIRD_VAT_ID
       , Nvl(DOC_INVOICE_EXPIRY_ID, -2) DOC_INVOICE_EXPIRY_ID
       , Nvl2(POS_INVOICE_EXPIRY, case
                when(POS_INVOICE_EXPIRY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_INVOICE_EXPIRY
       , Nvl(C_INVOICE_EXPIRY_INPUT_TYPE, 'DWH_ISNULL') C_INVOICE_EXPIRY_INPUT_TYPE
       , Nvl(DOC_INVOICE_EXPIRY_DETAIL_ID, -2) DOC_INVOICE_EXPIRY_DETAIL_ID
       , Nvl(POS_ADDENDUM_SRC_POS_ID, -2) POS_ADDENDUM_SRC_POS_ID
       , POS_ADDENDUM_QTY_BALANCED
       , POS_ADDENDUM_VALUE_QTY
       , Nvl2(POS_UPDATE_OP, case
                when(POS_UPDATE_OP >= 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_UPDATE_OP
       , Nvl(FAL_SCHEDULE_STEP_ID, -2) FAL_SCHEDULE_STEP_ID
       , Nvl(POS_EFFECTIVE_DIC_TARIFF_ID, '_') POS_EFFECTIVE_DIC_TARIFF_ID
       , Nvl(POS_PARTNER_POS_NUMBER, '_') POS_PARTNER_POS_NUMBER
       , Nvl(DOC_POS_LITIG_ID, -2) DOC_POS_LITIG_ID
       , Nvl2(POS_UPDATE_ATTRIB, case
                when(POS_UPDATE_ATTRIB = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') POS_UPDATE_ATTRIB
  from DOC_POSITION
  union all
  select -1 DOC_POSITION_ID
       , -1 DOC_DOCUMENT_ID
       , 'DWH_NA' C_GAUGE_TYPE_POS
       , 'DWH_NA' C_DOC_POS_STATUS
       , -1 GCO_GOOD_ID
       , -1 DOC_GAUGE_POSITION_ID
       , -1 DOC_RECORD_ID
       , -1 STM_STOCK_ID
       , -1 STM_STM_STOCK_ID
       , -1 STM_LOCATION_ID
       , -1 STM_STM_LOCATION_ID
       , -1 STM_MOVEMENT_KIND_ID
       , -1 ACS_TAX_CODE_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , null POS_NUMBER
       , 'N/A' POS_REFERENCE
       , 'N/A' POS_SHORT_DESCRIPTION
       , 'N/A' POS_LONG_DESCRIPTION
       , 'N/A' POS_FREE_DESCRIPTION
       , 'N/A' POS_BODY_TEXT
       , '-1' POS_GENERATE_MOVEMENT
       , '-1' POS_STOCK_OUTAGE
       , null POS_DISCOUNT_AMOUNT
       , null POS_CHARGE_AMOUNT
       , null POS_VAT_AMOUNT
       , null POS_VAT_BASE_AMOUNT
       , null POS_GROSS_UNIT_VALUE
       , null POS_NET_UNIT_VALUE
       , null POS_NET_UNIT_VALUE_INCL
       , null POS_REF_UNIT_VALUE
       , null POS_GROSS_VALUE
       , null POS_NET_VALUE_EXCL
       , null POS_NET_VALUE_INCL
       , null POS_BASIS_QUANTITY
       , null POS_INTERMEDIATE_QUANTITY
       , null POS_FINAL_QUANTITY
       , null POS_BALANCE_QUANTITY
       , null POS_RATE_FACTOR
       , null POS_NET_WEIGHT
       , null POS_GROSS_WEIGHT
       , 'DWH_NA' DIC_UNIT_OF_MEASURE_ID
       , null POS_CONVERT_FACTOR
       , '-1' POS_NOM_TEXT
       , null POS_UNIT_COST_PRICE
       , 'N/A' POS_EAN_CODE
       , -1 PC_APPLTXT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , 'DWH_NA' DIC_POS_FREE_TABLE_1_ID
       , 'DWH_NA' DIC_POS_FREE_TABLE_2_ID
       , 'DWH_NA' DIC_POS_FREE_TABLE_3_ID
       , null POS_DECIMAL_1
       , null POS_DECIMAL_2
       , null POS_DECIMAL_3
       , 'N/A' POS_TEXT_1
       , 'N/A' POS_TEXT_2
       , 'N/A' POS_TEXT_3
       , null POS_DISCOUNT_UNIT_VALUE
       , null POS_DISCOUNT_RATE
       , -1 PAC_REPRESENTATIVE_ID
       , -1 DOC_EXTRACT_COMMISSION_ID
       , null POS_VALUE_QUANTITY
       , '-1' POS_INCLUDE_TAX_TARIFF
       , null POS_GROSS_UNIT_VALUE_INCL
       , null POS_GROSS_VALUE_INCL
       , null POS_BALANCE_QTY_VALUE
       , -1 CML_POSITION_ID
       , -1 DOC_DOC_POSITION_ID
       , null POS_UTIL_COEFF
       , null POS_GROSS_UNIT_VALUE2
       , -1 PAC_THIRD_ID
       , -1 DOC_GAUGE_ID
       , 'DWH_NA' DIC_DIC_UNIT_OF_MEASURE_ID
       , null POS_CONVERT_FACTOR2
       , null POS_VAT_AMOUNT_E
       , null POS_GROSS_VALUE_B
       , null POS_GROSS_VALUE_E
       , null POS_GROSS_VALUE_INCL_B
       , null POS_GROSS_VALUE_INCL_E
       , null POS_NET_VALUE_EXCL_B
       , null POS_NET_VALUE_EXCL_E
       , null POS_NET_VALUE_INCL_B
       , null POS_NET_VALUE_INCL_E
       , '-1' POS_MODIFY_RATE
       , null POS_VAT_AMOUNT_V
       , null POS_GROSS_VALUE_V
       , null POS_GROSS_VALUE_INCL_V
       , null POS_NET_VALUE_EXCL_V
       , null POS_NET_VALUE_INCL_V
       , -1 ASA_RECORD_ID
       , '-1' POS_NET_TARIFF
       , '-1' POS_SPECIAL_TARIFF
       , '-1' POS_FLAT_RATE
       , null POS_BASIS_QUANTITY_SU
       , null POS_INTERMEDIATE_QUANTITY_SU
       , null POS_FINAL_QUANTITY_SU
       , 'DWH_NA' C_POS_DELIVERY_TYP
       , -1 ASA_RECORD_COMP_ID
       , -1 ASA_RECORD_TASK_ID
       , '-1' POS_BALANCED
       , -1 HRM_PERSON_ID
       , -1 FAM_FIXED_ASSETS_ID
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , 'N/A' POS_IMF_TEXT_1
       , 'N/A' POS_IMF_TEXT_2
       , 'N/A' POS_IMF_TEXT_3
       , 'N/A' POS_IMF_TEXT_4
       , 'N/A' POS_IMF_TEXT_5
       , null POS_IMF_NUMBER_2
       , null POS_IMF_NUMBER_3
       , null POS_IMF_NUMBER_4
       , null POS_IMF_NUMBER_5
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , '-1' POS_CREATE_POSITION_CHARGE
       , -1 FAL_SUPPLY_REQUEST_ID
       , -1 PAC_PERSON_ID
       , -1 DOC_DOC_RECORD_ID
       , '-1' POS_GEN_CML_EVENTS
       , '-1' POS_UPDATE_POSITION_CHARGE
       , -1 CML_EVENTS_ID
       , 'N/A' POS_PARTNER_NUMBER
       , 'N/A' POS_PARTNER_REFERENCE
       , to_date('00010101', 'YYYYMMDD') POS_DATE_PARTNER_DOCUMENT
       , '-1' POS_CUMULATIVE_CHARGE
       , '-1' POS_RECALC_AMOUNTS
       , '-1' POS_PARENT_CHARGE
       , to_date('00010101', 'YYYYMMDD') POS_DATE_1
       , to_date('00010101', 'YYYYMMDD') POS_DATE_2
       , to_date('00010101', 'YYYYMMDD') POS_DATE_3
       , 'DWH_NA' DIC_TARIFF_ID
       , '-1' POS_UPDATE_TARIFF
       , null POS_TARIFF_UNIT
       , null POS_TARIFF_INITIALIZED
       , '-1' POS_UPDATE_QTY_PRICE
       , '-1' POS_TRANSFERT_PROPRIETOR
       , '-1' POS_CREATE_MAT
       , 'N/A' POS_EAN_UCC14_CODE
       , 'N/A' POS_HIBC_PRIMARY_CODE
       , -1 ASA_RECORD_TASK_IMPUT_ID
       , 'DWH_NA' C_POS_CREATE_MODE
       , 'N/A' POS_TARIFF_SET
       , '-1' POS_PRICE_TRANSFERED
       , 'N/A' POS_SECONDARY_REFERENCE
       , to_date('00010101', 'YYYYMMDD') POS_TARIFF_DATE
       , null POS_GROSS_UNIT_VALUE_SU
       , null POS_GROSS_UNIT_VALUE_INCL_SU
       , to_date('00010101', 'YYYYMMDD') POS_DATE_DELIVERY
       , null POS_VAT_RATE
       , null POS_VAT_LIABLED_RATE
       , null POS_VAT_LIABLED_AMOUNT
       , null POS_VAT_TOTAL_AMOUNT
       , null POS_VAT_DEDUCTIBLE_RATE
       , null POS_VAT_TOTAL_AMOUNT_B
       , null POS_VAT_TOTAL_AMOUNT_V
       , to_date('00010101', 'YYYYMMDD') POS_DATE_BALANCED
       , null POS_QUANTITY_BALANCED
       , null POS_CALC_BUDGET_AMOUNT_MB
       , null POS_EFFECT_BUDGET_AMOUNT_MB
       , -1 ASA_INTERVENTION_DETAIL_ID
       , '-1' POS_BUDGET_EXCEEDED
       , 'N/A' POS_BUDGET_COMMENT
       , 'N/A' POS_BUDGET_USER_ID
       , to_date('00010101', 'YYYYMMDD') POS_BUDGET_ACCEPT_DATE
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , -1 PAC_REPR_ACI_ID
       , -1 PAC_REPR_DELIVERY_ID
       , '-1' POS_IMPUTATION
       , -1 PAC_THIRD_CDA_ID
       , -1 PAC_THIRD_VAT_ID
       , -1 DOC_INVOICE_EXPIRY_ID
       , '-1' POS_INVOICE_EXPIRY
       , 'DWH_NA' C_INVOICE_EXPIRY_INPUT_TYPE
       , -1 DOC_INVOICE_EXPIRY_DETAIL_ID
       , -1 POS_ADDENDUM_SRC_POS_ID
       , null POS_ADDENDUM_QTY_BALANCED
       , null POS_ADDENDUM_VALUE_QTY
       , '-1' POS_UPDATE_OP
       , -1 FAL_SCHEDULE_STEP_ID
       , 'N/A' POS_EFFECTIVE_DIC_TARIFF_ID
       , 'N/A' POS_PARTNER_POS_NUMBER
       , -1 DOC_POS_LITIG_ID
       , '-1' POS_UPDATE_ATTRIB
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_POSITION_CHARGE" ("DOC_POSITION_CHARGE_ID", "DOC_POSITION_ID", "PTC_CHARGE_ID", "PTC_DISCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "C_FINANCIAL_CHARGE", "PCH_DESCRIPTION", "PCH_AMOUNT", "PCH_RATE", "PCH_EXPRESS_IN", "ACS_PJ_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "DOC_DOC_POSITION_CHARGE_ID", "C_CALCULATION_MODE", "C_ROUND_TYPE", "PCH_AMOUNT_B", "PCH_AMOUNT_E", "PCH_TRANSFERT_PROP", "PCH_MODIFY", "PCH_IN_SERIES_CALCULATION", "PCH_BALANCE_AMOUNT", "PCH_NAME", "PCH_CALC_AMOUNT", "PCH_CALC_AMOUNT_B", "PCH_CALC_AMOUNT_E", "PCH_LIABLED_AMOUNT", "PCH_LIABLED_AMOUNT_B", "PCH_LIABLED_AMOUNT_E", "PCH_FIXED_AMOUNT", "PCH_FIXED_AMOUNT_B", "PCH_FIXED_AMOUNT_E", "PCH_EXCEEDED_AMOUNT_FROM", "PCH_EXCEEDED_AMOUNT_TO", "PCH_MIN_AMOUNT", "PCH_MAX_AMOUNT", "PCH_IS_MULTIPLICATOR", "PCH_ROUND_AMOUNT", "PCH_STORED_PROC", "PCH_AUTOMATIC_CALC", "PCH_SQL_EXTERN_ITEM", "PCH_QUANTITY_FROM", "PCH_QUANTITY_TO", "PCH_UNIT_DETAIL", "DOC_DOCUMENT_ID", "PAC_THIRD_ID", "PCH_MODIFY_RATE", "PCH_AMOUNT_V", "FAM_FIXED_ASSETS_ID", "HRM_PERSON_ID", "PCH_IMP_TEXT_1", "PCH_IMP_TEXT_2", "PCH_IMP_TEXT_3", "PCH_IMP_TEXT_4", "PCH_IMP_TEXT_5", "PCH_IMP_NUMBER_1", "PCH_IMP_NUMBER_2", "PCH_IMP_NUMBER_3", "PCH_IMP_NUMBER_4", "PCH_IMP_NUMBER_5", "C_FAM_TRANSACTION_TYP", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "PCH_EXCLUSIVE", "PCH_DISCHARGED", "PCH_CUMULATIVE", "C_CHARGE_ORIGIN", "DOC_DETAIL_COST_ID", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PCH_IMPUTATION", "PCH_PRCS_USE") AS
  select DOC_POSITION_CHARGE_ID
       , Nvl(DOC_POSITION_ID, -2) DOC_POSITION_ID
       , Nvl(PTC_CHARGE_ID, -2) PTC_CHARGE_ID
       , Nvl(PTC_DISCOUNT_ID, -2) PTC_DISCOUNT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(C_FINANCIAL_CHARGE, 'DWH_ISNULL') C_FINANCIAL_CHARGE
       , Nvl(PCH_DESCRIPTION, '_') PCH_DESCRIPTION
       , PCH_AMOUNT
       , PCH_RATE
       , PCH_EXPRESS_IN
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(DOC_DOC_POSITION_CHARGE_ID, -2) DOC_DOC_POSITION_CHARGE_ID
       , Nvl(C_CALCULATION_MODE, 'DWH_ISNULL') C_CALCULATION_MODE
       , Nvl(C_ROUND_TYPE, 'DWH_ISNULL') C_ROUND_TYPE
       , PCH_AMOUNT_B
       , PCH_AMOUNT_E
       , Nvl2(PCH_TRANSFERT_PROP, case
                when(PCH_TRANSFERT_PROP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_TRANSFERT_PROP
       , Nvl2(PCH_MODIFY, case
                when(PCH_MODIFY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_MODIFY
       , Nvl2(PCH_IN_SERIES_CALCULATION, case
                when(PCH_IN_SERIES_CALCULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_IN_SERIES_CALCULATION
       , PCH_BALANCE_AMOUNT
       , Nvl(PCH_NAME, '_') PCH_NAME
       , PCH_CALC_AMOUNT
       , PCH_CALC_AMOUNT_B
       , PCH_CALC_AMOUNT_E
       , PCH_LIABLED_AMOUNT
       , PCH_LIABLED_AMOUNT_B
       , PCH_LIABLED_AMOUNT_E
       , PCH_FIXED_AMOUNT
       , PCH_FIXED_AMOUNT_B
       , PCH_FIXED_AMOUNT_E
       , PCH_EXCEEDED_AMOUNT_FROM
       , PCH_EXCEEDED_AMOUNT_TO
       , PCH_MIN_AMOUNT
       , PCH_MAX_AMOUNT
       , Nvl2(PCH_IS_MULTIPLICATOR, case
                when(PCH_IS_MULTIPLICATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_IS_MULTIPLICATOR
       , PCH_ROUND_AMOUNT
       , Nvl(PCH_STORED_PROC, '_') PCH_STORED_PROC
       , Nvl2(PCH_AUTOMATIC_CALC, case
                when(PCH_AUTOMATIC_CALC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_AUTOMATIC_CALC
       , Nvl(PCH_SQL_EXTERN_ITEM, '_') PCH_SQL_EXTERN_ITEM
       , PCH_QUANTITY_FROM
       , PCH_QUANTITY_TO
       , Nvl2(PCH_UNIT_DETAIL, case
                when(PCH_UNIT_DETAIL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_UNIT_DETAIL
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl2(PCH_MODIFY_RATE, case
                when(PCH_MODIFY_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_MODIFY_RATE
       , PCH_AMOUNT_V
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(PCH_IMP_TEXT_1, '_') PCH_IMP_TEXT_1
       , Nvl(PCH_IMP_TEXT_2, '_') PCH_IMP_TEXT_2
       , Nvl(PCH_IMP_TEXT_3, '_') PCH_IMP_TEXT_3
       , Nvl(PCH_IMP_TEXT_4, '_') PCH_IMP_TEXT_4
       , Nvl(PCH_IMP_TEXT_5, '_') PCH_IMP_TEXT_5
       , PCH_IMP_NUMBER_1
       , PCH_IMP_NUMBER_2
       , PCH_IMP_NUMBER_3
       , PCH_IMP_NUMBER_4
       , PCH_IMP_NUMBER_5
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , Nvl2(PCH_EXCLUSIVE, case
                when(PCH_EXCLUSIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_EXCLUSIVE
       , Nvl2(PCH_DISCHARGED, case
                when(PCH_DISCHARGED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_DISCHARGED
       , Nvl2(PCH_CUMULATIVE, case
                when(PCH_CUMULATIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_CUMULATIVE
       , Nvl(C_CHARGE_ORIGIN, 'DWH_ISNULL') C_CHARGE_ORIGIN
       , Nvl(DOC_DETAIL_COST_ID, -2) DOC_DETAIL_COST_ID
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl2(PCH_IMPUTATION, case
                when(PCH_IMPUTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_IMPUTATION
       , Nvl2(PCH_PRCS_USE, case
                when(PCH_PRCS_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCH_PRCS_USE
  from DOC_POSITION_CHARGE
  union all
  select -1 DOC_POSITION_CHARGE_ID
       , -1 DOC_POSITION_ID
       , -1 PTC_CHARGE_ID
       , -1 PTC_DISCOUNT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , 'DWH_NA' C_FINANCIAL_CHARGE
       , 'N/A' PCH_DESCRIPTION
       , null PCH_AMOUNT
       , null PCH_RATE
       , null PCH_EXPRESS_IN
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 DOC_DOC_POSITION_CHARGE_ID
       , 'DWH_NA' C_CALCULATION_MODE
       , 'DWH_NA' C_ROUND_TYPE
       , null PCH_AMOUNT_B
       , null PCH_AMOUNT_E
       , '-1' PCH_TRANSFERT_PROP
       , '-1' PCH_MODIFY
       , '-1' PCH_IN_SERIES_CALCULATION
       , null PCH_BALANCE_AMOUNT
       , 'N/A' PCH_NAME
       , null PCH_CALC_AMOUNT
       , null PCH_CALC_AMOUNT_B
       , null PCH_CALC_AMOUNT_E
       , null PCH_LIABLED_AMOUNT
       , null PCH_LIABLED_AMOUNT_B
       , null PCH_LIABLED_AMOUNT_E
       , null PCH_FIXED_AMOUNT
       , null PCH_FIXED_AMOUNT_B
       , null PCH_FIXED_AMOUNT_E
       , null PCH_EXCEEDED_AMOUNT_FROM
       , null PCH_EXCEEDED_AMOUNT_TO
       , null PCH_MIN_AMOUNT
       , null PCH_MAX_AMOUNT
       , '-1' PCH_IS_MULTIPLICATOR
       , null PCH_ROUND_AMOUNT
       , 'N/A' PCH_STORED_PROC
       , '-1' PCH_AUTOMATIC_CALC
       , 'N/A' PCH_SQL_EXTERN_ITEM
       , null PCH_QUANTITY_FROM
       , null PCH_QUANTITY_TO
       , '-1' PCH_UNIT_DETAIL
       , -1 DOC_DOCUMENT_ID
       , -1 PAC_THIRD_ID
       , '-1' PCH_MODIFY_RATE
       , null PCH_AMOUNT_V
       , -1 FAM_FIXED_ASSETS_ID
       , -1 HRM_PERSON_ID
       , 'N/A' PCH_IMP_TEXT_1
       , 'N/A' PCH_IMP_TEXT_2
       , 'N/A' PCH_IMP_TEXT_3
       , 'N/A' PCH_IMP_TEXT_4
       , 'N/A' PCH_IMP_TEXT_5
       , null PCH_IMP_NUMBER_1
       , null PCH_IMP_NUMBER_2
       , null PCH_IMP_NUMBER_3
       , null PCH_IMP_NUMBER_4
       , null PCH_IMP_NUMBER_5
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , '-1' PCH_EXCLUSIVE
       , '-1' PCH_DISCHARGED
       , '-1' PCH_CUMULATIVE
       , 'DWH_NA' C_CHARGE_ORIGIN
       , -1 DOC_DETAIL_COST_ID
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , '-1' PCH_IMPUTATION
       , '-1' PCH_PRCS_USE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_POSITION_DETAIL" ("DOC_POSITION_DETAIL_ID", "DOC_GAUGE_FLOW_ID", "DOC_POSITION_ID", "DOC_DOC_POSITION_DETAIL_ID", "DOC2_DOC_POSITION_DETAIL_ID", "PDE_BASIS_DELAY", "PDE_BASIS_DELAY_W", "PDE_BASIS_DELAY_M", "PDE_INTERMEDIATE_DELAY", "PDE_INTERMEDIATE_DELAY_W", "PDE_INTERMEDIATE_DELAY_M", "PDE_FINAL_DELAY", "PDE_FINAL_DELAY_W", "PDE_FINAL_DELAY_M", "PDE_BASIS_QUANTITY", "PDE_INTERMEDIATE_QUANTITY", "PDE_FINAL_QUANTITY", "PDE_BALANCE_QUANTITY", "PDE_MOVEMENT_QUANTITY", "PDE_MOVEMENT_VALUE", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID", "PDE_BALANCE_QUANTITY_PARENT", "DIC_PDE_FREE_TABLE_1_ID", "DIC_PDE_FREE_TABLE_2_ID", "DIC_PDE_FREE_TABLE_3_ID", "PDE_DECIMAL_1", "PDE_DECIMAL_2", "PDE_DECIMAL_3", "PDE_TEXT_1", "PDE_TEXT_2", "PDE_TEXT_3", "FAL_SCHEDULE_STEP_ID", "DOC_DOCUMENT_ID", "PAC_THIRD_ID", "DOC_GAUGE_ID", "DOC_GAUGE_RECEIPT_ID", "DOC_GAUGE_COPY_ID", "DIC_DELAY_UPDATE_TYPE_ID", "PDE_DELAY_UPDATE_TEXT", "PDE_BASIS_QUANTITY_SU", "PDE_INTERMEDIATE_QUANTITY_SU", "PDE_FINAL_QUANTITY_SU", "PDE_GENERATE_MOVEMENT", "GCO_GOOD_ID", "PDE_PIECE", "PDE_SET", "PDE_VERSION", "PDE_CHRONOLOGICAL", "PDE_STD_CHAR_1", "PDE_STD_CHAR_2", "PDE_STD_CHAR_3", "PDE_STD_CHAR_4", "PDE_STD_CHAR_5", "PDE_BALANCE_PARENT", "FAL_NETWORK_LINK_ID", "PDE_DATE_1", "PDE_DATE_2", "PDE_DATE_3", "PDE_SQM_ACCEPTED_DELAY", "PDE_TRANSFERT_PROPRIETOR", "C_PDE_CREATE_MODE", "FAL_SUPPLY_REQUEST_ID", "GCO_GCO_GOOD_ID", "PDE_MOVEMENT_DATE", "DOC_POSITION_SRC_ID", "DOC_DOCUMENT_SRC_ID", "DOC_RECORD_ID", "CML_EVENTS_ID", "ACS_FINANCIAL_ACCOUNT_BS_ID", "ACS_FINANCIAL_ACCOUNT_PL_ID", "ACS_DIVISION_ACCOUNT_BS_ID", "ACS_DIVISION_ACCOUNT_PL_ID", "ACS_CPN_ACCOUNT_BS_ID", "ACS_CPN_ACCOUNT_PL_ID", "ACS_CDA_ACCOUNT_BS_ID", "ACS_CDA_ACCOUNT_PL_ID", "ACS_PF_ACCOUNT_BS_ID", "ACS_PF_ACCOUNT_PL_ID", "ACS_PJ_ACCOUNT_BS_ID", "ACS_PJ_ACCOUNT_PL_ID", "DOC_RECORD_BS_ID", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "PDE_IMF_NUMBER_1", "PDE_IMF_NUMBER_2", "PDE_IMF_NUMBER_3", "PDE_IMF_NUMBER_4", "PDE_IMF_NUMBER_5", "PDE_IMF_TEXT_1", "PDE_IMF_TEXT_2", "PDE_IMF_TEXT_3", "PDE_IMF_TEXT_4", "PDE_IMF_TEXT_5", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "PAC_THIRD_CDA_ID", "PAC_THIRD_VAT_ID", "PDE_ADDENDUM_QTY_BALANCED", "PDE_ADDENDUM_SRC_PDE_ID", "C_GAUGE_TYPE_POS", "DOC_PDE_LITIG_ID", "PDE_GAP_PURCHASE_PRICE") AS
  select DOC_POSITION_DETAIL_ID
       , Nvl(DOC_GAUGE_FLOW_ID, -2) DOC_GAUGE_FLOW_ID
       , Nvl(DOC_POSITION_ID, -2) DOC_POSITION_ID
       , Nvl(DOC_DOC_POSITION_DETAIL_ID, -2) DOC_DOC_POSITION_DETAIL_ID
       , Nvl(DOC2_DOC_POSITION_DETAIL_ID, -2) DOC2_DOC_POSITION_DETAIL_ID
       , Nvl(PDE_BASIS_DELAY, to_date('40000101', 'YYYYMMDD') ) PDE_BASIS_DELAY
       , Nvl(PDE_BASIS_DELAY_W, '_') PDE_BASIS_DELAY_W
       , Nvl(PDE_BASIS_DELAY_M, '_') PDE_BASIS_DELAY_M
       , Nvl(PDE_INTERMEDIATE_DELAY, to_date('40000101', 'YYYYMMDD') ) PDE_INTERMEDIATE_DELAY
       , Nvl(PDE_INTERMEDIATE_DELAY_W, '_') PDE_INTERMEDIATE_DELAY_W
       , Nvl(PDE_INTERMEDIATE_DELAY_M, '_') PDE_INTERMEDIATE_DELAY_M
       , Nvl(PDE_FINAL_DELAY, to_date('40000101', 'YYYYMMDD') ) PDE_FINAL_DELAY
       , Nvl(PDE_FINAL_DELAY_W, '_') PDE_FINAL_DELAY_W
       , Nvl(PDE_FINAL_DELAY_M, '_') PDE_FINAL_DELAY_M
       , PDE_BASIS_QUANTITY
       , PDE_INTERMEDIATE_QUANTITY
       , PDE_FINAL_QUANTITY
       , PDE_BALANCE_QUANTITY
       , PDE_MOVEMENT_QUANTITY
       , PDE_MOVEMENT_VALUE
       , Nvl(PDE_CHARACTERIZATION_VALUE_1, '_') PDE_CHARACTERIZATION_VALUE_1
       , Nvl(PDE_CHARACTERIZATION_VALUE_2, '_') PDE_CHARACTERIZATION_VALUE_2
       , Nvl(PDE_CHARACTERIZATION_VALUE_3, '_') PDE_CHARACTERIZATION_VALUE_3
       , Nvl(PDE_CHARACTERIZATION_VALUE_4, '_') PDE_CHARACTERIZATION_VALUE_4
       , Nvl(PDE_CHARACTERIZATION_VALUE_5, '_') PDE_CHARACTERIZATION_VALUE_5
       , Nvl(GCO_CHARACTERIZATION_ID, -2) GCO_CHARACTERIZATION_ID
       , Nvl(GCO_GCO_CHARACTERIZATION_ID, -2) GCO_GCO_CHARACTERIZATION_ID
       , Nvl(GCO2_GCO_CHARACTERIZATION_ID, -2) GCO2_GCO_CHARACTERIZATION_ID
       , Nvl(GCO3_GCO_CHARACTERIZATION_ID, -2) GCO3_GCO_CHARACTERIZATION_ID
       , Nvl(GCO4_GCO_CHARACTERIZATION_ID, -2) GCO4_GCO_CHARACTERIZATION_ID
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl(STM_STM_LOCATION_ID, -2) STM_STM_LOCATION_ID
       , PDE_BALANCE_QUANTITY_PARENT
       , Nvl(DIC_PDE_FREE_TABLE_1_ID, 'DWH_ISNULL') DIC_PDE_FREE_TABLE_1_ID
       , Nvl(DIC_PDE_FREE_TABLE_2_ID, 'DWH_ISNULL') DIC_PDE_FREE_TABLE_2_ID
       , Nvl(DIC_PDE_FREE_TABLE_3_ID, 'DWH_ISNULL') DIC_PDE_FREE_TABLE_3_ID
       , PDE_DECIMAL_1
       , PDE_DECIMAL_2
       , PDE_DECIMAL_3
       , Nvl(PDE_TEXT_1, '_') PDE_TEXT_1
       , Nvl(PDE_TEXT_2, '_') PDE_TEXT_2
       , Nvl(PDE_TEXT_3, '_') PDE_TEXT_3
       , Nvl(FAL_SCHEDULE_STEP_ID, -2) FAL_SCHEDULE_STEP_ID
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(DOC_GAUGE_RECEIPT_ID, -2) DOC_GAUGE_RECEIPT_ID
       , Nvl(DOC_GAUGE_COPY_ID, -2) DOC_GAUGE_COPY_ID
       , Nvl(DIC_DELAY_UPDATE_TYPE_ID, 'DWH_ISNULL') DIC_DELAY_UPDATE_TYPE_ID
       , Nvl(PDE_DELAY_UPDATE_TEXT, '_') PDE_DELAY_UPDATE_TEXT
       , PDE_BASIS_QUANTITY_SU
       , PDE_INTERMEDIATE_QUANTITY_SU
       , PDE_FINAL_QUANTITY_SU
       , Nvl2(PDE_GENERATE_MOVEMENT, case
                when(PDE_GENERATE_MOVEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDE_GENERATE_MOVEMENT
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(PDE_PIECE, '_') PDE_PIECE
       , Nvl(PDE_SET, '_') PDE_SET
       , Nvl(PDE_VERSION, '_') PDE_VERSION
       , Nvl(PDE_CHRONOLOGICAL, '_') PDE_CHRONOLOGICAL
       , Nvl(PDE_STD_CHAR_1, '_') PDE_STD_CHAR_1
       , Nvl(PDE_STD_CHAR_2, '_') PDE_STD_CHAR_2
       , Nvl(PDE_STD_CHAR_3, '_') PDE_STD_CHAR_3
       , Nvl(PDE_STD_CHAR_4, '_') PDE_STD_CHAR_4
       , Nvl(PDE_STD_CHAR_5, '_') PDE_STD_CHAR_5
       , Nvl2(PDE_BALANCE_PARENT, case
                when(PDE_BALANCE_PARENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDE_BALANCE_PARENT
       , Nvl(FAL_NETWORK_LINK_ID, -2) FAL_NETWORK_LINK_ID
       , Nvl(PDE_DATE_1, to_date('40000101', 'YYYYMMDD') ) PDE_DATE_1
       , Nvl(PDE_DATE_2, to_date('40000101', 'YYYYMMDD') ) PDE_DATE_2
       , Nvl(PDE_DATE_3, to_date('40000101', 'YYYYMMDD') ) PDE_DATE_3
       , Nvl(PDE_SQM_ACCEPTED_DELAY, to_date('40000101', 'YYYYMMDD') ) PDE_SQM_ACCEPTED_DELAY
       , Nvl2(PDE_TRANSFERT_PROPRIETOR, case
                when(PDE_TRANSFERT_PROPRIETOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDE_TRANSFERT_PROPRIETOR
       , Nvl(C_PDE_CREATE_MODE, 'DWH_ISNULL') C_PDE_CREATE_MODE
       , Nvl(FAL_SUPPLY_REQUEST_ID, -2) FAL_SUPPLY_REQUEST_ID
       , Nvl(GCO_GCO_GOOD_ID, -2) GCO_GCO_GOOD_ID
       , Nvl(PDE_MOVEMENT_DATE, to_date('40000101', 'YYYYMMDD') ) PDE_MOVEMENT_DATE
       , Nvl(DOC_POSITION_SRC_ID, -2) DOC_POSITION_SRC_ID
       , Nvl(DOC_DOCUMENT_SRC_ID, -2) DOC_DOCUMENT_SRC_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(CML_EVENTS_ID, -2) CML_EVENTS_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_BS_ID, -2) ACS_FINANCIAL_ACCOUNT_BS_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_PL_ID, -2) ACS_FINANCIAL_ACCOUNT_PL_ID
       , Nvl(ACS_DIVISION_ACCOUNT_BS_ID, -2) ACS_DIVISION_ACCOUNT_BS_ID
       , Nvl(ACS_DIVISION_ACCOUNT_PL_ID, -2) ACS_DIVISION_ACCOUNT_PL_ID
       , Nvl(ACS_CPN_ACCOUNT_BS_ID, -2) ACS_CPN_ACCOUNT_BS_ID
       , Nvl(ACS_CPN_ACCOUNT_PL_ID, -2) ACS_CPN_ACCOUNT_PL_ID
       , Nvl(ACS_CDA_ACCOUNT_BS_ID, -2) ACS_CDA_ACCOUNT_BS_ID
       , Nvl(ACS_CDA_ACCOUNT_PL_ID, -2) ACS_CDA_ACCOUNT_PL_ID
       , Nvl(ACS_PF_ACCOUNT_BS_ID, -2) ACS_PF_ACCOUNT_BS_ID
       , Nvl(ACS_PF_ACCOUNT_PL_ID, -2) ACS_PF_ACCOUNT_PL_ID
       , Nvl(ACS_PJ_ACCOUNT_BS_ID, -2) ACS_PJ_ACCOUNT_BS_ID
       , Nvl(ACS_PJ_ACCOUNT_PL_ID, -2) ACS_PJ_ACCOUNT_PL_ID
       , Nvl(DOC_RECORD_BS_ID, -2) DOC_RECORD_BS_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , PDE_IMF_NUMBER_1
       , PDE_IMF_NUMBER_2
       , PDE_IMF_NUMBER_3
       , PDE_IMF_NUMBER_4
       , PDE_IMF_NUMBER_5
       , Nvl(PDE_IMF_TEXT_1, '_') PDE_IMF_TEXT_1
       , Nvl(PDE_IMF_TEXT_2, '_') PDE_IMF_TEXT_2
       , Nvl(PDE_IMF_TEXT_3, '_') PDE_IMF_TEXT_3
       , Nvl(PDE_IMF_TEXT_4, '_') PDE_IMF_TEXT_4
       , Nvl(PDE_IMF_TEXT_5, '_') PDE_IMF_TEXT_5
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl(PAC_THIRD_CDA_ID, -2) PAC_THIRD_CDA_ID
       , Nvl(PAC_THIRD_VAT_ID, -2) PAC_THIRD_VAT_ID
       , PDE_ADDENDUM_QTY_BALANCED
       , Nvl(PDE_ADDENDUM_SRC_PDE_ID, -2) PDE_ADDENDUM_SRC_PDE_ID
       , Nvl(C_GAUGE_TYPE_POS, 'DWH_ISNULL') C_GAUGE_TYPE_POS
       , Nvl(DOC_PDE_LITIG_ID, -2) DOC_PDE_LITIG_ID
       , PDE_GAP_PURCHASE_PRICE
  from DOC_POSITION_DETAIL
  union all
  select -1 DOC_POSITION_DETAIL_ID
       , -1 DOC_GAUGE_FLOW_ID
       , -1 DOC_POSITION_ID
       , -1 DOC_DOC_POSITION_DETAIL_ID
       , -1 DOC2_DOC_POSITION_DETAIL_ID
       , to_date('00010101', 'YYYYMMDD') PDE_BASIS_DELAY
       , 'N/A' PDE_BASIS_DELAY_W
       , 'N/A' PDE_BASIS_DELAY_M
       , to_date('00010101', 'YYYYMMDD') PDE_INTERMEDIATE_DELAY
       , 'N/A' PDE_INTERMEDIATE_DELAY_W
       , 'N/A' PDE_INTERMEDIATE_DELAY_M
       , to_date('00010101', 'YYYYMMDD') PDE_FINAL_DELAY
       , 'N/A' PDE_FINAL_DELAY_W
       , 'N/A' PDE_FINAL_DELAY_M
       , null PDE_BASIS_QUANTITY
       , null PDE_INTERMEDIATE_QUANTITY
       , null PDE_FINAL_QUANTITY
       , null PDE_BALANCE_QUANTITY
       , null PDE_MOVEMENT_QUANTITY
       , null PDE_MOVEMENT_VALUE
       , 'N/A' PDE_CHARACTERIZATION_VALUE_1
       , 'N/A' PDE_CHARACTERIZATION_VALUE_2
       , 'N/A' PDE_CHARACTERIZATION_VALUE_3
       , 'N/A' PDE_CHARACTERIZATION_VALUE_4
       , 'N/A' PDE_CHARACTERIZATION_VALUE_5
       , -1 GCO_CHARACTERIZATION_ID
       , -1 GCO_GCO_CHARACTERIZATION_ID
       , -1 GCO2_GCO_CHARACTERIZATION_ID
       , -1 GCO3_GCO_CHARACTERIZATION_ID
       , -1 GCO4_GCO_CHARACTERIZATION_ID
       , -1 STM_LOCATION_ID
       , -1 STM_STM_LOCATION_ID
       , null PDE_BALANCE_QUANTITY_PARENT
       , 'DWH_NA' DIC_PDE_FREE_TABLE_1_ID
       , 'DWH_NA' DIC_PDE_FREE_TABLE_2_ID
       , 'DWH_NA' DIC_PDE_FREE_TABLE_3_ID
       , null PDE_DECIMAL_1
       , null PDE_DECIMAL_2
       , null PDE_DECIMAL_3
       , 'N/A' PDE_TEXT_1
       , 'N/A' PDE_TEXT_2
       , 'N/A' PDE_TEXT_3
       , -1 FAL_SCHEDULE_STEP_ID
       , -1 DOC_DOCUMENT_ID
       , -1 PAC_THIRD_ID
       , -1 DOC_GAUGE_ID
       , -1 DOC_GAUGE_RECEIPT_ID
       , -1 DOC_GAUGE_COPY_ID
       , 'DWH_NA' DIC_DELAY_UPDATE_TYPE_ID
       , 'N/A' PDE_DELAY_UPDATE_TEXT
       , null PDE_BASIS_QUANTITY_SU
       , null PDE_INTERMEDIATE_QUANTITY_SU
       , null PDE_FINAL_QUANTITY_SU
       , '-1' PDE_GENERATE_MOVEMENT
       , -1 GCO_GOOD_ID
       , 'N/A' PDE_PIECE
       , 'N/A' PDE_SET
       , 'N/A' PDE_VERSION
       , 'N/A' PDE_CHRONOLOGICAL
       , 'N/A' PDE_STD_CHAR_1
       , 'N/A' PDE_STD_CHAR_2
       , 'N/A' PDE_STD_CHAR_3
       , 'N/A' PDE_STD_CHAR_4
       , 'N/A' PDE_STD_CHAR_5
       , '-1' PDE_BALANCE_PARENT
       , -1 FAL_NETWORK_LINK_ID
       , to_date('00010101', 'YYYYMMDD') PDE_DATE_1
       , to_date('00010101', 'YYYYMMDD') PDE_DATE_2
       , to_date('00010101', 'YYYYMMDD') PDE_DATE_3
       , to_date('00010101', 'YYYYMMDD') PDE_SQM_ACCEPTED_DELAY
       , '-1' PDE_TRANSFERT_PROPRIETOR
       , 'DWH_NA' C_PDE_CREATE_MODE
       , -1 FAL_SUPPLY_REQUEST_ID
       , -1 GCO_GCO_GOOD_ID
       , to_date('00010101', 'YYYYMMDD') PDE_MOVEMENT_DATE
       , -1 DOC_POSITION_SRC_ID
       , -1 DOC_DOCUMENT_SRC_ID
       , -1 DOC_RECORD_ID
       , -1 CML_EVENTS_ID
       , -1 ACS_FINANCIAL_ACCOUNT_BS_ID
       , -1 ACS_FINANCIAL_ACCOUNT_PL_ID
       , -1 ACS_DIVISION_ACCOUNT_BS_ID
       , -1 ACS_DIVISION_ACCOUNT_PL_ID
       , -1 ACS_CPN_ACCOUNT_BS_ID
       , -1 ACS_CPN_ACCOUNT_PL_ID
       , -1 ACS_CDA_ACCOUNT_BS_ID
       , -1 ACS_CDA_ACCOUNT_PL_ID
       , -1 ACS_PF_ACCOUNT_BS_ID
       , -1 ACS_PF_ACCOUNT_PL_ID
       , -1 ACS_PJ_ACCOUNT_BS_ID
       , -1 ACS_PJ_ACCOUNT_PL_ID
       , -1 DOC_RECORD_BS_ID
       , -1 HRM_PERSON_ID
       , -1 FAM_FIXED_ASSETS_ID
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , null PDE_IMF_NUMBER_1
       , null PDE_IMF_NUMBER_2
       , null PDE_IMF_NUMBER_3
       , null PDE_IMF_NUMBER_4
       , null PDE_IMF_NUMBER_5
       , 'N/A' PDE_IMF_TEXT_1
       , 'N/A' PDE_IMF_TEXT_2
       , 'N/A' PDE_IMF_TEXT_3
       , 'N/A' PDE_IMF_TEXT_4
       , 'N/A' PDE_IMF_TEXT_5
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , -1 PAC_THIRD_CDA_ID
       , -1 PAC_THIRD_VAT_ID
       , null PDE_ADDENDUM_QTY_BALANCED
       , -1 PDE_ADDENDUM_SRC_PDE_ID
       , 'DWH_NA' C_GAUGE_TYPE_POS
       , -1 DOC_PDE_LITIG_ID
       , null PDE_GAP_PURCHASE_PRICE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_RECORD" ("DOC_RECORD_ID", "PAC_THIRD_ID", "DIC_ACCOUNTABLE_GROUP_ID", "RCO_TITLE", "RCO_DESCRIPTION", "DIC_RECORD1_ID", "DIC_RECORD2_ID", "DIC_RECORD3_ID", "DIC_RECORD4_ID", "DIC_RECORD5_ID", "DIC_RECORD6_ID", "DIC_RECORD7_ID", "DIC_RECORD8_ID", "DIC_RECORD9_ID", "DIC_RECORD10_ID", "RCO_BOOLEAN1", "RCO_BOOLEAN2", "RCO_BOOLEAN3", "RCO_BOOLEAN4", "RCO_BOOLEAN5", "RCO_BOOLEAN6", "RCO_BOOLEAN7", "RCO_BOOLEAN8", "RCO_BOOLEAN9", "RCO_BOOLEAN10", "RCO_ALPHA_SHORT1", "RCO_ALPHA_SHORT2", "RCO_ALPHA_SHORT3", "RCO_ALPHA_SHORT4", "RCO_ALPHA_SHORT5", "RCO_ALPHA_SHORT6", "RCO_ALPHA_SHORT7", "RCO_ALPHA_SHORT8", "RCO_ALPHA_SHORT9", "RCO_ALPHA_SHORT10", "RCO_ALPHA_LONG1", "RCO_ALPHA_LONG2", "RCO_ALPHA_LONG3", "RCO_ALPHA_LONG4", "RCO_ALPHA_LONG5", "RCO_ALPHA_LONG6", "RCO_ALPHA_LONG7", "RCO_ALPHA_LONG8", "RCO_ALPHA_LONG9", "RCO_ALPHA_LONG10", "RCO_DATE1", "RCO_DATE2", "RCO_DATE3", "RCO_DATE4", "RCO_DATE5", "RCO_DATE6", "RCO_DATE7", "RCO_DATE8", "RCO_DATE9", "RCO_DATE10", "RCO_DECIMAL1", "RCO_DECIMAL2", "RCO_DECIMAL3", "RCO_DECIMAL4", "RCO_DECIMAL5", "RCO_DECIMAL6", "RCO_DECIMAL7", "RCO_DECIMAL8", "RCO_DECIMAL9", "RCO_DECIMAL10", "RCO_NUMBER", "DIC_PERSON_POLITNESS_ID", "PC_LANG_ID", "PC_CNTRY_ID", "PAC_REPRESENTATIVE_ID", "RCO_NAME", "RCO_FORENAME", "RCO_ACTIVITY", "RCO_ZIPCODE", "RCO_CITY", "RCO_PHONE", "RCO_FAX", "RCO_ADD_FORMAT", "RCO_STATE", "RCO_ADDRESS", "RCO_AGREEMENT_NUMBER", "GAL_TASK_ID", "GAL_PROJECT_ID", "C_RCO_STATUS", "C_RCO_TYPE", "DOC_RECORD_CATEGORY_ID", "GAL_BUDGET_ID", "RCO_MACHINE_GOOD_ID", "STM_ELEMENT_NUMBER_ID", "RCO_SUPPLIER_WARRANTY_END", "RCO_MACHINE_LONG_DESCR", "RCO_MACHINE_FREE_DESCR", "RCO_MACHINE_REMARK", "RCO_MACHINE_COMMENT", "RCO_SUPPLIER_SERIAL_NUMBER", "RCO_SALE_PRICE", "RCO_COST_PRICE", "RCO_ESTIMATE_PRICE", "C_ASA_MACHINE_STATE", "PC_USER_ID", "RCO_STARTING_DATE", "RCO_ENDING_DATE", "RCO_DIC_ASSOCIATION_TYPE", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "DOC_PURCHASE_POSITION_ID", "C_ASA_GUARANTY_UNIT", "RCO_WARRANTY_PC_APPLTXT_ID", "RCO_SUPPLIER_WARRANTY_START", "RCO_SUPPLIER_WARRANTY_TERM", "RCO_WARRANTY_TEXT", "DIC_RCO_MACHINE1_ID", "DIC_RCO_MACHINE2_ID", "DIC_RCO_MACHINE3_ID", "DIC_RCO_MACHINE4_ID", "DIC_RCO_MACHINE5_ID", "DIC_RCO_MACHINE6_ID", "DIC_RCO_MACHINE7_ID", "DIC_RCO_MACHINE8_ID", "DIC_RCO_MACHINE9_ID", "DIC_RCO_MACHINE10_ID", "RCO_MACHINE_BOOLEAN1", "RCO_MACHINE_BOOLEAN2", "RCO_MACHINE_BOOLEAN3", "RCO_MACHINE_BOOLEAN4", "RCO_MACHINE_BOOLEAN5", "RCO_MACHINE_BOOLEAN6", "RCO_MACHINE_BOOLEAN7", "RCO_MACHINE_BOOLEAN8", "RCO_MACHINE_BOOLEAN9", "RCO_MACHINE_BOOLEAN10", "RCO_MACHINE_ALPHA_SHORT1", "RCO_MACHINE_ALPHA_SHORT2", "RCO_MACHINE_ALPHA_SHORT3", "RCO_MACHINE_ALPHA_SHORT4", "RCO_MACHINE_ALPHA_SHORT5", "RCO_MACHINE_ALPHA_SHORT6", "RCO_MACHINE_ALPHA_SHORT7", "RCO_MACHINE_ALPHA_SHORT8", "RCO_MACHINE_ALPHA_SHORT9", "RCO_MACHINE_ALPHA_SHORT10", "RCO_MACHINE_ALPHA_LONG1", "RCO_MACHINE_ALPHA_LONG2", "RCO_MACHINE_ALPHA_LONG3", "RCO_MACHINE_ALPHA_LONG4", "RCO_MACHINE_ALPHA_LONG5", "RCO_MACHINE_ALPHA_LONG6", "RCO_MACHINE_ALPHA_LONG7", "RCO_MACHINE_ALPHA_LONG8", "RCO_MACHINE_ALPHA_LONG9", "RCO_MACHINE_ALPHA_LONG10", "RCO_MACHINE_DATE1", "RCO_MACHINE_DATE2", "RCO_MACHINE_DATE3", "RCO_MACHINE_DATE4", "RCO_MACHINE_DATE5", "RCO_MACHINE_DATE6", "RCO_MACHINE_DATE7", "RCO_MACHINE_DATE8", "RCO_MACHINE_DATE9", "RCO_MACHINE_DATE10", "RCO_MACHINE_DECIMAL1", "RCO_MACHINE_DECIMAL2", "RCO_MACHINE_DECIMAL3", "RCO_MACHINE_DECIMAL4", "RCO_MACHINE_DECIMAL5", "RCO_MACHINE_DECIMAL6", "RCO_MACHINE_DECIMAL7", "RCO_MACHINE_DECIMAL8", "RCO_MACHINE_DECIMAL9", "RCO_MACHINE_DECIMAL10", "GAL_TASK_LINK_ID", "C_RCO_ORIGIN", "DOC_PROJECT_DOCUMENT_ID", "PPS_NOMENCLATURE_ID", "DOC_RECORD_GAL_ID") AS
  select DOC_RECORD_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(DIC_ACCOUNTABLE_GROUP_ID, 'DWH_ISNULL') DIC_ACCOUNTABLE_GROUP_ID
       , Nvl(RCO_TITLE, '_') RCO_TITLE
       , Nvl(RCO_DESCRIPTION, '_') RCO_DESCRIPTION
       , Nvl(DIC_RECORD1_ID, 'DWH_ISNULL') DIC_RECORD1_ID
       , Nvl(DIC_RECORD2_ID, 'DWH_ISNULL') DIC_RECORD2_ID
       , Nvl(DIC_RECORD3_ID, 'DWH_ISNULL') DIC_RECORD3_ID
       , Nvl(DIC_RECORD4_ID, 'DWH_ISNULL') DIC_RECORD4_ID
       , Nvl(DIC_RECORD5_ID, 'DWH_ISNULL') DIC_RECORD5_ID
       , Nvl(DIC_RECORD6_ID, 'DWH_ISNULL') DIC_RECORD6_ID
       , Nvl(DIC_RECORD7_ID, 'DWH_ISNULL') DIC_RECORD7_ID
       , Nvl(DIC_RECORD8_ID, 'DWH_ISNULL') DIC_RECORD8_ID
       , Nvl(DIC_RECORD9_ID, 'DWH_ISNULL') DIC_RECORD9_ID
       , Nvl(DIC_RECORD10_ID, 'DWH_ISNULL') DIC_RECORD10_ID
       , Nvl2(RCO_BOOLEAN1, case
                when(RCO_BOOLEAN1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN1
       , Nvl2(RCO_BOOLEAN2, case
                when(RCO_BOOLEAN2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN2
       , Nvl2(RCO_BOOLEAN3, case
                when(RCO_BOOLEAN3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN3
       , Nvl2(RCO_BOOLEAN4, case
                when(RCO_BOOLEAN4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN4
       , Nvl2(RCO_BOOLEAN5, case
                when(RCO_BOOLEAN5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN5
       , Nvl2(RCO_BOOLEAN6, case
                when(RCO_BOOLEAN6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN6
       , Nvl2(RCO_BOOLEAN7, case
                when(RCO_BOOLEAN7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN7
       , Nvl2(RCO_BOOLEAN8, case
                when(RCO_BOOLEAN8 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN8
       , Nvl2(RCO_BOOLEAN9, case
                when(RCO_BOOLEAN9 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN9
       , Nvl2(RCO_BOOLEAN10, case
                when(RCO_BOOLEAN10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_BOOLEAN10
       , Nvl(RCO_ALPHA_SHORT1, '_') RCO_ALPHA_SHORT1
       , Nvl(RCO_ALPHA_SHORT2, '_') RCO_ALPHA_SHORT2
       , Nvl(RCO_ALPHA_SHORT3, '_') RCO_ALPHA_SHORT3
       , Nvl(RCO_ALPHA_SHORT4, '_') RCO_ALPHA_SHORT4
       , Nvl(RCO_ALPHA_SHORT5, '_') RCO_ALPHA_SHORT5
       , Nvl(RCO_ALPHA_SHORT6, '_') RCO_ALPHA_SHORT6
       , Nvl(RCO_ALPHA_SHORT7, '_') RCO_ALPHA_SHORT7
       , Nvl(RCO_ALPHA_SHORT8, '_') RCO_ALPHA_SHORT8
       , Nvl(RCO_ALPHA_SHORT9, '_') RCO_ALPHA_SHORT9
       , Nvl(RCO_ALPHA_SHORT10, '_') RCO_ALPHA_SHORT10
       , Nvl(RCO_ALPHA_LONG1, '_') RCO_ALPHA_LONG1
       , Nvl(RCO_ALPHA_LONG2, '_') RCO_ALPHA_LONG2
       , Nvl(RCO_ALPHA_LONG3, '_') RCO_ALPHA_LONG3
       , Nvl(RCO_ALPHA_LONG4, '_') RCO_ALPHA_LONG4
       , Nvl(RCO_ALPHA_LONG5, '_') RCO_ALPHA_LONG5
       , Nvl(RCO_ALPHA_LONG6, '_') RCO_ALPHA_LONG6
       , Nvl(RCO_ALPHA_LONG7, '_') RCO_ALPHA_LONG7
       , Nvl(RCO_ALPHA_LONG8, '_') RCO_ALPHA_LONG8
       , Nvl(RCO_ALPHA_LONG9, '_') RCO_ALPHA_LONG9
       , Nvl(RCO_ALPHA_LONG10, '_') RCO_ALPHA_LONG10
       , Nvl(RCO_DATE1, to_date('40000101', 'YYYYMMDD') ) RCO_DATE1
       , Nvl(RCO_DATE2, to_date('40000101', 'YYYYMMDD') ) RCO_DATE2
       , Nvl(RCO_DATE3, to_date('40000101', 'YYYYMMDD') ) RCO_DATE3
       , Nvl(RCO_DATE4, to_date('40000101', 'YYYYMMDD') ) RCO_DATE4
       , Nvl(RCO_DATE5, to_date('40000101', 'YYYYMMDD') ) RCO_DATE5
       , Nvl(RCO_DATE6, to_date('40000101', 'YYYYMMDD') ) RCO_DATE6
       , Nvl(RCO_DATE7, to_date('40000101', 'YYYYMMDD') ) RCO_DATE7
       , Nvl(RCO_DATE8, to_date('40000101', 'YYYYMMDD') ) RCO_DATE8
       , Nvl(RCO_DATE9, to_date('40000101', 'YYYYMMDD') ) RCO_DATE9
       , Nvl(RCO_DATE10, to_date('40000101', 'YYYYMMDD') ) RCO_DATE10
       , RCO_DECIMAL1
       , RCO_DECIMAL2
       , RCO_DECIMAL3
       , RCO_DECIMAL4
       , RCO_DECIMAL5
       , RCO_DECIMAL6
       , RCO_DECIMAL7
       , RCO_DECIMAL8
       , RCO_DECIMAL9
       , RCO_DECIMAL10
       , RCO_NUMBER
       , Nvl(DIC_PERSON_POLITNESS_ID, 'DWH_ISNULL') DIC_PERSON_POLITNESS_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(PC_CNTRY_ID, -2) PC_CNTRY_ID
       , Nvl(PAC_REPRESENTATIVE_ID, -2) PAC_REPRESENTATIVE_ID
       , Nvl(RCO_NAME, '_') RCO_NAME
       , Nvl(RCO_FORENAME, '_') RCO_FORENAME
       , Nvl(RCO_ACTIVITY, '_') RCO_ACTIVITY
       , Nvl(RCO_ZIPCODE, '_') RCO_ZIPCODE
       , Nvl(RCO_CITY, '_') RCO_CITY
       , Nvl(RCO_PHONE, '_') RCO_PHONE
       , Nvl(RCO_FAX, '_') RCO_FAX
       , Nvl(RCO_ADD_FORMAT, '_') RCO_ADD_FORMAT
       , Nvl(RCO_STATE, '_') RCO_STATE
       , Nvl(RCO_ADDRESS, '_') RCO_ADDRESS
       , Nvl(RCO_AGREEMENT_NUMBER, '_') RCO_AGREEMENT_NUMBER
       , Nvl(GAL_TASK_ID, -2) GAL_TASK_ID
       , Nvl(GAL_PROJECT_ID, -2) GAL_PROJECT_ID
       , Nvl(C_RCO_STATUS, 'DWH_ISNULL') C_RCO_STATUS
       , Nvl(C_RCO_TYPE, 'DWH_ISNULL') C_RCO_TYPE
       , Nvl(DOC_RECORD_CATEGORY_ID, -2) DOC_RECORD_CATEGORY_ID
       , Nvl(GAL_BUDGET_ID, -2) GAL_BUDGET_ID
       , Nvl(RCO_MACHINE_GOOD_ID, -2) RCO_MACHINE_GOOD_ID
       , Nvl(STM_ELEMENT_NUMBER_ID, -2) STM_ELEMENT_NUMBER_ID
       , Nvl(RCO_SUPPLIER_WARRANTY_END, to_date('40000101', 'YYYYMMDD') ) RCO_SUPPLIER_WARRANTY_END
       , Nvl(RCO_MACHINE_LONG_DESCR, '_') RCO_MACHINE_LONG_DESCR
       , Nvl(RCO_MACHINE_FREE_DESCR, '_') RCO_MACHINE_FREE_DESCR
       , Nvl(RCO_MACHINE_REMARK, '_') RCO_MACHINE_REMARK
       , Nvl(RCO_MACHINE_COMMENT, '_') RCO_MACHINE_COMMENT
       , Nvl(RCO_SUPPLIER_SERIAL_NUMBER, '_') RCO_SUPPLIER_SERIAL_NUMBER
       , RCO_SALE_PRICE
       , RCO_COST_PRICE
       , RCO_ESTIMATE_PRICE
       , Nvl(C_ASA_MACHINE_STATE, 'DWH_ISNULL') C_ASA_MACHINE_STATE
       , Nvl(PC_USER_ID, -2) PC_USER_ID
       , Nvl(RCO_STARTING_DATE, to_date('40000101', 'YYYYMMDD') ) RCO_STARTING_DATE
       , Nvl(RCO_ENDING_DATE, to_date('40000101', 'YYYYMMDD') ) RCO_ENDING_DATE
       -- RCO_XML_CONDITIONS cannot be used with CLOB
       , Nvl(RCO_DIC_ASSOCIATION_TYPE, '_') RCO_DIC_ASSOCIATION_TYPE
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(DOC_PURCHASE_POSITION_ID, -2) DOC_PURCHASE_POSITION_ID
       , Nvl(C_ASA_GUARANTY_UNIT, 'DWH_ISNULL') C_ASA_GUARANTY_UNIT
       , Nvl(RCO_WARRANTY_PC_APPLTXT_ID, -2) RCO_WARRANTY_PC_APPLTXT_ID
       , Nvl(RCO_SUPPLIER_WARRANTY_START, to_date('40000101', 'YYYYMMDD') ) RCO_SUPPLIER_WARRANTY_START
       , RCO_SUPPLIER_WARRANTY_TERM
       , Nvl(RCO_WARRANTY_TEXT, '_') RCO_WARRANTY_TEXT
       , Nvl(DIC_RCO_MACHINE1_ID, 'DWH_ISNULL') DIC_RCO_MACHINE1_ID
       , Nvl(DIC_RCO_MACHINE2_ID, 'DWH_ISNULL') DIC_RCO_MACHINE2_ID
       , Nvl(DIC_RCO_MACHINE3_ID, 'DWH_ISNULL') DIC_RCO_MACHINE3_ID
       , Nvl(DIC_RCO_MACHINE4_ID, 'DWH_ISNULL') DIC_RCO_MACHINE4_ID
       , Nvl(DIC_RCO_MACHINE5_ID, 'DWH_ISNULL') DIC_RCO_MACHINE5_ID
       , Nvl(DIC_RCO_MACHINE6_ID, 'DWH_ISNULL') DIC_RCO_MACHINE6_ID
       , Nvl(DIC_RCO_MACHINE7_ID, 'DWH_ISNULL') DIC_RCO_MACHINE7_ID
       , Nvl(DIC_RCO_MACHINE8_ID, 'DWH_ISNULL') DIC_RCO_MACHINE8_ID
       , Nvl(DIC_RCO_MACHINE9_ID, 'DWH_ISNULL') DIC_RCO_MACHINE9_ID
       , Nvl(DIC_RCO_MACHINE10_ID, 'DWH_ISNULL') DIC_RCO_MACHINE10_ID
       , Nvl2(RCO_MACHINE_BOOLEAN1, case
                when(RCO_MACHINE_BOOLEAN1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN1
       , Nvl2(RCO_MACHINE_BOOLEAN2, case
                when(RCO_MACHINE_BOOLEAN2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN2
       , Nvl2(RCO_MACHINE_BOOLEAN3, case
                when(RCO_MACHINE_BOOLEAN3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN3
       , Nvl2(RCO_MACHINE_BOOLEAN4, case
                when(RCO_MACHINE_BOOLEAN4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN4
       , Nvl2(RCO_MACHINE_BOOLEAN5, case
                when(RCO_MACHINE_BOOLEAN5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN5
       , Nvl2(RCO_MACHINE_BOOLEAN6, case
                when(RCO_MACHINE_BOOLEAN6 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN6
       , Nvl2(RCO_MACHINE_BOOLEAN7, case
                when(RCO_MACHINE_BOOLEAN7 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN7
       , Nvl2(RCO_MACHINE_BOOLEAN8, case
                when(RCO_MACHINE_BOOLEAN8 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN8
       , Nvl2(RCO_MACHINE_BOOLEAN9, case
                when(RCO_MACHINE_BOOLEAN9 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN9
       , Nvl2(RCO_MACHINE_BOOLEAN10, case
                when(RCO_MACHINE_BOOLEAN10 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCO_MACHINE_BOOLEAN10
       , Nvl(RCO_MACHINE_ALPHA_SHORT1, '_') RCO_MACHINE_ALPHA_SHORT1
       , Nvl(RCO_MACHINE_ALPHA_SHORT2, '_') RCO_MACHINE_ALPHA_SHORT2
       , Nvl(RCO_MACHINE_ALPHA_SHORT3, '_') RCO_MACHINE_ALPHA_SHORT3
       , Nvl(RCO_MACHINE_ALPHA_SHORT4, '_') RCO_MACHINE_ALPHA_SHORT4
       , Nvl(RCO_MACHINE_ALPHA_SHORT5, '_') RCO_MACHINE_ALPHA_SHORT5
       , Nvl(RCO_MACHINE_ALPHA_SHORT6, '_') RCO_MACHINE_ALPHA_SHORT6
       , Nvl(RCO_MACHINE_ALPHA_SHORT7, '_') RCO_MACHINE_ALPHA_SHORT7
       , Nvl(RCO_MACHINE_ALPHA_SHORT8, '_') RCO_MACHINE_ALPHA_SHORT8
       , Nvl(RCO_MACHINE_ALPHA_SHORT9, '_') RCO_MACHINE_ALPHA_SHORT9
       , Nvl(RCO_MACHINE_ALPHA_SHORT10, '_') RCO_MACHINE_ALPHA_SHORT10
       , Nvl(RCO_MACHINE_ALPHA_LONG1, '_') RCO_MACHINE_ALPHA_LONG1
       , Nvl(RCO_MACHINE_ALPHA_LONG2, '_') RCO_MACHINE_ALPHA_LONG2
       , Nvl(RCO_MACHINE_ALPHA_LONG3, '_') RCO_MACHINE_ALPHA_LONG3
       , Nvl(RCO_MACHINE_ALPHA_LONG4, '_') RCO_MACHINE_ALPHA_LONG4
       , Nvl(RCO_MACHINE_ALPHA_LONG5, '_') RCO_MACHINE_ALPHA_LONG5
       , Nvl(RCO_MACHINE_ALPHA_LONG6, '_') RCO_MACHINE_ALPHA_LONG6
       , Nvl(RCO_MACHINE_ALPHA_LONG7, '_') RCO_MACHINE_ALPHA_LONG7
       , Nvl(RCO_MACHINE_ALPHA_LONG8, '_') RCO_MACHINE_ALPHA_LONG8
       , Nvl(RCO_MACHINE_ALPHA_LONG9, '_') RCO_MACHINE_ALPHA_LONG9
       , Nvl(RCO_MACHINE_ALPHA_LONG10, '_') RCO_MACHINE_ALPHA_LONG10
       , Nvl(RCO_MACHINE_DATE1, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE1
       , Nvl(RCO_MACHINE_DATE2, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE2
       , Nvl(RCO_MACHINE_DATE3, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE3
       , Nvl(RCO_MACHINE_DATE4, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE4
       , Nvl(RCO_MACHINE_DATE5, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE5
       , Nvl(RCO_MACHINE_DATE6, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE6
       , Nvl(RCO_MACHINE_DATE7, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE7
       , Nvl(RCO_MACHINE_DATE8, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE8
       , Nvl(RCO_MACHINE_DATE9, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE9
       , Nvl(RCO_MACHINE_DATE10, to_date('40000101', 'YYYYMMDD') ) RCO_MACHINE_DATE10
       , RCO_MACHINE_DECIMAL1
       , RCO_MACHINE_DECIMAL2
       , RCO_MACHINE_DECIMAL3
       , RCO_MACHINE_DECIMAL4
       , RCO_MACHINE_DECIMAL5
       , RCO_MACHINE_DECIMAL6
       , RCO_MACHINE_DECIMAL7
       , RCO_MACHINE_DECIMAL8
       , RCO_MACHINE_DECIMAL9
       , RCO_MACHINE_DECIMAL10
       , Nvl(GAL_TASK_LINK_ID, -2) GAL_TASK_LINK_ID
       , Nvl(C_RCO_ORIGIN, 'DWH_ISNULL') C_RCO_ORIGIN
       , Nvl(DOC_PROJECT_DOCUMENT_ID, -2) DOC_PROJECT_DOCUMENT_ID
       , Nvl(PPS_NOMENCLATURE_ID, -2) PPS_NOMENCLATURE_ID
       , Nvl(DOC_RECORD_GAL_ID, -2) DOC_RECORD_GAL_ID
  from DOC_RECORD
  union all
  select -1 DOC_RECORD_ID
       , -1 PAC_THIRD_ID
       , 'DWH_NA' DIC_ACCOUNTABLE_GROUP_ID
       , 'N/A' RCO_TITLE
       , 'N/A' RCO_DESCRIPTION
       , 'DWH_NA' DIC_RECORD1_ID
       , 'DWH_NA' DIC_RECORD2_ID
       , 'DWH_NA' DIC_RECORD3_ID
       , 'DWH_NA' DIC_RECORD4_ID
       , 'DWH_NA' DIC_RECORD5_ID
       , 'DWH_NA' DIC_RECORD6_ID
       , 'DWH_NA' DIC_RECORD7_ID
       , 'DWH_NA' DIC_RECORD8_ID
       , 'DWH_NA' DIC_RECORD9_ID
       , 'DWH_NA' DIC_RECORD10_ID
       , '-1' RCO_BOOLEAN1
       , '-1' RCO_BOOLEAN2
       , '-1' RCO_BOOLEAN3
       , '-1' RCO_BOOLEAN4
       , '-1' RCO_BOOLEAN5
       , '-1' RCO_BOOLEAN6
       , '-1' RCO_BOOLEAN7
       , '-1' RCO_BOOLEAN8
       , '-1' RCO_BOOLEAN9
       , '-1' RCO_BOOLEAN10
       , 'N/A' RCO_ALPHA_SHORT1
       , 'N/A' RCO_ALPHA_SHORT2
       , 'N/A' RCO_ALPHA_SHORT3
       , 'N/A' RCO_ALPHA_SHORT4
       , 'N/A' RCO_ALPHA_SHORT5
       , 'N/A' RCO_ALPHA_SHORT6
       , 'N/A' RCO_ALPHA_SHORT7
       , 'N/A' RCO_ALPHA_SHORT8
       , 'N/A' RCO_ALPHA_SHORT9
       , 'N/A' RCO_ALPHA_SHORT10
       , 'N/A' RCO_ALPHA_LONG1
       , 'N/A' RCO_ALPHA_LONG2
       , 'N/A' RCO_ALPHA_LONG3
       , 'N/A' RCO_ALPHA_LONG4
       , 'N/A' RCO_ALPHA_LONG5
       , 'N/A' RCO_ALPHA_LONG6
       , 'N/A' RCO_ALPHA_LONG7
       , 'N/A' RCO_ALPHA_LONG8
       , 'N/A' RCO_ALPHA_LONG9
       , 'N/A' RCO_ALPHA_LONG10
       , to_date('00010101', 'YYYYMMDD') RCO_DATE1
       , to_date('00010101', 'YYYYMMDD') RCO_DATE2
       , to_date('00010101', 'YYYYMMDD') RCO_DATE3
       , to_date('00010101', 'YYYYMMDD') RCO_DATE4
       , to_date('00010101', 'YYYYMMDD') RCO_DATE5
       , to_date('00010101', 'YYYYMMDD') RCO_DATE6
       , to_date('00010101', 'YYYYMMDD') RCO_DATE7
       , to_date('00010101', 'YYYYMMDD') RCO_DATE8
       , to_date('00010101', 'YYYYMMDD') RCO_DATE9
       , to_date('00010101', 'YYYYMMDD') RCO_DATE10
       , null RCO_DECIMAL1
       , null RCO_DECIMAL2
       , null RCO_DECIMAL3
       , null RCO_DECIMAL4
       , null RCO_DECIMAL5
       , null RCO_DECIMAL6
       , null RCO_DECIMAL7
       , null RCO_DECIMAL8
       , null RCO_DECIMAL9
       , null RCO_DECIMAL10
       , null RCO_NUMBER
       , 'DWH_NA' DIC_PERSON_POLITNESS_ID
       , -1 PC_LANG_ID
       , -1 PC_CNTRY_ID
       , -1 PAC_REPRESENTATIVE_ID
       , 'N/A' RCO_NAME
       , 'N/A' RCO_FORENAME
       , 'N/A' RCO_ACTIVITY
       , 'N/A' RCO_ZIPCODE
       , 'N/A' RCO_CITY
       , 'N/A' RCO_PHONE
       , 'N/A' RCO_FAX
       , 'N/A' RCO_ADD_FORMAT
       , 'N/A' RCO_STATE
       , 'N/A' RCO_ADDRESS
       , 'N/A' RCO_AGREEMENT_NUMBER
       , -1 GAL_TASK_ID
       , -1 GAL_PROJECT_ID
       , 'DWH_NA' C_RCO_STATUS
       , 'DWH_NA' C_RCO_TYPE
       , -1 DOC_RECORD_CATEGORY_ID
       , -1 GAL_BUDGET_ID
       , -1 RCO_MACHINE_GOOD_ID
       , -1 STM_ELEMENT_NUMBER_ID
       , to_date('00010101', 'YYYYMMDD') RCO_SUPPLIER_WARRANTY_END
       , 'N/A' RCO_MACHINE_LONG_DESCR
       , 'N/A' RCO_MACHINE_FREE_DESCR
       , 'N/A' RCO_MACHINE_REMARK
       , 'N/A' RCO_MACHINE_COMMENT
       , 'N/A' RCO_SUPPLIER_SERIAL_NUMBER
       , null RCO_SALE_PRICE
       , null RCO_COST_PRICE
       , null RCO_ESTIMATE_PRICE
       , 'DWH_NA' C_ASA_MACHINE_STATE
       , -1 PC_USER_ID
       , to_date('00010101', 'YYYYMMDD') RCO_STARTING_DATE
       , to_date('00010101', 'YYYYMMDD') RCO_ENDING_DATE
       -- RCO_XML_CONDITIONS cannot be used with CLOB
       , 'N/A' RCO_DIC_ASSOCIATION_TYPE
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 DOC_PURCHASE_POSITION_ID
       , 'DWH_NA' C_ASA_GUARANTY_UNIT
       , -1 RCO_WARRANTY_PC_APPLTXT_ID
       , to_date('00010101', 'YYYYMMDD') RCO_SUPPLIER_WARRANTY_START
       , null RCO_SUPPLIER_WARRANTY_TERM
       , 'N/A' RCO_WARRANTY_TEXT
       , 'DWH_NA' DIC_RCO_MACHINE1_ID
       , 'DWH_NA' DIC_RCO_MACHINE2_ID
       , 'DWH_NA' DIC_RCO_MACHINE3_ID
       , 'DWH_NA' DIC_RCO_MACHINE4_ID
       , 'DWH_NA' DIC_RCO_MACHINE5_ID
       , 'DWH_NA' DIC_RCO_MACHINE6_ID
       , 'DWH_NA' DIC_RCO_MACHINE7_ID
       , 'DWH_NA' DIC_RCO_MACHINE8_ID
       , 'DWH_NA' DIC_RCO_MACHINE9_ID
       , 'DWH_NA' DIC_RCO_MACHINE10_ID
       , '-1' RCO_MACHINE_BOOLEAN1
       , '-1' RCO_MACHINE_BOOLEAN2
       , '-1' RCO_MACHINE_BOOLEAN3
       , '-1' RCO_MACHINE_BOOLEAN4
       , '-1' RCO_MACHINE_BOOLEAN5
       , '-1' RCO_MACHINE_BOOLEAN6
       , '-1' RCO_MACHINE_BOOLEAN7
       , '-1' RCO_MACHINE_BOOLEAN8
       , '-1' RCO_MACHINE_BOOLEAN9
       , '-1' RCO_MACHINE_BOOLEAN10
       , 'N/A' RCO_MACHINE_ALPHA_SHORT1
       , 'N/A' RCO_MACHINE_ALPHA_SHORT2
       , 'N/A' RCO_MACHINE_ALPHA_SHORT3
       , 'N/A' RCO_MACHINE_ALPHA_SHORT4
       , 'N/A' RCO_MACHINE_ALPHA_SHORT5
       , 'N/A' RCO_MACHINE_ALPHA_SHORT6
       , 'N/A' RCO_MACHINE_ALPHA_SHORT7
       , 'N/A' RCO_MACHINE_ALPHA_SHORT8
       , 'N/A' RCO_MACHINE_ALPHA_SHORT9
       , 'N/A' RCO_MACHINE_ALPHA_SHORT10
       , 'N/A' RCO_MACHINE_ALPHA_LONG1
       , 'N/A' RCO_MACHINE_ALPHA_LONG2
       , 'N/A' RCO_MACHINE_ALPHA_LONG3
       , 'N/A' RCO_MACHINE_ALPHA_LONG4
       , 'N/A' RCO_MACHINE_ALPHA_LONG5
       , 'N/A' RCO_MACHINE_ALPHA_LONG6
       , 'N/A' RCO_MACHINE_ALPHA_LONG7
       , 'N/A' RCO_MACHINE_ALPHA_LONG8
       , 'N/A' RCO_MACHINE_ALPHA_LONG9
       , 'N/A' RCO_MACHINE_ALPHA_LONG10
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE1
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE2
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE3
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE4
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE5
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE6
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE7
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE8
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE9
       , to_date('00010101', 'YYYYMMDD') RCO_MACHINE_DATE10
       , null RCO_MACHINE_DECIMAL1
       , null RCO_MACHINE_DECIMAL2
       , null RCO_MACHINE_DECIMAL3
       , null RCO_MACHINE_DECIMAL4
       , null RCO_MACHINE_DECIMAL5
       , null RCO_MACHINE_DECIMAL6
       , null RCO_MACHINE_DECIMAL7
       , null RCO_MACHINE_DECIMAL8
       , null RCO_MACHINE_DECIMAL9
       , null RCO_MACHINE_DECIMAL10
       , -1 GAL_TASK_LINK_ID
       , 'DWH_NA' C_RCO_ORIGIN
       , -1 DOC_PROJECT_DOCUMENT_ID
       , -1 PPS_NOMENCLATURE_ID
       , -1 DOC_RECORD_GAL_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_DOC_RECORD_CATEGORY" ("DOC_RECORD_CATEGORY_ID", "C_RCO_STATUS", "C_RCO_TYPE", "GCO_GOOD_NUMBERING_ID", "RCY_DESCR", "RCY_KEY", "RCY_MANUAL_MODIF") AS
  select DOC_RECORD_CATEGORY_ID
       , Nvl(C_RCO_STATUS, 'DWH_ISNULL') C_RCO_STATUS
       , Nvl(C_RCO_TYPE, 'DWH_ISNULL') C_RCO_TYPE
       , Nvl(GCO_GOOD_NUMBERING_ID, -2) GCO_GOOD_NUMBERING_ID
       , Nvl(RCY_DESCR, '_') RCY_DESCR
       , Nvl(RCY_KEY, '_') RCY_KEY
       , Nvl2(RCY_MANUAL_MODIF, case
                when(RCY_MANUAL_MODIF = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') RCY_MANUAL_MODIF
  from DOC_RECORD_CATEGORY
  union all
  select -1 DOC_RECORD_CATEGORY_ID
       , 'DWH_NA' C_RCO_STATUS
       , 'DWH_NA' C_RCO_TYPE
       , -1 GCO_GOOD_NUMBERING_ID
       , 'N/A' RCY_DESCR
       , 'N/A' RCY_KEY
       , '-1' RCY_MANUAL_MODIF
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_FAL_FACTORY_FLOOR" ("FAL_FACTORY_FLOOR_ID", "DIC_FLOOR_FREE_CODE_ID", "DIC_FLOOR_FREE_CODE2_ID", "PAC_CALENDAR_TYPE_ID", "FAC_REFERENCE", "FAC_DESCRIBE", "FAC_RESOURCE_NUMBER", "C_TEAM", "FAC_PIC", "FAL_FAL_FACTORY_FLOOR_ID", "FAC_IS_MACHINE", "FAC_INFINITE_FLOOR", "DIC_FLOOR_FREE_CODE3_ID", "DIC_FLOOR_FREE_CODE4_ID", "DIC_FLOOR_FREE_CODE5_ID", "DIC_FLOOR_FREE_CODE6_ID", "DIC_FLOOR_FREE_CODE7_ID", "DIC_FLOOR_FREE_CODE8_ID", "DIC_FLOOR_FREE_CODE9_ID", "DIC_FLOOR_FREE_CODE10_ID", "FAC_ALPHA01", "FAC_ALPHA02", "FAC_ALPHA03", "FAC_ALPHA04", "FAC_ALPHA05", "FAC_ALPHA06", "FAC_ALPHA07", "FAC_ALPHA08", "FAC_ALPHA09", "FAC_ALPHA10", "FAC_UPDATE_LMU", "FAC_OUT_OF_ORDER", "FAC_IS_OPERATOR", "FAC_PIECES_DAY_CAP", "FAC_PIECES_HOUR_CAP", "ACS_CDA_ACCOUNT_ID", "HRM_PERSON_ID", "GAL_COST_CENTER_ID", "PAC_SCHEDULE_ID", "FAC_IS_PERSON", "FAC_IS_BLOCK", "FAL_GRP_FACTORY_FLOOR_ID", "FAM_FIXED_ASSETS_ID") AS
  select FAL_FACTORY_FLOOR_ID
       , nvl(DIC_FLOOR_FREE_CODE_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE_ID
       , nvl(DIC_FLOOR_FREE_CODE2_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE2_ID
       , nvl(PAC_CALENDAR_TYPE_ID, -2) PAC_CALENDAR_TYPE_ID
       , nvl(FAC_REFERENCE, '_') FAC_REFERENCE
       , nvl(FAC_DESCRIBE, '_') FAC_DESCRIBE
       , FAC_RESOURCE_NUMBER
       , nvl(C_TEAM, 'DWH_ISNULL') C_TEAM
       , nvl2(FAC_PIC, case
                when(FAC_PIC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_PIC
       , nvl(FAL_FAL_FACTORY_FLOOR_ID, -2) FAL_FAL_FACTORY_FLOOR_ID
       , nvl2(FAC_IS_MACHINE, case
                when(FAC_IS_MACHINE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_IS_MACHINE
       , nvl2(FAC_INFINITE_FLOOR, case
                when(FAC_INFINITE_FLOOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_INFINITE_FLOOR
       , nvl(DIC_FLOOR_FREE_CODE3_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE3_ID
       , nvl(DIC_FLOOR_FREE_CODE4_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE4_ID
       , nvl(DIC_FLOOR_FREE_CODE5_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE5_ID
       , nvl(DIC_FLOOR_FREE_CODE6_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE6_ID
       , nvl(DIC_FLOOR_FREE_CODE7_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE7_ID
       , nvl(DIC_FLOOR_FREE_CODE8_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE8_ID
       , nvl(DIC_FLOOR_FREE_CODE9_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE9_ID
       , nvl(DIC_FLOOR_FREE_CODE10_ID, 'DWH_ISNULL') DIC_FLOOR_FREE_CODE10_ID
       , nvl(FAC_ALPHA01, '_') FAC_ALPHA01
       , nvl(FAC_ALPHA02, '_') FAC_ALPHA02
       , nvl(FAC_ALPHA03, '_') FAC_ALPHA03
       , nvl(FAC_ALPHA04, '_') FAC_ALPHA04
       , nvl(FAC_ALPHA05, '_') FAC_ALPHA05
       , nvl(FAC_ALPHA06, '_') FAC_ALPHA06
       , nvl(FAC_ALPHA07, '_') FAC_ALPHA07
       , nvl(FAC_ALPHA08, '_') FAC_ALPHA08
       , nvl(FAC_ALPHA09, '_') FAC_ALPHA09
       , nvl(FAC_ALPHA10, '_') FAC_ALPHA10
       , nvl2(FAC_UPDATE_LMU, case
                when(FAC_UPDATE_LMU = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_UPDATE_LMU
       , nvl2(FAC_OUT_OF_ORDER, case
                when(FAC_OUT_OF_ORDER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_OUT_OF_ORDER
       , nvl2(FAC_IS_OPERATOR, case
                when(FAC_IS_OPERATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_IS_OPERATOR
       , FAC_PIECES_DAY_CAP
       , FAC_PIECES_HOUR_CAP
       , nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , nvl(GAL_COST_CENTER_ID, -2) GAL_COST_CENTER_ID
       , nvl(PAC_SCHEDULE_ID, -2) PAC_SCHEDULE_ID
       , nvl2(FAC_IS_PERSON, case
                when(FAC_IS_PERSON = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_IS_PERSON
       , nvl2(FAC_IS_BLOCK, case
                when(FAC_IS_BLOCK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') FAC_IS_BLOCK
       , nvl(FAL_GRP_FACTORY_FLOOR_ID, -2) FAL_GRP_FACTORY_FLOOR_ID
       , nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
    from FAL_FACTORY_FLOOR
  union all
  select -1 FAL_FACTORY_FLOOR_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE2_ID
       , -1 PAC_CALENDAR_TYPE_ID
       , 'N/A' FAC_REFERENCE
       , 'N/A' FAC_DESCRIBE
       , null FAC_RESOURCE_NUMBER
       , 'DWH_NA' C_TEAM
       , '-1' FAC_PIC
       , -1 FAL_FAL_FACTORY_FLOOR_ID
       , '-1' FAC_IS_MACHINE
       , '-1' FAC_INFINITE_FLOOR
       , 'DWH_NA' DIC_FLOOR_FREE_CODE3_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE4_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE5_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE6_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE7_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE8_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE9_ID
       , 'DWH_NA' DIC_FLOOR_FREE_CODE10_ID
       , 'N/A' FAC_ALPHA01
       , 'N/A' FAC_ALPHA02
       , 'N/A' FAC_ALPHA03
       , 'N/A' FAC_ALPHA04
       , 'N/A' FAC_ALPHA05
       , 'N/A' FAC_ALPHA06
       , 'N/A' FAC_ALPHA07
       , 'N/A' FAC_ALPHA08
       , 'N/A' FAC_ALPHA09
       , 'N/A' FAC_ALPHA10
       , '-1' FAC_UPDATE_LMU
       , '-1' FAC_OUT_OF_ORDER
       , '-1' FAC_IS_OPERATOR
       , null FAC_PIECES_DAY_CAP
       , null FAC_PIECES_HOUR_CAP
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 HRM_PERSON_ID
       , -1 GAL_COST_CENTER_ID
       , -1 PAC_SCHEDULE_ID
       , '-1' FAC_IS_PERSON
       , '-1' FAC_IS_BLOCK
       , -1 FAL_GRP_FACTORY_FLOOR_ID
       , -1 FAM_FIXED_ASSETS_ID
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_FAL_JOB_PROGRAM" ("FAL_JOB_PROGRAM_ID", "DIC_PROG_FREE_CODE_ID", "DIC_FAMILY_ID", "DOC_DOCUMENT_ID", "JOP_REFERENCE", "JOP_SHORT_DESCR", "JOP_LONG_DESCR", "JOP_FREE_DESCR", "JOP_LARGEST_END_DATE", "JOP_FREE_NUM", "JOP_FREE_NUM2", "DOC_RECORD_ID", "PC_YEAR_WEEK_ID", "PAC_CUSTOM_PARTNER_ID", "C_PRIORITY", "PAC_SUPPLIER_PARTNER_ID", "C_FAB_TYPE") AS
  select FAL_JOB_PROGRAM_ID
       , Nvl(DIC_PROG_FREE_CODE_ID, 'DWH_ISNULL') DIC_PROG_FREE_CODE_ID
       , Nvl(DIC_FAMILY_ID, 'DWH_ISNULL') DIC_FAMILY_ID
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , JOP_REFERENCE
       , Nvl(JOP_SHORT_DESCR, '_') JOP_SHORT_DESCR
       , Nvl(JOP_LONG_DESCR, '_') JOP_LONG_DESCR
       , Nvl(JOP_FREE_DESCR, '_') JOP_FREE_DESCR
       , Nvl(JOP_LARGEST_END_DATE, to_date('40000101', 'YYYYMMDD') ) JOP_LARGEST_END_DATE
       , JOP_FREE_NUM
       , JOP_FREE_NUM2
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(PC_YEAR_WEEK_ID, -2) PC_YEAR_WEEK_ID
       , Nvl(PAC_CUSTOM_PARTNER_ID, -2) PAC_CUSTOM_PARTNER_ID
       , Nvl(C_PRIORITY, 'DWH_ISNULL') C_PRIORITY
       , Nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , Nvl(C_FAB_TYPE, 'DWH_ISNULL') C_FAB_TYPE
  from FAL_JOB_PROGRAM
  union all
  select -1 FAL_JOB_PROGRAM_ID
       , 'DWH_NA' DIC_PROG_FREE_CODE_ID
       , 'DWH_NA' DIC_FAMILY_ID
       , -1 DOC_DOCUMENT_ID
       , null JOP_REFERENCE
       , 'N/A' JOP_SHORT_DESCR
       , 'N/A' JOP_LONG_DESCR
       , 'N/A' JOP_FREE_DESCR
       , to_date('00010101', 'YYYYMMDD') JOP_LARGEST_END_DATE
       , null JOP_FREE_NUM
       , null JOP_FREE_NUM2
       , -1 DOC_RECORD_ID
       , -1 PC_YEAR_WEEK_ID
       , -1 PAC_CUSTOM_PARTNER_ID
       , 'DWH_NA' C_PRIORITY
       , -1 PAC_SUPPLIER_PARTNER_ID
       , 'DWH_NA' C_FAB_TYPE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_FAL_LOT" ("FAL_LOT_ID", "DIC_FAMILY_ID", "DIC_LOT_CODE2_ID", "DIC_LOT_CODE3_ID", "FAL_ORDER_ID", "C_LOT_STATUS", "GCO_GOOD_ID", "LOT_REF", "LOT_FUSION_REF", "LOT_ORIGIN_REF", "LOT_SHORT_DESCR", "LOT_LONG_DESCR", "LOT_FREE_DESCR", "LOT_TO_BE_RELEASED", "LOT_ASKED_QTY", "LOT_REJECT_PLAN_QTY", "LOT_TOTAL_QTY", "LOT_PT_REJECT_QTY", "LOT_CPT_REJECT_QTY", "LOT_RELEASED_QTY", "LOT_REJECT_RELEASED_QTY", "LOT_DISMOUNTED_QTY", "LOT_INPROD_QTY", "LOT_MAX_PROD_QTY", "LOT_MAX_RELEASABLE_QTY", "LOT_FREE_QTY", "LOT_ALLOCATED_QTY", "LOT_PLAN_BEGIN_DTE", "LOT_PLAN_END_DTE", "LOT_OPEN__DTE", "LOT_FULL_REL_DTE", "LOT_PLAN_LEAD_TIME", "LOT_TOLERANCE", "LOT_VERSION_ORIGIN_NUM", "LOT_PLAN_NUMBER", "LOT_SECOND_REF", "LOT_PSHORT_DESCR", "LOT_PTEXT", "LOT_PFREE_TEXT", "LOT_FREE_NUM1", "LOT_FREE_NUM2", "C_SCHEDULE_PLANNING", "LOT_RELEASE_QTY", "LOT_PLAN_VERSION", "FAL_SCHEDULE_PLAN_ID", "PC_YEAR_WEEK_ID", "PC__PC_YEAR_WEEK_ID", "PC_2_PC_YEAR_WEEK_ID", "PC_3_PC_YEAR_WEEK_ID", "STM_LOCATION_ID", "STM_STM_LOCATION_ID", "PPS_OPERATION_PROCEDURE_ID", "DOC_RECORD_ID", "STM_STOCK_ID", "STM_STM_STOCK_ID", "LOT_REFCOMPL", "LOT_MODIFY", "C_PRIORITY", "DIC_FAB_CONDITION_ID", "PPS_NOMENCLATURE_ID", "GCO_QUALITY_PRINCIPLE_ID", "FAL_FAL_SCHEDULE_PLAN_ID", "C_FAB_TYPE", "FAL_JOB_PROGRAM_ID", "LOT_REF_QTY", "LOT_ORT_MARKERS", "LOT_BASIS_BEGIN_DTE", "LOT_BASIS_END_DTE", "LOT_BASIS_LEAD_TIME", "LOT_REAL_LEAD_TIME", "LOT_ORT_UPDATE_DELAY", "LOT_UPDATED_COMPONENTS", "C_LOT_RECEPT_ERROR", "PTC_FIXED_COSTPRICE_ID", "LOT_IS_POSTCALCULATED") AS
  select FAL_LOT_ID
       , Nvl(DIC_FAMILY_ID, 'DWH_ISNULL') DIC_FAMILY_ID
       , Nvl(DIC_LOT_CODE2_ID, 'DWH_ISNULL') DIC_LOT_CODE2_ID
       , Nvl(DIC_LOT_CODE3_ID, 'DWH_ISNULL') DIC_LOT_CODE3_ID
       , Nvl(FAL_ORDER_ID, -2) FAL_ORDER_ID
       , Nvl(C_LOT_STATUS, 'DWH_ISNULL') C_LOT_STATUS
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , LOT_REF
       , LOT_FUSION_REF
       , LOT_ORIGIN_REF
       , Nvl(LOT_SHORT_DESCR, '_') LOT_SHORT_DESCR
       , Nvl(LOT_LONG_DESCR, '_') LOT_LONG_DESCR
       , Nvl(LOT_FREE_DESCR, '_') LOT_FREE_DESCR
       , Nvl2(LOT_TO_BE_RELEASED, case
                when(LOT_TO_BE_RELEASED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOT_TO_BE_RELEASED
       , LOT_ASKED_QTY
       , LOT_REJECT_PLAN_QTY
       , LOT_TOTAL_QTY
       , LOT_PT_REJECT_QTY
       , LOT_CPT_REJECT_QTY
       , LOT_RELEASED_QTY
       , LOT_REJECT_RELEASED_QTY
       , LOT_DISMOUNTED_QTY
       , LOT_INPROD_QTY
       , LOT_MAX_PROD_QTY
       , LOT_MAX_RELEASABLE_QTY
       , LOT_FREE_QTY
       , LOT_ALLOCATED_QTY
       , Nvl(LOT_PLAN_BEGIN_DTE, to_date('40000101', 'YYYYMMDD') ) LOT_PLAN_BEGIN_DTE
       , Nvl(LOT_PLAN_END_DTE, to_date('40000101', 'YYYYMMDD') ) LOT_PLAN_END_DTE
       , Nvl(LOT_OPEN__DTE, to_date('40000101', 'YYYYMMDD') ) LOT_OPEN__DTE
       , Nvl(LOT_FULL_REL_DTE, to_date('40000101', 'YYYYMMDD') ) LOT_FULL_REL_DTE
       , LOT_PLAN_LEAD_TIME
       , LOT_TOLERANCE
       , Nvl(LOT_VERSION_ORIGIN_NUM, '_') LOT_VERSION_ORIGIN_NUM
       , Nvl(LOT_PLAN_NUMBER, '_') LOT_PLAN_NUMBER
       , Nvl(LOT_SECOND_REF, '_') LOT_SECOND_REF
       , Nvl(LOT_PSHORT_DESCR, '_') LOT_PSHORT_DESCR
       , Nvl(LOT_PTEXT, '_') LOT_PTEXT
       , Nvl(LOT_PFREE_TEXT, '_') LOT_PFREE_TEXT
       , LOT_FREE_NUM1
       , LOT_FREE_NUM2
       , Nvl(C_SCHEDULE_PLANNING, 'DWH_ISNULL') C_SCHEDULE_PLANNING
       , LOT_RELEASE_QTY
       , Nvl(LOT_PLAN_VERSION, '_') LOT_PLAN_VERSION
       , Nvl(FAL_SCHEDULE_PLAN_ID, -2) FAL_SCHEDULE_PLAN_ID
       , Nvl(PC_YEAR_WEEK_ID, -2) PC_YEAR_WEEK_ID
       , Nvl(PC__PC_YEAR_WEEK_ID, -2) PC__PC_YEAR_WEEK_ID
       , Nvl(PC_2_PC_YEAR_WEEK_ID, -2) PC_2_PC_YEAR_WEEK_ID
       , Nvl(PC_3_PC_YEAR_WEEK_ID, -2) PC_3_PC_YEAR_WEEK_ID
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl(STM_STM_LOCATION_ID, -2) STM_STM_LOCATION_ID
       , Nvl(PPS_OPERATION_PROCEDURE_ID, -2) PPS_OPERATION_PROCEDURE_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(STM_STM_STOCK_ID, -2) STM_STM_STOCK_ID
       , Nvl(LOT_REFCOMPL, '_') LOT_REFCOMPL
       , Nvl2(LOT_MODIFY, case
                when(LOT_MODIFY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOT_MODIFY
       , Nvl(C_PRIORITY, 'DWH_ISNULL') C_PRIORITY
       , Nvl(DIC_FAB_CONDITION_ID, 'DWH_ISNULL') DIC_FAB_CONDITION_ID
       , Nvl(PPS_NOMENCLATURE_ID, -2) PPS_NOMENCLATURE_ID
       , Nvl(GCO_QUALITY_PRINCIPLE_ID, -2) GCO_QUALITY_PRINCIPLE_ID
       , Nvl(FAL_FAL_SCHEDULE_PLAN_ID, -2) FAL_FAL_SCHEDULE_PLAN_ID
       , Nvl(C_FAB_TYPE, 'DWH_ISNULL') C_FAB_TYPE
       , Nvl(FAL_JOB_PROGRAM_ID, -2) FAL_JOB_PROGRAM_ID
       , LOT_REF_QTY
       , Nvl(LOT_ORT_MARKERS, '_') LOT_ORT_MARKERS
       , Nvl(LOT_BASIS_BEGIN_DTE, to_date('40000101', 'YYYYMMDD') ) LOT_BASIS_BEGIN_DTE
       , Nvl(LOT_BASIS_END_DTE, to_date('40000101', 'YYYYMMDD') ) LOT_BASIS_END_DTE
       , LOT_BASIS_LEAD_TIME
       , LOT_REAL_LEAD_TIME
       , Nvl2(LOT_ORT_UPDATE_DELAY, case
                when(LOT_ORT_UPDATE_DELAY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOT_ORT_UPDATE_DELAY
       , Nvl2(LOT_UPDATED_COMPONENTS, case
                when(LOT_UPDATED_COMPONENTS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOT_UPDATED_COMPONENTS
       , Nvl(C_LOT_RECEPT_ERROR, 'DWH_ISNULL') C_LOT_RECEPT_ERROR
       , Nvl(PTC_FIXED_COSTPRICE_ID, -2) PTC_FIXED_COSTPRICE_ID
       , Nvl2(LOT_IS_POSTCALCULATED, case
                when(LOT_IS_POSTCALCULATED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOT_IS_POSTCALCULATED
  from FAL_LOT
  union all
  select -1 FAL_LOT_ID
       , 'DWH_NA' DIC_FAMILY_ID
       , 'DWH_NA' DIC_LOT_CODE2_ID
       , 'DWH_NA' DIC_LOT_CODE3_ID
       , -1 FAL_ORDER_ID
       , 'DWH_NA' C_LOT_STATUS
       , -1 GCO_GOOD_ID
       , null LOT_REF
       , null LOT_FUSION_REF
       , null LOT_ORIGIN_REF
       , 'N/A' LOT_SHORT_DESCR
       , 'N/A' LOT_LONG_DESCR
       , 'N/A' LOT_FREE_DESCR
       , '-1' LOT_TO_BE_RELEASED
       , null LOT_ASKED_QTY
       , null LOT_REJECT_PLAN_QTY
       , null LOT_TOTAL_QTY
       , null LOT_PT_REJECT_QTY
       , null LOT_CPT_REJECT_QTY
       , null LOT_RELEASED_QTY
       , null LOT_REJECT_RELEASED_QTY
       , null LOT_DISMOUNTED_QTY
       , null LOT_INPROD_QTY
       , null LOT_MAX_PROD_QTY
       , null LOT_MAX_RELEASABLE_QTY
       , null LOT_FREE_QTY
       , null LOT_ALLOCATED_QTY
       , to_date('00010101', 'YYYYMMDD') LOT_PLAN_BEGIN_DTE
       , to_date('00010101', 'YYYYMMDD') LOT_PLAN_END_DTE
       , to_date('00010101', 'YYYYMMDD') LOT_OPEN__DTE
       , to_date('00010101', 'YYYYMMDD') LOT_FULL_REL_DTE
       , null LOT_PLAN_LEAD_TIME
       , null LOT_TOLERANCE
       , 'N/A' LOT_VERSION_ORIGIN_NUM
       , 'N/A' LOT_PLAN_NUMBER
       , 'N/A' LOT_SECOND_REF
       , 'N/A' LOT_PSHORT_DESCR
       , 'N/A' LOT_PTEXT
       , 'N/A' LOT_PFREE_TEXT
       , null LOT_FREE_NUM1
       , null LOT_FREE_NUM2
       , 'DWH_NA' C_SCHEDULE_PLANNING
       , null LOT_RELEASE_QTY
       , 'N/A' LOT_PLAN_VERSION
       , -1 FAL_SCHEDULE_PLAN_ID
       , -1 PC_YEAR_WEEK_ID
       , -1 PC__PC_YEAR_WEEK_ID
       , -1 PC_2_PC_YEAR_WEEK_ID
       , -1 PC_3_PC_YEAR_WEEK_ID
       , -1 STM_LOCATION_ID
       , -1 STM_STM_LOCATION_ID
       , -1 PPS_OPERATION_PROCEDURE_ID
       , -1 DOC_RECORD_ID
       , -1 STM_STOCK_ID
       , -1 STM_STM_STOCK_ID
       , 'N/A' LOT_REFCOMPL
       , '-1' LOT_MODIFY
       , 'DWH_NA' C_PRIORITY
       , 'DWH_NA' DIC_FAB_CONDITION_ID
       , -1 PPS_NOMENCLATURE_ID
       , -1 GCO_QUALITY_PRINCIPLE_ID
       , -1 FAL_FAL_SCHEDULE_PLAN_ID
       , 'DWH_NA' C_FAB_TYPE
       , -1 FAL_JOB_PROGRAM_ID
       , null LOT_REF_QTY
       , 'N/A' LOT_ORT_MARKERS
       , to_date('00010101', 'YYYYMMDD') LOT_BASIS_BEGIN_DTE
       , to_date('00010101', 'YYYYMMDD') LOT_BASIS_END_DTE
       , null LOT_BASIS_LEAD_TIME
       , null LOT_REAL_LEAD_TIME
       , '-1' LOT_ORT_UPDATE_DELAY
       , '-1' LOT_UPDATED_COMPONENTS
       , 'DWH_NA' C_LOT_RECEPT_ERROR
       , -1 PTC_FIXED_COSTPRICE_ID
       , '-1' LOT_IS_POSTCALCULATED
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_FAL_ORDER" ("PAC_SUPPLIER_PARTNER_ID", "FAL_ORDER_ID", "FAL_JOB_PROGRAM_ID", "DIC_FAMILY_ID", "DIC_ORDER_CODE2_ID", "DIC_ORDER_CODE3_ID", "DOC_DOCUMENT_ID", "C_ORDER_STATUS", "GCO_GOOD_ID", "ORD_REF", "ORD_OSHORT_DESCR", "ORD_OLONG_DESCR", "ORD_OFREE_DESCR", "ORD_MAX_RELEASABLE", "ORD_RELEASED_QTY", "ORD_OPENED_QTY", "ORD_STILL_TO_RELEASE_QTY", "ORD_PLANNED_QTY", "ORD_END_DATE", "ORD_PSHORT_DESCR", "ORD_PLONG_DESCR", "ORD_PFREE_DESCR", "ORD_SECOND_REF", "ORD_RESERVED_NUM1", "ORD_RESERVED_NUM2", "DOC_RECORD_ID", "PC_YEAR_WEEK_ID", "PAC_CUSTOM_PARTNER_ID", "C_PRIORITY", "C_FAB_TYPE") AS
  select Nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , FAL_ORDER_ID
       , Nvl(FAL_JOB_PROGRAM_ID, -2) FAL_JOB_PROGRAM_ID
       , Nvl(DIC_FAMILY_ID, 'DWH_ISNULL') DIC_FAMILY_ID
       , Nvl(DIC_ORDER_CODE2_ID, 'DWH_ISNULL') DIC_ORDER_CODE2_ID
       , Nvl(DIC_ORDER_CODE3_ID, 'DWH_ISNULL') DIC_ORDER_CODE3_ID
       , Nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , Nvl(C_ORDER_STATUS, 'DWH_ISNULL') C_ORDER_STATUS
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , ORD_REF
       , Nvl(ORD_OSHORT_DESCR, '_') ORD_OSHORT_DESCR
       , Nvl(ORD_OLONG_DESCR, '_') ORD_OLONG_DESCR
       , Nvl(ORD_OFREE_DESCR, '_') ORD_OFREE_DESCR
       , ORD_MAX_RELEASABLE
       , ORD_RELEASED_QTY
       , ORD_OPENED_QTY
       , ORD_STILL_TO_RELEASE_QTY
       , ORD_PLANNED_QTY
       , Nvl(ORD_END_DATE, to_date('40000101', 'YYYYMMDD') ) ORD_END_DATE
       , Nvl(ORD_PSHORT_DESCR, '_') ORD_PSHORT_DESCR
       , Nvl(ORD_PLONG_DESCR, '_') ORD_PLONG_DESCR
       , Nvl(ORD_PFREE_DESCR, '_') ORD_PFREE_DESCR
       , Nvl(ORD_SECOND_REF, '_') ORD_SECOND_REF
       , ORD_RESERVED_NUM1
       , ORD_RESERVED_NUM2
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(PC_YEAR_WEEK_ID, -2) PC_YEAR_WEEK_ID
       , Nvl(PAC_CUSTOM_PARTNER_ID, -2) PAC_CUSTOM_PARTNER_ID
       , Nvl(C_PRIORITY, 'DWH_ISNULL') C_PRIORITY
       , Nvl(C_FAB_TYPE, 'DWH_ISNULL') C_FAB_TYPE
  from FAL_ORDER
  union all
  select -1 PAC_SUPPLIER_PARTNER_ID
       , -1 FAL_ORDER_ID
       , -1 FAL_JOB_PROGRAM_ID
       , 'DWH_NA' DIC_FAMILY_ID
       , 'DWH_NA' DIC_ORDER_CODE2_ID
       , 'DWH_NA' DIC_ORDER_CODE3_ID
       , -1 DOC_DOCUMENT_ID
       , 'DWH_NA' C_ORDER_STATUS
       , -1 GCO_GOOD_ID
       , null ORD_REF
       , 'N/A' ORD_OSHORT_DESCR
       , 'N/A' ORD_OLONG_DESCR
       , 'N/A' ORD_OFREE_DESCR
       , null ORD_MAX_RELEASABLE
       , null ORD_RELEASED_QTY
       , null ORD_OPENED_QTY
       , null ORD_STILL_TO_RELEASE_QTY
       , null ORD_PLANNED_QTY
       , to_date('00010101', 'YYYYMMDD') ORD_END_DATE
       , 'N/A' ORD_PSHORT_DESCR
       , 'N/A' ORD_PLONG_DESCR
       , 'N/A' ORD_PFREE_DESCR
       , 'N/A' ORD_SECOND_REF
       , null ORD_RESERVED_NUM1
       , null ORD_RESERVED_NUM2
       , -1 DOC_RECORD_ID
       , -1 PC_YEAR_WEEK_ID
       , -1 PAC_CUSTOM_PARTNER_ID
       , 'DWH_NA' C_PRIORITY
       , 'DWH_NA' C_FAB_TYPE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_FAL_TASK" ("FAL_TASK_ID", "FAL_FACTORY_FLOOR_ID", "DIC_FREE_TASK_CODE2_ID", "PPS_TOOLS1_ID", "PPS_TOOLS2_ID", "PAC_SUPPLIER_PARTNER_ID", "GCO_GCO_GOOD_ID", "PPS_OPERATION_PROCEDURE_ID", "PPS_PPS_OPERATION_PROCEDURE_ID", "C_TASK_TYPE", "TAS_REF", "TAS_SHORT_DESCR", "TAS_LONG_DESCR", "TAS_FREE_DESCR", "DIC_FREE_TASK_CODE_ID", "C_TASK_IMPUTATION", "DIC_UNIT_OF_MEASURE_ID", "C_SCHEDULE_PLANNING", "FAL_FAL_FACTORY_FLOOR_ID", "DIC_FREE_TASK_CODE3_ID", "DIC_FREE_TASK_CODE4_ID", "DIC_FREE_TASK_CODE5_ID", "DIC_FREE_TASK_CODE6_ID", "DIC_FREE_TASK_CODE7_ID", "DIC_FREE_TASK_CODE8_ID", "DIC_FREE_TASK_CODE9_ID", "TAS_ADJUSTING_RATE", "TAS_WORK_RATE", "TAS_NUM_FLOOR", "TAS_ADJUSTING_FLOOR", "TAS_ADJUSTING_OPERATOR", "TAS_NUM_ADJUST_OPERATOR", "TAS_PERCENT_ADJUST_OPER", "TAS_WORK_FLOOR", "TAS_WORK_OPERATOR", "TAS_NUM_WORK_OPERATOR", "TAS_PERCENT_WORK_OPER", "TAS_CONVERSION_FACTOR", "TAS_FREE_NUM1", "TAS_FREE_NUM2", "TAS_FREE_NUM3", "TAS_FREE_NUM4", "PPS_TOOLS3_ID", "PPS_TOOLS4_ID", "PPS_TOOLS5_ID", "PPS_TOOLS6_ID", "PPS_TOOLS7_ID", "PPS_TOOLS8_ID", "PPS_TOOLS9_ID", "PPS_TOOLS10_ID", "PPS_TOOLS11_ID", "PPS_TOOLS12_ID", "PPS_TOOLS13_ID", "PPS_TOOLS14_ID", "PPS_TOOLS15_ID", "TAS_WEIGH", "TAS_WEIGH_MANDATORY", "TAS_AJUSTING_RATE", "TAS_GENERIC_SUBCONTRACT", "TAS_OPEN_TIME_MACHINE", "TAS_TRANSFERT_TIME", "TAS_AMOUNT", "TAS_QTY_REF_AMOUNT", "TAS_DIVISOR_AMOUNT", "TAS_PLAN_RATE", "TAS_PLAN_PROP") AS
  select FAL_TASK_ID
       , nvl(FAL_FACTORY_FLOOR_ID, -2) FAL_FACTORY_FLOOR_ID
       , nvl(DIC_FREE_TASK_CODE2_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE2_ID
       , nvl(PPS_TOOLS1_ID, -2) PPS_TOOLS1_ID
       , nvl(PPS_TOOLS2_ID, -2) PPS_TOOLS2_ID
       , nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , nvl(GCO_GCO_GOOD_ID, -2) GCO_GCO_GOOD_ID
       , nvl(PPS_OPERATION_PROCEDURE_ID, -2) PPS_OPERATION_PROCEDURE_ID
       , nvl(PPS_PPS_OPERATION_PROCEDURE_ID, -2) PPS_PPS_OPERATION_PROCEDURE_ID
       , nvl(C_TASK_TYPE, 'DWH_ISNULL') C_TASK_TYPE
       , nvl(TAS_REF, '_') TAS_REF
       , nvl(TAS_SHORT_DESCR, '_') TAS_SHORT_DESCR
       , nvl(TAS_LONG_DESCR, '_') TAS_LONG_DESCR
       , nvl(TAS_FREE_DESCR, '_') TAS_FREE_DESCR
       , nvl(DIC_FREE_TASK_CODE_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE_ID
       , nvl(C_TASK_IMPUTATION, 'DWH_ISNULL') C_TASK_IMPUTATION
       , nvl(DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE_ID
       , nvl(C_SCHEDULE_PLANNING, 'DWH_ISNULL') C_SCHEDULE_PLANNING
       , nvl(FAL_FAL_FACTORY_FLOOR_ID, -2) FAL_FAL_FACTORY_FLOOR_ID
       , nvl(DIC_FREE_TASK_CODE3_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE3_ID
       , nvl(DIC_FREE_TASK_CODE4_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE4_ID
       , nvl(DIC_FREE_TASK_CODE5_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE5_ID
       , nvl(DIC_FREE_TASK_CODE6_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE6_ID
       , nvl(DIC_FREE_TASK_CODE7_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE7_ID
       , nvl(DIC_FREE_TASK_CODE8_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE8_ID
       , nvl(DIC_FREE_TASK_CODE9_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE9_ID
       , TAS_ADJUSTING_RATE
       , TAS_WORK_RATE
       , TAS_NUM_FLOOR
       , nvl2(TAS_ADJUSTING_FLOOR, case
                when(TAS_ADJUSTING_FLOOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAS_ADJUSTING_FLOOR
       , nvl2(TAS_ADJUSTING_OPERATOR, case
                when(TAS_ADJUSTING_OPERATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAS_ADJUSTING_OPERATOR
       , TAS_NUM_ADJUST_OPERATOR
       , TAS_PERCENT_ADJUST_OPER
       , nvl2(TAS_WORK_FLOOR, case
                when(TAS_WORK_FLOOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAS_WORK_FLOOR
       , nvl2(TAS_WORK_OPERATOR, case
                when(TAS_WORK_OPERATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAS_WORK_OPERATOR
       , TAS_NUM_WORK_OPERATOR
       , TAS_PERCENT_WORK_OPER
       , TAS_CONVERSION_FACTOR
       , TAS_FREE_NUM1
       , TAS_FREE_NUM2
       , TAS_FREE_NUM3
       , TAS_FREE_NUM4
       , nvl(PPS_TOOLS3_ID, -2) PPS_TOOLS3_ID
       , nvl(PPS_TOOLS4_ID, -2) PPS_TOOLS4_ID
       , nvl(PPS_TOOLS5_ID, -2) PPS_TOOLS5_ID
       , nvl(PPS_TOOLS6_ID, -2) PPS_TOOLS6_ID
       , nvl(PPS_TOOLS7_ID, -2) PPS_TOOLS7_ID
       , nvl(PPS_TOOLS8_ID, -2) PPS_TOOLS8_ID
       , nvl(PPS_TOOLS9_ID, -2) PPS_TOOLS9_ID
       , nvl(PPS_TOOLS10_ID, -2) PPS_TOOLS10_ID
       , nvl(PPS_TOOLS11_ID, -2) PPS_TOOLS11_ID
       , nvl(PPS_TOOLS12_ID, -2) PPS_TOOLS12_ID
       , nvl(PPS_TOOLS13_ID, -2) PPS_TOOLS13_ID
       , nvl(PPS_TOOLS14_ID, -2) PPS_TOOLS14_ID
       , nvl(PPS_TOOLS15_ID, -2) PPS_TOOLS15_ID
       , nvl2(TAS_WEIGH, case
                when(TAS_WEIGH = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAS_WEIGH
       , nvl2(TAS_WEIGH_MANDATORY, case
                when(TAS_WEIGH_MANDATORY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAS_WEIGH_MANDATORY
       , TAS_AJUSTING_RATE
       , TAS_GENERIC_SUBCONTRACT
       , TAS_OPEN_TIME_MACHINE
       , TAS_TRANSFERT_TIME
       , TAS_AMOUNT
       , TAS_QTY_REF_AMOUNT
       , TAS_DIVISOR_AMOUNT
       , TAS_PLAN_RATE
       , TAS_PLAN_PROP
    from FAL_TASK
  union all
  select -1 FAL_TASK_ID
       , -1 FAL_FACTORY_FLOOR_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE2_ID
       , -1 PPS_TOOLS1_ID
       , -1 PPS_TOOLS2_ID
       , -1 PAC_SUPPLIER_PARTNER_ID
       , -1 GCO_GCO_GOOD_ID
       , -1 PPS_OPERATION_PROCEDURE_ID
       , -1 PPS_PPS_OPERATION_PROCEDURE_ID
       , 'DWH_NA' C_TASK_TYPE
       , 'N/A' TAS_REF
       , 'N/A' TAS_SHORT_DESCR
       , 'N/A' TAS_LONG_DESCR
       , 'N/A' TAS_FREE_DESCR
       , 'DWH_NA' DIC_FREE_TASK_CODE_ID
       , 'DWH_NA' C_TASK_IMPUTATION
       , 'DWH_NA' DIC_UNIT_OF_MEASURE_ID
       , 'DWH_NA' C_SCHEDULE_PLANNING
       , -1 FAL_FAL_FACTORY_FLOOR_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE3_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE4_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE5_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE6_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE7_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE8_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE9_ID
       , null TAS_ADJUSTING_RATE
       , null TAS_WORK_RATE
       , null TAS_NUM_FLOOR
       , '-1' TAS_ADJUSTING_FLOOR
       , '-1' TAS_ADJUSTING_OPERATOR
       , null TAS_NUM_ADJUST_OPERATOR
       , null TAS_PERCENT_ADJUST_OPER
       , '-1' TAS_WORK_FLOOR
       , '-1' TAS_WORK_OPERATOR
       , null TAS_NUM_WORK_OPERATOR
       , null TAS_PERCENT_WORK_OPER
       , null TAS_CONVERSION_FACTOR
       , null TAS_FREE_NUM1
       , null TAS_FREE_NUM2
       , null TAS_FREE_NUM3
       , null TAS_FREE_NUM4
       , -1 PPS_TOOLS3_ID
       , -1 PPS_TOOLS4_ID
       , -1 PPS_TOOLS5_ID
       , -1 PPS_TOOLS6_ID
       , -1 PPS_TOOLS7_ID
       , -1 PPS_TOOLS8_ID
       , -1 PPS_TOOLS9_ID
       , -1 PPS_TOOLS10_ID
       , -1 PPS_TOOLS11_ID
       , -1 PPS_TOOLS12_ID
       , -1 PPS_TOOLS13_ID
       , -1 PPS_TOOLS14_ID
       , -1 PPS_TOOLS15_ID
       , '-1' TAS_WEIGH
       , '-1' TAS_WEIGH_MANDATORY
       , null TAS_AJUSTING_RATE
       , null TAS_GENERIC_SUBCONTRACT
       , null TAS_OPEN_TIME_MACHINE
       , null TAS_TRANSFERT_TIME
       , null TAS_AMOUNT
       , null TAS_QTY_REF_AMOUNT
       , null TAS_DIVISOR_AMOUNT
       , null TAS_PLAN_RATE
       , null TAS_PLAN_PROP
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_FAL_TASK_LINK" ("FAL_SCHEDULE_STEP_ID", "FAL_LOT_ID", "DOC_DOCUMENT_ID", "TAL_DUE_TSK", "TAL_ACHIEVED_TSK", "TAL_TSK_BALANCE", "TAL_DUE_AMT", "TAL_ACHIEVED_AMT", "TAL_AMT_BALANCE", "TAL_PLAN_QTY", "TAL_RELEASE_QTY", "TAL_REJECTED_QTY", "TAL_AVALAIBLE_QTY", "TAL_DUE_QTY", "TAL_R_METER", "TAL_BEGIN_PLAN_DATE", "TAL_END_PLAN_DATE", "TAL_NUM_UNITS_ALLOCATED", "TAL_TASK_MANUF_TIME", "C_TASK_TYPE", "SCS_STEP_NUMBER", "SCS_WORK_TIME", "SCS_QTY_REF_WORK", "SCS_WORK_RATE", "SCS_AMOUNT", "SCS_QTY_REF_AMOUNT", "SCS_DIVISOR_AMOUNT", "SCS_PLAN_RATE", "SCS_SHORT_DESCR", "SCS_LONG_DESCR", "SCS_FREE_DESCR", "PAC_SUPPLIER_PARTNER_ID", "PPS_OPERATION_PROCEDURE_ID", "PPS_PPS_OPERATION_PROCEDURE_ID", "PPS_TOOLS1_ID", "GCO_GCO_GOOD_ID", "FAL_FACTORY_FLOOR_ID", "FAL_TASK_ID", "TAL_PLAN_RATE", "TAL_BEGIN_REAL_DATE", "TAL_END_REAL_DATE", "PPS_TOOLS2_ID", "C_OPERATION_TYPE", "SCS_ADJUSTING_TIME", "TAL_EAN_CODE", "TAL_SEQ_ORIGIN", "DIC_FREE_TASK_CODE2_ID", "DIC_FREE_TASK_CODE_ID", "SCS_PLAN_PROP", "C_TASK_IMPUTATION", "SCS_TRANSFERT_TIME", "SCS_QTY_FIX_ADJUSTING", "SCS_ADJUSTING_RATE", "TAL_ACHIEVED_AD_TSK", "DOC_POSITION_DETAIL_ID", "TAL_SUBCONTRACT_QTY", "C_RELATION_TYPE", "SCS_DELAY", "TAL_ORT_PRIORITY", "TAL_SUBCONTRACT_SELECT", "TAL_SUBCONTRACT_PRINT", "TAL_SUB_SELECT_DATE", "TAL_SUB_PRINT_DATE", "TAL_CONFIRM_DATE", "TAL_CONFIRM_DESCR", "TAL_ORT_MARKERS", "PPS_TOOLS3_ID", "PPS_TOOLS4_ID", "PPS_TOOLS5_ID", "PPS_TOOLS6_ID", "PPS_TOOLS7_ID", "PPS_TOOLS8_ID", "PPS_TOOLS9_ID", "PPS_TOOLS10_ID", "PPS_TOOLS11_ID", "PPS_TOOLS12_ID", "PPS_TOOLS13_ID", "PPS_TOOLS14_ID", "PPS_TOOLS15_ID", "DIC_FREE_TASK_CODE3_ID", "DIC_FREE_TASK_CODE4_ID", "DIC_FREE_TASK_CODE5_ID", "DIC_FREE_TASK_CODE6_ID", "DIC_FREE_TASK_CODE7_ID", "DIC_FREE_TASK_CODE8_ID", "DIC_FREE_TASK_CODE9_ID", "FAL_FAL_FACTORY_FLOOR_ID", "SCS_NUM_FLOOR", "SCS_ADJUSTING_FLOOR", "SCS_ADJUSTING_OPERATOR", "SCS_NUM_ADJUST_OPERATOR", "SCS_PERCENT_ADJUST_OPER", "SCS_WORK_FLOOR", "SCS_WORK_OPERATOR", "SCS_NUM_WORK_OPERATOR", "SCS_PERCENT_WORK_OPER", "TAL_TSK_AD_BALANCE", "TAL_TSK_W_BALANCE", "TAL_FREE_SLACK", "TAL_NEW_SUBC_TIME_TEMP", "TAL_NEW_END_PLAN_DATE", "TAL_BASIS_BEGIN_DATE", "TAL_BASIS_END_DATE", "TAL_TASK_BASIS_TIME", "TAL_TASK_REAL_TIME", "DIC_UNIT_OF_MEASURE_ID", "SCS_CONVERSION_FACTOR", "SCS_QTY_REF2_WORK", "SCS_FREE_NUM1", "SCS_FREE_NUM2", "SCS_FREE_NUM3", "SCS_FREE_NUM4", "SCS_WEIGH", "SCS_WEIGH_MANDATORY") AS
  select nvl(FAL_SCHEDULE_STEP_ID, -2) FAL_SCHEDULE_STEP_ID
       , nvl(FAL_LOT_ID, -2) FAL_LOT_ID
       , nvl(DOC_DOCUMENT_ID, -2) DOC_DOCUMENT_ID
       , TAL_DUE_TSK
       , TAL_ACHIEVED_TSK
       , TAL_TSK_BALANCE
       , TAL_DUE_AMT
       , TAL_ACHIEVED_AMT
       , TAL_AMT_BALANCE
       , TAL_PLAN_QTY
       , TAL_RELEASE_QTY
       , TAL_REJECTED_QTY
       , TAL_AVALAIBLE_QTY
       , TAL_DUE_QTY
       , TAL_R_METER
       , nvl(TAL_BEGIN_PLAN_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_BEGIN_PLAN_DATE
       , nvl(TAL_END_PLAN_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_END_PLAN_DATE
       , TAL_NUM_UNITS_ALLOCATED
       , TAL_TASK_MANUF_TIME
       , nvl(C_TASK_TYPE, 'DWH_ISNULL') C_TASK_TYPE
       , SCS_STEP_NUMBER
       , SCS_WORK_TIME
       , SCS_QTY_REF_WORK
       , SCS_WORK_RATE
       , SCS_AMOUNT
       , SCS_QTY_REF_AMOUNT
       , nvl2(SCS_DIVISOR_AMOUNT, case
                when(SCS_DIVISOR_AMOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_DIVISOR_AMOUNT
       , SCS_PLAN_RATE
       , nvl(SCS_SHORT_DESCR, '_') SCS_SHORT_DESCR
       , nvl(SCS_LONG_DESCR, '_') SCS_LONG_DESCR
       , nvl(SCS_FREE_DESCR, '_') SCS_FREE_DESCR
       , nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , nvl(PPS_OPERATION_PROCEDURE_ID, -2) PPS_OPERATION_PROCEDURE_ID
       , nvl(PPS_PPS_OPERATION_PROCEDURE_ID, -2) PPS_PPS_OPERATION_PROCEDURE_ID
       , nvl(PPS_TOOLS1_ID, -2) PPS_TOOLS1_ID
       , nvl(GCO_GCO_GOOD_ID, -2) GCO_GCO_GOOD_ID
       , nvl(FAL_FACTORY_FLOOR_ID, -2) FAL_FACTORY_FLOOR_ID
       , nvl(FAL_TASK_ID, -2) FAL_TASK_ID
       , TAL_PLAN_RATE
       , nvl(TAL_BEGIN_REAL_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_BEGIN_REAL_DATE
       , nvl(TAL_END_REAL_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_END_REAL_DATE
       , nvl(PPS_TOOLS2_ID, -2) PPS_TOOLS2_ID
       , nvl(C_OPERATION_TYPE, 'DWH_ISNULL') C_OPERATION_TYPE
       , SCS_ADJUSTING_TIME
       , nvl(TAL_EAN_CODE, '_') TAL_EAN_CODE
       , TAL_SEQ_ORIGIN
       , nvl(DIC_FREE_TASK_CODE2_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE2_ID
       , nvl(DIC_FREE_TASK_CODE_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE_ID
       , nvl2(SCS_PLAN_PROP, case
                when(SCS_PLAN_PROP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_PLAN_PROP
       , nvl(C_TASK_IMPUTATION, 'DWH_ISNULL') C_TASK_IMPUTATION
       , SCS_TRANSFERT_TIME
       , SCS_QTY_FIX_ADJUSTING
       , SCS_ADJUSTING_RATE
       , TAL_ACHIEVED_AD_TSK
       , nvl(DOC_POSITION_DETAIL_ID, -2) DOC_POSITION_DETAIL_ID
       , TAL_SUBCONTRACT_QTY
       , nvl(C_RELATION_TYPE, 'DWH_ISNULL') C_RELATION_TYPE
       , SCS_DELAY
       , TAL_ORT_PRIORITY
       , nvl2(TAL_SUBCONTRACT_SELECT, case
                when(TAL_SUBCONTRACT_SELECT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAL_SUBCONTRACT_SELECT
       , nvl2(TAL_SUBCONTRACT_PRINT, case
                when(TAL_SUBCONTRACT_PRINT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') TAL_SUBCONTRACT_PRINT
       , nvl(TAL_SUB_SELECT_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_SUB_SELECT_DATE
       , nvl(TAL_SUB_PRINT_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_SUB_PRINT_DATE
       , nvl(TAL_CONFIRM_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_CONFIRM_DATE
       , nvl(TAL_CONFIRM_DESCR, '_') TAL_CONFIRM_DESCR
       , nvl(TAL_ORT_MARKERS, '_') TAL_ORT_MARKERS
       , nvl(PPS_TOOLS3_ID, -2) PPS_TOOLS3_ID
       , nvl(PPS_TOOLS4_ID, -2) PPS_TOOLS4_ID
       , nvl(PPS_TOOLS5_ID, -2) PPS_TOOLS5_ID
       , nvl(PPS_TOOLS6_ID, -2) PPS_TOOLS6_ID
       , nvl(PPS_TOOLS7_ID, -2) PPS_TOOLS7_ID
       , nvl(PPS_TOOLS8_ID, -2) PPS_TOOLS8_ID
       , nvl(PPS_TOOLS9_ID, -2) PPS_TOOLS9_ID
       , nvl(PPS_TOOLS10_ID, -2) PPS_TOOLS10_ID
       , nvl(PPS_TOOLS11_ID, -2) PPS_TOOLS11_ID
       , nvl(PPS_TOOLS12_ID, -2) PPS_TOOLS12_ID
       , nvl(PPS_TOOLS13_ID, -2) PPS_TOOLS13_ID
       , nvl(PPS_TOOLS14_ID, -2) PPS_TOOLS14_ID
       , nvl(PPS_TOOLS15_ID, -2) PPS_TOOLS15_ID
       , nvl(DIC_FREE_TASK_CODE3_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE3_ID
       , nvl(DIC_FREE_TASK_CODE4_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE4_ID
       , nvl(DIC_FREE_TASK_CODE5_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE5_ID
       , nvl(DIC_FREE_TASK_CODE6_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE6_ID
       , nvl(DIC_FREE_TASK_CODE7_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE7_ID
       , nvl(DIC_FREE_TASK_CODE8_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE8_ID
       , nvl(DIC_FREE_TASK_CODE9_ID, 'DWH_ISNULL') DIC_FREE_TASK_CODE9_ID
       , nvl(FAL_FAL_FACTORY_FLOOR_ID, -2) FAL_FAL_FACTORY_FLOOR_ID
       , SCS_NUM_FLOOR
       , nvl2(SCS_ADJUSTING_FLOOR, case
                when(SCS_ADJUSTING_FLOOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_ADJUSTING_FLOOR
       , nvl2(SCS_ADJUSTING_OPERATOR, case
                when(SCS_ADJUSTING_OPERATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_ADJUSTING_OPERATOR
       , SCS_NUM_ADJUST_OPERATOR
       , SCS_PERCENT_ADJUST_OPER
       , nvl2(SCS_WORK_FLOOR, case
                when(SCS_WORK_FLOOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_WORK_FLOOR
       , nvl2(SCS_WORK_OPERATOR, case
                when(SCS_WORK_OPERATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_WORK_OPERATOR
       , SCS_NUM_WORK_OPERATOR
       , SCS_PERCENT_WORK_OPER
       , TAL_TSK_AD_BALANCE
       , TAL_TSK_W_BALANCE
       , TAL_FREE_SLACK
       , TAL_NEW_SUBC_TIME_TEMP
       , nvl(TAL_NEW_END_PLAN_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_NEW_END_PLAN_DATE
       , nvl(TAL_BASIS_BEGIN_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_BASIS_BEGIN_DATE
       , nvl(TAL_BASIS_END_DATE, to_date('40000101', 'YYYYMMDD') ) TAL_BASIS_END_DATE
       , TAL_TASK_BASIS_TIME
       , TAL_TASK_REAL_TIME
       , nvl(DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE_ID
       , SCS_CONVERSION_FACTOR
       , SCS_QTY_REF2_WORK
       , SCS_FREE_NUM1
       , SCS_FREE_NUM2
       , SCS_FREE_NUM3
       , SCS_FREE_NUM4
       , nvl2(SCS_WEIGH, case
                when(SCS_WEIGH = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_WEIGH
       , nvl2(SCS_WEIGH_MANDATORY, case
                when(SCS_WEIGH_MANDATORY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCS_WEIGH_MANDATORY
    from FAL_TASK_LINK
  union all
  select -1 FAL_SCHEDULE_STEP_ID
       , -1 FAL_LOT_ID
       , -1 DOC_DOCUMENT_ID
       , null TAL_DUE_TSK
       , null TAL_ACHIEVED_TSK
       , null TAL_TSK_BALANCE
       , null TAL_DUE_AMT
       , null TAL_ACHIEVED_AMT
       , null TAL_AMT_BALANCE
       , null TAL_PLAN_QTY
       , null TAL_RELEASE_QTY
       , null TAL_REJECTED_QTY
       , null TAL_AVALAIBLE_QTY
       , null TAL_DUE_QTY
       , null TAL_R_METER
       , to_date('00010101', 'YYYYMMDD') TAL_BEGIN_PLAN_DATE
       , to_date('00010101', 'YYYYMMDD') TAL_END_PLAN_DATE
       , null TAL_NUM_UNITS_ALLOCATED
       , null TAL_TASK_MANUF_TIME
       , 'DWH_NA' C_TASK_TYPE
       , null SCS_STEP_NUMBER
       , null SCS_WORK_TIME
       , null SCS_QTY_REF_WORK
       , null SCS_WORK_RATE
       , null SCS_AMOUNT
       , null SCS_QTY_REF_AMOUNT
       , '-1' SCS_DIVISOR_AMOUNT
       , null SCS_PLAN_RATE
       , 'N/A' SCS_SHORT_DESCR
       , 'N/A' SCS_LONG_DESCR
       , 'N/A' SCS_FREE_DESCR
       , -1 PAC_SUPPLIER_PARTNER_ID
       , -1 PPS_OPERATION_PROCEDURE_ID
       , -1 PPS_PPS_OPERATION_PROCEDURE_ID
       , -1 PPS_TOOLS1_ID
       , -1 GCO_GCO_GOOD_ID
       , -1 FAL_FACTORY_FLOOR_ID
       , -1 FAL_TASK_ID
       , null TAL_PLAN_RATE
       , to_date('00010101', 'YYYYMMDD') TAL_BEGIN_REAL_DATE
       , to_date('00010101', 'YYYYMMDD') TAL_END_REAL_DATE
       , -1 PPS_TOOLS2_ID
       , 'DWH_NA' C_OPERATION_TYPE
       , null SCS_ADJUSTING_TIME
       , 'N/A' TAL_EAN_CODE
       , null TAL_SEQ_ORIGIN
       , 'DWH_NA' DIC_FREE_TASK_CODE2_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE_ID
       , '-1' SCS_PLAN_PROP
       , 'DWH_NA' C_TASK_IMPUTATION
       , null SCS_TRANSFERT_TIME
       , null SCS_QTY_FIX_ADJUSTING
       , null SCS_ADJUSTING_RATE
       , null TAL_ACHIEVED_AD_TSK
       , -1 DOC_POSITION_DETAIL_ID
       , null TAL_SUBCONTRACT_QTY
       , 'DWH_NA' C_RELATION_TYPE
       , null SCS_DELAY
       , null TAL_ORT_PRIORITY
       , '-1' TAL_SUBCONTRACT_SELECT
       , '-1' TAL_SUBCONTRACT_PRINT
       , to_date('00010101', 'YYYYMMDD') TAL_SUB_SELECT_DATE
       , to_date('00010101', 'YYYYMMDD') TAL_SUB_PRINT_DATE
       , to_date('00010101', 'YYYYMMDD') TAL_CONFIRM_DATE
       , 'N/A' TAL_CONFIRM_DESCR
       , 'N/A' TAL_ORT_MARKERS
       , -1 PPS_TOOLS3_ID
       , -1 PPS_TOOLS4_ID
       , -1 PPS_TOOLS5_ID
       , -1 PPS_TOOLS6_ID
       , -1 PPS_TOOLS7_ID
       , -1 PPS_TOOLS8_ID
       , -1 PPS_TOOLS9_ID
       , -1 PPS_TOOLS10_ID
       , -1 PPS_TOOLS11_ID
       , -1 PPS_TOOLS12_ID
       , -1 PPS_TOOLS13_ID
       , -1 PPS_TOOLS14_ID
       , -1 PPS_TOOLS15_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE3_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE4_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE5_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE6_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE7_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE8_ID
       , 'DWH_NA' DIC_FREE_TASK_CODE9_ID
       , -1 FAL_FAL_FACTORY_FLOOR_ID
       , null SCS_NUM_FLOOR
       , '-1' SCS_ADJUSTING_FLOOR
       , '-1' SCS_ADJUSTING_OPERATOR
       , null SCS_NUM_ADJUST_OPERATOR
       , null SCS_PERCENT_ADJUST_OPER
       , '-1' SCS_WORK_FLOOR
       , '-1' SCS_WORK_OPERATOR
       , null SCS_NUM_WORK_OPERATOR
       , null SCS_PERCENT_WORK_OPER
       , null TAL_TSK_AD_BALANCE
       , null TAL_TSK_W_BALANCE
       , null TAL_FREE_SLACK
       , null TAL_NEW_SUBC_TIME_TEMP
       , to_date('00010101', 'YYYYMMDD') TAL_NEW_END_PLAN_DATE
       , to_date('00010101', 'YYYYMMDD') TAL_BASIS_BEGIN_DATE
       , to_date('00010101', 'YYYYMMDD') TAL_BASIS_END_DATE
       , null TAL_TASK_BASIS_TIME
       , null TAL_TASK_REAL_TIME
       , 'DWH_NA' DIC_UNIT_OF_MEASURE_ID
       , null SCS_CONVERSION_FACTOR
       , null SCS_QTY_REF2_WORK
       , null SCS_FREE_NUM1
       , null SCS_FREE_NUM2
       , null SCS_FREE_NUM3
       , null SCS_FREE_NUM4
       , '-1' SCS_WEIGH
       , '-1' SCS_WEIGH_MANDATORY
    from dual
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_CHARACTERIZATION" ("GCO_CHARACTERIZATION_ID", "C_CHRONOLOGY_TYPE", "C_CHARACT_TYPE", "C_UNIT_OF_TIME", "GCO_GOOD_ID", "CHA_CHARACTERIZATION_DESIGN", "CHA_AUTOMATIC_INCREMENTATION", "CHA_INCREMENT_STE", "CHA_LAST_USED_INCREMENT", "CHA_LAPSING_DELAY", "CHA_MINIMUM_VALUE", "CHA_MAXIMUM_VALUE", "CHA_COMMENT", "CHA_STOCK_MANAGEMENT", "GCO_CHAR_AUTONUM_FUNC_ID", "CHA_PREFIXE", "CHA_SUFFIXE", "CHA_FREE_TEXT_1", "CHA_FREE_TEXT_2", "CHA_FREE_TEXT_3", "CHA_FREE_TEXT_4", "CHA_FREE_TEXT_5", "CHA_LAPSING_MARGE", "GCO_REFERENCE_TEMPLATE_ID") AS
  select GCO_CHARACTERIZATION_ID
       , Nvl(C_CHRONOLOGY_TYPE, 'DWH_ISNULL') C_CHRONOLOGY_TYPE
       , Nvl(C_CHARACT_TYPE, 'DWH_ISNULL') C_CHARACT_TYPE
       , Nvl(C_UNIT_OF_TIME, 'DWH_ISNULL') C_UNIT_OF_TIME
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(CHA_CHARACTERIZATION_DESIGN, '_') CHA_CHARACTERIZATION_DESIGN
       , Nvl2(CHA_AUTOMATIC_INCREMENTATION, case
                when(CHA_AUTOMATIC_INCREMENTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CHA_AUTOMATIC_INCREMENTATION
       , CHA_INCREMENT_STE
       , CHA_LAST_USED_INCREMENT
       , CHA_LAPSING_DELAY
       , CHA_MINIMUM_VALUE
       , CHA_MAXIMUM_VALUE
       , Nvl(CHA_COMMENT, '_') CHA_COMMENT
       , Nvl2(CHA_STOCK_MANAGEMENT, case
                when(CHA_STOCK_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CHA_STOCK_MANAGEMENT
       , Nvl(GCO_CHAR_AUTONUM_FUNC_ID, -2) GCO_CHAR_AUTONUM_FUNC_ID
       , Nvl(CHA_PREFIXE, '_') CHA_PREFIXE
       , Nvl(CHA_SUFFIXE, '_') CHA_SUFFIXE
       , Nvl(CHA_FREE_TEXT_1, '_') CHA_FREE_TEXT_1
       , Nvl(CHA_FREE_TEXT_2, '_') CHA_FREE_TEXT_2
       , Nvl(CHA_FREE_TEXT_3, '_') CHA_FREE_TEXT_3
       , Nvl(CHA_FREE_TEXT_4, '_') CHA_FREE_TEXT_4
       , Nvl(CHA_FREE_TEXT_5, '_') CHA_FREE_TEXT_5
       , CHA_LAPSING_MARGE
       , Nvl(GCO_REFERENCE_TEMPLATE_ID, -2) GCO_REFERENCE_TEMPLATE_ID
  from GCO_CHARACTERIZATION
  union all
  select -1 GCO_CHARACTERIZATION_ID
       , 'DWH_NA' C_CHRONOLOGY_TYPE
       , 'DWH_NA' C_CHARACT_TYPE
       , 'DWH_NA' C_UNIT_OF_TIME
       , -1 GCO_GOOD_ID
       , 'N/A' CHA_CHARACTERIZATION_DESIGN
       , '-1' CHA_AUTOMATIC_INCREMENTATION
       , null CHA_INCREMENT_STE
       , null CHA_LAST_USED_INCREMENT
       , null CHA_LAPSING_DELAY
       , null CHA_MINIMUM_VALUE
       , null CHA_MAXIMUM_VALUE
       , 'N/A' CHA_COMMENT
       , '-1' CHA_STOCK_MANAGEMENT
       , -1 GCO_CHAR_AUTONUM_FUNC_ID
       , 'N/A' CHA_PREFIXE
       , 'N/A' CHA_SUFFIXE
       , 'N/A' CHA_FREE_TEXT_1
       , 'N/A' CHA_FREE_TEXT_2
       , 'N/A' CHA_FREE_TEXT_3
       , 'N/A' CHA_FREE_TEXT_4
       , 'N/A' CHA_FREE_TEXT_5
       , null CHA_LAPSING_MARGE
       , -1 GCO_REFERENCE_TEMPLATE_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_COM_DA_MANUFACTURE" ("GCO_COMPL_DATA_MANUFACTURE_ID", "C_QTY_SUPPLY_RULE", "C_TIME_SUPPLY_RULE", "DIC_UNIT_OF_MEASURE_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_SUBSTITUTION_LIST_ID", "GCO_GOOD_ID", "GCO_QUALITY_PRINCIPLE_ID", "CDA_COMPLEMENTARY_REFERENCE", "CDA_COMPLEMENTARY_EAN_CODE", "CDA_SHORT_DESCRIPTION", "CDA_LONG_DESCRIPTION", "CDA_FREE_DESCRIPTION", "CDA_COMMENT", "CDA_NUMBER_OF_DECIMAL", "CDA_CONVERSION_FACTOR", "CMA_AUTOMATIC_GENERATING_PROP", "CMA_ECONOMICAL_QUANTITY", "CMA_FIXED_DELAY", "CMA_MANUFACTURING_DELAY", "CMA_PERCENT_TRASH", "CMA_FIXED_QUANTITY_TRASH", "CMA_PERCENT_WASTE", "CMA_FIXED_QUANTITY_WASTE", "CMA_QTY_REFERENCE_LOSS", "FAL_SCHEDULE_PLAN_ID", "PPS_OPERATION_PROCEDURE_ID", "CMA_LOT_QUANTITY", "CMA_PLAN_NUMBER", "CMA_PLAN_VERSION", "CMA_MULTIMEDIA_PLAN", "PPS_NOMENCLATURE_ID", "DIC_FAB_CONDITION_ID", "CMA_DEFAULT", "CMA_SCHEDULE_TYPE", "DIC_COMPLEMENTARY_DATA_ID", "PPS_RANGE_ID", "CDA_FREE_ALPHA_1", "CDA_FREE_ALPHA_2", "CDA_FREE_DEC_1", "CDA_FREE_DEC_2", "C_ECONOMIC_CODE", "CMA_SHIFT", "CMA_FIX_DELAY", "CMA_MODULO_QUANTITY", "CMA_AUTO_RECEPT", "CDA_COMPLEMENTARY_UCC14_CODE", "CDA_SECONDARY_REFERENCE", "CMA_SECURITY_DELAY") AS
  select GCO_COMPL_DATA_MANUFACTURE_ID
       , Nvl(C_QTY_SUPPLY_RULE, 'DWH_ISNULL') C_QTY_SUPPLY_RULE
       , Nvl(C_TIME_SUPPLY_RULE, 'DWH_ISNULL') C_TIME_SUPPLY_RULE
       , Nvl(DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl(GCO_SUBSTITUTION_LIST_ID, -2) GCO_SUBSTITUTION_LIST_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(GCO_QUALITY_PRINCIPLE_ID, -2) GCO_QUALITY_PRINCIPLE_ID
       , Nvl(CDA_COMPLEMENTARY_REFERENCE, '_') CDA_COMPLEMENTARY_REFERENCE
       , Nvl(CDA_COMPLEMENTARY_EAN_CODE, '_') CDA_COMPLEMENTARY_EAN_CODE
       , Nvl(CDA_SHORT_DESCRIPTION, '_') CDA_SHORT_DESCRIPTION
       , Nvl(CDA_LONG_DESCRIPTION, '_') CDA_LONG_DESCRIPTION
       , Nvl(CDA_FREE_DESCRIPTION, '_') CDA_FREE_DESCRIPTION
       , Nvl(CDA_COMMENT, '_') CDA_COMMENT
       , CDA_NUMBER_OF_DECIMAL
       , CDA_CONVERSION_FACTOR
       , Nvl2(CMA_AUTOMATIC_GENERATING_PROP
            , case
                when(CMA_AUTOMATIC_GENERATING_PROP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end
            , '-2'
             ) CMA_AUTOMATIC_GENERATING_PROP
       , CMA_ECONOMICAL_QUANTITY
       , CMA_FIXED_DELAY
       , CMA_MANUFACTURING_DELAY
       , CMA_PERCENT_TRASH
       , CMA_FIXED_QUANTITY_TRASH
       , CMA_PERCENT_WASTE
       , CMA_FIXED_QUANTITY_WASTE
       , CMA_QTY_REFERENCE_LOSS
       , Nvl(FAL_SCHEDULE_PLAN_ID, -2) FAL_SCHEDULE_PLAN_ID
       , Nvl(PPS_OPERATION_PROCEDURE_ID, -2) PPS_OPERATION_PROCEDURE_ID
       , CMA_LOT_QUANTITY
       , Nvl(CMA_PLAN_NUMBER, '_') CMA_PLAN_NUMBER
       , Nvl(CMA_PLAN_VERSION, '_') CMA_PLAN_VERSION
       , Nvl(CMA_MULTIMEDIA_PLAN, '_') CMA_MULTIMEDIA_PLAN
       , Nvl(PPS_NOMENCLATURE_ID, -2) PPS_NOMENCLATURE_ID
       , Nvl(DIC_FAB_CONDITION_ID, 'DWH_ISNULL') DIC_FAB_CONDITION_ID
       , Nvl2(CMA_DEFAULT, case
                when(CMA_DEFAULT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CMA_DEFAULT
       , Nvl2(CMA_SCHEDULE_TYPE, case
                when(CMA_SCHEDULE_TYPE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CMA_SCHEDULE_TYPE
       , Nvl(DIC_COMPLEMENTARY_DATA_ID, 'DWH_ISNULL') DIC_COMPLEMENTARY_DATA_ID
       , Nvl(PPS_RANGE_ID, -2) PPS_RANGE_ID
       , Nvl(CDA_FREE_ALPHA_1, '_') CDA_FREE_ALPHA_1
       , Nvl(CDA_FREE_ALPHA_2, '_') CDA_FREE_ALPHA_2
       , CDA_FREE_DEC_1
       , CDA_FREE_DEC_2
       , Nvl(C_ECONOMIC_CODE, 'DWH_ISNULL') C_ECONOMIC_CODE
       , CMA_SHIFT
       , Nvl2(CMA_FIX_DELAY, case
                when(CMA_FIX_DELAY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CMA_FIX_DELAY
       , CMA_MODULO_QUANTITY
       , Nvl2(CMA_AUTO_RECEPT, case
                when(CMA_AUTO_RECEPT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CMA_AUTO_RECEPT
       , Nvl(CDA_COMPLEMENTARY_UCC14_CODE, '_') CDA_COMPLEMENTARY_UCC14_CODE
       , Nvl(CDA_SECONDARY_REFERENCE, '_') CDA_SECONDARY_REFERENCE
       , CMA_SECURITY_DELAY
  from GCO_COMPL_DATA_MANUFACTURE
  union all
  select -1 GCO_COMPL_DATA_MANUFACTURE_ID
       , 'DWH_NA' C_QTY_SUPPLY_RULE
       , 'DWH_NA' C_TIME_SUPPLY_RULE
       , 'DWH_NA' DIC_UNIT_OF_MEASURE_ID
       , -1 STM_STOCK_ID
       , -1 STM_LOCATION_ID
       , -1 GCO_SUBSTITUTION_LIST_ID
       , -1 GCO_GOOD_ID
       , -1 GCO_QUALITY_PRINCIPLE_ID
       , 'N/A' CDA_COMPLEMENTARY_REFERENCE
       , 'N/A' CDA_COMPLEMENTARY_EAN_CODE
       , 'N/A' CDA_SHORT_DESCRIPTION
       , 'N/A' CDA_LONG_DESCRIPTION
       , 'N/A' CDA_FREE_DESCRIPTION
       , 'N/A' CDA_COMMENT
       , null CDA_NUMBER_OF_DECIMAL
       , null CDA_CONVERSION_FACTOR
       , '-1' CMA_AUTOMATIC_GENERATING_PROP
       , null CMA_ECONOMICAL_QUANTITY
       , null CMA_FIXED_DELAY
       , null CMA_MANUFACTURING_DELAY
       , null CMA_PERCENT_TRASH
       , null CMA_FIXED_QUANTITY_TRASH
       , null CMA_PERCENT_WASTE
       , null CMA_FIXED_QUANTITY_WASTE
       , null CMA_QTY_REFERENCE_LOSS
       , -1 FAL_SCHEDULE_PLAN_ID
       , -1 PPS_OPERATION_PROCEDURE_ID
       , null CMA_LOT_QUANTITY
       , 'N/A' CMA_PLAN_NUMBER
       , 'N/A' CMA_PLAN_VERSION
       , 'N/A' CMA_MULTIMEDIA_PLAN
       , -1 PPS_NOMENCLATURE_ID
       , 'DWH_NA' DIC_FAB_CONDITION_ID
       , '-1' CMA_DEFAULT
       , '-1' CMA_SCHEDULE_TYPE
       , 'DWH_NA' DIC_COMPLEMENTARY_DATA_ID
       , -1 PPS_RANGE_ID
       , 'N/A' CDA_FREE_ALPHA_1
       , 'N/A' CDA_FREE_ALPHA_2
       , null CDA_FREE_DEC_1
       , null CDA_FREE_DEC_2
       , 'DWH_NA' C_ECONOMIC_CODE
       , null CMA_SHIFT
       , '-1' CMA_FIX_DELAY
       , null CMA_MODULO_QUANTITY
       , '-1' CMA_AUTO_RECEPT
       , 'N/A' CDA_COMPLEMENTARY_UCC14_CODE
       , 'N/A' CDA_SECONDARY_REFERENCE
       , null CMA_SECURITY_DELAY
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_DESCRIPTION" ("GCO_DESCRIPTION_ID", "GCO_GOOD_ID", "PC_LANG_ID", "GCO_MULTIMEDIA_ELEMENT_ID", "C_DESCRIPTION_TYPE", "DES_SHORT_DESCRIPTION", "DES_LONG_DESCRIPTION", "DES_FREE_DESCRIPTION") AS
  select GCO_DESCRIPTION_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(GCO_MULTIMEDIA_ELEMENT_ID, -2) GCO_MULTIMEDIA_ELEMENT_ID
       , Nvl(C_DESCRIPTION_TYPE, 'DWH_ISNULL') C_DESCRIPTION_TYPE
       , Nvl(DES_SHORT_DESCRIPTION, '_') DES_SHORT_DESCRIPTION
       , Nvl(DES_LONG_DESCRIPTION, '_') DES_LONG_DESCRIPTION
       , Nvl(DES_FREE_DESCRIPTION, '_') DES_FREE_DESCRIPTION
  from GCO_DESCRIPTION
  union all
  select -1 GCO_DESCRIPTION_ID
       , -1 GCO_GOOD_ID
       , -1 PC_LANG_ID
       , -1 GCO_MULTIMEDIA_ELEMENT_ID
       , 'DWH_NA' C_DESCRIPTION_TYPE
       , 'N/A' DES_SHORT_DESCRIPTION
       , 'N/A' DES_LONG_DESCRIPTION
       , 'N/A' DES_FREE_DESCRIPTION
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_DESC_LANGUAGE" ("GCO_DESC_LANGUAGE_ID", "C_TYPE_DESC_LANG", "GCO_BASE_CHARACTERIZATION_ID", "PC_LANG_ID", "GCO_CHARACTERIZATION_ID", "GCO_CHARACTERISTIC_ELEMENT_ID", "DLA_DESCRIPTION", "GCO_BASE_ELEMENT_CHARAC_ID") AS
  select GCO_DESC_LANGUAGE_ID
       , Nvl(C_TYPE_DESC_LANG, 'DWH_ISNULL') C_TYPE_DESC_LANG
       , Nvl(GCO_BASE_CHARACTERIZATION_ID, -2) GCO_BASE_CHARACTERIZATION_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(GCO_CHARACTERIZATION_ID, -2) GCO_CHARACTERIZATION_ID
       , Nvl(GCO_CHARACTERISTIC_ELEMENT_ID, -2) GCO_CHARACTERISTIC_ELEMENT_ID
       , Nvl(DLA_DESCRIPTION, '_') DLA_DESCRIPTION
       , Nvl(GCO_BASE_ELEMENT_CHARAC_ID, -2) GCO_BASE_ELEMENT_CHARAC_ID
  from GCO_DESC_LANGUAGE
  union all
  select -1 GCO_DESC_LANGUAGE_ID
       , 'DWH_NA' C_TYPE_DESC_LANG
       , -1 GCO_BASE_CHARACTERIZATION_ID
       , -1 PC_LANG_ID
       , -1 GCO_CHARACTERIZATION_ID
       , -1 GCO_CHARACTERISTIC_ELEMENT_ID
       , 'N/A' DLA_DESCRIPTION
       , -1 GCO_BASE_ELEMENT_CHARAC_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_FREE_DATA" ("GCO_FREE_DATA_ID", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "GCO_GOOD_ID", "DATA_ALPHA_COURT_1", "DATA_ALPHA_COURT_2", "DATA_ALPHA_COURT_3", "DATA_ALPHA_COURT_4", "DATA_ALPHA_COURT_5", "DATA_ALPHA_LONG_1", "DATA_ALPHA_LONG_2", "DATA_ALPHA_LONG_3", "DATA_ALPHA_LONG_4", "DATA_ALPHA_LONG_5", "DATA_INTEGER_1", "DATA_INTEGER_2", "DATA_INTEGER_3", "DATA_INTEGER_4", "DATA_INTEGER_5", "DATA_BOOLEAN_1", "DATA_BOOLEAN_2", "DATA_BOOLEAN_3", "DATA_BOOLEAN_4", "DATA_BOOLEAN_5", "DATA_DEC_1", "DATA_DEC_2", "DATA_DEC_3", "DATA_DEC_4", "DATA_DEC_5", "DATA_UNIT_PRICE_SALE") AS
  select GCO_FREE_DATA_ID
       , Nvl(DIC_FREE_TABLE_1_ID, 'DWH_ISNULL') DIC_FREE_TABLE_1_ID
       , Nvl(DIC_FREE_TABLE_2_ID, 'DWH_ISNULL') DIC_FREE_TABLE_2_ID
       , Nvl(DIC_FREE_TABLE_3_ID, 'DWH_ISNULL') DIC_FREE_TABLE_3_ID
       , Nvl(DIC_FREE_TABLE_4_ID, 'DWH_ISNULL') DIC_FREE_TABLE_4_ID
       , Nvl(DIC_FREE_TABLE_5_ID, 'DWH_ISNULL') DIC_FREE_TABLE_5_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(DATA_ALPHA_COURT_1, '_') DATA_ALPHA_COURT_1
       , Nvl(DATA_ALPHA_COURT_2, '_') DATA_ALPHA_COURT_2
       , Nvl(DATA_ALPHA_COURT_3, '_') DATA_ALPHA_COURT_3
       , Nvl(DATA_ALPHA_COURT_4, '_') DATA_ALPHA_COURT_4
       , Nvl(DATA_ALPHA_COURT_5, '_') DATA_ALPHA_COURT_5
       , Nvl(DATA_ALPHA_LONG_1, '_') DATA_ALPHA_LONG_1
       , Nvl(DATA_ALPHA_LONG_2, '_') DATA_ALPHA_LONG_2
       , Nvl(DATA_ALPHA_LONG_3, '_') DATA_ALPHA_LONG_3
       , Nvl(DATA_ALPHA_LONG_4, '_') DATA_ALPHA_LONG_4
       , Nvl(DATA_ALPHA_LONG_5, '_') DATA_ALPHA_LONG_5
       , DATA_INTEGER_1
       , DATA_INTEGER_2
       , DATA_INTEGER_3
       , DATA_INTEGER_4
       , DATA_INTEGER_5
       , Nvl2(DATA_BOOLEAN_1, case
                when(DATA_BOOLEAN_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DATA_BOOLEAN_1
       , Nvl2(DATA_BOOLEAN_2, case
                when(DATA_BOOLEAN_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DATA_BOOLEAN_2
       , Nvl2(DATA_BOOLEAN_3, case
                when(DATA_BOOLEAN_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DATA_BOOLEAN_3
       , Nvl2(DATA_BOOLEAN_4, case
                when(DATA_BOOLEAN_4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DATA_BOOLEAN_4
       , Nvl2(DATA_BOOLEAN_5, case
                when(DATA_BOOLEAN_5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DATA_BOOLEAN_5
       , DATA_DEC_1
       , DATA_DEC_2
       , DATA_DEC_3
       , DATA_DEC_4
       , DATA_DEC_5
       , DATA_UNIT_PRICE_SALE
  from GCO_FREE_DATA
  union all
  select -1 GCO_FREE_DATA_ID
       , 'DWH_NA' DIC_FREE_TABLE_1_ID
       , 'DWH_NA' DIC_FREE_TABLE_2_ID
       , 'DWH_NA' DIC_FREE_TABLE_3_ID
       , 'DWH_NA' DIC_FREE_TABLE_4_ID
       , 'DWH_NA' DIC_FREE_TABLE_5_ID
       , -1 GCO_GOOD_ID
       , 'N/A' DATA_ALPHA_COURT_1
       , 'N/A' DATA_ALPHA_COURT_2
       , 'N/A' DATA_ALPHA_COURT_3
       , 'N/A' DATA_ALPHA_COURT_4
       , 'N/A' DATA_ALPHA_COURT_5
       , 'N/A' DATA_ALPHA_LONG_1
       , 'N/A' DATA_ALPHA_LONG_2
       , 'N/A' DATA_ALPHA_LONG_3
       , 'N/A' DATA_ALPHA_LONG_4
       , 'N/A' DATA_ALPHA_LONG_5
       , null DATA_INTEGER_1
       , null DATA_INTEGER_2
       , null DATA_INTEGER_3
       , null DATA_INTEGER_4
       , null DATA_INTEGER_5
       , '-1' DATA_BOOLEAN_1
       , '-1' DATA_BOOLEAN_2
       , '-1' DATA_BOOLEAN_3
       , '-1' DATA_BOOLEAN_4
       , '-1' DATA_BOOLEAN_5
       , null DATA_DEC_1
       , null DATA_DEC_2
       , null DATA_DEC_3
       , null DATA_DEC_4
       , null DATA_DEC_5
       , null DATA_UNIT_PRICE_SALE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_GOOD" ("GCO_GOOD_ID", "C_GOOD_STATUS", "GCO_SUBSTITUTION_LIST_ID", "DIC_UNIT_OF_MEASURE_ID", "DIC_ACCOUNTABLE_GROUP_ID", "GCO_MULTIMEDIA_ELEMENT_ID", "GCO_GOOD_CATEGORY_ID", "DIC_GOOD_LINE_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_MODEL_ID", "DIC_GOOD_GROUP_ID", "C_MANAGEMENT_MODE", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE", "GOO_CCP_MANAGEMENT", "GOO_NUMBER_OF_DECIMAL", "GCO_DATA_PURCHASE", "GCO_DATA_SALE", "GCO_DATA_STOCK", "GCO_DATA_INVENTORY", "GCO_DATA_MANUFACTURE", "GCO_DATA_SUBCONTRACT", "GCO_DATA_SAV", "GCO_GOOD_OLE_OBJECT", "DIC_PUR_TARIFF_STRUCT_ID", "DIC_SALE_TARIFF_STRUCT_ID", "DIC_COMMISSIONING_ID", "C_GOO_WEB_STATUS", "DIC_GOO_WEB_CATEG1_ID", "DIC_GOO_WEB_CATEG2_ID", "DIC_GOO_WEB_CATEG3_ID", "DIC_GOO_WEB_CATEG4_ID", "GOO_WEB_PUBLISHED", "GOO_WEB_ALIAS", "GOO_WEB_PICTURE_URL", "GOO_WEB_ATTACHEMENT_URL", "GOO_UNSPSC", "GOO_INNOVATION_FROM", "GOO_INNOVATION_TO", "GOO_STD_PERCENT_WASTE", "GOO_STD_FIXED_QUANTITY_WASTE", "GOO_STD_QTY_REFERENCE_LOSS", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GCO_STATISTIC_10_ID", "GOO_EAN_CODE_AUTO_GEN", "GCO_PRODUCT_GROUP_ID", "GOO_OBSOLETE", "GOO_PRECIOUS_MAT", "DIC_PTC_GOOD_GROUP_ID", "GOO_TO_PUBLISH", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "DIC_TARIFF_SET_SALE_ID", "DIC_TARIFF_SET_PURCHASE_ID", "GOO_VERSION1_ID", "GOO_STD_CHAR1_ID", "GOO_STD_CHAR2_ID", "GOO_STD_CHAR3_ID", "GOO_STD_CHAR4_ID", "GOO_STD_CHAR5_ID", "GOO_PIECE1_ID", "GOO_PIECE2_ID", "GOO_PIECE3_ID", "GOO_SET1_ID", "GOO_SET2_ID", "GOO_SET3_ID", "GOO_CHRONO1_ID", "DIC_SET_TYPE_ID", "C_SERVICE_KIND", "C_SERVICE_RENEWAL", "C_SERVICE_GOOD_LINK", "DIC_TARIFF_ID") AS
  select GCO_GOOD_ID
       , Nvl(C_GOOD_STATUS, 'DWH_ISNULL') C_GOOD_STATUS
       , Nvl(GCO_SUBSTITUTION_LIST_ID, -2) GCO_SUBSTITUTION_LIST_ID
       , Nvl(DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE_ID
       , Nvl(DIC_ACCOUNTABLE_GROUP_ID, 'DWH_ISNULL') DIC_ACCOUNTABLE_GROUP_ID
       , Nvl(GCO_MULTIMEDIA_ELEMENT_ID, -2) GCO_MULTIMEDIA_ELEMENT_ID
       , Nvl(GCO_GOOD_CATEGORY_ID, -2) GCO_GOOD_CATEGORY_ID
       , Nvl(DIC_GOOD_LINE_ID, 'DWH_ISNULL') DIC_GOOD_LINE_ID
       , Nvl(DIC_GOOD_FAMILY_ID, 'DWH_ISNULL') DIC_GOOD_FAMILY_ID
       , Nvl(DIC_GOOD_MODEL_ID, 'DWH_ISNULL') DIC_GOOD_MODEL_ID
       , Nvl(DIC_GOOD_GROUP_ID, 'DWH_ISNULL') DIC_GOOD_GROUP_ID
       , Nvl(C_MANAGEMENT_MODE, 'DWH_ISNULL') C_MANAGEMENT_MODE
       , Nvl(GOO_MAJOR_REFERENCE, '_') GOO_MAJOR_REFERENCE
       , Nvl(GOO_SECONDARY_REFERENCE, '_') GOO_SECONDARY_REFERENCE
       , Nvl(GOO_EAN_CODE, '_') GOO_EAN_CODE
       , Nvl2(GOO_CCP_MANAGEMENT, case
                when(GOO_CCP_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GOO_CCP_MANAGEMENT
       , GOO_NUMBER_OF_DECIMAL
       , Nvl2(GCO_DATA_PURCHASE, case
                when(GCO_DATA_PURCHASE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_PURCHASE
       , Nvl2(GCO_DATA_SALE, case
                when(GCO_DATA_SALE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_SALE
       , Nvl2(GCO_DATA_STOCK, case
                when(GCO_DATA_STOCK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_STOCK
       , Nvl2(GCO_DATA_INVENTORY, case
                when(GCO_DATA_INVENTORY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_INVENTORY
       , Nvl2(GCO_DATA_MANUFACTURE, case
                when(GCO_DATA_MANUFACTURE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_MANUFACTURE
       , Nvl2(GCO_DATA_SUBCONTRACT, case
                when(GCO_DATA_SUBCONTRACT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_SUBCONTRACT
       , Nvl2(GCO_DATA_SAV, case
                when(GCO_DATA_SAV = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GCO_DATA_SAV
       , Nvl(GCO_GOOD_OLE_OBJECT, '_') GCO_GOOD_OLE_OBJECT
       , Nvl(DIC_PUR_TARIFF_STRUCT_ID, 'DWH_ISNULL') DIC_PUR_TARIFF_STRUCT_ID
       , Nvl(DIC_SALE_TARIFF_STRUCT_ID, 'DWH_ISNULL') DIC_SALE_TARIFF_STRUCT_ID
       , Nvl(DIC_COMMISSIONING_ID, 'DWH_ISNULL') DIC_COMMISSIONING_ID
       , Nvl(C_GOO_WEB_STATUS, 'DWH_ISNULL') C_GOO_WEB_STATUS
       , Nvl(DIC_GOO_WEB_CATEG1_ID, 'DWH_ISNULL') DIC_GOO_WEB_CATEG1_ID
       , Nvl(DIC_GOO_WEB_CATEG2_ID, 'DWH_ISNULL') DIC_GOO_WEB_CATEG2_ID
       , Nvl(DIC_GOO_WEB_CATEG3_ID, 'DWH_ISNULL') DIC_GOO_WEB_CATEG3_ID
       , Nvl(DIC_GOO_WEB_CATEG4_ID, 'DWH_ISNULL') DIC_GOO_WEB_CATEG4_ID
       , Nvl2(GOO_WEB_PUBLISHED, case
                when(GOO_WEB_PUBLISHED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GOO_WEB_PUBLISHED
       , Nvl(GOO_WEB_ALIAS, '_') GOO_WEB_ALIAS
       , Nvl(GOO_WEB_PICTURE_URL, '_') GOO_WEB_PICTURE_URL
       , Nvl(GOO_WEB_ATTACHEMENT_URL, '_') GOO_WEB_ATTACHEMENT_URL
       , Nvl(GOO_UNSPSC, '_') GOO_UNSPSC
       , Nvl(GOO_INNOVATION_FROM, to_date('40000101', 'YYYYMMDD') ) GOO_INNOVATION_FROM
       , Nvl(GOO_INNOVATION_TO, to_date('40000101', 'YYYYMMDD') ) GOO_INNOVATION_TO
       , GOO_STD_PERCENT_WASTE
       , GOO_STD_FIXED_QUANTITY_WASTE
       , GOO_STD_QTY_REFERENCE_LOSS
       , Nvl(DIC_GCO_STATISTIC_1_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_1_ID
       , Nvl(DIC_GCO_STATISTIC_2_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_2_ID
       , Nvl(DIC_GCO_STATISTIC_3_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_3_ID
       , Nvl(DIC_GCO_STATISTIC_4_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_4_ID
       , Nvl(DIC_GCO_STATISTIC_5_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_5_ID
       , Nvl(DIC_GCO_STATISTIC_6_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_6_ID
       , Nvl(DIC_GCO_STATISTIC_7_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_7_ID
       , Nvl(DIC_GCO_STATISTIC_8_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_8_ID
       , Nvl(DIC_GCO_STATISTIC_9_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_9_ID
       , Nvl(DIC_GCO_STATISTIC_10_ID, 'DWH_ISNULL') DIC_GCO_STATISTIC_10_ID
       , Nvl2(GOO_EAN_CODE_AUTO_GEN, case
                when(GOO_EAN_CODE_AUTO_GEN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GOO_EAN_CODE_AUTO_GEN
       , Nvl(GCO_PRODUCT_GROUP_ID, -2) GCO_PRODUCT_GROUP_ID
       , Nvl2(GOO_OBSOLETE, case
                when(GOO_OBSOLETE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GOO_OBSOLETE
       , Nvl2(GOO_PRECIOUS_MAT, case
                when(GOO_PRECIOUS_MAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GOO_PRECIOUS_MAT
       , Nvl(DIC_PTC_GOOD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_GOOD_GROUP_ID
       , Nvl2(GOO_TO_PUBLISH, case
                when(GOO_TO_PUBLISH = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') GOO_TO_PUBLISH
       , Nvl(GOO_HIBC_PRIMARY_CODE, '_') GOO_HIBC_PRIMARY_CODE
       , Nvl(GOO_HIBC_REFERENCE, '_') GOO_HIBC_REFERENCE
       , Nvl(GOO_EAN_UCC14_CODE, '_') GOO_EAN_UCC14_CODE
       , Nvl(DIC_TARIFF_SET_SALE_ID, 'DWH_ISNULL') DIC_TARIFF_SET_SALE_ID
       , Nvl(DIC_TARIFF_SET_PURCHASE_ID, 'DWH_ISNULL') DIC_TARIFF_SET_PURCHASE_ID
       , Nvl(GOO_VERSION1_ID, -2) GOO_VERSION1_ID
       , Nvl(GOO_STD_CHAR1_ID, -2) GOO_STD_CHAR1_ID
       , Nvl(GOO_STD_CHAR2_ID, -2) GOO_STD_CHAR2_ID
       , Nvl(GOO_STD_CHAR3_ID, -2) GOO_STD_CHAR3_ID
       , Nvl(GOO_STD_CHAR4_ID, -2) GOO_STD_CHAR4_ID
       , Nvl(GOO_STD_CHAR5_ID, -2) GOO_STD_CHAR5_ID
       , Nvl(GOO_PIECE1_ID, -2) GOO_PIECE1_ID
       , Nvl(GOO_PIECE2_ID, -2) GOO_PIECE2_ID
       , Nvl(GOO_PIECE3_ID, -2) GOO_PIECE3_ID
       , Nvl(GOO_SET1_ID, -2) GOO_SET1_ID
       , Nvl(GOO_SET2_ID, -2) GOO_SET2_ID
       , Nvl(GOO_SET3_ID, -2) GOO_SET3_ID
       , Nvl(GOO_CHRONO1_ID, -2) GOO_CHRONO1_ID
       , Nvl(DIC_SET_TYPE_ID, 'DWH_ISNULL') DIC_SET_TYPE_ID
       , Nvl(C_SERVICE_KIND, 'DWH_ISNULL') C_SERVICE_KIND
       , Nvl(C_SERVICE_RENEWAL, 'DWH_ISNULL') C_SERVICE_RENEWAL
       , Nvl(C_SERVICE_GOOD_LINK, 'DWH_ISNULL') C_SERVICE_GOOD_LINK
       , Nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       -- GOO_CONTRACT_CONDITION cannot be used with CLOB
  from GCO_GOOD
  union all
  select -1 GCO_GOOD_ID
       , 'DWH_NA' C_GOOD_STATUS
       , -1 GCO_SUBSTITUTION_LIST_ID
       , 'DWH_NA' DIC_UNIT_OF_MEASURE_ID
       , 'DWH_NA' DIC_ACCOUNTABLE_GROUP_ID
       , -1 GCO_MULTIMEDIA_ELEMENT_ID
       , -1 GCO_GOOD_CATEGORY_ID
       , 'DWH_NA' DIC_GOOD_LINE_ID
       , 'DWH_NA' DIC_GOOD_FAMILY_ID
       , 'DWH_NA' DIC_GOOD_MODEL_ID
       , 'DWH_NA' DIC_GOOD_GROUP_ID
       , 'DWH_NA' C_MANAGEMENT_MODE
       , 'N/A' GOO_MAJOR_REFERENCE
       , 'N/A' GOO_SECONDARY_REFERENCE
       , 'N/A' GOO_EAN_CODE
       , '-1' GOO_CCP_MANAGEMENT
       , null GOO_NUMBER_OF_DECIMAL
       , '-1' GCO_DATA_PURCHASE
       , '-1' GCO_DATA_SALE
       , '-1' GCO_DATA_STOCK
       , '-1' GCO_DATA_INVENTORY
       , '-1' GCO_DATA_MANUFACTURE
       , '-1' GCO_DATA_SUBCONTRACT
       , '-1' GCO_DATA_SAV
       , 'N/A' GCO_GOOD_OLE_OBJECT
       , 'DWH_NA' DIC_PUR_TARIFF_STRUCT_ID
       , 'DWH_NA' DIC_SALE_TARIFF_STRUCT_ID
       , 'DWH_NA' DIC_COMMISSIONING_ID
       , 'DWH_NA' C_GOO_WEB_STATUS
       , 'DWH_NA' DIC_GOO_WEB_CATEG1_ID
       , 'DWH_NA' DIC_GOO_WEB_CATEG2_ID
       , 'DWH_NA' DIC_GOO_WEB_CATEG3_ID
       , 'DWH_NA' DIC_GOO_WEB_CATEG4_ID
       , '-1' GOO_WEB_PUBLISHED
       , 'N/A' GOO_WEB_ALIAS
       , 'N/A' GOO_WEB_PICTURE_URL
       , 'N/A' GOO_WEB_ATTACHEMENT_URL
       , 'N/A' GOO_UNSPSC
       , to_date('00010101', 'YYYYMMDD') GOO_INNOVATION_FROM
       , to_date('00010101', 'YYYYMMDD') GOO_INNOVATION_TO
       , null GOO_STD_PERCENT_WASTE
       , null GOO_STD_FIXED_QUANTITY_WASTE
       , null GOO_STD_QTY_REFERENCE_LOSS
       , 'DWH_NA' DIC_GCO_STATISTIC_1_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_2_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_3_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_4_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_5_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_6_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_7_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_8_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_9_ID
       , 'DWH_NA' DIC_GCO_STATISTIC_10_ID
       , '-1' GOO_EAN_CODE_AUTO_GEN
       , -1 GCO_PRODUCT_GROUP_ID
       , '-1' GOO_OBSOLETE
       , '-1' GOO_PRECIOUS_MAT
       , 'DWH_NA' DIC_PTC_GOOD_GROUP_ID
       , '-1' GOO_TO_PUBLISH
       , 'N/A' GOO_HIBC_PRIMARY_CODE
       , 'N/A' GOO_HIBC_REFERENCE
       , 'N/A' GOO_EAN_UCC14_CODE
       , 'DWH_NA' DIC_TARIFF_SET_SALE_ID
       , 'DWH_NA' DIC_TARIFF_SET_PURCHASE_ID
       , -1 GOO_VERSION1_ID
       , -1 GOO_STD_CHAR1_ID
       , -1 GOO_STD_CHAR2_ID
       , -1 GOO_STD_CHAR3_ID
       , -1 GOO_STD_CHAR4_ID
       , -1 GOO_STD_CHAR5_ID
       , -1 GOO_PIECE1_ID
       , -1 GOO_PIECE2_ID
       , -1 GOO_PIECE3_ID
       , -1 GOO_SET1_ID
       , -1 GOO_SET2_ID
       , -1 GOO_SET3_ID
       , -1 GOO_CHRONO1_ID
       , 'DWH_NA' DIC_SET_TYPE_ID
       , 'DWH_NA' C_SERVICE_KIND
       , 'DWH_NA' C_SERVICE_RENEWAL
       , 'DWH_NA' C_SERVICE_GOOD_LINK
       , 'DWH_NA' DIC_TARIFF_ID
       -- GOO_CONTRACT_CONDITION cannot be used with CLOB
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_GOOD_CATEGOR_DESCR" ("GCO_GOOD_CATEGORY_DESCR_ID", "PC_LANG_ID", "GCO_GOOD_CATEGORY_ID", "GCD_WORDING", "GCD_FREE_DESCRIPTION") AS
  select GCO_GOOD_CATEGORY_DESCR_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(GCO_GOOD_CATEGORY_ID, -2) GCO_GOOD_CATEGORY_ID
       , Nvl(GCD_WORDING, '_') GCD_WORDING
       , Nvl(GCD_FREE_DESCRIPTION, '_') GCD_FREE_DESCRIPTION
  from GCO_GOOD_CATEGORY_DESCR
  union all
  select -1 GCO_GOOD_CATEGORY_DESCR_ID
       , -1 PC_LANG_ID
       , -1 GCO_GOOD_CATEGORY_ID
       , 'N/A' GCD_WORDING
       , 'N/A' GCD_FREE_DESCRIPTION
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_PRODUCT" ("GCO_GOOD_ID", "GCO_GCO_SERVICE_ID", "GCO2_GCO_GOOD_ID", "C_PRODUCT_TYPE", "C_SUPPLY_MODE", "C_PRODUCT_DELIVERY_TYP", "STM_LOCATION_ID", "STM_STOCK_ID", "PAC_SUPPLIER_PARTNER_ID", "GCO_DANGEROUS_TRANSP_ADR_ID", "GCO_DANGEROUS_TRANSP_IATA_ID", "GCO_DANGEROUS_TRANSP_IMDG_ID", "DIC_UNIT_OF_MEASURE_ID", "DIC_UNIT_OF_MEASURE1_ID", "DIC_UNIT_OF_MEASURE2_ID", "DIC_DEL_TYP_EXPLAIN_ID", "PDT_STOCK_MANAGEMENT", "PDT_THRESHOLD_MANAGEMENT", "PDT_STOCK_OBTAIN_MANAGEMENT", "PDT_CALC_REQUIREMENT_MNGMENT", "PDT_CONTINUOUS_INVENTAR", "PDT_FULL_TRACABILITY", "PDT_ALTERNATIVE_QUANTITY_1", "PDT_ALTERNATIVE_QUANTITY_2", "PDT_ALTERNATIVE_QUANTITY_3", "PDT_CONVERSION_FACTOR_1", "PDT_CONVERSION_FACTOR_2", "PDT_CONVERSION_FACTOR_3", "PDT_PIC", "PDT_FACT_STOCK", "PDT_BLOCK_EQUI", "PDT_GUARANTY_USE", "PDT_END_LIFE", "PDT_MARK_NOMENCLATURE", "PDT_MARK_USED", "PDT_STOCK_ALLOC_BATCH", "PDT_SCALE_LINK", "PDT_FULL_TRACABILITY_COEF", "PDT_FULL_TRACABILITY_SUPPLY", "PDT_FULL_TRACABILITY_RULE", "C_SUPPLY_TYPE", "PDT_MULTI_SOURCING") AS
  select Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(GCO_GCO_SERVICE_ID, -2) GCO_GCO_SERVICE_ID
       , Nvl(GCO2_GCO_GOOD_ID, -2) GCO2_GCO_GOOD_ID
       , Nvl(C_PRODUCT_TYPE, 'DWH_ISNULL') C_PRODUCT_TYPE
       , Nvl(C_SUPPLY_MODE, 'DWH_ISNULL') C_SUPPLY_MODE
       , Nvl(C_PRODUCT_DELIVERY_TYP, 'DWH_ISNULL') C_PRODUCT_DELIVERY_TYP
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , Nvl(GCO_DANGEROUS_TRANSP_ADR_ID, -2) GCO_DANGEROUS_TRANSP_ADR_ID
       , Nvl(GCO_DANGEROUS_TRANSP_IATA_ID, -2) GCO_DANGEROUS_TRANSP_IATA_ID
       , Nvl(GCO_DANGEROUS_TRANSP_IMDG_ID, -2) GCO_DANGEROUS_TRANSP_IMDG_ID
       , Nvl(DIC_UNIT_OF_MEASURE_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE_ID
       , Nvl(DIC_UNIT_OF_MEASURE1_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE1_ID
       , Nvl(DIC_UNIT_OF_MEASURE2_ID, 'DWH_ISNULL') DIC_UNIT_OF_MEASURE2_ID
       , Nvl(DIC_DEL_TYP_EXPLAIN_ID, 'DWH_ISNULL') DIC_DEL_TYP_EXPLAIN_ID
       , Nvl2(PDT_STOCK_MANAGEMENT, case
                when(PDT_STOCK_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_STOCK_MANAGEMENT
       , Nvl2(PDT_THRESHOLD_MANAGEMENT, case
                when(PDT_THRESHOLD_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_THRESHOLD_MANAGEMENT
       , Nvl2(PDT_STOCK_OBTAIN_MANAGEMENT, case
                when(PDT_STOCK_OBTAIN_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_STOCK_OBTAIN_MANAGEMENT
       , Nvl2(PDT_CALC_REQUIREMENT_MNGMENT, case
                when(PDT_CALC_REQUIREMENT_MNGMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_CALC_REQUIREMENT_MNGMENT
       , Nvl2(PDT_CONTINUOUS_INVENTAR, case
                when(PDT_CONTINUOUS_INVENTAR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_CONTINUOUS_INVENTAR
       , Nvl2(PDT_FULL_TRACABILITY, case
                when(PDT_FULL_TRACABILITY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_FULL_TRACABILITY
       , Nvl2(PDT_ALTERNATIVE_QUANTITY_1, case
                when(PDT_ALTERNATIVE_QUANTITY_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_ALTERNATIVE_QUANTITY_1
       , Nvl2(PDT_ALTERNATIVE_QUANTITY_2, case
                when(PDT_ALTERNATIVE_QUANTITY_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_ALTERNATIVE_QUANTITY_2
       , Nvl2(PDT_ALTERNATIVE_QUANTITY_3, case
                when(PDT_ALTERNATIVE_QUANTITY_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_ALTERNATIVE_QUANTITY_3
       , PDT_CONVERSION_FACTOR_1
       , PDT_CONVERSION_FACTOR_2
       , PDT_CONVERSION_FACTOR_3
       , Nvl2(PDT_PIC, case
                when(PDT_PIC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_PIC
       , PDT_FACT_STOCK
       , Nvl2(PDT_BLOCK_EQUI, case
                when(PDT_BLOCK_EQUI = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_BLOCK_EQUI
       , Nvl2(PDT_GUARANTY_USE, case
                when(PDT_GUARANTY_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_GUARANTY_USE
       , Nvl2(PDT_END_LIFE, case
                when(PDT_END_LIFE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_END_LIFE
       , Nvl2(PDT_MARK_NOMENCLATURE, case
                when(PDT_MARK_NOMENCLATURE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_MARK_NOMENCLATURE
       , Nvl2(PDT_MARK_USED, case
                when(PDT_MARK_USED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_MARK_USED
       , Nvl2(PDT_STOCK_ALLOC_BATCH, case
                when(PDT_STOCK_ALLOC_BATCH = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_STOCK_ALLOC_BATCH
       , PDT_SCALE_LINK
       , PDT_FULL_TRACABILITY_COEF
       , Nvl2(PDT_FULL_TRACABILITY_SUPPLY, case
                when(PDT_FULL_TRACABILITY_SUPPLY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_FULL_TRACABILITY_SUPPLY
       , Nvl2(PDT_FULL_TRACABILITY_RULE, case
                when(PDT_FULL_TRACABILITY_RULE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_FULL_TRACABILITY_RULE
       , Nvl(C_SUPPLY_TYPE, 'DWH_ISNULL') C_SUPPLY_TYPE
       , Nvl2(PDT_MULTI_SOURCING, case
                when(PDT_MULTI_SOURCING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDT_MULTI_SOURCING
  from GCO_PRODUCT
  union all
  select -1 GCO_GOOD_ID
       , -1 GCO_GCO_SERVICE_ID
       , -1 GCO2_GCO_GOOD_ID
       , 'DWH_NA' C_PRODUCT_TYPE
       , 'DWH_NA' C_SUPPLY_MODE
       , 'DWH_NA' C_PRODUCT_DELIVERY_TYP
       , -1 STM_LOCATION_ID
       , -1 STM_STOCK_ID
       , -1 PAC_SUPPLIER_PARTNER_ID
       , -1 GCO_DANGEROUS_TRANSP_ADR_ID
       , -1 GCO_DANGEROUS_TRANSP_IATA_ID
       , -1 GCO_DANGEROUS_TRANSP_IMDG_ID
       , 'DWH_NA' DIC_UNIT_OF_MEASURE_ID
       , 'DWH_NA' DIC_UNIT_OF_MEASURE1_ID
       , 'DWH_NA' DIC_UNIT_OF_MEASURE2_ID
       , 'DWH_NA' DIC_DEL_TYP_EXPLAIN_ID
       , '-1' PDT_STOCK_MANAGEMENT
       , '-1' PDT_THRESHOLD_MANAGEMENT
       , '-1' PDT_STOCK_OBTAIN_MANAGEMENT
       , '-1' PDT_CALC_REQUIREMENT_MNGMENT
       , '-1' PDT_CONTINUOUS_INVENTAR
       , '-1' PDT_FULL_TRACABILITY
       , '-1' PDT_ALTERNATIVE_QUANTITY_1
       , '-1' PDT_ALTERNATIVE_QUANTITY_2
       , '-1' PDT_ALTERNATIVE_QUANTITY_3
       , null PDT_CONVERSION_FACTOR_1
       , null PDT_CONVERSION_FACTOR_2
       , null PDT_CONVERSION_FACTOR_3
       , '-1' PDT_PIC
       , null PDT_FACT_STOCK
       , '-1' PDT_BLOCK_EQUI
       , '-1' PDT_GUARANTY_USE
       , '-1' PDT_END_LIFE
       , '-1' PDT_MARK_NOMENCLATURE
       , '-1' PDT_MARK_USED
       , '-1' PDT_STOCK_ALLOC_BATCH
       , null PDT_SCALE_LINK
       , null PDT_FULL_TRACABILITY_COEF
       , '-1' PDT_FULL_TRACABILITY_SUPPLY
       , '-1' PDT_FULL_TRACABILITY_RULE
       , 'DWH_NA' C_SUPPLY_TYPE
       , '-1' PDT_MULTI_SOURCING
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_PRODUCT_GROUP" ("GCO_PRODUCT_GROUP_ID", "PRG_NAME", "PRG_MAX_DISCOUNT", "DIC_GCO_LEVEL_A_ID", "DIC_GCO_LEVEL_B_ID", "DIC_GCO_LEVEL_C_ID", "DIC_GCO_LEVEL_D_ID", "DIC_GCO_LEVEL_E_ID", "DIC_GCO_MANAGER_ID", "DIC_GCO_STICKER_FORMAT_ID", "DIC_GCO_STICKER_COLOR_ID", "DIC_GCO_STORAGE_ID", "DIC_GCO_DOCUMENT_ID", "PRG_DESCRIPTION", "PTC_TARIFF_CATEGORY_ID", "DIC_PRG_FREE_TABLE_1_ID", "DIC_PRG_FREE_TABLE_3_ID", "DIC_PRG_FREE_TABLE_4_ID", "DIC_PRG_FREE_TABLE_5_ID", "PRG_FREE_NUMBER_1", "PRG_FREE_NUMBER_2", "PRG_FREE_NUMBER_3", "PRG_FREE_NUMBER_4", "PRG_FREE_NUMBER_5", "PRG_FREE_ALPHA_1", "PRG_FREE_ALPHA_2", "PRG_FREE_ALPHA_3", "PRG_FREE_ALPHA_4", "PRG_FREE_ALPHA_5", "DIC_PRG_FREE_TABLE_2_ID") AS
  select GCO_PRODUCT_GROUP_ID
       , Nvl(PRG_NAME, '_') PRG_NAME
       , PRG_MAX_DISCOUNT
       , Nvl(DIC_GCO_LEVEL_A_ID, 'DWH_ISNULL') DIC_GCO_LEVEL_A_ID
       , Nvl(DIC_GCO_LEVEL_B_ID, 'DWH_ISNULL') DIC_GCO_LEVEL_B_ID
       , Nvl(DIC_GCO_LEVEL_C_ID, 'DWH_ISNULL') DIC_GCO_LEVEL_C_ID
       , Nvl(DIC_GCO_LEVEL_D_ID, 'DWH_ISNULL') DIC_GCO_LEVEL_D_ID
       , Nvl(DIC_GCO_LEVEL_E_ID, 'DWH_ISNULL') DIC_GCO_LEVEL_E_ID
       , Nvl(DIC_GCO_MANAGER_ID, 'DWH_ISNULL') DIC_GCO_MANAGER_ID
       , Nvl(DIC_GCO_STICKER_FORMAT_ID, 'DWH_ISNULL') DIC_GCO_STICKER_FORMAT_ID
       , Nvl(DIC_GCO_STICKER_COLOR_ID, 'DWH_ISNULL') DIC_GCO_STICKER_COLOR_ID
       , Nvl(DIC_GCO_STORAGE_ID, 'DWH_ISNULL') DIC_GCO_STORAGE_ID
       , Nvl(DIC_GCO_DOCUMENT_ID, 'DWH_ISNULL') DIC_GCO_DOCUMENT_ID
       , Nvl(PRG_DESCRIPTION, '_') PRG_DESCRIPTION
       , Nvl(PTC_TARIFF_CATEGORY_ID, -2) PTC_TARIFF_CATEGORY_ID
       , Nvl(DIC_PRG_FREE_TABLE_1_ID, 'DWH_ISNULL') DIC_PRG_FREE_TABLE_1_ID
       , Nvl(DIC_PRG_FREE_TABLE_3_ID, 'DWH_ISNULL') DIC_PRG_FREE_TABLE_3_ID
       , Nvl(DIC_PRG_FREE_TABLE_4_ID, 'DWH_ISNULL') DIC_PRG_FREE_TABLE_4_ID
       , Nvl(DIC_PRG_FREE_TABLE_5_ID, 'DWH_ISNULL') DIC_PRG_FREE_TABLE_5_ID
       , PRG_FREE_NUMBER_1
       , PRG_FREE_NUMBER_2
       , PRG_FREE_NUMBER_3
       , PRG_FREE_NUMBER_4
       , PRG_FREE_NUMBER_5
       , Nvl(PRG_FREE_ALPHA_1, '_') PRG_FREE_ALPHA_1
       , Nvl(PRG_FREE_ALPHA_2, '_') PRG_FREE_ALPHA_2
       , Nvl(PRG_FREE_ALPHA_3, '_') PRG_FREE_ALPHA_3
       , Nvl(PRG_FREE_ALPHA_4, '_') PRG_FREE_ALPHA_4
       , Nvl(PRG_FREE_ALPHA_5, '_') PRG_FREE_ALPHA_5
       , Nvl(DIC_PRG_FREE_TABLE_2_ID, 'DWH_ISNULL') DIC_PRG_FREE_TABLE_2_ID
  from GCO_PRODUCT_GROUP
  union all
  select -1 GCO_PRODUCT_GROUP_ID
       , 'N/A' PRG_NAME
       , null PRG_MAX_DISCOUNT
       , 'DWH_NA' DIC_GCO_LEVEL_A_ID
       , 'DWH_NA' DIC_GCO_LEVEL_B_ID
       , 'DWH_NA' DIC_GCO_LEVEL_C_ID
       , 'DWH_NA' DIC_GCO_LEVEL_D_ID
       , 'DWH_NA' DIC_GCO_LEVEL_E_ID
       , 'DWH_NA' DIC_GCO_MANAGER_ID
       , 'DWH_NA' DIC_GCO_STICKER_FORMAT_ID
       , 'DWH_NA' DIC_GCO_STICKER_COLOR_ID
       , 'DWH_NA' DIC_GCO_STORAGE_ID
       , 'DWH_NA' DIC_GCO_DOCUMENT_ID
       , 'N/A' PRG_DESCRIPTION
       , -1 PTC_TARIFF_CATEGORY_ID
       , 'DWH_NA' DIC_PRG_FREE_TABLE_1_ID
       , 'DWH_NA' DIC_PRG_FREE_TABLE_3_ID
       , 'DWH_NA' DIC_PRG_FREE_TABLE_4_ID
       , 'DWH_NA' DIC_PRG_FREE_TABLE_5_ID
       , null PRG_FREE_NUMBER_1
       , null PRG_FREE_NUMBER_2
       , null PRG_FREE_NUMBER_3
       , null PRG_FREE_NUMBER_4
       , null PRG_FREE_NUMBER_5
       , 'N/A' PRG_FREE_ALPHA_1
       , 'N/A' PRG_FREE_ALPHA_2
       , 'N/A' PRG_FREE_ALPHA_3
       , 'N/A' PRG_FREE_ALPHA_4
       , 'N/A' PRG_FREE_ALPHA_5
       , 'DWH_NA' DIC_PRG_FREE_TABLE_2_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_QUALITY_PRINCIPLE" ("GCO_QUALITY_PRINCIPLE_ID", "QPR_QUALITY_PRINCIPLE_DESIGN", "QPR_STANDARD_REFERENCE", "QPR_STANDARD_DESCRIPTION", "QPR_TESTING_PLAN_REFERENCE") AS
  select GCO_QUALITY_PRINCIPLE_ID
       , Nvl(QPR_QUALITY_PRINCIPLE_DESIGN, '_') QPR_QUALITY_PRINCIPLE_DESIGN
       , Nvl(QPR_STANDARD_REFERENCE, '_') QPR_STANDARD_REFERENCE
       , Nvl(QPR_STANDARD_DESCRIPTION, '_') QPR_STANDARD_DESCRIPTION
       , Nvl(QPR_TESTING_PLAN_REFERENCE, '_') QPR_TESTING_PLAN_REFERENCE
  from GCO_QUALITY_PRINCIPLE
  union all
  select -1 GCO_QUALITY_PRINCIPLE_ID
       , 'N/A' QPR_QUALITY_PRINCIPLE_DESIGN
       , 'N/A' QPR_STANDARD_REFERENCE
       , 'N/A' QPR_STANDARD_DESCRIPTION
       , 'N/A' QPR_TESTING_PLAN_REFERENCE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_GCO_SERVICE" ("GCO_GOOD_ID") AS
  select Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
  from GCO_SERVICE
  union all
  select -1 GCO_GOOD_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_CODE_DIC" ("HRM_CODE_DIC_ID", "DIC_DESCR", "DIC_FORMAT") AS
  select HRM_CODE_DIC_ID
       , Nvl(DIC_DESCR, '_') DIC_DESCR
       , Nvl2(DIC_FORMAT, case
                when(DIC_FORMAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DIC_FORMAT
  from HRM_CODE_DIC
  union all
  select -1 HRM_CODE_DIC_ID
       , 'N/A' DIC_DESCR
       , '-1' DIC_FORMAT
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_COUNTRY" ("CNT_CODE", "CNT_NAME", "CNT_POSTAL_CODE") AS
  select Nvl(CNT_CODE, '_') CNT_CODE
       , Nvl(CNT_NAME, '_') CNT_NAME
       , Nvl(CNT_POSTAL_CODE, '_') CNT_POSTAL_CODE
  from HRM_COUNTRY
  union all
  select 'N/A' CNT_CODE
       , 'N/A' CNT_NAME
       , 'N/A' CNT_POSTAL_CODE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_DIVISION" ("HRM_DIVISION_ID", "DIV_DESCR", "DIV_COMMENT", "HRM_COMPANY_ID", "HRM_IN_CHARGE_ID", "DIC_DEPARTMENT_ID", "HRM_DIV_SUPERIOR_ID", "DIC_DIVISION_TYPE_ID") AS
  select HRM_DIVISION_ID
       , Nvl(DIV_DESCR, '_') DIV_DESCR
       , Nvl(DIV_COMMENT, '_') DIV_COMMENT
       , Nvl(HRM_COMPANY_ID, -2) HRM_COMPANY_ID
       , Nvl(HRM_IN_CHARGE_ID, -2) HRM_IN_CHARGE_ID
       , Nvl(DIC_DEPARTMENT_ID, 'DWH_ISNULL') DIC_DEPARTMENT_ID
       , Nvl(HRM_DIV_SUPERIOR_ID, -2) HRM_DIV_SUPERIOR_ID
       , Nvl(DIC_DIVISION_TYPE_ID, 'DWH_ISNULL') DIC_DIVISION_TYPE_ID
  from HRM_DIVISION
  union all
  select -1 HRM_DIVISION_ID
       , 'N/A' DIV_DESCR
       , 'N/A' DIV_COMMENT
       , -1 HRM_COMPANY_ID
       , -1 HRM_IN_CHARGE_ID
       , 'DWH_NA' DIC_DEPARTMENT_ID
       , -1 HRM_DIV_SUPERIOR_ID
       , 'DWH_NA' DIC_DIVISION_TYPE_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_ELEMENTS_FAMILY" ("HRM_ELEMENTS_ROOT_ID", "HRM_ELEMENTS_PREFIXES_ID", "HRM_ELEMENTS_SUFFIXES_ID", "ELF_EXPRESSION", "ELF_SQL", "HRM_ELEMENTS_ID", "ELF_IS_REFERENCE", "ELF_PRIORITY", "HRM_BREAK_GROUP_ID", "ELF_AGREG") AS
  select Nvl(HRM_ELEMENTS_ROOT_ID, -2) HRM_ELEMENTS_ROOT_ID
       , Nvl(HRM_ELEMENTS_PREFIXES_ID, '_') HRM_ELEMENTS_PREFIXES_ID
       , Nvl(HRM_ELEMENTS_SUFFIXES_ID, '_') HRM_ELEMENTS_SUFFIXES_ID
       , Nvl(to_char(ELF_EXPRESSION), '_') ELF_EXPRESSION
       , Nvl(ELF_SQL, '_') ELF_SQL
       , Nvl(HRM_ELEMENTS_ID, -2) HRM_ELEMENTS_ID
       , Nvl2(ELF_IS_REFERENCE, case
                when(ELF_IS_REFERENCE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELF_IS_REFERENCE
       , Nvl2(ELF_PRIORITY, case
                when(ELF_PRIORITY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELF_PRIORITY
       , Nvl(HRM_BREAK_GROUP_ID, -2) HRM_BREAK_GROUP_ID
       , Nvl2(ELF_AGREG, case
                when(ELF_AGREG = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELF_AGREG
  from HRM_ELEMENTS_FAMILY
  union all
  select -1 HRM_ELEMENTS_ROOT_ID
       , 'N/A' HRM_ELEMENTS_PREFIXES_ID
       , 'N/A' HRM_ELEMENTS_SUFFIXES_ID
       , 'N/A' ELF_EXPRESSION
       , 'N/A' ELF_SQL
       , -1 HRM_ELEMENTS_ID
       , '-1' ELF_IS_REFERENCE
       , '-1' ELF_PRIORITY
       , -1 HRM_BREAK_GROUP_ID
       , '-1' ELF_AGREG
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_ELEMENTS_ROOT" ("HRM_ELEMENTS_ROOT_ID", "ELR_ROOT_CODE", "ELR_ROOT_NAME", "ELR_FROM", "ELR_TO", "C_ROOT_TYPE", "C_ROOT_VARIANT", "ELR_USES_SUMS", "ELR_USES_FEEDBACK", "ELR_USES_CONSTENT", "C_HRM_SAL_CONST_TYPE", "ELR_IS_ACTIVE", "ELR_ROUND", "ELR_FORMAT", "ELR_SIGN", "ELR_DEFAULT_VALUE", "ELR_CODE_DIC", "ELR_IS_INDIV", "ELR_REPORTING", "ELR_IS_MANDATORY", "DIC_GROUP1_ID", "DIC_GROUP2_ID", "DIC_GROUP3_ID", "DIC_GROUP4_ID", "ELR_MULTI_CURRENCY", "ELR_CURRENCY", "HRM_CODE_DIC_ID", "ELR_SUMS_USED", "HRM_ELEMENTS_ID", "ELR_CONDITION", "ELR_IS_PRINT", "ELR_BASE_AMOUNT", "ELR_RATE", "ELR_PER_RATE", "ACS_FINANCIAL_CURRENCY_ID", "ELR_INPUT_TYPE", "ELR_IS_BASE_COND", "ELR_BASE_COND_ID", "ELR_BASE_COND_CODE", "ELR_IS_BREAK", "ELR_SWAP_DC", "ELR_USE_RATIO_GROUP", "ELR_IS_BREAK_DEBIT", "ELR_IS_BREAK_CREDIT", "ELR_D_CGBASE", "ELR_D_CG_SHIFT_ID", "ELR_D_IS_BREAK_DIV", "ELR_IS_BREAK_INVERSE", "ELR_D_DIVBASE", "ELR_C_CGBASE", "ELR_C_CG_SHIFT_ID", "ELR_C_IS_BREAK_DIV", "ELR_C_DIVBASE", "ELR_PRECISION", "C_ROOT_FUNCTION", "ELR_ROOT_RATE", "ELR_SUM_AMOUNT", "ELR_INPUT_PRECISION", "ELR_TYPE", "ELR_IS_BUDGETED", "DIC_HRM_ROOT_NATURE_ID", "ELR_IS_VISIBLE", "ELR_IS_CERTIFIED") AS
  select HRM_ELEMENTS_ROOT_ID
       , Nvl(ELR_ROOT_CODE, '_') ELR_ROOT_CODE
       , Nvl(ELR_ROOT_NAME, '_') ELR_ROOT_NAME
       , Nvl(ELR_FROM, to_date('40000101', 'YYYYMMDD') ) ELR_FROM
       , Nvl(ELR_TO, to_date('40000101', 'YYYYMMDD') ) ELR_TO
       , Nvl(C_ROOT_TYPE, 'DWH_ISNULL') C_ROOT_TYPE
       , Nvl(C_ROOT_VARIANT, 'DWH_ISNULL') C_ROOT_VARIANT
       , Nvl2(ELR_USES_SUMS, case
                when(ELR_USES_SUMS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_USES_SUMS
       , Nvl2(ELR_USES_FEEDBACK, case
                when(ELR_USES_FEEDBACK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_USES_FEEDBACK
       , Nvl2(ELR_USES_CONSTENT, case
                when(ELR_USES_CONSTENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_USES_CONSTENT
       , Nvl(C_HRM_SAL_CONST_TYPE, 'DWH_ISNULL') C_HRM_SAL_CONST_TYPE
       , Nvl2(ELR_IS_ACTIVE, case
                when(ELR_IS_ACTIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_ACTIVE
       , Nvl2(ELR_ROUND, case
                when(ELR_ROUND = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_ROUND
       , Nvl2(ELR_FORMAT, case
                when(ELR_FORMAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_FORMAT
       , Nvl(ELR_SIGN, '_') ELR_SIGN
       , Nvl(ELR_DEFAULT_VALUE, '_') ELR_DEFAULT_VALUE
       , Nvl(ELR_CODE_DIC, '_') ELR_CODE_DIC
       , Nvl2(ELR_IS_INDIV, case
                when(ELR_IS_INDIV = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_INDIV
       , Nvl2(ELR_REPORTING, case
                when(ELR_REPORTING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_REPORTING
       , Nvl2(ELR_IS_MANDATORY, case
                when(ELR_IS_MANDATORY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_MANDATORY
       , Nvl(DIC_GROUP1_ID, 'DWH_ISNULL') DIC_GROUP1_ID
       , Nvl(DIC_GROUP2_ID, 'DWH_ISNULL') DIC_GROUP2_ID
       , Nvl(DIC_GROUP3_ID, 'DWH_ISNULL') DIC_GROUP3_ID
       , Nvl(DIC_GROUP4_ID, 'DWH_ISNULL') DIC_GROUP4_ID
       , Nvl2(ELR_MULTI_CURRENCY, case
                when(ELR_MULTI_CURRENCY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_MULTI_CURRENCY
       , Nvl(ELR_CURRENCY, '_') ELR_CURRENCY
       , Nvl(HRM_CODE_DIC_ID, -2) HRM_CODE_DIC_ID
       , Nvl(ELR_SUMS_USED, '_') ELR_SUMS_USED
       , Nvl(HRM_ELEMENTS_ID, -2) HRM_ELEMENTS_ID
       , Nvl(ELR_CONDITION, '_') ELR_CONDITION
       , Nvl2(ELR_IS_PRINT, case
                when(ELR_IS_PRINT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_PRINT
       , Nvl(ELR_BASE_AMOUNT, '_') ELR_BASE_AMOUNT
       , Nvl(ELR_RATE, '_') ELR_RATE
       , Nvl(ELR_PER_RATE, '_') ELR_PER_RATE
       , Nvl(ACS_FINANCIAL_CURRENCY_ID, -2) ACS_FINANCIAL_CURRENCY_ID
       , Nvl2(ELR_INPUT_TYPE, case
                when(ELR_INPUT_TYPE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_INPUT_TYPE
       , Nvl2(ELR_IS_BASE_COND, case
                when(ELR_IS_BASE_COND = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_BASE_COND
       , Nvl(ELR_BASE_COND_ID, -2) ELR_BASE_COND_ID
       , Nvl(ELR_BASE_COND_CODE, '_') ELR_BASE_COND_CODE
       , Nvl2(ELR_IS_BREAK, case
                when(ELR_IS_BREAK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_BREAK
       , Nvl2(ELR_SWAP_DC, case
                when(ELR_SWAP_DC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_SWAP_DC
       , Nvl(ELR_USE_RATIO_GROUP, '_') ELR_USE_RATIO_GROUP
       , Nvl2(ELR_IS_BREAK_DEBIT, case
                when(ELR_IS_BREAK_DEBIT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_BREAK_DEBIT
       , Nvl2(ELR_IS_BREAK_CREDIT, case
                when(ELR_IS_BREAK_CREDIT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_BREAK_CREDIT
       , Nvl(ELR_D_CGBASE, '_') ELR_D_CGBASE
       , Nvl(ELR_D_CG_SHIFT_ID, -2) ELR_D_CG_SHIFT_ID
       , Nvl2(ELR_D_IS_BREAK_DIV, case
                when(ELR_D_IS_BREAK_DIV = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_D_IS_BREAK_DIV
       , Nvl2(ELR_IS_BREAK_INVERSE, case
                when(ELR_IS_BREAK_INVERSE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_BREAK_INVERSE
       , Nvl(ELR_D_DIVBASE, '_') ELR_D_DIVBASE
       , Nvl(ELR_C_CGBASE, '_') ELR_C_CGBASE
       , Nvl(ELR_C_CG_SHIFT_ID, -2) ELR_C_CG_SHIFT_ID
       , Nvl2(ELR_C_IS_BREAK_DIV, case
                when(ELR_C_IS_BREAK_DIV = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_C_IS_BREAK_DIV
       , Nvl(ELR_C_DIVBASE, '_') ELR_C_DIVBASE
       , ELR_PRECISION
       , Nvl(C_ROOT_FUNCTION, 'DWH_ISNULL') C_ROOT_FUNCTION
       , Nvl2(ELR_ROOT_RATE, case
                when(ELR_ROOT_RATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_ROOT_RATE
       , Nvl(ELR_SUM_AMOUNT, '_') ELR_SUM_AMOUNT
       , Nvl2(ELR_INPUT_PRECISION, case
                when(ELR_INPUT_PRECISION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_INPUT_PRECISION
       , Nvl2(ELR_TYPE, case
                when(ELR_TYPE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_TYPE
       , Nvl2(ELR_IS_BUDGETED, case
                when(ELR_IS_BUDGETED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_BUDGETED
       , Nvl(DIC_HRM_ROOT_NATURE_ID, 'DWH_ISNULL') DIC_HRM_ROOT_NATURE_ID
       , Nvl2(ELR_IS_VISIBLE, case
                when(ELR_IS_VISIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_VISIBLE
       , Nvl2(ELR_IS_CERTIFIED, case
                when(ELR_IS_CERTIFIED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ELR_IS_CERTIFIED
  from HRM_ELEMENTS_ROOT
  union all
  select -1 HRM_ELEMENTS_ROOT_ID
       , 'N/A' ELR_ROOT_CODE
       , 'N/A' ELR_ROOT_NAME
       , to_date('00010101', 'YYYYMMDD') ELR_FROM
       , to_date('00010101', 'YYYYMMDD') ELR_TO
       , 'DWH_NA' C_ROOT_TYPE
       , 'DWH_NA' C_ROOT_VARIANT
       , '-1' ELR_USES_SUMS
       , '-1' ELR_USES_FEEDBACK
       , '-1' ELR_USES_CONSTENT
       , 'DWH_NA' C_HRM_SAL_CONST_TYPE
       , '-1' ELR_IS_ACTIVE
       , '-1' ELR_ROUND
       , '-1' ELR_FORMAT
       , 'N/A' ELR_SIGN
       , 'N/A' ELR_DEFAULT_VALUE
       , 'N/A' ELR_CODE_DIC
       , '-1' ELR_IS_INDIV
       , '-1' ELR_REPORTING
       , '-1' ELR_IS_MANDATORY
       , 'DWH_NA' DIC_GROUP1_ID
       , 'DWH_NA' DIC_GROUP2_ID
       , 'DWH_NA' DIC_GROUP3_ID
       , 'DWH_NA' DIC_GROUP4_ID
       , '-1' ELR_MULTI_CURRENCY
       , 'N/A' ELR_CURRENCY
       , -1 HRM_CODE_DIC_ID
       , 'N/A' ELR_SUMS_USED
       , -1 HRM_ELEMENTS_ID
       , 'N/A' ELR_CONDITION
       , '-1' ELR_IS_PRINT
       , 'N/A' ELR_BASE_AMOUNT
       , 'N/A' ELR_RATE
       , 'N/A' ELR_PER_RATE
       , -1 ACS_FINANCIAL_CURRENCY_ID
       , '-1' ELR_INPUT_TYPE
       , '-1' ELR_IS_BASE_COND
       , -1 ELR_BASE_COND_ID
       , 'N/A' ELR_BASE_COND_CODE
       , '-1' ELR_IS_BREAK
       , '-1' ELR_SWAP_DC
       , 'N/A' ELR_USE_RATIO_GROUP
       , '-1' ELR_IS_BREAK_DEBIT
       , '-1' ELR_IS_BREAK_CREDIT
       , 'N/A' ELR_D_CGBASE
       , -1 ELR_D_CG_SHIFT_ID
       , '-1' ELR_D_IS_BREAK_DIV
       , '-1' ELR_IS_BREAK_INVERSE
       , 'N/A' ELR_D_DIVBASE
       , 'N/A' ELR_C_CGBASE
       , -1 ELR_C_CG_SHIFT_ID
       , '-1' ELR_C_IS_BREAK_DIV
       , 'N/A' ELR_C_DIVBASE
       , null ELR_PRECISION
       , 'DWH_NA' C_ROOT_FUNCTION
       , '-1' ELR_ROOT_RATE
       , 'N/A' ELR_SUM_AMOUNT
       , '-1' ELR_INPUT_PRECISION
       , '-1' ELR_TYPE
       , '-1' ELR_IS_BUDGETED
       , 'DWH_NA' DIC_HRM_ROOT_NATURE_ID
       , '-1' ELR_IS_VISIBLE
       , '-1' ELR_IS_CERTIFIED
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_JOB" ("HRM_JOB_ID", "HRM_IN_CHARGE_ID", "JOB_CODE", "DIC_DEPARTMENT_ID", "DIC_WORK_PERMIT_ID", "DIC_JOB_TYPE_ID", "C_JOB_STATUS", "HRM_COMPANY_ID", "DIC_JOB_CREATION_MOTIVE_ID", "JOB_TITLE", "JOB_DESCR", "JOB_ACTIVITY", "JOB_WAGES_FROM", "JOB_WAGES_TO", "JOB_SEX", "JOB_HOME", "JOB_FREE", "JOB_AGE", "JOB_DUE_DATE", "JOB_CREATION_DATE", "JOB_PROVIDED_DATE", "JOB_TAKING_ON_NO", "JOB_TAKING_ON_DESCR", "JOB_TAKING_ON_DATE", "HRM_DIVISION_ID", "JOB_DIV_NUMBER", "JOB_CDA_NUMBER", "JOB_PF_NUMBER", "JOB_PJ_NUMBER", "DIC_RESPONSABILITY_ID", "DIC_JOB_ACTIVITY_ID", "DIC_PROFESSIONAL_CATEGORY_ID", "JOB_ACTIVITY_N", "HRM_PROFILE_ID", "JOB_SHIFT", "JOB_RCO_TITLE") AS
  select HRM_JOB_ID
       , Nvl(HRM_IN_CHARGE_ID, -2) HRM_IN_CHARGE_ID
       , Nvl(JOB_CODE, '_') JOB_CODE
       , Nvl(DIC_DEPARTMENT_ID, 'DWH_ISNULL') DIC_DEPARTMENT_ID
       , Nvl(DIC_WORK_PERMIT_ID, 'DWH_ISNULL') DIC_WORK_PERMIT_ID
       , Nvl(DIC_JOB_TYPE_ID, 'DWH_ISNULL') DIC_JOB_TYPE_ID
       , Nvl(C_JOB_STATUS, 'DWH_ISNULL') C_JOB_STATUS
       , Nvl(HRM_COMPANY_ID, -2) HRM_COMPANY_ID
       , Nvl(DIC_JOB_CREATION_MOTIVE_ID, 'DWH_ISNULL') DIC_JOB_CREATION_MOTIVE_ID
       , Nvl(JOB_TITLE, '_') JOB_TITLE
       , Nvl(JOB_DESCR, '_') JOB_DESCR
       , JOB_ACTIVITY
       , JOB_WAGES_FROM
       , JOB_WAGES_TO
       , Nvl(JOB_SEX, '_') JOB_SEX
       , Nvl(JOB_HOME, '_') JOB_HOME
       , Nvl(JOB_FREE, '_') JOB_FREE
       , Nvl(JOB_AGE, '_') JOB_AGE
       , Nvl(JOB_DUE_DATE, to_date('40000101', 'YYYYMMDD') ) JOB_DUE_DATE
       , Nvl(JOB_CREATION_DATE, to_date('40000101', 'YYYYMMDD') ) JOB_CREATION_DATE
       , Nvl(JOB_PROVIDED_DATE, to_date('40000101', 'YYYYMMDD') ) JOB_PROVIDED_DATE
       , Nvl(JOB_TAKING_ON_NO, '_') JOB_TAKING_ON_NO
       , Nvl(JOB_TAKING_ON_DESCR, '_') JOB_TAKING_ON_DESCR
       , Nvl(JOB_TAKING_ON_DATE, to_date('40000101', 'YYYYMMDD') ) JOB_TAKING_ON_DATE
       , Nvl(HRM_DIVISION_ID, -2) HRM_DIVISION_ID
       , Nvl(JOB_DIV_NUMBER, '_') JOB_DIV_NUMBER
       , Nvl(JOB_CDA_NUMBER, '_') JOB_CDA_NUMBER
       , Nvl(JOB_PF_NUMBER, '_') JOB_PF_NUMBER
       , Nvl(JOB_PJ_NUMBER, '_') JOB_PJ_NUMBER
       , Nvl(DIC_RESPONSABILITY_ID, 'DWH_ISNULL') DIC_RESPONSABILITY_ID
       , Nvl(DIC_JOB_ACTIVITY_ID, 'DWH_ISNULL') DIC_JOB_ACTIVITY_ID
       , Nvl(DIC_PROFESSIONAL_CATEGORY_ID, 'DWH_ISNULL') DIC_PROFESSIONAL_CATEGORY_ID
       , JOB_ACTIVITY_N
       , Nvl(HRM_PROFILE_ID, -2) HRM_PROFILE_ID
       , Nvl(JOB_SHIFT, '_') JOB_SHIFT
       , Nvl(JOB_RCO_TITLE, '_') JOB_RCO_TITLE
       -- JOB_MAIN_DUTIES cannot be used with CLOB
       -- JOB_SPECIAL_DUTIES cannot be used with CLOB
       -- JOB_RESPONSABILITY cannot be used with CLOB
       -- JOB_WAGES_TEXT cannot be used with CLOB
       -- JOB_TRAINING cannot be used with CLOB
       -- JOB_ACCADEMICS cannot be used with CLOB
       -- JOB_REQUIRED_EXPERIENCE cannot be used with CLOB
       -- JOB_QUALITES_PERSO_REQUIRED cannot be used with CLOB
  from HRM_JOB
  union all
  select -1 HRM_JOB_ID
       , -1 HRM_IN_CHARGE_ID
       , 'N/A' JOB_CODE
       , 'DWH_NA' DIC_DEPARTMENT_ID
       , 'DWH_NA' DIC_WORK_PERMIT_ID
       , 'DWH_NA' DIC_JOB_TYPE_ID
       , 'DWH_NA' C_JOB_STATUS
       , -1 HRM_COMPANY_ID
       , 'DWH_NA' DIC_JOB_CREATION_MOTIVE_ID
       , 'N/A' JOB_TITLE
       , 'N/A' JOB_DESCR
       , null JOB_ACTIVITY
       , null JOB_WAGES_FROM
       , null JOB_WAGES_TO
       , 'N/A' JOB_SEX
       , 'N/A' JOB_HOME
       , 'N/A' JOB_FREE
       , 'N/A' JOB_AGE
       , to_date('00010101', 'YYYYMMDD') JOB_DUE_DATE
       , to_date('00010101', 'YYYYMMDD') JOB_CREATION_DATE
       , to_date('00010101', 'YYYYMMDD') JOB_PROVIDED_DATE
       , 'N/A' JOB_TAKING_ON_NO
       , 'N/A' JOB_TAKING_ON_DESCR
       , to_date('00010101', 'YYYYMMDD') JOB_TAKING_ON_DATE
       , -1 HRM_DIVISION_ID
       , 'N/A' JOB_DIV_NUMBER
       , 'N/A' JOB_CDA_NUMBER
       , 'N/A' JOB_PF_NUMBER
       , 'N/A' JOB_PJ_NUMBER
       , 'DWH_NA' DIC_RESPONSABILITY_ID
       , 'DWH_NA' DIC_JOB_ACTIVITY_ID
       , 'DWH_NA' DIC_PROFESSIONAL_CATEGORY_ID
       , null JOB_ACTIVITY_N
       , -1 HRM_PROFILE_ID
       , 'N/A' JOB_SHIFT
       , 'N/A' JOB_RCO_TITLE
       -- JOB_MAIN_DUTIES cannot be used with CLOB
       -- JOB_SPECIAL_DUTIES cannot be used with CLOB
       -- JOB_RESPONSABILITY cannot be used with CLOB
       -- JOB_WAGES_TEXT cannot be used with CLOB
       -- JOB_TRAINING cannot be used with CLOB
       -- JOB_ACCADEMICS cannot be used with CLOB
       -- JOB_REQUIRED_EXPERIENCE cannot be used with CLOB
       -- JOB_QUALITES_PERSO_REQUIRED cannot be used with CLOB
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_PERSON" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_TITLE", "PER_FIRST_NAME", "PER_LAST_NAME", "PER_INITIALS", "PER_GENDER", "PER_BIRTH_DATE", "PER_COMMENT", "PER_ASSISTANT_PHONE", "PER_BUSINESS_PHONE", "PER_BUSINESS2_PHONE", "PER_HOME_PHONE", "PER_HOME2_PHONE", "PER_MOBILE_PHONE", "PER_OTHER_PHONE", "PER_FAX_PHONE", "PER_FAX2_PHONE", "PER_PHONE_SELECTOR", "PER_EMAIL", "PER_EMAIL2", "PER_EMAIL3", "PER_EMAIL_SELECTOR", "PER_BUSINESSSTREET", "PER_BUSINESSCITY", "PER_BUSINESSSTATE", "PER_BUSINESSPOSTALCODE", "PER_BUSINESSCOUNTRY", "PER_HOMESTREET", "PER_HOMECITY", "PER_HOMESTATE", "PER_HOMEPOSTALCODE", "PER_HOMECOUNTRY", "PER_OTHERSTREET", "PER_OTHERCITY", "PER_OTHERSTATE", "PER_OTHERPOSTALCODE", "PER_OTHERCOUNTRY", "PER_TAXSTREET", "PER_TAXCITY", "PER_TAXSTATE", "PER_TAXPOSTALCODE", "PER_TAXCOUNTRY", "PER_ADDRESS_SELECTOR", "PER_ADDRESS_SELECTED", "PER_MAIL_ADD_SELECTOR", "PER_MAIL_ADD_SELECTED", "PER_WEB_PAGE", "PER_ACTIVITY", "PER_IS_CONTACT", "PER_IS_EMPLOYEE", "PER_IS_DEPENDENT", "PER_IS_CANDIDAT", "PER_IS_DELEGATE", "PER_IS_TRAINER", "PER_IS_RESPONSIBLE", "PER_IS_QUICK_EDIT", "EMP_OTHER_FIRSTNAME", "EMP_MAIDEN_NAME", "EMP_STATUS", "EMP_NUMBER", "EMP_SECONDARY_KEY", "EMP_SOCIAL_SECURITYNO", "C_CIVIL_STATUS", "EMP_LAST_INTERVIEW", "EMP_WORKINGAREA", "DIC_WORKREGION_ID", "EMP_BIRTH_COUNTRY", "EMP_NATIVE_OF", "EMP_BIRTH_PLACE", "EMP_CALCULATION", "EMP_CHILD_NB", "EMP_HOBBIES", "EMP_LAST_PAY_DATE", "EMP_LAST_PAY_NUM", "DIC_RESPONSABILITY_ID", "DIC_JOB_ACTIVITY_ID", "COM_BITMAP_ID", "HRM_DIVISION_ID", "PER_ACTIVITY_RATE", "PC_LANG_ID", "HRM_JOB_ID", "DIC_WORKPLACE_ID", "DIC_DEPARTMENT_ID", "DIC_NATIONALITY_ID", "DIC_NATIONALITY2_ID", "DIC_NATIONALITY3_ID", "EMP_MEATS_COST_SHARE", "EMP_STOCK_OPTIONS", "EMP_COMPANY_CAR", "EMP_SEASON_TICKET", "EMP_PASSWORD", "EMP_PASS_CHANGE_ALLOWED", "EMP_DRIVING_LICENCE", "DIC_NOTICE_TYPE_ID", "C_APPLICATION_TYPE", "CAN_APPEAREANCE", "CAN_CULTURE", "CAN_DESCR", "CAN_ELOCUTION", "CAN_EVALUATION_COMMENT", "CAN_EVALUATION_DATE", "CAN_INTEL", "CAN_LAST_COMPANY", "CAN_RELATION", "CAN_ACTUAL_SALARY", "CAN_WISHED_SALARY", "CAN_APPLIED_JOB", "CAN_CLASS_NUMBER", "CAN_DATE_FREE", "CAN_FREE", "CAN_INITAL_DATE", "DIC_WORK_PERMIT_ID", "DIC_ACTIVITY_RATE_ID", "C_APPLICATION_STATUS", "DIC_MOBILITY_AREA_ID", "HRM_APPLICATION_ORIGIN_ID", "HRM_PROFILE_ID", "DIC_CONFESSION_ID", "DIC_CANTON_WORK_ID", "EMP_GROUP_ENTRY", "EMP_OFS_INCLUDED", "C_OFS_TRAINING", "C_OFS_JOB_QUALIF", "C_OFS_ACTIVITY", "C_OFS_RESPONSABILITY", "C_OFS_SALARY_CONTRACT", "C_OFS_SALARY_TYPE", "HRM_CANDIDATE_RESP_ID", "EMP_LAST_PAY_DATE_AC", "EMP_CIVIL_STATUS_SINCE", "EMP_MARRIAGE_PLACE", "PER_SEARCH_NAME", "DIC_HRM_EMP_TYPE_ID", "C_HRM_GE_COHABITATION", "C_HRM_GE_RELIGION", "C_HRM_GE_HOMECITY", "C_HRM_GE_HOMESTATE", "C_HRM_GE_TAXPAYER", "C_HRM_GE_PROF_CAT", "C_HRM_GE_WORKCITY", "EMP_SOCIAL_SECURITYNO2", "EMP_SINGLE_PARENT", "EMP_LPP_CONTRIBUTOR", "PER_CARD_ID", "PER_TAX_ID", "PER_ADD1_FIELD01", "PER_ADD1_FIELD02", "PER_ADD1_FIELD03", "PER_ADD1_FIELD04", "PER_ADD1_FIELD05", "PER_ADD1_FIELD06", "PER_ADD1_FIELD07", "PER_ADD1_FIELD08", "PER_ADD2_FIELD01", "PER_ADD2_FIELD02", "PER_ADD2_FIELD03", "PER_ADD2_FIELD04", "PER_ADD2_FIELD05", "PER_ADD2_FIELD06", "PER_ADD2_FIELD07", "PER_ADD2_FIELD08", "PER_ADD3_FIELD01", "PER_ADD3_FIELD02", "PER_ADD3_FIELD03", "PER_ADD3_FIELD04", "PER_ADD3_FIELD05", "PER_ADD3_FIELD06", "PER_ADD3_FIELD07", "PER_ADD3_FIELD08", "PER_ADD4_FIELD01", "PER_ADD4_FIELD02", "PER_ADD4_FIELD03", "PER_ADD4_FIELD04", "PER_ADD4_FIELD05", "PER_ADD4_FIELD06", "PER_ADD4_FIELD07", "PER_ADD4_FIELD08", "PER_LAST_NAME_LOCAL", "PER_FIRST_NAME_LOCAL", "PER_PASS_ID", "PER_PASS_ISSUED_BY", "PER_PASS_VALID_FROM", "PER_PASS_VALID_TO") AS
  select PER.HRM_PERSON_ID
       , Nvl(PER.PER_FULLNAME, '_') PER_FULLNAME
       , Nvl(PER.PER_TITLE, '_') PER_TITLE
       , Nvl(PER.PER_FIRST_NAME, '_') PER_FIRST_NAME
       , Nvl(PER.PER_LAST_NAME, '_') PER_LAST_NAME
       , Nvl(PER.PER_INITIALS, '_') PER_INITIALS
       , Nvl(PER.PER_GENDER, '_') PER_GENDER
       , Nvl(PER.PER_BIRTH_DATE, to_date('40000101', 'YYYYMMDD') ) PER_BIRTH_DATE
       , Nvl(PER.PER_COMMENT, '_') PER_COMMENT
       , Nvl(PER.PER_ASSISTANT_PHONE, '_') PER_ASSISTANT_PHONE
       , Nvl(PER.PER_BUSINESS_PHONE, '_') PER_BUSINESS_PHONE
       , Nvl(PER.PER_BUSINESS2_PHONE, '_') PER_BUSINESS2_PHONE
       , Nvl(PER.PER_HOME_PHONE, '_') PER_HOME_PHONE
       , Nvl(PER.PER_HOME2_PHONE, '_') PER_HOME2_PHONE
       , Nvl(PER.PER_MOBILE_PHONE, '_') PER_MOBILE_PHONE
       , Nvl(PER.PER_OTHER_PHONE, '_') PER_OTHER_PHONE
       , Nvl(PER.PER_FAX_PHONE, '_') PER_FAX_PHONE
       , Nvl(PER.PER_FAX2_PHONE, '_') PER_FAX2_PHONE
       , Nvl2(PER.PER_PHONE_SELECTOR, case
                when(PER.PER_PHONE_SELECTOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_PHONE_SELECTOR
       , Nvl(PER.PER_EMAIL, '_') PER_EMAIL
       , Nvl(PER.PER_EMAIL2, '_') PER_EMAIL2
       , Nvl(PER.PER_EMAIL3, '_') PER_EMAIL3
       , Nvl2(PER.PER_EMAIL_SELECTOR, case
                when(PER.PER_EMAIL_SELECTOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_EMAIL_SELECTOR
       , Nvl(PER.PER_BUSINESSSTREET, '_') PER_BUSINESSSTREET
       , Nvl(PER.PER_BUSINESSCITY, '_') PER_BUSINESSCITY
       , Nvl(PER.PER_BUSINESSSTATE, '_') PER_BUSINESSSTATE
       , Nvl(PER.PER_BUSINESSPOSTALCODE, '_') PER_BUSINESSPOSTALCODE
       , Nvl(PER.PER_BUSINESSCOUNTRY, '_') PER_BUSINESSCOUNTRY
       , Nvl(PER.PER_HOMESTREET, '_') PER_HOMESTREET
       , Nvl(PER.PER_HOMECITY, '_') PER_HOMECITY
       , Nvl(PER.PER_HOMESTATE, '_') PER_HOMESTATE
       , Nvl(PER.PER_HOMEPOSTALCODE, '_') PER_HOMEPOSTALCODE
       , Nvl(PER.PER_HOMECOUNTRY, '_') PER_HOMECOUNTRY
       , Nvl(PER.PER_OTHERSTREET, '_') PER_OTHERSTREET
       , Nvl(PER.PER_OTHERCITY, '_') PER_OTHERCITY
       , Nvl(PER.PER_OTHERSTATE, '_') PER_OTHERSTATE
       , Nvl(PER.PER_OTHERPOSTALCODE, '_') PER_OTHERPOSTALCODE
       , Nvl(PER.PER_OTHERCOUNTRY, '_') PER_OTHERCOUNTRY
       , Nvl(PER.PER_TAXSTREET, '_') PER_TAXSTREET
       , Nvl(PER.PER_TAXCITY, '_') PER_TAXCITY
       , Nvl(PER.PER_TAXSTATE, '_') PER_TAXSTATE
       , Nvl(PER.PER_TAXPOSTALCODE, '_') PER_TAXPOSTALCODE
       , Nvl(PER.PER_TAXCOUNTRY, '_') PER_TAXCOUNTRY
       , Nvl2(PER.PER_ADDRESS_SELECTOR, case
                when(PER.PER_ADDRESS_SELECTOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_ADDRESS_SELECTOR
       , Nvl(PER.PER_ADDRESS_SELECTED, '_') PER_ADDRESS_SELECTED
       , Nvl2(PER.PER_MAIL_ADD_SELECTOR, case
                when(PER.PER_MAIL_ADD_SELECTOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_MAIL_ADD_SELECTOR
       , Nvl(PER.PER_MAIL_ADD_SELECTED, '_') PER_MAIL_ADD_SELECTED
       , Nvl(PER.PER_WEB_PAGE, '_') PER_WEB_PAGE
       , Nvl(PER.PER_ACTIVITY, '_') PER_ACTIVITY
       , Nvl2(PER.PER_IS_CONTACT, case
                when(PER.PER_IS_CONTACT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_CONTACT
       , Nvl2(PER.PER_IS_EMPLOYEE, case
                when(PER.PER_IS_EMPLOYEE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_EMPLOYEE
       , Nvl2(PER.PER_IS_DEPENDENT, case
                when(PER.PER_IS_DEPENDENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_DEPENDENT
       , Nvl2(PER.PER_IS_CANDIDAT, case
                when(PER.PER_IS_CANDIDAT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_CANDIDAT
       , Nvl2(PER.PER_IS_DELEGATE, case
                when(PER.PER_IS_DELEGATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_DELEGATE
       , Nvl2(PER.PER_IS_TRAINER, case
                when(PER.PER_IS_TRAINER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_TRAINER
       , Nvl2(PER.PER_IS_RESPONSIBLE, case
                when(PER.PER_IS_RESPONSIBLE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_RESPONSIBLE
       , Nvl2(PER.PER_IS_QUICK_EDIT, case
                when(PER.PER_IS_QUICK_EDIT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_IS_QUICK_EDIT
       , Nvl(EMP_OTHER_FIRSTNAME, '_') EMP_OTHER_FIRSTNAME
       , Nvl(EMP_MAIDEN_NAME, '_') EMP_MAIDEN_NAME
       , Nvl(EMP_STATUS, '_') EMP_STATUS
       , Nvl(EMP_NUMBER, '_') EMP_NUMBER
       , Nvl(EMP_SECONDARY_KEY, '_') EMP_SECONDARY_KEY
       , Nvl(EMP_SOCIAL_SECURITYNO, '_') EMP_SOCIAL_SECURITYNO
       , Nvl(PER.C_CIVIL_STATUS, 'DWH_ISNULL') C_CIVIL_STATUS
       , Nvl(PER.EMP_LAST_INTERVIEW, to_date('40000101', 'YYYYMMDD') ) EMP_LAST_INTERVIEW
       , Nvl(PER.EMP_WORKINGAREA, '_') EMP_WORKINGAREA
       , Nvl(PER.DIC_WORKREGION_ID, 'DWH_ISNULL') DIC_WORKREGION_ID
       , Nvl(PER.EMP_BIRTH_COUNTRY, '_') EMP_BIRTH_COUNTRY
       , Nvl(PER.EMP_NATIVE_OF, '_') EMP_NATIVE_OF
       , Nvl(PER.EMP_BIRTH_PLACE, '_') EMP_BIRTH_PLACE
       , Nvl2(PER.EMP_CALCULATION, case
                when(PER.EMP_CALCULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_CALCULATION
       , PER.EMP_CHILD_NB
       , Nvl(PER.EMP_HOBBIES, '_') EMP_HOBBIES
       , Nvl(PER.EMP_LAST_PAY_DATE, to_date('40000101', 'YYYYMMDD') ) EMP_LAST_PAY_DATE
       , PER.EMP_LAST_PAY_NUM
       , Nvl(PER.DIC_RESPONSABILITY_ID, 'DWH_ISNULL') DIC_RESPONSABILITY_ID
       , Nvl(PER.DIC_JOB_ACTIVITY_ID, 'DWH_ISNULL') DIC_JOB_ACTIVITY_ID
       , Nvl(PER.COM_BITMAP_ID, -2) COM_BITMAP_ID
       , Nvl(PER.HRM_DIVISION_ID, -2) HRM_DIVISION_ID
       , PER.PER_ACTIVITY_RATE
       , Nvl(PER.PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(PER.HRM_JOB_ID, -2) HRM_JOB_ID
       , Nvl(PER.DIC_WORKPLACE_ID, 'DWH_ISNULL') DIC_WORKPLACE_ID
       , Nvl(PER.DIC_DEPARTMENT_ID, 'DWH_ISNULL') DIC_DEPARTMENT_ID
       , Nvl(PER.DIC_NATIONALITY_ID, 'DWH_ISNULL') DIC_NATIONALITY_ID
       , Nvl(PER.DIC_NATIONALITY2_ID, 'DWH_ISNULL') DIC_NATIONALITY2_ID
       , Nvl(PER.DIC_NATIONALITY3_ID, 'DWH_ISNULL') DIC_NATIONALITY3_ID
       , Nvl2(PER.EMP_MEATS_COST_SHARE, case
                when(PER.EMP_MEATS_COST_SHARE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_MEATS_COST_SHARE
       , Nvl2(PER.EMP_STOCK_OPTIONS, case
                when(PER.EMP_STOCK_OPTIONS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_STOCK_OPTIONS
       , Nvl2(PER.EMP_COMPANY_CAR, case
                when(PER.EMP_COMPANY_CAR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_COMPANY_CAR
       , Nvl2(PER.EMP_SEASON_TICKET, case
                when(PER.EMP_SEASON_TICKET = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_SEASON_TICKET
       , Nvl(PER.EMP_PASSWORD, '_') EMP_PASSWORD
       , Nvl2(PER.EMP_PASS_CHANGE_ALLOWED, case
                when(PER.EMP_PASS_CHANGE_ALLOWED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_PASS_CHANGE_ALLOWED
       , Nvl(PER.EMP_DRIVING_LICENCE, '_') EMP_DRIVING_LICENCE
       , Nvl(PER.DIC_NOTICE_TYPE_ID, 'DWH_ISNULL') DIC_NOTICE_TYPE_ID
       , Nvl(PER.C_APPLICATION_TYPE, 'DWH_ISNULL') C_APPLICATION_TYPE
       , Nvl(PER.CAN_APPEAREANCE, '_') CAN_APPEAREANCE
       , Nvl(PER.CAN_CULTURE, '_') CAN_CULTURE
       , Nvl(PER.CAN_DESCR, '_') CAN_DESCR
       , Nvl(PER.CAN_ELOCUTION, '_') CAN_ELOCUTION
       , Nvl(PER.CAN_EVALUATION_COMMENT, '_') CAN_EVALUATION_COMMENT
       , Nvl(PER.CAN_EVALUATION_DATE, to_date('40000101', 'YYYYMMDD') ) CAN_EVALUATION_DATE
       , Nvl(PER.CAN_INTEL, '_') CAN_INTEL
       , Nvl(PER.CAN_LAST_COMPANY, '_') CAN_LAST_COMPANY
       , Nvl(PER.CAN_RELATION, '_') CAN_RELATION
       , PER.CAN_ACTUAL_SALARY
       , PER.CAN_WISHED_SALARY
       , Nvl(PER.CAN_APPLIED_JOB, '_') CAN_APPLIED_JOB
       , Nvl(PER.CAN_CLASS_NUMBER, '_') CAN_CLASS_NUMBER
       , Nvl(PER.CAN_DATE_FREE, to_date('40000101', 'YYYYMMDD') ) CAN_DATE_FREE
       , Nvl2(PER.CAN_FREE, case
                when(PER.CAN_FREE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CAN_FREE
       , Nvl(PER.CAN_INITAL_DATE, to_date('40000101', 'YYYYMMDD') ) CAN_INITAL_DATE
       , Nvl(PER.DIC_WORK_PERMIT_ID, 'DWH_ISNULL') DIC_WORK_PERMIT_ID
       , Nvl(PER.DIC_ACTIVITY_RATE_ID, 'DWH_ISNULL') DIC_ACTIVITY_RATE_ID
       , Nvl(PER.C_APPLICATION_STATUS, 'DWH_ISNULL') C_APPLICATION_STATUS
       , Nvl(PER.DIC_MOBILITY_AREA_ID, 'DWH_ISNULL') DIC_MOBILITY_AREA_ID
       , Nvl(PER.HRM_APPLICATION_ORIGIN_ID, -2) HRM_APPLICATION_ORIGIN_ID
       , Nvl(PER.HRM_PROFILE_ID, -2) HRM_PROFILE_ID
       , Nvl(PER.DIC_CONFESSION_ID, 'DWH_ISNULL') DIC_CONFESSION_ID
       , Nvl(PER.DIC_CANTON_WORK_ID, 'DWH_ISNULL') DIC_CANTON_WORK_ID
       , Nvl(PER.EMP_GROUP_ENTRY, to_date('40000101', 'YYYYMMDD') ) EMP_GROUP_ENTRY
       , Nvl2(PER.EMP_OFS_INCLUDED, case
                when(PER.EMP_OFS_INCLUDED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_OFS_INCLUDED
       , Nvl(PER.C_OFS_TRAINING, 'DWH_ISNULL') C_OFS_TRAINING
       , Nvl(PER.C_OFS_JOB_QUALIF, 'DWH_ISNULL') C_OFS_JOB_QUALIF
       , Nvl(PER.C_OFS_ACTIVITY, 'DWH_ISNULL') C_OFS_ACTIVITY
       , Nvl(PER.C_OFS_RESPONSABILITY, 'DWH_ISNULL') C_OFS_RESPONSABILITY
       , Nvl(PER.C_OFS_SALARY_CONTRACT, 'DWH_ISNULL') C_OFS_SALARY_CONTRACT
       , Nvl(PER.C_OFS_SALARY_TYPE, 'DWH_ISNULL') C_OFS_SALARY_TYPE
       , Nvl(PER.HRM_CANDIDATE_RESP_ID, -2) HRM_CANDIDATE_RESP_ID
       , Nvl(PER.EMP_LAST_PAY_DATE_AC, to_date('40000101', 'YYYYMMDD') ) EMP_LAST_PAY_DATE_AC
       , Nvl(PER.EMP_CIVIL_STATUS_SINCE, to_date('40000101', 'YYYYMMDD') ) EMP_CIVIL_STATUS_SINCE
       , Nvl(PER.EMP_MARRIAGE_PLACE, '_') EMP_MARRIAGE_PLACE
       , Nvl(PER.PER_SEARCH_NAME, '_') PER_SEARCH_NAME
       , Nvl(PER.DIC_HRM_EMP_TYPE_ID, 'DWH_ISNULL') DIC_HRM_EMP_TYPE_ID
       , Nvl(PER.C_HRM_GE_COHABITATION, 'DWH_ISNULL') C_HRM_GE_COHABITATION
       , Nvl(PER.C_HRM_GE_RELIGION, 'DWH_ISNULL') C_HRM_GE_RELIGION
       , Nvl(PER.C_HRM_GE_HOMECITY, 'DWH_ISNULL') C_HRM_GE_HOMECITY
       , Nvl(PER.C_HRM_GE_HOMESTATE, 'DWH_ISNULL') C_HRM_GE_HOMESTATE
       , Nvl(PER.C_HRM_GE_TAXPAYER, 'DWH_ISNULL') C_HRM_GE_TAXPAYER
       , Nvl(PER.C_HRM_GE_PROF_CAT, 'DWH_ISNULL') C_HRM_GE_PROF_CAT
       , Nvl(PER.C_HRM_GE_WORKCITY, 'DWH_ISNULL') C_HRM_GE_WORKCITY
       , Nvl(PER.EMP_SOCIAL_SECURITYNO2, '_') EMP_SOCIAL_SECURITYNO2
       , Nvl2(PER.EMP_SINGLE_PARENT, case
                when(PER.EMP_SINGLE_PARENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_SINGLE_PARENT
       , Nvl(PER.EMP_LPP_CONTRIBUTOR, '_') EMP_LPP_CONTRIBUTOR
       , Nvl(PER.PER_CARD_ID, '_') PER_CARD_ID
       , Nvl(PER.PER_TAX_ID, '_') PER_TAX_ID
       , Nvl(PER.PER_ADD1_FIELD01, '_') PER_ADD1_FIELD01
       , Nvl(PER.PER_ADD1_FIELD02, '_') PER_ADD1_FIELD02
       , Nvl(PER.PER_ADD1_FIELD03, '_') PER_ADD1_FIELD03
       , Nvl(PER.PER_ADD1_FIELD04, '_') PER_ADD1_FIELD04
       , Nvl(PER.PER_ADD1_FIELD05, '_') PER_ADD1_FIELD05
       , Nvl(PER.PER_ADD1_FIELD06, '_') PER_ADD1_FIELD06
       , Nvl(PER.PER_ADD1_FIELD07, '_') PER_ADD1_FIELD07
       , Nvl(PER.PER_ADD1_FIELD08, '_') PER_ADD1_FIELD08
       , Nvl(PER.PER_ADD2_FIELD01, '_') PER_ADD2_FIELD01
       , Nvl(PER.PER_ADD2_FIELD02, '_') PER_ADD2_FIELD02
       , Nvl(PER.PER_ADD2_FIELD03, '_') PER_ADD2_FIELD03
       , Nvl(PER.PER_ADD2_FIELD04, '_') PER_ADD2_FIELD04
       , Nvl(PER.PER_ADD2_FIELD05, '_') PER_ADD2_FIELD05
       , Nvl(PER.PER_ADD2_FIELD06, '_') PER_ADD2_FIELD06
       , Nvl(PER.PER_ADD2_FIELD07, '_') PER_ADD2_FIELD07
       , Nvl(PER.PER_ADD2_FIELD08, '_') PER_ADD2_FIELD08
       , Nvl(PER.PER_ADD3_FIELD01, '_') PER_ADD3_FIELD01
       , Nvl(PER.PER_ADD3_FIELD02, '_') PER_ADD3_FIELD02
       , Nvl(PER.PER_ADD3_FIELD03, '_') PER_ADD3_FIELD03
       , Nvl(PER.PER_ADD3_FIELD04, '_') PER_ADD3_FIELD04
       , Nvl(PER.PER_ADD3_FIELD05, '_') PER_ADD3_FIELD05
       , Nvl(PER.PER_ADD3_FIELD06, '_') PER_ADD3_FIELD06
       , Nvl(PER.PER_ADD3_FIELD07, '_') PER_ADD3_FIELD07
       , Nvl(PER.PER_ADD3_FIELD08, '_') PER_ADD3_FIELD08
       , Nvl(PER.PER_ADD4_FIELD01, '_') PER_ADD4_FIELD01
       , Nvl(PER.PER_ADD4_FIELD02, '_') PER_ADD4_FIELD02
       , Nvl(PER.PER_ADD4_FIELD03, '_') PER_ADD4_FIELD03
       , Nvl(PER.PER_ADD4_FIELD04, '_') PER_ADD4_FIELD04
       , Nvl(PER.PER_ADD4_FIELD05, '_') PER_ADD4_FIELD05
       , Nvl(PER.PER_ADD4_FIELD06, '_') PER_ADD4_FIELD06
       , Nvl(PER.PER_ADD4_FIELD07, '_') PER_ADD4_FIELD07
       , Nvl(PER.PER_ADD4_FIELD08, '_') PER_ADD4_FIELD08
       , Nvl(PER.PER_LAST_NAME_LOCAL, '_') PER_LAST_NAME_LOCAL
       , Nvl(PER.PER_FIRST_NAME_LOCAL, '_') PER_FIRST_NAME_LOCAL
       , Nvl(PER.PER_PASS_ID, '_') PER_PASS_ID
       , Nvl(PER.PER_PASS_ISSUED_BY, '_') PER_PASS_ISSUED_BY
       , Nvl(PER.PER_PASS_VALID_FROM, to_date('40000101', 'YYYYMMDD') ) PER_PASS_VALID_FROM
       , Nvl(PER.PER_PASS_VALID_TO, to_date('40000101', 'YYYYMMDD') ) PER_PASS_VALID_TO
  from HRM_PERSON PER
  union all
  select -1 HRM_PERSON_ID
       , 'N/A' PER_FULLNAME
       , 'N/A' PER_TITLE
       , 'N/A' PER_FIRST_NAME
       , 'N/A' PER_LAST_NAME
       , 'N/A' PER_INITIALS
       , 'N/A' PER_GENDER
       , to_date('00010101', 'YYYYMMDD') PER_BIRTH_DATE
       , 'N/A' PER_COMMENT
       , 'N/A' PER_ASSISTANT_PHONE
       , 'N/A' PER_BUSINESS_PHONE
       , 'N/A' PER_BUSINESS2_PHONE
       , 'N/A' PER_HOME_PHONE
       , 'N/A' PER_HOME2_PHONE
       , 'N/A' PER_MOBILE_PHONE
       , 'N/A' PER_OTHER_PHONE
       , 'N/A' PER_FAX_PHONE
       , 'N/A' PER_FAX2_PHONE
       , '-1' PER_PHONE_SELECTOR
       , 'N/A' PER_EMAIL
       , 'N/A' PER_EMAIL2
       , 'N/A' PER_EMAIL3
       , '-1' PER_EMAIL_SELECTOR
       , 'N/A' PER_BUSINESSSTREET
       , 'N/A' PER_BUSINESSCITY
       , 'N/A' PER_BUSINESSSTATE
       , 'N/A' PER_BUSINESSPOSTALCODE
       , 'N/A' PER_BUSINESSCOUNTRY
       , 'N/A' PER_HOMESTREET
       , 'N/A' PER_HOMECITY
       , 'N/A' PER_HOMESTATE
       , 'N/A' PER_HOMEPOSTALCODE
       , 'N/A' PER_HOMECOUNTRY
       , 'N/A' PER_OTHERSTREET
       , 'N/A' PER_OTHERCITY
       , 'N/A' PER_OTHERSTATE
       , 'N/A' PER_OTHERPOSTALCODE
       , 'N/A' PER_OTHERCOUNTRY
       , 'N/A' PER_TAXSTREET
       , 'N/A' PER_TAXCITY
       , 'N/A' PER_TAXSTATE
       , 'N/A' PER_TAXPOSTALCODE
       , 'N/A' PER_TAXCOUNTRY
       , '-1' PER_ADDRESS_SELECTOR
       , 'N/A' PER_ADDRESS_SELECTED
       , '-1' PER_MAIL_ADD_SELECTOR
       , 'N/A' PER_MAIL_ADD_SELECTED
       , 'N/A' PER_WEB_PAGE
       , 'N/A' PER_ACTIVITY
       , '-1' PER_IS_CONTACT
       , '-1' PER_IS_EMPLOYEE
       , '-1' PER_IS_DEPENDENT
       , '-1' PER_IS_CANDIDAT
       , '-1' PER_IS_DELEGATE
       , '-1' PER_IS_TRAINER
       , '-1' PER_IS_RESPONSIBLE
       , '-1' PER_IS_QUICK_EDIT
       , 'N/A' EMP_OTHER_FIRSTNAME
       , 'N/A' EMP_MAIDEN_NAME
       , 'N/A' EMP_STATUS
       , 'N/A' EMP_NUMBER
       , 'N/A' EMP_SECONDARY_KEY
       , 'N/A' EMP_SOCIAL_SECURITYNO
       , 'DWH_NA' C_CIVIL_STATUS
       , to_date('00010101', 'YYYYMMDD') EMP_LAST_INTERVIEW
       , 'N/A' EMP_WORKINGAREA
       , 'DWH_NA' DIC_WORKREGION_ID
       , 'N/A' EMP_BIRTH_COUNTRY
       , 'N/A' EMP_NATIVE_OF
       , 'N/A' EMP_BIRTH_PLACE
       , '-1' EMP_CALCULATION
       , null EMP_CHILD_NB
       , 'N/A' EMP_HOBBIES
       , to_date('00010101', 'YYYYMMDD') EMP_LAST_PAY_DATE
       , null EMP_LAST_PAY_NUM
       , 'DWH_NA' DIC_RESPONSABILITY_ID
       , 'DWH_NA' DIC_JOB_ACTIVITY_ID
       , -1 COM_BITMAP_ID
       , -1 HRM_DIVISION_ID
       , null PER_ACTIVITY_RATE
       , -1 PC_LANG_ID
       , -1 HRM_JOB_ID
       , 'DWH_NA' DIC_WORKPLACE_ID
       , 'DWH_NA' DIC_DEPARTMENT_ID
       , 'DWH_NA' DIC_NATIONALITY_ID
       , 'DWH_NA' DIC_NATIONALITY2_ID
       , 'DWH_NA' DIC_NATIONALITY3_ID
       , '-1' EMP_MEATS_COST_SHARE
       , '-1' EMP_STOCK_OPTIONS
       , '-1' EMP_COMPANY_CAR
       , '-1' EMP_SEASON_TICKET
       , 'N/A' EMP_PASSWORD
       , '-1' EMP_PASS_CHANGE_ALLOWED
       , 'N/A' EMP_DRIVING_LICENCE
       , 'DWH_NA' DIC_NOTICE_TYPE_ID
       , 'DWH_NA' C_APPLICATION_TYPE
       , 'N/A' CAN_APPEAREANCE
       , 'N/A' CAN_CULTURE
       , 'N/A' CAN_DESCR
       , 'N/A' CAN_ELOCUTION
       , 'N/A' CAN_EVALUATION_COMMENT
       , to_date('00010101', 'YYYYMMDD') CAN_EVALUATION_DATE
       , 'N/A' CAN_INTEL
       , 'N/A' CAN_LAST_COMPANY
       , 'N/A' CAN_RELATION
       , null CAN_ACTUAL_SALARY
       , null CAN_WISHED_SALARY
       , 'N/A' CAN_APPLIED_JOB
       , 'N/A' CAN_CLASS_NUMBER
       , to_date('00010101', 'YYYYMMDD') CAN_DATE_FREE
       , '-1' CAN_FREE
       , to_date('00010101', 'YYYYMMDD') CAN_INITAL_DATE
       , 'DWH_NA' DIC_WORK_PERMIT_ID
       , 'DWH_NA' DIC_ACTIVITY_RATE_ID
       , 'DWH_NA' C_APPLICATION_STATUS
       , 'DWH_NA' DIC_MOBILITY_AREA_ID
       , -1 HRM_APPLICATION_ORIGIN_ID
       , -1 HRM_PROFILE_ID
       , 'DWH_NA' DIC_CONFESSION_ID
       , 'DWH_NA' DIC_CANTON_WORK_ID
       , to_date('00010101', 'YYYYMMDD') EMP_GROUP_ENTRY
       , '-1' EMP_OFS_INCLUDED
       , 'DWH_NA' C_OFS_TRAINING
       , 'DWH_NA' C_OFS_JOB_QUALIF
       , 'DWH_NA' C_OFS_ACTIVITY
       , 'DWH_NA' C_OFS_RESPONSABILITY
       , 'DWH_NA' C_OFS_SALARY_CONTRACT
       , 'DWH_NA' C_OFS_SALARY_TYPE
       , -1 HRM_CANDIDATE_RESP_ID
       , to_date('00010101', 'YYYYMMDD') EMP_LAST_PAY_DATE_AC
       , to_date('00010101', 'YYYYMMDD') EMP_CIVIL_STATUS_SINCE
       , 'N/A' EMP_MARRIAGE_PLACE
       , 'N/A' PER_SEARCH_NAME
       , 'DWH_NA' DIC_HRM_EMP_TYPE_ID
       , 'DWH_NA' C_HRM_GE_COHABITATION
       , 'DWH_NA' C_HRM_GE_RELIGION
       , 'DWH_NA' C_HRM_GE_HOMECITY
       , 'DWH_NA' C_HRM_GE_HOMESTATE
       , 'DWH_NA' C_HRM_GE_TAXPAYER
       , 'DWH_NA' C_HRM_GE_PROF_CAT
       , 'DWH_NA' C_HRM_GE_WORKCITY
       , 'N/A' EMP_SOCIAL_SECURITYNO2
       , '-1' EMP_SINGLE_PARENT
       , 'N/A' EMP_LPP_CONTRIBUTOR
       , 'N/A' PER_CARD_ID
       , 'N/A' PER_TAX_ID
       , 'N/A' PER_ADD1_FIELD01
       , 'N/A' PER_ADD1_FIELD02
       , 'N/A' PER_ADD1_FIELD03
       , 'N/A' PER_ADD1_FIELD04
       , 'N/A' PER_ADD1_FIELD05
       , 'N/A' PER_ADD1_FIELD06
       , 'N/A' PER_ADD1_FIELD07
       , 'N/A' PER_ADD1_FIELD08
       , 'N/A' PER_ADD2_FIELD01
       , 'N/A' PER_ADD2_FIELD02
       , 'N/A' PER_ADD2_FIELD03
       , 'N/A' PER_ADD2_FIELD04
       , 'N/A' PER_ADD2_FIELD05
       , 'N/A' PER_ADD2_FIELD06
       , 'N/A' PER_ADD2_FIELD07
       , 'N/A' PER_ADD2_FIELD08
       , 'N/A' PER_ADD3_FIELD01
       , 'N/A' PER_ADD3_FIELD02
       , 'N/A' PER_ADD3_FIELD03
       , 'N/A' PER_ADD3_FIELD04
       , 'N/A' PER_ADD3_FIELD05
       , 'N/A' PER_ADD3_FIELD06
       , 'N/A' PER_ADD3_FIELD07
       , 'N/A' PER_ADD3_FIELD08
       , 'N/A' PER_ADD4_FIELD01
       , 'N/A' PER_ADD4_FIELD02
       , 'N/A' PER_ADD4_FIELD03
       , 'N/A' PER_ADD4_FIELD04
       , 'N/A' PER_ADD4_FIELD05
       , 'N/A' PER_ADD4_FIELD06
       , 'N/A' PER_ADD4_FIELD07
       , 'N/A' PER_ADD4_FIELD08
       , 'N/A' PER_LAST_NAME_LOCAL
       , 'N/A' PER_FIRST_NAME_LOCAL
       , 'N/A' PER_PASS_ID
       , 'N/A' PER_PASS_ISSUED_BY
       , to_date('00010101', 'YYYYMMDD') PER_PASS_VALID_FROM
       , to_date('00010101', 'YYYYMMDD') PER_PASS_VALID_TO
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_PERSON_JOB" ("HRM_PERSON_JOB_ID", "HRM_JOB_ID", "HRM_IN_OUT_ID", "HRM_PERSON_ID", "PEJ_FROM", "PEJ_TO", "PEJ_AFFECT_RATE", "PEJ_MAIN_JOB", "PEJ_ANNUAL_SALARY", "PEJ_CLASSIFICATION", "PEJ_FREE_01", "PEJ_FREE_02", "PEJ_FREE_03", "PEJ_FREE_04", "PEJ_FREE_05", "PEJ_FREE_06", "PEJ_FREE_07", "PEJ_FREE_08", "PEJ_FREE_09", "PEJ_FREE_10") AS
  select HRM_PERSON_JOB_ID
       , Nvl(HRM_JOB_ID, -2) HRM_JOB_ID
       , Nvl(HRM_IN_OUT_ID, -2) HRM_IN_OUT_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(PEJ_FROM, to_date('40000101', 'YYYYMMDD') ) PEJ_FROM
       , Nvl(PEJ_TO, to_date('40000101', 'YYYYMMDD') ) PEJ_TO
       , PEJ_AFFECT_RATE
       , Nvl2(PEJ_MAIN_JOB, case
                when(PEJ_MAIN_JOB = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PEJ_MAIN_JOB
       , PEJ_ANNUAL_SALARY
       , Nvl(PEJ_CLASSIFICATION, '_') PEJ_CLASSIFICATION
       , Nvl(PEJ_FREE_01, '_') PEJ_FREE_01
       , Nvl(PEJ_FREE_02, '_') PEJ_FREE_02
       , Nvl(PEJ_FREE_03, '_') PEJ_FREE_03
       , Nvl(PEJ_FREE_04, '_') PEJ_FREE_04
       , Nvl(PEJ_FREE_05, '_') PEJ_FREE_05
       , Nvl(PEJ_FREE_06, '_') PEJ_FREE_06
       , Nvl(PEJ_FREE_07, '_') PEJ_FREE_07
       , Nvl(PEJ_FREE_08, '_') PEJ_FREE_08
       , Nvl(PEJ_FREE_09, '_') PEJ_FREE_09
       , Nvl(PEJ_FREE_10, '_') PEJ_FREE_10
  from HRM_PERSON_JOB
  union all
  select -1 HRM_PERSON_JOB_ID
       , -1 HRM_JOB_ID
       , -1 HRM_IN_OUT_ID
       , -1 HRM_PERSON_ID
       , to_date('00010101', 'YYYYMMDD') PEJ_FROM
       , to_date('00010101', 'YYYYMMDD') PEJ_TO
       , null PEJ_AFFECT_RATE
       , '-1' PEJ_MAIN_JOB
       , null PEJ_ANNUAL_SALARY
       , 'N/A' PEJ_CLASSIFICATION
       , 'N/A' PEJ_FREE_01
       , 'N/A' PEJ_FREE_02
       , 'N/A' PEJ_FREE_03
       , 'N/A' PEJ_FREE_04
       , 'N/A' PEJ_FREE_05
       , 'N/A' PEJ_FREE_06
       , 'N/A' PEJ_FREE_07
       , 'N/A' PEJ_FREE_08
       , 'N/A' PEJ_FREE_09
       , 'N/A' PEJ_FREE_10
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_HRM_PERSON_TAX" ("HRM_PERSON_TAX_ID", "EMP_TAX_YEAR", "HRM_PERSON_ID", "C_HRM_TAX_CERTIF_TYPE", "C_HRM_CANTON_TAX_CAR", "C_HRM_CANTON_TAX_SHARE", "C_HRM_CANTON_TAX_FEES", "DIC_HRM_TAX_SHARE_REASON_ID", "DIC_HRM_TAX_SHARE_REASON2_ID", "EMP_TAX_IS_EXPATRIATE", "EMP_TAX_CAR_DATE", "EMP_TAX_FULLFILLED", "EMP_TAX_SHARE_DATE", "EMP_TAX_EXPAT_EXPENSES", "EMP_TAX_OTHER_BENEFITS", "EMP_TAX_FEES_DATE", "EMP_TAX_THIRD_SHARE", "EMP_TAX_THIRD_SHARE_NAME", "EMP_TAX_CHILD_ALLOW_PERAVS", "EMP_TAX_RELOCATION_COSTS", "EMP_TAX_CAR_CHECK", "EMP_CARRIER_FREE", "EMP_CANTEEN", "EMP_CERTIF_OBSERVATION", "EMP_TAX_CONTACT_NAME", "EMP_TAX_CONTACT_PHONE", "EMP_TAX_CONTACT_EMAIL", "EMP_TAX_CONTACT_ZIP", "EMP_TAX_CONTACT_CITY", "EMP_TAX_CAR_MIN_PART", "EMP_TAX_REMARK_LINE01", "EMP_TAX_REMARK_LINE02", "EMP_TAX_REMARK_LINE03", "EMP_TAX_REMARK_LINE04", "EMP_TAX_REMARK_LINE05", "EMP_TAX_REMARK_LINE06", "EMP_TAX_REMARK_LINE07", "EMP_TAX_REMARK_LINE08", "EMP_TAX_REMARK_LINE09", "EMP_TAX_REMARK_LINE10") AS
  select HRM_PERSON_TAX_ID
       , Nvl(EMP_TAX_YEAR, '_') EMP_TAX_YEAR
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(C_HRM_TAX_CERTIF_TYPE, 'DWH_ISNULL') C_HRM_TAX_CERTIF_TYPE
       , Nvl(C_HRM_CANTON_TAX_CAR, 'DWH_ISNULL') C_HRM_CANTON_TAX_CAR
       , Nvl(C_HRM_CANTON_TAX_SHARE, 'DWH_ISNULL') C_HRM_CANTON_TAX_SHARE
       , Nvl(C_HRM_CANTON_TAX_FEES, 'DWH_ISNULL') C_HRM_CANTON_TAX_FEES
       , Nvl(DIC_HRM_TAX_SHARE_REASON_ID, 'DWH_ISNULL') DIC_HRM_TAX_SHARE_REASON_ID
       , Nvl(DIC_HRM_TAX_SHARE_REASON2_ID, 'DWH_ISNULL') DIC_HRM_TAX_SHARE_REASON2_ID
       , Nvl2(EMP_TAX_IS_EXPATRIATE, case
                when (EMP_TAX_IS_EXPATRIATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_IS_EXPATRIATE
       , Nvl(EMP_TAX_CAR_DATE, to_date('40000101', 'YYYYMMDD') ) EMP_TAX_CAR_DATE
       , Nvl2(EMP_TAX_FULLFILLED, case
                when (EMP_TAX_FULLFILLED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_FULLFILLED
       , Nvl(EMP_TAX_SHARE_DATE, to_date('40000101', 'YYYYMMDD') ) EMP_TAX_SHARE_DATE
       , Nvl2(EMP_TAX_EXPAT_EXPENSES, case
                when (EMP_TAX_EXPAT_EXPENSES = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_EXPAT_EXPENSES
       , Nvl(EMP_TAX_OTHER_BENEFITS, '_') EMP_TAX_OTHER_BENEFITS
       , Nvl(EMP_TAX_FEES_DATE, to_date('40000101', 'YYYYMMDD') ) EMP_TAX_FEES_DATE
       , Nvl2(EMP_TAX_THIRD_SHARE, case
                when (EMP_TAX_THIRD_SHARE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_THIRD_SHARE
       , Nvl(EMP_TAX_THIRD_SHARE_NAME, '_') EMP_TAX_THIRD_SHARE_NAME
       , Nvl2(EMP_TAX_CHILD_ALLOW_PERAVS, case
                when (EMP_TAX_CHILD_ALLOW_PERAVS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_CHILD_ALLOW_PERAVS
       , EMP_TAX_RELOCATION_COSTS
       , Nvl2(EMP_TAX_CAR_CHECK, case
                when (EMP_TAX_CAR_CHECK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_CAR_CHECK
       , Nvl2(EMP_CARRIER_FREE, case
                when (EMP_CARRIER_FREE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_CARRIER_FREE
       , Nvl2(EMP_CANTEEN, case
                when (EMP_CANTEEN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_CANTEEN
       , Nvl(EMP_CERTIF_OBSERVATION, '_') EMP_CERTIF_OBSERVATION
       , Nvl(EMP_TAX_CONTACT_NAME, '_') EMP_TAX_CONTACT_NAME
       , Nvl(EMP_TAX_CONTACT_PHONE, '_') EMP_TAX_CONTACT_PHONE
       , Nvl(EMP_TAX_CONTACT_EMAIL, '_') EMP_TAX_CONTACT_EMAIL
       , Nvl(EMP_TAX_CONTACT_ZIP, '_') EMP_TAX_CONTACT_ZIP
       , Nvl(EMP_TAX_CONTACT_CITY, '_') EMP_TAX_CONTACT_CITY
       , Nvl2(EMP_TAX_CAR_MIN_PART, case
                when (EMP_TAX_CAR_MIN_PART = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') EMP_TAX_CAR_MIN_PART
       , Nvl(EMP_TAX_REMARK_LINE01, '_') EMP_TAX_REMARK_LINE01
       , Nvl(EMP_TAX_REMARK_LINE02, '_') EMP_TAX_REMARK_LINE02
       , Nvl(EMP_TAX_REMARK_LINE03, '_') EMP_TAX_REMARK_LINE03
       , Nvl(EMP_TAX_REMARK_LINE04, '_') EMP_TAX_REMARK_LINE04
       , Nvl(EMP_TAX_REMARK_LINE05, '_') EMP_TAX_REMARK_LINE05
       , Nvl(EMP_TAX_REMARK_LINE06, '_') EMP_TAX_REMARK_LINE06
       , Nvl(EMP_TAX_REMARK_LINE07, '_') EMP_TAX_REMARK_LINE07
       , Nvl(EMP_TAX_REMARK_LINE08, '_') EMP_TAX_REMARK_LINE08
       , Nvl(EMP_TAX_REMARK_LINE09, '_') EMP_TAX_REMARK_LINE09
       , Nvl(EMP_TAX_REMARK_LINE10, '_') EMP_TAX_REMARK_LINE10
  from HRM_PERSON_TAX
  union all
  select -1 HRM_PERSON_TAX_ID
       , 'N/A' EMP_TAX_YEAR
       , -1 HRM_PERSON_ID
       , 'DWH_NA' C_HRM_TAX_CERTIF_TYPE
       , 'DWH_NA' C_HRM_CANTON_TAX_CAR
       , 'DWH_NA' C_HRM_CANTON_TAX_SHARE
       , 'DWH_NA' C_HRM_CANTON_TAX_FEES
       , 'DWH_NA' DIC_HRM_TAX_SHARE_REASON_ID
       , 'DWH_NA' DIC_HRM_TAX_SHARE_REASON2_ID
       , '-1' EMP_TAX_IS_EXPATRIATE
       , to_date('00010101', 'YYYYMMDD') EMP_TAX_CAR_DATE
       , '-1' EMP_TAX_FULLFILLED
       , to_date('00010101', 'YYYYMMDD') EMP_TAX_SHARE_DATE
       , '-1' EMP_TAX_EXPAT_EXPENSES
       , 'N/A' EMP_TAX_OTHER_BENEFITS
       , to_date('00010101', 'YYYYMMDD') EMP_TAX_FEES_DATE
       , '-1' EMP_TAX_THIRD_SHARE
       , 'N/A' EMP_TAX_THIRD_SHARE_NAME
       , '-1' EMP_TAX_CHILD_ALLOW_PERAVS
       , null EMP_TAX_RELOCATION_COSTS
       , '-1' EMP_TAX_CAR_CHECK
       , '-1' EMP_CARRIER_FREE
       , '-1' EMP_CANTEEN
       , 'N/A' EMP_CERTIF_OBSERVATION
       , 'N/A' EMP_TAX_CONTACT_NAME
       , 'N/A' EMP_TAX_CONTACT_PHONE
       , 'N/A' EMP_TAX_CONTACT_EMAIL
       , 'N/A' EMP_TAX_CONTACT_ZIP
       , 'N/A' EMP_TAX_CONTACT_CITY
       , '-1' EMP_TAX_CAR_MIN_PART
       , 'N/A' EMP_TAX_REMARK_LINE01
       , 'N/A' EMP_TAX_REMARK_LINE02
       , 'N/A' EMP_TAX_REMARK_LINE03
       , 'N/A' EMP_TAX_REMARK_LINE04
       , 'N/A' EMP_TAX_REMARK_LINE05
       , 'N/A' EMP_TAX_REMARK_LINE06
       , 'N/A' EMP_TAX_REMARK_LINE07
       , 'N/A' EMP_TAX_REMARK_LINE08
       , 'N/A' EMP_TAX_REMARK_LINE09
       , 'N/A' EMP_TAX_REMARK_LINE10
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_ADDRESS" ("PAC_ADDRESS_ID", "PAC_PERSON_ID", "PC_CNTRY_ID", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "PC_LANG_ID", "ADD_COMMENT", "DIC_ADDRESS_TYPE_ID", "ADD_SINCE", "ADD_FORMAT", "ADD_PRINCIPAL", "C_PARTNER_STATUS", "ADD_PRIORITY", "ADD_CARE_OF", "ADD_PO_BOX", "ADD_PO_BOX_NBR", "ADD_COUNTY") AS
  select PAC_ADDRESS_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(PC_CNTRY_ID, -2) PC_CNTRY_ID
       , Nvl(ADD_ADDRESS1, '_') ADD_ADDRESS1
       , Nvl(ADD_ZIPCODE, '_') ADD_ZIPCODE
       , Nvl(ADD_CITY, '_') ADD_CITY
       , Nvl(ADD_STATE, '_') ADD_STATE
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(ADD_COMMENT, '_') ADD_COMMENT
       , Nvl(DIC_ADDRESS_TYPE_ID, 'DWH_ISNULL') DIC_ADDRESS_TYPE_ID
       , Nvl(ADD_SINCE, to_date('40000101', 'YYYYMMDD') ) ADD_SINCE
       , Nvl(ADD_FORMAT, '_') ADD_FORMAT
       , Nvl2(ADD_PRINCIPAL, case
                when(ADD_PRINCIPAL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') ADD_PRINCIPAL
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , ADD_PRIORITY
       , Nvl(ADD_CARE_OF, '_') ADD_CARE_OF
       , Nvl(ADD_PO_BOX, '_') ADD_PO_BOX
       , ADD_PO_BOX_NBR
       , Nvl(ADD_COUNTY, '_') ADD_COUNTY
  from PAC_ADDRESS
  union all
  select -1 PAC_ADDRESS_ID
       , -1 PAC_PERSON_ID
       , -1 PC_CNTRY_ID
       , 'N/A' ADD_ADDRESS1
       , 'N/A' ADD_ZIPCODE
       , 'N/A' ADD_CITY
       , 'N/A' ADD_STATE
       , -1 PC_LANG_ID
       , 'N/A' ADD_COMMENT
       , 'DWH_NA' DIC_ADDRESS_TYPE_ID
       , to_date('00010101', 'YYYYMMDD') ADD_SINCE
       , 'N/A' ADD_FORMAT
       , '-1' ADD_PRINCIPAL
       , 'DWH_NA' C_PARTNER_STATUS
       , null ADD_PRIORITY
       , 'N/A' ADD_CARE_OF
       , 'N/A' ADD_PO_BOX
       , null ADD_PO_BOX_NBR
       , 'N/A' ADD_COUNTY
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_CUSTOM_PARTNER" ("PAC_CUSTOM_PARTNER_ID", "DIC_TYPE_SUBMISSION_ID", "DIC_STATISTIC_1_ID", "DIC_TYPE_PARTNER_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "PAC_REMAINDER_CATEGORY_ID", "PAC_PAYMENT_CONDITION_ID", "ACS_AUXILIARY_ACCOUNT_ID", "C_REMAINDER_LAUNCHING", "PAC_ADDRESS_ID", "CUS_COMMENT", "DIC_TARIFF_ID", "ACS_VAT_DET_ACCOUNT_ID", "C_TARIFFICATION_MODE", "C_PARTNER_CATEGORY", "PAC_REPRESENTATIVE_ID", "PAC_SENDING_CONDITION_ID", "PAC_CALENDAR_TYPE_ID", "C_TYPE_EDI", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "CUS_WITHOUT_REMIND_DATE", "DIC_COMPLEMENTARY_DATA_ID", "CUS_SUP_COPY1", "CUS_SUP_COPY2", "CUS_SUP_COPY3", "CUS_SUP_COPY4", "CUS_SUP_COPY5", "ACS_FIN_ACC_S_PAYMENT_ID", "C_STATUS_SETTLEMENT", "C_PARTNER_STATUS", "CUS_RATE_FOR_VALUE", "CUS_PERIODIC_INVOICING", "CUS_PERIODIC_DELIVERY", "C_RESERVATION_TYP", "C_DELIVERY_TYP", "C_BVR_GENERATION_METHOD", "CUS_SUP_COPY6", "CUS_SUP_COPY7", "CUS_SUP_COPY8", "CUS_SUP_COPY9", "CUS_SUP_COPY10", "C_DOC_CREATION", "CUS_MIN_INVOICING", "CUS_DELIVERY_DELAY", "DIC_DELIVERY_PERIOD_ID", "C_DOC_CREATION_INVOICE", "DIC_INVOICING_PERIOD_ID", "CUS_MIN_INVOICING_DELAY", "C_INCOTERMS", "DIC_PIC_GROUP_ID", "CUS_DATA_EXPORT", "CUS_SUPPLIER_NUMBER", "CUS_EAN_NUMBER", "DOC_GAUGE_ID", "DOC_DOC_GAUGE_ID", "CUS_PAYMENT_FACTOR", "CUS_ADAPTED_FACTOR", "CUS_PAYMENT_FACTOR_DATE", "CUS_ADAPTED_FACTOR_DATE", "PAC_PAC_THIRD_1_ID", "PAC_PAC_THIRD_2_ID", "CUS_INCOTERMS_PLACE", "DIC_PTC_THIRD_GROUP_ID", "PC_APPLTXT_ID", "PC__PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "PC_3_PC_APPLTXT_ID", "PC_4_PC_APPLTXT_ID", "CUS_LAPSING_MARGE", "C_MATERIAL_MGNT_MODE", "C_THIRD_MATERIAL_RELATION_TYPE", "C_WEIGHING_MGNT", "CUS_ADV_MATERIAL_MGNT", "C_ADV_MATERIAL_MODE", "CUS_TARIFF_BY_SET", "STM_STOCK_ID", "CUS_METAL_ACCOUNT", "COM_NAME", "CUS_NO_REM_CHARGE", "CUS_NO_MORATORIUM_INTEREST", "PAC_DISTRIBUTION_CHANNEL_ID", "PAC_SALE_TERRITORY_ID", "PAC_SCHEDULE_ID") AS
  select PAC_CUSTOM_PARTNER_ID
       , Nvl(DIC_TYPE_SUBMISSION_ID, 'DWH_ISNULL') DIC_TYPE_SUBMISSION_ID
       , Nvl(DIC_STATISTIC_1_ID, 'DWH_ISNULL') DIC_STATISTIC_1_ID
       , Nvl(DIC_TYPE_PARTNER_ID, 'DWH_ISNULL') DIC_TYPE_PARTNER_ID
       , Nvl(DIC_STATISTIC_2_ID, 'DWH_ISNULL') DIC_STATISTIC_2_ID
       , Nvl(DIC_STATISTIC_3_ID, 'DWH_ISNULL') DIC_STATISTIC_3_ID
       , Nvl(DIC_STATISTIC_4_ID, 'DWH_ISNULL') DIC_STATISTIC_4_ID
       , Nvl(DIC_STATISTIC_5_ID, 'DWH_ISNULL') DIC_STATISTIC_5_ID
       , Nvl(PAC_REMAINDER_CATEGORY_ID, -2) PAC_REMAINDER_CATEGORY_ID
       , Nvl(PAC_PAYMENT_CONDITION_ID, -2) PAC_PAYMENT_CONDITION_ID
       , Nvl(ACS_AUXILIARY_ACCOUNT_ID, -2) ACS_AUXILIARY_ACCOUNT_ID
       , Nvl(C_REMAINDER_LAUNCHING, 'DWH_ISNULL') C_REMAINDER_LAUNCHING
       , Nvl(PAC_ADDRESS_ID, -2) PAC_ADDRESS_ID
       , Nvl(CUS_COMMENT, '_') CUS_COMMENT
       , Nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , Nvl(ACS_VAT_DET_ACCOUNT_ID, -2) ACS_VAT_DET_ACCOUNT_ID
       , Nvl(C_TARIFFICATION_MODE, 'DWH_ISNULL') C_TARIFFICATION_MODE
       , Nvl(C_PARTNER_CATEGORY, 'DWH_ISNULL') C_PARTNER_CATEGORY
       , Nvl(PAC_REPRESENTATIVE_ID, -2) PAC_REPRESENTATIVE_ID
       , Nvl(PAC_SENDING_CONDITION_ID, -2) PAC_SENDING_CONDITION_ID
       , Nvl(PAC_CALENDAR_TYPE_ID, -2) PAC_CALENDAR_TYPE_ID
       , Nvl(C_TYPE_EDI, 'DWH_ISNULL') C_TYPE_EDI
       , Nvl(CUS_FREE_ZONE1, '_') CUS_FREE_ZONE1
       , Nvl(CUS_FREE_ZONE2, '_') CUS_FREE_ZONE2
       , Nvl(CUS_FREE_ZONE3, '_') CUS_FREE_ZONE3
       , Nvl(CUS_FREE_ZONE4, '_') CUS_FREE_ZONE4
       , Nvl(CUS_FREE_ZONE5, '_') CUS_FREE_ZONE5
       , Nvl(CUS_WITHOUT_REMIND_DATE, to_date('40000101', 'YYYYMMDD') ) CUS_WITHOUT_REMIND_DATE
       , Nvl(DIC_COMPLEMENTARY_DATA_ID, 'DWH_ISNULL') DIC_COMPLEMENTARY_DATA_ID
       , CUS_SUP_COPY1
       , CUS_SUP_COPY2
       , CUS_SUP_COPY3
       , CUS_SUP_COPY4
       , CUS_SUP_COPY5
       , Nvl(ACS_FIN_ACC_S_PAYMENT_ID, -2) ACS_FIN_ACC_S_PAYMENT_ID
       , Nvl(C_STATUS_SETTLEMENT, 'DWH_ISNULL') C_STATUS_SETTLEMENT
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , CUS_RATE_FOR_VALUE
       , Nvl2(CUS_PERIODIC_INVOICING, case
                when(CUS_PERIODIC_INVOICING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_PERIODIC_INVOICING
       , Nvl2(CUS_PERIODIC_DELIVERY, case
                when(CUS_PERIODIC_DELIVERY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_PERIODIC_DELIVERY
       , Nvl(C_RESERVATION_TYP, 'DWH_ISNULL') C_RESERVATION_TYP
       , Nvl(C_DELIVERY_TYP, 'DWH_ISNULL') C_DELIVERY_TYP
       , Nvl(C_BVR_GENERATION_METHOD, 'DWH_ISNULL') C_BVR_GENERATION_METHOD
       , CUS_SUP_COPY6
       , CUS_SUP_COPY7
       , CUS_SUP_COPY8
       , CUS_SUP_COPY9
       , CUS_SUP_COPY10
       , Nvl(C_DOC_CREATION, 'DWH_ISNULL') C_DOC_CREATION
       , CUS_MIN_INVOICING
       , CUS_DELIVERY_DELAY
       , Nvl(DIC_DELIVERY_PERIOD_ID, 'DWH_ISNULL') DIC_DELIVERY_PERIOD_ID
       , Nvl(C_DOC_CREATION_INVOICE, 'DWH_ISNULL') C_DOC_CREATION_INVOICE
       , Nvl(DIC_INVOICING_PERIOD_ID, 'DWH_ISNULL') DIC_INVOICING_PERIOD_ID
       , CUS_MIN_INVOICING_DELAY
       , Nvl(C_INCOTERMS, 'DWH_ISNULL') C_INCOTERMS
       , Nvl(DIC_PIC_GROUP_ID, 'DWH_ISNULL') DIC_PIC_GROUP_ID
       , Nvl(CUS_DATA_EXPORT, '_') CUS_DATA_EXPORT
       , Nvl(CUS_SUPPLIER_NUMBER, '_') CUS_SUPPLIER_NUMBER
       , Nvl(CUS_EAN_NUMBER, '_') CUS_EAN_NUMBER
       , Nvl(DOC_GAUGE_ID, -2) DOC_GAUGE_ID
       , Nvl(DOC_DOC_GAUGE_ID, -2) DOC_DOC_GAUGE_ID
       , CUS_PAYMENT_FACTOR
       , CUS_ADAPTED_FACTOR
       , Nvl(CUS_PAYMENT_FACTOR_DATE, to_date('40000101', 'YYYYMMDD') ) CUS_PAYMENT_FACTOR_DATE
       , Nvl(CUS_ADAPTED_FACTOR_DATE, to_date('40000101', 'YYYYMMDD') ) CUS_ADAPTED_FACTOR_DATE
       , Nvl(PAC_PAC_THIRD_1_ID, -2) PAC_PAC_THIRD_1_ID
       , Nvl(PAC_PAC_THIRD_2_ID, -2) PAC_PAC_THIRD_2_ID
       , Nvl(CUS_INCOTERMS_PLACE, '_') CUS_INCOTERMS_PLACE
       , Nvl(DIC_PTC_THIRD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_THIRD_GROUP_ID
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl(PC__PC_APPLTXT_ID, -2) PC__PC_APPLTXT_ID
       , Nvl(PC_2_PC_APPLTXT_ID, -2) PC_2_PC_APPLTXT_ID
       , Nvl(PC_3_PC_APPLTXT_ID, -2) PC_3_PC_APPLTXT_ID
       , Nvl(PC_4_PC_APPLTXT_ID, -2) PC_4_PC_APPLTXT_ID
       , CUS_LAPSING_MARGE
       , Nvl(C_MATERIAL_MGNT_MODE, 'DWH_ISNULL') C_MATERIAL_MGNT_MODE
       , Nvl(C_THIRD_MATERIAL_RELATION_TYPE, 'DWH_ISNULL') C_THIRD_MATERIAL_RELATION_TYPE
       , Nvl(C_WEIGHING_MGNT, 'DWH_ISNULL') C_WEIGHING_MGNT
       , Nvl2(CUS_ADV_MATERIAL_MGNT, case
                when(CUS_ADV_MATERIAL_MGNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_ADV_MATERIAL_MGNT
       , Nvl(C_ADV_MATERIAL_MODE, 'DWH_ISNULL') C_ADV_MATERIAL_MODE
       , Nvl2(CUS_TARIFF_BY_SET, case
                when(CUS_TARIFF_BY_SET = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_TARIFF_BY_SET
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl2(CUS_METAL_ACCOUNT, case
                when(CUS_METAL_ACCOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_METAL_ACCOUNT
       , Nvl(COM_NAME, '_') COM_NAME
       , Nvl2(CUS_NO_REM_CHARGE, case
                when(CUS_NO_REM_CHARGE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_NO_REM_CHARGE
       , Nvl2(CUS_NO_MORATORIUM_INTEREST, case
                when(CUS_NO_MORATORIUM_INTEREST = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CUS_NO_MORATORIUM_INTEREST
       , Nvl(PAC_DISTRIBUTION_CHANNEL_ID, -2) PAC_DISTRIBUTION_CHANNEL_ID
       , Nvl(PAC_SALE_TERRITORY_ID, -2) PAC_SALE_TERRITORY_ID
       , Nvl(PAC_SCHEDULE_ID, -2) PAC_SCHEDULE_ID
  from PAC_CUSTOM_PARTNER
  union all
  select -1 PAC_CUSTOM_PARTNER_ID
       , 'DWH_NA' DIC_TYPE_SUBMISSION_ID
       , 'DWH_NA' DIC_STATISTIC_1_ID
       , 'DWH_NA' DIC_TYPE_PARTNER_ID
       , 'DWH_NA' DIC_STATISTIC_2_ID
       , 'DWH_NA' DIC_STATISTIC_3_ID
       , 'DWH_NA' DIC_STATISTIC_4_ID
       , 'DWH_NA' DIC_STATISTIC_5_ID
       , -1 PAC_REMAINDER_CATEGORY_ID
       , -1 PAC_PAYMENT_CONDITION_ID
       , -1 ACS_AUXILIARY_ACCOUNT_ID
       , 'DWH_NA' C_REMAINDER_LAUNCHING
       , -1 PAC_ADDRESS_ID
       , 'N/A' CUS_COMMENT
       , 'DWH_NA' DIC_TARIFF_ID
       , -1 ACS_VAT_DET_ACCOUNT_ID
       , 'DWH_NA' C_TARIFFICATION_MODE
       , 'DWH_NA' C_PARTNER_CATEGORY
       , -1 PAC_REPRESENTATIVE_ID
       , -1 PAC_SENDING_CONDITION_ID
       , -1 PAC_CALENDAR_TYPE_ID
       , 'DWH_NA' C_TYPE_EDI
       , 'N/A' CUS_FREE_ZONE1
       , 'N/A' CUS_FREE_ZONE2
       , 'N/A' CUS_FREE_ZONE3
       , 'N/A' CUS_FREE_ZONE4
       , 'N/A' CUS_FREE_ZONE5
       , to_date('00010101', 'YYYYMMDD') CUS_WITHOUT_REMIND_DATE
       , 'DWH_NA' DIC_COMPLEMENTARY_DATA_ID
       , null CUS_SUP_COPY1
       , null CUS_SUP_COPY2
       , null CUS_SUP_COPY3
       , null CUS_SUP_COPY4
       , null CUS_SUP_COPY5
       , -1 ACS_FIN_ACC_S_PAYMENT_ID
       , 'DWH_NA' C_STATUS_SETTLEMENT
       , 'DWH_NA' C_PARTNER_STATUS
       , null CUS_RATE_FOR_VALUE
       , '-1' CUS_PERIODIC_INVOICING
       , '-1' CUS_PERIODIC_DELIVERY
       , 'DWH_NA' C_RESERVATION_TYP
       , 'DWH_NA' C_DELIVERY_TYP
       , 'DWH_NA' C_BVR_GENERATION_METHOD
       , null CUS_SUP_COPY6
       , null CUS_SUP_COPY7
       , null CUS_SUP_COPY8
       , null CUS_SUP_COPY9
       , null CUS_SUP_COPY10
       , 'DWH_NA' C_DOC_CREATION
       , null CUS_MIN_INVOICING
       , null CUS_DELIVERY_DELAY
       , 'DWH_NA' DIC_DELIVERY_PERIOD_ID
       , 'DWH_NA' C_DOC_CREATION_INVOICE
       , 'DWH_NA' DIC_INVOICING_PERIOD_ID
       , null CUS_MIN_INVOICING_DELAY
       , 'DWH_NA' C_INCOTERMS
       , 'DWH_NA' DIC_PIC_GROUP_ID
       , 'N/A' CUS_DATA_EXPORT
       , 'N/A' CUS_SUPPLIER_NUMBER
       , 'N/A' CUS_EAN_NUMBER
       , -1 DOC_GAUGE_ID
       , -1 DOC_DOC_GAUGE_ID
       , null CUS_PAYMENT_FACTOR
       , null CUS_ADAPTED_FACTOR
       , to_date('00010101', 'YYYYMMDD') CUS_PAYMENT_FACTOR_DATE
       , to_date('00010101', 'YYYYMMDD') CUS_ADAPTED_FACTOR_DATE
       , -1 PAC_PAC_THIRD_1_ID
       , -1 PAC_PAC_THIRD_2_ID
       , 'N/A' CUS_INCOTERMS_PLACE
       , 'DWH_NA' DIC_PTC_THIRD_GROUP_ID
       , -1 PC_APPLTXT_ID
       , -1 PC__PC_APPLTXT_ID
       , -1 PC_2_PC_APPLTXT_ID
       , -1 PC_3_PC_APPLTXT_ID
       , -1 PC_4_PC_APPLTXT_ID
       , null CUS_LAPSING_MARGE
       , 'DWH_NA' C_MATERIAL_MGNT_MODE
       , 'DWH_NA' C_THIRD_MATERIAL_RELATION_TYPE
       , 'DWH_NA' C_WEIGHING_MGNT
       , '-1' CUS_ADV_MATERIAL_MGNT
       , 'DWH_NA' C_ADV_MATERIAL_MODE
       , '-1' CUS_TARIFF_BY_SET
       , -1 STM_STOCK_ID
       , '-1' CUS_METAL_ACCOUNT
       , 'N/A' COM_NAME
       , '-1' CUS_NO_REM_CHARGE
       , '-1' CUS_NO_MORATORIUM_INTEREST
       , -1 PAC_DISTRIBUTION_CHANNEL_ID
       , -1 PAC_SALE_TERRITORY_ID
       , -1 PAC_SCHEDULE_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_DISTRIBUTI_CHANNEL" ("PAC_DISTRIBUTION_CHANNEL_ID", "PDC_KEY", "PDC_DESCRIPTION", "PDC_COMMENT", "PDC_NUMBER1", "PDC_NUMBER2", "PDC_NUMBER3", "PDC_NUMBER4", "PDC_NUMBER5", "PDC_MEMO1", "PDC_MEMO2", "PDC_MEMO3", "PDC_MEMO4", "PDC_MEMO5", "PDC_TEXT1", "PDC_TEXT2", "PDC_TEXT3", "PDC_TEXT4", "PDC_TEXT5", "PDC_BOOLEAN1", "PDC_BOOLEAN2", "PDC_BOOLEAN3", "PDC_BOOLEAN4", "PDC_BOOLEAN5", "PDC_DATE1", "PDC_DATE2", "PDC_DATE3", "PDC_DATE4", "PDC_DATE5", "C_PARTNER_STATUS", "DIC_PAC_DIST_CHANNEL_FREE1_ID", "DIC_PAC_DIST_CHANNEL_FREE2_ID", "DIC_PAC_DIST_CHANNEL_FREE3_ID", "DIC_PAC_DIST_CHANNEL_FREE4_ID", "DIC_PAC_DIST_CHANNEL_FREE5_ID") AS
  select PAC_DISTRIBUTION_CHANNEL_ID
       , Nvl(PDC_KEY, '_') PDC_KEY
       , Nvl(PDC_DESCRIPTION, '_') PDC_DESCRIPTION
       , Nvl(PDC_COMMENT, '_') PDC_COMMENT
       , PDC_NUMBER1
       , PDC_NUMBER2
       , PDC_NUMBER3
       , PDC_NUMBER4
       , PDC_NUMBER5
       , Nvl(PDC_MEMO1, '_') PDC_MEMO1
       , Nvl(PDC_MEMO2, '_') PDC_MEMO2
       , Nvl(PDC_MEMO3, '_') PDC_MEMO3
       , Nvl(PDC_MEMO4, '_') PDC_MEMO4
       , Nvl(PDC_MEMO5, '_') PDC_MEMO5
       , Nvl(PDC_TEXT1, '_') PDC_TEXT1
       , Nvl(PDC_TEXT2, '_') PDC_TEXT2
       , Nvl(PDC_TEXT3, '_') PDC_TEXT3
       , Nvl(PDC_TEXT4, '_') PDC_TEXT4
       , Nvl(PDC_TEXT5, '_') PDC_TEXT5
       , Nvl2(PDC_BOOLEAN1, case
                when(PDC_BOOLEAN1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDC_BOOLEAN1
       , Nvl2(PDC_BOOLEAN2, case
                when(PDC_BOOLEAN2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDC_BOOLEAN2
       , Nvl2(PDC_BOOLEAN3, case
                when(PDC_BOOLEAN3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDC_BOOLEAN3
       , Nvl2(PDC_BOOLEAN4, case
                when(PDC_BOOLEAN4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDC_BOOLEAN4
       , Nvl2(PDC_BOOLEAN5, case
                when(PDC_BOOLEAN5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PDC_BOOLEAN5
       , Nvl(PDC_DATE1, to_date('40000101', 'YYYYMMDD') ) PDC_DATE1
       , Nvl(PDC_DATE2, to_date('40000101', 'YYYYMMDD') ) PDC_DATE2
       , Nvl(PDC_DATE3, to_date('40000101', 'YYYYMMDD') ) PDC_DATE3
       , Nvl(PDC_DATE4, to_date('40000101', 'YYYYMMDD') ) PDC_DATE4
       , Nvl(PDC_DATE5, to_date('40000101', 'YYYYMMDD') ) PDC_DATE5
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , Nvl(DIC_PAC_DIST_CHANNEL_FREE1_ID, 'DWH_ISNULL') DIC_PAC_DIST_CHANNEL_FREE1_ID
       , Nvl(DIC_PAC_DIST_CHANNEL_FREE2_ID, 'DWH_ISNULL') DIC_PAC_DIST_CHANNEL_FREE2_ID
       , Nvl(DIC_PAC_DIST_CHANNEL_FREE3_ID, 'DWH_ISNULL') DIC_PAC_DIST_CHANNEL_FREE3_ID
       , Nvl(DIC_PAC_DIST_CHANNEL_FREE4_ID, 'DWH_ISNULL') DIC_PAC_DIST_CHANNEL_FREE4_ID
       , Nvl(DIC_PAC_DIST_CHANNEL_FREE5_ID, 'DWH_ISNULL') DIC_PAC_DIST_CHANNEL_FREE5_ID
  from PAC_DISTRIBUTION_CHANNEL
  union all
  select -1 PAC_DISTRIBUTION_CHANNEL_ID
       , 'N/A' PDC_KEY
       , 'N/A' PDC_DESCRIPTION
       , 'N/A' PDC_COMMENT
       , null PDC_NUMBER1
       , null PDC_NUMBER2
       , null PDC_NUMBER3
       , null PDC_NUMBER4
       , null PDC_NUMBER5
       , 'N/A' PDC_MEMO1
       , 'N/A' PDC_MEMO2
       , 'N/A' PDC_MEMO3
       , 'N/A' PDC_MEMO4
       , 'N/A' PDC_MEMO5
       , 'N/A' PDC_TEXT1
       , 'N/A' PDC_TEXT2
       , 'N/A' PDC_TEXT3
       , 'N/A' PDC_TEXT4
       , 'N/A' PDC_TEXT5
       , '-1' PDC_BOOLEAN1
       , '-1' PDC_BOOLEAN2
       , '-1' PDC_BOOLEAN3
       , '-1' PDC_BOOLEAN4
       , '-1' PDC_BOOLEAN5
       , to_date('00010101', 'YYYYMMDD') PDC_DATE1
       , to_date('00010101', 'YYYYMMDD') PDC_DATE2
       , to_date('00010101', 'YYYYMMDD') PDC_DATE3
       , to_date('00010101', 'YYYYMMDD') PDC_DATE4
       , to_date('00010101', 'YYYYMMDD') PDC_DATE5
       , 'DWH_NA' C_PARTNER_STATUS
       , 'DWH_NA' DIC_PAC_DIST_CHANNEL_FREE1_ID
       , 'DWH_NA' DIC_PAC_DIST_CHANNEL_FREE2_ID
       , 'DWH_NA' DIC_PAC_DIST_CHANNEL_FREE3_ID
       , 'DWH_NA' DIC_PAC_DIST_CHANNEL_FREE4_ID
       , 'DWH_NA' DIC_PAC_DIST_CHANNEL_FREE5_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_LEAD" ("PAC_LEAD_ID", "PAC_PERSON_ID", "C_LEAD_STATUS", "LEA_LABEL", "LEA_COMMENT", "DIC_LEA_SOURCE_ID", "LEA_SOURCE_COMMENT", "LEA_SOURCE_NR", "DIC_LEA_CATEGORY_ID", "DIC_LEA_SUBCATEGORY_ID", "DIC_LEA_CLASSIFICATION_ID", "PAC_SALE_TERRITORY_ID", "PAC_REPRESENTATIVE_ID", "C_OPPORTUNITY_STATUS", "LEA_RESULT_COMMENT", "DIC_LEA_RATING_ID", "PC_CURR_ID", "LEA_BUDGET_AMOUNT", "LEA_OFFER_DEADLINE", "LEA_DATE", "LEA_GOOD_DESCR", "GCO_GOOD_ID", "LEA_USER_ID", "LEA_CONTACT_PERSON_ID", "DIC_LEA_NEXT_STEP_ID", "LEA_PROJECT_BEGIN_DATE", "LEA_PROJECT_END_DATE", "LEA_RECORD_ID", "LEA_NEXT_STEP_DEADLINE", "LEA_COMPANY_NAME", "LEA_COMP_ADDRESS", "LEA_COMP_ZIPCODE", "LEA_COMP_CITY", "PC_CNTRY_ID", "PC_LANG_ID", "DIC_PERSON_POLITNESS_ID", "LEA_CONTACT_NAME", "LEA_CONTACT_FORENAME", "LEA_CONTACT_LANG_ID", "LEA_CONTACT_FUNCTION", "DIC_ASSOCIATION_TYPE_ID", "LEA_CONTACT_PHONE", "LEA_CONTACT_FAX", "LEA_CONTACT_MOBILE", "LEA_CONTACT_EMAIL") AS
  select PAC_LEAD_ID
       , Nvl(PAC_PERSON_ID, -2) PAC_PERSON_ID
       , Nvl(C_LEAD_STATUS, 'DWH_ISNULL') C_LEAD_STATUS
       , Nvl(LEA_LABEL, '_') LEA_LABEL
       , Nvl(LEA_COMMENT, '_') LEA_COMMENT
       , Nvl(DIC_LEA_SOURCE_ID, 'DWH_ISNULL') DIC_LEA_SOURCE_ID
       , Nvl(LEA_SOURCE_COMMENT, '_') LEA_SOURCE_COMMENT
       , Nvl(LEA_SOURCE_NR, '_') LEA_SOURCE_NR
       , Nvl(DIC_LEA_CATEGORY_ID, 'DWH_ISNULL') DIC_LEA_CATEGORY_ID
       , Nvl(DIC_LEA_SUBCATEGORY_ID, 'DWH_ISNULL') DIC_LEA_SUBCATEGORY_ID
       , Nvl(DIC_LEA_CLASSIFICATION_ID, 'DWH_ISNULL') DIC_LEA_CLASSIFICATION_ID
       , Nvl(PAC_SALE_TERRITORY_ID, -2) PAC_SALE_TERRITORY_ID
       , Nvl(PAC_REPRESENTATIVE_ID, -2) PAC_REPRESENTATIVE_ID
       , Nvl(C_OPPORTUNITY_STATUS, 'DWH_ISNULL') C_OPPORTUNITY_STATUS
       , Nvl(LEA_RESULT_COMMENT, '_') LEA_RESULT_COMMENT
       , Nvl(DIC_LEA_RATING_ID, 'DWH_ISNULL') DIC_LEA_RATING_ID
       , Nvl(PC_CURR_ID, -2) PC_CURR_ID
       , LEA_BUDGET_AMOUNT
       , Nvl(LEA_OFFER_DEADLINE, to_date('40000101', 'YYYYMMDD') ) LEA_OFFER_DEADLINE
       , Nvl(LEA_DATE, to_date('40000101', 'YYYYMMDD') ) LEA_DATE
       , Nvl(LEA_GOOD_DESCR, '_') LEA_GOOD_DESCR
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(LEA_USER_ID, -2) LEA_USER_ID
       , Nvl(LEA_CONTACT_PERSON_ID, -2) LEA_CONTACT_PERSON_ID
       , Nvl(DIC_LEA_NEXT_STEP_ID, 'DWH_ISNULL') DIC_LEA_NEXT_STEP_ID
       , Nvl(LEA_PROJECT_BEGIN_DATE, to_date('40000101', 'YYYYMMDD') ) LEA_PROJECT_BEGIN_DATE
       , Nvl(LEA_PROJECT_END_DATE, to_date('40000101', 'YYYYMMDD') ) LEA_PROJECT_END_DATE
       , Nvl(LEA_RECORD_ID, -2) LEA_RECORD_ID
       , Nvl(LEA_NEXT_STEP_DEADLINE, to_date('40000101', 'YYYYMMDD') ) LEA_NEXT_STEP_DEADLINE
       , Nvl(LEA_COMPANY_NAME, '_') LEA_COMPANY_NAME
       , Nvl(LEA_COMP_ADDRESS, '_') LEA_COMP_ADDRESS
       , Nvl(LEA_COMP_ZIPCODE, '_') LEA_COMP_ZIPCODE
       , Nvl(LEA_COMP_CITY, '_') LEA_COMP_CITY
       , Nvl(PC_CNTRY_ID, -2) PC_CNTRY_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(DIC_PERSON_POLITNESS_ID, 'DWH_ISNULL') DIC_PERSON_POLITNESS_ID
       , Nvl(LEA_CONTACT_NAME, '_') LEA_CONTACT_NAME
       , Nvl(LEA_CONTACT_FORENAME, '_') LEA_CONTACT_FORENAME
       , Nvl(LEA_CONTACT_LANG_ID, -2) LEA_CONTACT_LANG_ID
       , Nvl(LEA_CONTACT_FUNCTION, '_') LEA_CONTACT_FUNCTION
       , Nvl(DIC_ASSOCIATION_TYPE_ID, 'DWH_ISNULL') DIC_ASSOCIATION_TYPE_ID
       , Nvl(LEA_CONTACT_PHONE, '_') LEA_CONTACT_PHONE
       , Nvl(LEA_CONTACT_FAX, '_') LEA_CONTACT_FAX
       , Nvl(LEA_CONTACT_MOBILE, '_') LEA_CONTACT_MOBILE
       , Nvl(LEA_CONTACT_EMAIL, '_') LEA_CONTACT_EMAIL
  from PAC_LEAD
  union all
  select -1 PAC_LEAD_ID
       , -1 PAC_PERSON_ID
       , 'DWH_NA' C_LEAD_STATUS
       , 'N/A' LEA_LABEL
       , 'N/A' LEA_COMMENT
       , 'DWH_NA' DIC_LEA_SOURCE_ID
       , 'N/A' LEA_SOURCE_COMMENT
       , 'N/A' LEA_SOURCE_NR
       , 'DWH_NA' DIC_LEA_CATEGORY_ID
       , 'DWH_NA' DIC_LEA_SUBCATEGORY_ID
       , 'DWH_NA' DIC_LEA_CLASSIFICATION_ID
       , -1 PAC_SALE_TERRITORY_ID
       , -1 PAC_REPRESENTATIVE_ID
       , 'DWH_NA' C_OPPORTUNITY_STATUS
       , 'N/A' LEA_RESULT_COMMENT
       , 'DWH_NA' DIC_LEA_RATING_ID
       , -1 PC_CURR_ID
       , null LEA_BUDGET_AMOUNT
       , to_date('00010101', 'YYYYMMDD') LEA_OFFER_DEADLINE
       , to_date('00010101', 'YYYYMMDD') LEA_DATE
       , 'N/A' LEA_GOOD_DESCR
       , -1 GCO_GOOD_ID
       , -1 LEA_USER_ID
       , -1 LEA_CONTACT_PERSON_ID
       , 'DWH_NA' DIC_LEA_NEXT_STEP_ID
       , to_date('00010101', 'YYYYMMDD') LEA_PROJECT_BEGIN_DATE
       , to_date('00010101', 'YYYYMMDD') LEA_PROJECT_END_DATE
       , -1 LEA_RECORD_ID
       , to_date('00010101', 'YYYYMMDD') LEA_NEXT_STEP_DEADLINE
       , 'N/A' LEA_COMPANY_NAME
       , 'N/A' LEA_COMP_ADDRESS
       , 'N/A' LEA_COMP_ZIPCODE
       , 'N/A' LEA_COMP_CITY
       , -1 PC_CNTRY_ID
       , -1 PC_LANG_ID
       , 'DWH_NA' DIC_PERSON_POLITNESS_ID
       , 'N/A' LEA_CONTACT_NAME
       , 'N/A' LEA_CONTACT_FORENAME
       , -1 LEA_CONTACT_LANG_ID
       , 'N/A' LEA_CONTACT_FUNCTION
       , 'DWH_NA' DIC_ASSOCIATION_TYPE_ID
       , 'N/A' LEA_CONTACT_PHONE
       , 'N/A' LEA_CONTACT_FAX
       , 'N/A' LEA_CONTACT_MOBILE
       , 'N/A' LEA_CONTACT_EMAIL
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_PAYMENT_CONDITION" ("PAC_PAYMENT_CONDITION_ID", "PCO_DESCR", "PCO_DEFAULT", "C_VALID", "PC_APPLTXT_ID", "C_PARTNER_STATUS", "PCO_DEFAULT_PAY", "DIC_CONDITION_TYP_ID", "C_PAYMENT_CONDITION_KIND", "C_INVOICE_EXPIRY_INPUT_TYPE", "PCO_ONLY_AMOUNT_BILL_BOOK", "C_DIRECT_PAY") AS
  select PAC_PAYMENT_CONDITION_ID
       , Nvl(PCO_DESCR, '_') PCO_DESCR
       , Nvl2(PCO_DEFAULT, case
                when(PCO_DEFAULT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCO_DEFAULT
       , Nvl(C_VALID, 'DWH_ISNULL') C_VALID
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , Nvl2(PCO_DEFAULT_PAY, case
                when(PCO_DEFAULT_PAY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCO_DEFAULT_PAY
       , Nvl(DIC_CONDITION_TYP_ID, 'DWH_ISNULL') DIC_CONDITION_TYP_ID
       , Nvl(C_PAYMENT_CONDITION_KIND, 'DWH_ISNULL') C_PAYMENT_CONDITION_KIND
       , Nvl(C_INVOICE_EXPIRY_INPUT_TYPE, 'DWH_ISNULL') C_INVOICE_EXPIRY_INPUT_TYPE
       , Nvl2(PCO_ONLY_AMOUNT_BILL_BOOK, case
                when(PCO_ONLY_AMOUNT_BILL_BOOK = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PCO_ONLY_AMOUNT_BILL_BOOK
       , Nvl(C_DIRECT_PAY, 'DWH_ISNULL') C_DIRECT_PAY
  from PAC_PAYMENT_CONDITION
  union all
  select -1 PAC_PAYMENT_CONDITION_ID
       , 'N/A' PCO_DESCR
       , '-1' PCO_DEFAULT
       , 'DWH_NA' C_VALID
       , -1 PC_APPLTXT_ID
       , 'DWH_NA' C_PARTNER_STATUS
       , '-1' PCO_DEFAULT_PAY
       , 'DWH_NA' DIC_CONDITION_TYP_ID
       , 'DWH_NA' C_PAYMENT_CONDITION_KIND
       , 'DWH_NA' C_INVOICE_EXPIRY_INPUT_TYPE
       , '-1' PCO_ONLY_AMOUNT_BILL_BOOK
       , 'DWH_NA' C_DIRECT_PAY
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_PERSON" ("PAC_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PER_SHORT_NAME", "PER_CONTACT", "C_PARTNER_STATUS") AS
  select PAC_PERSON_ID
       , Nvl(DIC_PERSON_POLITNESS_ID, 'DWH_ISNULL') DIC_PERSON_POLITNESS_ID
       , Nvl(PER_NAME, '_') PER_NAME
       , Nvl(PER_FORENAME, '_') PER_FORENAME
       , Nvl(PER_ACTIVITY, '_') PER_ACTIVITY
       , Nvl(PER_COMMENT, '_') PER_COMMENT
       , Nvl(PER_KEY1, '_') PER_KEY1
       , Nvl(PER_KEY2, '_') PER_KEY2
       , Nvl(DIC_FREE_CODE1_ID, 'DWH_ISNULL') DIC_FREE_CODE1_ID
       , Nvl(DIC_FREE_CODE2_ID, 'DWH_ISNULL') DIC_FREE_CODE2_ID
       , Nvl(DIC_FREE_CODE3_ID, 'DWH_ISNULL') DIC_FREE_CODE3_ID
       , Nvl(DIC_FREE_CODE4_ID, 'DWH_ISNULL') DIC_FREE_CODE4_ID
       , Nvl(DIC_FREE_CODE5_ID, 'DWH_ISNULL') DIC_FREE_CODE5_ID
       , Nvl(DIC_FREE_CODE6_ID, 'DWH_ISNULL') DIC_FREE_CODE6_ID
       , Nvl(DIC_FREE_CODE7_ID, 'DWH_ISNULL') DIC_FREE_CODE7_ID
       , Nvl(DIC_FREE_CODE8_ID, 'DWH_ISNULL') DIC_FREE_CODE8_ID
       , Nvl(DIC_FREE_CODE9_ID, 'DWH_ISNULL') DIC_FREE_CODE9_ID
       , Nvl(DIC_FREE_CODE10_ID, 'DWH_ISNULL') DIC_FREE_CODE10_ID
       , Nvl(PER_SHORT_NAME, '_') PER_SHORT_NAME
       , Nvl2(PER_CONTACT, case
                when(PER_CONTACT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') PER_CONTACT
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
  from PAC_PERSON
  union all
  select -1 PAC_PERSON_ID
       , 'DWH_NA' DIC_PERSON_POLITNESS_ID
       , 'N/A' PER_NAME
       , 'N/A' PER_FORENAME
       , 'N/A' PER_ACTIVITY
       , 'N/A' PER_COMMENT
       , 'N/A' PER_KEY1
       , 'N/A' PER_KEY2
       , 'DWH_NA' DIC_FREE_CODE1_ID
       , 'DWH_NA' DIC_FREE_CODE2_ID
       , 'DWH_NA' DIC_FREE_CODE3_ID
       , 'DWH_NA' DIC_FREE_CODE4_ID
       , 'DWH_NA' DIC_FREE_CODE5_ID
       , 'DWH_NA' DIC_FREE_CODE6_ID
       , 'DWH_NA' DIC_FREE_CODE7_ID
       , 'DWH_NA' DIC_FREE_CODE8_ID
       , 'DWH_NA' DIC_FREE_CODE9_ID
       , 'DWH_NA' DIC_FREE_CODE10_ID
       , 'N/A' PER_SHORT_NAME
       , '-1' PER_CONTACT
       , 'DWH_NA' C_PARTNER_STATUS
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_REPRESENTATIVE" ("PAC_REPRESENTATIVE_ID", "PAC_ADDRESS_ID", "REP_DESCR", "REP_GROUP", "C_PARTNER_STATUS") AS
  select PAC_REPRESENTATIVE_ID
       , Nvl(PAC_ADDRESS_ID, -2) PAC_ADDRESS_ID
       , Nvl(REP_DESCR, '_') REP_DESCR
       , Nvl2(REP_GROUP, case
                when(REP_GROUP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') REP_GROUP
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
  from PAC_REPRESENTATIVE
  union all
  select -1 PAC_REPRESENTATIVE_ID
       , -1 PAC_ADDRESS_ID
       , 'N/A' REP_DESCR
       , '-1' REP_GROUP
       , 'DWH_NA' C_PARTNER_STATUS
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_SALE_TERRITORY" ("PAC_SALE_TERRITORY_ID", "STE_KEY", "STE_DESCRIPTION", "STE_COMMENT", "STE_NUMBER1", "STE_NUMBER2", "STE_NUMBER3", "STE_NUMBER4", "STE_NUMBER5", "STE_MEMO1", "STE_MEMO2", "STE_MEMO3", "STE_MEMO4", "STE_MEMO5", "STE_TEXT1", "STE_TEXT2", "STE_TEXT3", "STE_TEXT4", "STE_TEXT5", "STE_BOOLEAN1", "STE_BOOLEAN2", "STE_BOOLEAN3", "STE_BOOLEAN4", "STE_BOOLEAN5", "STE_DATE1", "STE_DATE2", "STE_DATE3", "STE_DATE4", "STE_DATE5", "C_PARTNER_STATUS", "DIC_PAC_TERRITORY_FREE2_ID", "DIC_PAC_TERRITORY_FREE3_ID", "DIC_PAC_TERRITORY_FREE4_ID", "DIC_PAC_TERRITORY_FREE5_ID", "DIC_PAC_TERRITORY_FREE1_ID") AS
  select PAC_SALE_TERRITORY_ID
       , Nvl(STE_KEY, '_') STE_KEY
       , Nvl(STE_DESCRIPTION, '_') STE_DESCRIPTION
       , Nvl(STE_COMMENT, '_') STE_COMMENT
       , STE_NUMBER1
       , STE_NUMBER2
       , STE_NUMBER3
       , STE_NUMBER4
       , STE_NUMBER5
       , Nvl(STE_MEMO1, '_') STE_MEMO1
       , Nvl(STE_MEMO2, '_') STE_MEMO2
       , Nvl(STE_MEMO3, '_') STE_MEMO3
       , Nvl(STE_MEMO4, '_') STE_MEMO4
       , Nvl(STE_MEMO5, '_') STE_MEMO5
       , Nvl(STE_TEXT1, '_') STE_TEXT1
       , Nvl(STE_TEXT2, '_') STE_TEXT2
       , Nvl(STE_TEXT3, '_') STE_TEXT3
       , Nvl(STE_TEXT4, '_') STE_TEXT4
       , Nvl(STE_TEXT5, '_') STE_TEXT5
       , Nvl2(STE_BOOLEAN1, case
                when(STE_BOOLEAN1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STE_BOOLEAN1
       , Nvl2(STE_BOOLEAN2, case
                when(STE_BOOLEAN2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STE_BOOLEAN2
       , Nvl2(STE_BOOLEAN3, case
                when(STE_BOOLEAN3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STE_BOOLEAN3
       , Nvl2(STE_BOOLEAN4, case
                when(STE_BOOLEAN4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STE_BOOLEAN4
       , Nvl2(STE_BOOLEAN5, case
                when(STE_BOOLEAN5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STE_BOOLEAN5
       , Nvl(STE_DATE1, to_date('40000101', 'YYYYMMDD') ) STE_DATE1
       , Nvl(STE_DATE2, to_date('40000101', 'YYYYMMDD') ) STE_DATE2
       , Nvl(STE_DATE3, to_date('40000101', 'YYYYMMDD') ) STE_DATE3
       , Nvl(STE_DATE4, to_date('40000101', 'YYYYMMDD') ) STE_DATE4
       , Nvl(STE_DATE5, to_date('40000101', 'YYYYMMDD') ) STE_DATE5
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , Nvl(DIC_PAC_TERRITORY_FREE2_ID, 'DWH_ISNULL') DIC_PAC_TERRITORY_FREE2_ID
       , Nvl(DIC_PAC_TERRITORY_FREE3_ID, 'DWH_ISNULL') DIC_PAC_TERRITORY_FREE3_ID
       , Nvl(DIC_PAC_TERRITORY_FREE4_ID, 'DWH_ISNULL') DIC_PAC_TERRITORY_FREE4_ID
       , Nvl(DIC_PAC_TERRITORY_FREE5_ID, 'DWH_ISNULL') DIC_PAC_TERRITORY_FREE5_ID
       , Nvl(DIC_PAC_TERRITORY_FREE1_ID, 'DWH_ISNULL') DIC_PAC_TERRITORY_FREE1_ID
  from PAC_SALE_TERRITORY
  union all
  select -1 PAC_SALE_TERRITORY_ID
       , 'N/A' STE_KEY
       , 'N/A' STE_DESCRIPTION
       , 'N/A' STE_COMMENT
       , null STE_NUMBER1
       , null STE_NUMBER2
       , null STE_NUMBER3
       , null STE_NUMBER4
       , null STE_NUMBER5
       , 'N/A' STE_MEMO1
       , 'N/A' STE_MEMO2
       , 'N/A' STE_MEMO3
       , 'N/A' STE_MEMO4
       , 'N/A' STE_MEMO5
       , 'N/A' STE_TEXT1
       , 'N/A' STE_TEXT2
       , 'N/A' STE_TEXT3
       , 'N/A' STE_TEXT4
       , 'N/A' STE_TEXT5
       , '-1' STE_BOOLEAN1
       , '-1' STE_BOOLEAN2
       , '-1' STE_BOOLEAN3
       , '-1' STE_BOOLEAN4
       , '-1' STE_BOOLEAN5
       , to_date('00010101', 'YYYYMMDD') STE_DATE1
       , to_date('00010101', 'YYYYMMDD') STE_DATE2
       , to_date('00010101', 'YYYYMMDD') STE_DATE3
       , to_date('00010101', 'YYYYMMDD') STE_DATE4
       , to_date('00010101', 'YYYYMMDD') STE_DATE5
       , 'DWH_NA' C_PARTNER_STATUS
       , 'DWH_NA' DIC_PAC_TERRITORY_FREE2_ID
       , 'DWH_NA' DIC_PAC_TERRITORY_FREE3_ID
       , 'DWH_NA' DIC_PAC_TERRITORY_FREE4_ID
       , 'DWH_NA' DIC_PAC_TERRITORY_FREE5_ID
       , 'DWH_NA' DIC_PAC_TERRITORY_FREE1_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_SCHEDULE" ("PAC_SCHEDULE_ID", "SCE_DESCR", "SCE_DEFAULT") AS
  select PAC_SCHEDULE_ID
       , Nvl(SCE_DESCR, '_') SCE_DESCR
       , Nvl2(SCE_DEFAULT, case
                when(SCE_DEFAULT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCE_DEFAULT
  from PAC_SCHEDULE
  union all
  select -1 PAC_SCHEDULE_ID
       , 'N/A' SCE_DESCR
       , '-1' SCE_DEFAULT
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_SCHEDULE_PERIOD" ("PAC_SCHEDULE_PERIOD_ID", "PAC_SCHEDULE_ID", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "FAL_FACTORY_FLOOR_ID", "HRM_PERSON_ID", "C_DAY_OF_WEEK", "DIC_SCH_PERIOD_1_ID", "DIC_SCH_PERIOD_2_ID", "SCP_OPEN_TIME", "SCP_CLOSE_TIME", "SCP_DATE", "SCP_NONWORKING_DAY", "SCP_COMMENT", "SCP_RESOURCE_NUMBER", "SCP_RESOURCE_CAPACITY", "SCP_RESOURCE_CAP_IN_QTY", "SCP_WORKING_TIME", "SCP_PIECES_HOUR_CAP", "PAC_DEPARTMENT_ID", "SCP_ENTRY_ID") AS
  select PAC_SCHEDULE_PERIOD_ID
       , Nvl(PAC_SCHEDULE_ID, -2) PAC_SCHEDULE_ID
       , Nvl(PAC_CUSTOM_PARTNER_ID, -2) PAC_CUSTOM_PARTNER_ID
       , Nvl(PAC_SUPPLIER_PARTNER_ID, -2) PAC_SUPPLIER_PARTNER_ID
       , Nvl(FAL_FACTORY_FLOOR_ID, -2) FAL_FACTORY_FLOOR_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(C_DAY_OF_WEEK, 'DWH_ISNULL') C_DAY_OF_WEEK
       , Nvl(DIC_SCH_PERIOD_1_ID, 'DWH_ISNULL') DIC_SCH_PERIOD_1_ID
       , Nvl(DIC_SCH_PERIOD_2_ID, 'DWH_ISNULL') DIC_SCH_PERIOD_2_ID
       , SCP_OPEN_TIME
       , SCP_CLOSE_TIME
       , Nvl(SCP_DATE, to_date('40000101', 'YYYYMMDD') ) SCP_DATE
       , Nvl2(SCP_NONWORKING_DAY, case
                when(SCP_NONWORKING_DAY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCP_NONWORKING_DAY
       , Nvl(SCP_COMMENT, '_') SCP_COMMENT
       , SCP_RESOURCE_NUMBER
       , SCP_RESOURCE_CAPACITY
       , SCP_RESOURCE_CAP_IN_QTY
       , SCP_WORKING_TIME
       , SCP_PIECES_HOUR_CAP
       , Nvl(PAC_DEPARTMENT_ID, -2) PAC_DEPARTMENT_ID
       , Nvl(SCP_ENTRY_ID, -2) SCP_ENTRY_ID
  from PAC_SCHEDULE_PERIOD
  union all
  select -1 PAC_SCHEDULE_PERIOD_ID
       , -1 PAC_SCHEDULE_ID
       , -1 PAC_CUSTOM_PARTNER_ID
       , -1 PAC_SUPPLIER_PARTNER_ID
       , -1 FAL_FACTORY_FLOOR_ID
       , -1 HRM_PERSON_ID
       , 'DWH_NA' C_DAY_OF_WEEK
       , 'DWH_NA' DIC_SCH_PERIOD_1_ID
       , 'DWH_NA' DIC_SCH_PERIOD_2_ID
       , null SCP_OPEN_TIME
       , null SCP_CLOSE_TIME
       , to_date('00010101', 'YYYYMMDD') SCP_DATE
       , '-1' SCP_NONWORKING_DAY
       , 'N/A' SCP_COMMENT
       , null SCP_RESOURCE_NUMBER
       , null SCP_RESOURCE_CAPACITY
       , null SCP_RESOURCE_CAP_IN_QTY
       , null SCP_WORKING_TIME
       , null SCP_PIECES_HOUR_CAP
       , -1 PAC_DEPARTMENT_ID
       , -1 SCP_ENTRY_ID
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_SENDING_CONDITION" ("PAC_SENDING_CONDITION_ID", "PAC_ADDRESS_ID", "SEN_KEY", "C_PARTNER_STATUS", "C_CONDITION_MODE") AS
  select PAC_SENDING_CONDITION_ID
       , Nvl(PAC_ADDRESS_ID, -2) PAC_ADDRESS_ID
       , Nvl(SEN_KEY, '_') SEN_KEY
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , Nvl(C_CONDITION_MODE, 'DWH_ISNULL') C_CONDITION_MODE
  from PAC_SENDING_CONDITION
  union all
  select -1 PAC_SENDING_CONDITION_ID
       , -1 PAC_ADDRESS_ID
       , 'N/A' SEN_KEY
       , 'DWH_NA' C_PARTNER_STATUS
       , 'DWH_NA' C_CONDITION_MODE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_SENDING_CONDI_TEXT" ("PAC_SENDING_CONDITION_TEXT_ID", "PAC_SENDING_CONDITION_ID", "PC_LANG_ID", "SEN_DESCR") AS
  select PAC_SENDING_CONDITION_TEXT_ID
       , Nvl(PAC_SENDING_CONDITION_ID, -2) PAC_SENDING_CONDITION_ID
       , Nvl(PC_LANG_ID, -2) PC_LANG_ID
       , Nvl(SEN_DESCR, '_') SEN_DESCR
  from PAC_SENDING_CONDITION_TEXT
  union all
  select -1 PAC_SENDING_CONDITION_TEXT_ID
       , -1 PAC_SENDING_CONDITION_ID
       , -1 PC_LANG_ID
       , 'N/A' SEN_DESCR
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_SUPPLIER_PARTNER" ("PAC_SUPPLIER_PARTNER_ID", "DIC_TYPE_SUBMISSION_ID", "DIC_PRIORITY_PAYMENT_ID", "DIC_CENTER_PAYMENT_ID", "DIC_LEVEL_PRIORITY_ID", "PAC_REMAINDER_CATEGORY_ID", "PAC_PAYMENT_CONDITION_ID", "CRE_BLOCKED", "CRE_REMARK", "ACS_AUXILIARY_ACCOUNT_ID", "C_REMAINDER_LAUNCHING", "PAC_ADDRESS_ID", "DIC_TARIFF_ID", "DIC_TYPE_PARTNER_F_ID", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "ACS_VAT_DET_ACCOUNT_ID", "C_TARIFFICATION_MODE", "C_PARTNER_CATEGORY", "PAC_SENDING_CONDITION_ID", "PAC_CALENDAR_TYPE_ID", "C_TYPE_EDI", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "CRE_WITHOUT_REMIND_DATE", "DIC_COMPLEMENTARY_DATA_ID", "CRE_SUP_COPY1", "CRE_SUP_COPY2", "CRE_SUP_COPY3", "CRE_SUP_COPY4", "CRE_SUP_COPY5", "ACS_FIN_ACC_S_PAYMENT_ID", "C_STATUS_SETTLEMENT", "C_PARTNER_STATUS", "CRE_SUP_COPY6", "CRE_SUP_COPY7", "CRE_SUP_COPY8", "CRE_SUP_COPY9", "CRE_SUP_COPY10", "CRE_SUPPLY_DELAY", "DIC_PIC_GROUP_ID", "C_INCOTERMS", "CRE_DATA_EXPORT", "CRE_CUSTOMER_NUMBER", "CRE_EAN_NUMBER", "CRE_PAYMENT_FACTOR", "CRE_ADAPTED_FACTOR", "CRE_PAYMENT_FACTOR_DATE", "CRE_ADAPTED_FACTOR_DATE", "CRE_MANUFACTURER", "C_DELIVERY_TYP", "CRE_INCOTERMS_PLACE", "PAC_PAC_THIRD_1_ID", "PAC_PAC_THIRD_2_ID", "DIC_PTC_THIRD_GROUP_ID", "PC_APPLTXT_ID", "PC__PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "PC_3_PC_APPLTXT_ID", "PC_4_PC_APPLTXT_ID", "CRE_DAY_CAPACITY", "C_WEIGHING_MGNT", "C_THIRD_MATERIAL_RELATION_TYPE", "C_MATERIAL_MGNT_MODE", "CRE_ADV_MATERIAL_MGNT", "C_ADV_MATERIAL_MODE", "CRE_TARIFF_BY_SET", "STM_STOCK_ID", "CRE_METAL_ACCOUNT", "COM_NAME", "C_DAS2_BREAKDOWN", "PAC_SCHEDULE_ID", "C_SUPPLIER_LITIG") AS
  select PAC_SUPPLIER_PARTNER_ID
       , Nvl(DIC_TYPE_SUBMISSION_ID, 'DWH_ISNULL') DIC_TYPE_SUBMISSION_ID
       , Nvl(DIC_PRIORITY_PAYMENT_ID, 'DWH_ISNULL') DIC_PRIORITY_PAYMENT_ID
       , Nvl(DIC_CENTER_PAYMENT_ID, 'DWH_ISNULL') DIC_CENTER_PAYMENT_ID
       , Nvl(DIC_LEVEL_PRIORITY_ID, 'DWH_ISNULL') DIC_LEVEL_PRIORITY_ID
       , Nvl(PAC_REMAINDER_CATEGORY_ID, -2) PAC_REMAINDER_CATEGORY_ID
       , Nvl(PAC_PAYMENT_CONDITION_ID, -2) PAC_PAYMENT_CONDITION_ID
       , Nvl2(CRE_BLOCKED, case
                when(CRE_BLOCKED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRE_BLOCKED
       , Nvl(CRE_REMARK, '_') CRE_REMARK
       , Nvl(ACS_AUXILIARY_ACCOUNT_ID, -2) ACS_AUXILIARY_ACCOUNT_ID
       , Nvl(C_REMAINDER_LAUNCHING, 'DWH_ISNULL') C_REMAINDER_LAUNCHING
       , Nvl(PAC_ADDRESS_ID, -2) PAC_ADDRESS_ID
       , Nvl(DIC_TARIFF_ID, 'DWH_ISNULL') DIC_TARIFF_ID
       , Nvl(DIC_TYPE_PARTNER_F_ID, 'DWH_ISNULL') DIC_TYPE_PARTNER_F_ID
       , Nvl(DIC_STATISTIC_F1_ID, 'DWH_ISNULL') DIC_STATISTIC_F1_ID
       , Nvl(DIC_STATISTIC_F2_ID, 'DWH_ISNULL') DIC_STATISTIC_F2_ID
       , Nvl(DIC_STATISTIC_F3_ID, 'DWH_ISNULL') DIC_STATISTIC_F3_ID
       , Nvl(DIC_STATISTIC_F4_ID, 'DWH_ISNULL') DIC_STATISTIC_F4_ID
       , Nvl(DIC_STATISTIC_F5_ID, 'DWH_ISNULL') DIC_STATISTIC_F5_ID
       , Nvl(ACS_VAT_DET_ACCOUNT_ID, -2) ACS_VAT_DET_ACCOUNT_ID
       , Nvl(C_TARIFFICATION_MODE, 'DWH_ISNULL') C_TARIFFICATION_MODE
       , Nvl(C_PARTNER_CATEGORY, 'DWH_ISNULL') C_PARTNER_CATEGORY
       , Nvl(PAC_SENDING_CONDITION_ID, -2) PAC_SENDING_CONDITION_ID
       , Nvl(PAC_CALENDAR_TYPE_ID, -2) PAC_CALENDAR_TYPE_ID
       , Nvl(C_TYPE_EDI, 'DWH_ISNULL') C_TYPE_EDI
       , Nvl(CRE_FREE_ZONE1, '_') CRE_FREE_ZONE1
       , Nvl(CRE_FREE_ZONE2, '_') CRE_FREE_ZONE2
       , Nvl(CRE_FREE_ZONE3, '_') CRE_FREE_ZONE3
       , Nvl(CRE_FREE_ZONE4, '_') CRE_FREE_ZONE4
       , Nvl(CRE_FREE_ZONE5, '_') CRE_FREE_ZONE5
       , Nvl(CRE_WITHOUT_REMIND_DATE, to_date('40000101', 'YYYYMMDD') ) CRE_WITHOUT_REMIND_DATE
       , Nvl(DIC_COMPLEMENTARY_DATA_ID, 'DWH_ISNULL') DIC_COMPLEMENTARY_DATA_ID
       , CRE_SUP_COPY1
       , CRE_SUP_COPY2
       , CRE_SUP_COPY3
       , CRE_SUP_COPY4
       , CRE_SUP_COPY5
       , Nvl(ACS_FIN_ACC_S_PAYMENT_ID, -2) ACS_FIN_ACC_S_PAYMENT_ID
       , Nvl(C_STATUS_SETTLEMENT, 'DWH_ISNULL') C_STATUS_SETTLEMENT
       , Nvl(C_PARTNER_STATUS, 'DWH_ISNULL') C_PARTNER_STATUS
       , CRE_SUP_COPY6
       , CRE_SUP_COPY7
       , CRE_SUP_COPY8
       , CRE_SUP_COPY9
       , CRE_SUP_COPY10
       , CRE_SUPPLY_DELAY
       , Nvl(DIC_PIC_GROUP_ID, 'DWH_ISNULL') DIC_PIC_GROUP_ID
       , Nvl(C_INCOTERMS, 'DWH_ISNULL') C_INCOTERMS
       , Nvl(CRE_DATA_EXPORT, '_') CRE_DATA_EXPORT
       , Nvl(CRE_CUSTOMER_NUMBER, '_') CRE_CUSTOMER_NUMBER
       , Nvl(CRE_EAN_NUMBER, '_') CRE_EAN_NUMBER
       , CRE_PAYMENT_FACTOR
       , CRE_ADAPTED_FACTOR
       , Nvl(CRE_PAYMENT_FACTOR_DATE, to_date('40000101', 'YYYYMMDD') ) CRE_PAYMENT_FACTOR_DATE
       , Nvl(CRE_ADAPTED_FACTOR_DATE, to_date('40000101', 'YYYYMMDD') ) CRE_ADAPTED_FACTOR_DATE
       , Nvl2(CRE_MANUFACTURER, case
                when(CRE_MANUFACTURER = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRE_MANUFACTURER
       , Nvl(C_DELIVERY_TYP, 'DWH_ISNULL') C_DELIVERY_TYP
       , Nvl(CRE_INCOTERMS_PLACE, '_') CRE_INCOTERMS_PLACE
       , Nvl(PAC_PAC_THIRD_1_ID, -2) PAC_PAC_THIRD_1_ID
       , Nvl(PAC_PAC_THIRD_2_ID, -2) PAC_PAC_THIRD_2_ID
       , Nvl(DIC_PTC_THIRD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_THIRD_GROUP_ID
       , Nvl(PC_APPLTXT_ID, -2) PC_APPLTXT_ID
       , Nvl(PC__PC_APPLTXT_ID, -2) PC__PC_APPLTXT_ID
       , Nvl(PC_2_PC_APPLTXT_ID, -2) PC_2_PC_APPLTXT_ID
       , Nvl(PC_3_PC_APPLTXT_ID, -2) PC_3_PC_APPLTXT_ID
       , Nvl(PC_4_PC_APPLTXT_ID, -2) PC_4_PC_APPLTXT_ID
       , CRE_DAY_CAPACITY
       , Nvl(C_WEIGHING_MGNT, 'DWH_ISNULL') C_WEIGHING_MGNT
       , Nvl(C_THIRD_MATERIAL_RELATION_TYPE, 'DWH_ISNULL') C_THIRD_MATERIAL_RELATION_TYPE
       , Nvl(C_MATERIAL_MGNT_MODE, 'DWH_ISNULL') C_MATERIAL_MGNT_MODE
       , Nvl2(CRE_ADV_MATERIAL_MGNT, case
                when(CRE_ADV_MATERIAL_MGNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRE_ADV_MATERIAL_MGNT
       , Nvl(C_ADV_MATERIAL_MODE, 'DWH_ISNULL') C_ADV_MATERIAL_MODE
       , Nvl2(CRE_TARIFF_BY_SET, case
                when(CRE_TARIFF_BY_SET = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRE_TARIFF_BY_SET
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl2(CRE_METAL_ACCOUNT, case
                when(CRE_METAL_ACCOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRE_METAL_ACCOUNT
       , Nvl(COM_NAME, '_') COM_NAME
       , Nvl(C_DAS2_BREAKDOWN, 'DWH_ISNULL') C_DAS2_BREAKDOWN
       , Nvl(PAC_SCHEDULE_ID, -2) PAC_SCHEDULE_ID
       , Nvl(C_SUPPLIER_LITIG, 'DWH_ISNULL') C_SUPPLIER_LITIG
  from PAC_SUPPLIER_PARTNER
  union all
  select -1 PAC_SUPPLIER_PARTNER_ID
       , 'DWH_NA' DIC_TYPE_SUBMISSION_ID
       , 'DWH_NA' DIC_PRIORITY_PAYMENT_ID
       , 'DWH_NA' DIC_CENTER_PAYMENT_ID
       , 'DWH_NA' DIC_LEVEL_PRIORITY_ID
       , -1 PAC_REMAINDER_CATEGORY_ID
       , -1 PAC_PAYMENT_CONDITION_ID
       , '-1' CRE_BLOCKED
       , 'N/A' CRE_REMARK
       , -1 ACS_AUXILIARY_ACCOUNT_ID
       , 'DWH_NA' C_REMAINDER_LAUNCHING
       , -1 PAC_ADDRESS_ID
       , 'DWH_NA' DIC_TARIFF_ID
       , 'DWH_NA' DIC_TYPE_PARTNER_F_ID
       , 'DWH_NA' DIC_STATISTIC_F1_ID
       , 'DWH_NA' DIC_STATISTIC_F2_ID
       , 'DWH_NA' DIC_STATISTIC_F3_ID
       , 'DWH_NA' DIC_STATISTIC_F4_ID
       , 'DWH_NA' DIC_STATISTIC_F5_ID
       , -1 ACS_VAT_DET_ACCOUNT_ID
       , 'DWH_NA' C_TARIFFICATION_MODE
       , 'DWH_NA' C_PARTNER_CATEGORY
       , -1 PAC_SENDING_CONDITION_ID
       , -1 PAC_CALENDAR_TYPE_ID
       , 'DWH_NA' C_TYPE_EDI
       , 'N/A' CRE_FREE_ZONE1
       , 'N/A' CRE_FREE_ZONE2
       , 'N/A' CRE_FREE_ZONE3
       , 'N/A' CRE_FREE_ZONE4
       , 'N/A' CRE_FREE_ZONE5
       , to_date('00010101', 'YYYYMMDD') CRE_WITHOUT_REMIND_DATE
       , 'DWH_NA' DIC_COMPLEMENTARY_DATA_ID
       , null CRE_SUP_COPY1
       , null CRE_SUP_COPY2
       , null CRE_SUP_COPY3
       , null CRE_SUP_COPY4
       , null CRE_SUP_COPY5
       , -1 ACS_FIN_ACC_S_PAYMENT_ID
       , 'DWH_NA' C_STATUS_SETTLEMENT
       , 'DWH_NA' C_PARTNER_STATUS
       , null CRE_SUP_COPY6
       , null CRE_SUP_COPY7
       , null CRE_SUP_COPY8
       , null CRE_SUP_COPY9
       , null CRE_SUP_COPY10
       , null CRE_SUPPLY_DELAY
       , 'DWH_NA' DIC_PIC_GROUP_ID
       , 'DWH_NA' C_INCOTERMS
       , 'N/A' CRE_DATA_EXPORT
       , 'N/A' CRE_CUSTOMER_NUMBER
       , 'N/A' CRE_EAN_NUMBER
       , null CRE_PAYMENT_FACTOR
       , null CRE_ADAPTED_FACTOR
       , to_date('00010101', 'YYYYMMDD') CRE_PAYMENT_FACTOR_DATE
       , to_date('00010101', 'YYYYMMDD') CRE_ADAPTED_FACTOR_DATE
       , '-1' CRE_MANUFACTURER
       , 'DWH_NA' C_DELIVERY_TYP
       , 'N/A' CRE_INCOTERMS_PLACE
       , -1 PAC_PAC_THIRD_1_ID
       , -1 PAC_PAC_THIRD_2_ID
       , 'DWH_NA' DIC_PTC_THIRD_GROUP_ID
       , -1 PC_APPLTXT_ID
       , -1 PC__PC_APPLTXT_ID
       , -1 PC_2_PC_APPLTXT_ID
       , -1 PC_3_PC_APPLTXT_ID
       , -1 PC_4_PC_APPLTXT_ID
       , null CRE_DAY_CAPACITY
       , 'DWH_NA' C_WEIGHING_MGNT
       , 'DWH_NA' C_THIRD_MATERIAL_RELATION_TYPE
       , 'DWH_NA' C_MATERIAL_MGNT_MODE
       , '-1' CRE_ADV_MATERIAL_MGNT
       , 'DWH_NA' C_ADV_MATERIAL_MODE
       , '-1' CRE_TARIFF_BY_SET
       , -1 STM_STOCK_ID
       , '-1' CRE_METAL_ACCOUNT
       , 'N/A' COM_NAME
       , 'DWH_NA' C_DAS2_BREAKDOWN
       , -1 PAC_SCHEDULE_ID
       , 'DWH_NA' C_SUPPLIER_LITIG
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PAC_THIRD" ("PAC_THIRD_ID", "THI_NO_TVA", "THI_NO_INTRA", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_FORMAT", "THI_NO_SIREN", "THI_NO_SIRET", "THI_WEB_KEY", "PAC_PAC_PERSON_ID", "DIC_CITI_CODE_ID", "DIC_JURIDICAL_STATUS_ID", "THI_CUSTOM_NUMBER", "THI_NO_FID", "THI_NO_STATE") AS
  select PAC_THIRD_ID
       , Nvl(THI_NO_TVA, '_') THI_NO_TVA
       , Nvl(THI_NO_INTRA, '_') THI_NO_INTRA
       , Nvl(DIC_THIRD_ACTIVITY_ID, 'DWH_ISNULL') DIC_THIRD_ACTIVITY_ID
       , Nvl(DIC_THIRD_AREA_ID, 'DWH_ISNULL') DIC_THIRD_AREA_ID
       , Nvl(THI_NO_FORMAT, '_') THI_NO_FORMAT
       , Nvl(THI_NO_SIREN, '_') THI_NO_SIREN
       , Nvl(THI_NO_SIRET, '_') THI_NO_SIRET
       , Nvl(THI_WEB_KEY, '_') THI_WEB_KEY
       , Nvl(PAC_PAC_PERSON_ID, -2) PAC_PAC_PERSON_ID
       , Nvl(DIC_CITI_CODE_ID, 'DWH_ISNULL') DIC_CITI_CODE_ID
       , Nvl(DIC_JURIDICAL_STATUS_ID, 'DWH_ISNULL') DIC_JURIDICAL_STATUS_ID
       , Nvl(THI_CUSTOM_NUMBER, '_') THI_CUSTOM_NUMBER
       , Nvl(THI_NO_FID, '_') THI_NO_FID
       , Nvl(THI_NO_STATE, '_') THI_NO_STATE
  from PAC_THIRD
  union all
  select -1 PAC_THIRD_ID
       , 'N/A' THI_NO_TVA
       , 'N/A' THI_NO_INTRA
       , 'DWH_NA' DIC_THIRD_ACTIVITY_ID
       , 'DWH_NA' DIC_THIRD_AREA_ID
       , 'N/A' THI_NO_FORMAT
       , 'N/A' THI_NO_SIREN
       , 'N/A' THI_NO_SIRET
       , 'N/A' THI_WEB_KEY
       , -1 PAC_PAC_PERSON_ID
       , 'DWH_NA' DIC_CITI_CODE_ID
       , 'DWH_NA' DIC_JURIDICAL_STATUS_ID
       , 'N/A' THI_CUSTOM_NUMBER
       , 'N/A' THI_NO_FID
       , 'N/A' THI_NO_STATE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PTC_CHARGE" ("PTC_CHARGE_ID", "C_CALCULATION_MODE", "CRG_NAME", "DIC_FREE_CHARGE_ID", "CRG_RATE", "CRG_FRACTION", "CRG_FIXED_AMOUNT", "CRG_EXCEEDED_AMOUNT_FROM", "CRG_EXCEEDED_AMOUNT_TO", "CRG_MIN_AMOUNT", "CRG_MAX_AMOUNT", "CRG_QUANTITY_FROM", "CRG_QUANTITY_TO", "CRG_DATE_TO", "CRG_DATE_FROM", "CRG_STORED_PROC", "C_ROUND_TYPE", "CRG_ROUND_AMOUNT", "CRG_AUTOMATIC_CALC", "CRG_SQL_EXTERN_ITEM", "C_THIRDRELATION_TYPE", "C_GOODRELATION_TYPE", "C_GAUGERELATION_TYPE", "CRG_THIRD_CONDITION", "CRG_GOOD_CONDITION", "CRG_GAUGE_CONDITION", "C_CHARGE_KIND", "C_CHARGE_TYPE", "CRG_IN_SERIE_CALCULATION", "CRG_IS_MULTIPLICATOR", "ACS_DIVISION_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "CRG_TRANSFERT_PROP", "CRG_MODIFY", "CRG_UNIT_DETAIL", "C_RECORDRELATION_TYPE", "CRG_RECORD_CONDITION", "ACS_CDA_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "CRG_EXCLUSIVE", "DIC_PTC_THIRD_GROUP_ID", "DIC_PTC_GOOD_GROUP_ID", "CRG_PRCS_USE") AS
  select PTC_CHARGE_ID
       , Nvl(C_CALCULATION_MODE, 'DWH_ISNULL') C_CALCULATION_MODE
       , Nvl(CRG_NAME, '_') CRG_NAME
       , Nvl(DIC_FREE_CHARGE_ID, 'DWH_ISNULL') DIC_FREE_CHARGE_ID
       , CRG_RATE
       , CRG_FRACTION
       , CRG_FIXED_AMOUNT
       , CRG_EXCEEDED_AMOUNT_FROM
       , CRG_EXCEEDED_AMOUNT_TO
       , CRG_MIN_AMOUNT
       , CRG_MAX_AMOUNT
       , CRG_QUANTITY_FROM
       , CRG_QUANTITY_TO
       , Nvl(CRG_DATE_TO, to_date('40000101', 'YYYYMMDD') ) CRG_DATE_TO
       , Nvl(CRG_DATE_FROM, to_date('40000101', 'YYYYMMDD') ) CRG_DATE_FROM
       , Nvl(CRG_STORED_PROC, '_') CRG_STORED_PROC
       , Nvl(C_ROUND_TYPE, 'DWH_ISNULL') C_ROUND_TYPE
       , CRG_ROUND_AMOUNT
       , Nvl2(CRG_AUTOMATIC_CALC, case
                when(CRG_AUTOMATIC_CALC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_AUTOMATIC_CALC
       , Nvl(CRG_SQL_EXTERN_ITEM, '_') CRG_SQL_EXTERN_ITEM
       , Nvl(C_THIRDRELATION_TYPE, 'DWH_ISNULL') C_THIRDRELATION_TYPE
       , Nvl(C_GOODRELATION_TYPE, 'DWH_ISNULL') C_GOODRELATION_TYPE
       , Nvl(C_GAUGERELATION_TYPE, 'DWH_ISNULL') C_GAUGERELATION_TYPE
       , Nvl(CRG_THIRD_CONDITION, '_') CRG_THIRD_CONDITION
       , Nvl(CRG_GOOD_CONDITION, '_') CRG_GOOD_CONDITION
       , Nvl(CRG_GAUGE_CONDITION, '_') CRG_GAUGE_CONDITION
       , Nvl(C_CHARGE_KIND, 'DWH_ISNULL') C_CHARGE_KIND
       , Nvl(C_CHARGE_TYPE, 'DWH_ISNULL') C_CHARGE_TYPE
       , Nvl2(CRG_IN_SERIE_CALCULATION, case
                when(CRG_IN_SERIE_CALCULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_IN_SERIE_CALCULATION
       , Nvl2(CRG_IS_MULTIPLICATOR, case
                when(CRG_IS_MULTIPLICATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_IS_MULTIPLICATOR
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl2(CRG_TRANSFERT_PROP, case
                when(CRG_TRANSFERT_PROP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_TRANSFERT_PROP
       , Nvl2(CRG_MODIFY, case
                when(CRG_MODIFY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_MODIFY
       , Nvl2(CRG_UNIT_DETAIL, case
                when(CRG_UNIT_DETAIL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_UNIT_DETAIL
       , Nvl(C_RECORDRELATION_TYPE, 'DWH_ISNULL') C_RECORDRELATION_TYPE
       , Nvl(CRG_RECORD_CONDITION, '_') CRG_RECORD_CONDITION
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl2(CRG_EXCLUSIVE, case
                when(CRG_EXCLUSIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_EXCLUSIVE
       , Nvl(DIC_PTC_THIRD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_THIRD_GROUP_ID
       , Nvl(DIC_PTC_GOOD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_GOOD_GROUP_ID
       , Nvl2(CRG_PRCS_USE, case
                when(CRG_PRCS_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') CRG_PRCS_USE
  from PTC_CHARGE
  union all
  select -1 PTC_CHARGE_ID
       , 'DWH_NA' C_CALCULATION_MODE
       , 'N/A' CRG_NAME
       , 'DWH_NA' DIC_FREE_CHARGE_ID
       , null CRG_RATE
       , null CRG_FRACTION
       , null CRG_FIXED_AMOUNT
       , null CRG_EXCEEDED_AMOUNT_FROM
       , null CRG_EXCEEDED_AMOUNT_TO
       , null CRG_MIN_AMOUNT
       , null CRG_MAX_AMOUNT
       , null CRG_QUANTITY_FROM
       , null CRG_QUANTITY_TO
       , to_date('00010101', 'YYYYMMDD') CRG_DATE_TO
       , to_date('00010101', 'YYYYMMDD') CRG_DATE_FROM
       , 'N/A' CRG_STORED_PROC
       , 'DWH_NA' C_ROUND_TYPE
       , null CRG_ROUND_AMOUNT
       , '-1' CRG_AUTOMATIC_CALC
       , 'N/A' CRG_SQL_EXTERN_ITEM
       , 'DWH_NA' C_THIRDRELATION_TYPE
       , 'DWH_NA' C_GOODRELATION_TYPE
       , 'DWH_NA' C_GAUGERELATION_TYPE
       , 'N/A' CRG_THIRD_CONDITION
       , 'N/A' CRG_GOOD_CONDITION
       , 'N/A' CRG_GAUGE_CONDITION
       , 'DWH_NA' C_CHARGE_KIND
       , 'DWH_NA' C_CHARGE_TYPE
       , '-1' CRG_IN_SERIE_CALCULATION
       , '-1' CRG_IS_MULTIPLICATOR
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , '-1' CRG_TRANSFERT_PROP
       , '-1' CRG_MODIFY
       , '-1' CRG_UNIT_DETAIL
       , 'DWH_NA' C_RECORDRELATION_TYPE
       , 'N/A' CRG_RECORD_CONDITION
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , '-1' CRG_EXCLUSIVE
       , 'DWH_NA' DIC_PTC_THIRD_GROUP_ID
       , 'DWH_NA' DIC_PTC_GOOD_GROUP_ID
       , '-1' CRG_PRCS_USE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_PTC_DISCOUNT" ("PTC_DISCOUNT_ID", "C_CALCULATION_MODE", "DNT_NAME", "DNT_RATE", "DNT_FRACTION", "DNT_FIXED_AMOUNT", "DNT_EXCEEDING_AMOUNT_FROM", "DNT_EXCEEDING_AMOUNT_TO", "DNT_MIN_AMOUNT", "DNT_MAX_AMOUNT", "DNT_QUANTITY_FROM", "DNT_QUANTITY_TO", "DNT_DATE_FROM", "DNT_DATE_TO", "DNT_STORED_PROC", "C_ROUND_TYPE", "DNT_ROUND_AMOUNT", "C_DISCOUNT_TYPE", "C_DISCOUNT_KIND", "C_THIRDRELATION_TYPE", "C_GOODRELATION_TYPE", "DNT_THIRD_CONDITION", "DNT_GOOD_CONDITION", "DNT_IN_SERIES_CALCULATION", "ACS_DIVISION_ACCOUNT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "DIC_FREE_DISCOUNT_ID", "C_GAUGERELATION_TYPE", "DNT_GAUGE_CONDITION", "DNT_IS_MULTIPLICATOR", "DNT_TRANSFERT_PROP", "DNT_MODIFY", "DNT_UNIT_DETAIL", "C_RECORDRELATION_TYPE", "DNT_RECORD_CONDITION", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_CPN_ACCOUNT_ID", "DNT_EXCLUSIVE", "DIC_PTC_THIRD_GROUP_ID", "DIC_PTC_GOOD_GROUP_ID", "DNT_PRCS_USE") AS
  select PTC_DISCOUNT_ID
       , Nvl(C_CALCULATION_MODE, 'DWH_ISNULL') C_CALCULATION_MODE
       , Nvl(DNT_NAME, '_') DNT_NAME
       , DNT_RATE
       , DNT_FRACTION
       , DNT_FIXED_AMOUNT
       , DNT_EXCEEDING_AMOUNT_FROM
       , DNT_EXCEEDING_AMOUNT_TO
       , DNT_MIN_AMOUNT
       , DNT_MAX_AMOUNT
       , DNT_QUANTITY_FROM
       , DNT_QUANTITY_TO
       , Nvl(DNT_DATE_FROM, to_date('40000101', 'YYYYMMDD') ) DNT_DATE_FROM
       , Nvl(DNT_DATE_TO, to_date('40000101', 'YYYYMMDD') ) DNT_DATE_TO
       , Nvl(DNT_STORED_PROC, '_') DNT_STORED_PROC
       , Nvl(C_ROUND_TYPE, 'DWH_ISNULL') C_ROUND_TYPE
       , DNT_ROUND_AMOUNT
       , Nvl(C_DISCOUNT_TYPE, 'DWH_ISNULL') C_DISCOUNT_TYPE
       , Nvl(C_DISCOUNT_KIND, 'DWH_ISNULL') C_DISCOUNT_KIND
       , Nvl(C_THIRDRELATION_TYPE, 'DWH_ISNULL') C_THIRDRELATION_TYPE
       , Nvl(C_GOODRELATION_TYPE, 'DWH_ISNULL') C_GOODRELATION_TYPE
       , Nvl(DNT_THIRD_CONDITION, '_') DNT_THIRD_CONDITION
       , Nvl(DNT_GOOD_CONDITION, '_') DNT_GOOD_CONDITION
       , Nvl2(DNT_IN_SERIES_CALCULATION, case
                when(DNT_IN_SERIES_CALCULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_IN_SERIES_CALCULATION
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(DIC_FREE_DISCOUNT_ID, 'DWH_ISNULL') DIC_FREE_DISCOUNT_ID
       , Nvl(C_GAUGERELATION_TYPE, 'DWH_ISNULL') C_GAUGERELATION_TYPE
       , Nvl(DNT_GAUGE_CONDITION, '_') DNT_GAUGE_CONDITION
       , Nvl2(DNT_IS_MULTIPLICATOR, case
                when(DNT_IS_MULTIPLICATOR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_IS_MULTIPLICATOR
       , Nvl2(DNT_TRANSFERT_PROP, case
                when(DNT_TRANSFERT_PROP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_TRANSFERT_PROP
       , Nvl2(DNT_MODIFY, case
                when(DNT_MODIFY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_MODIFY
       , Nvl2(DNT_UNIT_DETAIL, case
                when(DNT_UNIT_DETAIL = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_UNIT_DETAIL
       , Nvl(C_RECORDRELATION_TYPE, 'DWH_ISNULL') C_RECORDRELATION_TYPE
       , Nvl(DNT_RECORD_CONDITION, '_') DNT_RECORD_CONDITION
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl2(DNT_EXCLUSIVE, case
                when(DNT_EXCLUSIVE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_EXCLUSIVE
       , Nvl(DIC_PTC_THIRD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_THIRD_GROUP_ID
       , Nvl(DIC_PTC_GOOD_GROUP_ID, 'DWH_ISNULL') DIC_PTC_GOOD_GROUP_ID
       , Nvl2(DNT_PRCS_USE, case
                when(DNT_PRCS_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') DNT_PRCS_USE
  from PTC_DISCOUNT
  union all
  select -1 PTC_DISCOUNT_ID
       , 'DWH_NA' C_CALCULATION_MODE
       , 'N/A' DNT_NAME
       , null DNT_RATE
       , null DNT_FRACTION
       , null DNT_FIXED_AMOUNT
       , null DNT_EXCEEDING_AMOUNT_FROM
       , null DNT_EXCEEDING_AMOUNT_TO
       , null DNT_MIN_AMOUNT
       , null DNT_MAX_AMOUNT
       , null DNT_QUANTITY_FROM
       , null DNT_QUANTITY_TO
       , to_date('00010101', 'YYYYMMDD') DNT_DATE_FROM
       , to_date('00010101', 'YYYYMMDD') DNT_DATE_TO
       , 'N/A' DNT_STORED_PROC
       , 'DWH_NA' C_ROUND_TYPE
       , null DNT_ROUND_AMOUNT
       , 'DWH_NA' C_DISCOUNT_TYPE
       , 'DWH_NA' C_DISCOUNT_KIND
       , 'DWH_NA' C_THIRDRELATION_TYPE
       , 'DWH_NA' C_GOODRELATION_TYPE
       , 'N/A' DNT_THIRD_CONDITION
       , 'N/A' DNT_GOOD_CONDITION
       , '-1' DNT_IN_SERIES_CALCULATION
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , 'DWH_NA' DIC_FREE_DISCOUNT_ID
       , 'DWH_NA' C_GAUGERELATION_TYPE
       , 'N/A' DNT_GAUGE_CONDITION
       , '-1' DNT_IS_MULTIPLICATOR
       , '-1' DNT_TRANSFERT_PROP
       , '-1' DNT_MODIFY
       , '-1' DNT_UNIT_DETAIL
       , 'DWH_NA' C_RECORDRELATION_TYPE
       , 'N/A' DNT_RECORD_CONDITION
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_CPN_ACCOUNT_ID
       , '-1' DNT_EXCLUSIVE
       , 'DWH_NA' DIC_PTC_THIRD_GROUP_ID
       , 'DWH_NA' DIC_PTC_GOOD_GROUP_ID
       , '-1' DNT_PRCS_USE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_SQM_AXIS" ("SQM_AXIS_ID", "C_AXIS_TYPE", "C_AXIS_STATUS", "SQM_INITIALIZATION_METHOD_ID", "SAX_NAME", "SAX_DESCRIPTION", "SAX_COMMENT", "PC_SQLST_ID", "SAX_FREE_TEXT1", "SAX_FREE_TEXT2", "SAX_FREE_TEXT3", "SAX_FREE_TEXT4", "SAX_FREE_TEXT5", "SAX_FREE_NUMBER1", "SAX_FREE_NUMBER2", "SAX_FREE_NUMBER3", "SAX_FREE_NUMBER4", "SAX_FREE_NUMBER5", "C_SQM_AXIS_ORIGIN") AS
  select SQM_AXIS_ID
       , Nvl(C_AXIS_TYPE, 'DWH_ISNULL') C_AXIS_TYPE
       , Nvl(C_AXIS_STATUS, 'DWH_ISNULL') C_AXIS_STATUS
       , Nvl(SQM_INITIALIZATION_METHOD_ID, -2) SQM_INITIALIZATION_METHOD_ID
       , Nvl(SAX_NAME, '_') SAX_NAME
       , Nvl(SAX_DESCRIPTION, '_') SAX_DESCRIPTION
       , Nvl(SAX_COMMENT, '_') SAX_COMMENT
       , Nvl(PC_SQLST_ID, -2) PC_SQLST_ID
       , Nvl(SAX_FREE_TEXT1, '_') SAX_FREE_TEXT1
       , Nvl(SAX_FREE_TEXT2, '_') SAX_FREE_TEXT2
       , Nvl(SAX_FREE_TEXT3, '_') SAX_FREE_TEXT3
       , Nvl(SAX_FREE_TEXT4, '_') SAX_FREE_TEXT4
       , Nvl(SAX_FREE_TEXT5, '_') SAX_FREE_TEXT5
       , SAX_FREE_NUMBER1
       , SAX_FREE_NUMBER2
       , SAX_FREE_NUMBER3
       , SAX_FREE_NUMBER4
       , SAX_FREE_NUMBER5
       , Nvl(C_SQM_AXIS_ORIGIN, 'DWH_ISNULL') C_SQM_AXIS_ORIGIN
  from SQM_AXIS
  union all
  select -1 SQM_AXIS_ID
       , 'DWH_NA' C_AXIS_TYPE
       , 'DWH_NA' C_AXIS_STATUS
       , -1 SQM_INITIALIZATION_METHOD_ID
       , 'N/A' SAX_NAME
       , 'N/A' SAX_DESCRIPTION
       , 'N/A' SAX_COMMENT
       , -1 PC_SQLST_ID
       , 'N/A' SAX_FREE_TEXT1
       , 'N/A' SAX_FREE_TEXT2
       , 'N/A' SAX_FREE_TEXT3
       , 'N/A' SAX_FREE_TEXT4
       , 'N/A' SAX_FREE_TEXT5
       , null SAX_FREE_NUMBER1
       , null SAX_FREE_NUMBER2
       , null SAX_FREE_NUMBER3
       , null SAX_FREE_NUMBER4
       , null SAX_FREE_NUMBER5
       , 'DWH_NA' C_SQM_AXIS_ORIGIN
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_SQM_PENALTY" ("SQM_PENALTY_ID", "SQM_SCALE_ID", "DIC_SQM_MODIF_TYPE_ID", "DOC_POSITION_DETAIL_ID", "DOC_POSITION_ID", "PAC_THIRD_ID", "GCO_GOOD_ID", "C_PENALTY_STATUS", "SPE_DATE_REFERENCE", "SPE_CALC_PENALTY", "SPE_MODIFIED_PENALTY", "SPE_MODIF_COMMENT", "SQM_AXIS_ID", "SPE_INIT_VALUE", "SPE_UPDATED_VALUE", "SPE_EXPECTED_VALUE", "SPE_EFFECTIVE_VALUE", "SQM_EVALUATION_ID", "SQM_ANC_POSITION_ID", "FAL_SCHEDULE_STEP_ID", "FAL_LOT_ID", "SQM_ANC_ID", "SPE_MANUAL_PENALTY", "SQM_ANC_DIRECT_ACTION_ID", "SQM_ANC_CAUSE_ID", "SQM_ANC_PREVENTIVE_ACTION_ID", "SQM_AUDIT_QUESTION_ID", "SQM_AUDIT_CHAPTER_ID", "SQM_AUDIT_ID", "C_SQM_AXIS_ORIGIN") AS
  select SQM_PENALTY_ID
       , Nvl(SQM_SCALE_ID, -2) SQM_SCALE_ID
       , Nvl(DIC_SQM_MODIF_TYPE_ID, 'DWH_ISNULL') DIC_SQM_MODIF_TYPE_ID
       , Nvl(DOC_POSITION_DETAIL_ID, -2) DOC_POSITION_DETAIL_ID
       , Nvl(DOC_POSITION_ID, -2) DOC_POSITION_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(C_PENALTY_STATUS, 'DWH_ISNULL') C_PENALTY_STATUS
       , Nvl(SPE_DATE_REFERENCE, to_date('40000101', 'YYYYMMDD') ) SPE_DATE_REFERENCE
       , SPE_CALC_PENALTY
       , SPE_MODIFIED_PENALTY
       , Nvl(SPE_MODIF_COMMENT, '_') SPE_MODIF_COMMENT
       , Nvl(SQM_AXIS_ID, -2) SQM_AXIS_ID
       , Nvl(SPE_INIT_VALUE, '_') SPE_INIT_VALUE
       , Nvl(SPE_UPDATED_VALUE, '_') SPE_UPDATED_VALUE
       , Nvl(SPE_EXPECTED_VALUE, '_') SPE_EXPECTED_VALUE
       , Nvl(SPE_EFFECTIVE_VALUE, '_') SPE_EFFECTIVE_VALUE
       , Nvl(SQM_EVALUATION_ID, -2) SQM_EVALUATION_ID
       , Nvl(SQM_ANC_POSITION_ID, -2) SQM_ANC_POSITION_ID
       , Nvl(FAL_SCHEDULE_STEP_ID, -2) FAL_SCHEDULE_STEP_ID
       , Nvl(FAL_LOT_ID, -2) FAL_LOT_ID
       , Nvl(SQM_ANC_ID, -2) SQM_ANC_ID
       , Nvl2(SPE_MANUAL_PENALTY, case
                when(SPE_MANUAL_PENALTY = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SPE_MANUAL_PENALTY
       , Nvl(SQM_ANC_DIRECT_ACTION_ID, -2) SQM_ANC_DIRECT_ACTION_ID
       , Nvl(SQM_ANC_CAUSE_ID, -2) SQM_ANC_CAUSE_ID
       , Nvl(SQM_ANC_PREVENTIVE_ACTION_ID, -2) SQM_ANC_PREVENTIVE_ACTION_ID
       , Nvl(SQM_AUDIT_QUESTION_ID, -2) SQM_AUDIT_QUESTION_ID
       , Nvl(SQM_AUDIT_CHAPTER_ID, -2) SQM_AUDIT_CHAPTER_ID
       , Nvl(SQM_AUDIT_ID, -2) SQM_AUDIT_ID
       , Nvl(C_SQM_AXIS_ORIGIN, 'DWH_ISNULL') C_SQM_AXIS_ORIGIN
  from SQM_PENALTY
  union all
  select -1 SQM_PENALTY_ID
       , -1 SQM_SCALE_ID
       , 'DWH_NA' DIC_SQM_MODIF_TYPE_ID
       , -1 DOC_POSITION_DETAIL_ID
       , -1 DOC_POSITION_ID
       , -1 PAC_THIRD_ID
       , -1 GCO_GOOD_ID
       , 'DWH_NA' C_PENALTY_STATUS
       , to_date('00010101', 'YYYYMMDD') SPE_DATE_REFERENCE
       , null SPE_CALC_PENALTY
       , null SPE_MODIFIED_PENALTY
       , 'N/A' SPE_MODIF_COMMENT
       , -1 SQM_AXIS_ID
       , 'N/A' SPE_INIT_VALUE
       , 'N/A' SPE_UPDATED_VALUE
       , 'N/A' SPE_EXPECTED_VALUE
       , 'N/A' SPE_EFFECTIVE_VALUE
       , -1 SQM_EVALUATION_ID
       , -1 SQM_ANC_POSITION_ID
       , -1 FAL_SCHEDULE_STEP_ID
       , -1 FAL_LOT_ID
       , -1 SQM_ANC_ID
       , '-1' SPE_MANUAL_PENALTY
       , -1 SQM_ANC_DIRECT_ACTION_ID
       , -1 SQM_ANC_CAUSE_ID
       , -1 SQM_ANC_PREVENTIVE_ACTION_ID
       , -1 SQM_AUDIT_QUESTION_ID
       , -1 SQM_AUDIT_CHAPTER_ID
       , -1 SQM_AUDIT_ID
       , 'DWH_NA' C_SQM_AXIS_ORIGIN
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_SQM_SCALE" ("SQM_SCALE_ID", "SCA_NAME", "SCA_DESCRIPTION", "SCA_STARTING_DATE", "SCA_ENDING_DATE", "SCA_PRIORITY", "SQM_AXIS_ID", "SCA_CONDITION_INDIV", "PC_SQLST_ID", "SCA_INIT_FROM_AXIS", "C_SQM_AXIS_ORIGIN") AS
  select SQM_SCALE_ID
       , Nvl(SCA_NAME, '_') SCA_NAME
       , Nvl(SCA_DESCRIPTION, '_') SCA_DESCRIPTION
       -- SCA_COMMENT cannot be used with CLOB
       , Nvl(SCA_STARTING_DATE, to_date('40000101', 'YYYYMMDD') ) SCA_STARTING_DATE
       , Nvl(SCA_ENDING_DATE, to_date('40000101', 'YYYYMMDD') ) SCA_ENDING_DATE
       , SCA_PRIORITY
       , Nvl(SQM_AXIS_ID, -2) SQM_AXIS_ID
       , Nvl2(SCA_CONDITION_INDIV, case
                when(SCA_CONDITION_INDIV = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCA_CONDITION_INDIV
       , Nvl(PC_SQLST_ID, -2) PC_SQLST_ID
       , Nvl2(SCA_INIT_FROM_AXIS, case
                when(SCA_INIT_FROM_AXIS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SCA_INIT_FROM_AXIS
       , Nvl(C_SQM_AXIS_ORIGIN, 'DWH_ISNULL') C_SQM_AXIS_ORIGIN
  from SQM_SCALE
  union all
  select -1 SQM_SCALE_ID
       , 'N/A' SCA_NAME
       , 'N/A' SCA_DESCRIPTION
       -- SCA_COMMENT cannot be used with CLOB
       , to_date('00010101', 'YYYYMMDD') SCA_STARTING_DATE
       , to_date('00010101', 'YYYYMMDD') SCA_ENDING_DATE
       , null SCA_PRIORITY
       , -1 SQM_AXIS_ID
       , '-1' SCA_CONDITION_INDIV
       , -1 PC_SQLST_ID
       , '-1' SCA_INIT_FROM_AXIS
       , 'DWH_NA' C_SQM_AXIS_ORIGIN
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_STM_EXERCISE" ("STM_EXERCISE_ID", "C_EXERCISE_STATUS", "EXE_DESCRIPTION", "EXE_STARTING_EXERCISE", "EXE_ENDING_EXERCISE") AS
  select STM_EXERCISE_ID
       , Nvl(C_EXERCISE_STATUS, 'DWH_ISNULL') C_EXERCISE_STATUS
       , Nvl(EXE_DESCRIPTION, '_') EXE_DESCRIPTION
       , Nvl(EXE_STARTING_EXERCISE, to_date('40000101', 'YYYYMMDD') ) EXE_STARTING_EXERCISE
       , Nvl(EXE_ENDING_EXERCISE, to_date('40000101', 'YYYYMMDD') ) EXE_ENDING_EXERCISE
  from STM_EXERCISE
  union all
  select -1 STM_EXERCISE_ID
       , 'DWH_NA' C_EXERCISE_STATUS
       , 'N/A' EXE_DESCRIPTION
       , to_date('00010101', 'YYYYMMDD') EXE_STARTING_EXERCISE
       , to_date('00010101', 'YYYYMMDD') EXE_ENDING_EXERCISE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_STM_LOCATION" ("STM_LOCATION_ID", "STM_STOCK_ID", "LOC_DESCRIPTION", "LOC_FREE_DESCRIPTION", "LOC_CLASSIFICATION", "LOC_LOCATION_MANAGEMENT", "LOC_FULL_LOCATION", "LOC_FIXED_STOCK_POSITION", "DIC_LOC_FREE_CODE_2_ID", "DIC_LOC_FREE_CODE_3_ID", "DIC_LOC_FREE_CODE_4_ID", "DIC_LOC_FREE_CODE_5_ID", "DIC_LOC_FREE_CODE_1_ID", "LOC_FREE_DECIMAL_1", "LOC_FREE_DECIMAL_2", "LOC_FREE_DECIMAL_3", "LOC_FREE_DECIMAL_4", "LOC_FREE_DECIMAL_5", "LOC_FREE_TEXT_1", "LOC_FREE_TEXT_2", "LOC_FREE_TEXT_3", "LOC_FREE_TEXT_4", "LOC_FREE_TEXT_5", "LOC_FREE_DATE_1", "LOC_FREE_DATE_2", "LOC_FREE_DATE_3", "LOC_FREE_DATE_4", "LOC_FREE_DATE_5", "LOC_FREE_BOOLEAN_1", "LOC_FREE_BOOLEAN_2", "LOC_FREE_BOOLEAN_3", "LOC_FREE_BOOLEAN_4", "LOC_FREE_BOOLEAN_5", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "LOC_CONTINUOUS_INVENTAR") AS
  select STM_LOCATION_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(LOC_DESCRIPTION, '_') LOC_DESCRIPTION
       , Nvl(LOC_FREE_DESCRIPTION, '_') LOC_FREE_DESCRIPTION
       , LOC_CLASSIFICATION
       , Nvl2(LOC_LOCATION_MANAGEMENT, case
                when(LOC_LOCATION_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_LOCATION_MANAGEMENT
       , Nvl2(LOC_FULL_LOCATION, case
                when(LOC_FULL_LOCATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FULL_LOCATION
       , Nvl2(LOC_FIXED_STOCK_POSITION, case
                when(LOC_FIXED_STOCK_POSITION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FIXED_STOCK_POSITION
       , Nvl(DIC_LOC_FREE_CODE_2_ID, 'DWH_ISNULL') DIC_LOC_FREE_CODE_2_ID
       , Nvl(DIC_LOC_FREE_CODE_3_ID, 'DWH_ISNULL') DIC_LOC_FREE_CODE_3_ID
       , Nvl(DIC_LOC_FREE_CODE_4_ID, 'DWH_ISNULL') DIC_LOC_FREE_CODE_4_ID
       , Nvl(DIC_LOC_FREE_CODE_5_ID, 'DWH_ISNULL') DIC_LOC_FREE_CODE_5_ID
       , Nvl(DIC_LOC_FREE_CODE_1_ID, 'DWH_ISNULL') DIC_LOC_FREE_CODE_1_ID
       , LOC_FREE_DECIMAL_1
       , LOC_FREE_DECIMAL_2
       , LOC_FREE_DECIMAL_3
       , LOC_FREE_DECIMAL_4
       , LOC_FREE_DECIMAL_5
       , Nvl(LOC_FREE_TEXT_1, '_') LOC_FREE_TEXT_1
       , Nvl(LOC_FREE_TEXT_2, '_') LOC_FREE_TEXT_2
       , Nvl(LOC_FREE_TEXT_3, '_') LOC_FREE_TEXT_3
       , Nvl(LOC_FREE_TEXT_4, '_') LOC_FREE_TEXT_4
       , Nvl(LOC_FREE_TEXT_5, '_') LOC_FREE_TEXT_5
       , Nvl(LOC_FREE_DATE_1, to_date('40000101', 'YYYYMMDD') ) LOC_FREE_DATE_1
       , Nvl(LOC_FREE_DATE_2, to_date('40000101', 'YYYYMMDD') ) LOC_FREE_DATE_2
       , Nvl(LOC_FREE_DATE_3, to_date('40000101', 'YYYYMMDD') ) LOC_FREE_DATE_3
       , Nvl(LOC_FREE_DATE_4, to_date('40000101', 'YYYYMMDD') ) LOC_FREE_DATE_4
       , Nvl(LOC_FREE_DATE_5, to_date('40000101', 'YYYYMMDD') ) LOC_FREE_DATE_5
       , Nvl2(LOC_FREE_BOOLEAN_1, case
                when(LOC_FREE_BOOLEAN_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FREE_BOOLEAN_1
       , Nvl2(LOC_FREE_BOOLEAN_2, case
                when(LOC_FREE_BOOLEAN_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FREE_BOOLEAN_2
       , Nvl2(LOC_FREE_BOOLEAN_3, case
                when(LOC_FREE_BOOLEAN_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FREE_BOOLEAN_3
       , Nvl2(LOC_FREE_BOOLEAN_4, case
                when(LOC_FREE_BOOLEAN_4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FREE_BOOLEAN_4
       , Nvl2(LOC_FREE_BOOLEAN_5, case
                when(LOC_FREE_BOOLEAN_5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_FREE_BOOLEAN_5
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl2(LOC_CONTINUOUS_INVENTAR, case
                when(LOC_CONTINUOUS_INVENTAR = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') LOC_CONTINUOUS_INVENTAR
  from STM_LOCATION
  union all
  select -1 STM_LOCATION_ID
       , -1 STM_STOCK_ID
       , 'N/A' LOC_DESCRIPTION
       , 'N/A' LOC_FREE_DESCRIPTION
       , null LOC_CLASSIFICATION
       , '-1' LOC_LOCATION_MANAGEMENT
       , '-1' LOC_FULL_LOCATION
       , '-1' LOC_FIXED_STOCK_POSITION
       , 'DWH_NA' DIC_LOC_FREE_CODE_2_ID
       , 'DWH_NA' DIC_LOC_FREE_CODE_3_ID
       , 'DWH_NA' DIC_LOC_FREE_CODE_4_ID
       , 'DWH_NA' DIC_LOC_FREE_CODE_5_ID
       , 'DWH_NA' DIC_LOC_FREE_CODE_1_ID
       , null LOC_FREE_DECIMAL_1
       , null LOC_FREE_DECIMAL_2
       , null LOC_FREE_DECIMAL_3
       , null LOC_FREE_DECIMAL_4
       , null LOC_FREE_DECIMAL_5
       , 'N/A' LOC_FREE_TEXT_1
       , 'N/A' LOC_FREE_TEXT_2
       , 'N/A' LOC_FREE_TEXT_3
       , 'N/A' LOC_FREE_TEXT_4
       , 'N/A' LOC_FREE_TEXT_5
       , to_date('00010101', 'YYYYMMDD') LOC_FREE_DATE_1
       , to_date('00010101', 'YYYYMMDD') LOC_FREE_DATE_2
       , to_date('00010101', 'YYYYMMDD') LOC_FREE_DATE_3
       , to_date('00010101', 'YYYYMMDD') LOC_FREE_DATE_4
       , to_date('00010101', 'YYYYMMDD') LOC_FREE_DATE_5
       , '-1' LOC_FREE_BOOLEAN_1
       , '-1' LOC_FREE_BOOLEAN_2
       , '-1' LOC_FREE_BOOLEAN_3
       , '-1' LOC_FREE_BOOLEAN_4
       , '-1' LOC_FREE_BOOLEAN_5
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , '-1' LOC_CONTINUOUS_INVENTAR
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_STM_MOVEMENT_KIND" ("STM_MOVEMENT_KIND_ID", "STM_STM_MOVEMENT_KIND_ID", "STM_STOCK_ID", "C_MOVEMENT_SORT", "C_MOVEMENT_TYPE", "C_MOVEMENT_CODE", "MOK_COSTPRICE_USE", "MOK_STANDARD_SIGN", "MOK_ABBREVIATION", "MOK_FINANCIAL_IMPUTATION", "ACJ_JOB_TYPE_S_CATALOGUE_ID", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "MOK_VISIBLE_PART", "MOK_VISIBLE_DOC", "MOK_VISIBLE_DOC_EXT", "MOK_VISIBLE_PART_EXT", "MOK_VISIBLE_LIB", "MOK_OBLIG_PART", "MOK_OBLIG_DOC", "MOK_OBLIG_PART_EXT", "MOK_OBLIG_DOC_EXT", "MOK_OBLIG_LIB", "MOK_ANAL_IMPUTATION", "MOK_SUBCONTRACT_UPDATE", "MOK_VERIFY_CHARACTERIZATION", "MOK_UPDATE_OP", "MOK_PIC_USE", "MOK_GUARANTY_USE", "MOK_USE_MANAGED_DATA", "DIC_MOK_STATISTIC_3_ID", "DIC_MOK_STATISTIC_2_ID", "MOK_BOOLEAN_3", "MOK_BOOLEAN_2", "MOK_BOOLEAN_1", "MOK_NUMERIC_1", "MOK_NUMERIC_2", "MOK_NUMERIC_3", "DIC_MOK_STATISTIC_1_ID", "MOK_RETURN", "MOK_USE_RESTOCKING", "MOK_TRANSFER_ATTRIB", "MOK_EXPORT_MVT", "MOK_CONSUMER_ANALYSE_USE") AS
  select STM_MOVEMENT_KIND_ID
       , Nvl(STM_STM_MOVEMENT_KIND_ID, -2) STM_STM_MOVEMENT_KIND_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(C_MOVEMENT_SORT, 'DWH_ISNULL') C_MOVEMENT_SORT
       , Nvl(C_MOVEMENT_TYPE, 'DWH_ISNULL') C_MOVEMENT_TYPE
       , Nvl(C_MOVEMENT_CODE, 'DWH_ISNULL') C_MOVEMENT_CODE
       , Nvl2(MOK_COSTPRICE_USE, case
                when(MOK_COSTPRICE_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_COSTPRICE_USE
       , MOK_STANDARD_SIGN
       , Nvl(MOK_ABBREVIATION, '_') MOK_ABBREVIATION
       , Nvl2(MOK_FINANCIAL_IMPUTATION, case
                when(MOK_FINANCIAL_IMPUTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_FINANCIAL_IMPUTATION
       , Nvl(ACJ_JOB_TYPE_S_CATALOGUE_ID, -2) ACJ_JOB_TYPE_S_CATALOGUE_ID
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl2(MOK_VISIBLE_PART, case
                when(MOK_VISIBLE_PART = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_VISIBLE_PART
       , Nvl2(MOK_VISIBLE_DOC, case
                when(MOK_VISIBLE_DOC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_VISIBLE_DOC
       , Nvl2(MOK_VISIBLE_DOC_EXT, case
                when(MOK_VISIBLE_DOC_EXT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_VISIBLE_DOC_EXT
       , Nvl2(MOK_VISIBLE_PART_EXT, case
                when(MOK_VISIBLE_PART_EXT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_VISIBLE_PART_EXT
       , Nvl2(MOK_VISIBLE_LIB, case
                when(MOK_VISIBLE_LIB = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_VISIBLE_LIB
       , Nvl2(MOK_OBLIG_PART, case
                when(MOK_OBLIG_PART = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_OBLIG_PART
       , Nvl2(MOK_OBLIG_DOC, case
                when(MOK_OBLIG_DOC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_OBLIG_DOC
       , Nvl2(MOK_OBLIG_PART_EXT, case
                when(MOK_OBLIG_PART_EXT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_OBLIG_PART_EXT
       , Nvl2(MOK_OBLIG_DOC_EXT, case
                when(MOK_OBLIG_DOC_EXT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_OBLIG_DOC_EXT
       , Nvl2(MOK_OBLIG_LIB, case
                when(MOK_OBLIG_LIB = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_OBLIG_LIB
       , Nvl2(MOK_ANAL_IMPUTATION, case
                when(MOK_ANAL_IMPUTATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_ANAL_IMPUTATION
       , Nvl2(MOK_SUBCONTRACT_UPDATE, case
                when(MOK_SUBCONTRACT_UPDATE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_SUBCONTRACT_UPDATE
       , Nvl2(MOK_VERIFY_CHARACTERIZATION, case
                when(MOK_VERIFY_CHARACTERIZATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_VERIFY_CHARACTERIZATION
       , Nvl2(MOK_UPDATE_OP, case
                when(MOK_UPDATE_OP = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_UPDATE_OP
       , Nvl2(MOK_PIC_USE, case
                when(MOK_PIC_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_PIC_USE
       , Nvl2(MOK_GUARANTY_USE, case
                when(MOK_GUARANTY_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_GUARANTY_USE
       , Nvl2(MOK_USE_MANAGED_DATA, case
                when(MOK_USE_MANAGED_DATA = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_USE_MANAGED_DATA
       , Nvl(DIC_MOK_STATISTIC_3_ID, 'DWH_ISNULL') DIC_MOK_STATISTIC_3_ID
       , Nvl(DIC_MOK_STATISTIC_2_ID, 'DWH_ISNULL') DIC_MOK_STATISTIC_2_ID
       , Nvl2(MOK_BOOLEAN_3, case
                when(MOK_BOOLEAN_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_BOOLEAN_3
       , Nvl2(MOK_BOOLEAN_2, case
                when(MOK_BOOLEAN_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_BOOLEAN_2
       , Nvl2(MOK_BOOLEAN_1, case
                when(MOK_BOOLEAN_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_BOOLEAN_1
       , MOK_NUMERIC_1
       , MOK_NUMERIC_2
       , MOK_NUMERIC_3
       , Nvl(DIC_MOK_STATISTIC_1_ID, 'DWH_ISNULL') DIC_MOK_STATISTIC_1_ID
       , Nvl2(MOK_RETURN, case
                when(MOK_RETURN = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_RETURN
       , Nvl2(MOK_USE_RESTOCKING, case
                when(MOK_USE_RESTOCKING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_USE_RESTOCKING
       , Nvl2(MOK_TRANSFER_ATTRIB, case
                when(MOK_TRANSFER_ATTRIB = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_TRANSFER_ATTRIB
       , Nvl2(MOK_EXPORT_MVT, case
                when(MOK_EXPORT_MVT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_EXPORT_MVT
       , Nvl2(MOK_CONSUMER_ANALYSE_USE, case
                when(MOK_CONSUMER_ANALYSE_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') MOK_CONSUMER_ANALYSE_USE
  from STM_MOVEMENT_KIND
  union all
  select -1 STM_MOVEMENT_KIND_ID
       , -1 STM_STM_MOVEMENT_KIND_ID
       , -1 STM_STOCK_ID
       , 'DWH_NA' C_MOVEMENT_SORT
       , 'DWH_NA' C_MOVEMENT_TYPE
       , 'DWH_NA' C_MOVEMENT_CODE
       , '-1' MOK_COSTPRICE_USE
       , null MOK_STANDARD_SIGN
       , 'N/A' MOK_ABBREVIATION
       , '-1' MOK_FINANCIAL_IMPUTATION
       , -1 ACJ_JOB_TYPE_S_CATALOGUE_ID
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , '-1' MOK_VISIBLE_PART
       , '-1' MOK_VISIBLE_DOC
       , '-1' MOK_VISIBLE_DOC_EXT
       , '-1' MOK_VISIBLE_PART_EXT
       , '-1' MOK_VISIBLE_LIB
       , '-1' MOK_OBLIG_PART
       , '-1' MOK_OBLIG_DOC
       , '-1' MOK_OBLIG_PART_EXT
       , '-1' MOK_OBLIG_DOC_EXT
       , '-1' MOK_OBLIG_LIB
       , '-1' MOK_ANAL_IMPUTATION
       , '-1' MOK_SUBCONTRACT_UPDATE
       , '-1' MOK_VERIFY_CHARACTERIZATION
       , '-1' MOK_UPDATE_OP
       , '-1' MOK_PIC_USE
       , '-1' MOK_GUARANTY_USE
       , '-1' MOK_USE_MANAGED_DATA
       , 'DWH_NA' DIC_MOK_STATISTIC_3_ID
       , 'DWH_NA' DIC_MOK_STATISTIC_2_ID
       , '-1' MOK_BOOLEAN_3
       , '-1' MOK_BOOLEAN_2
       , '-1' MOK_BOOLEAN_1
       , null MOK_NUMERIC_1
       , null MOK_NUMERIC_2
       , null MOK_NUMERIC_3
       , 'DWH_NA' DIC_MOK_STATISTIC_1_ID
       , '-1' MOK_RETURN
       , '-1' MOK_USE_RESTOCKING
       , '-1' MOK_TRANSFER_ATTRIB
       , '-1' MOK_EXPORT_MVT
       , '-1' MOK_CONSUMER_ANALYSE_USE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_STM_STOCK" ("STM_STOCK_ID", "STO_DESCRIPTION", "STO_FREE_DESCRIPTION", "STO_CLASSIFICATION", "C_ACCESS_METHOD", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "STO_NEED_CALCULATION", "ACS_VAT_DET_ACCOUNT_ID", "STO_NEED_PIC", "STO_FIXED_STOCK_POSITION", "STO_COSTPRICE_RESET", "DIC_STO_FREE_CODE_2_ID", "DIC_STO_FREE_CODE_3_ID", "DIC_STO_FREE_CODE_4_ID", "DIC_STO_FREE_CODE_5_ID", "DIC_STO_FREE_CODE_1_ID", "STO_FREE_DECIMAL_1", "STO_FREE_DECIMAL_2", "STO_FREE_DECIMAL_3", "STO_FREE_DECIMAL_4", "STO_FREE_DECIMAL_5", "STO_FREE_TEXT_1", "STO_FREE_TEXT_2", "STO_FREE_TEXT_3", "STO_FREE_TEXT_4", "STO_FREE_TEXT_5", "STO_FREE_DATE_1", "STO_FREE_DATE_2", "STO_FREE_DATE_3", "STO_FREE_DATE_4", "STO_FREE_DATE_5", "STO_FREE_BOOLEAN_1", "STO_FREE_BOOLEAN_2", "STO_FREE_BOOLEAN_3", "STO_FREE_BOOLEAN_4", "STO_FREE_BOOLEAN_5", "C_STO_METAL_ACCOUNT_TYPE", "C_THIRD_MATERIAL_RELATION_TYPE", "PAC_THIRD_ID", "STO_METAL_ACCOUNT", "STO_DEFAULT_METAL_ACCOUNT", "STO_CONSUMER_ANALYSE_USE") AS
  select STM_STOCK_ID
       , Nvl(STO_DESCRIPTION, '_') STO_DESCRIPTION
       , Nvl(STO_FREE_DESCRIPTION, '_') STO_FREE_DESCRIPTION
       , STO_CLASSIFICATION
       , Nvl(C_ACCESS_METHOD, 'DWH_ISNULL') C_ACCESS_METHOD
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl2(STO_NEED_CALCULATION, case
                when(STO_NEED_CALCULATION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_NEED_CALCULATION
       , Nvl(ACS_VAT_DET_ACCOUNT_ID, -2) ACS_VAT_DET_ACCOUNT_ID
       , Nvl2(STO_NEED_PIC, case
                when(STO_NEED_PIC = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_NEED_PIC
       , Nvl2(STO_FIXED_STOCK_POSITION, case
                when(STO_FIXED_STOCK_POSITION = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_FIXED_STOCK_POSITION
       , Nvl2(STO_COSTPRICE_RESET, case
                when(STO_COSTPRICE_RESET = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_COSTPRICE_RESET
       , Nvl(DIC_STO_FREE_CODE_2_ID, 'DWH_ISNULL') DIC_STO_FREE_CODE_2_ID
       , Nvl(DIC_STO_FREE_CODE_3_ID, 'DWH_ISNULL') DIC_STO_FREE_CODE_3_ID
       , Nvl(DIC_STO_FREE_CODE_4_ID, 'DWH_ISNULL') DIC_STO_FREE_CODE_4_ID
       , Nvl(DIC_STO_FREE_CODE_5_ID, 'DWH_ISNULL') DIC_STO_FREE_CODE_5_ID
       , Nvl(DIC_STO_FREE_CODE_1_ID, 'DWH_ISNULL') DIC_STO_FREE_CODE_1_ID
       , STO_FREE_DECIMAL_1
       , STO_FREE_DECIMAL_2
       , STO_FREE_DECIMAL_3
       , STO_FREE_DECIMAL_4
       , STO_FREE_DECIMAL_5
       , Nvl(STO_FREE_TEXT_1, '_') STO_FREE_TEXT_1
       , Nvl(STO_FREE_TEXT_2, '_') STO_FREE_TEXT_2
       , Nvl(STO_FREE_TEXT_3, '_') STO_FREE_TEXT_3
       , Nvl(STO_FREE_TEXT_4, '_') STO_FREE_TEXT_4
       , Nvl(STO_FREE_TEXT_5, '_') STO_FREE_TEXT_5
       , Nvl(STO_FREE_DATE_1, to_date('40000101', 'YYYYMMDD') ) STO_FREE_DATE_1
       , Nvl(STO_FREE_DATE_2, to_date('40000101', 'YYYYMMDD') ) STO_FREE_DATE_2
       , Nvl(STO_FREE_DATE_3, to_date('40000101', 'YYYYMMDD') ) STO_FREE_DATE_3
       , Nvl(STO_FREE_DATE_4, to_date('40000101', 'YYYYMMDD') ) STO_FREE_DATE_4
       , Nvl(STO_FREE_DATE_5, to_date('40000101', 'YYYYMMDD') ) STO_FREE_DATE_5
       , Nvl2(STO_FREE_BOOLEAN_1, case
                when(STO_FREE_BOOLEAN_1 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_FREE_BOOLEAN_1
       , Nvl2(STO_FREE_BOOLEAN_2, case
                when(STO_FREE_BOOLEAN_2 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_FREE_BOOLEAN_2
       , Nvl2(STO_FREE_BOOLEAN_3, case
                when(STO_FREE_BOOLEAN_3 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_FREE_BOOLEAN_3
       , Nvl2(STO_FREE_BOOLEAN_4, case
                when(STO_FREE_BOOLEAN_4 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_FREE_BOOLEAN_4
       , Nvl2(STO_FREE_BOOLEAN_5, case
                when(STO_FREE_BOOLEAN_5 = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_FREE_BOOLEAN_5
       , Nvl(C_STO_METAL_ACCOUNT_TYPE, 'DWH_ISNULL') C_STO_METAL_ACCOUNT_TYPE
       , Nvl(C_THIRD_MATERIAL_RELATION_TYPE, 'DWH_ISNULL') C_THIRD_MATERIAL_RELATION_TYPE
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl2(STO_METAL_ACCOUNT, case
                when(STO_METAL_ACCOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_METAL_ACCOUNT
       , Nvl2(STO_DEFAULT_METAL_ACCOUNT, case
                when(STO_DEFAULT_METAL_ACCOUNT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_DEFAULT_METAL_ACCOUNT
       , Nvl2(STO_CONSUMER_ANALYSE_USE, case
                when(STO_CONSUMER_ANALYSE_USE = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') STO_CONSUMER_ANALYSE_USE
       -- STO_CLOB cannot be used with CLOB
       -- STO_BLOB cannot be used with BLOB
  from STM_STOCK
  union all
  select -1 STM_STOCK_ID
       , 'N/A' STO_DESCRIPTION
       , 'N/A' STO_FREE_DESCRIPTION
       , null STO_CLASSIFICATION
       , 'DWH_NA' C_ACCESS_METHOD
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , '-1' STO_NEED_CALCULATION
       , -1 ACS_VAT_DET_ACCOUNT_ID
       , '-1' STO_NEED_PIC
       , '-1' STO_FIXED_STOCK_POSITION
       , '-1' STO_COSTPRICE_RESET
       , 'DWH_NA' DIC_STO_FREE_CODE_2_ID
       , 'DWH_NA' DIC_STO_FREE_CODE_3_ID
       , 'DWH_NA' DIC_STO_FREE_CODE_4_ID
       , 'DWH_NA' DIC_STO_FREE_CODE_5_ID
       , 'DWH_NA' DIC_STO_FREE_CODE_1_ID
       , null STO_FREE_DECIMAL_1
       , null STO_FREE_DECIMAL_2
       , null STO_FREE_DECIMAL_3
       , null STO_FREE_DECIMAL_4
       , null STO_FREE_DECIMAL_5
       , 'N/A' STO_FREE_TEXT_1
       , 'N/A' STO_FREE_TEXT_2
       , 'N/A' STO_FREE_TEXT_3
       , 'N/A' STO_FREE_TEXT_4
       , 'N/A' STO_FREE_TEXT_5
       , to_date('00010101', 'YYYYMMDD') STO_FREE_DATE_1
       , to_date('00010101', 'YYYYMMDD') STO_FREE_DATE_2
       , to_date('00010101', 'YYYYMMDD') STO_FREE_DATE_3
       , to_date('00010101', 'YYYYMMDD') STO_FREE_DATE_4
       , to_date('00010101', 'YYYYMMDD') STO_FREE_DATE_5
       , '-1' STO_FREE_BOOLEAN_1
       , '-1' STO_FREE_BOOLEAN_2
       , '-1' STO_FREE_BOOLEAN_3
       , '-1' STO_FREE_BOOLEAN_4
       , '-1' STO_FREE_BOOLEAN_5
       , 'DWH_NA' C_STO_METAL_ACCOUNT_TYPE
       , 'DWH_NA' C_THIRD_MATERIAL_RELATION_TYPE
       , -1 PAC_THIRD_ID
       , '-1' STO_METAL_ACCOUNT
       , '-1' STO_DEFAULT_METAL_ACCOUNT
       , '-1' STO_CONSUMER_ANALYSE_USE
       -- STO_CLOB cannot be used with CLOB
       -- STO_BLOB cannot be used with BLOB
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_DWH_S_STM_STOCK_MOVEMENT" ("STM_STOCK_MOVEMENT_ID", "STM_STM_STOCK_MOVEMENT_ID", "STM2_STM_STOCK_MOVEMENT_ID", "STM_EXERCISE_ID", "STM_PERIOD_ID", "STM_MOVEMENT_KIND_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "PAC_THIRD_ID", "GCO_GOOD_ID", "ACS_ACCOUNT_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "DOC_RECORD_ID", "SMO_MOVEMENT_DATE", "SMO_WORDING", "SMO_EXTERNAL_DOCUMENT", "SMO_EXTERNAL_PARTNER", "SMO_CHARACTERIZATION_VALUE_1", "SMO_CHARACTERIZATION_VALUE_2", "SMO_CHARACTERIZATION_VALUE_3", "SMO_CHARACTERIZATION_VALUE_4", "SMO_CHARACTERIZATION_VALUE_5", "SMO_MOVEMENT_QUANTITY", "SMO_MOVEMENT_PRICE", "SMO_DOCUMENT_QUANTITY", "SMO_DOCUMENT_PRICE", "SMO_UNIT_PRICE", "SMO_FINANCIAL_CHARGING", "ACS_FINANCIAL_ACCOUNT_ID", "ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_DIVISION_ACCOUNT_ID", "ACS_ACS_FINANCIAL_ACCOUNT_ID", "DOC_POSITION_DETAIL_ID", "SMO_MVT_ALTERNATIV_QTY_1", "SMO_MVT_ALTERNATIV_QTY_2", "SMO_MVT_ALTERNATIV_QTY_3", "SMO_REFERENCE_UNIT_PRICE", "ACS_CPN_ACCOUNT_ID", "ACS_ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "ACS_ACS_PJ_ACCOUNT_ID", "DOC_POSITION_ID", "SMO_UPDATE_PROV", "SMO_EXTOURNE_MVT", "FAM_FIXED_ASSETS_ID", "HRM_PERSON_ID", "C_FAM_TRANSACTION_TYP", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "SMO_IMP_TEXT_1", "SMO_IMP_TEXT_2", "SMO_IMP_TEXT_3", "SMO_IMP_TEXT_4", "SMO_IMP_TEXT_5", "SMO_IMP_NUMBER_1", "SMO_IMP_NUMBER_2", "SMO_IMP_NUMBER_3", "SMO_IMP_NUMBER_4", "SMO_IMP_NUMBER_5", "SMO_UPDATE_PRCS", "SMO_PRCS_BEFORE", "SMO_PRCS_AFTER", "SMO_PIECE", "SMO_SET", "SMO_VERSION", "SMO_CHRONOLOGICAL", "SMO_STD_CHAR_1", "SMO_STD_CHAR_2", "SMO_STD_CHAR_3", "SMO_STD_CHAR_4", "SMO_STD_CHAR_5", "SMO_FINANCIAL_PRICE", "SMO_PRCS_ADDED_QUANTITY_BEFORE", "SMO_PRCS_ADDED_QUANTITY_AFTER", "SMO_PRCS_ADDED_VALUE_BEFORE", "SMO_PRCS_ADDED_VALUE_AFTER", "STM_DISTRIBUTION_UNIT_ID", "STM_STM_DISTRIBUTION_UNIT_ID", "SMO_USE_RESTOCKING", "SMO_VALUE_DATE", "SMO_MOVEMENT_ORDER_KEY", "SMO_PRCS_UPDATED", "DOC_FOOT_ALLOY_ID", "SMO_STOCK_MANAGEMENT", "FAL_LOT_ID", "FAL_FACTORY_IN_ID", "FAL_FACTORY_OUT_ID", "PAC_THIRD_ACI_ID", "PAC_THIRD_DELIVERY_ID", "PAC_THIRD_TARIFF_ID", "ASA_INTERVENTION_DETAIL_ID", "SMO_PRCS_VALUE") AS
  select STM_STOCK_MOVEMENT_ID
       , Nvl(STM_STM_STOCK_MOVEMENT_ID, -2) STM_STM_STOCK_MOVEMENT_ID
       , Nvl(STM2_STM_STOCK_MOVEMENT_ID, -2) STM2_STM_STOCK_MOVEMENT_ID
       , Nvl(STM_EXERCISE_ID, -2) STM_EXERCISE_ID
       , Nvl(STM_PERIOD_ID, -2) STM_PERIOD_ID
       , Nvl(STM_MOVEMENT_KIND_ID, -2) STM_MOVEMENT_KIND_ID
       , Nvl(STM_STOCK_ID, -2) STM_STOCK_ID
       , Nvl(STM_LOCATION_ID, -2) STM_LOCATION_ID
       , Nvl(PAC_THIRD_ID, -2) PAC_THIRD_ID
       , Nvl(GCO_GOOD_ID, -2) GCO_GOOD_ID
       , Nvl(ACS_ACCOUNT_ID, -2) ACS_ACCOUNT_ID
       , Nvl(GCO_CHARACTERIZATION_ID, -2) GCO_CHARACTERIZATION_ID
       , Nvl(GCO_GCO_CHARACTERIZATION_ID, -2) GCO_GCO_CHARACTERIZATION_ID
       , Nvl(GCO2_GCO_CHARACTERIZATION_ID, -2) GCO2_GCO_CHARACTERIZATION_ID
       , Nvl(GCO3_GCO_CHARACTERIZATION_ID, -2) GCO3_GCO_CHARACTERIZATION_ID
       , Nvl(GCO4_GCO_CHARACTERIZATION_ID, -2) GCO4_GCO_CHARACTERIZATION_ID
       , Nvl(DOC_RECORD_ID, -2) DOC_RECORD_ID
       , Nvl(SMO_MOVEMENT_DATE, to_date('40000101', 'YYYYMMDD') ) SMO_MOVEMENT_DATE
       , Nvl(SMO_WORDING, '_') SMO_WORDING
       , Nvl(SMO_EXTERNAL_DOCUMENT, '_') SMO_EXTERNAL_DOCUMENT
       , Nvl(SMO_EXTERNAL_PARTNER, '_') SMO_EXTERNAL_PARTNER
       , Nvl(SMO_CHARACTERIZATION_VALUE_1, '_') SMO_CHARACTERIZATION_VALUE_1
       , Nvl(SMO_CHARACTERIZATION_VALUE_2, '_') SMO_CHARACTERIZATION_VALUE_2
       , Nvl(SMO_CHARACTERIZATION_VALUE_3, '_') SMO_CHARACTERIZATION_VALUE_3
       , Nvl(SMO_CHARACTERIZATION_VALUE_4, '_') SMO_CHARACTERIZATION_VALUE_4
       , Nvl(SMO_CHARACTERIZATION_VALUE_5, '_') SMO_CHARACTERIZATION_VALUE_5
       , SMO_MOVEMENT_QUANTITY
       , SMO_MOVEMENT_PRICE
       , SMO_DOCUMENT_QUANTITY
       , SMO_DOCUMENT_PRICE
       , SMO_UNIT_PRICE
       , Nvl2(SMO_FINANCIAL_CHARGING, case
                when(SMO_FINANCIAL_CHARGING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_FINANCIAL_CHARGING
       , Nvl(ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(ACS_DIVISION_ACCOUNT_ID, -2) ACS_DIVISION_ACCOUNT_ID
       , Nvl(ACS_ACS_DIVISION_ACCOUNT_ID, -2) ACS_ACS_DIVISION_ACCOUNT_ID
       , Nvl(ACS_ACS_FINANCIAL_ACCOUNT_ID, -2) ACS_ACS_FINANCIAL_ACCOUNT_ID
       , Nvl(DOC_POSITION_DETAIL_ID, -2) DOC_POSITION_DETAIL_ID
       , SMO_MVT_ALTERNATIV_QTY_1
       , SMO_MVT_ALTERNATIV_QTY_2
       , SMO_MVT_ALTERNATIV_QTY_3
       , SMO_REFERENCE_UNIT_PRICE
       , Nvl(ACS_CPN_ACCOUNT_ID, -2) ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_ACS_CPN_ACCOUNT_ID, -2) ACS_ACS_CPN_ACCOUNT_ID
       , Nvl(ACS_CDA_ACCOUNT_ID, -2) ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_ACS_CDA_ACCOUNT_ID, -2) ACS_ACS_CDA_ACCOUNT_ID
       , Nvl(ACS_PF_ACCOUNT_ID, -2) ACS_PF_ACCOUNT_ID
       , Nvl(ACS_ACS_PF_ACCOUNT_ID, -2) ACS_ACS_PF_ACCOUNT_ID
       , Nvl(ACS_PJ_ACCOUNT_ID, -2) ACS_PJ_ACCOUNT_ID
       , Nvl(ACS_ACS_PJ_ACCOUNT_ID, -2) ACS_ACS_PJ_ACCOUNT_ID
       , Nvl(DOC_POSITION_ID, -2) DOC_POSITION_ID
       , Nvl2(SMO_UPDATE_PROV, case
                when(SMO_UPDATE_PROV = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_UPDATE_PROV
       , Nvl2(SMO_EXTOURNE_MVT, case
                when(SMO_EXTOURNE_MVT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_EXTOURNE_MVT
       , Nvl(FAM_FIXED_ASSETS_ID, -2) FAM_FIXED_ASSETS_ID
       , Nvl(HRM_PERSON_ID, -2) HRM_PERSON_ID
       , Nvl(C_FAM_TRANSACTION_TYP, 'DWH_ISNULL') C_FAM_TRANSACTION_TYP
       , Nvl(DIC_IMP_FREE1_ID, 'DWH_ISNULL') DIC_IMP_FREE1_ID
       , Nvl(DIC_IMP_FREE2_ID, 'DWH_ISNULL') DIC_IMP_FREE2_ID
       , Nvl(DIC_IMP_FREE3_ID, 'DWH_ISNULL') DIC_IMP_FREE3_ID
       , Nvl(DIC_IMP_FREE4_ID, 'DWH_ISNULL') DIC_IMP_FREE4_ID
       , Nvl(DIC_IMP_FREE5_ID, 'DWH_ISNULL') DIC_IMP_FREE5_ID
       , Nvl(SMO_IMP_TEXT_1, '_') SMO_IMP_TEXT_1
       , Nvl(SMO_IMP_TEXT_2, '_') SMO_IMP_TEXT_2
       , Nvl(SMO_IMP_TEXT_3, '_') SMO_IMP_TEXT_3
       , Nvl(SMO_IMP_TEXT_4, '_') SMO_IMP_TEXT_4
       , Nvl(SMO_IMP_TEXT_5, '_') SMO_IMP_TEXT_5
       , SMO_IMP_NUMBER_1
       , SMO_IMP_NUMBER_2
       , SMO_IMP_NUMBER_3
       , SMO_IMP_NUMBER_4
       , SMO_IMP_NUMBER_5
       , Nvl2(SMO_UPDATE_PRCS, case
                when(SMO_UPDATE_PRCS = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_UPDATE_PRCS
       , SMO_PRCS_BEFORE
       , SMO_PRCS_AFTER
       , Nvl(SMO_PIECE, '_') SMO_PIECE
       , Nvl(SMO_SET, '_') SMO_SET
       , Nvl(SMO_VERSION, '_') SMO_VERSION
       , Nvl(SMO_CHRONOLOGICAL, '_') SMO_CHRONOLOGICAL
       , Nvl(SMO_STD_CHAR_1, '_') SMO_STD_CHAR_1
       , Nvl(SMO_STD_CHAR_2, '_') SMO_STD_CHAR_2
       , Nvl(SMO_STD_CHAR_3, '_') SMO_STD_CHAR_3
       , Nvl(SMO_STD_CHAR_4, '_') SMO_STD_CHAR_4
       , Nvl(SMO_STD_CHAR_5, '_') SMO_STD_CHAR_5
       , SMO_FINANCIAL_PRICE
       , SMO_PRCS_ADDED_QUANTITY_BEFORE
       , SMO_PRCS_ADDED_QUANTITY_AFTER
       , SMO_PRCS_ADDED_VALUE_BEFORE
       , SMO_PRCS_ADDED_VALUE_AFTER
       , Nvl(STM_DISTRIBUTION_UNIT_ID, -2) STM_DISTRIBUTION_UNIT_ID
       , Nvl(STM_STM_DISTRIBUTION_UNIT_ID, -2) STM_STM_DISTRIBUTION_UNIT_ID
       , Nvl2(SMO_USE_RESTOCKING, case
                when(SMO_USE_RESTOCKING = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_USE_RESTOCKING
       , Nvl(SMO_VALUE_DATE, to_date('40000101', 'YYYYMMDD') ) SMO_VALUE_DATE
       , SMO_MOVEMENT_ORDER_KEY
       , Nvl2(SMO_PRCS_UPDATED, case
                when(SMO_PRCS_UPDATED = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_PRCS_UPDATED
       , Nvl(DOC_FOOT_ALLOY_ID, -2) DOC_FOOT_ALLOY_ID
       , Nvl2(SMO_STOCK_MANAGEMENT, case
                when(SMO_STOCK_MANAGEMENT = 1) then 'DWH_TRUE'
                else 'DWH_FALSE'
              end, '-2') SMO_STOCK_MANAGEMENT
       , Nvl(FAL_LOT_ID, -2) FAL_LOT_ID
       , Nvl(FAL_FACTORY_IN_ID, -2) FAL_FACTORY_IN_ID
       , Nvl(FAL_FACTORY_OUT_ID, -2) FAL_FACTORY_OUT_ID
       , Nvl(PAC_THIRD_ACI_ID, -2) PAC_THIRD_ACI_ID
       , Nvl(PAC_THIRD_DELIVERY_ID, -2) PAC_THIRD_DELIVERY_ID
       , Nvl(PAC_THIRD_TARIFF_ID, -2) PAC_THIRD_TARIFF_ID
       , Nvl(ASA_INTERVENTION_DETAIL_ID, -2) ASA_INTERVENTION_DETAIL_ID
       , SMO_PRCS_VALUE
  from STM_STOCK_MOVEMENT
  union all
  select -1 STM_STOCK_MOVEMENT_ID
       , -1 STM_STM_STOCK_MOVEMENT_ID
       , -1 STM2_STM_STOCK_MOVEMENT_ID
       , -1 STM_EXERCISE_ID
       , -1 STM_PERIOD_ID
       , -1 STM_MOVEMENT_KIND_ID
       , -1 STM_STOCK_ID
       , -1 STM_LOCATION_ID
       , -1 PAC_THIRD_ID
       , -1 GCO_GOOD_ID
       , -1 ACS_ACCOUNT_ID
       , -1 GCO_CHARACTERIZATION_ID
       , -1 GCO_GCO_CHARACTERIZATION_ID
       , -1 GCO2_GCO_CHARACTERIZATION_ID
       , -1 GCO3_GCO_CHARACTERIZATION_ID
       , -1 GCO4_GCO_CHARACTERIZATION_ID
       , -1 DOC_RECORD_ID
       , to_date('00010101', 'YYYYMMDD') SMO_MOVEMENT_DATE
       , 'N/A' SMO_WORDING
       , 'N/A' SMO_EXTERNAL_DOCUMENT
       , 'N/A' SMO_EXTERNAL_PARTNER
       , 'N/A' SMO_CHARACTERIZATION_VALUE_1
       , 'N/A' SMO_CHARACTERIZATION_VALUE_2
       , 'N/A' SMO_CHARACTERIZATION_VALUE_3
       , 'N/A' SMO_CHARACTERIZATION_VALUE_4
       , 'N/A' SMO_CHARACTERIZATION_VALUE_5
       , null SMO_MOVEMENT_QUANTITY
       , null SMO_MOVEMENT_PRICE
       , null SMO_DOCUMENT_QUANTITY
       , null SMO_DOCUMENT_PRICE
       , null SMO_UNIT_PRICE
       , '-1' SMO_FINANCIAL_CHARGING
       , -1 ACS_FINANCIAL_ACCOUNT_ID
       , -1 ACS_DIVISION_ACCOUNT_ID
       , -1 ACS_ACS_DIVISION_ACCOUNT_ID
       , -1 ACS_ACS_FINANCIAL_ACCOUNT_ID
       , -1 DOC_POSITION_DETAIL_ID
       , null SMO_MVT_ALTERNATIV_QTY_1
       , null SMO_MVT_ALTERNATIV_QTY_2
       , null SMO_MVT_ALTERNATIV_QTY_3
       , null SMO_REFERENCE_UNIT_PRICE
       , -1 ACS_CPN_ACCOUNT_ID
       , -1 ACS_ACS_CPN_ACCOUNT_ID
       , -1 ACS_CDA_ACCOUNT_ID
       , -1 ACS_ACS_CDA_ACCOUNT_ID
       , -1 ACS_PF_ACCOUNT_ID
       , -1 ACS_ACS_PF_ACCOUNT_ID
       , -1 ACS_PJ_ACCOUNT_ID
       , -1 ACS_ACS_PJ_ACCOUNT_ID
       , -1 DOC_POSITION_ID
       , '-1' SMO_UPDATE_PROV
       , '-1' SMO_EXTOURNE_MVT
       , -1 FAM_FIXED_ASSETS_ID
       , -1 HRM_PERSON_ID
       , 'DWH_NA' C_FAM_TRANSACTION_TYP
       , 'DWH_NA' DIC_IMP_FREE1_ID
       , 'DWH_NA' DIC_IMP_FREE2_ID
       , 'DWH_NA' DIC_IMP_FREE3_ID
       , 'DWH_NA' DIC_IMP_FREE4_ID
       , 'DWH_NA' DIC_IMP_FREE5_ID
       , 'N/A' SMO_IMP_TEXT_1
       , 'N/A' SMO_IMP_TEXT_2
       , 'N/A' SMO_IMP_TEXT_3
       , 'N/A' SMO_IMP_TEXT_4
       , 'N/A' SMO_IMP_TEXT_5
       , null SMO_IMP_NUMBER_1
       , null SMO_IMP_NUMBER_2
       , null SMO_IMP_NUMBER_3
       , null SMO_IMP_NUMBER_4
       , null SMO_IMP_NUMBER_5
       , '-1' SMO_UPDATE_PRCS
       , null SMO_PRCS_BEFORE
       , null SMO_PRCS_AFTER
       , 'N/A' SMO_PIECE
       , 'N/A' SMO_SET
       , 'N/A' SMO_VERSION
       , 'N/A' SMO_CHRONOLOGICAL
       , 'N/A' SMO_STD_CHAR_1
       , 'N/A' SMO_STD_CHAR_2
       , 'N/A' SMO_STD_CHAR_3
       , 'N/A' SMO_STD_CHAR_4
       , 'N/A' SMO_STD_CHAR_5
       , null SMO_FINANCIAL_PRICE
       , null SMO_PRCS_ADDED_QUANTITY_BEFORE
       , null SMO_PRCS_ADDED_QUANTITY_AFTER
       , null SMO_PRCS_ADDED_VALUE_BEFORE
       , null SMO_PRCS_ADDED_VALUE_AFTER
       , -1 STM_DISTRIBUTION_UNIT_ID
       , -1 STM_STM_DISTRIBUTION_UNIT_ID
       , '-1' SMO_USE_RESTOCKING
       , to_date('00010101', 'YYYYMMDD') SMO_VALUE_DATE
       , null SMO_MOVEMENT_ORDER_KEY
       , '-1' SMO_PRCS_UPDATED
       , -1 DOC_FOOT_ALLOY_ID
       , '-1' SMO_STOCK_MANAGEMENT
       , -1 FAL_LOT_ID
       , -1 FAL_FACTORY_IN_ID
       , -1 FAL_FACTORY_OUT_ID
       , -1 PAC_THIRD_ACI_ID
       , -1 PAC_THIRD_DELIVERY_ID
       , -1 PAC_THIRD_TARIFF_ID
       , -1 ASA_INTERVENTION_DETAIL_ID
       , null SMO_PRCS_VALUE
  from dual
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_CASH_MOVEMENT" ("IMF_TRANSACTION_DATE", "CURRENCY", "IMF_DESCRIPTION", "LOCAL", "BASE", "FOREIGN", "PER_SHORT_NAME", "PER_KEY1") AS
  select
imf_transaction_date,
currency,
imf_description,
DECODE(imp.acs_financial_currency_id,acs_function.GETLOCALCURRENCYID,(imf_amount_lc_d-imf_amount_lc_c)*-1,0) LOCAL,
(imf_amount_lc_d-imf_amount_lc_c)*-1 BASE,
(imf_amount_fc_d-imf_amount_fc_c)*-1 FOREIGN,
per_short_name,
per_key1
from
act_financial_imputation imp,
act_document doc,
acs_financial_currency cur,
pcs.pc_curr curr,
pac_person pac,
acj_catalogue_document acj
where
acj.C_TYPE_CATALOGUE in (3,4) and
doc.ACJ_CATALOGUE_DOCUMENT_ID=acj.ACJ_CATALOGUE_DOCUMENT_ID and
doc.ACT_DOCUMENT_ID=imp.ACT_DOCUMENT_ID and
imf_primary=0 and
doc.acs_financial_currency_id=cur.ACS_FINANCIAL_CURRENCY_ID and
cur.PC_CURR_ID=curr.PC_CURR_ID and
imp.act_part_imputation_id is not null and
pac.pac_person_id=nvl(imp.imf_pac_custom_partner_id,imp.imf_pac_supplier_partner_id)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_COM" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY ) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '15') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_CONSIG" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE ( POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY ) )  POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '20' OR
     DGS.C_GAUGE_TITLE = '21') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_CONSIG_OPEN" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE ( POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '20') AND
     DOC.C_DOCUMENT_STATUS<'04' AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_DELIVERY" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '7') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_DELIVERY_OPEN" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '7') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_COM" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY ) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B)  POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '15') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_CONSIG" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B)  POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '20' OR
     DGS.C_GAUGE_TITLE = '21') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_CONSI_OPEN" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE ( POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '20') AND
     DOC.C_DOCUMENT_STATUS<'04' AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_DELIVERY" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '7') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_DELIV_OPEN" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '7') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_OFFER" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '12') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_ORDER" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     ( DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '6') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_ORDER_OPEN" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     ( DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B)  POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '6') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_OTHER" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "PER_NAME", "PER_KEY1", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY ) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '10') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_GOOD_TURNOVER" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE", "COUNTRY", "PRCS") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_FINAL_QUANTITY * -1),'8',POS_FINAL_QUANTITY,'30',POS_FINAL_QUANTITY,0 ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL * -1),'8',POS_NET_VALUE_EXCL,'30',POS_NET_VALUE_EXCL,0) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL_B * -1),'8',POS_NET_VALUE_EXCL_B,'30',POS_NET_VALUE_EXCL_B,0) ) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE,
     PC_CNTRY.CNTNAME,
     GCD.GOO_BASE_COST_PRICE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO,
     GCO_GOOD_CALC_DATA GCD,
     PCS.PC_CNTRY
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '8' OR
     DGS.C_GAUGE_TITLE = '9' OR
     DGS.C_GAUGE_TITLE = '30' ) AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     GOO.GCO_GOOD_ID = POS.GCO_GOOD_ID AND
     GCD.GCO_GOOD_ID = GOO.GCO_GOOD_ID AND
     DOC.PC_CNTRY_ID=PC_CNTRY.PC_CNTRY_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_OFFER" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '12') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_ORDER" ("DATE_OF_DOCUMENT", "DATE_OF_POSITION", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE", "PDE_FINAL_QUANTITY") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (POSDET.PDE_FINAL_DELAY,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     POS_FINAL_QUANTITY,
     POS_NET_VALUE_EXCL,
     POS_NET_VALUE_EXCL_B,
     POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE,
     PDE_FINAL_QUANTITY
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION_DETAIL POSDET
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '6') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     POS.DOC_POSITION_ID = POSDET.DOC_POSITION_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_ORDER_OPEN" ("DMT_DATE_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY ) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '6') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_OTHER" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY ) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '10') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_PRTF_CUST" ("DATE_OF_DOCUMENT", "SAE_YEAR", "SAE_MONTH", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "PER_KEY1", "PER_NAME", "RCO_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYY') SAE_YEAR,
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'MM') SAE_MONTH,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PER_KEY1,
     PER_NAME,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_FINAL_QUANTITY * -1),'8',POS_FINAL_QUANTITY,POS_FINAL_QUANTITY ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL * -1),'8',POS_NET_VALUE_EXCL,POS_NET_VALUE_EXCL) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL_B * -1),'8',POS_NET_VALUE_EXCL_B,POS_NET_VALUE_EXCL_B) ) POS_NET_VALUE_EXCL_MB,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_BALANCE_QUANTITY * -1),'8',POS_BALANCE_QUANTITY,POS_BALANCE_QUANTITY ) ) POS_BALANCE_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE * -1),'8',POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE,POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) ) POS_NET_VALUE_BALANCE,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY * -1) ),'8',DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ),DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ) ) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     DOC_DOCUMENT DOC,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_PRTF_GOOD" ("DATE_OF_DOCUMENT", "SAE_YEAR", "SAE_MONTH", "PER_KEY1", "PER_NAME", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "GOO_MAJOR_REFERENCE", "RCO_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYY') SAE_YEAR,
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'MM') SAE_MONTH,
     PER_KEY1,
     PER_NAME,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_FINAL_QUANTITY * -1),'8',POS_FINAL_QUANTITY,POS_FINAL_QUANTITY ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL * -1),'8',POS_NET_VALUE_EXCL,POS_NET_VALUE_EXCL) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL_B * -1),'8',POS_NET_VALUE_EXCL_B,POS_NET_VALUE_EXCL_B) ) POS_NET_VALUE_EXCL_MB,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_BALANCE_QUANTITY * -1),'8',POS_BALANCE_QUANTITY,POS_BALANCE_QUANTITY ) ) POS_BALANCE_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE * -1),'8',POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE,POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) ) POS_NET_VALUE_BALANCE,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY * -1) ),'8',DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ),DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ) ) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_DOCUMENT DOC,
     DOC_RECORD DRE,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     POS.DOC_RECORD_ID = DRE.DOC_RECORD_ID  (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_PRTF_RECORD" ("DATE_OF_DOCUMENT", "SAE_YEAR", "SAE_MONTH", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "PER_KEY1", "PER_NAME", "RCO_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYY') SAE_YEAR,
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'MM') SAE_MONTH,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PER_KEY1,
     PER_NAME,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_FINAL_QUANTITY * -1),'8',POS_FINAL_QUANTITY,POS_FINAL_QUANTITY ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL * -1),'8',POS_NET_VALUE_EXCL,POS_NET_VALUE_EXCL) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL_B * -1),'8',POS_NET_VALUE_EXCL_B,POS_NET_VALUE_EXCL_B) ) POS_NET_VALUE_EXCL_MB,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_BALANCE_QUANTITY * -1),'8',POS_BALANCE_QUANTITY,POS_BALANCE_QUANTITY ) ) POS_BALANCE_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE * -1),'8',POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE,POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) ) POS_NET_VALUE_BALANCE,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY * -1) ),'8',DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ),DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ) ) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     GCO_GOOD GOO,
     DOC_DOCUMENT DOC,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_POSITION POS,
     DOC_RECORD DRE
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     POS.DOC_RECORD_ID = DRE.DOC_RECORD_ID   AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_CUST_TURNOVER" ("DATE_OF_DOCUMENT", "RCO_TITLE", "PER_NAME", "PER_KEY1", "GOO_MAJOR_REFERENCE", "DMT_NUMBER", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER", "STATISTIC_1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_ID,
     PAC.DIC_STATISTIC_1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_FINAL_QUANTITY * -1),'8',POS_FINAL_QUANTITY,'30',POS_FINAL_QUANTITY,0 ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL * -1),'8',POS_NET_VALUE_EXCL,'30',POS_NET_VALUE_EXCL,0) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'9',(POS_NET_VALUE_EXCL_B * -1),'8',POS_NET_VALUE_EXCL_B,'30',POS_NET_VALUE_EXCL_B,0) ) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_CUSTOM_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     PCS.PC_CNTRY CNTRY
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '8' OR
     DGS.C_GAUGE_TITLE = '9' OR
     DGS.C_GAUGE_TITLE = '30' ) AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_CUSTOM_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+) AND
     DOC.PC_CNTRY_ID = CNTRY.PC_CNTRY_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_DOC_SUPPLY_PRTF_GOOD" ("DATE_OF_DOCUMENT", "SAE_YEAR", "SAE_MONTH", "KEY1", "NAME", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "REFERENCE", "TITLE_OF_RECORD", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYY'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'MM'),
     PER_KEY1,
     PER_NAME,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_FINAL_QUANTITY * -1),POS_FINAL_QUANTITY ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_NET_VALUE_EXCL * -1),POS_NET_VALUE_EXCL) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_NET_VALUE_EXCL_B * -1),POS_NET_VALUE_EXCL_B) )  POS_NET_VALUE_EXCL_MB,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_BALANCE_QUANTITY * -1),POS_BALANCE_QUANTITY ) ) POS_BALANCE_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_BALANCE_QUANTITY *POS_NET_UNIT_VALUE * -1),POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) ) POS_NET_VALUE_BALANCE,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY * -1) ),DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ) ) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_DOCUMENT DOC,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     POS.DOC_RECORD_ID = DRE.DOC_RECORD_ID  (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_DOC_SUPPLY_PRTF_RCO" ("DATE_OF_DOCUMENT", "SAE_YEAR", "SAE_MONTH", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "KEY1", "NAME", "TITLE_OF_RECORD", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYY') SAE_YEAR,
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'MM') SAE_MONTH,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PER_KEY1,
     PER_NAME,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_FINAL_QUANTITY * -1),POS_FINAL_QUANTITY ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_NET_VALUE_EXCL * -1),POS_NET_VALUE_EXCL) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_NET_VALUE_EXCL_B * -1),POS_NET_VALUE_EXCL_B) )  POS_NET_VALUE_EXCL_MB,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_BALANCE_QUANTITY * -1),POS_BALANCE_QUANTITY ) ) POS_BALANCE_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_BALANCE_QUANTITY *POS_NET_UNIT_VALUE * -1),POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) ) POS_NET_VALUE_BALANCE,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY * -1) ),DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ) ) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     DOC_DOCUMENT DOC,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_DELIVERY" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '2'  OR
     DGS.C_GAUGE_TITLE = '3') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_DELIVERY_OPEN" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '2'  OR
     DGS.C_GAUGE_TITLE = '3') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_GOOD_DELIVERY" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '2' OR
     DGS.C_GAUGE_TITLE = '3') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_GOOD_INVOICE" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '4') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_GOOD_OFFER" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '11') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_GOOD_ORDER" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '1') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_GOOD_OTHER" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '10') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_GOOD_RETURN" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '5') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_INVOICE" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '4') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_OFFER" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '11') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_ORDER" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '1') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_ORDER_OPEN" ("DATE_OF_LIVRAISON", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '1') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_OTHER" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '10') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_PRTF_SUPPLY" ("DATE_OF_DOCUMENT", "SAE_YEAR", "SAE_MONTH", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "KEY1", "NAME", "TITLE_OF_RECORD", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYY') SAE_YEAR,
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'MM') SAE_MONTH,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PER_KEY1,
     PER_NAME,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_FINAL_QUANTITY * -1),POS_FINAL_QUANTITY ) ) POS_FINAL_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_NET_VALUE_EXCL * -1),POS_NET_VALUE_EXCL) ) POS_NET_VALUE_EXCL,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_NET_VALUE_EXCL_B * -1),POS_NET_VALUE_EXCL_B) )  POS_NET_VALUE_EXCL_MB,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_BALANCE_QUANTITY * -1),POS_BALANCE_QUANTITY ) ) POS_BALANCE_QUANTITY,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(POS_BALANCE_QUANTITY *POS_NET_UNIT_VALUE * -1),POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) ) POS_NET_VALUE_BALANCE,
     (DECODE (DGS.C_GAUGE_TITLE,'5',(DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY * -1) ),DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY ) ) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     DOC_DOCUMENT DOC,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_RETURN" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '5') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_FINAL_QUANTITY <> 0 OR
     POS.POS_NET_VALUE_EXCL <> 0) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPLY_RETURN_OPEN" ("DATE_OF_DOCUMENT", "TITLE_OF_RECORD", "NAME", "KEY1", "REFERENCE", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_POSITION POS,
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     GCO_GOOD GOO,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '5') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPL_GOO_DELIV_OPEN" ("DATE_OF_DOCUMENT", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B / POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B)  POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '2'  OR
     DGS.C_GAUGE_TITLE = '3') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPL_GOO_ORDER_OPEN" ("DATE_OF_LIVRAISON", "REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY*POS_BALANCE_QUANTITY) ) POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B) POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '1') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_EIS_DOC_SUPPL_GOO_RETUR_OPE" ("DATE_OF_DOCUMENT", "GOO_MAJOR_REFERENCE", "TITLE_OF_RECORD", "NAME", "KEY1", "NUMBER_OF_DOCUMENT", "POS_NUMBER", "C_GAUGE_TITLE", "C_DOCUMENT_STATUS", "THIRD_ACTIVITY", "THIRD_AREA", "TYPE_PARTNER_F", "STATISTIC_F1", "GOOD_LINE", "GOOD_FAMILY", "GOOD_GROUP", "GOOD_MODEL", "POS_BALANCE_QUANTITY", "POS_NET_VALUE_BALANCE", "POS_NET_VALUE_BALANCE_MB", "POS_FINAL_QUANTITY", "POS_NET_VALUE_EXCL", "POS_NET_VALUE_EXCL_MB", "POS_NET_UNIT_VALUE") AS
  SELECT
     TO_CHAR (DOC.DMT_DATE_DOCUMENT,'YYYYMMDD'),
     NVL (GOO.GOO_MAJOR_REFERENCE,' ') GOO_MAJOR_REFERENCE,
     NVL (RCO_TITLE,' ') RCO_TITLE,
     PER_NAME,
     PER_KEY1,
     DMT_NUMBER,
     POS_NUMBER,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_GAUGE_TITLE',DGS.C_GAUGE_TITLE) C_GAUGE_TITLE,
     PCS.PC_FUNCTIONS.GETDESCODEDESCR ('C_DOCUMENT_STATUS',DOC.C_DOCUMENT_STATUS) C_DOCUMENT_STATUS,
     THI.DIC_THIRD_ACTIVITY_ID,
     THI.DIC_THIRD_AREA_ID,
     PAC.DIC_TYPE_PARTNER_F_ID,
     PAC.DIC_STATISTIC_F1_ID,
     NVL (GOO.DIC_GOOD_LINE_ID,' ') DIC_GOOD_LINE_ID,
     NVL (GOO.DIC_GOOD_FAMILY_ID,' ') DIC_GOOD_FAMILY_ID,
     NVL (GOO.DIC_GOOD_GROUP_ID,' ') DIC_GOOD_GROUP_ID,
     NVL (GOO.DIC_GOOD_MODEL_ID,' ') DIC_GOOD_MODEL_ID,
     (POS_BALANCE_QUANTITY) POS_BALANCE_QUANTITY,
     (POS_BALANCE_QUANTITY * POS_NET_UNIT_VALUE) POS_NET_VALUE_BALANCE,
     (DECODE (POS_FINAL_QUANTITY,0,0,POS_NET_VALUE_EXCL_B/POS_FINAL_QUANTITY * POS_BALANCE_QUANTITY) )  POS_NET_VALUE_BALANCE_MB,
     (POS_FINAL_QUANTITY) POS_FINAL_QUANTITY,
     (POS_NET_VALUE_EXCL) POS_NET_VALUE_EXCL,
     (POS_NET_VALUE_EXCL_B)  POS_NET_VALUE_EXCL_MB,
     POS_NET_UNIT_VALUE
 FROM
     DOC_GAUGE_STRUCTURED DGS,
     DOC_RECORD DRE,
     PAC_SUPPLIER_PARTNER PAC,
     PAC_THIRD THI,
     PAC_PERSON PER,
     DOC_DOCUMENT DOC,
     DOC_POSITION POS,
     GCO_GOOD GOO
 WHERE
     DOC.DOC_GAUGE_ID=DGS.DOC_GAUGE_ID AND
     (DGS.C_GAUGE_TITLE = '5') AND
     (DOC.C_DOCUMENT_STATUS<'04') AND
     DOC.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)  AND
     DOC.DOC_DOCUMENT_ID = POS.DOC_DOCUMENT_ID AND
     ( POS.POS_BALANCE_QUANTITY <> 0 ) AND
     POS.C_DOC_POS_STATUS <> '05' AND
     (POS.C_GAUGE_TYPE_POS='1' OR
     POS.C_GAUGE_TYPE_POS='5' OR
     POS.C_GAUGE_TYPE_POS='7' OR
     POS.C_GAUGE_TYPE_POS='8' OR
     POS.C_GAUGE_TYPE_POS='91' OR
     POS.C_GAUGE_TYPE_POS='10') AND
     PER.PAC_PERSON_ID = DOC.PAC_THIRD_ID AND
     PER.PAC_PERSON_ID=THI.PAC_THIRD_ID AND
     THI.PAC_THIRD_ID=PAC.PAC_SUPPLIER_PARTNER_ID AND
     POS.GCO_GOOD_ID = GOO.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_CASCADE" ("NEED_ID_IN", "FLN_QTY", "STM_STOCK_POSITION_ID", "DESCRIPTION", "GOO_MAJOR_REFERENCE", "GCO_GOOD_ID", "GOO_NUMBER_OF_DECIMAL", "SOURCE", "NEED_ID_OUT", "TOTAL_QTY", "END_DELAY") AS
  SELECT
LINK.FAL_NETWORK_NEED_ID,
LINK.FLN_QTY,
LINK.STM_STOCK_POSITION_ID,
SUPP.FAN_DESCRIPTION,
DECODE(GCO1.GCO_GOOD_ID,NULL,DECODE(GCO2.GCO_GOOD_ID,NULL,DECODE(GCO3.GCO_GOOD_ID,NULL,'None',GCO3.GOO_MAJOR_REFERENCE),GCO2.GOO_MAJOR_REFERENCE) ,GCO1.GOO_MAJOR_REFERENCE),
decode(GCO1.GCO_GOOD_ID,null,decode(GCO2.GCO_GOOD_ID,null,decode(GCO3.GCO_GOOD_ID,null,0,GCO3.GCO_GOOD_ID),GCO2.GCO_GOOD_ID),GCO1.GCO_GOOD_ID),
decode(GCO1.GCO_GOOD_ID,null,decode(GCO2.GCO_GOOD_ID,null,decode(GCO3.GCO_GOOD_ID,null,0,GCO3.GOO_NUMBER_OF_DECIMAL),GCO2.GOO_NUMBER_OF_DECIMAL),GCO1.GOO_NUMBER_OF_DECIMAL),
DECODE(LOT.FAL_LOT_ID,NULL,DECODE(PRL.FAL_LOT_PROP_ID,NULL,DECODE(PRD.FAL_DOC_PROP_ID,NULL,'FIN','PROP DOC'),'PROP LOT'),'LOT'),
DECODE(NE_LOT.FAL_NETWORK_NEED_ID,NULL,DECODE(NE_PRL.FAL_NETWORK_NEED_ID,NULL,DECODE(NE_PRD.FAL_NETWORK_NEED_ID,NULL,0,NE_PRD.FAL_NETWORK_NEED_ID),NE_PRL.FAL_NETWORK_NEED_ID),NE_LOT.FAL_NETWORK_NEED_ID),
DECODE(LOT.FAL_LOT_ID,NULL,DECODE(PRL.FAL_LOT_PROP_ID,NULL,DECODE(PRD.FAL_DOC_PROP_ID,NULL,0,PRD.FDP_FINAL_QTY),PRL.LOT_TOTAL_QTY),LOT.LOT_TOTAL_QTY),
DECODE(LOT.FAL_LOT_ID,NULL,DECODE(PRL.FAL_LOT_PROP_ID,NULL,DECODE(PRD.FAL_DOC_PROP_ID,NULL,'FIN',PRD.FDP_FINAL_DELAY),PRL.LOT_PLAN_END_DTE),LOT.LOT_PLAN_END_DTE)
from
FAL_NETWORK_LINK LINK,
FAL_NETWORK_SUPPLY SUPP,
FAL_LOT LOT,
FAL_DOC_PROP PRD,
FAL_LOT_PROP PRL,
FAL_NETWORK_NEED NE_LOT,
FAL_NETWORK_NEED NE_PRD,
FAL_NETWORK_NEED NE_PRL,
GCO_GOOD GCO1,
GCO_GOOD GCO2,
GCO_GOOD GCO3
WHERE
LINK.FAL_NETWORK_SUPPLY_ID=SUPP.FAL_NETWORK_SUPPLY_ID (+) AND
SUPP.FAL_LOT_ID=LOT.FAL_LOT_ID (+) and
SUPP.FAL_DOC_PROP_ID=PRD.FAL_DOC_PROP_ID (+) and
SUPP.FAL_LOT_PROP_ID=PRL.FAL_LOT_PROP_ID (+) and
LOT.FAL_LOT_ID=NE_LOT.FAL_LOT_ID (+) AND
PRD.FAL_DOC_PROP_ID=NE_PRD.FAL_DOC_PROP_ID (+) AND
PRL.FAL_LOT_PROP_ID=NE_PRL.FAL_LOT_PROP_ID (+) AND
NE_LOT.GCO_GOOD_ID=GCO1.GCO_GOOD_ID (+) AND
NE_PRD.GCO_GOOD_ID=GCO2.GCO_GOOD_ID (+) AND
NE_PRL.GCO_GOOD_ID=GCO3.GCO_GOOD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_CTRL_FAL_LOT" ("FAL_LOT_ID", "LOT_OPEN__DTE", "GCO_GOOD_ID", "LOT_RELEASED_QTY", "LOT_REJECT_RELEASED_QTY", "LOT_DISMOUNTED_QTY", "LOT_REJECT_PLAN_QTY", "FAL_JOB_PROGRAM_ID", "LOT_REFCOMPL") AS
  (SELECT
     LOT1.FAL_LOT_ID,
     LOT1.LOT_OPEN__DTE,
     LOT1.GCO_GOOD_ID,
     LOT1.LOT_RELEASED_QTY,
     LOT1.LOT_REJECT_RELEASED_QTY,
     LOT1.LOT_DISMOUNTED_QTY,
     LOT1.LOT_REJECT_PLAN_QTY,
		 LOT1.FAL_JOB_PROGRAM_ID,
		 LOT1.LOT_REFCOMPL
   FROM
     FAL_LOT LOT1
   WHERE
     LOT1.C_LOT_STATUS = '5')
   UNION ALL
   (SELECT
     LOTHIST.FAL_LOT_HIST_ID,
     LOTHIST.LOT_OPEN__DTE,
     LOTHIST.GCO_GOOD_ID,
     LOTHIST.LOT_RELEASED_QTY,
     LOTHIST.LOT_REJECT_RELEASED_QTY,
     LOTHIST.LOT_DISMOUNTED_QTY,
     LOTHIST.LOT_REJECT_PLAN_QTY,
		 LOTHIST.FAL_JOB_PROGRAM_HIST_ID,
		 LOTHIST.LOT_REFCOMPL
   FROM
     FAL_LOT_HIST LOTHIST
   WHERE
     LOTHIST.C_LOT_STATUS = '6')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_CTRL_FLOOR_OCCUP" ("DATE_DEBUT", "FAC_REFERENCE", "FAL_FACTORY_FLOOR_ID", "NB_REAL_HOUR") AS
  (SELECT
     FLP.FLP_DATE1,
     FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID ,
     SUM(FLP.FLP_ADJUSTING_TIME + FLP.FLP_WORK_TIME) SOMME
   FROM
     FAL_LOT_PROGRESS FLP,
     FAL_FACTORY_FLOOR FAC
   WHERE
     FLP.FAL_FACTORY_FLOOR_ID IS NOT NULL AND
     FLP.FLP_DATE1 IS NOT NULL AND
     FLP.FAL_FACTORY_FLOOR_ID = FAC.FAL_FACTORY_FLOOR_ID AND
		 FLP.FAL_LOT_PROGRESS_ID > 0
   GROUP BY
     FLP.FLP_DATE1,
		 FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID
   UNION ALL
   SELECT
     TAL.TAL_BEGIN_REAL_DATE,
     FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID,
     SUM(TAL.TAL_ACHIEVED_TSK + TAL.TAL_ACHIEVED_AD_TSK) SOMME
   FROM
     FAL_TASK_LINK TAL,
     FAL_FACTORY_FLOOR FAC
   WHERE
     (
       (TAL.C_OPERATION_TYPE='2' AND PCS.PC_CONFIG.GETCONFIG('FAL_PROGRESS_TYPE') = '3')
       OR
       (PCS.PC_CONFIG.GETCONFIG('FAL_PROGRESS_TYPE') <> '3')
     ) AND
     TAL.FAL_FACTORY_FLOOR_ID IS NOT NULL AND
     TAL.TAL_BEGIN_REAL_DATE IS NOT NULL AND
     TAL.FAL_FACTORY_FLOOR_ID = FAC.FAL_FACTORY_FLOOR_ID AND
		 TAL.FAL_SCHEDULE_STEP_ID > 0
   GROUP BY
	   TAL.TAL_BEGIN_REAL_DATE,
     FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID
	 UNION ALL
   SELECT
     FLP.FLP_DATE1,
     FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID ,
     SUM(FLP.FLP_ADJUSTING_TIME + FLP.FLP_WORK_TIME) SOMME
   FROM
     FAL_LOT_PROGRESS_HIST FLP,
     FAL_FACTORY_FLOOR FAC
   WHERE
     FLP.FAL_FACTORY_FLOOR_ID IS NOT NULL AND
     FLP.FLP_DATE1 IS NOT NULL AND
     FLP.FAL_FACTORY_FLOOR_ID = FAC.FAL_FACTORY_FLOOR_ID AND
		 FLP.FAL_LOT_PROGRESS_HIST_ID > 0
   GROUP BY
     FLP.FLP_DATE1,
		 FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID
	 UNION ALL
   SELECT
     TAL.TAL_BEGIN_REAL_DATE,
     FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID,
     SUM(TAL.TAL_ACHIEVED_TSK + TAL.TAL_ACHIEVED_AD_TSK) SOMME
   FROM
     FAL_TASK_LINK_HIST TAL,
     FAL_FACTORY_FLOOR FAC
   WHERE
     (
       (TAL.C_OPERATION_TYPE='2' AND PCS.PC_CONFIG.GETCONFIG('FAL_PROGRESS_TYPE') = '3')
       OR
       (PCS.PC_CONFIG.GETCONFIG('FAL_PROGRESS_TYPE') <> '3')
     ) AND
     TAL.FAL_FACTORY_FLOOR_ID IS NOT NULL AND
     TAL.TAL_BEGIN_REAL_DATE IS NOT NULL AND
     TAL.FAL_FACTORY_FLOOR_ID = FAC.FAL_FACTORY_FLOOR_ID AND
		 TAL.FAL_SCHEDULE_STEP_ID > 0
   GROUP BY
	   TAL.TAL_BEGIN_REAL_DATE,
     FAC.FAC_REFERENCE,
     FAC.FAL_FACTORY_FLOOR_ID
	)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_DETAIL_POSITION_TO_LINK" ("DMT_NUMBER", "PER_NAME", "PER_KEY1", "DOC_POSITION_DETAIL_ID", "REF_ART", "ART_ID", "DIG", "DELAI", "QTE", "SOLDE", "DEC1", "REF_ART_1", "ART_ID_1", "DIG_1", "QTE_1", "QTN_1", "STK_1", "DEC2", "REF_ART_2", "ART_ID_2", "DIG_2", "QTE_2", "QTN_2", "STK_2", "DEC3", "REF_ART_3", "ART_ID_3", "DIG_3", "QTE_3", "QTN_3", "STK_3", "DEC4", "REF_ART_4", "ART_ID_4", "DIG_4", "QTE_4", "QTN_4", "STK_4", "DEC5", "REF_ART_5", "ART_ID_5", "DIG_5", "QTE_5", "QTN_5", "STK_5", "DEC6", "REF_ART_6", "ART_ID_6", "DIG_6", "QTE_6", "QTN_6", "STK_6") AS
  SELECT
	DOC.DMT_NUMBER,PER.PER_NAME,PER.PER_KEY1,DET.DOC_POSITION_DETAIL_ID,
	GCO.GOO_MAJOR_REFERENCE REF_ART,GCO.GCO_GOOD_ID,GCO.GOO_NUMBER_OF_DECIMAL DIG,DET.PDE_FINAL_DELAY DELAI,DET.PDE_FINAL_QUANTITY QTE, DET.PDE_BALANCE_QUANTITY SOLDE,
	SUPP1.FAN_DESCRIPTION DEC1,GCO1.GOO_MAJOR_REFERENCE REF_ART_1,GCO1.GCO_GOOD_ID,GCO1.GOO_NUMBER_OF_DECIMAL DIG_1,LOT1.LOT_TOTAL_QTY QTE_1,LINK1.FLN_QTY QTN_1,LINK1.STM_STOCK_POSITION_ID,
	SUPP2.FAN_DESCRIPTION DEC2,GCO2.GOO_MAJOR_REFERENCE REF_ART_2,GCO2.GCO_GOOD_ID,GCO2.GOO_NUMBER_OF_DECIMAL DIG_2,LOT2.LOT_TOTAL_QTY QTE_2,LINK2.FLN_QTY QTN_2,LINK2.STM_STOCK_POSITION_ID,
	SUPP3.FAN_DESCRIPTION DEC3,GCO3.GOO_MAJOR_REFERENCE REF_ART_3,GCO3.GCO_GOOD_ID,GCO3.GOO_NUMBER_OF_DECIMAL DIG_3,LOT3.LOT_TOTAL_QTY QTE_3,LINK3.FLN_QTY QTN_3,LINK3.STM_STOCK_POSITION_ID,
	SUPP4.FAN_DESCRIPTION DEC4,GCO4.GOO_MAJOR_REFERENCE REF_ART_4,GCO4.GCO_GOOD_ID,GCO4.GOO_NUMBER_OF_DECIMAL DIG_4,LOT4.LOT_TOTAL_QTY QTE_4,LINK4.FLN_QTY QTN_4,LINK4.STM_STOCK_POSITION_ID,
	SUPP5.FAN_DESCRIPTION DEC5,GCO5.GOO_MAJOR_REFERENCE REF_ART_5,GCO5.GCO_GOOD_ID,GCO5.GOO_NUMBER_OF_DECIMAL DIG_5,LOT5.LOT_TOTAL_QTY QTE_5,LINK5.FLN_QTY QTN_5,LINK5.STM_STOCK_POSITION_ID,
	SUPP6.FAN_DESCRIPTION DEC6,GCO6.GOO_MAJOR_REFERENCE REF_ART_6,GCO6.GCO_GOOD_ID,GCO6.GOO_NUMBER_OF_DECIMAL DIG_6,LOT6.LOT_TOTAL_QTY QTE_6,LINK6.FLN_QTY QTN_6,LINK6.STM_STOCK_POSITION_ID
from
	DOC_DOCUMENT DOC,
	PAC_THIRD THI,
	PAC_PERSON PER,
	DOC_POSITION POS,
	DOC_POSITION_DETAIL DET,
	DOC_GAUGE_STRUCTURED GST,
	GCO_GOOD GCO,
	FAL_NETWORK_NEED NEED,
	FAL_NETWORK_LINK LINK1,
	FAL_NETWORK_SUPPLY SUPP1,
	FAL_LOT LOT1,
	FAL_NETWORK_NEED NEED1,
	GCO_GOOD GCO1,
	FAL_NETWORK_LINK LINK2,
	FAL_NETWORK_SUPPLY SUPP2,
	FAL_LOT LOT2,
	FAL_NETWORK_NEED NEED2,
	GCO_GOOD GCO2,
	FAL_NETWORK_LINK LINK3,
	FAL_NETWORK_SUPPLY SUPP3,
	FAL_LOT LOT3,
	FAL_NETWORK_NEED NEED3,
	GCO_GOOD GCO3,
	FAL_NETWORK_LINK LINK4,
	FAL_NETWORK_SUPPLY SUPP4,
	FAL_LOT LOT4,
	FAL_NETWORK_NEED NEED4,
	GCO_GOOD GCO4,
	FAL_NETWORK_LINK LINK5,
	FAL_NETWORK_SUPPLY SUPP5,
	FAL_LOT LOT5,
	FAL_NETWORK_NEED NEED5,
	GCO_GOOD GCO5,
	FAL_NETWORK_LINK LINK6,
	FAL_NETWORK_SUPPLY SUPP6,
	FAL_LOT LOT6,
	FAL_NETWORK_NEED NEED6,
	GCO_GOOD GCO6
WHERE
    DOC.DOC_DOCUMENT_ID=POS.DOC_DOCUMENT_ID AND
	POS.DOC_POSITION_ID=DET.DOC_POSITION_ID AND
	POS.GCO_GOOD_ID=GCO.GCO_GOOD_ID AND
	DOC.DOC_GAUGE_ID = GST.DOC_GAUGE_ID AND
    DOC.PAC_THIRD_ID = THI.PAC_THIRD_ID AND
	THI.PAC_THIRD_ID = PER.PAC_PERSON_ID AND
    DET.DOC_POSITION_DETAIL_ID = NEED.DOC_POSITION_DETAIL_ID (+) AND
	NEED.FAL_NETWORK_NEED_ID=LINK1.FAL_NETWORK_NEED_ID (+) AND
	LINK1.FAL_NETWORK_SUPPLY_ID=SUPP1.FAL_NETWORK_SUPPLY_ID (+) AND
 	SUPP1.FAL_LOT_ID=LOT1.FAL_LOT_ID (+) AND
	LOT1.FAL_LOT_ID= NEED1.FAL_LOT_ID (+) AND
	NEED1.GCO_GOOD_ID=GCO1.GCO_GOOD_ID (+) AND
	NEED1.FAL_NETWORK_NEED_ID=LINK2.FAL_NETWORK_NEED_ID (+) AND
	LINK2.FAL_NETWORK_SUPPLY_ID=SUPP2.FAL_NETWORK_SUPPLY_ID (+) AND
 	SUPP2.FAL_LOT_ID=LOT2.FAL_LOT_ID (+) AND
	LOT2.FAL_LOT_ID= NEED2.FAL_LOT_ID (+) AND
	NEED2.GCO_GOOD_ID=GCO2.GCO_GOOD_ID (+) AND
	NEED2.FAL_NETWORK_NEED_ID=LINK3.FAL_NETWORK_NEED_ID (+) AND
	LINK3.FAL_NETWORK_SUPPLY_ID=SUPP3.FAL_NETWORK_SUPPLY_ID (+) AND
 	SUPP3.FAL_LOT_ID=LOT3.FAL_LOT_ID (+) AND
	LOT3.FAL_LOT_ID= NEED3.FAL_LOT_ID (+) AND
	NEED3.GCO_GOOD_ID=GCO3.GCO_GOOD_ID (+) AND
	NEED3.FAL_NETWORK_NEED_ID=LINK4.FAL_NETWORK_NEED_ID (+) AND
	LINK4.FAL_NETWORK_SUPPLY_ID=SUPP4.FAL_NETWORK_SUPPLY_ID (+) AND
 	SUPP4.FAL_LOT_ID=LOT4.FAL_LOT_ID (+) AND
	LOT4.FAL_LOT_ID= NEED4.FAL_LOT_ID (+) AND
	NEED4.GCO_GOOD_ID=GCO4.GCO_GOOD_ID (+) AND
	NEED4.FAL_NETWORK_NEED_ID=LINK5.FAL_NETWORK_NEED_ID (+) AND
	LINK5.FAL_NETWORK_SUPPLY_ID=SUPP5.FAL_NETWORK_SUPPLY_ID (+) AND
 	SUPP5.FAL_LOT_ID=LOT5.FAL_LOT_ID (+) AND
	LOT5.FAL_LOT_ID= NEED5.FAL_LOT_ID (+) AND
	NEED5.GCO_GOOD_ID=GCO5.GCO_GOOD_ID (+) AND
	NEED5.FAL_NETWORK_NEED_ID=LINK6.FAL_NETWORK_NEED_ID (+) AND
	LINK6.FAL_NETWORK_SUPPLY_ID=SUPP6.FAL_NETWORK_SUPPLY_ID (+) AND
 	SUPP6.FAL_LOT_ID=LOT6.FAL_LOT_ID (+) AND
	LOT6.FAL_LOT_ID= NEED6.FAL_LOT_ID (+) AND
	NEED6.GCO_GOOD_ID=GCO6.GCO_GOOD_ID (+) AND
	GST.C_GAUGE_TITLE = '6' AND
    (DOC.C_DOCUMENT_STATUS = '03' OR DOC.C_DOCUMENT_STATUS = '02') AND
    (POS.C_GAUGE_TYPE_POS = '10' OR POS.C_GAUGE_TYPE_POS = '91' OR POS.C_GAUGE_TYPE_POS = '8' OR POS.C_GAUGE_TYPE_POS = '7' OR POS.C_GAUGE_TYPE_POS = '1')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_HIST_FABRICATION" ("JOP_SHORT_DESCR", "LOT_REFCOMPL", "LOT_FULL_REL_DTE", "LOT_OPEN__DTE", "LOT_PLAN_BEGIN_DTE", "LOT_PLAN_END_DTE", "LOT_TOTAL_QTY", "GCO_GOOD_ID", "C_LOT_STATUS", "STATUS_DESCR") AS
  (select JOP.JOP_SHORT_DESCR
        , LOT.LOT_REFCOMPL
        , LOT.LOT_FULL_REL_DTE
        , LOT.LOT_OPEN__DTE
        , LOT.LOT_PLAN_BEGIN_DTE
        , LOT.LOT_PLAN_END_DTE
        , LOT.LOT_TOTAL_QTY
        , LOT.GCO_GOOD_ID
        , LOT.C_LOT_STATUS
        , PCS.PC_FUNCTIONS.GETDESCODEDESCR('C_LOT_STATUS', LOT.C_LOT_STATUS, PCS.PC_I_LIB_SESSION.GETUSERLANGID) STATUS_DESCR
     from FAL_LOT LOT
        , FAL_ORDER ORD
        , FAL_JOB_PROGRAM JOP
    where LOT.FAL_ORDER_ID = ORD.FAL_ORDER_ID
      and ORD.FAL_JOB_PROGRAM_ID = JOP.FAL_JOB_PROGRAM_ID
      and LOT.C_FAB_TYPE <> '4' --Exclure les lots de type sous-traitance
      and LOT.FAL_LOT_ID > 0
   union all
   select JOP.JOP_SHORT_DESCR
        , LOT.LOT_REFCOMPL
        , LOT.LOT_FULL_REL_DTE
        , LOT.LOT_OPEN__DTE
        , LOT.LOT_PLAN_BEGIN_DTE
        , LOT.LOT_PLAN_END_DTE
        , LOT.LOT_TOTAL_QTY
        , LOT.GCO_GOOD_ID
        , LOT.C_LOT_STATUS
        , PCS.PC_FUNCTIONS.GETDESCODEDESCR('C_LOT_STATUS', LOT.C_LOT_STATUS, PCS.PC_I_LIB_SESSION.GETUSERLANGID) STATUS_DESCR
     from FAL_LOT_HIST LOT
        , FAL_ORDER_HIST ORD
        , FAL_JOB_PROGRAM_HIST JOP
    where LOT.FAL_ORDER_HIST_ID = ORD.FAL_ORDER_HIST_ID
      and ORD.FAL_JOB_PROGRAM_HIST_ID = JOP.FAL_JOB_PROGRAM_HIST_ID
      and LOT.FAL_LOT_HIST_ID > 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_LINK" ("DMT_NUMBER", "PER_NAME", "PER_KEY1", "DOC_POSITION_DETAIL_ID", "REF_ART", "ART_ID", "DIG", "DELAI", "QTE", "SOLDE", "DEC1", "REF_ART_1", "ART_ID_1", "DIG_1", "QTE_1", "DELAY_1", "QTN_1", "STK_1", "DEC2", "REF_ART_2", "ART_ID_2", "DIG_2", "QTE_2", "DELAY_2", "QTN_2", "STK_2", "DEC3", "REF_ART_3", "ART_ID_3", "DIG_3", "QTE_3", "DELAY_3", "QTN_3", "STK_3", "DEC4", "REF_ART_4", "ART_ID_4", "DIG_4", "QTE_4", "DELAY_4", "QTN_4", "STK_4", "DEC5", "REF_ART_5", "ART_ID_5", "DIG_5", "QTE_5", "DELAY_5", "QTN_5", "STK_5", "DEC6", "REF_ART_6", "ART_ID_6", "DIG_6", "QTE_6", "DELAY_6", "QTN_6", "STK_6") AS
  SELECT
DOC.DMT_NUMBER, PER.PER_NAME, PER.PER_KEY1, DET.DOC_POSITION_DETAIL_ID, GCO.GOO_MAJOR_REFERENCE,
GCO.GCO_GOOD_ID, GCO.GOO_NUMBER_OF_DECIMAL, DET.PDE_FINAL_DELAY, DET.PDE_FINAL_QUANTITY,DET.PDE_BALANCE_QUANTITY,

CAS_1.DESCRIPTION, CAS_1.GOO_MAJOR_REFERENCE, CAS_1.GCO_GOOD_ID, CAS_1.GOO_NUMBER_OF_DECIMAL, CAS_1.TOTAL_QTY, CAS_1.END_DELAY,CAS_1.FLN_QTY,CAS_1.STM_STOCK_POSITION_ID,
CAS_2.DESCRIPTION, CAS_2.GOO_MAJOR_REFERENCE, CAS_2.GCO_GOOD_ID, CAS_2.GOO_NUMBER_OF_DECIMAL, CAS_2.TOTAL_QTY, CAS_2.END_DELAY,CAS_2.FLN_QTY, CAS_2.STM_STOCK_POSITION_ID,
CAS_3.DESCRIPTION, CAS_3.GOO_MAJOR_REFERENCE, CAS_3.GCO_GOOD_ID, CAS_3.GOO_NUMBER_OF_DECIMAL, CAS_3.TOTAL_QTY, CAS_3.END_DELAY,CAS_3.FLN_QTY, CAS_3.STM_STOCK_POSITION_ID,
CAS_4.DESCRIPTION, CAS_4.GOO_MAJOR_REFERENCE, CAS_4.GCO_GOOD_ID, CAS_4.GOO_NUMBER_OF_DECIMAL, CAS_4.TOTAL_QTY, CAS_4.END_DELAY,CAS_4.FLN_QTY, CAS_4.STM_STOCK_POSITION_ID,
CAS_5.DESCRIPTION, CAS_5.GOO_MAJOR_REFERENCE, CAS_5.GCO_GOOD_ID, CAS_5.GOO_NUMBER_OF_DECIMAL, CAS_5.TOTAL_QTY, CAS_5.END_DELAY,CAS_5.FLN_QTY, CAS_5.STM_STOCK_POSITION_ID,
CAS_6.DESCRIPTION, CAS_6.GOO_MAJOR_REFERENCE, CAS_6.GCO_GOOD_ID, CAS_6.GOO_NUMBER_OF_DECIMAL, CAS_6.TOTAL_QTY, CAS_6.END_DELAY,CAS_6.FLN_QTY,CAS_6.STM_STOCK_POSITION_ID
from
DOC_DOCUMENT DOC,
DOC_POSITION POS,
DOC_POSITION_DETAIL DET,
PAC_THIRD THI,
PAC_PERSON PER,
DOC_GAUGE_STRUCTURED GST,
GCO_GOOD GCO,
FAL_NETWORK_NEED NEED,
V_FAL_CASCADE CAS_1,
V_FAL_CASCADE CAS_2,
V_FAL_CASCADE CAS_3,
V_FAL_CASCADE CAS_4,
V_FAL_CASCADE CAS_5,
V_FAL_CASCADE CAS_6
WHERE
DOC.DOC_DOCUMENT_ID=POS.DOC_DOCUMENT_ID AND
POS.DOC_POSITION_ID=DET.DOC_POSITION_ID AND
POS.GCO_GOOD_ID=GCO.GCO_GOOD_ID AND
DOC.DOC_GAUGE_ID = GST.DOC_GAUGE_ID AND
DET.DOC_POSITION_DETAIL_ID = NEED.DOC_POSITION_DETAIL_ID (+) AND
DOC.PAC_THIRD_ID = THI.PAC_THIRD_ID AND
THI.PAC_THIRD_ID = PER.PAC_PERSON_ID AND
NEED.FAL_NETWORK_NEED_ID=CAS_1.NEED_ID_IN (+) AND
CAS_1.NEED_ID_OUT=CAS_2.NEED_ID_IN (+) AND
CAS_2.NEED_ID_OUT=CAS_3.NEED_ID_IN (+) AND
CAS_3.NEED_ID_OUT=CAS_4.NEED_ID_IN (+) AND
CAS_4.NEED_ID_OUT=CAS_5.NEED_ID_IN (+) AND
CAS_5.NEED_ID_OUT=CAS_6.NEED_ID_IN (+) AND
GST.C_GAUGE_TITLE = '6' AND
(DOC.C_DOCUMENT_STATUS = '03' OR DOC.C_DOCUMENT_STATUS = '02') AND
(POS.C_GAUGE_TYPE_POS = '10' OR POS.C_GAUGE_TYPE_POS = '91' OR POS.C_GAUGE_TYPE_POS = '8' OR POS.C_GAUGE_TYPE_POS = '7' OR POS.C_GAUGE_TYPE_POS = '1')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_LOT_CHARACTERIZATION" ("FAL_FACTORY_IN_ID", "FAL_LOT_ID", "GCO_GOOD_ID", "STM_LOCATION_ID", "STM_STOCK_POSITION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "C_IN_ORIGINE", "IN_DATE", "IN_LOT_REFCOMPL", "IN_FULL_TRACABILITY", "IN_VERSION", "IN_LOT", "IN_PIECE", "IN_CHRONOLOGY", "IN_STD_CHAR_1", "IN_STD_CHAR_2", "IN_STD_CHAR_3", "IN_STD_CHAR_4", "IN_STD_CHAR_5", "IN_CHARACTERIZATION_VALUE_1", "IN_CHARACTERIZATION_VALUE_2", "IN_CHARACTERIZATION_VALUE_3", "IN_CHARACTERIZATION_VALUE_4", "IN_CHARACTERIZATION_VALUE_5", "IN_PRICE", "IN_IN_QTE", "IN_OUT_QTE", "IN_BALANCE", "FAL_LOT_MATERIAL_LINK_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM") AS
  select FAL_FACTORY_IN_ID
       , FAL_LOT_ID
       , GCO_GOOD_ID
       , STM_LOCATION_ID
       , STM_STOCK_POSITION_ID
       , GCO_CHARACTERIZATION_ID
       , GCO_GCO_CHARACTERIZATION_ID
       , GCO2_GCO_CHARACTERIZATION_ID
       , GCO3_GCO_CHARACTERIZATION_ID
       , GCO4_GCO_CHARACTERIZATION_ID
       , C_IN_ORIGINE
       , IN_DATE
       , IN_LOT_REFCOMPL
       , IN_FULL_TRACABILITY
       , IN_VERSION
       , IN_LOT
       , IN_PIECE
       , IN_CHRONOLOGY
       , IN_STD_CHAR_1
       , IN_STD_CHAR_2
       , IN_STD_CHAR_3
       , IN_STD_CHAR_4
       , IN_STD_CHAR_5
       , IN_CHARACTERIZATION_VALUE_1
       , IN_CHARACTERIZATION_VALUE_2
       , IN_CHARACTERIZATION_VALUE_3
       , IN_CHARACTERIZATION_VALUE_4
       , IN_CHARACTERIZATION_VALUE_5
       , IN_PRICE
       , IN_IN_QTE
       , IN_OUT_QTE
       , IN_BALANCE
       , FAL_LOT_MATERIAL_LINK_ID
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
       , A_CONFIRM
    from FAL_FACTORY_IN
   where IN_BALANCE <> 0
  union all
  select FAL_FACTORY_OUT_ID
       , FAL_LOT_ID
       , GCO_GOOD_ID
       , STM_LOCATION_ID
       , to_number(null)
       , to_number(null)
       , to_number(null)
       , to_number(null)
       , to_number(null)
       , to_number(null)
       , C_OUT_ORIGINE
       , OUT_DATE
       , OUT_LOT_REFCOMPL
       , to_number(null)
       , OUT_VERSION
       , OUT_LOT
       , OUT_PIECE
       , OUT_CHRONOLOGY
       , OUT_STD_CHAR_1
       , OUT_STD_CHAR_2
       , OUT_STD_CHAR_3
       , OUT_STD_CHAR_4
       , OUT_STD_CHAR_5
       , null
       , null
       , null
       , null
       , null
       , OUT_PRICE
       , 0
       , 0
       , OUT_QTE
       , to_number(null)
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
       , A_CONFIRM
    from FAL_FACTORY_OUT
   where C_OUT_TYPE = '1'
      or C_OUT_TYPE = '2'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_LOT_REFERENCE" ("FAL_LOT_ID", "FAL_ORDER_ID", "FAL_JOB_PROGRAM_ID", "REFERENCE_COMPLETE_DES_LOTS", "GOO_MAJOR_REFERENCE", "LOT_SHORT_DESCR", "C_LOT_STATUS", "C_FAB_TYPE", "LOT_REFCOMPL") AS
  select
FAL_LOT_ID,
FAL_ORDER.FAL_ORDER_ID,
FAL_ORDER.FAL_JOB_PROGRAM_ID,
LOT_REFCOMPL,
GOO_MAJOR_REFERENCE,
LOT_SHORT_DESCR,
C_LOT_STATUS,
FAL_LOT.C_FAB_TYPE,
LOT_REFCOMPL
FROM FAL_LOT,FAL_ORDER,GCO_GOOD
WHERE
   FAL_LOT.FAL_ORDER_ID = FAL_ORDER.FAL_ORDER_ID AND
   GCO_GOOD.GCO_GOOD_ID = FAl_LOT.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_LOT_REFERENCE2" ("FAL_LOT_ID", "LOT_REFCOMPL", "REFERENCE_COMPLETE_DES_LOTS", "LOT_SHORT_DESCR", "C_LOT_STATUS", "GCO_GOOD_ID", "C_FAB_TYPE", "GOO_MAJOR_REFERENCE", "FAL_JOB_PROGRAM_ID", "FAL_ORDER_ID") AS
  select
  FAL_LOT_ID,
  LOT_REFCOMPL,
  LOT_REFCOMPL,
  LOT_SHORT_DESCR,
  C_LOT_STATUS,
  FAl_LOT.GCO_GOOD_ID,
  FAL_LOT.C_FAB_TYPE,
  GCo_GOOD.GOO_MAJOR_REFERENCE,
  FAL_ORDER.FAL_JOB_PROGRAM_ID,
  FAL_ORDER.FAL_ORDER_ID
 FROM
  FAL_LOT, GCO_GOOD,FAL_ORDER
  WHERE GCO_GOOD.GCO_GOOD_ID = FAl_LOT.GCO_GOOD_ID
  AND FAL_LOT.FAL_ORDER_ID = FAL_ORDER.FAL_ORDER_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_LOT_REFERENCE_ARCHIVE" ("FAL_LOT_HIST_ID", "FAL_ORDER_HIST_ID", "FAL_JOB_PROGRAM_HIST_ID", "REFERENCE_COMPLETE_DES_LOTS", "GOO_MAJOR_REFERENCE") AS
  select
FAL_LOT_HIST_ID,
FAL_ORDER_HIST.FAL_ORDER_HIST_ID,
FAL_ORDER_HIST.FAL_JOB_PROGRAM_HIST_ID,
LOT_REFCOMPL,
GOO_MAJOR_REFERENCE
FROM FAL_LOT_HIST,FAL_ORDER_HIST,FAL_JOB_PROGRAM_HIST,GCO_GOOD
WHERE
   FAL_LOT_HIST.FAL_ORDER_HIST_ID = FAL_ORDER_HIST.FAL_ORDER_HIST_ID AND
   FAL_ORDER_HIST.FAL_JOB_PROGRAM_HIST_ID = FAL_JOB_PROGRAM_HIST.FAL_JOB_PROGRAM_HIST_ID AND
   FAL_LOT_HIST.GCO_GOOD_ID = GCO_GOOD.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NEED_UNION" ("C_TYPE_NETWORK", "FAL_NETWORK_ID", "GCO_GOOD_ID", "FAN_BALANCE_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAL_LOT_ID", "FAN_DESCRIPTION", "DOC_POSITION_ID", "DIC_UNIT_OF_MEASURE_ID", "DIC_ACCOUNTABLE_GROUP_ID", "GOO_MAJOR_REFERENCE", "GOO_NUMBER_OF_DECIMAL", "FAL_LOT_PROP_ID", "FAL_DOC_PROP_ID", "STM_STOCK_ID", "STO_DESCRIPTION", "C_SUPPLY_MODE", "DOC_DOCUMENT_ID", "JOP_SHORT_DESCR", "PER_NAME", "PER_NAME_1") AS
  SELECT
  'N' C_TYPE_NETWORK,
  V_FAL_NETWORK.FAL_NETWORK_NEED_ID fal_network_id,
  V_FAL_NETWORK.GCO_GOOD_ID,
  V_FAL_NETWORK.FAN_BALANCE_QTY,
  V_FAL_NETWORK.FAN_BEG_PLAN,
  V_FAL_NETWORK.FAN_END_PLAN,
  V_FAL_NETWORK.FAL_LOT_ID,
  V_FAL_NETWORK.FAN_DESCRIPTION,
  DOC_POSITION.DOC_POSITION_ID,
  --GCO_GOOD.GCO_GOOD_ID,
  GCO_GOOD.DIC_UNIT_OF_MEASURE_ID,
  GCO_GOOD.DIC_ACCOUNTABLE_GROUP_ID,
  GCO_GOOD.GOO_MAJOR_REFERENCE,
  GCO_GOOD.GOO_NUMBER_OF_DECIMAL,
  FAL_LOT_PROP.FAL_LOT_PROP_ID,
  --FAL_LOT_PROP.GCO_GOOD_ID,
  FAL_DOC_PROP.FAL_DOC_PROP_ID,
  --FAL_LOT.FAL_LOT_ID,
  STM_STOCK.STM_STOCK_ID,
  STM_STOCK.STO_DESCRIPTION,
  GCO_PRODUCT.C_SUPPLY_MODE,
  DOC_DOCUMENT.DOC_DOCUMENT_ID,
  FAL_JOB_PROGRAM.JOP_SHORT_DESCR,
  PAC_PERSON.PER_NAME,
  PAC_PERSON_DOCUMENT.PER_NAME PER_NAME_1
FROM
  FAL_NETWORK_NEED V_FAL_NETWORK,
  GCO_GOOD,
  FAL_LOT_PROP,
  FAL_DOC_PROP,
  DOC_POSITION,
  FAL_LOT,
  STM_STOCK,
  GCO_PRODUCT,
  DOC_DOCUMENT,
  GCO_COMPL_DATA_PURCHASE,
  FAL_ORDER,
  FAL_JOB_PROGRAM,
  PAC_PERSON,
  PAC_PERSON PAC_PERSON_DOCUMENT
WHERE
  V_FAL_NETWORK.GCO_GOOD_ID=GCO_GOOD.GCO_GOOD_ID AND
  V_FAL_NETWORK.FAL_LOT_PROP_ID=FAL_LOT_PROP.FAL_LOT_PROP_ID(+) AND
  V_FAL_NETWORK.FAL_DOC_PROP_ID=FAL_DOC_PROP.FAL_DOC_PROP_ID(+) AND
  V_FAL_NETWORK.DOC_POSITION_ID=DOC_POSITION.DOC_POSITION_ID(+) AND
  V_FAL_NETWORK.FAL_LOT_ID=FAL_LOT.FAL_LOT_ID(+) AND
  V_FAL_NETWORK.STM_STOCK_ID=STM_STOCK.STM_STOCK_ID(+) AND
  GCO_GOOD.GCO_GOOD_ID=GCO_PRODUCT.GCO_GOOD_ID(+) AND
  DOC_POSITION.DOC_DOCUMENT_ID=DOC_DOCUMENT.DOC_DOCUMENT_ID(+) AND
  FAL_DOC_PROP.PAC_SUPPLIER_PARTNER_ID=GCO_COMPL_DATA_PURCHASE.PAC_SUPPLIER_PARTNER_ID(+) AND
  FAL_DOC_PROP.GCO_GOOD_ID=GCO_COMPL_DATA_PURCHASE.GCO_GOOD_ID(+) AND
  FAL_LOT.FAL_ORDER_ID=FAL_ORDER.FAL_ORDER_ID(+) AND
  FAL_ORDER.FAL_JOB_PROGRAM_ID=FAL_JOB_PROGRAM.FAL_JOB_PROGRAM_ID(+) AND
  GCO_COMPL_DATA_PURCHASE.PAC_SUPPLIER_PARTNER_ID=PAC_PERSON.PAC_PERSON_ID(+) AND
  DOC_DOCUMENT.PAC_THIRD_ID=PAC_PERSON_DOCUMENT.PAC_PERSON_ID(+) AND
  V_FAL_NETWORK.GCO_GOOD_ID >= 0
  union
  SELECT
  'S' C_TYPE_NETWORK,
  V_FAL_NETWORK.FAL_NETWORK_SUPPLY_ID fal_network_id,
  V_FAL_NETWORK.GCO_GOOD_ID,
  V_FAL_NETWORK.FAN_BALANCE_QTY,
  V_FAL_NETWORK.FAN_BEG_PLAN,
  V_FAL_NETWORK.FAN_END_PLAN,
  V_FAL_NETWORK.FAL_LOT_ID,
  V_FAL_NETWORK.FAN_DESCRIPTION,
  DOC_POSITION.DOC_POSITION_ID,
  --GCO_GOOD.GCO_GOOD_ID,
  GCO_GOOD.DIC_UNIT_OF_MEASURE_ID,
  GCO_GOOD.DIC_ACCOUNTABLE_GROUP_ID,
  GCO_GOOD.GOO_MAJOR_REFERENCE,
  GCO_GOOD.GOO_NUMBER_OF_DECIMAL,
  FAL_LOT_PROP.FAL_LOT_PROP_ID,
  --FAL_LOT_PROP.GCO_GOOD_ID,
  FAL_DOC_PROP.FAL_DOC_PROP_ID,
  --FAL_LOT.FAL_LOT_ID,
  STM_STOCK.STM_STOCK_ID,
  STM_STOCK.STO_DESCRIPTION,
  GCO_PRODUCT.C_SUPPLY_MODE,
  DOC_DOCUMENT.DOC_DOCUMENT_ID,
  FAL_JOB_PROGRAM.JOP_SHORT_DESCR,
  PAC_PERSON.PER_NAME,
  PAC_PERSON_DOCUMENT.PER_NAME PER_NAME_1
FROM
  FAL_NETWORK_SUPPLY V_FAL_NETWORK,
  GCO_GOOD,
  FAL_LOT_PROP,
  FAL_DOC_PROP,
  DOC_POSITION,
  FAL_LOT,
  STM_STOCK,
  GCO_PRODUCT,
  DOC_DOCUMENT,
  GCO_COMPL_DATA_PURCHASE,
  FAL_ORDER,
  FAL_JOB_PROGRAM,
  PAC_PERSON,
  PAC_PERSON PAC_PERSON_DOCUMENT
WHERE
  V_FAL_NETWORK.GCO_GOOD_ID=GCO_GOOD.GCO_GOOD_ID AND
  V_FAL_NETWORK.FAL_LOT_PROP_ID=FAL_LOT_PROP.FAL_LOT_PROP_ID(+) AND
  V_FAL_NETWORK.FAL_DOC_PROP_ID=FAL_DOC_PROP.FAL_DOC_PROP_ID(+) AND
  V_FAL_NETWORK.DOC_POSITION_ID=DOC_POSITION.DOC_POSITION_ID(+) AND
  V_FAL_NETWORK.FAL_LOT_ID=FAL_LOT.FAL_LOT_ID(+) AND
  V_FAL_NETWORK.STM_STOCK_ID=STM_STOCK.STM_STOCK_ID(+) AND
  GCO_GOOD.GCO_GOOD_ID=GCO_PRODUCT.GCO_GOOD_ID(+) AND
  DOC_POSITION.DOC_DOCUMENT_ID=DOC_DOCUMENT.DOC_DOCUMENT_ID(+) AND
  FAL_DOC_PROP.PAC_SUPPLIER_PARTNER_ID=GCO_COMPL_DATA_PURCHASE.PAC_SUPPLIER_PARTNER_ID(+) AND
  FAL_DOC_PROP.GCO_GOOD_ID=GCO_COMPL_DATA_PURCHASE.GCO_GOOD_ID(+) AND
  FAL_LOT.FAL_ORDER_ID=FAL_ORDER.FAL_ORDER_ID(+) AND
  FAL_ORDER.FAL_JOB_PROGRAM_ID=FAL_JOB_PROGRAM.FAL_JOB_PROGRAM_ID(+) AND
  GCO_COMPL_DATA_PURCHASE.PAC_SUPPLIER_PARTNER_ID=PAC_PERSON.PAC_PERSON_ID(+) AND
  DOC_DOCUMENT.PAC_THIRD_ID=PAC_PERSON_DOCUMENT.PAC_PERSON_ID(+) AND
  V_FAL_NETWORK.GCO_GOOD_ID >= 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NETWORK" ("C_TYPE_NETWORK", "FAL_NETWORK_ID", "GCO_GOOD_ID", "DOC_GAUGE_ID", "PAC_THIRD_ID", "DOC_RECORD_ID", "GCO_CHARACTERIZATION1_ID", "GCO_CHARACTERIZATION2_ID", "GCO_CHARACTERIZATION3_ID", "GCO_CHARACTERIZATION4_ID", "GCO_CHARACTERIZATION5_ID", "C_GAUGE_TITLE", "STM_STOCK_ID", "STM_LOCATION_ID", "DOC_POSITION_ID", "DOC_POSITION_DETAIL_ID", "FAN_SEQ", "FAN_PRIOR", "FAN_CHAR_VALUE1", "FAN_CHAR_VALUE2", "FAN_CHAR_VALUE3", "FAN_CHAR_VALUE4", "FAN_CHAR_VALUE5", "FAN_PREV_QTY", "FAN_SCRAP_QTY", "FAN_FULL_QTY", "FAN_EXCEED_QTY", "FAN_REALIZE_QTY", "FAN_SCRAP_REAL_QTY", "FAN_RETURN_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_BEG_PLAN1", "FAN_BEG_PLAN2", "FAN_BEG_PLAN3", "FAN_BEG_PLAN4", "FAN_END_PLAN1", "FAN_END_PLAN2", "FAN_END_PLAN3", "FAN_END_PLAN4", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAN_REAL_BEG", "FAN_REAL_END", "FAN_PLAN_PERIOD", "FAN_STK_QTY", "FAN_NETW_QTY", "FAN_FREE_QTY", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM", "FAL_LOT_ID", "FAN_NEXT", "FAL_LOT_MATERIAL_LINK_ID", "FAN_DESCRIPTION", "FAL_DOC_PROP_ID", "FAL_LOT_PROP_ID", "FAL_LOT_MAT_LINK_PROP_ID") AS
  (SELECT
'N' C_TYPE_NETWORK,
FAL_NETWORK_NEED_ID FAL_NETWORK_ID,
GCO_GOOD_ID,
DOC_GAUGE_ID,
PAC_THIRD_ID,
DOC_RECORD_ID,
GCO_CHARACTERIZATION1_ID,
GCO_CHARACTERIZATION2_ID,
GCO_CHARACTERIZATION3_ID,
GCO_CHARACTERIZATION4_ID,
GCO_CHARACTERIZATION5_ID,
C_GAUGE_TITLE,
STM_STOCK_ID,
STM_LOCATION_ID,
DOC_POSITION_ID,
DOC_POSITION_DETAIL_ID,
FAN_SEQ,
FAN_PRIOR,
FAN_CHAR_VALUE1,
FAN_CHAR_VALUE2,
FAN_CHAR_VALUE3,
FAN_CHAR_VALUE4,
FAN_CHAR_VALUE5,
FAN_PREV_QTY,
FAN_SCRAP_QTY,
FAN_FULL_QTY,
FAN_EXCEED_QTY,
FAN_REALIZE_QTY,
FAN_SCRAP_REAL_QTY,
FAN_RETURN_QTY,
FAN_DISCHARGE_QTY,
FAN_BALANCE_QTY,
FAN_BEG_PLAN1,
FAN_BEG_PLAN2,
FAN_BEG_PLAN3,
FAN_BEG_PLAN4,
FAN_END_PLAN1,
FAN_END_PLAN2,
FAN_END_PLAN3,
FAN_END_PLAN4,
FAN_BEG_PLAN,
FAN_END_PLAN,
FAN_REAL_BEG,
FAN_REAL_END,
FAN_PLAN_PERIOD,
FAN_STK_QTY,
FAN_NETW_QTY,
FAN_FREE_QTY,
A_DATECRE,
A_DATEMOD,
A_IDCRE,
A_IDMOD,
A_RECLEVEL,
A_RECSTATUS,
A_CONFIRM,
FAL_LOT_ID,
FAN_NEXT,
FAL_LOT_MATERIAL_LINK_ID,
FAN_DESCRIPTION,
FAL_DOC_PROP_ID,
FAL_LOT_PROP_ID,
FAL_LOT_MAT_LINK_PROP_ID
FROM FAL_NETWORK_NEED
UNION ALL
SELECT
'S' C_TYPE_NETWORK,
FAL_NETWORK_SUPPLY_ID FAL_NETWORK_ID,
GCO_GOOD_ID,
DOC_GAUGE_ID,
PAC_THIRD_ID,
DOC_RECORD_ID,
GCO_CHARACTERIZATION1_ID,
GCO_CHARACTERIZATION2_ID,
GCO_CHARACTERIZATION3_ID,
GCO_CHARACTERIZATION4_ID,
GCO_CHARACTERIZATION5_ID,
C_GAUGE_TITLE,
STM_STOCK_ID,
STM_LOCATION_ID,
DOC_POSITION_ID,
DOC_POSITION_DETAIL_ID,
FAN_SEQ,
FAN_PRIOR,
FAN_CHAR_VALUE1,
FAN_CHAR_VALUE2,
FAN_CHAR_VALUE3,
FAN_CHAR_VALUE4,
FAN_CHAR_VALUE5,
FAN_PREV_QTY,
FAN_SCRAP_QTY,
FAN_FULL_QTY,
FAN_EXCEED_QTY,
FAN_REALIZE_QTY,
FAN_SCRAP_REAL_QTY,
FAN_RETURN_QTY,
FAN_DISCHARGE_QTY,
FAN_BALANCE_QTY,
FAN_BEG_PLAN1,
FAN_BEG_PLAN2,
FAN_BEG_PLAN3,
FAN_BEG_PLAN4,
FAN_END_PLAN1,
FAN_END_PLAN2,
FAN_END_PLAN3,
FAN_END_PLAN4,
FAN_BEG_PLAN,
FAN_END_PLAN,
FAN_REAL_BEG,
FAN_REAL_END,
FAN_PLAN_PERIOD,
FAN_STK_QTY,
FAN_NETW_QTY,
FAN_FREE_QTY,
A_DATECRE,
A_DATEMOD,
A_IDCRE,
A_IDMOD,
A_RECLEVEL,
A_RECSTATUS,
A_CONFIRM,
FAL_LOT_ID,
FAN_NEXT,
FAL_LOT_MATERIAL_LINK_ID,
FAN_DESCRIPTION,
FAL_DOC_PROP_ID,
FAL_LOT_PROP_ID,
FAL_LOT_MAT_LINK_PROP_ID
FROM FAL_NETWORK_SUPPLY)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NETWORK_NEED" ("GCO_GOOD_ID", "FAN_PREV_QTY", "FAN_SCRAP_QTY", "FAN_FULL_QTY", "FAN_EXCEED_QTY", "FAN_REALIZE_QTY", "FAN_SCRAP_REAL_QTY", "FAN_RETURN_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAN_REAL_BEG", "FAN_REAL_END") AS
  (
SELECT
GCO_GOOD_ID,
SUM(FAN_PREV_QTY) FAN_PREV_QTY,
SUM(FAN_SCRAP_QTY) FAN_SCRAP_QTY,
SUM(FAN_FULL_QTY) FAN_FULL_QTY,
SUM(FAN_EXCEED_QTY) FAN_EXCEED_QTY,
SUM(FAN_REALIZE_QTY) FAN_REALIZE_QTY,
SUM(FAN_SCRAP_REAL_QTY) FAN_SCRAP_REAL_QTY,
SUM(FAN_RETURN_QTY) FAN_RETURN_QTY,
SUM(FAN_DISCHARGE_QTY) FAN_DISCHARGE_QTY,
SUM(FAN_BALANCE_QTY) FAN_BALANCE_QTY,
MIN(FAN_BEG_PLAN) FAN_BEG_PLAN,
MAX(FAN_END_PLAN) FAN_END_PLAN,
MIN(FAN_REAL_BEG) FAN_REAL_BEG,
MAX(FAN_REAL_END) FAN_REAL_END
FROM FAL_NETWORK_NEED
GROUP BY GCO_GOOD_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NETWORK_NEED_DETAIL" ("GCO_GOOD_ID", "DOC_POSITION_DETAIL_ID", "FAN_PREV_QTY", "FAN_SCRAP_QTY", "FAN_FULL_QTY", "FAN_EXCEED_QTY", "FAN_REALIZE_QTY", "FAN_SCRAP_REAL_QTY", "FAN_RETURN_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_NETW_QTY", "FAN_FREE_QTY", "FAN_STK_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAN_REAL_BEG", "FAN_REAL_END") AS
  (select   GCO_GOOD_ID
          , DOC_POSITION_DETAIL_ID
          , sum(FAN_PREV_QTY) FAN_PREV_QTY
          , sum(FAN_SCRAP_QTY) FAN_SCRAP_QTY
          , sum(FAN_FULL_QTY) FAN_FULL_QTY
          , sum(FAN_EXCEED_QTY) FAN_EXCEED_QTY
          , sum(FAN_REALIZE_QTY) FAN_REALIZE_QTY
          , sum(FAN_SCRAP_REAL_QTY) FAN_SCRAP_REAL_QTY
          , sum(FAN_RETURN_QTY) FAN_RETURN_QTY
          , sum(FAN_DISCHARGE_QTY) FAN_DISCHARGE_QTY
          , sum(FAN_BALANCE_QTY) FAN_BALANCE_QTY
          , sum(FAN_NETW_QTY) FAN_NETW_QTY
          , sum(FAN_FREE_QTY) FAN_FREE_QTY
          , sum(FAN_STK_QTY) FAN_STK_QTY
          , min(FAN_BEG_PLAN) FAN_BEG_PLAN
          , max(FAN_END_PLAN) FAN_END_PLAN
          , min(FAN_REAL_BEG) FAN_REAL_BEG
          , max(FAN_REAL_END) FAN_REAL_END
       from FAL_NETWORK_NEED
   group by GCO_GOOD_ID
          , DOC_POSITION_DETAIL_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NETWORK_PROP" ("GCO_GOOD_ID", "FAN_PREV_QTY", "FAN_SCRAP_QTY", "FAN_FULL_QTY", "FAN_EXCEED_QTY", "FAN_REALIZE_QTY", "FAN_SCRAP_REAL_QTY", "FAN_RETURN_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAN_REAL_BEG", "FAN_REAL_END") AS
  SELECT
GCO_GOOD_ID,
SUM(FAN_PREV_QTY) FAN_PREV_QTY,
SUM(FAN_SCRAP_QTY) FAN_SCRAP_QTY,
SUM(FAN_FULL_QTY) FAN_FULL_QTY,
SUM(FAN_EXCEED_QTY) FAN_EXCEED_QTY,
SUM(FAN_REALIZE_QTY) FAN_REALIZE_QTY,
SUM(FAN_SCRAP_REAL_QTY) FAN_SCRAP_REAL_QTY,
SUM(FAN_RETURN_QTY) FAN_RETURN_QTY,
SUM(FAN_DISCHARGE_QTY) FAN_DISCHARGE_QTY,
SUM(FAN_BALANCE_QTY) FAN_BALANCE_QTY,
MIN(FAN_BEG_PLAN) FAN_BEG_PLAN,
MAX(FAN_END_PLAN) FAN_END_PLAN,
MIN(FAN_REAL_BEG) FAN_REAL_BEG,
MAX(FAN_REAL_END) FAN_REAL_END
FROM FAL_NETWORK_SUPPLY
WHERE DOC_POSITION_DETAIL_ID  IS NULL AND
FAL_LOT_ID IS NULL
GROUP BY GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NETWORK_SUPPLY" ("GCO_GOOD_ID", "FAN_PREV_QTY", "FAN_SCRAP_QTY", "FAN_FULL_QTY", "FAN_EXCEED_QTY", "FAN_REALIZE_QTY", "FAN_SCRAP_REAL_QTY", "FAN_RETURN_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAN_REAL_BEG", "FAN_REAL_END") AS
  (
SELECT
GCO_GOOD_ID,
SUM(FAN_PREV_QTY) FAN_PREV_QTY,
SUM(FAN_SCRAP_QTY) FAN_SCRAP_QTY,
SUM(FAN_FULL_QTY) FAN_FULL_QTY,
SUM(FAN_EXCEED_QTY) FAN_EXCEED_QTY,
SUM(FAN_REALIZE_QTY) FAN_REALIZE_QTY,
SUM(FAN_SCRAP_REAL_QTY) FAN_SCRAP_REAL_QTY,
SUM(FAN_RETURN_QTY) FAN_RETURN_QTY,
SUM(FAN_DISCHARGE_QTY) FAN_DISCHARGE_QTY,
SUM(FAN_BALANCE_QTY) FAN_BALANCE_QTY,
MIN(FAN_BEG_PLAN) FAN_BEG_PLAN,
MAX(FAN_END_PLAN) FAN_END_PLAN,
MIN(FAN_REAL_BEG) FAN_REAL_BEG,
MAX(FAN_REAL_END) FAN_REAL_END
FROM FAL_NETWORK_SUPPLY
GROUP BY GCO_GOOD_ID)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_NETWORK_SUPPLY_DETAIL" ("GCO_GOOD_ID", "DOC_POSITION_DETAIL_ID", "FAN_PREV_QTY", "FAN_SCRAP_QTY", "FAN_FULL_QTY", "FAN_EXCEED_QTY", "FAN_REALIZE_QTY", "FAN_SCRAP_REAL_QTY", "FAN_RETURN_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_NETW_QTY", "FAN_FREE_QTY", "FAN_STK_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "FAN_REAL_BEG", "FAN_REAL_END") AS
  (select   GCO_GOOD_ID
          , DOC_POSITION_DETAIL_ID
          , sum(FAN_PREV_QTY) FAN_PREV_QTY
          , sum(FAN_SCRAP_QTY) FAN_SCRAP_QTY
          , sum(FAN_FULL_QTY) FAN_FULL_QTY
          , sum(FAN_EXCEED_QTY) FAN_EXCEED_QTY
          , sum(FAN_REALIZE_QTY) FAN_REALIZE_QTY
          , sum(FAN_SCRAP_REAL_QTY) FAN_SCRAP_REAL_QTY
          , sum(FAN_RETURN_QTY) FAN_RETURN_QTY
          , sum(FAN_DISCHARGE_QTY) FAN_DISCHARGE_QTY
          , sum(FAN_BALANCE_QTY) FAN_BALANCE_QTY
          , sum(FAN_NETW_QTY) FAN_NETW_QTY
          , sum(FAN_FREE_QTY) FAN_FREE_QTY
          , sum(FAN_STK_QTY) FAN_STK_QTY
          , min(FAN_BEG_PLAN) FAN_BEG_PLAN
          , max(FAN_END_PLAN) FAN_END_PLAN
          , min(FAN_REAL_BEG) FAN_REAL_BEG
          , max(FAN_REAL_END) FAN_REAL_END
       from FAL_NETWORK_SUPPLY
   group by GCO_GOOD_ID
          , DOC_POSITION_DETAIL_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_TASK_LINK" ("FAL_TASK_ID", "FAL_FACTORY_FLOOR_ID", "TAL_BEGIN_PLAN_DATE", "LOT_REFCOMPL", "GCO_GOOD_ID", "JOP_SHORT_DESCR", "C_SCHEDULE_PLANNING", "STATUS", "TAL_DURATION_PLAN") AS
  (select TAL.FAL_TASK_ID
        , TAL.FAL_FACTORY_FLOOR_ID
        , TAL.TAL_BEGIN_PLAN_DATE
        , LOT.LOT_REFCOMPL
        , LOT.GCO_GOOD_ID
        , JOP.JOP_SHORT_DESCR
        , LOT.C_SCHEDULE_PLANNING
        , LOT.C_LOT_STATUS STATUS
        , TAL.TAL_DUE_TSK
     from FAL_TASK_LINK TAL
        , FAL_LOT LOT
        , FAL_JOB_PROGRAM JOP
    where TAL.FAL_LOT_ID = LOT.FAL_LOT_ID
      and LOT.FAL_JOB_PROGRAM_ID = JOP.FAL_JOB_PROGRAM_ID
      and (   LOT.C_LOT_STATUS = '1'
           or LOT.C_LOT_STATUS = '2')
      and TAL.FAL_FACTORY_FLOOR_ID is not null
      and LOT.FAL_LOT_ID > 0
   union all
   select TAL.FAL_TASK_ID
        , TAL.FAL_FACTORY_FLOOR_ID
        , TAL.TAL_BEGIN_PLAN_DATE
        , (PCS.PC_FUNCTIONS.GetDescodeCode('C_PREFIX_PROP', LOT.C_PREFIX_PROP, PCS.PC_I_LIB_SESSION.GetCompLangId) || LOT.LOT_NUMBER) LOT_REFOMPL
        , LOT.GCO_GOOD_ID
        , PCS.PC_FUNCTIONS.TRANSLATEWORD('Proposition', 1) JOP_SHORT_DESCR
        , LOT.C_SCHEDULE_PLANNING
        , LOT.C_PREFIX_PROP STATUS
        , TAL.TAL_TSK_BALANCE
     from FAL_TASK_LINK_PROP TAL
        , FAL_LOT_PROP LOT
    where TAL.FAL_LOT_PROP_ID = LOT.FAL_LOT_PROP_ID
      and TAL.FAL_FACTORY_FLOOR_ID is not null
      and LOT.FAL_LOT_PROP_ID > 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAL_TEPS" ("TYP", "GCO_GOOD_CATEGORY_WORDING", "GCO_CATEGORY_CODE", "DIC_CATEGORY_FREE_1_ID", "DIC_CATEGORY_FREE_2_ID", "GOO_MAJOR_REFERENCE", "DIC_GOOD_LINE_ID", "DIC_GOOD_LINE", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_FAMILY", "DIC_GOOD_MODEL_ID", "DIC_GOOD_MODEL", "DIC_GOOD_GROUP_ID", "DIC_GOOD_GROUP", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_ACCOUNTABLE_GROUP", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_1", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_2", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_3", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_4", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_5", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_6", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_7", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_8", "DIC_GCO_STATISTIC_9_ID", "DIC_GCO_STATISTIC_9", "DIC_GCO_STATISTIC_10_ID", "DIC_GCO_STATISTIC_10", "DIC_UNIT_OF_MEASURE_ID", "FAN_DESCRIPTION", "C_LOT_STATUS", "PER_SHORT_NAME", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "STO_DESCRIPTION", "LOC_DESCRIPTION", "FAN_FULL_QTY", "FAN_DISCHARGE_QTY", "FAN_BALANCE_QTY", "FAN_BEG_PLAN", "FAN_END_PLAN", "ANNEE", "MOIS", "SEMAINE", "C_GAUGE_TITLE", "DOC_POSITION_DETAIL_ID", "FAL_LOT_ID", "FAL_DOC_PROP_ID", "FAL_LOT_PROP_ID", "STM_STOCK_ID", "GCO_GOOD_ID", "STM_STM_LOCATION", "FAL_PIC_LINE_ID", "FAL_PIC_LINE_DESCR") AS
  SELECT
   '3. NEED' TYP,
   CAT.GCO_GOOD_CATEGORY_WORDING,
   CAT.GCO_CATEGORY_CODE,
   CAT.DIC_CATEGORY_FREE_1_ID,
   CAT.DIC_CATEGORY_FREE_2_ID,
   GOO.GOO_MAJOR_REFERENCE,
   GOO.DIC_GOOD_LINE_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_LINE',GOO.DIC_GOOD_LINE_ID,1),1,100) DIC_GOOD_LINE,
   GOO.DIC_GOOD_FAMILY_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_FAMILY',GOO.DIC_GOOD_FAMILY_ID,1),1,100) DIC_GOOD_FAMILY,
   GOO.DIC_GOOD_MODEL_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_MODEL',GOO.DIC_GOOD_MODEL_ID,1),1,100) DIC_GOOD_MODEL,
   GOO.DIC_GOOD_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_GROUP',GOO.DIC_GOOD_GROUP_ID,1),1,100) DIC_GOOD_GROUP,
   GOO.DIC_ACCOUNTABLE_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_ACCOUNTABLE_GROUP',GOO.DIC_ACCOUNTABLE_GROUP_ID,1),1,100) DIC_ACCOUNTABLE_GROUP,
   GOO.DIC_GCO_STATISTIC_1_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_1',GOO.DIC_GCO_STATISTIC_1_ID,1),1,100) DIC_GCO_STATISTIC_1,
   GOO.DIC_GCO_STATISTIC_2_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_2',GOO.DIC_GCO_STATISTIC_2_ID,1),1,100) DIC_GCO_STATISTIC_2,
   GOO.DIC_GCO_STATISTIC_3_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_3',GOO.DIC_GCO_STATISTIC_3_ID,1),1,100) DIC_GCO_STATISTIC_3,
   GOO.DIC_GCO_STATISTIC_4_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_4',GOO.DIC_GCO_STATISTIC_4_ID,1),1,100) DIC_GCO_STATISTIC_4,
   GOO.DIC_GCO_STATISTIC_5_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_5',GOO.DIC_GCO_STATISTIC_5_ID,1),1,100) DIC_GCO_STATISTIC_5,
   GOO.DIC_GCO_STATISTIC_6_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_6',GOO.DIC_GCO_STATISTIC_6_ID,1),1,100) DIC_GCO_STATISTIC_6,
   GOO.DIC_GCO_STATISTIC_7_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_7',GOO.DIC_GCO_STATISTIC_7_ID,1),1,100) DIC_GCO_STATISTIC_7,
   GOO.DIC_GCO_STATISTIC_8_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_8',GOO.DIC_GCO_STATISTIC_8_ID,1),1,100) DIC_GCO_STATISTIC_8,
   GOO.DIC_GCO_STATISTIC_9_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_9',GOO.DIC_GCO_STATISTIC_9_ID,1),1,100) DIC_GCO_STATISTIC_9,
   GOO.DIC_GCO_STATISTIC_10_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_10',GOO.DIC_GCO_STATISTIC_10_ID,1),1,100) DIC_GCO_STATISTIC_10,
   GOO.DIC_UNIT_OF_MEASURE_ID,
   FNN.FAN_DESCRIPTION,
   FLO.C_LOT_STATUS,
   PER.PER_SHORT_NAME,
   PER.PER_NAME,
   PER.PER_FORENAME,
   PER.PER_ACTIVITY,
   PER.PER_COMMENT,
   PER.PER_KEY1,
   PER.PER_KEY2,
   STO.STO_DESCRIPTION,
   LOC.LOC_DESCRIPTION,
   FNN.FAN_FULL_QTY*(-1) FAN_FULL_QTY,
   FNN.FAN_DISCHARGE_QTY*(-1) FAN_DISCHARGE_QTY,
   FNN.FAN_BALANCE_QTY*(-1) FAN_BALANCE_QTY,
   FNN.FAN_BEG_PLAN,
   FNN.FAN_END_PLAN,
   to_number(substr(to_char(fnn.fan_beg_plan,'dd.MM.yyyy'),7,4)) ANNEE,
   to_number(substr(to_char(fnn.fan_beg_plan,'dd.MM.yyyy'),4,2)) MOIS,
   to_number(SUBSTR(DOC_DELAY_FUNCTIONS.DATETOWEEK(fnn.fan_beg_plan),6,2)) SEMAINE,
   FNN.C_GAUGE_TITLE,
   FNN.DOC_POSITION_DETAIL_ID,
   FNN.FAL_LOT_ID,
   FNN.FAL_DOC_PROP_ID,
   FNN.FAL_LOT_PROP_ID,
   STO.STM_STOCK_ID,
   GOO.GCO_GOOD_ID,
   '',
   FNN.FAL_PIC_LINE_ID,
   DECODE(FNN.FAL_PIC_LINE_ID, null, '',
     DECODE(PCS.PC_CONFIG.GetConfig('FAL_PIC_WEEK_MONTH'),1 , GOO2.GOO_MAJOR_REFERENCE || ' - ' || TO_CHAR(FPL.PIL_DATE,'DD.MM.YYYY'),
    													  	  GOO2.GOO_MAJOR_REFERENCE || ' - ' || TRANSLATE(DOC_DELAY_FUNCTIONS.DateToWeek(FPL.PIL_DATE),'.','/'))
   ) FAL_PIC_LINE_DESCR
FROM
   PAC_PERSON PER,
   GCO_GOOD_CATEGORY CAT,
   GCO_GOOD GOO,
   FAL_LOT FLO,
   STM_STOCK STO,
   STM_LOCATION LOC,
   FAL_NETWORK_NEED FNN,
   FAL_PIC_LINE FPL,
   GCO_GOOD GOO2
WHERE
   FNN.GCO_GOOD_ID=GOO.GCO_GOOD_ID
   AND GOO.GCO_GOOD_CATEGORY_ID=CAT.GCO_GOOD_CATEGORY_ID
   AND FNN.PAC_THIRD_ID=PER.PAC_PERSON_ID (+)
   AND FNN.STM_STOCK_ID=STO.STM_STOCK_ID (+)
   AND FNN.STM_LOCATION_ID=LOC.STM_LOCATION_ID (+)
   AND FNN.FAL_LOT_ID=FLO.FAL_LOT_ID(+)
   AND FNN.FAL_PIC_LINE_ID = FPL.FAL_PIC_LINE_ID (+)
   AND FPL.GCO_GOOD_ID = GOO2.GCO_GOOD_ID (+)
   AND FNN.FAN_BEG_PLAN IS NOT NULL
UNION ALL
SELECT
   '2. SUPPLY' TYP,
   CAT.GCO_GOOD_CATEGORY_WORDING,
   CAT.GCO_CATEGORY_CODE,
   CAT.DIC_CATEGORY_FREE_1_ID,
   CAT.DIC_CATEGORY_FREE_2_ID,
   GOO.GOO_MAJOR_REFERENCE,
   GOO.DIC_GOOD_LINE_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_LINE',GOO.DIC_GOOD_LINE_ID,1),1,100) DIC_GOOD_LINE,
   GOO.DIC_GOOD_FAMILY_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_FAMILY',GOO.DIC_GOOD_FAMILY_ID,1),1,100) DIC_GOOD_FAMILY,
   GOO.DIC_GOOD_MODEL_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_MODEL',GOO.DIC_GOOD_MODEL_ID,1),1,100) DIC_GOOD_MODEL,
   GOO.DIC_GOOD_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_GROUP',GOO.DIC_GOOD_GROUP_ID,1),1,100) DIC_GOOD_GROUP,
   GOO.DIC_ACCOUNTABLE_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_ACCOUNTABLE_GROUP',GOO.DIC_ACCOUNTABLE_GROUP_ID,1),1,100) DIC_ACCOUNTABLE_GROUP,
   GOO.DIC_GCO_STATISTIC_1_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_1',GOO.DIC_GCO_STATISTIC_1_ID,1),1,100) DIC_GCO_STATISTIC_1,
   GOO.DIC_GCO_STATISTIC_2_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_2',GOO.DIC_GCO_STATISTIC_2_ID,1),1,100) DIC_GCO_STATISTIC_2,
   GOO.DIC_GCO_STATISTIC_3_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_3',GOO.DIC_GCO_STATISTIC_3_ID,1),1,100) DIC_GCO_STATISTIC_3,
   GOO.DIC_GCO_STATISTIC_4_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_4',GOO.DIC_GCO_STATISTIC_4_ID,1),1,100) DIC_GCO_STATISTIC_4,
   GOO.DIC_GCO_STATISTIC_5_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_5',GOO.DIC_GCO_STATISTIC_5_ID,1),1,100) DIC_GCO_STATISTIC_5,
   GOO.DIC_GCO_STATISTIC_6_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_6',GOO.DIC_GCO_STATISTIC_6_ID,1),1,100) DIC_GCO_STATISTIC_6,
   GOO.DIC_GCO_STATISTIC_7_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_7',GOO.DIC_GCO_STATISTIC_7_ID,1),1,100) DIC_GCO_STATISTIC_7,
   GOO.DIC_GCO_STATISTIC_8_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_8',GOO.DIC_GCO_STATISTIC_8_ID,1),1,100) DIC_GCO_STATISTIC_8,
   GOO.DIC_GCO_STATISTIC_9_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_9',GOO.DIC_GCO_STATISTIC_9_ID,1),1,100) DIC_GCO_STATISTIC_9,
   GOO.DIC_GCO_STATISTIC_10_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_10',GOO.DIC_GCO_STATISTIC_10_ID,1),1,100) DIC_GCO_STATISTIC_10,
   GOO.DIC_UNIT_OF_MEASURE_ID,
   FNS.FAN_DESCRIPTION,
   FLO.C_LOT_STATUS,
   PER.PER_SHORT_NAME,
   PER.PER_NAME,
   PER.PER_FORENAME,
   PER.PER_ACTIVITY,
   PER.PER_COMMENT,
   PER.PER_KEY1,
   PER.PER_KEY2,
   STO.STO_DESCRIPTION,
   LOC.LOC_DESCRIPTION,
   FNS.FAN_FULL_QTY,
   FNS.FAN_DISCHARGE_QTY,
   FNS.FAN_BALANCE_QTY,
   FNS.FAN_BEG_PLAN,
   FNS.FAN_END_PLAN,
   to_number(substr(to_char(fns.fan_end_plan,'dd.MM.yyyy'),7,4)) ANNEE,
   to_number(substr(to_char(fns.fan_end_plan,'dd.MM.yyyy'),4,2)) MOIS,
	 to_number(SUBSTR(DOC_DELAY_FUNCTIONS.DATETOWEEK(fns.fan_end_plan),6,2)) SEMAINE,
   FNS.C_GAUGE_TITLE,
   FNS.DOC_POSITION_DETAIL_ID,
   FNS.FAL_LOT_ID,
   FNS.FAL_DOC_PROP_ID,
   FNS.FAL_LOT_PROP_ID,
   STO.STM_STOCK_ID,
   GOO.GCO_GOOD_ID,
   '',
   FNS.FAL_PIC_LINE_ID,
   DECODE(FNS.FAL_PIC_LINE_ID, null, '',
     DECODE(PCS.PC_CONFIG.GetConfig('FAL_PIC_WEEK_MONTH'),1 , GOO2.GOO_MAJOR_REFERENCE || ' - ' || TO_CHAR(FPL.PIL_DATE,'DD.MM.YYYY'),
    													  	  GOO2.GOO_MAJOR_REFERENCE || ' - ' || TRANSLATE(DOC_DELAY_FUNCTIONS.DateToWeek(FPL.PIL_DATE),'.','/'))
   ) FAL_PIC_LINE_DESCR
FROM
   PAC_PERSON PER,
   GCO_GOOD_CATEGORY CAT,
   GCO_GOOD GOO,
   STM_STOCK STO,
   STM_LOCATION LOC,
   FAL_LOT FLO,
   FAL_NETWORK_SUPPLY FNS,
   FAL_PIC_LINE FPL,
   GCO_GOOD GOO2
WHERE
   FNS.GCO_GOOD_ID=GOO.GCO_GOOD_ID
   AND GOO.GCO_GOOD_CATEGORY_ID=CAT.GCO_GOOD_CATEGORY_ID
   AND FNS.PAC_THIRD_ID=PER.PAC_PERSON_ID (+)
   AND FNS.STM_STOCK_ID=STO.STM_STOCK_ID (+)
   AND FNS.STM_LOCATION_ID=LOC.STM_LOCATION_ID (+)
   AND FNS.FAL_LOT_ID=FLO.FAL_LOT_ID (+)
   AND FNS.FAL_PIC_LINE_ID = FPL.FAL_PIC_LINE_ID (+)
   AND FPL.GCO_GOOD_ID = GOO2.GCO_GOOD_ID (+)
   AND FNS.FAN_BEG_PLAN IS NOT NULL
UNION ALL
SELECT
   '1. STOCK' TYP,
   CAT.GCO_GOOD_CATEGORY_WORDING,
   CAT.GCO_CATEGORY_CODE,
   CAT.DIC_CATEGORY_FREE_1_ID,
   CAT.DIC_CATEGORY_FREE_2_ID,
   GOO.GOO_MAJOR_REFERENCE,
   GOO.DIC_GOOD_LINE_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_LINE',GOO.DIC_GOOD_LINE_ID,1),1,100) DIC_GOOD_LINE,
   GOO.DIC_GOOD_FAMILY_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_FAMILY',GOO.DIC_GOOD_FAMILY_ID,1),1,100) DIC_GOOD_FAMILY,
   GOO.DIC_GOOD_MODEL_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_MODEL',GOO.DIC_GOOD_MODEL_ID,1),1,100) DIC_GOOD_MODEL,
   GOO.DIC_GOOD_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_GROUP',GOO.DIC_GOOD_GROUP_ID,1),1,100) DIC_GOOD_GROUP,
   GOO.DIC_ACCOUNTABLE_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_ACCOUNTABLE_GROUP',GOO.DIC_ACCOUNTABLE_GROUP_ID,1),1,100) DIC_ACCOUNTABLE_GROUP,
   GOO.DIC_GCO_STATISTIC_1_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_1',GOO.DIC_GCO_STATISTIC_1_ID,1),1,100) DIC_GCO_STATISTIC_1,
   GOO.DIC_GCO_STATISTIC_2_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_2',GOO.DIC_GCO_STATISTIC_2_ID,1),1,100) DIC_GCO_STATISTIC_2,
   GOO.DIC_GCO_STATISTIC_3_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_3',GOO.DIC_GCO_STATISTIC_3_ID,1),1,100) DIC_GCO_STATISTIC_3,
   GOO.DIC_GCO_STATISTIC_4_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_4',GOO.DIC_GCO_STATISTIC_4_ID,1),1,100) DIC_GCO_STATISTIC_4,
   GOO.DIC_GCO_STATISTIC_5_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_5',GOO.DIC_GCO_STATISTIC_5_ID,1),1,100) DIC_GCO_STATISTIC_5,
   GOO.DIC_GCO_STATISTIC_6_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_6',GOO.DIC_GCO_STATISTIC_6_ID,1),1,100) DIC_GCO_STATISTIC_6,
   GOO.DIC_GCO_STATISTIC_7_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_7',GOO.DIC_GCO_STATISTIC_7_ID,1),1,100) DIC_GCO_STATISTIC_7,
   GOO.DIC_GCO_STATISTIC_8_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_8',GOO.DIC_GCO_STATISTIC_8_ID,1),1,100) DIC_GCO_STATISTIC_8,
   GOO.DIC_GCO_STATISTIC_9_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_9',GOO.DIC_GCO_STATISTIC_9_ID,1),1,100) DIC_GCO_STATISTIC_9,
   GOO.DIC_GCO_STATISTIC_10_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_10',GOO.DIC_GCO_STATISTIC_10_ID,1),1,100) DIC_GCO_STATISTIC_10,
   GOO.DIC_UNIT_OF_MEASURE_ID,
   '',
   '',
   '',
   '',
   '',
   '',
   '',
   '',
   '',
   STO.STO_DESCRIPTION,
   LOC.LOC_DESCRIPTION,
   SUM(SSP.SPO_STOCK_QUANTITY),
   TO_NUMBER(NULL),
   SUM(SSP.SPO_THEORETICAL_QUANTITY),
   TO_DATE(NULL),
   TO_DATE(NULL),
   TO_NUMBER(NULL),
   TO_NUMBER(NULL),
   TO_NUMBER(NULL),
   '',
   TO_NUMBER(NULL),
   TO_NUMBER(NULL),
   TO_NUMBER(NULL),
   TO_NUMBER(NULL),
   STO.STM_STOCK_ID,
   GOO.GCO_GOOD_ID,
   EMPL.LOC_DESCRIPTION,
   TO_NUMBER(NULL),
   ''
FROM
   STM_STOCK STO,
   STM_LOCATION LOC,
   STM_LOCATION EMPL,
   GCO_GOOD_CATEGORY CAT,
   GCO_GOOD GOO,
   STM_STOCK_POSITION SSP
WHERE
   SSP.GCO_GOOD_ID=GOO.GCO_GOOD_ID
   AND GOO.GCO_GOOD_CATEGORY_ID=CAT.GCO_GOOD_CATEGORY_ID
   AND SSP.STM_STOCK_ID=STO.STM_STOCK_ID
   AND SSP.STM_LOCATION_ID=LOC.STM_LOCATION_ID
   AND LOC.STM_LOCATION_ID=EMPL.STM_LOCATION_ID (+)
   AND STO.STO_NEED_CALCULATION=1
GROUP BY
   CAT.GCO_GOOD_CATEGORY_WORDING,
   CAT.GCO_CATEGORY_CODE,
   CAT.DIC_CATEGORY_FREE_1_ID,
   CAT.DIC_CATEGORY_FREE_2_ID,
   GOO.GOO_MAJOR_REFERENCE,
   GOO.DIC_GOOD_LINE_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_LINE',GOO.DIC_GOOD_LINE_ID,1),1,100) ,
   GOO.DIC_GOOD_FAMILY_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_FAMILY',GOO.DIC_GOOD_FAMILY_ID,1),1,100) ,
   GOO.DIC_GOOD_MODEL_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_MODEL',GOO.DIC_GOOD_MODEL_ID,1),1,100) ,
   GOO.DIC_GOOD_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GOOD_GROUP',GOO.DIC_GOOD_GROUP_ID,1),1,100) ,
   GOO.DIC_ACCOUNTABLE_GROUP_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_ACCOUNTABLE_GROUP',GOO.DIC_ACCOUNTABLE_GROUP_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_1_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_1',GOO.DIC_GCO_STATISTIC_1_ID,1),1,100),
   GOO.DIC_GCO_STATISTIC_2_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_2',GOO.DIC_GCO_STATISTIC_2_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_3_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_3',GOO.DIC_GCO_STATISTIC_3_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_4_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_4',GOO.DIC_GCO_STATISTIC_4_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_5_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_5',GOO.DIC_GCO_STATISTIC_5_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_6_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_6',GOO.DIC_GCO_STATISTIC_6_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_7_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_7',GOO.DIC_GCO_STATISTIC_7_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_8_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_8',GOO.DIC_GCO_STATISTIC_8_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_9_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_9',GOO.DIC_GCO_STATISTIC_9_ID,1),1,100) ,
   GOO.DIC_GCO_STATISTIC_10_ID,
   SUBSTR(COM_DIC_FUNCTIONS.GETDICODESCR('DIC_GCO_STATISTIC_10',GOO.DIC_GCO_STATISTIC_10_ID,1),1,100),
   GOO.DIC_UNIT_OF_MEASURE_ID,
   STO.STO_DESCRIPTION,
   LOC.LOC_DESCRIPTION,
   STO.STM_STOCK_ID,
   GOO.GCO_GOOD_ID,
   EMPL.LOC_DESCRIPTION




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAM_AMO_PLAN" ("FAM_FIXED_ASSETS_ID", "FAM_MANAGED_VALUE_ID", "CALCULATION_DATE", "AMOUNT_STRUCTURE1_BASE", "AMOUNT_STRUCTURE6_BASE", "AMOUNT_PLANED", "AMOUNT_AMORTIZED", "AMOUNT_IN_PROGRESS", "AMOUNT_ADJUSTMENT") AS
  select FAM_FIXED_ASSETS_ID
       , FAM_MANAGED_VALUE_ID
       , CALCULATION_DATE
       , FAM_AMORTIZATION_PLAN.GetDatedStrElemAmount(FAM_FIXED_ASSETS_ID
                                                   , FAM_MANAGED_VALUE_ID
                                                   , CALCULATION_DATE
                                                   , FAM_STRUCTURE_ELEMENT1_ID
                                                    ) AMOUNT_STRUCTURE1_BASE
       , FAM_AMORTIZATION_PLAN.GetDatedStrElemAmount(FAM_FIXED_ASSETS_ID
                                                   , FAM_MANAGED_VALUE_ID
                                                   , CALCULATION_DATE
                                                   , FAM_STRUCTURE_ELEMENT6_ID
                                                    ) AMOUNT_STRUCTURE6_BASE
       , FAM_AMORTIZATION_PLAN.GetFixAssetsPlanAmount(FAM_FIXED_ASSETS_ID, FAM_MANAGED_VALUE_ID, CALCULATION_DATE)
                                                                                                          AMOUNT_PLANED
       , FAM_AMORTIZATION_PLAN.GetAmortizedAmount(FAM_FIXED_ASSETS_ID, FAM_MANAGED_VALUE_ID, CALCULATION_DATE)
                                                                                                       AMOUNT_AMORTIZED
       , FAM_AMORTIZATION_PLAN.GetInProgressAmoAmount(FAM_FIXED_ASSETS_ID, FAM_MANAGED_VALUE_ID, CALCULATION_DATE)
                                                                                                     AMOUNT_IN_PROGRESS
       , FAM_AMORTIZATION_PLAN.GetAmortizedAmount(FAM_FIXED_ASSETS_ID, FAM_MANAGED_VALUE_ID, CALCULATION_DATE) +
         FAM_AMORTIZATION_PLAN.GetInProgressAmoAmount(FAM_FIXED_ASSETS_ID, FAM_MANAGED_VALUE_ID, CALCULATION_DATE) -
         FAM_AMORTIZATION_PLAN.GetFixAssetsPlanAmount(FAM_FIXED_ASSETS_ID, FAM_MANAGED_VALUE_ID, CALCULATION_DATE)
                                                                                                      AMOUNT_ADJUSTMENT
    from (select FIX.FAM_FIXED_ASSETS_ID
               , VAL.FAM_MANAGED_VALUE_ID
               , FAM_AMORTIZATION_PLAN.GetLastAmoCalculationDate CALCULATION_DATE
               , nvl(DEF.FAM_STRUCTURE_ELEMENT1_ID, VAL.FAM_STRUCTURE_ELEMENT_ID) FAM_STRUCTURE_ELEMENT1_ID
               , nvl(DEF.FAM_STRUCTURE_ELEMENT6_ID, VAL.FAM_STRUCTURE_ELEMENT6_ID) FAM_STRUCTURE_ELEMENT6_ID
            from FAM_FIXED_ASSETS FIX
               , FAM_AMO_APPLICATION APP
               , FAM_MANAGED_VALUE VAL
               , FAM_AMORTIZATION_METHOD AMO
               , FAM_DEFAULT DEF
           where FIX.C_FIXED_ASSETS_STATUS = '01'
             and APP.FAM_FIXED_ASSETS_ID = FIX.FAM_FIXED_ASSETS_ID
             and VAL.FAM_MANAGED_VALUE_ID = APP.FAM_MANAGED_VALUE_ID
             and DEF.FAM_MANAGED_VALUE_ID = APP.FAM_MANAGED_VALUE_ID
             and DEF.FAM_FIXED_ASSETS_CATEG_ID = FIX.FAM_FIXED_ASSETS_CATEG_ID
             and DEF.FAM_AMORTIZATION_METHOD_ID = APP.FAM_AMORTIZATION_METHOD_ID
             and AMO.FAM_AMORTIZATION_METHOD_ID = DEF.FAM_AMORTIZATION_METHOD_ID
             and AMO.AMO_AMORTIZATION_PLAN = 1)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAM_REP_ACCOUNT_CATEG" ("FAM_IMPUTATION_ACCOUNT_ID", "FAM_DEFAULT_ID", "VAL_KEY", "FAM_FIXED_ASSETS_ID", "C_FAM_IMPUTATION_TYP", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER_FIN", "ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER_DIV", "ACS_CPN_ACCOUNT_ID", "ACC_NUMBER_CPN", "ACS_CDA_ACCOUNT_ID", "ACC_NUMBER_CDA", "ACS_PF_ACCOUNT_ID", "ACC_NUMBER_PF", "ACS_PJ_ACCOUNT_ID", "ACC_NUMBER_PJ") AS
  SELECT
  IMP.FAM_IMPUTATION_ACCOUNT_ID,
  IMP.FAM_DEFAULT_ID,
  VAL.VAL_KEY,
  ASS.FAM_FIXED_ASSETS_ID,
  IMP.C_FAM_IMPUTATION_TYP,
  IMP.ACS_FINANCIAL_ACCOUNT_ID,
  ACC.ACC_NUMBER,
  IMP.ACS_DIVISION_ACCOUNT_ID,
  DIV.ACC_NUMBER,
  IMP.ACS_CPN_ACCOUNT_ID,
  CPN.ACC_NUMBER,
  IMP.ACS_CDA_ACCOUNT_ID,
  CDA.ACC_NUMBER,
  IMP.ACS_PF_ACCOUNT_ID,
  PF.ACC_NUMBER,
  IMP.ACS_PJ_ACCOUNT_ID,
  PJ.ACC_NUMBER
FROM
  ACS_ACCOUNT PJ,
  ACS_ACCOUNT PF,
  ACS_ACCOUNT CDA,
  ACS_ACCOUNT CPN,
  ACS_ACCOUNT DIV,
  ACS_ACCOUNT ACC,
  FAM_FIXED_ASSETS ASS,
  FAM_IMPUTATION_ACCOUNT IMP,
  FAM_DEFAULT DEF,
  FAM_MANAGED_VALUE VAL
WHERE
  IMP.FAM_DEFAULT_ID = DEF.FAM_DEFAULT_ID AND
  DEF.FAM_MANAGED_VALUE_ID = VAL.FAM_MANAGED_VALUE_ID AND
  DEF.FAM_FIXED_ASSETS_CATEG_ID = ASS.FAM_FIXED_ASSETS_CATEG_ID AND
  IMP.ACS_FINANCIAL_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID(+) AND
  IMP.ACS_DIVISION_ACCOUNT_ID = DIV.ACS_ACCOUNT_ID(+) AND
  IMP.ACS_CPN_ACCOUNT_ID = CPN.ACS_ACCOUNT_ID(+) AND
  IMP.ACS_CDA_ACCOUNT_ID = CDA.ACS_ACCOUNT_ID(+) AND
  IMP.ACS_PF_ACCOUNT_ID = PF.ACS_ACCOUNT_ID(+) AND
  IMP.ACS_PJ_ACCOUNT_ID = PJ.ACS_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAM_REP_ACCOUNT_IMMO" ("FAM_IMPUTATION_ACCOUNT_ID", "FAM_AMO_APPLICATION_ID", "VAL_KEY", "CAT_DESCR", "FAM_FIXED_ASSETS_ID", "C_FAM_IMPUTATION_TYP", "ACS_FINANCIAL_ACCOUNT_ID", "ACC_NUMBER_FIN", "ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER_DIV", "ACS_CPN_ACCOUNT_ID", "ACC_NUMBER_CPN", "ACS_CDA_ACCOUNT_ID", "ACC_NUMBER_CDA", "ACS_PF_ACCOUNT_ID", "ACC_NUMBER_PF", "ACS_PJ_ACCOUNT_ID", "ACC_NUMBER_PJ") AS
  SELECT
 IMP.FAM_IMPUTATION_ACCOUNT_ID,
 IMP.FAM_AMO_APPLICATION_ID,
 VAL.VAL_KEY,
 CAT.CAT_DESCR,
 ASS.FAM_FIXED_ASSETS_ID,
 IMP.C_FAM_IMPUTATION_TYP,
 IMP.ACS_FINANCIAL_ACCOUNT_ID,
 ACC.ACC_NUMBER,
 IMP.ACS_DIVISION_ACCOUNT_ID,
 DIV.ACC_NUMBER,
 IMP.ACS_CPN_ACCOUNT_ID,
 CPN.ACC_NUMBER,
 IMP.ACS_CDA_ACCOUNT_ID,
 CDA.ACC_NUMBER,
 IMP.ACS_PF_ACCOUNT_ID,
 PF.ACC_NUMBER,
 IMP.ACS_PJ_ACCOUNT_ID,
 PJ.ACC_NUMBER
FROM
 ACS_ACCOUNT PJ,
 ACS_ACCOUNT PF,
 ACS_ACCOUNT CDA,
 ACS_ACCOUNT CPN,
 ACS_ACCOUNT DIV,
 ACS_ACCOUNT ACC,
 FAM_DEFAULT DEF,
 FAM_FIXED_ASSETS ASS,
 FAM_IMPUTATION_ACCOUNT IMP,
 FAM_AMO_APPLICATION APP,
 FAM_FIXED_ASSETS_CATEG CAT,
 FAM_MANAGED_VALUE VAL
WHERE
 IMP.FAM_AMO_APPLICATION_ID = APP.FAM_AMO_APPLICATION_ID AND
 APP.FAM_FIXED_ASSETS_ID = ASS.FAM_FIXED_ASSETS_ID AND
 ASS.FAM_FIXED_ASSETS_CATEG_ID = CAT.FAM_FIXED_ASSETS_CATEG_ID AND
 CAT.FAM_FIXED_ASSETS_CATEG_ID = DEF.FAM_FIXED_ASSETS_CATEG_ID AND
 DEF.FAM_MANAGED_VALUE_ID = VAL.FAM_MANAGED_VALUE_ID AND
 APP.FAM_MANAGED_VALUE_ID = DEF.FAM_MANAGED_VALUE_ID AND
 IMP.ACS_FINANCIAL_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID(+) AND
 IMP.ACS_DIVISION_ACCOUNT_ID = DIV.ACS_ACCOUNT_ID(+) AND
 IMP.ACS_CPN_ACCOUNT_ID = CPN.ACS_ACCOUNT_ID(+) AND
 IMP.ACS_CDA_ACCOUNT_ID = CDA.ACS_ACCOUNT_ID(+) AND
 IMP.ACS_PF_ACCOUNT_ID = PF.ACS_ACCOUNT_ID(+) AND
 IMP.ACS_PJ_ACCOUNT_ID = PJ.ACS_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAM_REP_MAIN_COMP" ("FAM_FIXED_ASSETS_ID1", "FAM_FIXED_ASSETS_CATEG_ID", "C_FIXED_ASSETS_TYP1", "C_OWNERSHIP", "C_FIXED_ASSETS_STATUS", "DIC_LIABILITY_ID", "DIC_LOCATION_ID", "DIC_STATE_ID", "DIC_USE_UNIT_ID", "FIX_NUMBER1", "FIX_SHORT_DESCR", "FIX_LONG_DESCR", "FIX_YEAR", "FIX_MODEL", "FIX_SERIAL_NUMBER", "FIX_WARRANT_DURATION", "FIX_WARRANT_END", "FIX_LANDOWNER_NUMBER", "FIX_LAND_REGISTRY_NUMBER", "FIX_SURFACE", "FIX_VOLUME", "FIX_STATE_DATE", "FIX_PURCHASE_DATE", "FIX_WORKING_DATE", "FIX_UNIT_QUANTITY", "FIX_MAN_ACCOUNTING_ALLOWED", "ACS_DIVISION_ACCOUNT_ID", "ACC_NUMBER_DIV", "ACS_CDA_ACCOUNT_ID", "ACC_NUMBER_CDA", "ACS_PF_ACCOUNT_ID", "ACC_NUMBER_PF", "ACS_PJ_ACCOUNT_ID", "ACC_NUMBER_PJ", "FAM_FAM_FIXED_ASSETS_ID", "PAC_PERSON_ID", "PER_NAME", "HRM_PERSON_ID", "PER_FULLNAME", "DOC_RECORD_ID", "RCO_TITLE", "RCO_DESCRIPTION", "C_FIXED_ASSETS_TYP2", "FIX_NUMBER2", "FIX_SHORT_DESCR2", "C_FIXED_ASSETS_TYP11", "FIX_NUMBER11", "FIX_SHORT_DESCR11", "A_DATECRE", "A_DATEMOD", "A_IDMOD", "A_IDCRE", "DIC_FAM_FIX_FREECOD1_ID", "DIC_FAM_FIX_FREECOD10_ID", "DIC_FAM_FIX_FREECOD2_ID", "DIC_FAM_FIX_FREECOD3_ID", "DIC_FAM_FIX_FREECOD4_ID", "DIC_FAM_FIX_FREECOD5_ID", "DIC_FAM_FIX_FREECOD6_ID", "DIC_FAM_FIX_FREECOD7_ID", "DIC_FAM_FIX_FREECOD8_ID", "DIC_FAM_FIX_FREECOD9_ID") AS
  SELECT
  FIX1.FAM_FIXED_ASSETS_ID,
  FIX1.FAM_FIXED_ASSETS_CATEG_ID,
  FIX1.C_FIXED_ASSETS_TYP,
  FIX1.C_OWNERSHIP,
  FIX1.C_FIXED_ASSETS_STATUS,
  FIX1.DIC_LIABILITY_ID,
  FIX1.DIC_LOCATION_ID,
  FIX1.DIC_STATE_ID,
  FIX1.DIC_USE_UNIT_ID,
  FIX1.FIX_NUMBER,
  FIX1.FIX_SHORT_DESCR,
  FIX1.FIX_LONG_DESCR,
  FIX1.FIX_YEAR,
  FIX1.FIX_MODEL,
  FIX1.FIX_SERIAL_NUMBER,
  FIX1.FIX_WARRANT_DURATION,
  FIX1.FIX_WARRANT_END,
  FIX1.FIX_LANDOWNER_NUMBER,
  FIX1.FIX_LAND_REGISTRY_NUMBER,
  FIX1.FIX_SURFACE,
  FIX1.FIX_VOLUME,
  FIX1.FIX_STATE_DATE,
  FIX1.FIX_PURCHASE_DATE,
  FIX1.FIX_WORKING_DATE,
  FIX1.FIX_UNIT_QUANTITY,
  FIX1.FIX_MAN_ACCOUNTING_ALLOWED,
  FIX1.ACS_DIVISION_ACCOUNT_ID,
  ACC1.ACC_NUMBER,
  FIX1.ACS_CDA_ACCOUNT_ID,
  ACC2.ACC_NUMBER,
  FIX1.ACS_PF_ACCOUNT_ID,
  ACC3.ACC_NUMBER,
  FIX1.ACS_PJ_ACCOUNT_ID,
  ACC4.ACC_NUMBER,
  FIX1.FAM_FAM_FIXED_ASSETS_ID,
  FIX1.PAC_PERSON_ID,
  PER.PER_NAME,
  FIX1.HRM_PERSON_ID,
  HPE.PER_FULLNAME,
  FIX1.DOC_RECORD_ID,
  DRE.RCO_TITLE,
  DRE.RCO_DESCRIPTION,
  FIX2.C_FIXED_ASSETS_TYP,
  FIX2.FIX_NUMBER,
  FIX2.FIX_SHORT_DESCR,
  FIX11.C_FIXED_ASSETS_TYP,
  FIX11.FIX_NUMBER,
  FIX11.FIX_SHORT_DESCR,
  FIX1.A_DATECRE,
  FIX1.A_DATEMOD,
  FIX1.A_IDMOD,
  FIX1.A_IDCRE,
  FIX1.DIC_FAM_FIX_FREECOD1_ID,
  FIX1.DIC_FAM_FIX_FREECOD10_ID,
  FIX1.DIC_FAM_FIX_FREECOD2_ID,
  FIX1.DIC_FAM_FIX_FREECOD3_ID,
  FIX1.DIC_FAM_FIX_FREECOD4_ID,
  FIX1.DIC_FAM_FIX_FREECOD5_ID,
  FIX1.DIC_FAM_FIX_FREECOD6_ID,
  FIX1.DIC_FAM_FIX_FREECOD7_ID,
  FIX1.DIC_FAM_FIX_FREECOD8_ID,
  FIX1.DIC_FAM_FIX_FREECOD9_ID
FROM
  DOC_RECORD DRE,
  HRM_PERSON HPE,
  PAC_PERSON PER,
  ACS_ACCOUNT ACC1,
  ACS_ACCOUNT ACC2,
  ACS_ACCOUNT ACC3,
  ACS_ACCOUNT ACC4,
  FAM_FIXED_ASSETS FIX11,
  FAM_FIXED_ASSETS FIX2,
  FAM_FIXED_ASSETS FIX1
WHERE
  FIX1.FAM_FIXED_ASSETS_ID = FIX2.FAM_FAM_FIXED_ASSETS_ID(+) AND
  FIX11.FAM_FIXED_ASSETS_ID(+) = FIX1.FAM_FAM_FIXED_ASSETS_ID AND
  FIX1.ACS_DIVISION_ACCOUNT_ID = ACC1.ACS_ACCOUNT_ID(+) AND
  FIX1.ACS_CDA_ACCOUNT_ID = ACC2.ACS_ACCOUNT_ID(+) AND
  FIX1.ACS_PF_ACCOUNT_ID = ACC3.ACS_ACCOUNT_ID(+) AND
  FIX1.ACS_PJ_ACCOUNT_ID = ACC4.ACS_ACCOUNT_ID(+) AND
  FIX1.PAC_PERSON_ID = PER.PAC_PERSON_ID (+) AND
  FIX1.HRM_PERSON_ID = HPE.HRM_PERSON_ID (+) AND
  FIX1.DOC_RECORD_ID = DRE.DOC_RECORD_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_FAM_REP_RATE" ("FAM_FIXED_ASSETS_ID", "FAM_AMORTIZATION_METHOD_ID", "FAM_MANAGED_VALUE_ID", "APP_LIN_AMORTIZATION", "APP_DEC_AMORTIZATION", "APP_INTEREST_RATE", "APP_INTEREST_RATE_2", "APP_MONTH_DURATION", "APP_AMORTIZATION_BEGIN", "APP_AMORTIZATION_END", "FAM_AMO_APPLICATION_ID", "DIC_FAM_COEFFICIENT_2_ID", "VAL_KEY", "AMO_DESCR", "CAT_DESCR", "FAM_DEFAULT_ID", "DEF_LIN_AMORTIZATION", "DEF_DEC_AMORTIZATION", "DEF_INTEREST_RATE", "DEF_INTEREST_RATE_2", "DIC_FAM_COEFFICIENT_1_ID") AS
  SELECT
   APP.FAM_FIXED_ASSETS_ID,
   APP.FAM_AMORTIZATION_METHOD_ID,
   APP.FAM_MANAGED_VALUE_ID,
   APP.APP_LIN_AMORTIZATION,
   APP.APP_DEC_AMORTIZATION,
   APP.APP_INTEREST_RATE,
   APP.APP_INTEREST_RATE_2,
   APP.APP_MONTH_DURATION,
   APP.APP_AMORTIZATION_BEGIN,
   APP.APP_AMORTIZATION_END,
   APP.FAM_AMO_APPLICATION_ID,
   APP.DIC_FAM_COEFFICIENT_ID,
   VAL.VAL_KEY,
   MET.AMO_DESCR,
   CAT.CAT_DESCR,
   DEF.FAM_DEFAULT_ID,
   DEF.DEF_LIN_AMORTIZATION,
   DEF.DEF_DEC_AMORTIZATION,
   DEF.DEF_INTEREST_RATE,
   DEF.DEF_INTEREST_RATE_2,
   DEF.DIC_FAM_COEFFICIENT_ID
FROM
   FAM_FIXED_ASSETS ASS,
   FAM_AMO_APPLICATION APP,
   FAM_DEFAULT DEF,
   FAM_FIXED_ASSETS_CATEG CAT,
   FAM_AMORTIZATION_METHOD MET,
   FAM_MANAGED_VALUE VAL
WHERE
   APP.FAM_FIXED_ASSETS_ID = ASS.FAM_FIXED_ASSETS_ID AND
   APP.FAM_MANAGED_VALUE_ID = VAL.FAM_MANAGED_VALUE_ID AND
   APP.FAM_AMORTIZATION_METHOD_ID = MET.FAM_AMORTIZATION_METHOD_ID AND
   ASS.FAM_FIXED_ASSETS_CATEG_ID = CAT.FAM_FIXED_ASSETS_CATEG_ID AND
   DEF.FAM_FIXED_ASSETS_CATEG_ID = ASS.FAM_FIXED_ASSETS_CATEG_ID AND
   DEF.FAM_AMORTIZATION_METHOD_ID = APP.FAM_AMORTIZATION_METHOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GAL_PCS_GOOD" ("GAL_GOOD_ID", "GGO_MAJOR_REFERENCE", "GGO_INDEX", "GGO_SHORT_DESCRIPTION", "GGO_LONG_DESCRIPTION", "GGO_PLAN_NUMBER", "GGO_PLAN_VERSION", "GGO_MANUFACTURER_NAME", "GGO_MANUFACTURER_REFERENCE", "GGO_BUILDING_MATERIAL", "GGO_SURFACE_TREATEMENT", "GGO_STARTUP_DATE", "GGO_EXPIRY_DATE", "GAL_GOOD_CATEGORY_ID", "GAL_PURCHASE_CATEGORY_ID", "GGO_SUPPLY_TYPE", "GGO_SUPPLY_MODE", "GGO_UNIT_OF_MEASURE", "GGO_OBTAINING_DELAY", "GGO_MANUFACTURING_DELAY", "GGO_SUPPLY_DELAY", "GGO_STANDARD_COSTPRICE", "GGO_STANDARD_COSTPRICE_DATE", "GGO_STOCK_DESCRIPTION", "GGO_DESCRIPTION", "GGO_COMMENT", "GGO_CHAR_1", "GGO_CHAR_2", "GGO_CHAR_3", "GGO_CHAR_4", "GGO_CHAR_5", "GGO_CHAR_6", "GGO_CHAR_7", "GGO_CHAR_8", "GGO_DECIMAL_1", "GGO_DECIMAL_2", "GGO_DECIMAL_3", "GGO_DECIMAL_4", "GGO_DECIMAL_5", "GGO_DECIMAL_6", "GGO_DECIMAL_7", "GGO_DECIMAL_8", "GGO_BOOLEAN_1", "GGO_BOOLEAN_2", "GGO_BOOLEAN_3", "GGO_BOOLEAN_4", "GGO_DATE_1", "GGO_DATE_2", "GGO_DATE_3", "GGO_DATE_4", "GGO_FREE_TEXT", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select --+INDEX(GCO_GOOD PK_GCO_GOOD)
         GOO.GCO_GOOD_ID GAL_GOOD_ID
       , GOO.GOO_MAJOR_REFERENCE GGO_MAJOR_REFERENCE
       , ' ' GGO_INDEX
       , nvl(DES.DES_SHORT_DESCRIPTION, DES.DES_LONG_DESCRIPTION) GGO_SHORT_DESCRIPTION
       , nvl(DES.DES_LONG_DESCRIPTION, DES.DES_SHORT_DESCRIPTION) GGO_LONG_DESCRIPTION
       , CMA_PLAN_NUMBER GGO_PLAN_NUMBER
       , CMA_PLAN_VERSION GGO_PLAN_VERSION
       , CPU_PER.PER_NAME GGO_MANUFACTURER_NAME
       , GOO.GOO_SECONDARY_REFERENCE GGO_MANUFACTURER_REFERENCE
       , ATT.DIC_GCO_ATTRIBUTE_FREE_30_ID GGO_BUILDING_MATERIAL
       , ATT.DIC_GCO_ATTRIBUTE_FREE_29_ID GGO_SURFACE_TREATEMENT
       , ATT.GAT_DATE_30 GGO_STARTUP_DATE
       , ATT.GAT_DATE_29 GGO_EXPIRY_DATE
       , GOO.GCO_GOOD_CATEGORY_ID GAL_GOOD_CATEGORY_ID
       , GOO.GCO_GOOD_CATEGORY_ID GAL_PURCHASE_CATEGORY_ID
       , case
           when PDT.GCO_GOOD_ID is not null
           and PDT.C_SUPPLY_TYPE is null then 'S'
           when PDT.GCO_GOOD_ID is not null
           and PDT.C_SUPPLY_TYPE = '1' then 'S'
           when PDT.GCO_GOOD_ID is not null
           and PDT.C_SUPPLY_TYPE = '2' then 'A'
           when SER.GCO_GOOD_ID is not null then 'A'
           when PSE.GCO_GOOD_ID is not null then 'F'
         end GGO_SUPPLY_TYPE
       , case
           when PDT.GCO_GOOD_ID is not null
           and PDT.C_SUPPLY_MODE = '1' then 'A'
           when PDT.GCO_GOOD_ID is not null
           and PDT.C_SUPPLY_MODE = '2' then 'F'
           when PDT.GCO_GOOD_ID is not null
           and PDT.C_SUPPLY_MODE = '3' then 'T'
           when SER.GCO_GOOD_ID is not null then 'A'
           when PSE.GCO_GOOD_ID is not null then null
         end GGO_SUPPLY_MODE
       , GOO.DIC_UNIT_OF_MEASURE_ID GGO_UNIT_OF_MEASURE
       , decode(PDT.C_SUPPLY_MODE, '1', nvl(CPU.CPU_SUPPLY_DELAY, 0) + nvl(CPU.CPU_CONTROL_DELAY, 0), nvl(CMA.CMA_MANUFACTURING_DELAY, 0) ) GGO_OBTAINING_DELAY
       , nvl(CMA.CMA_MANUFACTURING_DELAY, 0) GGO_MANUFACTURING_DELAY
       , nvl(CPU.CPU_SUPPLY_DELAY, 0) + nvl(CPU.CPU_CONTROL_DELAY, 0) GGO_SUPPLY_DELAY
       , GCO_FUNCTIONS.GetCostPriceWithManagementMode(GOO.GCO_GOOD_ID) GGO_STANDARD_COSTPRICE
       , to_date(null) GGO_STANDARD_COSTPRICE_DATE
--       , nvl(PDT_STK.STO_DESCRIPTION, GAL_FUNCTIONS.INIT_PARAM('GCO_DEFLTSTOCK') ) GGO_STOCK_DESCRIPTION
--       , nvl(PDT_STK.STO_DESCRIPTION, PCS.PC_CONFIG.GETCONFIG('GCO_DefltSTOCK') ) GGO_STOCK_DESCRIPTION
  ,      nvl(PDT_STK.STO_DESCRIPTION, GAL_FUNCTIONS.GET_PC_CONFIG('GCO_DefltSTOCK') ) GGO_STOCK_DESCRIPTION
       , case
           when DES.DES_SHORT_DESCRIPTION is null
           and DES_LONG_DESCRIPTION is not null then DES.DES_FREE_DESCRIPTION
           when DES_SHORT_DESCRIPTION is not null then nvl(DES.DES_LONG_DESCRIPTION, DES.DES_FREE_DESCRIPTION)
         end GGO_DESCRIPTION
       , ' ' GGO_COMMENT
       , ' ' GGO_CHAR_1
       , ' ' GGO_CHAR_2
       , ' ' GGO_CHAR_3
       , ' ' GGO_CHAR_4
       , ' ' GGO_CHAR_5
       , ' ' GGO_CHAR_6
       , ' ' GGO_CHAR_7
       , ' ' GGO_CHAR_8
       , to_number(null) GGO_DECIMAL_1
       , to_number(null) GGO_DECIMAL_2
       , to_number(null) GGO_DECIMAL_3
       , to_number(null) GGO_DECIMAL_4
       , to_number(null) GGO_DECIMAL_5
       , to_number(null) GGO_DECIMAL_6
       , to_number(null) GGO_DECIMAL_7
       , to_number(null) GGO_DECIMAL_8
       , ' ' GGO_BOOLEAN_1
       , ' ' GGO_BOOLEAN_2
       , ' ' GGO_BOOLEAN_3
       , ' ' GGO_BOOLEAN_4
       , to_date(null) GGO_DATE_1
       , to_date(null) GGO_DATE_2
       , to_date(null) GGO_DATE_3
       , to_date(null) GGO_DATE_4
       , ' ' GGO_FREE_TEXT
       , GOO.A_DATECRE A_DATECRE
       , GOO.A_IDCRE A_IDCRE
       , GOO.A_DATEMOD A_DATEMOD
       , GOO.A_IDMOD A_IDMOD
    from GCO_GOOD GOO
       , GCO_PRODUCT PDT
       , GCO_SERVICE SER
       , GCO_PSEUDO_GOOD PSE
       , GCO_DESCRIPTION DES
       , GCO_COMPL_DATA_MANUFACTURE CMA
       , GCO_COMPL_DATA_PURCHASE CPU
       , PAC_PERSON CPU_PER
       , GCO_GOOD_ATTRIBUTE ATT
       , STM_STOCK PDT_STK
   where GOO.GCO_GOOD_ID = PDT.GCO_GOOD_ID(+)
     and GOO.GCO_GOOD_ID = SER.GCO_GOOD_ID(+)
     and GOO.GCO_GOOD_ID = PSE.GCO_GOOD_ID(+)
     and DES.GCO_GOOD_ID = GOO.GCO_GOOD_ID
     and DES.C_DESCRIPTION_TYPE = '01'
     and DES.PC_LANG_ID = nvl(PCS.PC_I_LIB_SESSION.GetCompLangId, 1)
     and CMA.GCO_GOOD_ID(+) = GOO.GCO_GOOD_ID
     and CMA.CMA_DEFAULT(+) = 1
     and CPU.GCO_GOOD_ID(+) = GOO.GCO_GOOD_ID
     and CPU.CPU_DEFAULT_SUPPLIER(+) = 1
     and CPU_PER.PAC_PERSON_ID(+) = CPU.PAC_SUPPLIER_PARTNER_ID
     and ATT.GCO_GOOD_ID(+) = GOO.GCO_GOOD_ID
     and PDT_STK.STM_STOCK_ID(+) = PDT.STM_STOCK_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GAL_REPORT_DF" ("PRJ_CODE", "GAL_PROJECT_ID", "PRJ_WORDING", "DFCODE", "DFDESCRIPTION", "DFWORDING", "DFSTARTDATE", "DFENDDATE", "DFAUTHOR", "DFVERSION", "DFSTATE", "DFPRIORITY", "DFTCA_WORDING", "GAL_TASK_ID", "GAL_TASK_ID_2", "GAL_FATHER_TASK_ID", "DFLOCATION", "TAS_CODE", "TAS_WORDING", "TAS_END_DATE", "TAS_VERSION", "TAS_AUTHOR", "DIC_GLO_WORDING", "PER_NAME", "PER_FORENAME", "GTL_SEQUENCE", "GTL_PLAN_NUMBER", "GTL_QUANTITY", "GTL_PLAN_VERSION", "SCS_STEP_NUMBER", "SCS_SHORT_DESCR", "SCS_FREE_DESCR", "SCS_LONG_DESCR", "TAL_DUE_TSK", "TAL_TSK_BALANCE", "TAL_ACHIEVED_TSK", "TAL_END_PLAN_DATE", "TAL_BEGIN_PLAN_DATE", "GAL_TASK_LINK_ID", "CB_GAL_TASK_LINK_ID", "FAC_REFERENCE", "FAC_DESCRIBE", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "PC_LANG_ID", "DES_SHORT_DESCRIPTION", "DES_LONG_DESCRIPTION", "DES_FREE_DESCRIPTION", "TAS_DESCRIPTION", "C_TASK_TYPE", "DOC_RECORD_ID") AS
  (select PRJ_CODE
        , GAL_PROJECT.GAL_PROJECT_ID
        , PRJ_WORDING
        , TASCHILD.TAS_CODE DFCODE
        , TASCHILD.TAS_DESCRIPTION DFDESCRIPTION
        , TASCHILD.TAS_WORDING DFWORDING
        , TASCHILD.TAS_START_DATE DFSTARTDATE
        , TASCHILD.TAS_END_DATE DFENDDATE
        , TASCHILD.TAS_AUTHOR DFAUTHOR
        , TASCHILD.TAS_VERSION DFVERSION
        , TASCHILD.C_TAS_STATE DFSTATE
        , TASCHILD.TAS_PRIORITY DFPRIORITY
        , TCA_WORDING DFTCA_WORDING
        , to_char(TASCHILD.GAL_TASK_ID) GAL_TASK_ID
        , TASCHILD.GAL_TASK_ID GAL_TASK_ID_2
        , to_char(TASCHILD.GAL_FATHER_TASK_ID) GAL_FATHER_TASK_ID
        , nvl(CHILDLOCATION.DIC_GLO_WORDING, nvl(FATHERLOCATION.DIC_GLO_WORDING, AFFAIRELOCATION.DIC_GLO_WORDING) ) DFLOCATION
        , TASFATHER.TAS_CODE
        , TASFATHER.TAS_WORDING
        , TASFATHER.TAS_END_DATE
        , TASFATHER.TAS_VERSION
        , TASFATHER.TAS_AUTHOR
        , FATHERLOCATION.DIC_GLO_WORDING
        , PER_NAME
        , PER_FORENAME
        , GTL_SEQUENCE
        , GTL_PLAN_NUMBER
        , GTL_QUANTITY
        , GTL_PLAN_VERSION
        , SCS_STEP_NUMBER
        , SCS_SHORT_DESCR
        , SCS_FREE_DESCR
        , SCS_LONG_DESCR
        , TAL_DUE_TSK
        , TAL_TSK_BALANCE
        , TAL_ACHIEVED_TSK
        , TAL_END_PLAN_DATE
        , TAL_BEGIN_PLAN_DATE
        , to_char(GAL_TASK_LINK.GAL_TASK_LINK_ID) GAL_TASK_LINK_ID
        , GAL_TASK_LINK.GAL_TASK_LINK_ID CB_GAL_TASK_LINK_ID
        , FAC_REFERENCE
        , FAC_DESCRIBE
        , GOO_MAJOR_REFERENCE
        , GOO_SECONDARY_REFERENCE
        , PC_LANG_ID
        , DES_SHORT_DESCRIPTION
        , DES_LONG_DESCRIPTION
        , DES_FREE_DESCRIPTION
        , TASFATHER.TAS_DESCRIPTION
        , C_TASK_TYPE
        , GAL_TASK_LINK.DOC_RECORD_ID
     from GAL_TASK_CATEGORY
        , GAL_TASK_LOT_LINK
        , GAL_TASK_LOT
        , GAL_TASK_LINK
        , GAL_TASK TASCHILD
        , GAL_TASK TASFATHER
        , DIC_GAL_LOCATION CHILDLOCATION
        , DIC_GAL_LOCATION FATHERLOCATION
        , DIC_GAL_LOCATION AFFAIRELOCATION
        , GAL_PROJECT
        , GCO_GOOD
        , GCO_DESCRIPTION
        , FAL_FACTORY_FLOOR
        , PAC_CUSTOM_PARTNER
        , PAC_PERSON
    where GAL_TASK_LOT.GAL_TASK_LOT_ID = GAL_TASK_LOT_LINK.GAL_TASK_LOT_ID
      and GAL_TASK_LOT_LINK.GAL_TASK_LINK_ID = GAL_TASK_LINK.GAL_TASK_LINK_ID
      and TASCHILD.GAL_TASK_ID = GAL_TASK_LOT_LINK.GAL_TASK_ID
      and TASCHILD.GAL_FATHER_TASK_ID = TASFATHER.GAL_TASK_ID(+)
      and TASCHILD.GAL_PROJECT_ID = GAL_PROJECT.GAL_PROJECT_ID
      and TASCHILD.DIC_GAL_LOCATION_ID = CHILDLOCATION.DIC_GAL_LOCATION_ID(+)
      and TASFATHER.DIC_GAL_LOCATION_ID = FATHERLOCATION.DIC_GAL_LOCATION_ID(+)
      and AFFAIRELOCATION.dic_gal_location_id(+) = GAL_PROJECT.dic_gal_location_id
      and GAL_TASK_LOT.GCO_GOOD_ID = GCO_GOOD.GCO_GOOD_ID
      and GCO_GOOD.GCO_GOOD_ID = GCO_DESCRIPTION.GCO_GOOD_ID
      and GCO_DESCRIPTION.C_DESCRIPTION_TYPE = '01'
      and GAL_TASK_LINK.FAL_FACTORY_FLOOR_ID = FAL_FACTORY_FLOOR.FAL_FACTORY_FLOOR_ID(+)
      and PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID = PAC_PERSON.PAC_PERSON_ID(+)
      and GAL_PROJECT.PAC_CUSTOM_PARTNER_ID = PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID(+)
      and TASCHILD.GAL_TASK_CATEGORY_ID = GAL_TASK_CATEGORY.GAL_TASK_CATEGORY_ID(+))
  union
  (select PRJ_CODE
        , GAL_PROJECT.GAL_PROJECT_ID
        , PRJ_WORDING
        , TASCHILD.TAS_CODE DFCODE
        , TASCHILD.TAS_DESCRIPTION DFDESCRIPTION
        , TASCHILD.TAS_WORDING DFWORDING
        , TASCHILD.TAS_START_DATE DFSTARTDATE
        , TASCHILD.TAS_END_DATE DFENDDATE
        , TASCHILD.TAS_AUTHOR DFAUTHOR
        , TASCHILD.TAS_VERSION DFVERSION
        , TASCHILD.C_TAS_STATE DFSTATE
        , TASCHILD.TAS_PRIORITY DFPRIORITY
        , TCA_WORDING DFTCA_WORDING
        , to_char(TASCHILD.GAL_TASK_ID) GAL_TASK_ID
        , TASCHILD.GAL_TASK_ID GAL_TASK_ID_2
        , to_char(TASCHILD.GAL_FATHER_TASK_ID) GAL_FATHER_TASK_ID
        , nvl(CHILDLOCATION.DIC_GLO_WORDING, nvl(FATHERLOCATION.DIC_GLO_WORDING, AFFAIRELOCATION.DIC_GLO_WORDING) ) DFLOCATION
        , TASFATHER.TAS_CODE
        , TASFATHER.TAS_WORDING
        , TASFATHER.TAS_END_DATE
        , TASFATHER.TAS_VERSION
        , TASFATHER.TAS_AUTHOR
        , FATHERLOCATION.DIC_GLO_WORDING
        , PER_NAME
        , PER_FORENAME
        , null
        , null
        , null
        , null
        , SCS_STEP_NUMBER
        , SCS_SHORT_DESCR
        , SCS_FREE_DESCR
        , SCS_LONG_DESCR
        , TAL_DUE_TSK
        , TAL_TSK_BALANCE
        , TAL_ACHIEVED_TSK
        , TAL_END_PLAN_DATE
        , TAL_BEGIN_PLAN_DATE
        , to_char(GAL_TASK_LINK.GAL_TASK_LINK_ID) GAL_TASK_LINK_ID
        , GAL_TASK_LINK.GAL_TASK_LINK_ID CB_GAL_TASK_LINK_ID
        , FAC_REFERENCE
        , FAC_DESCRIBE
        , null
        , null
        , 99
        , null
        , null
        , null
        , TASFATHER.TAS_DESCRIPTION
        , C_TASK_TYPE
        , GAL_TASK_LINK.DOC_RECORD_ID
     from GAL_TASK_CATEGORY
        , GAL_TASK_LOT_LINK
        , GAL_TASK_LINK
        , GAL_TASK TASCHILD
        , GAL_TASK TASFATHER
        , DIC_GAL_LOCATION CHILDLOCATION
        , DIC_GAL_LOCATION FATHERLOCATION
        , DIC_GAL_LOCATION AFFAIRELOCATION
        , GAL_PROJECT
        , FAL_FACTORY_FLOOR
        , PAC_CUSTOM_PARTNER
        , PAC_PERSON
    where TASCHILD.GAL_TASK_ID = GAL_TASK_LINK.GAL_TASK_ID
      and GAL_TASK_LINK.GAL_TASK_LINK_ID = GAL_TASK_LOT_LINK.GAL_TASK_LINK_ID(+)
      and TASCHILD.GAL_FATHER_TASK_ID = TASFATHER.GAL_TASK_ID(+)
      and TASCHILD.GAL_PROJECT_ID = GAL_PROJECT.GAL_PROJECT_ID
      and TASCHILD.DIC_GAL_LOCATION_ID = CHILDLOCATION.DIC_GAL_LOCATION_ID(+)
      and TASFATHER.DIC_GAL_LOCATION_ID = FATHERLOCATION.DIC_GAL_LOCATION_ID(+)
      and AFFAIRELOCATION.dic_gal_location_id(+) = GAL_PROJECT.dic_gal_location_id
      and GAL_TASK_LINK.FAL_FACTORY_FLOOR_ID = FAL_FACTORY_FLOOR.FAL_FACTORY_FLOOR_ID(+)
      and PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID = PAC_PERSON.PAC_PERSON_ID(+)
      and GAL_PROJECT.PAC_CUSTOM_PARTNER_ID = PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID(+)
      and TASCHILD.GAL_TASK_CATEGORY_ID = GAL_TASK_CATEGORY.GAL_TASK_CATEGORY_ID(+))


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GAL_REPORT_MO" ("PRJ_CODE", "GAL_PROJECT_ID", "PRJ_WORDING", "TAS_CODE", "TAS_WORDING", "TAS_START_DATE", "TAS_END_DATE", "TAS_AUTHOR", "TAS_VERSION", "GAL_TASK_ID", "DIC_GLO_WORDING", "PER_NAME", "PER_FORENAME", "SCS_STEP_NUMBER", "SCS_SHORT_DESCR", "SCS_FREE_DESCR", "SCS_LONG_DESCR", "TAL_DUE_TSK", "TAL_TSK_BALANCE", "TAL_ACHIEVED_TSK", "TAL_END_PLAN_DATE", "TAL_BEGIN_PLAN_DATE", "GAL_TASK_LINK_ID", "FAC_REFERENCE", "FAC_DESCRIBE", "TAS_DESCRIPTION") AS
  select PRJ_CODE
       , GAL_PROJECT.GAL_PROJECT_ID
       , PRJ_WORDING
       , TAS_CODE
       , TAS_WORDING
       , TAS_START_DATE
       , TAS_END_DATE
       , TAS_AUTHOR
       , TAS_VERSION
       , to_char(GAL_TASK.GAL_TASK_ID) GAL_TASK_ID
       , nvl(TASKLOCATION.DIC_GLO_WORDING, AFFAIRELOCATION.DIC_GLO_WORDING) DIC_GLO_WORDING
       , PER_NAME
       , PER_FORENAME
       , SCS_STEP_NUMBER
       , SCS_SHORT_DESCR
       , SCS_FREE_DESCR
       , SCS_LONG_DESCR
       , TAL_DUE_TSK
       , TAL_TSK_BALANCE
       , TAL_ACHIEVED_TSK
       , TAL_END_PLAN_DATE
       , TAL_BEGIN_PLAN_DATE
       , to_char(GAL_TASK_LINK.GAL_TASK_LINK_ID) GAL_TASK_LINK_ID
       , FAC_REFERENCE
       , FAC_DESCRIBE
       , TAS_DESCRIPTION
    from GAL_TASK_LINK
       , GAL_TASK
       , DIC_GAL_LOCATION TASKLOCATION
       , DIC_GAL_LOCATION AFFAIRELOCATION
       , GAL_PROJECT
       , FAL_FACTORY_FLOOR
       , PAC_CUSTOM_PARTNER
       , PAC_PERSON
   where GAL_TASK.GAL_PROJECT_ID = GAL_PROJECT.GAL_PROJECT_ID
     and GAL_TASK.GAL_TASK_ID = GAL_TASK_LINK.GAL_TASK_ID
     and GAL_TASK.DIC_GAL_LOCATION_ID = TASKLOCATION.DIC_GAL_LOCATION_ID(+)
     and GAL_PROJECT.DIC_GAL_LOCATION_ID = AFFAIRELOCATION.DIC_GAL_LOCATION_ID(+)
     and GAL_TASK_LINK.FAL_FACTORY_FLOOR_ID = FAL_FACTORY_FLOOR.FAL_FACTORY_FLOOR_ID
     and PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID = PAC_PERSON.PAC_PERSON_ID(+)
     and GAL_PROJECT.PAC_CUSTOM_PARTNER_ID = PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_ACCOUNT_LIST" ("GCO_GOOD_ID", "PC_LANG_ID", "DES_PROV", "CODE", "CODE_WORDING", "DIVISION_NUMBER", "DIVISION_DESCRIPTION", "FINANCIAL_NUMBER", "FINANCIAL_DESCRIPTION") AS
  (select
  GCO_GOOD_ID, ACS_DESCRIPTION_DIVISION.PC_LANG_ID,
  'DOC' DES_PROV,
  C_ADMIN_DOMAIN CODE, V_PC_DESCODES.GCDTEXT1 CODE_WORDING,
  ACS_ACCOUNT_DIVISION.ACC_NUMBER DIVISION_NUMBER,
  ACS_DESCRIPTION_DIVISION.DES_DESCRIPTION_SUMMARY DIVISION_DESCRIPTION,
  ACS_ACCOUNT_FINANCIAL.ACC_NUMBER FINANCIAL_NUMBER,
  ACS_DESCRIPTION_FINANCIAL.DES_DESCRIPTION_SUMMARY FINANCIAL_DESCRIPTION
from
  GCO_IMPUT_DOC, PCS.V_PC_DESCODES,
  ACS_ACCOUNT ACS_ACCOUNT_DIVISION,
  ACS_DESCRIPTION ACS_DESCRIPTION_DIVISION,
  ACS_ACCOUNT ACS_ACCOUNT_FINANCIAL,
  ACS_DESCRIPTION ACS_DESCRIPTION_FINANCIAL
where
  ACS_DESCRIPTION_DIVISION.ACS_ACCOUNT_ID = GCO_IMPUT_DOC.ACS_DIVISION_ACCOUNT_ID
  AND ACS_DESCRIPTION_FINANCIAL.ACS_ACCOUNT_ID = GCO_IMPUT_DOC.ACS_FINANCIAL_ACCOUNT_ID
  AND ACS_DESCRIPTION_DIVISION.PC_LANG_ID = ACS_DESCRIPTION_FINANCIAL.PC_LANG_ID
  AND ACS_DESCRIPTION_DIVISION.PC_LANG_ID = V_PC_DESCODES.PC_LANG_ID
  AND V_PC_DESCODES.GCGNAME = 'C_ADMIN_DOMAIN'
  AND V_PC_DESCODES.GCLCODE = GCO_IMPUT_DOC.C_ADMIN_DOMAIN
  AND ACS_DESCRIPTION_DIVISION.ACS_ACCOUNT_ID = ACS_ACCOUNT_DIVISION.ACS_ACCOUNT_ID
  AND ACS_DESCRIPTION_FINANCIAL.ACS_ACCOUNT_ID = ACS_ACCOUNT_FINANCIAL.ACS_ACCOUNT_ID)
union
(select
  GCO_GOOD_ID, ACS_DESCRIPTION_DIVISION.PC_LANG_ID,
  'STOCK' DES_PROV,
  '' CODE, STM_MOVEMENT_KIND.MOK_ABBREVIATION CODE_WORDING,
  ACS_ACCOUNT_DIVISION.ACC_NUMBER DIVISION_NUMBER,
  ACS_DESCRIPTION_DIVISION.DES_DESCRIPTION_SUMMARY DIVISION_DESCRIPTION,
  ACS_ACCOUNT_FINANCIAL.ACC_NUMBER FINANCIAL_NUMBER,
  ACS_DESCRIPTION_FINANCIAL.DES_DESCRIPTION_SUMMARY FINANCIAL_DESCRIPTION
from
  GCO_IMPUT_STOCK,
  ACS_ACCOUNT ACS_ACCOUNT_DIVISION,
  ACS_DESCRIPTION ACS_DESCRIPTION_DIVISION,
  ACS_ACCOUNT ACS_ACCOUNT_FINANCIAL,
  ACS_DESCRIPTION ACS_DESCRIPTION_FINANCIAL,
  STM_MOVEMENT_KIND
where
  ACS_DESCRIPTION_DIVISION.ACS_ACCOUNT_ID = GCO_IMPUT_STOCK.ACS_DIVISION_ACCOUNT_ID
  AND ACS_DESCRIPTION_FINANCIAL.ACS_ACCOUNT_ID = GCO_IMPUT_STOCK.ACS_FINANCIAL_ACCOUNT_ID
  AND ACS_DESCRIPTION_DIVISION.PC_LANG_ID = ACS_DESCRIPTION_FINANCIAL.PC_LANG_ID
  AND ACS_DESCRIPTION_DIVISION.ACS_ACCOUNT_ID = ACS_ACCOUNT_DIVISION.ACS_ACCOUNT_ID
  AND ACS_DESCRIPTION_FINANCIAL.ACS_ACCOUNT_ID = ACS_ACCOUNT_FINANCIAL.ACS_ACCOUNT_ID
  AND GCO_IMPUT_STOCK.STM_MOVEMENT_KIND_ID = STM_MOVEMENT_KIND.STM_MOVEMENT_KIND_ID )




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_GOOD_CATALOGUE" ("GCO_GOOD_ID", "C_GOOD_STATUS", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "GOO_CCP_MANAGEMENT", "GOO_NUMBER_OF_DECIMAL", "A_DATECRE", "A_DATEMOD", "GCO_MULTIMEDIA_ELEMENT_ID", "GCO_DESCRIPTION_ID", "GCO_GOOD_IDENT", "PC_LANG_ID", "C_DESCRIPTION_TYPE", "DES_SHORT_DESCRIPTION", "DES_LONG_DESCRIPTION", "DES_FREE_DESCRIPTION", "GCO_GOOD_CATEGORY_ID", "GCO_GOOD_CATEGORY_WORDING", "GCO_CATEGORY_CODE", "DIC_UNIT_OF_MEASURE_ID", "DIC_UNIT_OF_MEASURE_WORDING", "UME_UOM_CODE", "UME_BARCODE_CODE", "DIC_GOOD_LINE_ID", "DIC_GOOD_LINE_WORDING", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_FAMILY_WORDING", "DIC_GOOD_MODEL_ID", "DIC_GOOD_MODEL_WORDING", "DIC_GOOD_GROUP_ID", "DIC_GOOD_GROUP_WORDING", "C_MANAGEMENT_MODE", "C_MNGMNT_MODE_WORDING1") AS
  select GCO_GOOD.GCO_GOOD_ID
       , GCO_GOOD.C_GOOD_STATUS
       , GCO_GOOD.GOO_MAJOR_REFERENCE
       , GCO_GOOD.GOO_SECONDARY_REFERENCE
       , GCO_GOOD.GOO_EAN_CODE
       , GCO_GOOD.GOO_HIBC_PRIMARY_CODE
       , GCO_GOOD.GOO_HIBC_REFERENCE
       , GCO_GOOD.GOO_EAN_UCC14_CODE
       , GCO_GOOD.GOO_CCP_MANAGEMENT
       , GCO_GOOD.GOO_NUMBER_OF_DECIMAL
       , GCO_GOOD.A_DATECRE
       , GCO_GOOD.A_DATEMOD
       , nvl(to_char(GCO_GOOD.GCO_MULTIMEDIA_ELEMENT_ID), 'A') as GCO_MULTIMEDIA_ELEMENT_ID
       , GCO_DESCRIPTION.GCO_DESCRIPTION_ID
       , GCO_DESCRIPTION.GCO_GOOD_ID as GCO_GOOD_IDENT
       , GCO_DESCRIPTION.PC_LANG_ID
       , GCO_DESCRIPTION.C_DESCRIPTION_TYPE
       , GCO_DESCRIPTION.DES_SHORT_DESCRIPTION
       , GCO_DESCRIPTION.DES_LONG_DESCRIPTION
       , GCO_DESCRIPTION.DES_FREE_DESCRIPTION
       , GCO_GOOD_CATEGORY.GCO_GOOD_CATEGORY_ID
       , GCO_GOOD_CATEGORY.GCO_GOOD_CATEGORY_WORDING
       , GCO_GOOD_CATEGORY.GCO_CATEGORY_CODE
       , DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_ID
       , DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_WORDING
       , DIC_UNIT_OF_MEASURE.UME_UOM_CODE
       , DIC_UNIT_OF_MEASURE.UME_BARCODE_CODE
       , nvl(DIC_GOOD_LINE.DIC_GOOD_LINE_ID, ' ') as DIC_GOOD_LINE_ID
       , nvl(DIC_GOOD_LINE.DIC_GOOD_LINE_WORDING, ' ') as DIC_GOOD_LINE_WORDING
       , nvl(DIC_GOOD_FAMILY.DIC_GOOD_FAMILY_ID, ' ') as DIC_GOOD_FAMILY_ID
       , nvl(DIC_GOOD_FAMILY.DIC_GOOD_FAMILY_WORDING, ' ') as DIC_GOOD_FAMILY_WORDING
       , nvl(DIC_GOOD_MODEL.DIC_GOOD_MODEL_ID, ' ') as DIC_GOOD_MODEL_ID
       , nvl(DIC_GOOD_MODEL.DIC_GOOD_MODEL_WORDING, ' ') as DIC_GOOD_MODEL_WORDING
       , nvl(DIC_GOOD_GROUP.DIC_GOOD_GROUP_ID, ' ') as DIC_GOOD_GROUP_ID
       , nvl(DIC_GOOD_GROUP.DIC_GOOD_GROUP_WORDING, ' ') as DIC_GOOD_GROUP_WORDING
       , GCO_GOOD.C_MANAGEMENT_MODE
       , V_PC_DESCODES1.GCDTEXT1 C_MNGMNT_MODE_WORDING1
    from GCO_GOOD
       , GCO_DESCRIPTION
       , GCO_GOOD_CATEGORY
       , DIC_UNIT_OF_MEASURE
       , DIC_GOOD_LINE
       , DIC_GOOD_FAMILY
       , DIC_GOOD_MODEL
       , DIC_GOOD_GROUP
       , PCS.V_PC_DESCODES V_PC_DESCODES1
   where GCO_DESCRIPTION.GCO_GOOD_ID = GCO_GOOD.GCO_GOOD_ID
     and GCO_DESCRIPTION.C_DESCRIPTION_TYPE = 1
     and GCO_GOOD_CATEGORY.GCO_GOOD_CATEGORY_ID = GCO_GOOD.GCO_GOOD_CATEGORY_ID
     and DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_ID = GCO_GOOD.DIC_UNIT_OF_MEASURE_ID
     and DIC_GOOD_LINE.DIC_GOOD_LINE_ID(+) = GCO_GOOD.DIC_GOOD_LINE_ID
     and DIC_GOOD_FAMILY.DIC_GOOD_FAMILY_ID(+) = GCO_GOOD.DIC_GOOD_FAMILY_ID
     and DIC_GOOD_MODEL.DIC_GOOD_MODEL_ID(+) = GCO_GOOD.DIC_GOOD_MODEL_ID
     and DIC_GOOD_GROUP.DIC_GOOD_GROUP_ID(+) = GCO_GOOD.DIC_GOOD_GROUP_ID
     and V_PC_DESCODES1.PC_LANG_ID = GCO_DESCRIPTION.PC_LANG_ID
     and V_PC_DESCODES1.GCGNAME = 'C_MANAGEMENT_MODE'
     and V_PC_DESCODES1.GCLCODE = GCO_GOOD.C_MANAGEMENT_MODE




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_GOOD_DESCR" ("GCO_GOOD_ID", "C_GOOD_STATUS", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "GOO_CCP_MANAGEMENT", "GOO_NUMBER_OF_DECIMAL", "C_MANAGEMENT_MODE", "A_DATECRE", "A_DATEMOD", "GCO_GOOD_CATEGORY_ID", "DIC_ACCOUNTABLE_GROUP_ID", "GCO_MULTIMEDIA_ELEMENT_ID", "GCO_DESCRIPTION_ID", "GCO_GOOD_IDENT", "PC_LANG_ID", "C_DESCRIPTION_TYPE", "DES_SHORT_DESCRIPTION", "DES_LONG_DESCRIPTION", "DES_FREE_DESCRIPTION", "DIC_UNIT_OF_MEASURE_ID", "DIC_UNIT_OF_MEASURE_WORDING", "UME_UOM_CODE", "UME_BARCODE_CODE") AS
  select GCO_GOOD.GCO_GOOD_ID
       , GCO_GOOD.C_GOOD_STATUS
       , GCO_GOOD.GOO_MAJOR_REFERENCE
       , GCO_GOOD.GOO_SECONDARY_REFERENCE
       , GCO_GOOD.GOO_EAN_CODE
       , GCO_GOOD.GOO_HIBC_PRIMARY_CODE
       , GCO_GOOD.GOO_HIBC_REFERENCE
       , GCO_GOOD.GOO_EAN_UCC14_CODE
       , GCO_GOOD.GOO_CCP_MANAGEMENT
       , GCO_GOOD.GOO_NUMBER_OF_DECIMAL
       , GCO_GOOD.C_MANAGEMENT_MODE
       , GCO_GOOD.A_DATECRE
       , GCO_GOOD.A_DATEMOD
       , GCO_GOOD.GCO_GOOD_CATEGORY_ID
       , GCO_GOOD.DIC_ACCOUNTABLE_GROUP_ID
       , nvl(to_char(GCO_GOOD.GCO_MULTIMEDIA_ELEMENT_ID), 'A') as GCO_MULTIMEDIA_ELEMENT_ID
       , GCO_DESCRIPTION.GCO_DESCRIPTION_ID
       , GCO_DESCRIPTION.GCO_GOOD_ID as GCO_GOOD_IDENT
       , GCO_DESCRIPTION.PC_LANG_ID
       , GCO_DESCRIPTION.C_DESCRIPTION_TYPE
       , GCO_DESCRIPTION.DES_SHORT_DESCRIPTION
       , GCO_DESCRIPTION.DES_LONG_DESCRIPTION
       , GCO_DESCRIPTION.DES_FREE_DESCRIPTION
       , DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_ID
       , DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_WORDING
       , DIC_UNIT_OF_MEASURE.UME_UOM_CODE
       , DIC_UNIT_OF_MEASURE.UME_BARCODE_CODE
    from GCO_GOOD
       , GCO_DESCRIPTION
       , DIC_UNIT_OF_MEASURE
   where GCO_DESCRIPTION.GCO_GOOD_ID = GCO_GOOD.GCO_GOOD_ID
     and GCO_DESCRIPTION.C_DESCRIPTION_TYPE = 1
     and DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_ID = GCO_GOOD.DIC_UNIT_OF_MEASURE_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_GOOD_FULL_DESCR" ("GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "DES_SHORT_DESCRIPTION", "DES_LONG_DESCRIPTION", "DES_FREE_DESCRIPTION", "GOO_NUMBER_OF_DECIMAL", "C_GOOD_STATUS", "GCLCODE", "GCDTEXT1", "WING_STATUS", "DIC_UNIT_OF_MEASURE_ID", "DIC_UNIT_OF_MEASURE_WORDING", "UME_UOM_CODE", "UME_BARCODE_CODE", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_ACCOUNTABLE_GROUP_WORDING", "GCO_GOOD_CATEGORY_ID", "GCO_GOOD_CATEGORY_WORDING", "DIC_GOOD_LINE_ID", "DIC_GOOD_LINE_WORDING", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_FAMILY_WORDING", "DIC_GOOD_MODEL_ID", "DIC_GOOD_MODEL_WORDING", "DIC_GOOD_GROUP_ID", "DIC_GOOD_GROUP_WORDING") AS
  select GCO.GCO_GOOD_ID
       , GCO.GOO_MAJOR_REFERENCE
       , GCO.GOO_SECONDARY_REFERENCE
       , GCO.GOO_EAN_CODE
       , GCO.GOO_HIBC_PRIMARY_CODE
       , GCO.GOO_HIBC_REFERENCE
       , GCO.GOO_EAN_UCC14_CODE
       , GCD.DES_SHORT_DESCRIPTION
       , GCD.DES_LONG_DESCRIPTION
       , GCD.DES_FREE_DESCRIPTION
       , GCO.GOO_NUMBER_OF_DECIMAL
       , GCO.C_GOOD_STATUS
       , DCOD.GCLCODE
       , DCOD.GCDTEXT1
       , substr('160', GCO.C_GOOD_STATUS, 1) WING_STATUS
       , GCO.DIC_UNIT_OF_MEASURE_ID
       , DUOM.DIC_UNIT_OF_MEASURE_WORDING
       , DUOM.UME_UOM_CODE
       , DUOM.UME_BARCODE_CODE
       , GCO.DIC_ACCOUNTABLE_GROUP_ID
       , DAG.DIC_ACCOUNTABLE_GROUP_WORDING
       , GCO.GCO_GOOD_CATEGORY_ID
       , CAT.GCO_GOOD_CATEGORY_WORDING
       , GCO.DIC_GOOD_LINE_ID
       , DGL.DIC_GOOD_LINE_WORDING
       , GCO.DIC_GOOD_FAMILY_ID
       , DGF.DIC_GOOD_FAMILY_WORDING
       , GCO.DIC_GOOD_MODEL_ID
       , DGM.DIC_GOOD_MODEL_WORDING
       , GCO.DIC_GOOD_GROUP_ID
       , DGG.DIC_GOOD_GROUP_WORDING
    from GCO_GOOD GCO
       , GCO_DESCRIPTION GCD
       , GCO_GOOD_CATEGORY CAT
       , PCS.V_PC_DESCODES DCOD
       , DIC_UNIT_OF_MEASURE DUOM
       , DIC_ACCOUNTABLE_GROUP DAG
       , DIC_GOOD_LINE DGL
       , DIC_GOOD_FAMILY DGF
       , DIC_GOOD_MODEL DGM
       , DIC_GOOD_GROUP DGG
   where GCO.GCO_GOOD_ID = GCD.GCO_GOOD_ID
     and GCO.GCO_GOOD_CATEGORY_ID = CAT.GCO_GOOD_CATEGORY_ID
     and GCO.C_GOOD_STATUS = DCOD.GCLCODE
     and DUOM.DIC_UNIT_OF_MEASURE_ID = GCO.DIC_UNIT_OF_MEASURE_ID
     and DAG.DIC_ACCOUNTABLE_GROUP_ID(+) = GCO.DIC_ACCOUNTABLE_GROUP_ID
     and DGL.DIC_GOOD_LINE_ID(+) = GCO.DIC_GOOD_LINE_ID
     and DGF.DIC_GOOD_FAMILY_ID(+) = GCO.DIC_GOOD_FAMILY_ID
     and DGM.DIC_GOOD_MODEL_ID(+) = GCO.DIC_GOOD_MODEL_ID
     and DGG.DIC_GOOD_GROUP_ID(+) = GCO.DIC_GOOD_GROUP_ID
     and DCOD.GCGNAME = 'C_GOOD_STATUS'
     and GCD.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId
     and GCD.C_DESCRIPTION_TYPE = '01'
     and DCOD.PC_LANG_ID = PCS.PC_I_LIB_SESSION.GetUserLangId


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_GOOD_LIST" ("GCO_GOOD_ID", "C_GOOD_STATUS", "GCO_GOOD_CATEGORY_ID", "GCO_REFERENCE_TEMPLATE_ID", "RTE_DESIGNATION", "RTE_DESCRIPTION", "RTE_FORMAT", "GCO_GOOD_CATEGORY_WORDING", "GCO_CATEGORY_CODE", "DIC_CATEGORY_FREE_1_ID", "DIC_CATEGORY_FREE_2_ID", "CAT_FREE_TEXT_1", "CAT_FREE_TEXT_2", "CAT_FREE_TEXT_3", "CAT_FREE_TEXT_4", "CAT_FREE_TEXT_5", "CAT_FREE_NUMBER_1", "CAT_FREE_NUMBER_2", "CAT_FREE_NUMBER_3", "CAT_FREE_NUMBER_4", "CAT_FREE_NUMBER_5", "CAT_EAN_GOO_UCC14", "CAT_EAN_ASA_UCC14", "CAT_EAN_FAL_UCC14", "CAT_EAN_INV_UCC14", "CAT_EAN_PUR_UCC14", "CAT_EAN_SAL_UCC14", "CAT_EAN_STK_UCC14", "CAT_EAN_SUB_UCC14", "CAT_EAN_DIU_UCC14", "CAT_HIBC_MANAGEMENT", "GCO_MULTIMEDIA_ELEMENT_ID", "MME_MULTIMEDIA_DESIGNATION", "MME_FREE_DESCRIPTION", "GCO_SUBSTITUTION_LIST_ID", "SUL_SUBST_DESIGN_SHORT", "SUL_SUBST_DESIGN_LONG", "SUL_COMMENT", "SUL_FROM_DATE", "SUL_UNTIL_DATE", "SUL_REPLACEMENT_GOOD_ID", "DIC_FREE_TABLE_1_ID", "DIC_FREE_TABLE_2_ID", "DIC_FREE_TABLE_3_ID", "DIC_FREE_TABLE_4_ID", "DIC_FREE_TABLE_5_ID", "DATA_ALPHA_COURT_1", "DATA_ALPHA_COURT_2", "DATA_ALPHA_COURT_3", "DATA_ALPHA_COURT_4", "DATA_ALPHA_COURT_5", "DATA_ALPHA_LONG_1", "DATA_ALPHA_LONG_2", "DATA_ALPHA_LONG_3", "DATA_ALPHA_LONG_4", "DATA_ALPHA_LONG_5", "DATA_INTEGER_1", "DATA_INTEGER_2", "DATA_INTEGER_3", "DATA_INTEGER_4", "DATA_INTEGER_5", "DATA_BOOLEAN_1", "DATA_BOOLEAN_2", "DATA_BOOLEAN_3", "DATA_BOOLEAN_4", "DATA_BOOLEAN_5", "DATA_DEC_1", "DATA_DEC_2", "DATA_DEC_3", "DATA_DEC_4", "DATA_DEC_5", "DIC_UNIT_OF_MEASURE_ID", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_ACCOUNTABLE_GROUP_WORDING", "DIC_GOOD_LINE_ID", "DIC_GOOD_LINE_WORDING", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_FAMILY_WORDING", "DIC_GOOD_MODEL_ID", "DIC_GOOD_MODEL_WORDING", "DIC_GOOD_GROUP_ID", "DIC_GOOD_GROUP_WORDING", "C_MANAGEMENT_MODE", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE", "GOO_CCP_MANAGEMENT", "GOO_NUMBER_OF_DECIMAL", "GOO_BASE_COST_PRICE", "GOO_ADDED_QTY_COST_PRICE", "GOO_ADDED_VALUE_COST_PRICE", "GCO_DATA_PURCHASE", "GCO_DATA_SALE", "GCO_DATA_STOCK", "GCO_DATA_INVENTORY", "GCO_DATA_MANUFACTURE", "GCO_DATA_SUBCONTRACT", "GCO_DATA_SAV", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GCO_STATISTIC_10_ID", "GOO_EAN_CODE_AUTO_GEN", "GCO_PRODUCT_GROUP_ID", "GOO_OBSOLETE", "GOO_PRECIOUS_MAT", "DIC_PTC_GOOD_GROUP_ID", "GOO_TO_PUBLISH", "GCO_GOOD_OLE_OBJECT", "DIC_PUR_TARIFF_STRUCT_ID", "DIC_SALE_TARIFF_STRUCT_ID", "DIC_COMMISSIONING_ID", "C_GOO_WEB_STATUS", "DIC_GOO_WEB_CATEG1_ID", "DIC_GOO_WEB_CATEG2_ID", "DIC_GOO_WEB_CATEG3_ID", "DIC_GOO_WEB_CATEG4_ID", "GOO_WEB_PUBLISHED", "GOO_WEB_ALIAS", "GOO_WEB_PICTURE_URL", "GOO_WEB_ATTACHEMENT_URL", "GOO_UNSPSC", "GOO_INNOVATION_FROM", "GOO_INNOVATION_TO", "GOO_STD_PERCENT_WASTE", "GOO_STD_FIXED_QUANTITY_WASTE", "GOO_STD_QTY_REFERENCE_LOSS", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "DIC_TARIFF_SET_PURCHASE_ID", "DIC_TARIFF_SET_SALE_ID") AS
  select GCO.GCO_GOOD_ID
       , GCO.C_GOOD_STATUS
       , GCO.GCO_GOOD_CATEGORY_ID
       , CAT.GCO_REFERENCE_TEMPLATE_ID
       , GCO_REFERENCE_TEMPLATE.RTE_DESIGNATION
       , GCO_REFERENCE_TEMPLATE.RTE_DESCRIPTION
       , GCO_REFERENCE_TEMPLATE.RTE_FORMAT
       , CAT.GCO_GOOD_CATEGORY_WORDING
       , CAT.GCO_CATEGORY_CODE
       , CAT.DIC_CATEGORY_FREE_1_ID
       , CAT.DIC_CATEGORY_FREE_2_ID
       , CAT.CAT_FREE_TEXT_1
       , CAT.CAT_FREE_TEXT_2
       , CAT.CAT_FREE_TEXT_3
       , CAT.CAT_FREE_TEXT_4
       , CAT.CAT_FREE_TEXT_5
       , CAT.CAT_FREE_NUMBER_1
       , CAT.CAT_FREE_NUMBER_2
       , CAT.CAT_FREE_NUMBER_3
       , CAT.CAT_FREE_NUMBER_4
       , CAT.CAT_FREE_NUMBER_5
       , CAT_EAN_GOO_UCC14
       , CAT_EAN_ASA_UCC14
       , CAT_EAN_FAL_UCC14
       , CAT_EAN_INV_UCC14
       , CAT_EAN_PUR_UCC14
       , CAT_EAN_SAL_UCC14
       , CAT_EAN_STK_UCC14
       , CAT_EAN_SUB_UCC14
       , CAT_EAN_DIU_UCC14
       , CAT_HIBC_MANAGEMENT
       , GCO.GCO_MULTIMEDIA_ELEMENT_ID
       , GCO_MULTIMEDIA_ELEMENT.MME_MULTIMEDIA_DESIGNATION
       , GCO_MULTIMEDIA_ELEMENT.MME_FREE_DESCRIPTION
       , GCO.GCO_SUBSTITUTION_LIST_ID
       , GCO_SUBSTITUTION_LIST.SUL_SUBSTITUTION_LIST_DESIGN SUL_SUBST_DESIGN_SHORT
       , GCO_SUBSTITUTION_LIST.SUL_DESIGN SUL_SUBST_DESIGN_LONG
       , GCO_SUBSTITUTION_LIST.SUL_COMMENT
       , GCO_SUBSTITUTION_LIST.SUL_FROM_DATE
       , GCO_SUBSTITUTION_LIST.SUL_UNTIL_DATE
       , GCO_SUBSTITUTION_LIST.GCO_GOOD_ID SUL_REPLACEMENT_GOOD_ID
       , GCO_FREE_DATA.DIC_FREE_TABLE_1_ID
       , GCO_FREE_DATA.DIC_FREE_TABLE_2_ID
       , GCO_FREE_DATA.DIC_FREE_TABLE_3_ID
       , GCO_FREE_DATA.DIC_FREE_TABLE_4_ID
       , GCO_FREE_DATA.DIC_FREE_TABLE_5_ID
       , GCO_FREE_DATA.DATA_ALPHA_COURT_1
       , GCO_FREE_DATA.DATA_ALPHA_COURT_2
       , GCO_FREE_DATA.DATA_ALPHA_COURT_3
       , GCO_FREE_DATA.DATA_ALPHA_COURT_4
       , GCO_FREE_DATA.DATA_ALPHA_COURT_5
       , GCO_FREE_DATA.DATA_ALPHA_LONG_1
       , GCO_FREE_DATA.DATA_ALPHA_LONG_2
       , GCO_FREE_DATA.DATA_ALPHA_LONG_3
       , GCO_FREE_DATA.DATA_ALPHA_LONG_4
       , GCO_FREE_DATA.DATA_ALPHA_LONG_5
       , GCO_FREE_DATA.DATA_INTEGER_1
       , GCO_FREE_DATA.DATA_INTEGER_2
       , GCO_FREE_DATA.DATA_INTEGER_3
       , GCO_FREE_DATA.DATA_INTEGER_4
       , GCO_FREE_DATA.DATA_INTEGER_5
       , GCO_FREE_DATA.DATA_BOOLEAN_1
       , GCO_FREE_DATA.DATA_BOOLEAN_2
       , GCO_FREE_DATA.DATA_BOOLEAN_3
       , GCO_FREE_DATA.DATA_BOOLEAN_4
       , GCO_FREE_DATA.DATA_BOOLEAN_5
       , GCO_FREE_DATA.DATA_DEC_1
       , GCO_FREE_DATA.DATA_DEC_2
       , GCO_FREE_DATA.DATA_DEC_3
       , GCO_FREE_DATA.DATA_DEC_4
       , GCO_FREE_DATA.DATA_DEC_5
       , GCO.DIC_UNIT_OF_MEASURE_ID
       , GCO.DIC_ACCOUNTABLE_GROUP_ID
       , DIC_ACCOUNTABLE_GROUP.DIC_ACCOUNTABLE_GROUP_WORDING
       , GCO.DIC_GOOD_LINE_ID
       , DIC_GOOD_LINE.DIC_GOOD_LINE_WORDING
       , GCO.DIC_GOOD_FAMILY_ID
       , DIC_GOOD_FAMILY.DIC_GOOD_FAMILY_WORDING
       , GCO.DIC_GOOD_MODEL_ID
       , DIC_GOOD_MODEL.DIC_GOOD_MODEL_WORDING
       , GCO.DIC_GOOD_GROUP_ID
       , DIC_GOOD_GROUP.DIC_GOOD_GROUP_WORDING
       , GCO.C_MANAGEMENT_MODE
       , GCO.GOO_MAJOR_REFERENCE
       , GCO.GOO_SECONDARY_REFERENCE
       , GCO.GOO_EAN_CODE
       , GCO.GOO_CCP_MANAGEMENT
       , GCO.GOO_NUMBER_OF_DECIMAL
       , GCO_GOOD_CALC_DATA.GOO_BASE_COST_PRICE
       , GCO_GOOD_CALC_DATA.GOO_ADDED_QTY_COST_PRICE
       , GCO_GOOD_CALC_DATA.GOO_ADDED_VALUE_COST_PRICE
       , GCO.GCO_DATA_PURCHASE
       , GCO.GCO_DATA_SALE
       , GCO.GCO_DATA_STOCK
       , GCO.GCO_DATA_INVENTORY
       , GCO.GCO_DATA_MANUFACTURE
       , GCO.GCO_DATA_SUBCONTRACT
       , GCO.GCO_DATA_SAV
       , GCO.DIC_GCO_STATISTIC_1_ID
       , GCO.DIC_GCO_STATISTIC_2_ID
       , GCO.DIC_GCO_STATISTIC_3_ID
       , GCO.DIC_GCO_STATISTIC_4_ID
       , GCO.DIC_GCO_STATISTIC_5_ID
       , GCO.DIC_GCO_STATISTIC_6_ID
       , GCO.DIC_GCO_STATISTIC_7_ID
       , GCO.DIC_GCO_STATISTIC_8_ID
       , GCO.DIC_GCO_STATISTIC_9_ID
       , GCO.DIC_GCO_STATISTIC_10_ID
       , GCO.GOO_EAN_CODE_AUTO_GEN
       , GCO.GCO_PRODUCT_GROUP_ID
       , GCO.GOO_OBSOLETE
       , GCO.GOO_PRECIOUS_MAT
       , GCO.DIC_PTC_GOOD_GROUP_ID
       , GCO.GOO_TO_PUBLISH
       , GCO.GCO_GOOD_OLE_OBJECT
       , GCO.DIC_PUR_TARIFF_STRUCT_ID
       , GCO.DIC_SALE_TARIFF_STRUCT_ID
       , GCO.DIC_COMMISSIONING_ID
       , GCO.C_GOO_WEB_STATUS
       , GCO.DIC_GOO_WEB_CATEG1_ID
       , GCO.DIC_GOO_WEB_CATEG2_ID
       , GCO.DIC_GOO_WEB_CATEG3_ID
       , GCO.DIC_GOO_WEB_CATEG4_ID
       , GCO.GOO_WEB_PUBLISHED
       , GCO.GOO_WEB_ALIAS
       , GCO.GOO_WEB_PICTURE_URL
       , GCO.GOO_WEB_ATTACHEMENT_URL
       , GCO.GOO_UNSPSC
       , GCO.GOO_INNOVATION_FROM
       , GCO.GOO_INNOVATION_TO
       , GCO.GOO_STD_PERCENT_WASTE
       , GCO.GOO_STD_FIXED_QUANTITY_WASTE
       , GCO.GOO_STD_QTY_REFERENCE_LOSS
       , GCO.GOO_HIBC_PRIMARY_CODE
       , GCO.GOO_HIBC_REFERENCE
       , GCO.GOO_EAN_UCC14_CODE
       , GCO.A_DATECRE
       , GCO.A_DATEMOD
       , GCO.A_IDCRE
       , GCO.A_IDMOD
       , GCO.DIC_TARIFF_SET_PURCHASE_ID
       , GCO.DIC_TARIFF_SET_SALE_ID
    from GCO_GOOD GCO
       , GCO_GOOD_CALC_DATA
       , GCO_GOOD_CATEGORY CAT
       , GCO_REFERENCE_TEMPLATE
       , GCO_MULTIMEDIA_ELEMENT
       , GCO_SUBSTITUTION_LIST
       , GCO_FREE_DATA
       , DIC_ACCOUNTABLE_GROUP
       , DIC_GOOD_LINE
       , DIC_GOOD_FAMILY
       , DIC_GOOD_MODEL
       , DIC_GOOD_GROUP
   where GCO.GCO_GOOD_CATEGORY_ID = CAT.GCO_GOOD_CATEGORY_ID
     and CAT.GCO_REFERENCE_TEMPLATE_ID = GCO_REFERENCE_TEMPLATE.GCO_REFERENCE_TEMPLATE_ID(+)
     and GCO.GCO_MULTIMEDIA_ELEMENT_ID = GCO_MULTIMEDIA_ELEMENT.GCO_MULTIMEDIA_ELEMENT_ID(+)
     and GCO.GCO_SUBSTITUTION_LIST_ID = GCO_SUBSTITUTION_LIST.GCO_SUBSTITUTION_LIST_ID(+)
     and GCO.GCO_GOOD_ID = GCO_FREE_DATA.GCO_GOOD_ID(+)
     and GCO.GCO_GOOD_ID = GCO_GOOD_CALC_DATA.GCO_GOOD_ID(+)
     and GCO.DIC_ACCOUNTABLE_GROUP_ID = DIC_ACCOUNTABLE_GROUP.DIC_ACCOUNTABLE_GROUP_ID(+)
     and GCO.DIC_GOOD_LINE_ID = DIC_GOOD_LINE.DIC_GOOD_LINE_ID(+)
     and GCO.DIC_GOOD_FAMILY_ID = DIC_GOOD_FAMILY.DIC_GOOD_FAMILY_ID(+)
     and GCO.DIC_GOOD_MODEL_ID = DIC_GOOD_MODEL.DIC_GOOD_MODEL_ID(+)
     and GCO.DIC_GOOD_GROUP_ID = DIC_GOOD_GROUP.DIC_GOOD_GROUP_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_GOOD_MIN_STOCK" ("GCO_GOOD_ID", "CST_QUANTITY_MIN") AS
  SELECT
     A.GCO_GOOD_ID,
     SUM(A.CST_QUANTITY_MIN) CST_QUANTITY_MIN
 FROM
     GCO_COMPL_DATA_STOCK A,
     STM_STOCK B
 WHERE
     A.STM_STOCK_ID = B.STM_STOCK_ID AND
     B.STO_NEED_CALCULATION=1
 GROUP BY
     A.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_GOOD_MIN_STOCK_BY_STOCK" ("GCO_GOOD_ID", "STM_STOCK_ID", "CST_QUANTITY_MIN") AS
  SELECT
     A.GCO_GOOD_ID,
     A.STM_STOCK_ID,
     SUM(A.CST_QUANTITY_MIN) CST_QUANTITY_MIN
 FROM
     GCO_COMPL_DATA_STOCK A,
     STM_STOCK B
 WHERE
     A.STM_STOCK_ID = B.STM_STOCK_ID AND
     B.STO_NEED_CALCULATION=1
 GROUP BY
     A.GCO_GOOD_ID,
     A.STM_STOCK_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_MULTIMEDIA_ITEM" ("GCO_GOOD_ID", "C_GOOD_STATUS", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "GOO_CCP_MANAGEMENT", "GOO_NUMBER_OF_DECIMAL", "GCO_MULTIMEDIA_ELEMENT_IDENT", "MME_MULTIMEDIA_DESIGNATION", "MME_FREE_DESCRIPTION", "MME_PRESENTATION_ELEMENT", "GCO_MULTIMEDIA_DATA_IDENT", "C_MULTIMEDIA_TYPE", "MMD_LEGEND", "GCO_FILE_NAME_MULTIMEDIA") AS
  select GCO_GOOD.GCO_GOOD_ID
       , GCO_GOOD.C_GOOD_STATUS
       , GCO_GOOD.GOO_MAJOR_REFERENCE
       , GCO_GOOD.GOO_SECONDARY_REFERENCE
       , GCO_GOOD.GOO_EAN_CODE
       , GCO_GOOD.GOO_HIBC_PRIMARY_CODE
       , GCO_GOOD.GOO_HIBC_REFERENCE
       , GCO_GOOD.GOO_EAN_UCC14_CODE
       , GCO_GOOD.GOO_CCP_MANAGEMENT
       , GCO_GOOD.GOO_NUMBER_OF_DECIMAL
       , GCO_MULTIMEDIA_ELEMENT.GCO_MULTIMEDIA_ELEMENT_ID as GCO_MULTIMEDIA_ELEMENT_IDENT
       , GCO_MULTIMEDIA_ELEMENT.MME_MULTIMEDIA_DESIGNATION
       , GCO_MULTIMEDIA_ELEMENT.MME_FREE_DESCRIPTION
       , GCO_MULTIMEDIA_ELEMENT.MME_PRESENTATION_ELEMENT
       , GCO_MULTIMEDIA_DATA.GCO_MULTIMEDIA_DATA_ID as GCO_MULTIMEDIA_DATA_IDENT
       , GCO_MULTIMEDIA_DATA.C_MULTIMEDIA_TYPE
       , GCO_MULTIMEDIA_DATA.MMD_LEGEND
       , to_char(GCO_MULTIMEDIA_ELEMENT.GCO_MULTIMEDIA_ELEMENT_ID) ||
         '_' ||
         to_char(GCO_MULTIMEDIA_DATA.GCO_MULTIMEDIA_DATA_ID) ||
         '.' ||
         GCO_MULTIMEDIA_DATA.C_MULTIMEDIA_TYPE as GCO_FILE_NAME_MULTIMEDIA
    from GCO_GOOD
       , GCO_MULTIMEDIA_ELEMENT
       , GCO_MULTIMEDIA_DATA
   where GCO_MULTIMEDIA_ELEMENT.GCO_MULTIMEDIA_ELEMENT_ID = GCO_GOOD.GCO_MULTIMEDIA_ELEMENT_ID
     and GCO_MULTIMEDIA_DATA.GCO_MULTIMEDIA_ELEMENT_ID = GCO_MULTIMEDIA_ELEMENT.GCO_MULTIMEDIA_ELEMENT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_PRODUCT_LIST" ("GCO_GOOD_ID", "STM_STOCK_ID", "PDT_FULL_TRACABILITY", "STO_CLASSIFICATION", "STO_DESCRIPTION", "STO_FREE_DESCRIPTION", "C_ACCESS_METHOD", "STM_LOCATION_ID", "LOC_CLASSIFICATION", "LOC_DESCRIPTION", "LOC_FREE_DESCRIPTION", "LOC_LOCATION_MANAGEMENT", "LOC_FULL_LOCATION", "DIC_SHAPE_TYPE_ID", "MEA_NET_HEIGHT", "MEA_NET_LENGTH", "MEA_NET_DEPTH", "MEA_NET_WEIGHT", "MEA_GROSS_HEIGHT", "MEA_GROSS_LENGTH", "MEA_GROSS_DEPTH", "MEA_GROSS_WEIGHT", "PC_CNTRY_ID", "CNTID", "CNTNAME", "CUS_CUSTONS_POSITION", "CUS_TRANSPORT_INFORMATION", "C_SUPPLY_MODE", "C_SUPPLY_MODE_WORDING1", "C_PRODUCT_TYPE", "PDT_STOCK_MANAGEMENT", "PDT_THRESHOLD_MANAGEMENT", "PDT_STOCK_OBTAIN_MANAGEMENT", "PDT_CALC_REQUIREMENT_MNGMENT", "PDT_CONTINUOUS_INVENTAR", "PDT_PIC", "PDT_FACT_STOCK", "PDT_BLOCK_EQUI", "PDT_GUARANTY_USE", "PDT_END_LIFE", "PC_LANG_ID", "PDT_ALTERNATIVE_QUANTITY_1", "DIC_UNIT_OF_MEASURE_ID", "DIC_UNIT_OF_MEASURE_WORDING", "PDT_CONVERSION_FACTOR_1", "PDT_ALTERNATIVE_QUANTITY_2", "DIC_UNIT_OF_MEASURE1_ID", "DIC_UNIT_OF_MEASURE1_WORDING", "PDT_CONVERSION_FACTOR_2", "PDT_ALTERNATIVE_QUANTITY_3", "DIC_UNIT_OF_MEASURE2_ID", "DIC_UNIT_OF_MEASURE2_WORDING", "PDT_CONVERSION_FACTOR_3", "GCO_GCO_SERVICE_ID", "GCO_SERVICE_MAJOR_REFERENCE", "GCO_SERVICE_SEC_REFERENCE", "PDT_MARK_NOMENCLATURE", "PDT_MARK_USED", "PDT_STOCK_ALLOC_BATCH", "PDT_SCALE_LINK", "PDT_FULL_TRACABILITY_COEF", "PDT_FULL_TRACABILITY_SUPPLY", "PDT_FULL_TRACABILITY_RULE", "C_SUPPLY_TYPE", "PDT_MULTI_SOURCING", "C_PRODUCT_DELIVERY_TYP", "DIC_DEL_TYP_EXPLAIN_ID", "PAC_SUPPLIER_PARTNER_ID", "GCO_DANGEROUS_TRANSP_ADR_ID", "GTD_REFERENCE_ADR", "GCO_DANGEROUS_TRANSP_IATA_ID", "GTD_REFERENCE_IATA", "GCO_DANGEROUS_TRANSP_IMDG_ID", "GTD_REFERENCE_IMDG") AS
  select GCO_PRODUCT.GCO_GOOD_ID
       , GCO_PRODUCT.STM_STOCK_ID STM_STOCK_ID
       , GCO_PRODUCT.PDT_FULL_TRACABILITY
       , STM_STOCK.STO_CLASSIFICATION
       , STM_STOCK.STO_DESCRIPTION
       , STM_STOCK.STO_FREE_DESCRIPTION
       , STM_STOCK.C_ACCESS_METHOD
       , GCO_PRODUCT.STM_LOCATION_ID STM_LOCATION_ID
       , STM_LOCATION.LOC_CLASSIFICATION
       , STM_LOCATION.LOC_DESCRIPTION
       , STM_LOCATION.LOC_FREE_DESCRIPTION
       , STM_LOCATION.LOC_LOCATION_MANAGEMENT
       , STM_LOCATION.LOC_FULL_LOCATION
       , GCO_MEASUREMENT_WEIGHT.DIC_SHAPE_TYPE_ID
       , GCO_MEASUREMENT_WEIGHT.MEA_NET_HEIGHT
       , GCO_MEASUREMENT_WEIGHT.MEA_NET_LENGTH
       , GCO_MEASUREMENT_WEIGHT.MEA_NET_DEPTH
       , GCO_MEASUREMENT_WEIGHT.MEA_NET_WEIGHT
       , GCO_MEASUREMENT_WEIGHT.MEA_GROSS_HEIGHT
       , GCO_MEASUREMENT_WEIGHT.MEA_GROSS_LENGTH
       , GCO_MEASUREMENT_WEIGHT.MEA_GROSS_DEPTH
       , GCO_MEASUREMENT_WEIGHT.MEA_GROSS_WEIGHT
       , GCO_CUSTOMS_ELEMENT.PC_CNTRY_ID
       , PC_CNTRY.CNTID
       , PC_CNTRY.CNTNAME
       , GCO_CUSTOMS_ELEMENT.CUS_CUSTONS_POSITION
       , GCO_CUSTOMS_ELEMENT.CUS_TRANSPORT_INFORMATION
       , GCO_PRODUCT.C_SUPPLY_MODE
       , V_PC_DESCODES1.GCDTEXT1 C_SUPPLY_MODE_WORDING1
       , GCO_PRODUCT.C_PRODUCT_TYPE
       , GCO_PRODUCT.PDT_STOCK_MANAGEMENT
       , GCO_PRODUCT.PDT_THRESHOLD_MANAGEMENT
       , GCO_PRODUCT.PDT_STOCK_OBTAIN_MANAGEMENT
       , GCO_PRODUCT.PDT_CALC_REQUIREMENT_MNGMENT
       , GCO_PRODUCT.PDT_CONTINUOUS_INVENTAR
       , GCO_PRODUCT.PDT_PIC
       , GCO_PRODUCT.PDT_FACT_STOCK
       , GCO_PRODUCT.PDT_BLOCK_EQUI
       , GCO_PRODUCT.PDT_GUARANTY_USE
       , GCO_PRODUCT.PDT_END_LIFE
       , V_PC_DESCODES1.PC_LANG_ID
       , GCO_PRODUCT.PDT_ALTERNATIVE_QUANTITY_1
       , GCO_PRODUCT.DIC_UNIT_OF_MEASURE_ID
       , DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_WORDING
       , GCO_PRODUCT.PDT_CONVERSION_FACTOR_1
       , GCO_PRODUCT.PDT_ALTERNATIVE_QUANTITY_2
       , GCO_PRODUCT.DIC_UNIT_OF_MEASURE1_ID
       , DIC_UNIT_OF_MEASURE1.DIC_UNIT_OF_MEASURE_WORDING DIC_UNIT_OF_MEASURE1_WORDING
       , GCO_PRODUCT.PDT_CONVERSION_FACTOR_2
       , GCO_PRODUCT.PDT_ALTERNATIVE_QUANTITY_3
       , GCO_PRODUCT.DIC_UNIT_OF_MEASURE2_ID
       , DIC_UNIT_OF_MEASURE2.DIC_UNIT_OF_MEASURE_WORDING DIC_UNIT_OF_MEASURE2_WORDING
       , GCO_PRODUCT.PDT_CONVERSION_FACTOR_3
       , GCO_PRODUCT.GCO_GCO_SERVICE_ID
       , GCO_GOOD.GOO_MAJOR_REFERENCE GCO_SERVICE_MAJOR_REFERENCE
       , GCO_GOOD.GOO_SECONDARY_REFERENCE GCO_SERVICE_SEC_REFERENCE
       , PDT_MARK_NOMENCLATURE
       , PDT_MARK_USED
       , PDT_STOCK_ALLOC_BATCH
       , PDT_SCALE_LINK
       , PDT_FULL_TRACABILITY_COEF
       , PDT_FULL_TRACABILITY_SUPPLY
       , PDT_FULL_TRACABILITY_RULE
       , C_SUPPLY_TYPE
       , PDT_MULTI_SOURCING
       , GCO_PRODUCT.C_PRODUCT_DELIVERY_TYP
       , GCO_PRODUCT.DIC_DEL_TYP_EXPLAIN_ID
       , GCO_PRODUCT.PAC_SUPPLIER_PARTNER_ID
       , GCO_PRODUCT.GCO_DANGEROUS_TRANSP_ADR_ID
       , GCO_DANGEROUS_TRANSP_ADR.GTD_REFERENCE GTD_REFERENCE_ADR
       , GCO_PRODUCT.GCO_DANGEROUS_TRANSP_IATA_ID
       , GCO_DANGEROUS_TRANSP_IATA.GTD_REFERENCE GTD_REFERENCE_IATA
       , GCO_PRODUCT.GCO_DANGEROUS_TRANSP_IMDG_ID
       , GCO_DANGEROUS_TRANSP_IMDG.GTD_REFERENCE GTD_REFERENCE_IMDG
    from GCO_PRODUCT
       , STM_STOCK
       , STM_LOCATION
       , GCO_MEASUREMENT_WEIGHT
       , GCO_GOOD
       , GCO_CUSTOMS_ELEMENT
       , PCS.PC_CNTRY
       , PCS.V_PC_DESCODES V_PC_DESCODES1
       , DIC_UNIT_OF_MEASURE
       , DIC_UNIT_OF_MEASURE DIC_UNIT_OF_MEASURE1
       , DIC_UNIT_OF_MEASURE DIC_UNIT_OF_MEASURE2
       , GCO_DANGEROUS_TRANSP GCO_DANGEROUS_TRANSP_ADR
       , GCO_DANGEROUS_TRANSP GCO_DANGEROUS_TRANSP_IATA
       , GCO_DANGEROUS_TRANSP GCO_DANGEROUS_TRANSP_IMDG
   where GCO_PRODUCT.STM_STOCK_ID = STM_STOCK.STM_STOCK_ID(+)
     and GCO_PRODUCT.STM_LOCATION_ID = STM_LOCATION.STM_LOCATION_ID(+)
     and GCO_PRODUCT.GCO_GOOD_ID = GCO_MEASUREMENT_WEIGHT.GCO_GOOD_ID(+)
     and GCO_PRODUCT.GCO_GOOD_ID = GCO_CUSTOMS_ELEMENT.GCO_GOOD_ID(+)
     and GCO_CUSTOMS_ELEMENT.PC_CNTRY_ID = PCS.PC_CNTRY.PC_CNTRY_ID(+)
     and V_PC_DESCODES1.GCGNAME = 'C_SUPPLY_MODE'
     and V_PC_DESCODES1.GCLCODE = GCO_PRODUCT.C_SUPPLY_MODE
     and GCO_PRODUCT.DIC_UNIT_OF_MEASURE_ID = DIC_UNIT_OF_MEASURE.DIC_UNIT_OF_MEASURE_ID(+)
     and GCO_PRODUCT.DIC_UNIT_OF_MEASURE1_ID = DIC_UNIT_OF_MEASURE1.DIC_UNIT_OF_MEASURE_ID(+)
     and GCO_PRODUCT.DIC_UNIT_OF_MEASURE2_ID = DIC_UNIT_OF_MEASURE2.DIC_UNIT_OF_MEASURE_ID(+)
     and GCO_PRODUCT.GCO_GCO_SERVICE_ID = GCO_GOOD.GCO_GOOD_ID(+)
     and GCO_PRODUCT.GCO_DANGEROUS_TRANSP_ADR_ID = GCO_DANGEROUS_TRANSP_ADR.GCO_DANGEROUS_TRANSP_ID(+)
     and GCO_PRODUCT.GCO_DANGEROUS_TRANSP_IATA_ID = GCO_DANGEROUS_TRANSP_IATA.GCO_DANGEROUS_TRANSP_ID(+)
     and GCO_PRODUCT.GCO_DANGEROUS_TRANSP_IMDG_ID = GCO_DANGEROUS_TRANSP_IMDG.GCO_DANGEROUS_TRANSP_ID(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GCO_VAT_GOOD" ("GCO_GOOD_ID", "PC_LANG_ID", "DES_DESCRIPTION_SUMMARY", "DIC_TYPE_VAT_GOOD_ID", "DIC_DESCRIPTION") AS
  select
  GCO_VAT_GOOD.GCO_GOOD_ID, ACS_DESCRIPTION.PC_LANG_ID,
  ACS_DESCRIPTION.DES_DESCRIPTION_SUMMARY, DIC_TYPE_VAT_GOOD.DIC_TYPE_VAT_GOOD_ID,
  DIC_TYPE_VAT_GOOD.DIC_DESCRIPTION
from
  GCO_VAT_GOOD, DIC_TYPE_VAT_GOOD, ACS_VAT_DET_ACCOUNT, ACS_DESCRIPTION
where
  GCO_VAT_GOOD.DIC_TYPE_VAT_GOOD_ID = DIC_TYPE_VAT_GOOD.DIC_TYPE_VAT_GOOD_ID
  and GCO_VAT_GOOD.ACS_VAT_DET_ACCOUNT_ID = ACS_VAT_DET_ACCOUNT.ACS_VAT_DET_ACCOUNT_ID
  and ACS_VAT_DET_ACCOUNT.ACS_VAT_DET_ACCOUNT_ID = ACS_DESCRIPTION.ACS_VAT_DET_ACCOUNT_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_GOOD_DESCRIPTION" ("GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "DIC_UNIT_OF_MEASURE_ID", "GOO_NUMBER_OF_DECIMAL", "C_DESCRIPTION_TYPE", "PC_LANG_ID", "DES_SHORT_DESCRIPTION", "DES_LONG_DESCRIPTION", "DES_FREE_DESCRIPTION", "C_DESCR_TYPE_ST", "DES_SHORT_DESCR_ST", "DES_LONG_DESCR_ST", "DES_FREE_DESCR_ST", "C_DESCR_PU", "DES_SHORT_DESCR_PU", "DES_LONG_DESCR_PU", "DES_FREE_DESCR_PU", "C_DESCR_SA", "DES_SHORT_DESCR_SA", "DES_LONG_DESCR_SA", "DES_FREE_DESCR_SA", "C_DESCR_FA", "DES_SHORT_DESCR_FA", "DES_LONG_DESCR_FA", "DES_FREE_DESCR_FA", "C_DESCR_SO", "DES_SHORT_DESCR_SO", "DES_LONG_DESCR_SO", "DES_FREE_DESCR_SO", "C_DESCR_SV", "DES_SHORT_DESCR_SV", "DES_LONG_DESCR_SV", "DES_FREE_DESCR_SV", "C_DESCR_IN", "DES_SHORT_DESCR_IN", "DES_LONG_DESCR_IN", "DES_FREE_DESCR_IN", "C_DESCR_CA", "DES_SHORT_DESCR_CA", "DES_LONG_DESCR_CA", "DES_FREE_DESCR_CA", "C_DESCR_TK", "DES_SHORT_DESCR_TK", "DES_LONG_DESCR_TK", "DES_FREE_DESCR_TK", "C_DESCR_IV", "DES_SHORT_DESCR_IV", "DES_LONG_DESCR_IV", "DES_FREE_DESCR_IV") AS
  select GCO_GOOD.GCO_GOOD_ID
       , GCO_GOOD.GOO_MAJOR_REFERENCE
       , GCO_GOOD.GOO_SECONDARY_REFERENCE
       , GCO_GOOD.DIC_UNIT_OF_MEASURE_ID
       , GCO_GOOD.GOO_NUMBER_OF_DECIMAL
       , GCO_DESCRIPTION.C_DESCRIPTION_TYPE
       , GCO_DESCRIPTION.PC_LANG_ID
       , GCO_DESCRIPTION.DES_SHORT_DESCRIPTION
       , GCO_DESCRIPTION.DES_LONG_DESCRIPTION
       , GCO_DESCRIPTION.DES_FREE_DESCRIPTION
       , GCO_DESCRIPTION_ST.C_DESCRIPTION_TYPE C_DESCR_TYPE_ST
       , GCO_DESCRIPTION_ST.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_ST
       , GCO_DESCRIPTION_ST.DES_LONG_DESCRIPTION DES_LONG_DESCR_ST
       , GCO_DESCRIPTION_ST.DES_FREE_DESCRIPTION DES_FREE_DESCR_ST
       , GCO_DESCRIPTION_PU.C_DESCRIPTION_TYPE C_DESCR_PU
       , GCO_DESCRIPTION_PU.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_PU
       , GCO_DESCRIPTION_PU.DES_LONG_DESCRIPTION DES_LONG_DESCR_PU
       , GCO_DESCRIPTION_PU.DES_FREE_DESCRIPTION DES_FREE_DESCR_PU
       , GCO_DESCRIPTION_SA.C_DESCRIPTION_TYPE C_DESCR_SA
       , GCO_DESCRIPTION_SA.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_SA
       , GCO_DESCRIPTION_SA.DES_LONG_DESCRIPTION DES_LONG_DESCR_SA
       , GCO_DESCRIPTION_SA.DES_FREE_DESCRIPTION DES_FREE_DESCR_SA
       , GCO_DESCRIPTION_FA.C_DESCRIPTION_TYPE C_DESCR_FA
       , GCO_DESCRIPTION_FA.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_FA
       , GCO_DESCRIPTION_FA.DES_LONG_DESCRIPTION DES_LONG_DESCR_FA
       , GCO_DESCRIPTION_FA.DES_FREE_DESCRIPTION DES_FREE_DESCR_FA
       , GCO_DESCRIPTION_SO.C_DESCRIPTION_TYPE C_DESCR_SO
       , GCO_DESCRIPTION_SO.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_SO
       , GCO_DESCRIPTION_SO.DES_LONG_DESCRIPTION DES_LONG_DESCR_SO
       , GCO_DESCRIPTION_SO.DES_FREE_DESCRIPTION DES_FREE_DESCR_SO
       , GCO_DESCRIPTION_SV.C_DESCRIPTION_TYPE C_DESCR_SV
       , GCO_DESCRIPTION_SV.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_SV
       , GCO_DESCRIPTION_SV.DES_LONG_DESCRIPTION DES_LONG_DESCR_SV
       , GCO_DESCRIPTION_SV.DES_FREE_DESCRIPTION DES_FREE_DESCR_SV
       , GCO_DESCRIPTION_IN.C_DESCRIPTION_TYPE C_DESCR_IN
       , GCO_DESCRIPTION_IN.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_IN
       , GCO_DESCRIPTION_IN.DES_LONG_DESCRIPTION DES_LONG_DESCR_IN
       , GCO_DESCRIPTION_IN.DES_FREE_DESCRIPTION DES_FREE_DESCR_IN
       , GCO_DESCRIPTION_CA.C_DESCRIPTION_TYPE C_DESCR_CA
       , GCO_DESCRIPTION_CA.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_CA
       , GCO_DESCRIPTION_CA.DES_LONG_DESCRIPTION DES_LONG_DESCR_CA
       , GCO_DESCRIPTION_CA.DES_FREE_DESCRIPTION DES_FREE_DESCR_CA
       , GCO_DESCRIPTION_TK.C_DESCRIPTION_TYPE C_DESCR_TK
       , GCO_DESCRIPTION_TK.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_TK
       , GCO_DESCRIPTION_TK.DES_LONG_DESCRIPTION DES_LONG_DESCR_TK
       , GCO_DESCRIPTION_TK.DES_FREE_DESCRIPTION DES_FREE_DESCR_TK
       , GCO_DESCRIPTION_IV.C_DESCRIPTION_TYPE C_DESCR_IV
       , GCO_DESCRIPTION_IV.DES_SHORT_DESCRIPTION DES_SHORT_DESCR_IV
       , GCO_DESCRIPTION_IV.DES_LONG_DESCRIPTION DES_LONG_DESCR_IV
       , GCO_DESCRIPTION_IV.DES_FREE_DESCRIPTION DES_FREE_DESCR_IV
    from GCO_GOOD
       , GCO_DESCRIPTION
       , GCO_DESCRIPTION GCO_DESCRIPTION_ST
       , GCO_DESCRIPTION GCO_DESCRIPTION_PU
       , GCO_DESCRIPTION GCO_DESCRIPTION_SA
       , GCO_DESCRIPTION GCO_DESCRIPTION_FA
       , GCO_DESCRIPTION GCO_DESCRIPTION_SO
       , GCO_DESCRIPTION GCO_DESCRIPTION_SV
       , GCO_DESCRIPTION GCO_DESCRIPTION_IN
       , GCO_DESCRIPTION GCO_DESCRIPTION_CA
       , GCO_DESCRIPTION GCO_DESCRIPTION_TK
       , GCO_DESCRIPTION GCO_DESCRIPTION_IV
   where GCO_GOOD.GCO_GOOD_ID = GCO_DESCRIPTION.GCO_GOOD_ID
     and GCO_DESCRIPTION.C_DESCRIPTION_TYPE = 1
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_ST.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_ST.PC_LANG_ID(+)
     and GCO_DESCRIPTION_ST.C_DESCRIPTION_TYPE(+) = 2
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_PU.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_PU.PC_LANG_ID(+)
     and GCO_DESCRIPTION_PU.C_DESCRIPTION_TYPE(+) = 3
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_SA.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_SA.PC_LANG_ID(+)
     and GCO_DESCRIPTION_SA.C_DESCRIPTION_TYPE(+) = 4
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_FA.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_FA.PC_LANG_ID(+)
     and GCO_DESCRIPTION_FA.C_DESCRIPTION_TYPE(+) = 5
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_SO.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_SO.PC_LANG_ID(+)
     and GCO_DESCRIPTION_SO.C_DESCRIPTION_TYPE(+) = 6
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_SV.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_SV.PC_LANG_ID(+)
     and GCO_DESCRIPTION_SV.C_DESCRIPTION_TYPE(+) = 7
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_IN.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_IN.PC_LANG_ID(+)
     and GCO_DESCRIPTION_IN.C_DESCRIPTION_TYPE(+) = 8
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_CA.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_CA.PC_LANG_ID(+)
     and GCO_DESCRIPTION_CA.C_DESCRIPTION_TYPE(+) = 9
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_TK.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_TK.PC_LANG_ID(+)
     and GCO_DESCRIPTION_TK.C_DESCRIPTION_TYPE(+) = 10
     and GCO_DESCRIPTION.GCO_GOOD_ID = GCO_DESCRIPTION_IV.GCO_GOOD_ID(+)
     and GCO_DESCRIPTION.PC_LANG_ID = GCO_DESCRIPTION_IV.PC_LANG_ID(+)
     and GCO_DESCRIPTION_IV.C_DESCRIPTION_TYPE(+) = 11


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HABENKST_KTR3_ISAG" ("KTR3_ID", "KTR3_NUMBER", "KTR3_DESCRIPTION_SUMMARY", "KTR3_DES_DESCRIPTION_LARGE", "LANID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  select PJ.ACS_PJ_ACCOUNT_ID KTR3_ID,
          ACC.ACC_NUMBER KTR3_NUMBER,
          DES.DES_DESCRIPTION_SUMMARY KTR3_DESCRIPTION_SUMMARY,
          DES.DES_DESCRIPTION_LARGE KTR3_DES_DESCRIPTION_LARGE,
          LAN.LANID || '' LANID,
          PJ.A_DATECRE,
          PJ.A_IDCRE,
          PJ.A_DATEMOD,
          PJ.A_IDMOD
     from ACS_DESCRIPTION DES,
          PCS.PC_LANG LAN,
          ACS_ACCOUNT ACC,
          ACS_PJ_ACCOUNT PJ
    where PJ.ACS_PJ_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID
      and ACC.ACS_ACCOUNT_ID = DES.ACS_ACCOUNT_ID
      and DES.PC_LANG_ID = LAN.PC_LANG_ID
      and PCS.PC_CONFIG.GetConfig('ACI_ISAG_HABENKST_KTR3', NULL, NULL) = 'PJ'
    union all
    select RCO.DOC_RECORD_ID KTR3_ID,
          RCO.RCO_TITLE KTR3_NUMBER,
          RCO.RCO_DESCRIPTION KTR3_DESCRIPTION_SUMMARY,
          '' KTR3_DES_DESCRIPTION_LARGE,
          NULL LAN_ID,
          RCO.A_DATECRE,
          RCO.A_IDCRE,
          RCO.A_DATEMOD,
          RCO.A_IDMOD
     from DOC_RECORD RCO
     where PCS.PC_CONFIG.GetConfig('ACI_ISAG_HABENKST_KTR3', NULL, NULL) = 'RCO'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ACJ_JOB_CATALOGUE" ("ACJ_JOB_TYPE_S_CATALOGUE_ID", "TYP_DESCRIPTION", "CAT_DESCRIPTION") AS
  SELECT
  a.acj_job_type_s_catalogue_id,
  b.typ_description,
  c.cat_description
FROM
  acj_job_type_s_catalogue a,
  acj_job_type b,
  acj_catalogue_document c
WHERE
  a.acj_job_type_id = b.acj_job_type_id and
  a.acj_catalogue_document_id=c.acj_catalogue_document_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ALLOCATION" ("BRT_TYPE", "BREAK_TYPE", "HRM_ALLOCATION_ID", "HRM_ALLOCATION_DETAIL_ID", "ALLOC_TYPE", "ITEM_ID", "ITEM_NAME", "RATE", "TARGET_TYPE", "TARGET_ID", "TARGET_NAME", "OPERATION", "SHIFT_CODE", "OP_TYPE") AS
  SELECT
  b.brt_type,
  a.BREAK_TYPE,
  a.HRM_ALLOCATION_ID,
  a.HRM_ALLOCATION_DETAIL_ID,
  a.ALLOC_TYPE,
  a.ITEM_ID,
  a.ITEM_NAME,
  a.RATE,
  a.TARGET_TYPE,
  a.TARGET_ID,
  a.TARGET_NAME,
  a.OPERATION,
  a.SHIFT_CODE,
  decode(sign(rate), 1, 'DEBIT', -1, 'CREDIT') op_type
FROM
  v_hrm_break a,
  hrm_break_type b
WHERE
  a.break_type = b.hrm_break_type_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ALL_DEFINED" ("IS_ELEMENT", "ELEMID", "CODE", "ALIAS", "SQL", "IS_SQL", "DICID", "FORMAT", "PRECISION", "ROUND", "BEGINDATE", "ENDDATE", "IS_VARIABLE", "ACTIVE", "MANDATORY", "CORRELATEDID", "REPORTING", "MULTICURRENCY", "CURRENCY", "CONST_TYPE", "DESCR1", "DESCR2", "DESCR3", "LANID1", "LANID2", "LANID3", "EXPRESSION", "SALSHEETID") AS
  SELECT
  1,
  a.Hrm_Elements_id,
  a.Ele_Code,
  a.Ele_Alias_Name,
  a.Ele_SQL,
  a.Ele_Is_Sql,
  0,
  a.Ele_Format,
  a.Ele_Precision,
  a.Ele_Round,
  a.Ele_Valid_From,
  a.Ele_Valid_to,
  a.Ele_Variable,
  a.Ele_Active,
  0,
  a.ele_correlated_id,
  a.ele_reporting,
  a.ele_multi_currency,
  a.acs_financial_currency_id,
  '',
  b.ele_descr,
  c.ele_descr,
  d.ele_descr,
  'FR',
  'GE',
  'EN',
  e.For_Expression,
  1
FROM
  hrm_elements a,
  hrm_elements_descr b,
  hrm_elements_descr c,
  hrm_elements_descr d,
  hrm_formulas e
WHERE
  (a.hrm_elements_id = b.hrm_elements_id and b.pc_lang_id(+) = 1) and
  (a.hrm_elements_id = c.hrm_elements_id(+) and c.pc_lang_id(+) = 2) and
  (a.hrm_elements_id = d.hrm_elements_id(+) and d.pc_lang_id(+) = 3) and
  (a.hrm_elements_id = e.hrm_elements_id(+) and e.hrm_salary_sheet_id(+) = 1)
UNION
SELECT
  0,
  a.hrm_constants_id,
  a.Con_Code,
  '' Alias_Name,
  '' SQL,
  0 Is_Sql,
  a.Hrm_Code_Dic_id,
  a.Con_Format,
  a.Con_Precision,
  a.Con_Round,
  a.Con_From,
  a.Con_to,
  0,
  a.Con_Active,
  a.Con_Mandatory,
  a.con_correlated_id,
  a.con_reporting,
  a.con_multi_currency,
  a.acs_financial_currency_id Currency,
  a.c_Hrm_Sal_Const_Type,
  b.con_descr,
  c.con_descr,
  d.con_descr,
  'FR',
  'GE',
  'EN',
  a.con_Expression,
  1
FROM
  hrm_const_descr b,
  hrm_const_descr c,
  hrm_const_descr d,
  Hrm_constants a
WHERE
  (a.hrm_constants_id = b.hrm_constants_id and b.pc_lang_id(+) = 1) and
  (a.hrm_constants_id = c.hrm_constants_id(+) and c.pc_lang_id(+) = 2) and
  (a.hrm_constants_id = d.hrm_constants_id(+) and d.pc_lang_id(+) = 3)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_AN_TOTAL" ("HRM_EMPLOYEE_ID", "HEB_DEFAULT_FLAG", "VAL") AS
  SELECT
  HRM_EMPLOYEE_ID,
  heb_default_flag,
  sum(heb_ratio) Val
FROM
  hrm_employee_break
WHERE
  heb_an_flag=1
group by
  hrm_employee_id,
  heb_default_flag
UNION
SELECT
  c.hrm_person_id,
  1,
  0 Val
FROM
  hrm_person c
WHERE
  c.hrm_person_id not in (SELECT d.hrm_employee_id
                            FROM hrm_employee_break d
                            WHERE heb_an_flag=1)
  and c.per_is_employee=1
UNION
SELECT
  c.hrm_person_id,
  0,
  0 Val
FROM
  hrm_person c
WHERE
  c.hrm_person_id not in (SELECT d.hrm_employee_id
                            FROM hrm_employee_break d
                            WHERE heb_an_flag=1)
  and c.per_is_employee = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_AVS" ("EMPID", "SECUNO", "BIRTH", "EMPNAME", "DATEIN", "DATEOUT", "ELEMCODE", "HISVAL", "HISPERIOD", "HISPERIODYYYY", "SEARCHNAME", "UPPERNAME", "LISTID", "COEBOX", "NATIONALITY", "GRP_AVS", "GRP_EMP", "IS_RETRO") AS
  select
  H.HRM_EMPLOYEE_ID EMPID,
  Nvl(P.EMP_SOCIAL_SECURITYNO2, P.EMP_SOCIAL_SECURITYNO) SECUNO,
  P.PER_BIRTH_DATE BIRTH,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME EMPNAME,
  I.INO_IN DATEIN,
  I.INO_OUT DATEOUT,
  C.COE_CODE ELEMCODE,
  HD.HIS_PAY_SUM_VAL HISVAL,
  H.HIT_PAY_PERIOD HISPERIOD,
  to_char(H.HIT_PAY_PERIOD, 'YYYY') HISPERIODYYYY,
  PER_SEARCH_NAME SEARCHNAME,
  Upper(P.PER_LAST_NAME||' '||P.PER_FIRST_NAME) UPPERNAME,
  C.HRM_CONTROL_LIST_ID LISTID,
  C.COE_BOX COEBOX,
  P.DIC_NATIONALITY_ID,
  Nvl2(P.EMP_SOCIAL_SECURITYNO2,
    case Length(P.EMP_SOCIAL_SECURITYNO2) when 16 then 2 else 1 end,
    case Length(P.EMP_SOCIAL_SECURITYNO) when 14 then 2 else 1 end
  ) GRPAVS,
  P.PER_SEARCH_NAME||to_char(P.HRM_PERSON_ID) GRPEMP,
  S.SAL_IS_RETRO
from
  HRM_SALARY_SHEET S,
  HRM_IN_OUT I,
  HRM_HISTORY_DETAIL HD,
  HRM_HISTORY H,
  HRM_PERSON P,
  HRM_CONTROL_ELEMENTS C
where
  S.HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
  HD.HRM_ELEMENTS_ID = C.HRM_CONTROL_ELEMENTS_ID and
  HD.HIS_PAY_NUM = H.HIT_PAY_NUM and
  HD.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
  P.HRM_PERSON_ID = H.HRM_EMPLOYEE_ID and
  I.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
  I.C_IN_OUT_CATEGORY = '3' and
  H.HIT_PAY_PERIOD between I.INO_IN and hrm_date.NextInOutInDate(I.INO_OUT, I.HRM_EMPLOYEE_ID) and
  H.HIT_DEFINITIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BANK_BREAK" ("PRIORITY", "AMOUNT", "EMPID", "TYPE", "NAME", "ADDRESS", "NPA", "ACCOUNT", "BANKID", "BANKNAME", "BANKCITY", "BANKETAB", "BANKGUICH", "BANKSWIFT", "BANKCLEAR", "CURRENCY", "FIN_COMMENTS", "ELEM_ID", "EURO_RATE", "EURO_PRECISION", "PC_CNTRY_ID", "C_CHARGES_MANAGEMENT") AS
  select a.fin_sequence
       , a.fin_amount
       , b.hrm_person_id
       , a.c_financial_ref_type
       , nvl(a.fin_name, b.per_last_name || ' ' || b.per_first_name)
       ,
         -- address ie street
         case
           when fin_name is null then case
                                       when per_taxpostalcode is null then case per_mail_add_selector
                                                                            when 0 then hrm_var.hrm_memoline(per_businessstreet) ||
                                                                                        ' ' ||
                                                                                        hrm_var.hrm_memoline(per_businessstreet, 2)
                                                                            when 1 then hrm_var.hrm_memoline(per_homestreet) ||
                                                                                        ' ' ||
                                                                                        hrm_var.hrm_memoline(per_homestreet, 2)
                                                                            when 2 then hrm_var.hrm_memoline(per_otherstreet) ||
                                                                                        ' ' ||
                                                                                        hrm_var.hrm_memoline(per_otherstreet, 2)
                                                                          end
                                       else hrm_var.hrm_memoline(per_taxstreet) || ' ' || hrm_var.hrm_memoline(per_taxstreet, 2)
                                     end
           else hrm_var.hrm_memoline(fin_address) || ' ' || hrm_var.hrm_memoline(fin_address, 2)
         end
       ,
         -- postalcode, should have country code, and city
         case
           when fin_name is null then case
                                       when per_taxpostalcode is null then case per_mail_add_selector
                                                                            when 0 then per_businesspostalcode || ' ' || per_businesscity
                                                                            when 1 then per_homepostalcode || ' ' || per_homecity
                                                                            when 2 then per_otherpostalcode || ' ' || per_othercity
                                                                          end
                                       else per_taxpostalcode || ' ' || per_taxcity
                                     end
           else fin_city
         end
       , a.fin_account_number
       , a.pc_bank_id
       , nvl2(a.pc_bank_id, e.ban_name1, a.fin_ban_name)
       , a.fin_ban_city
       , a.fin_ban_etab
       , a.fin_ban_guich
       , a.fin_swift
       , e.ban_clear
       , nvl2(a.acs_financial_currency_id, g.currency, 'CHF')
       , case
           when a.fin_comments is not null then hrm_var.hrm_memoline(a.fin_comments) || ' ' || hrm_var.hrm_memoline(a.fin_comments, 2)
         end
       , a.hrm_elements_id
       , f.fin_euro_rate
       , case
           when f.fin_euro_rate is not null then f.fin_rounded_amount
         end
       , nvl(e.pc_cntry_id, a.pc_cntry_id)
       , a.c_charges_management
    from pcs.pc_curr g
       , acs_financial_currency f
       , pcs.pc_bank e
       , hrm_financial_ref a
       , hrm_person b
   where a.hrm_employee_id = b.hrm_person_id
     and e.pc_bank_id(+) = a.pc_bank_id
     and f.acs_financial_currency_id(+) = a.acs_financial_currency_id
     and g.pc_curr_id(+) = f.pc_curr_id
     and HRM_DATE.ACTIVEPERIODENDDATE between FIN_START_DATE and nvl(FIN_END_DATE, HRM_DATE.ACTIVEPERIODENDDATE)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK" ("BREAK_TYPE", "HRM_ALLOCATION_ID", "HRM_ALLOCATION_DETAIL_ID", "ALLOC_TYPE", "ITEM_ID", "ITEM_NAME", "RATE", "TARGET_TYPE", "TARGET_ID", "TARGET_NAME", "OPERATION", "SHIFT_CODE") AS
  SELECT
  HBS.hrm_break_type_id,
  HAD.hrm_allocation_id,
  HAD.HRM_ALLOCATION_DETAIL_ID,
  HA.dic_allocation_type_id,
  HBS.bre_item_id,
  HBS.bre_item_name,
  HAD.ald_rate,
  HAD.DIC_ACCOUNT_TYPE_ID,
  HAD.ald_acc_id,
  HAD.ald_acc_name,
  HBSH.brs_operation_type,
  HBSH.brs_code
FROM
  HRM_BREAK_SHIFT HBSH,
  hrm_break_structure HBS,
  hrm_allocation HA,
  HRM_ALLOCATION_DETAIL HAD
WHERE
  HBSH.HRM_BREAK_SHIFT_ID = HAD.HRM_BREAK_SHIFT_ID and
  HBS.hrm_allocation_id = HAD.hrm_allocation_id and
  HBS.hrm_allocation_id = HA.hrm_allocation_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAKROUND" ("HBR_EMPLOYEE_ID", "HBR_ELEMENTS_ID", "HBR_AMOUNT_TYPE", "HBR_ACCOUNT_TYPE_ID", "HBR_HISTORY_DETAIL_ID", "HBR_SOURCE", "HBR_ACTUAL_VALUE", "HBR_REAL_VALUE", "HBR_AMOUNT", "HBR_DELTA") AS
  SELECT
  b.per_last_name||' '||b.per_first_name,
  c.code,
  a.hbr_amount_type,
  a.hbr_account_type_id,
  a.hbr_history_detail_id,
  a.hbr_source,
  a.hbr_actual_value,
  a.hbr_real_value,
  a.hbr_amount,
  a.hbr_delta
FROM
  v_hrm_defined_names_descr c,
  hrm_person b,
  hrm_break_round a
WHERE
  b.hrm_person_id = a.hbr_employee_id AND
  c.elem_const_id = a.hbr_elements_id AND
  c.lang_id = pcs.PC_I_LIB_SESSION.GetUserLangId


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_AN" ("CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "AMOUNT1", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SOURCE", "HRM_BREAK_ID", "CURRENCY", "CURRID", "ELE_CODE", "ELE_STATCODE", "ELE_DESCR", "PERNAME", "SEARCHNAME", "BRK_DESCRIPTION", "BRK_VALUE_DATE", "HRM_ELEMENTS_ID") AS
  SELECT
  sb.sab_account_name,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'CDA') cda_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PF') pf_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PJ') pj_number,
  decode(sb.sab_amount_type, 'D', sb.sab_amount, 0) debit_amount,
  decode(sb.sab_amount_type, 'C', sb.sab_amount, 0) credit_amount,
  sb.sab_amount,
  sb.sab_amount_type,
  sb.acs_financial_currency_id,
  sb.sab_pay_date,
  sb.hrm_history_detail_id,
  sb.sab_source,
  sb.hrm_break_id,
  acs_function.GetCurrencyName(sb.acs_financial_currency_id),
  sb.acs_financial_currency_id,
  e.ele_code,
  e.ele_stat_code,
  e.ele_code ele_descr,
  p.per_last_name||' '||per_first_name pername,
  p.per_search_name searchname,
  b.brk_description,
  b.brk_value_date,
  sb.hrm_elements_id
FROM
  hrm_person p,
  hrm_elements e,
  hrm_salary_breakdown sb,
  hrm_break b
WHERE
  sb.dic_account_type_id = 'CPN' and
  b.hrm_break_id = sb.hrm_break_id and
  e.hrm_elements_id = sb.hrm_elements_id and
  p.hrm_person_id = sb.hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_AN_GRP" ("CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "AMOUNT", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_BREAK_ID", "CURRENCY") AS
  SELECT
  CPN_NUMBER,
  CDA_NUMBER,
  PF_NUMBER,
  PJ_NUMBER,
  sum(DEBIT_AMOUNT) DEBIT_AMOUNT,
  sum(CREDIT_AMOUNT) CREDIT_AMOUNT,
  sum(AMOUNT1) AMOUNT,
  AMOUNT_TYPE,
  ACS_FINANCIAL_CURRENCY_ID,
  SAB_PAY_DATE,
  HRM_BREAK_ID,
  CURRENCY
FROM
  V_HRM_BREAK_AN
GROUP BY
  CPN_NUMBER,
  CDA_NUMBER,
  PF_NUMBER,
  PJ_NUMBER,
  AMOUNT_TYPE,
  ACS_FINANCIAL_CURRENCY_ID,
  CURRENCY,
  SAB_PAY_DATE,
  HRM_BREAK_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_AN_TRANSFERT" ("CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "AMOUNT1", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SOURCE", "HRM_BREAK_ID", "ACI_FINANCIAL_IMPUTATION_ID", "ACI_DOCUMENT_ID") AS
  SELECT
  A.sab_account_Name,
  B.CDA_NUMBER,
  B.PF_NUMBER,
  B.PJ_NUMBER,
  B.DEBIT_AMOUNT,
  B.CREDIT_AMOUNT,
  B.AMOUNT1,
  B.AMOUNT_TYPE,
  B.ACS_FINANCIAL_CURRENCY_ID,
  B.SAB_PAY_DATE,
  B.HRM_HISTORY_DETAIL_ID,
  B.SOURCE,
  B.HRM_BREAK_ID,
  ACI_FUNCTIONS.GetACI_FINANCIAL_IMPUTATION_ID(aci_document_id,V_HBC_DIV_NAME,V_HBC_ACC_NAME) ACI_FINANCIAL_IMPUTATION_ID,
  ACI_DOCUMENT_ID
FROM
  V_HRM_BREAK_CGDIV2 C,
  HRM_SALARY_BREAKDOWN A,
  HRM_BREAK E,
  ACI_DOCUMENT F,
  V_HRM_BREAK_AN_TRANSFERT0 B
WHERE
  A.dic_account_type_id = 'CPN' AND
  A.hrm_history_detail_id = B.hrm_history_detail_id AND
  A.sab_source = B.Source AND
  A.sab_amount_type = B.amount_type AND
  C.HRM_BREAK_ID=A.HRM_BREAK_ID AND
  E.HRM_BREAK_ID=A.HRM_BREAK_ID AND
  BRK_DOCUMENT_CG=F.DOC_NUMBER and
  A.hrm_history_detail_id = C.hrm_history_detail_id AND
  A.sab_source = C.source AND
  A.sab_amount_type = C.v_hbc_amount_type


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_AN_TRANSFERT0" ("CDA_NUMBER", "PJ_NUMBER", "PF_NUMBER", "AMOUNT1", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SOURCE", "HRM_BREAK_ID") AS
  SELECT DISTINCT
  t1.sab_account_name CDA_NUMBER,
  t2.sab_account_name PJ_NUMBER,
  t3.sab_account_name PF_NUMBER,
  nvl(t1.sab_amount,0) AMOUNT1,
  decode(t1.sab_amount_type, 'D', t1.sab_amount, 0) DEBIT_AMOUNT,
  decode(t1.sab_amount_type, 'C', t1.sab_amount, 0) CREDIT_AMOUNT,
  t1.sab_amount_type AMOUNT_TYPE,
  t1.ACS_FINANCIAL_CuRRENCY_ID,
  t1.sab_pay_date,
  t1.hrm_history_detail_id,
  t1.sab_source source,
  t1.hrm_break_id
FROM
  HRM_SALARY_BREAKDOWN t1,
  HRM_SALARY_BREAKDOWN t2,
  HRM_SALARY_BREAKDOWN t3
WHERE
  t1.dic_account_type_id = 'CDA' AND
  t2.dic_account_type_id(+) = 'PJ' AND
  t3.dic_account_type_id(+) = 'PF' AND
  t1.hrm_break_id = t2.hrm_break_id(+) AND
  t1.hrm_break_id = t3.hrm_break_id(+) AND
  t1.hrm_history_detail_id = t2.hrm_history_detail_id(+) AND
  t1.hrm_history_detail_id = t3.hrm_history_detail_id(+) AND
  t1.sab_amount_type= t2.sab_amount_type(+) AND
  t1.sab_amount_type= t3.sab_amount_type(+) AND
  t1.sab_source = t2.sab_source(+) AND
  t1.sab_source = t3.sab_source(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_AN_TRANSFERT_GRP" ("CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "AMOUNT", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_BREAK_ID", "ACI_FINANCIAL_IMPUTATION_ID", "ACI_DOCUMENT_ID") AS
  SELECT
  CPN_NUMBER,
  CDA_NUMBER,
  PF_NUMBER,
  PJ_NUMBER,
  sum(DEBIT_AMOUNT) DEBIT_AMOUNT,
  sum(CREDIT_AMOUNT) CREDIT_AMOUNT,
  sum(AMOUNT1) AMOUNT,
  AMOUNT_TYPE,
  ACS_FINANCIAL_CURRENCY_ID,
  SAB_PAY_DATE,
  HRM_BREAK_ID,
  ACI_FINANCIAL_IMPUTATION_ID,ACI_DOCUMENT_ID
FROM
  V_HRM_BREAK_AN_TRANSFERT
GROUP BY
  CPN_NUMBER,
  CDA_NUMBER,
  PF_NUMBER,
  PJ_NUMBER,
  AMOUNT_TYPE,
  ACS_FINANCIAL_CURRENCY_ID,
  SAB_PAY_DATE,
  HRM_BREAK_ID,
  ACI_FINANCIAL_IMPUTATION_ID,
  ACI_DOCUMENT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CGAN" ("CG_NUMBER", "DIV_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "NUMBER1", "NUMBER2", "NUMBER3", "NUMBER4", "TEXT1", "TEXT2", "TEXT3", "TEXT4", "RCO_TITLE", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "FOREIGN_DEBIT_AMOUNT", "FOREIGN_CREDIT_AMOUNT", "AMOUNT1", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SOURCE", "HRM_BREAK_ID", "CURRENCY", "ELE_CODE", "ELE_STATCODE", "ELE_DESCR", "PERNAME", "BRK_DESCRIPTION", "HRM_ELEMENTS_ID") AS
  SELECT
  sb.sab_account_name,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'DIV') div_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'CPN') cpn_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'CDA') cda_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PF') pf_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PJ') pj_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER1') number1,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER2') number2,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER3') number3,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER4') number4,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT1') text1,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT2') text2,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT3') text3,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT4') text4,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'DOC_RECORD') rco_title,
  decode(sb.sab_amount_type, 'D', sb.sab_amount, 0) debit_amount,
  decode(sb.sab_amount_type, 'C', sb.sab_amount, 0) credit_amount,
  decode(sb.sab_amount_type, 'D', sb.sab_foreign_amount, 0) foreign_debit_amount,
  decode(sb.sab_amount_type, 'C', sb.sab_foreign_amount, 0) foreign_credit_amount,
  nvl(sb.sab_amount,0) amount1,
  sb.sab_amount_type,
  sb.acs_financial_currency_id,
  sb.sab_pay_date,
  sb.hrm_history_detail_id,
  sb.sab_source,
  sb.hrm_break_id,
  (select currency from pcs.pc_curr
   where pc_curr_id = (select pc_curr_id from acs_financial_currency
                       where acs_financial_currency_id = sb.acs_financial_currency_id)) currency,
  r.ele_code,
  r.elr_root_code,
  r.ele_code ele_descr,
  (select per_last_name||' '||per_first_name from hrm_person
   where hrm_person_id = sb.hrm_employee_id) pername,
  b.brk_description,
  sb.hrm_elements_id
from
  (select r.elr_root_code, f.hrm_elements_id, e.ele_code
   from hrm_elements e, hrm_elements_root r, hrm_elements_family f
   where r.hrm_elements_root_id = f.hrm_elements_root_id and
     (upper(r.c_root_function) <> 'HOURS' or r.c_root_function is null) and
     e.hrm_elements_id = r.hrm_elements_id
  ) r,
  hrm_break b,
  hrm_salary_breakdown sb
where
  sb.dic_account_type_id = 'CG' and
  b.hrm_break_id = sb.hrm_break_id and
  r.hrm_elements_id = sb.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CGAN_GRP" ("CG_NUMBER", "DIV_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "NUMBER1", "NUMBER2", "NUMBER3", "NUMBER4", "TEXT1", "TEXT2", "TEXT3", "TEXT4", "RCO_TITLE", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "FOREIGN_DEBIT_AMOUNT", "FOREIGN_CREDIT_AMOUNT", "AMOUNT1", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_BREAK_ID", "CURRENCY", "BRK_DESCRIPTION") AS
  SELECT
  cg_number,
  div_number,
  cpn_number,
  cda_number,
  pf_number,
  pj_number,
  number1,
  number2,
  number3,
  number4,
  text1,
  text2,
  text3,
  text4,
  rco_title,
  sum(debit_amount),
  sum(credit_amount),
  sum(foreign_debit_amount),
  sum(foreign_credit_amount),
  sum(amount1),
  amount_type,
  acs_financial_currency_id,
  sab_pay_date,
  hrm_break_id,
  currency,
  brk_description
FROM
  v_hrm_break_cgan
GROUP BY
  cg_number,
  div_number,
  cpn_number,
  cda_number,
  pf_number,
  pj_number,
  number1,
  number2,
  number3,
  number4,
  text1,
  text2,
  text3,
  text4,
  rco_title,
  amount_type,
  acs_financial_currency_id,
  sab_pay_date,
  hrm_break_id,
  currency,
  brk_description


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CGDIV" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "HRM_EMPLOYEE_ID", "ACS_CPN_ACCOUNT_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "ACC_DESCR", "ACS_ACCOUNT_ID") AS
  SELECT
  t1.hrm_history_detail_id,
  t1.hrm_break_id,
  t1.hrm_elements_id,
  t1.sab_account_id v_hbc_ACC_NUM,
  t1.sab_account_name v_hbc_ACC_NAME,
  t2.sab_account_id v_hbc_DIV_NUM,
  t2.sab_account_name v_hbc_DIV_NAME,
  nvl(t2.sab_amount, t1.sab_amount) v_hbc_AMOUNT,
  decode(t1.sab_amount_type, 'D', nvl(t2.sab_amount, t1.sab_amount), 'C', 0) v_hbc_Debit_amount,
  decode(t1.sab_amount_type, 'C', nvl(t2.sab_amount, t1.sab_amount), 'D', 0) v_hbc_Credit_amount,
  t1.sab_amount_type v_hbc_AMOUNT_TYPE,
  t1.sab_pay_date,
  t1.sab_ref_value,
  t1.sab_zl,
  p.currency,
  t1.hrm_employee_id,
  t4.ACS_CPN_ACCOUNT_ID,
  ele_code ele_descr,
  brk_description,
  ele_code,
  ele_stat_code,
  '' DES_DESCRIPTION_SUMMARY,
  t5.ACS_ACCOUNT_ID
FROM
  hrm_break b,
  hrm_elements c,
  PCS.PC_CURR p,
  hrm_salary_breakdown t1,
  hrm_salary_breakdown t2,
  ACS_Financial_currency t3,
  ACS_Financial_account t4,
  ACS_Account t5
WHERE
  c.hrm_elements_id = t1.hrm_elements_id AND
  B.HRM_BREAK_ID = t1.hrm_break_id AND
  t1.sab_account_name = t5.ACC_NUMBER (+) AND
  t5.ACS_ACCOUNT_ID = t4.ACS_FINANCIAL_ACCOUNT_ID AND
  t1.ACS_FINANCIAL_CURRENCY_ID = t3.ACS_FINANCIAL_CURRENCY_ID AND
  t3.pc_curr_id = p.pc_curr_id AND
  t1.dic_account_type_id = 'CG' AND
  t2.dic_account_type_id(+) = 'DIV' AND
  t2.sab_amount_type(+) = t1.sab_amount_type AND
  t2.sab_source(+) = t1.sab_source AND
  t1.hrm_history_detail_id = t2.hrm_history_detail_id(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CGDIV2" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_FOREIGN_AMOUNT", "V_HBC_DEBIT_FOREIGN_AMOUNT", "V_HBC_CREDIT_FOREIGN_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "HRM_EMPLOYEE_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "SOURCE", "VALUE_DATE", "BREAK_DATE") AS
  SELECT
  t1.hrm_history_detail_id,
  t1.hrm_break_id,
  t1.hrm_elements_id,
  t1.sab_account_id v_hbc_ACC_NUM,
  t1.sab_account_name v_hbc_ACC_NAME,
  t2.sab_account_id v_hbc_DIV_NUM,
  t2.sab_account_name v_hbc_DIV_NAME,
  nvl(t2.sab_amount, t1.sab_amount) v_hbc_AMOUNT,
  decode(t1.sab_amount_type, 'D', nvl(t2.sab_amount, t1.sab_amount), 'C', 0) v_hbc_Debit_amount,
  decode(t1.sab_amount_type, 'C', nvl(t2.sab_amount, t1.sab_amount), 'D', 0) v_hbc_Credit_amount,
  nvl(t2.sab_foreign_amount, t1.sab_foreign_amount) v_hbc_foreign_AMOUNT,
  decode(t1.sab_amount_type, 'D', nvl(t2.sab_foreign_amount, t1.sab_foreign_amount), 'C', 0) V_HBC_DEBIT_FOREIGN_AMOUNT,
  decode(t1.sab_amount_type, 'C', nvl(t2.sab_foreign_amount, t1.sab_foreign_amount), 'D', 0) V_HBC_CREDIT_FOREIGN_AMOUNT,
  t1.sab_amount_type v_hbc_AMOUNT_TYPE,
  t1.sab_pay_date,
  t1.sab_ref_value,
  t1.sab_zl,
  p.currency,
  t1.HRM_EMPLOYEE_ID,
  ele_code,
  brk_description,
  ele_code,
  ele_stat_code,
  t1.sab_source,
  b.brk_value_date,
  b.brk_break_date
FROM
  hrm_break B,
  hrm_elements c,
  hrm_salary_breakdown t1,
  hrm_salary_breakdown t2,
  ACS_Financial_currency t3,
  PCS.PC_CURR p
WHERE
  B.HRM_BREAK_ID = t1.hrm_break_id AND
  C.HRM_ELEMENTS_ID = t1.hrm_elements_id AND
  t1.dic_account_type_id = 'CG' AND
  t2.dic_account_type_id(+) = 'DIV' AND
  t1.ACS_FINANCIAL_CURRENCY_ID = t3.ACS_FINANCIAL_CURRENCY_ID AND
  t3.pc_curr_id = p.pc_curr_id AND
  t2.sab_amount_type(+) = t1.sab_amount_type AND
  t2.sab_source(+) = t1.sab_source AND
  t1.hrm_history_detail_id = t2.hrm_history_detail_id(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CGDIV_GRP" ("HRM_BREAK_ID", "HRM_BREAK_ACC_NAME", "HRM_BREAK_DIV_NAME", "ACS_CPN_ACCOUNT_ID", "HRM_BREAK_DEBIT_AMOUNT", "HRM_BREAK_CREDIT_AMOUNT", "CURRENCY") AS
  SELECT
  hrm_break_id,
  v_hbc_acc_name,
  v_hbc_div_name,
  acs_cpn_account_id,
  sum(v_hbc_Debit_amount),
  sum(v_hbc_Credit_amount),
  currency
FROM
  v_hrm_break_cgdiv
GROUP BY
  hrm_break_id,
  v_hbc_acc_name,
  v_hbc_div_name,
  acs_cpn_account_id,
  currency


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CGDIV_GRP2" ("HRM_BREAK_ID", "HRM_BREAK_ACC_NAME", "HRM_BREAK_DIV_NAME", "HRM_BREAK_DEBIT_AMOUNT", "HRM_BREAK_CREDIT_AMOUNT", "CURRENCY") AS
  SELECT
  hrm_break_id,
  v_hbc_acc_name,
  v_hbc_div_name,
  sum(v_hbc_Debit_amount),
  sum(v_hbc_Credit_amount),
  currency
FROM
  v_hrm_break_cgdiv2
GROUP BY
  hrm_break_id,
  v_hbc_acc_name,
  v_hbc_div_name,
  currency


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CG_DIV" ("HRM_BREAK_ID", "HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "HDB_SOURCE", "HDB_AMOUNT_TYPE", "CG", "DIV", "HDB_AMOUNT", "DEBIT_AMOUNT", "CREDIT_AMOUNT") AS
  SELECT
  a.hrm_break_id,
  a.hrm_employee_id,
  a.hrm_elements_id,
  a.hdb_source,
  a.hdb_amount_type,
  a.hdb_account_name CG,
  b.hdb_account_name DIV,
  a.hdb_amount,
  decode(a.HDB_AMOUNT_TYPE,'D',a.HDB_AMOUNT,0) debit_amount,
  decode(a.HDB_AMOUNT_TYPE,'C',a.HDB_AMOUNT,0) credit_amount
FROM
  hrm_break_detail a,
  hrm_break_detail b,
  hrm_elements c
WHERE
  a.hrm_elements_id=c.hrm_elements_id and
  a.hrm_break_id = b.hrm_break_id and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  a.hdb_source = b.hdb_source and
  a.hdb_amount_type=b.hdb_amount_type and
  c.dic_group4_id not in ('3','4','5') and
  a.DIC_ACCOUNT_TYPE_ID = 'CG' and
  b.DIC_ACCOUNT_TYPE_ID = 'DIV'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CG_DIV_GRP" ("HRM_BREAK_ID", "ACC_NUMBER", "DIV_NUMBER", "DEBIT_AMOUNT", "CREDIT_AMOUNT") AS
  SELECT
  hrm_break_id,
  CG ACC_NUMBER,
  DIV DIV_NUMBER,
  sum(debit_amount) debit_amount,
  sum(credit_amount) credit_amount
FROM
  V_HRM_BREAK_CG_DIV
GROUP BY
  hrm_break_id, cg,div


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CG_PARITY_CONTROL" ("HRM_EMPLOYEE_ID", "DEBIT_AMOUNT", "CREDIT_AMOUNT") AS
  SELECT hrm_employee_id,
         SUM (CASE hdb_amount_type WHEN 'D' THEN hdb_amount ELSE 0 END) debit_amount,
         SUM (CASE hdb_amount_type WHEN 'C' THEN hdb_amount ELSE 0 END) credit_amount
    FROM hrm_tmp_break_detail
   WHERE dic_account_type_id = 'CG'
GROUP BY hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_CTRL_13M" ("PERNAME", "HRM_ELEMENTS_ID", "HIS_PAY_PERIOD", "HIS_PAY_SUM_VAL", "EEB_TIME_RATIO", "EEB_RATIO_GROUP", "EEB_VALUE", "DIC_DEPARTMENT_ID", "JOB_CODE") AS
  SELECT
  a.per_last_name||' '||a.per_first_name pername,
  d.HRM_ELEMENTS_ID,
  d.HIS_PAY_PERIOD,
  d.HIS_PAY_SUM_VAL,
  c.EEB_TIME_RATIO,
  c.EEB_RATIO_GROUP,
  c.EEB_VALUE,
  c.DIC_DEPARTMENT_ID,
  c.JOB_CODE
FROM
  HRM_PERSON A,
  HRM_HISTORY_DETAIL D,
  HRM_HISTORY_DETAIL_BREAK C,
  HRM_HISTORY B
WHERE
  hrm_elements_id in (6103, 2798) AND
  D.HRM_HISTORY_DETAIL_ID = c.HRM_HISTORY_DETAIL_ID AND
  b.hit_pay_num = d.his_pay_num AND
  b.hrm_employee_id = d.hrm_employee_id AND
  a.hrm_person_id = b.hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "RATE", "DIVISION", "DIC_DEPARTMENT_ID", "JOB_CODE", "SOURCE") AS
  SELECT
  a.hrm_employee_id,
  a.hrm_elements_id,
  a.VAL/b.TOTAL rate,
  eeb_divbase DIVISION,
  dic_department_id,
  job_code,
  to_char(a.hrm_employee_id)||'-'||to_char(a.hrm_elements_id)||'/'||to_char(eeb_divbase)||'/'||to_char(dic_department_id)||'/'||to_char(job_code) SOURCE
FROM
  v_hrm_break_prop_val_element a,
  v_hrm_break_prop_total_element b
WHERE
  a.hrm_employee_id = b.hrm_employee_id and
  a.hrm_elements_id = b.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_13M" ("HRM_EMPLOYEE_ID", "DIV", "CG", "RATE", "SOURCE", "YEAR", "VERSION") AS
  SELECT
  a.hrm_employee_id,
  DIV,
  CG,
  a.VAL/b.TOTAL rate,
  to_char(a.hrm_employee_id)||'-'||to_char(div)||'/'||to_char(cg) SOURCE,
  a.year,
  2 version
FROM
  v_hrm_break_prop_val_13m a,
  v_hrm_break_prop_total_13m b
WHERE
  a.hrm_employee_id = b.hrm_employee_id and
  a.year = b.year


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_N" ("HRM_EMPLOYEE_ID", "MAIN_ID", "RATE", "DIVISION", "DIC_DEPARTMENT_ID", "JOB_CODE", "SOURCE", "RATIO_GROUP") AS
  SELECT
  a.hrm_employee_id,
  a.main_id,
  a.VAL/b.VAL rate,
  DIVISION,
  dic_department_id,
  job_code,
  to_char(EEB_RATIO_GROUP)||'/'||to_char(division)||'/'||to_char(dic_department_id)||'/'||to_char(job_code) SOURCE,
  a.eeb_ratio_group
FROM
  v_hrm_break_prop_val_elt_N a,
  v_hrm_break_prop_total_elt_N b
WHERE
  a.hrm_employee_id = b.hrm_employee_id and
  a.main_id = b.main_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_P13" ("HRM_EMPLOYEE_ID", "MAIN_ID", "RATE", "DIVISION", "DIC_DEPARTMENT_ID", "JOB_CODE", "SOURCE", "RATIO_GROUP") AS
  SELECT
  a.hrm_employee_id,
  a.main_id,
  a.VAL/b.VAL rate,
  DIVISION,
  dic_department_id,
  job_code,
  to_char(a.eeb_ratio_group)||to_char(division)||'/'||to_char(dic_department_id)||'/'||to_char(job_code) SOURCE,
  a.eeb_ratio_group
FROM
  v_hrm_break_prop_val_elt_P13 a,
  v_hrm_break_prop_total_elt_P13 b
WHERE
  a.hrm_employee_id = b.hrm_employee_id and
  a.main_id = b.main_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_TOTAL" ("HRM_EMPLOYEE_ID", "EEB_RATIO_GROUP", "TOTAL") AS
  SELECT
  b.hrm_employee_id,
  eeb_ratio_group,
  sum(eeb_value) total
FROM
  hrm_history c,
  hrm_history_detail b,
  hrm_history_detail_break a
WHERE
  eeb_ratio_group > 0 and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  b.hrm_employee_id = c.hrm_employee_id and
  hit_pay_num = his_pay_num and
  b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
  hit_accounted = 2
GROUP BY
  b.hrm_employee_id,
  eeb_ratio_group


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_TOTAL_13M" ("HRM_EMPLOYEE_ID", "YEAR", "TOTAL", "VERSION") AS
  SELECT
  hrm_employee_id,
  to_char(brk_value_date,'yyyy') year,
  sum(HDB_AMOUNT) total,
  2.1 version
FROM
  v_hrm_rep_break_ctrl_ivs a,
  hrm_break b
WHERE
  (b.brk_status <> 0 or b.hrm_break_id=(select max(hrm_break_id) from hrm_break)) and
  a.hrm_break_id=b.hrm_break_id and
  hrm_elements_id=6103 and
  brk_value_date >= hrm_date.Get_BeginOfInOutInYear(hrm_employee_id)
GROUP BY
  hrm_employee_id,
  to_char(brk_value_date,'yyyy')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_TOTAL_ELEMENT" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "TOTAL") AS
  SELECT
  b.hrm_employee_id,
  d.hrm_elements_id,
  sum(eeb_value) total
FROM
  hrm_elements d,
  hrm_history c,
  hrm_history_detail b,
  hrm_history_detail_break a
WHERE
  eeb_ratio_group > 0 and
  instr(ele_use_ratio_group, eeb_ratio_group) > 0 and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  b.hrm_employee_id = c.hrm_employee_id and
  hit_pay_num = his_pay_num and
  b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
  hit_accounted = 3
GROUP BY
  b.hrm_employee_id,
  d.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_TOTAL_ELT_N" ("HRM_EMPLOYEE_ID", "MAIN_ID", "VAL") AS
  SELECT
  hrm_employee_id,
  main_id,
  sum(val) val
FROM
  (SELECT
     b.hrm_employee_id,
     main_id,
     eeb_value val
   FROM
     hrm_formulas_structure e,
     hrm_history c,
     hrm_history_detail b,
     hrm_history_detail_break a,
     hrm_elements d
   WHERE
     main_id in (SELECT hrm_elements_id FROM V_HRM_HISTORY_DETAIL_TO_BREAK) and
     related_id = b.hrm_elements_id and
     d.hrm_elements_id = main_id and
     relation_type = 1 and
     a.hrm_history_detail_id = b.hrm_history_detail_id and
     instr(ele_use_ratio_group, a.eeb_ratio_group) > 0 and
     b.hrm_employee_id = c.hrm_employee_id and
     hit_pay_num = his_pay_num and
     b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
     hit_accounted = 3
   UNION ALL
   SELECT
     aa.hrm_employee_id,
     main_id hrm_elements_id,
     hdb_amount val
   FROM
     v_hrm_break_cg_div aa,
     hrm_break ab,
     hrm_history ac,
     hrm_formulas_structure
   WHERE
     related_id = 1881 and relation_type = 1 and
     ac.hit_accounted = 3 and
     ac.hit_pay_period = ab.brk_value_date and
     ab.hrm_break_id=(select max(hrm_break_id) from hrm_break ) and
     aa.hrm_break_id=ab.hrm_break_id and
     aa.hrm_employee_id=ac.hrm_employee_id and
     aa.hrm_elements_id=2798)
GROUP BY
  hrm_employee_id,
  main_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_TOTAL_ELT_P13" ("HRM_EMPLOYEE_ID", "MAIN_ID", "VAL") AS
  SELECT
  b.hrm_employee_id,
  main_id,
  sum(eeb_value) val
FROM
  hrm_formulas_structure e,
  hrm_history c,
  hrm_history_detail b,
  hrm_history_detail_break a,
  hrm_elements d
WHERE
  main_id in (SELECT hrm_elements_id FROM V_HRM_HISTORY_DETAIL_TO_BREAK) and
  related_id = b.hrm_elements_id and
  d.hrm_elements_id = main_id and
  relation_type = 1 and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  instr(ele_use_ratio_group, a.eeb_ratio_group) > 0 and
  b.hrm_employee_id = c.hrm_employee_id and
  hit_pay_num = his_pay_num and
  b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
  hit_accounted = 3 AND
  MAIN_ID=6103
GROUP BY
  b.hrm_employee_id,
  main_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_VAL" ("HRM_EMPLOYEE_ID", "EEB_RATIO_GROUP", "EEB_DIVBASE", "VAL") AS
  SELECT
  b.hrm_employee_id,
  eeb_ratio_group,
  eeb_divbase,
  sum(eeb_value) val
FROM
  hrm_history c,
  hrm_history_detail b,
  hrm_history_detail_break a
WHERE
  eeb_ratio_group > 0 and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  b.hrm_employee_id = c.hrm_employee_id and
  hit_pay_num = his_pay_num and
  b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
  hit_accounted = 2
GROUP BY
  b.hrm_employee_id,
  eeb_ratio_group,
  eeb_divbase


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_VAL_13M" ("HRM_EMPLOYEE_ID", "CG", "DIV", "YEAR", "VAL", "VERSION") AS
  SELECT
  hrm_employee_id,
  CG, DIV,
  to_char(brk_value_date,'yyyy') year,
  sum(hdb_amount) val,
  2.1 version
FROM
  v_hrm_rep_break_ctrl_ivs a,
  hrm_break b
WHERE
  (b.brk_status<>0 or b.HRM_BREAK_ID=(select max(hrm_break_id) from hrm_break)) and
  a.hrm_break_id=b.hrm_break_id and
  hrm_elements_id=6103 and
  brk_value_date >= hrm_date.Get_BeginOfInOutInYear(hrm_employee_id)
GROUP BY
  hrm_employee_id,
  CG,
  DIV,
  to_char(brk_value_date,'yyyy')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_VAL_ELEMENT" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "EEB_DIVBASE", "DIC_DEPARTMENT_ID", "JOB_CODE", "VAL") AS
  SELECT
  b.hrm_employee_id,
  d.hrm_elements_id,
  eeb_divbase,
  dic_department_id,
  job_code,
  sum(eeb_value) val
FROM
  hrm_elements d,
  hrm_history c,
  hrm_history_detail b,
  hrm_history_detail_break a
WHERE
  instr(ele_use_ratio_group, eeb_ratio_group) > 0 and
  eeb_ratio_group > 0 and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  b.hrm_employee_id = c.hrm_employee_id and
  hit_pay_num = his_pay_num and
  b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
  hit_accounted = 3
GROUP BY
  b.hrm_employee_id,
  eeb_divbase,
  dic_department_id,
  job_code,
  d.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_VAL_ELT_N" ("HRM_EMPLOYEE_ID", "MAIN_ID", "DIVISION", "DIC_DEPARTMENT_ID", "JOB_CODE", "VAL", "EEB_RATIO_GROUP") AS
  SELECT
  hrm_employee_id,
  main_id,
  division,
  dic_department_id,
  job_code,
  sum(val) val,
  eeb_ratio_group
FROM
  (SELECT
     b.hrm_employee_id,
     main_id,
     eeb_divbase division,
     dic_department_id,
     job_code,
     eeb_value val,
     eeb_ratio_group
   FROM
     hrm_formulas_structure e,
     hrm_history c,
     hrm_history_detail b,
     hrm_history_detail_break a,
     hrm_elements d
   WHERE
     main_id in (SELECT hrm_elements_id FROM V_HRM_HISTORY_DETAIL_TO_BREAK) and
     related_id = b.hrm_elements_id and
     d.hrm_elements_id = main_id and
     relation_type = 1 and
     instr(ele_use_ratio_group, a.eeb_ratio_group) > 0 and
     a.hrm_history_detail_id = b.hrm_history_detail_id and
     b.hrm_employee_id = c.hrm_employee_id and
     hit_pay_num = his_pay_num and
     b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
     hit_accounted = 3
   UNION ALL
   SELECT
     aa.hrm_employee_id,
     main_id hrm_elements_id,
     aa.div division,
     substr(cg,1,2) dic_department_id,
     substr(cg,3,3) job_code,
     HDB_AMOUNT val,
     1 eeb_ratio_group
   FROM
     v_hrm_break_cg_div aa,
     hrm_break ab,
     hrm_history ac,
     hrm_formulas_structure e
   WHERE
     related_id=1881 and relation_type=1 and
     ac.hit_accounted=3 and
     ac.hit_pay_period=ab.brk_value_date and
     ab.hrm_break_id=(select max(hrm_break_id) from hrm_break ) and
     aa.hrm_break_id=ab.hrm_break_id and
     aa.hrm_employee_id=ac.hrm_employee_id and
     aa.hrm_elements_id=2798) A
GROUP BY
  hrm_employee_id,
  main_id,
  division,
  dic_department_id,
  job_code,
  eeb_ratio_group


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_PROP_VAL_ELT_P13" ("HRM_EMPLOYEE_ID", "MAIN_ID", "DIVISION", "DIC_DEPARTMENT_ID", "JOB_CODE", "VAL", "EEB_RATIO_GROUP") AS
  SELECT
  b.hrm_employee_id,
  main_id,
  eeb_divbase division,
  dic_department_id,
  job_code,
  sum(eeb_value) val,
  eeb_ratio_group
FROM
  hrm_formulas_structure e,
  hrm_history c,
  hrm_history_detail b,
  hrm_history_detail_break a,
  hrm_elements d
WHERE
  main_id in (SELECT hrm_elements_id FROM V_HRM_HISTORY_DETAIL_TO_BREAK) and
  related_id = b.hrm_elements_id and
  d.hrm_elements_id = main_id and
  relation_type = 1 and
  instr(ele_use_ratio_group, a.eeb_ratio_group) > 0 and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  b.hrm_employee_id = c.hrm_employee_id and
  hit_pay_num = his_pay_num and
  b.hrm_salary_sheet_id = c.hrm_salary_sheet_id and
  hit_accounted = 3 AND
  MAIN_ID=6103
GROUP BY
  b.hrm_employee_id,
  main_id,
  eeb_divbase,
  dic_department_id,
  job_code,
  eeb_ratio_group


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_QTY_TRANSFER" ("CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "SAB_PAY_DATE", "HRM_BREAK_ID") AS
  SELECT
  sb.sab_account_name,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'CDA') cda_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PF') pf_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PJ') pj_number,
  decode(sb.sab_amount_type, 'D', sb.sab_amount, 0) debit_amount,
  decode(sb.sab_amount_type, 'C', sb.sab_amount, 0) credit_amount,
  sb.sab_pay_date,
  sb.hrm_break_id
from
  hrm_elements_family f,
  hrm_elements_root r,
  hrm_salary_breakdown sb
where
  sb.dic_account_type_id = 'CPN' and
  f.hrm_elements_id = sb.hrm_elements_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  lower(r.c_root_function) = 'hours'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_ROUNDAMOUNT" ("HRM_HISTORY_DETAIL_ID", "SAB_SOURCE", "SAB_AMOUNT", "HRM_BREAK_ID", "DIC_ACCOUNT_TYPE_ID", "SAB_AMOUNT_TYPE") AS
  SELECT
  a.hrm_history_detail_id,
  a.sab_source,
  b.sab_amount,
  b.hrm_break_id,
  a.dic_account_type_id,
  b.sab_amount_type
FROM
  v_hrm_break_roundrow a,
  hrm_salary_breakdown b
WHERE
  a.hrm_history_detail_id = b.hrm_history_detail_id AND
  a.sab_source = b.sab_source AND
  a.sab_amount_type = b.sab_amount_type AND
  a.dic_account_type_id = b.dic_account_type_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_ROUNDDELTA" ("DIC_ACCOUNT_TYPE_ID", "HRM_HISTORY_DETAIL_ID", "TOT", "REALVAL", "DELTA", "SAB_AMOUNT_TYPE", "HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID") AS
  SELECT
  b.dic_account_type_id,
  a.hrm_history_detail_id,
  b.tot,
  a.his_pay_sum_val,
  (abs(a.his_pay_sum_val)-abs(b.tot)),
  b.sab_amount_type,
  a.hrm_employee_id,
  a.hrm_elements_id
FROM
  hrm_history_detail a,
 (SELECT
    a.hrm_elements_id,
    dic_account_type_id,
    sum(sab_amount) tot,
    hrm_history_detail_id,
    sab_amount_type
  FROM
    hrm_elements c,
    hrm_salary_breakdown a
  WHERE
    a.hrm_elements_id=c.hrm_elements_id
  GROUP BY
    a.hrm_elements_id,
    dic_account_type_id,
    hrm_history_detail_id,
    sab_amount_type) b
WHERE
  a.hrm_history_detail_id = b.hrm_history_detail_id AND
  (abs(a.his_pay_sum_val)-abs(b.tot)) < 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_ROUNDROW" ("HRM_HISTORY_DETAIL_ID", "SAB_SOURCE", "DIC_ACCOUNT_TYPE_ID", "SAB_AMOUNT_TYPE") AS
  SELECT
  a.hrm_history_detail_id,
  min(a.sab_source) sab_source,
  a.dic_account_type_id,
  a.sab_amount_type
FROM
  hrm_salary_breakdown a
GROUP BY
  a.hrm_history_detail_id,
  a.dic_account_type_id,
  a.sab_amount_type


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_1" ("HRM_HISTORY_DETAIL_ID", "SOURCE", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "HIS_PAY_PERIOD", "HIS_PAY_NUM", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "AMOUNT_TYPE") AS
  SELECT
  B.HRM_HISTORY_DETAIL_ID,
  EEB_SEQUENCE SOURCE,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  B.HIS_PAY_PERIOD,
  B.HIS_PAY_NUM,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  Decode(sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(EEB_VALUE) BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(nvl(EEB_D_CGBASE,to_char(to_number(ELE_D_CGBASE)+decode(ELE_D_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0))),'99999') ACCOUNT_NAME,
  ELE_D_CG_SHIFT_ID HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(EEB_VALUE),-1,'C','D') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B,
  HRM_HISTORY_DETAIL_BREAK C
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.HRM_HISTORY_DETAIL_ID = C.HRM_HISTORY_DETAIL_ID and
  EEB_RATIO_GROUP > 0 and
  ELE_IS_BREAK_DEBIT = 1
UNION
--Debit DIV--
SELECT
  B.HRM_HISTORY_DETAIL_ID,
  EEB_SEQUENCE SOURCE,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  B.HIS_PAY_PERIOD,
  B.HIS_PAY_NUM,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(EEB_VALUE) BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(EEB_DIVBASE,ELE_D_DIVBASE),'000') ACCOUNT_NAME,
  ELE_D_DIV_SHIFT_ID HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(EEB_VALUE),-1,'C','D') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B,
  HRM_HISTORY_DETAIL_BREAK C
WHERE
  A.HRM_ELEMENTS_ID=B.HRM_ELEMENTS_ID and
  B.HRM_HISTORY_DETAIL_ID=C.HRM_HISTORY_DETAIL_ID and
  EEB_RATIO_GROUP>0 and
  ELE_D_IS_BREAK_DIV=1
UNION
--Crdit CG--
SELECT
  B.HRM_HISTORY_DETAIL_ID,
  EEB_SEQUENCE SOURCE,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  B.HIS_PAY_PERIOD,
  B.HIS_PAY_NUM,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(EEB_VALUE) BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(nvl(EEB_C_CGBASE, to_char(to_number(ELE_C_CGBASE)+decode(ELE_C_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0))), '99999') ACCOUNT_NAME,
  ELE_D_CG_SHIFT_ID HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(EEB_VALUE),-1,'D','C') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B,
  HRM_HISTORY_DETAIL_BREAK C
WHERE
  A.HRM_ELEMENTS_ID=B.HRM_ELEMENTS_ID
  AND B.HRM_HISTORY_DETAIL_ID=C.HRM_HISTORY_DETAIL_ID
  AND EEB_RATIO_GROUP>0
  AND ELE_IS_BREAK_CREDIT=1
UNION
--Credit DIV--
SELECT
  B.HRM_HISTORY_DETAIL_ID,
  EEB_SEQUENCE SOURCE,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  B.HIS_PAY_PERIOD,
  B.HIS_PAY_NUM,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(EEB_VALUE)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(EEB_VALUE) BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(EEB_DIVBASE,ELE_C_DIVBASE),'000') ACCOUNT_NAME,
  ELE_C_DIV_SHIFT_ID HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(EEB_VALUE),-1,'D','C') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B,
  HRM_HISTORY_DETAIL_BREAK C
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.HRM_HISTORY_DETAIL_ID = C.HRM_HISTORY_DETAIL_ID and
  EEB_RATIO_GROUP > 0 and
  ELE_IS_BREAK_CREDIT = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_14" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SOURCE", "HIS_PAY_PERIOD", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "AMOUNT_TYPE") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_D_CGBASE)+decode(ELE_D_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)),0 )),'99999') ACCOUNT_NAME,
  nvl(ELE_D_CG_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_P13 C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_IS_BREAK_DEBIT = 1 and A.HRM_ELEMENTS_ID=6103
UNION
-- Dbit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_D_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_P13 C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_D_IS_BREAK_DIV = 1 and A.HRM_ELEMENTS_ID=6103
UNION
--Crdit CG--
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_C_CGBASE)+decode(ELE_C_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)),0 )),'99999') ACCOUNT_NAME,
  nvl(ELE_C_CG_SHIFT_ID,0),
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_P13 C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_IS_BREAK_CREDIT = 1 and A.HRM_ELEMENTS_ID=6103
UNION
-- Crdit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_c_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_P13 C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_C_IS_BREAK_DIV = 1 and A.HRM_ELEMENTS_ID=6103


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_16" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SOURCE", "HIS_PAY_PERIOD", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "AMOUNT_TYPE") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  CG ACCOUNT_NAME,
  nvl(ELE_D_CG_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_13M C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  A.ELE_IS_BREAK_DEBIT = 1 and A.HRM_ELEMENTS_ID = 2798
UNION
-- Dbit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  DIV ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_13M C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  A.ELE_D_IS_BREAK_DIV = 1  and A.HRM_ELEMENTS_ID = 2798
UNION
  --Crdit CG--
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  CG ACCOUNT_NAME,
  nvl(ELE_C_CG_SHIFT_ID,0),
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_13M C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  A.ELE_IS_BREAK_CREDIT = 1  and A.HRM_ELEMENTS_ID = 2798
UNION
-- Crdit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  DIV ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_13M C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  A.ELE_C_IS_BREAK_DIV = 1  and A.HRM_ELEMENTS_ID = 2798


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_2" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SOURCE", "HIS_PAY_PERIOD", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "AMOUNT_TYPE") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_D_CGBASE)+decode(ELE_D_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0)), '99999') ACCOUNT_NAME,
  nvl(ELE_D_CG_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_N C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_IS_BREAK_DEBIT = 1
UNION
-- Dbit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_D_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_N C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_D_IS_BREAK_DIV = 1
UNION
--Crdit CG--
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_C_CGBASE)+decode(ELE_C_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0)), '99999') ACCOUNT_NAME,
  nvl(ELE_C_CG_SHIFT_ID,0),
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_N C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_IS_BREAK_CREDIT = 1
UNION
-- Crdit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_c_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP_N C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.main_id and
  ELE_C_IS_BREAK_DIV = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_3" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SOURCE", "HIS_PAY_PERIOD", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "AMOUNT_TYPE") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_D_CGBASE)+decode(ELE_D_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0)), '99999') ACCOUNT_NAME,
  nvl(ELE_D_CG_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_IS_BREAK_DEBIT = 1
UNION
-- Dbit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_D_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_D_IS_BREAK_DIV = 1
UNION
--Crdit CG--
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_C_CGBASE)+decode(ELE_C_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0)), '99999') ACCOUNT_NAME,
  nvl(ELE_C_CG_SHIFT_ID,0),
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_IS_BREAK_CREDIT = 1
UNION
-- Crdit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  round(decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate*20)/20 BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_c_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_C_IS_BREAK_DIV = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_4" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SOURCE", "HIS_PAY_PERIOD", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "AMOUNT_TYPE") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_D_CGBASE)+decode(ELE_D_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0)), '99999') ACCOUNT_NAME,
  nvl(ELE_D_CG_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_IS_BREAK_DEBIT = 1
UNION
-- Dbit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_D_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_D_IS_BREAK_DIV = 1
UNION
--Crdit CG--
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(to_char(to_number(ELE_C_CGBASE)+decode(ELE_C_CG_SHIFT_ID,100,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000,500,TO_NUMBER(NVL(DIC_DEPARTMENT_ID,0))*1000+TO_NUMBER(NVL(JOB_CODE,0)), 0)), '99999') ACCOUNT_NAME,
  nvl(ELE_C_CG_SHIFT_ID,0),
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_IS_BREAK_CREDIT = 1
UNION
-- Crdit DIV
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  B.HRM_EMPLOYEE_ID,
  SOURCE,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL)*rate BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(nvl(ELE_c_DIVBASE,DIVISION),'000') ACCOUNT_NAME,
  0 HRM_BREAK_SHIFT_ID,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  V_HRM_BREAK_PROP C,
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_to_break B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID and
  B.hrm_employee_id = c.hrm_employee_id and
  B.hrm_elements_id = c.hrm_elements_id and
  ELE_C_IS_BREAK_DIV = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SOURCE_OTHER" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SOURCE", "HIS_PAY_PERIOD", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_ZL", "BREAK_VALUE", "ACCOUNT_TYPE", "ACCOUNT_NAME", "HRM_BREAK_SHIFT_ID", "ELE_USE_RATIO_GROUP", "AMOUNT_TYPE") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  HRM_EMPLOYEE_ID,
  to_char(HRM_HISTORY_DETAIL_ID) source,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL) BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(ELE_D_CGBASE,'99999') ACCOUNT_NAME,
  nvl(ELE_D_CG_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  ELE_USE_RATIO_GROUP,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID AND
  ELE_IS_BREAK_DEBIT = 1
UNION
-- div dbit
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  HRM_EMPLOYEE_ID,
  to_char(HRM_HISTORY_DETAIL_ID) source,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL) BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(ELE_D_DIVBASE,'000') ACCOUNT_NAME,
  nvl(ELE_D_DIV_SHIFT_ID,0) HRM_BREAK_SHIFT_ID,
  ELE_USE_RATIO_GROUP,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'C','D') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID AND
  ELE_D_IS_BREAK_DIV = 1
UNION
--Crdit CG--
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  HRM_EMPLOYEE_ID,
  to_char(HRM_HISTORY_DETAIL_ID) source,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL) BREAK_VALUE,
  'CG' ACCOUNT_TYPE,
  nvl(Ele_C_CGBASE,'99999') ACCOUNT_NAME,
  nvl(ELE_C_CG_SHIFT_ID,0),
  ELE_USE_RATIO_GROUP,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID AND
  ELE_IS_BREAK_CREDIT = 1
UNION
-- DIV dbit
SELECT
  HRM_HISTORY_DETAIL_ID,
  B.HRM_ELEMENTS_ID,
  HRM_EMPLOYEE_ID,
  to_char(HRM_HISTORY_DETAIL_ID) source,
  HIS_PAY_PERIOD,
  B.ACS_FINANCIAL_CURRENCY_ID,
  HIS_CURRENCY_VALUE,
  HIS_REF_VALUE,
  HIS_ZL,
  decode(sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))),0,1,sign((1-ELE_SWAP_DC)*Sign(HIS_PAY_SUM_VAL)*(1-2*(ELE_IS_BREAK_INVERSE))))*abs(HIS_PAY_SUM_VAL) BREAK_VALUE,
  'DIV' ACCOUNT_TYPE,
  nvl(ELE_C_DIVBASE,'000') ACCOUNT_NAME,
  nvl(ELE_C_DIV_SHIFT_ID,0),
  ELE_USE_RATIO_GROUP,
  DECODE(ELE_SWAP_DC*SIGN(HIS_PAY_SUM_VAL),-1,'D','C') AMOUNT_TYPE
FROM
  HRM_ELEMENTS A,
  V_HRM_HISTORY_DETAIL_TO_BREAK B
WHERE
  A.HRM_ELEMENTS_ID = B.HRM_ELEMENTS_ID AND
  ELE_C_IS_BREAK_DIV = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_STRUCTURE" ("ELEMENT", "TYPE", "COMPTE", "DEPLACEMENT") AS
  SELECT
  b.ele_descr||' ('||a.bre_item_name||')',
  decode(sign(c.ald_rate),-1,'C','D'),
  d.dta_descr||' '||c.ald_acc_name,
  decode(e.hrm_break_shift_id,0,'',e.brs_code)
FROM
  hrm_break_structure a,
  hrm_elements_descr b,
  hrm_allocation_detail c,
  dic_account_type d,
  hrm_break_shift e
WHERE
  a.bre_item_id = b.hrm_elements_id AND
  b.pc_lang_id = pcs.PC_I_LIB_SESSION.GetUserLangId AND
  c.hrm_allocation_id = a.hrm_allocation_id AND
  c.dic_account_type_id = d.dic_account_type_id AND
  c.hrm_break_shift_id = e.hrm_break_shift_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BREAK_SUM" ("HRM_HISTORY_DETAIL_ID", "DIC_ACCOUNT_TYPE_ID", "SAB_AMOUNT_TYPE", "TOT") AS
  SELECT
  hrm_history_detail_id,
  dic_account_type_id,
  sab_amount_type,
  sum(sab_amount)
FROM
  hrm_salary_breakdown b
GROUP BY
  hrm_history_detail_id,
  dic_account_type_id,
  sab_amount_type


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BUDGET_BREAK" ("HRM_ELEMENTS_ID", "HBU_CG_ACCOUNT", "HBU_DIV_ACCOUNT", "HBU_REC_ACCOUNT", "HBU_CPN_ACCOUNT", "HBU_CDA_ACCOUNT", "HBU_PF_ACCOUNT", "HBU_PJ_ACCOUNT", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "HBU_AMOUNT", "HBU_AMOUNT_TYPE", "HBU_SOURCE", "HRM_BUDGET_VERSION_ID", "HRM_BUDGET_DETAIL_ID") AS
  SELECT
  hrm_elements_id,
  hbu_cg_account,
  hbu_div_account,
  hbu_rec_account,
  hbu_cpn_account,
  hbu_cda_account,
  hbu_pf_account,
  hbu_pj_account,
  decode (hbu_amount_type,'D',hbu_amount,0) debit_amount,
  decode (hbu_amount_type,'C',hbu_amount,0) credit_amount,
  hbu_amount,
  hbu_amount_type,
  hbu_source,
  hrm_budget_version_id,
  hrm_budget_detail_id
FROM hrm_budget_break




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_BUDGET_BREAK_COMPARE" ("HBU_YEAR", "HBU_VERSION", "EMPID", "ELEMID", "CG_NUMBER", "DIV_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "AMOUNT", "TYP") AS
  SELECT
  TO_NUMBER(TO_CHAR(brk_value_date, 'YYYY')) hbu_year,
  '' hbu_version,
  pername,
  hrm_elements_id,
  cg_number,
  div_number,
  cpn_number,
  cda_number,
  pf_number,
  pj_number,
  SUM(debit_amount - credit_amount) amount,
  'REAL' typ

FROM
  v_hrm_break_cgan v,
  hrm_break b
WHERE
  v.hrm_break_id = b.hrm_break_id
GROUP BY
  brk_value_date,
  pername,
  hrm_elements_id,
  cg_number,
  div_number,
  cpn_number,
  cda_number,
  pf_number,
  pj_number
UNION ALL
SELECT
  hbu_year,
  hbu_version,
  per_last_name || ' ' || per_first_name,
  b.hrm_elements_id,
  hbu_cg_account,
  hbu_div_account,
  hbu_cpn_account,
  hbu_cda_account,
  hbu_pf_account,
  hbu_pj_account,
  SUM (hbu_amount * DECODE (hbu_amount_type, 'D', 1, -1)),
  'BUD' amount

FROM
  hrm_budget_header h,
  hrm_budget_detail d,
  hrm_budget_break b,
  hrm_budget_version v
WHERE
  b.hrm_budget_version_id = v.hrm_budget_version_id AND
  d.hrm_budget_detail_id = b.hrm_budget_detail_id AND
  h.hrm_budget_header_id = d.hrm_budget_header_id
GROUP BY
  hbu_year,
  hbu_version,
  per_last_name,
  per_first_name,
  b.hrm_elements_id,
  hbu_cg_account,
  hbu_div_account,
  hbu_cpn_account,
  hbu_cda_account,
  hbu_pf_account,
  hbu_pj_account


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_CDA_ACCOUNT" ("ACS_CDA_ACCOUNT_ID", "ACS_CDA_NUMBER") AS
  SELECT
  b.acs_cda_account_id,
  a.acc_number acs_cda_number
FROM
  acs_account a,
  acs_cda_account b
WHERE
  a.acs_account_id = b.acs_cda_account_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_COMP_ELEMENTS" ("ELEMID", "COM_FROM", "COM_TO", "NUM_AMOUNT", "AMOUNT") AS
  SELECT
  c.hrm_elements_id,
  c.com_from,
  c.com_to,
  to_char (c.com_num_amount),
  c.com_amount
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_company_elements c
WHERE
  r.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = c.hrm_elements_id AND
  c.com_active = 1  AND
  r.elr_from <= hrm_date.ActivePeriodEndDate and
  r.elr_to >= hrm_date.ActivePeriod


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_COMP_ELEM_BUDGET" ("ELEMID", "AMOUNT") AS
  SELECT
  c.hrm_elements_id,
  to_char(round (sum (c.com_num_amount *
                      hrm_date.days_between (greatest (trunc (c.com_from,'Month'), hrm_date.activeperiod),
                                             least (last_day (c.com_to), hrm_date.activeperiodenddate))) /
                 sum (hrm_date.days_between (greatest (trunc (c.com_from,'Month'), hrm_date.activeperiod),
                                             least (last_day (c.com_to), hrm_date.activeperiodenddate))),
                 r.elr_input_precision)) amount
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_company_elements c
WHERE
  c.hrm_elements_id = f.hrm_elements_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  hrm_date.validforactiveperiod (c.com_from,c.com_to) = 1 and
  r.elr_format = 1 -- montants
GROUP BY
  c.hrm_elements_id,
  r.elr_input_precision




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_CONSTANTS" ("CONSTID", "CODE", "DESCR", "IS_REPORTING", "STATCODE", "SIGN", "LANGID") AS
  SELECT
  a.hrm_constants_id,
  a.con_code,
  b.con_descr,
  hrm_utils.BoolToStr(a.con_reporting),
  con_stat_code,
  con_sign,
  b.pc_lang_id
FROM
  hrm_const_descr b,
  hrm_constants a
WHERE
  b.HRM_constants_ID = a.hrm_constants_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_CONSTANTS_DETAIL" ("CONSTID", "CODE", "DESCR", "EXPRESSION", "FREEVAL", "DICO", "FORMAT", "PRECISION", "ROUND", "BEGINDATE", "ENDDATE", "ACTIVE", "MANDATORY", "CORRELATEDID", "REPORTING", "MULTICURRENCY", "CURRENCY", "CONSTTYPE") AS
  SELECT
  a.hrm_Constants_id,
  a.Con_code,
  b.Con_descr,
  a.Con_Expression,
  nvl2(a.hrm_code_dic_id, hrm_utils.get_FalseBoolStr, hrm_utils.get_TrueBoolStr),
  a.hrm_code_dic_id,
  a.Con_format,
  a.Con_precision,
  a.Con_round,
  a.Con_from,
  a.Con_to,
  hrm_utils.BoolToStr(a.con_active),
  hrm_utils.BoolToStr(a.con_mandatory),
  a.con_correlated_id,
  a.con_reporting,
  a.con_multi_currency,
  a.acs_financial_currency_id,
  a.c_hrm_sal_const_type
FROM
  hrm_constants a,
  hrm_const_descr b
WHERE
  b.hrm_constants_ID = a.hrm_constants_id AND
  b.pc_lang_id = (SELECT pc_lang_id
                  FROM pcs.pc_user
                  WHERE use_name = user)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_CONTROL_ELEMENTS" ("ELEMID", "LISTID", "ELEMCODE", "ELEMDESCR", "BOX") AS
  SELECT
  a.hrm_control_elements_id,
  to_char(a.hrm_control_list_id),
  a.coe_code,
  a.coe_descr,
  a.coe_box
FROM
  hrm_control_elements a


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_CPN_ACCOUNT" ("ACS_CPN_ACCOUNT_ID", "ACS_CPN_NUMBER") AS
  SELECT
  b.acs_cpn_account_id,
  a.acc_number acs_cpn_number
FROM
  acs_account a,
  acs_cpn_account b
WHERE
  a.acs_account_id = b.acs_cpn_account_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DADS_EMPL_PAY" ("EMPID", "INOUTID", "PAYYEAR", "PAY") AS
  select
  I.HRM_EMPLOYEE_ID EMPID,
  I.HRM_IN_OUT_ID INOUTID,
  to_char(H.HIT_PAY_PERIOD, 'YYYY') PAYYEAR,
  H.HIT_PAY_NUM PAY
from
  HRM_HISTORY H,
  HRM_IN_OUT I
where
  I.C_IN_OUT_CATEGORY = '3' and
  H.HRM_EMPLOYEE_ID = I.HRM_EMPLOYEE_ID and
  H.HIT_PAY_PERIOD between I.INO_IN AND
        (select Nvl(Min(INO_IN)-1, hrm_date.endOfYear)
         from HRM_IN_OUT
         where HRM_EMPLOYEE_ID = I.HRM_EMPLOYEE_ID and
           C_IN_OUT_CATEGORY = '3' and
           INO_IN > I.INO_OUT)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DADS_EMPL_PERIOD" ("HRM_EMPLOYEE_ID", "HRM_IN_OUT_ID", "HRM_ESTABLISHMENT_ID", "INO_IN", "INO_OUT", "DIC_IN_TYPE_ID", "DIC_OUT_TYPE_ID", "HRM_CONTRACT_ID", "C_CONTRACT_TYPE", "DIC_CONTRACT_CATEGORY_ID", "EST_NAME", "EST_SIRET", "FIRSTPAY", "LASTPAY", "PAYYEAR") AS
  select
  V.EMPID,
  V.INOUTID,
  I.HRM_ESTABLISHMENT_ID,
  I.INO_IN,
  I.INO_OUT,
  I.DIC_IN_TYPE_ID,
  I.DIC_OUT_TYPE_ID,
  C.HRM_CONTRACT_ID,
  C.C_CONTRACT_TYPE,
  C.DIC_CONTRACT_CATEGORY_ID,
  E.EST_NAME,
  E.EST_SIRET,
  V.FIRSTPAY,
  V.LASTPAY,
  V.PAYYEAR
from
  HRM_ESTABLISHMENT E,
  HRM_CONTRACT C,
  HRM_IN_OUT I,
  (select EMPID, Min(PAY) FIRSTPAY, Max(PAY) LASTPAY, INOUTID, PAYYEAR
   from V_HRM_DADS_EMPL_PAY
   group by INOUTID, PAYYEAR, EMPID) v
where
  I.C_IN_OUT_CATEGORY = '3' and
  C.HRM_IN_OUT_ID(+) = I.HRM_IN_OUT_ID and
  E.HRM_ESTABLISHMENT_ID(+) = I.HRM_ESTABLISHMENT_ID and
  I.HRM_IN_OUT_ID = V.INOUTID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DBA_ELEMENTS" ("ELEMID", "CODE", "FDESCR", "DDESCR", "EDESCR", "FORMAT", "PRECISION", "ROUND", "BEGINDATE", "ENDDATE", "VAR", "ACTIVE", "ISSQL", "SQLVCI", "ALIAS") AS
  SELECT
  a.hrm_elements_id,
  a.ele_code,
  b.ele_descr,
  c.ele_descr,
  d.ele_descr,
  a.ele_format,
  a.ele_precision,
  a.ele_round,
  a.ele_valid_from,
  a.ele_valid_to,
  hrm_utils.BoolToStr(a.ele_variable),
  hrm_utils.BoolToStr(a.ele_active),
  hrm_utils.BoolToStr(a.ele_is_Sql),
  a.ele_sql,
  a.ele_Alias_Name
FROM
  hrm_elements a,
  hrm_elements_descr b,
  hrm_elements_descr c,
  hrm_elements_descr d
WHERE
  (a.hrm_elements_id = b.hrm_elements_id and b.pc_lang_id(+) = 1) AND
  (a.hrm_elements_id = c.hrm_elements_id(+) and c.pc_lang_id(+) = 2) AND
  (a.hrm_elements_id = d.hrm_elements_id(+) and d.pc_lang_id(+) = 3)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DBA_ELEMENTS_CELL" ("HRM_ELEMENTS_ID", "ELE_CODE", "ELE_DESCR", "FOR_EXPRESSION") AS
  SELECT
  e.hrm_elements_id,
  e.ele_code,
  de.ele_descr,
  f.for_expression
FROM
  hrm_formulas f,
  hrm_elements_descr de,
  hrm_elements e
WHERE
  f.hrm_elements_id = e.hrm_elements_id and
  de.hrm_elements_id = e.hrm_elements_id and
  de.pc_lang_id = (SELECT pc_lang_id
                   FROM pcs.pc_user
                   WHERE Use_name = user) and
  InStr(f.for_expression,'!') <> 0
UNION
SELECT
  c.hrm_constants_id,
  c.con_code,
  dc.con_descr,
  c.con_expression
FROM
  hrm_const_descr dc,
  hrm_constants c
WHERE
  c.hrm_constants_id = dc.hrm_constants_id and
  dc.pc_lang_id = (SELECT pc_lang_id
                   FROM pcs.pc_user
                   WHERE Use_name = user)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DEFINED_NAMES" ("IS_ELEMENT", "ID", "CODE", "DESCR", "IS_REPORTING", "STATCODE", "SIGN", "LANGID") AS
  SELECT
  hrm_utils.get_TrueBoolStr,
  elemid,
  code,
  descr,
  Is_Reporting,
  statcode,
  sign,
  langid
FROM
  v_hrm_elements
UNION ALL
SELECT
  hrm_utils.get_FalseBoolStr,
  constid,
  code,
  descr,
  Is_Reporting,
  statcode statcode,
  sign sign,
  langid
FROM
  v_hrm_constants




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DEFINED_NAMES_COMPTA" ("HRM_ELEMENTS_ID", "ELE_USE_RATIO_GROUP", "ELE_IS_BREAK_INVERSE", "ELE_SWAP_DC", "ELE_IS_BREAK_DEBIT", "ELE_IS_BREAK_CREDIT", "ELE_D_CGBASE", "ELE_D_CG_SHIFT_ID", "ELE_D_IS_BREAK_DIV", "ELE_D_CPNBASE", "ELE_D_PFEMPL", "ELE_D_PFBASE", "ELE_D_PF_SHIFT_ID", "ELE_D_PJEMPL", "ELE_D_PJBASE", "ELE_D_PJ_SHIFT_ID", "ELE_D_CDAEMPL", "ELE_D_CDABASE", "ELE_D_CDA_SHIFT_ID", "ELE_C_CGBASE", "ELE_C_CG_SHIFT_ID", "ELE_C_IS_BREAK_DIV", "ELE_C_DIV_SHIFT_ID", "ELE_C_CPNBASE", "ELE_C_PFEMPL", "ELE_C_PFBASE", "ELE_C_PF_SHIFT_ID", "ELE_C_PJEMPL", "ELE_C_PJBASE", "ELE_C_PJ_SHIFT_ID", "ELE_C_CDAEMPL", "ELE_C_CDABASE", "ELE_C_CDA_SHIFT_ID", "ELE_C_DIVBASE", "ELE_D_DIVBASE", "ELE_IS_BREAK") AS
  SELECT
  a.HRM_ELEMENTS_ID, a.ELE_USE_RATIO_GROUP, a.ELE_IS_BREAK_INVERSE,
  a.ELE_SWAP_DC, a.ELE_IS_BREAK_DEBIT, a.ELE_IS_BREAK_CREDIT,
  a.ELE_D_CGBASE, a.ELE_D_CG_SHIFT_ID, a.ELE_D_IS_BREAK_DIV,
  a.ELE_D_CPNBASE, a.ELE_D_PFEMPL, a.ELE_D_PFBASE,
  a.ELE_D_PF_SHIFT_ID, a.ELE_D_PJEMPL, a.ELE_D_PJBASE,
  a.ELE_D_PJ_SHIFT_ID, a.ELE_D_CDAEMPL, a.ELE_D_CDABASE,
  a.ELE_D_CDA_SHIFT_ID, a.ELE_C_CGBASE, a.ELE_C_CG_SHIFT_ID,
  a.ELE_C_IS_BREAK_DIV, a.ELE_C_DIV_SHIFT_ID, a.ELE_C_CPNBASE,
  a.ELE_C_PFEMPL, a.ELE_C_PFBASE, a.ELE_C_PF_SHIFT_ID,
  a.ELE_C_PJEMPL, a.ELE_C_PJBASE, a.ELE_C_PJ_SHIFT_ID,
  a.ELE_C_CDAEMPL, a.ELE_C_CDABASE, a.ELE_C_CDA_SHIFT_ID,
  a.ELE_C_DIVBASE, a.ELE_D_DIVBASE, a.ELE_IS_BREAK
FROM
  HRM_ELEMENTS a


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DEFINED_NAMES_DESCR" ("IS_ELEMENT", "ELEM_CONST_ID", "CODE", "LANG_ID", "DESCR", "SUBST_CODE", "COMMENTAIRE") AS
  SELECT
  hrm_utils.get_TrueBoolStr,
  a.hrm_elements_id,
  a.ele_code,
  b.pc_lang_id,
  b.ele_descr,
  b.ele_subst_code,
  b.ele_comment
FROM
  hrm_elements_descr b,
  hrm_elements a
WHERE
  a.hrm_elements_id = b.hrm_elements_id
UNION ALL
SELECT
  hrm_utils.get_FalseBoolStr,
  a.hrm_constants_id,
  a.con_code,
  b.pc_lang_id,
  b.con_descr,
  b.con_subst_code,
  b.con_comment
FROM
  hrm_const_descr b,
  hrm_constants a
WHERE
  a.hrm_constants_id = b.hrm_constants_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DEFINED_NAMES_DETAIL" ("IS_ELEMENT", "ELEM_CONST_ID", "CODE", "CORRELATED", "ALIAS_NAME", "SQL", "IS_SQL", "IS_FREE_VAL", "DICO_ID", "FORMAT", "PRECISION", "ROUND", "BEGINDATE", "ENDDATE", "IS_VARIABLE", "ACTIVE", "MANDATORY", "CORRELATEDID", "REPORTING", "MULTICURRENCY", "CURRENCY", "CONST_TYPE", "STATCODE", "SIGN", "DIC_GROUP1_ID", "DIC_GROUP2_ID", "DIC_GROUP3_ID", "DIC_GROUP4_ID", "BALANCE_TYPE", "IS_INDIV", "INPUT_MODE", "BREAK_INPUT_MODE", "USE_RATIO_GROUP", "IS_BREAK") AS
  SELECT
  hrm_utils.get_TrueBoolStr,
  a.hrm_elements_id,
  a.ele_code,
  b.code,
  a.ele_alias_name,
  a.ele_sql,
  hrm_utils.BoolToStr(a.ele_is_sql),
  hrm_utils.get_FalseBoolStr,
  0,
  a.ele_format,
  a.ele_precision,
  a.ele_round,
  a.ele_valid_from,
  a.ele_valid_to,
  hrm_utils.BoolToStr(a.ele_variable),
  hrm_utils.BoolToStr(a.ele_active),
  hrm_utils.get_FalseBoolStr,
  a.ele_correlated_id,
  hrm_utils.BoolToStr(a.ele_reporting),
  hrm_utils.BoolToStr(a.ele_multi_currency),
  a.acs_financial_currency_id,
  '',
  a.ele_stat_code,
  a.ele_sign,
  a.Dic_group1_id,
  a.Dic_group2_id,
  a.Dic_group3_id,
  a.Dic_group4_id,
  a.ele_type,
  a.ele_Is_Indiv,
  a.ele_input_Mode,
  a.ele_Break_Input_Mode,
  a.ele_Use_Ratio_Group,
  hrm_utils.BoolToStr(a.ele_is_break)
FROM
  hrm_elements a,
  v_hrm_elements_short b
WHERE
  a.ele_correlated_id = b.ElemId (+)
UNION
SELECT
  hrm_utils.get_FalseBoolStr,
  a.hrm_constants_id,
  a.con_code,
  b.code,
  '',
  '',
  hrm_utils.get_FalseBoolStr,
  nvl2(a.hrm_code_dic_id, hrm_utils.get_FalseBoolStr, hrm_utils.get_TrueBoolStr),
  a.hrm_code_dic_id,
  a.con_format,
  a.con_precision,
  a.con_round,
  a.con_from,
  a.con_to,
  hrm_utils.get_FalseBoolStr,
  hrm_utils.BoolToStr(a.con_active),
  hrm_utils.BoolToStr(a.con_mandatory),
  a.con_correlated_id,
  hrm_utils.BoolToStr(a.con_reporting),
  hrm_utils.BoolToStr(a.con_multi_currency),
  a.acs_financial_currency_id,
  a.c_hrm_sal_const_type,
  a.con_stat_code,
  a.con_sign,
  a.Dic_group1_id,
  a.Dic_group2_id,
  a.Dic_group3_id,
  a.Dic_group4_id,
  a.con_type,
  a.con_Is_Indiv,
  null,
  null,
  null,
  hrm_utils.get_FalseBoolStr
FROM
  hrm_constants a,
  v_hrm_elements_short b
WHERE
  a.con_correlated_id = b.ElemId (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DEFINED_NAMES_EXPR" ("ELEMID", "CODE", "EXPR") AS
  SELECT f.hrm_elements_id, s.code, f.elf_expression
  FROM
    v_hrm_elements_short s,
    hrm_elements_family f
  WHERE
    s.elemid = f.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_DICO_TABLE" ("CATEG", "CODE", "DESCR") AS
  SELECT
  b.dic_descr,
  a.Cod_Code,
  c.cod_descr
FROM
  hrm_code_descr c,
  hrm_code_table a,
  hrm_code_dic b
WHERE
  b.hrm_code_dic_id = a.hrm_code_dic_id and
  c.hrm_code_table_id = a.hrm_code_table_id and
  c.pc_lang_id = (SELECT pc_lang_id
                  FROM pcs.pc_user
                  WHERE use_name = user)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS" ("ELEMID", "CODE", "DESCR", "IS_REPORTING", "STATCODE", "SIGN", "LANGID") AS
  SELECT
  a.hrm_elements_id,
  a.ele_code,
  b.ele_descr,
  hrm_utils.BoolToStr(a.ele_reporting),
  ele_stat_code,
  ele_sign,
  b.pc_lang_id
FROM
  hrm_elements_descr b,
  hrm_elements a
WHERE
  b.hrm_elements_id = a.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_BREAK_V1" ("HRM_ELEMENTS_ID", "ELE_SWAP_DC", "ELE_IS_BREAK_INVERSE", "ELE_USE_RATIO_GROUP", "ACCOUNT_TYPE", "AMOUNT_TYPE", "BASE", "SHIFT") AS
  SELECT
  hrm_elements_id,
  ELE_SWAP_DC,
  ELE_IS_BREAK_INVERSE,
  ELE_USE_RATIO_GROUP,
  'CG' account_type,
  'D' amount_type,
  ele_d_cgbase BASE,
  ele_d_cg_shift_id shift
FROM
  hrm_elements
WHERE
  (ele_is_break_debit =1 or ele_d_is_break_div = 1) and
  (ele_d_cgbase is not null or ele_d_cg_shift_id is not null)
UNION ALL
SELECT
  hrm_elements_id,
  ELE_SWAP_DC,
  ELE_IS_BREAK_INVERSE,
  ELE_USE_RATIO_GROUP,
  'DIV' account_type,
  'D' amount_type,
  ele_d_divbase cgbase,
  ele_d_div_shift_id shift
FROM
  hrm_elements
WHERE
  (ele_is_break_debit =1 or ele_d_is_break_div = 1) and
  (ele_d_divbase is not null or ele_d_div_shift_id is not null)
UNION ALL
SELECT
  hrm_elements_id,
  ELE_SWAP_DC,
  ELE_IS_BREAK_INVERSE,
  ELE_USE_RATIO_GROUP,
  'CG' account_type,
  'C' amount_type,
  ele_C_cgbase cgbase,
  ele_C_cg_shift_id shift
FROM
  hrm_elements
WHERE
  (ele_is_break_CREDIT =1 or ele_C_is_break_div = 1) and
  (ele_C_cgbase is not null or ele_C_cg_shift_id is not null)
UNION ALL
SELECT
  hrm_elements_id,
  ELE_SWAP_DC,
  ELE_IS_BREAK_INVERSE,
  ELE_USE_RATIO_GROUP,
  'DIV' account_type,
  'C' amount_type,
  ele_C_divbase cgbase,
  ele_C_div_shift_id shift
FROM
  hrm_elements
WHERE
  (ele_is_break_CREDIT =1 or ele_C_is_break_div = 1) and
  (ele_C_divbase is not null or ele_C_div_shift_id is not null)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_DETAIL" ("ELEMID", "CODE", "DESCRIPTION", "FORMAT", "PRECISION", "ROUND", "BEGINDATE", "ENDDATE", "VAR", "ACTIVE", "CORRELATEDID", "REPORTING", "MULTICURRENCY", "CURRENCY") AS
  SELECT
  a.hrm_elements_id,
  a.ele_code,
  b.ele_descr,
  a.ele_format,
  a.ele_precision,
  a.ele_round,
  a.ele_valid_from,
  a.ele_valid_to,
  hrm_utils.BoolToStr(a.ele_variable),
  hrm_utils.BoolToStr(a.ele_active),
  a.ele_correlated_id,
  hrm_utils.BoolToStr(a.ele_reporting),
  hrm_utils.BoolToStr(a.ele_multi_currency),
  a.acs_financial_currency_id
FROM
  hrm_elements_descr b,
  hrm_elements a
WHERE
  a.Ele_Active = 1 and
  a.Ele_variable = 1 and
  b.hrm_elements_id = a.hrm_elements_id and
  b.pc_lang_id = (SELECT pc_lang_id
                  FROM pcs.pc_user
                  WHERE use_name = user)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_LINK1" ("MAIN_ID", "MAIN_CODE", "LINK1_ID", "EMPID", "EMPELEMID", "BASEAMOUNT", "RATE", "PERRATE", "EMP_VALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "EMP_ACTIVE", "CURRENCY") AS
  SELECT
  b.main_id,
  b.main_code,
  b.link1_id,
  hrm_employee_id empid,
  hrm_employee_elements_id EmpElemId,
  a.emp_base_amount baseamount,
  a.emp_rate rate,
  a.emp_per_rate perrate,
  a.emp_value,
  a.emp_text Text,
  a.emp_override Override,
  a.emp_foreign_value ExValue,
  a.emp_ref_value refValue,
  a.emp_ZL ZL,
  a.Emp_Active,
  d.acs_financial_currency_id currency
FROM
  hrm_employee_elements a,
  hrm_elements d,
  hrm_elements_link b,
  hrm_period c
WHERE
  b.link1_id = a.hrm_elements_id and
  d.hrm_elements_id=b.main_id and
  c.per_act = 1 and
  a.emp_value_from <= c.per_end and
  a.emp_value_to>= c.per_begin


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_LINK2" ("MAIN_ID", "MAIN_CODE", "LINK2_ID", "EMPID", "EMPELEMID", "BASEAMOUNT", "RATE", "PERRATE", "EMP_VALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "EMP_ACTIVE", "CURRENCY") AS
  SELECT
  b.main_id main_id,
  b.main_code main_code,
  b.link2_id link2_id,
  hrm_employee_id empid,
  hrm_employee_const_id EmpElemId,
  a.emc_base_amount baseamount,
  a.emc_rate rate,
  a.emc_per_rate perrate,
  a.emc_value,
  a.emc_text Text,
  a.emc_override Override,
  a.emc_foreign_value ExValue,
  a.emc_ref_value refValue,
  a.emc_ZL ZL,
  a.emc_Active,
  d.acs_financial_currency_id currency
FROM
  hrm_employee_const a,
  hrm_elements d,
  hrm_elements_link b,
  hrm_period c
WHERE
  b.link2_id = a.hrm_constants_id and
  d.hrm_elements_id = b.main_id and
  c.per_act = 1 and
  a.emc_value_from <= c.per_end and
  a.emc_value_to >= c.per_begin and
  b.main_id not in (SELECT d.main_id
                    FROM
                      hrm_employee_elements c,
                      hrm_elements_link d,
                      hrm_period e
                    WHERE
                      c.hrm_employee_id = a.hrm_employee_id and
                      d.link1_id = c.hrm_elements_id and
                      e.per_act = 1 and
                      c.emp_value_from <= e.per_end and
                      c.emp_value_to >= e.per_begin)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_NEW_LINK1" ("MAIN_ID", "MAIN_CODE", "LINK1_ID", "EMPID", "EMPELEMID", "BASEAMOUNT", "RATE", "PERRATE", "EMP_VALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "EMP_ACTIVE", "CURRENCY", "EXRATE") AS
  select
  D.HRM_ELEMENTS_ID MAIN_ID,
  D.ELE_CODE MAIN_CODE,
  A.HRM_ELEMENTS_ID LINK1_ID,
  A.HRM_EMPLOYEE_ID EMPID,
  A.HRM_EMPLOYEE_ELEMENTS_ID EMPELEMID,
  A.EMP_BASE_AMOUNT BASEAMOUNT,
  A.EMP_RATE RATE,
  A.EMP_PER_RATE PERRATE,
  A.EMP_VALUE,
  A.EMP_TEXT TEXT,
  A.EMP_OVERRIDE OVERRIDE,
  A.EMP_FOREIGN_VALUE EXVALUE,
  A.EMP_REF_VALUE REFVALUE,
  A.EMP_ZL ZL,
  A.EMP_ACTIVE,
  Nvl(A.ACS_FINANCIAL_CURRENCY_ID, D.ACS_FINANCIAL_CURRENCY_ID) CURRENCY,
  A.EMP_EX_RATE
from
  HRM_ELEMENTS D,
  HRM_ELEMENTS_FAMILY C,
  HRM_ELEMENTS_FAMILY B,
  HRM_EMPLOYEE_ELEMENTS A
where
  A.EMP_ACTIVE = 1 and
  hrm_date.ValidForActivePeriod(A.EMP_VALUE_FROM, A.EMP_VALUE_TO) = 1 and
  B.HRM_ELEMENTS_ID = A.HRM_ELEMENTS_ID and
  C.HRM_ELEMENTS_ROOT_ID = B.HRM_ELEMENTS_ROOT_ID and
  C.ELF_IS_REFERENCE = 1 and
  D.HRM_ELEMENTS_ID = C.HRM_ELEMENTS_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_NEW_LINK2" ("MAIN_ID", "MAIN_CODE", "LINK2_ID", "EMPID", "EMPELEMID", "BASEAMOUNT", "RATE", "PERRATE", "EMP_VALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "EMP_ACTIVE", "CURRENCY", "EXRATE") AS
  select
  D.HRM_ELEMENTS_ID MAIN_ID,
  D.ELE_CODE MAIN_CODE,
  A.HRM_CONSTANTS_ID LINK1_ID,
  A.HRM_EMPLOYEE_ID EMPID,
  A.HRM_EMPLOYEE_CONST_ID EMPELEMID,
  A.EMC_BASE_AMOUNT BASEAMOUNT,
  A.EMC_RATE RATE,
  A.EMC_PER_RATE PERRATE,
  A.EMC_VALUE,
  A.EMC_TEXT TEXT,
  A.EMC_OVERRIDE OVERRIDE,
  A.EMC_FOREIGN_VALUE EXVALUE,
  A.EMC_REF_VALUE REFVALUE,
  A.EMC_ZL ZL,
  A.EMC_ACTIVE,
  Nvl(A.ACS_FINANCIAL_CURRENCY_ID, D.ACS_FINANCIAL_CURRENCY_ID) CURRENCY,
  A.EMC_EX_RATE
from
  HRM_ELEMENTS D,
  HRM_ELEMENTS_FAMILY C,
  HRM_ELEMENTS_FAMILY B,
  HRM_EMPLOYEE_CONST A
where
  A.EMC_ACTIVE = 1 and
  hrm_date.ValidForActivePeriod(A.EMC_VALUE_FROM, A.EMC_VALUE_TO) = 1 and
  B.HRM_ELEMENTS_ID = A.HRM_CONSTANTS_ID and
  C.HRM_ELEMENTS_ROOT_ID = B.HRM_ELEMENTS_ROOT_ID and
  C.ELF_IS_REFERENCE = 1 and
  D.HRM_ELEMENTS_ID = C.HRM_ELEMENTS_ID and
  not B.HRM_ELEMENTS_ROOT_ID in (
      select D.HRM_ELEMENTS_ROOT_ID
      from HRM_EMPLOYEE_ELEMENTS C, HRM_ELEMENTS_FAMILY D
      where C.HRM_EMPLOYEE_ID = A.HRM_EMPLOYEE_ID and
        C.EMP_ACTIVE = 1 and
        hrm_date.ValidForActivePeriod(C.EMP_VALUE_FROM, C.EMP_VALUE_TO)=1 and
        D.HRM_ELEMENTS_ID = C.HRM_ELEMENTS_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEMENTS_SHORT" ("IS_ELEMENT", "ELEMID", "CODE") AS
  SELECT
  hrm_utils.get_TrueBoolStr,
  hrm_elements_id,
  ele_code
FROM
  hrm_elements a
UNION ALL
SELECT
  hrm_utils.get_FalseBoolStr,
  hrm_constants_id,
  con_code
FROM
  hrm_constants




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELEM_CONST_DESCR" ("ELEM_CONST_ID", "CONST_TYPE", "CODE", "DESCR", "LANID", "ACTIVE", "INPUT", "SUBST_CODE", "STAT_CODE") AS
  SELECT
  a.hrm_constants_id,
  a.c_hrm_sal_const_type,
  a.con_code,
  b.con_descr,
  b.pc_lang_id,
  a.con_active,
  1 Input,
  b.con_subst_code,
  a.con_stat_code
FROM
  hrm_const_descr b,
  hrm_constants a
WHERE
  a.hrm_constants_id = b.hrm_constants_id
UNION
SELECT
  a.hrm_elements_id,
  '',
  a.ele_code,
  b.ele_descr,
  b.pc_lang_id,
  a.ele_active,
  a.ele_variable,
  b.ele_subst_code,
  a.ele_stat_code
FROM
  hrm_elements_descr b,
  hrm_elements a
WHERE
  a.hrm_elements_id = b.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_ALFA_SUM" ("LISTID", "INSURANCEID", "EMPID", "CANTON_WORK", "DATEIN", "DATEOUT", "SALARYCAFAMOUNT", "ALLOCAMOUNT", "ISRETRO") AS
  select   i.HRM_CONTROL_LIST_ID LISTID
         , i.HRM_INSURANCE_ID INSURANCEID
         , V.EMPID
         , V.CODE CANTON_WORK
         , INO_IN DATEIN
         , INO_OUT DATEOUT
         , sum(case
                 when V.COE_BOX = 'COL01' then V.HisPaySumVal
               end) as SalaryCAFAmount
         , sum(case
                 when V.COE_BOX = 'COL02' then V.HisPaySumVal
               end) as AllocAmount
         , case
             when ino_out < hrm_elm.beginofperiod then 1
             else 0
           end as IsRetro
      from V_HRM_ELM_BASE V
         , HRM_CONTROL_LIST C
         , HRM_INSURANCE I
     where C.C_CONTROL_LIST_TYPE = '112'
       and V.LISTID = C.HRM_CONTROL_LIST_ID
       and V.CODE <> 'N/A'
       and I.hrm_control_list_id = v.listid
       and (   I.DIC_CANTON_WORK_ID = CODE
            or I.DIC_CANTON_WORK_ID is null)
       and not exists(select 1
                        from HRM_INSURANCE
                       where C_HRM_INSURANCE = '06'
                         and DIC_CANTON_WORK_ID = V.CODE
                         and HRM_INSURANCE_ID <> I.HRM_INSURANCE_ID)
  group by i.HRM_CONTROL_LIST_ID
         , i.HRM_INSURANCE_ID
         , V.EMPID
         , V.INO_IN
         , V.INO_OUT
         , V.CODE
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_AVS_SUM" ("LISTID", "INSURANCEID", "EMPID", "CODE", "DATEIN", "DATEOUT", "SALARYAVSAMOUNT", "SALARYACAMOUNT", "SALARYAC2AMOUNT", "FREEAVSAMOUNT", "FREEACAMOUNT", "ISRETRO") AS
  select   v.LISTID
         , i.HRM_INSURANCE_ID INSURANCEID
         , V.EMPID
         , V.CODE
         , V.INO_IN DATEIN
         , V.INO_OUT DATEOUT
         , sum(case
                 when V.COE_BOX = 'COLA1' then V.HisPaySumVal
               end) as SalaryAVSAmount
         , sum(case
                 when V.COE_BOX = 'COLA2' then V.HisPaySumVal
               end) as SalaryACAmount
         , sum(case
                 when V.COE_BOX = 'COLA3' then V.HisPaySumVal
               end) as SalaryAC2Amount
         , sum(case
                 when V.COE_BOX = 'COLB1' then V.HisPaySumVal
               end) as FreeAVSAmount
         , sum(case
                 when V.COE_BOX = 'COLB2' then V.HisPaySumVal
               end) as FreeACAmount
         , case
             when ino_out < hrm_elm.beginofperiod then 1
             else 0
           end as IsRetro
      from V_HRM_ELM_BASE V
         , HRM_CONTROL_LIST C
         , hrm_insurance i
     where C.C_CONTROL_LIST_TYPE = '102'
       and V.LISTID = C.HRM_CONTROL_LIST_ID
       and i.hrm_control_list_id = v.listid
       and V.CODE <> 'N/A'
  group by v.LISTID
         , i.HRM_INSURANCE_ID
         , V.EMPID
         , V.INO_IN
         , V.INO_OUT
         , V.CODE
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_BASE" ("COE_BOX", "EMPID", "HISPAYSUMVAL", "CODE", "GRP", "FROMNUM", "TONUM", "INO_IN", "INO_OUT", "LISTID") AS
  select   coe_box
         , t.hrm_employee_id as empid
         , sum(his_pay_sum_val) hispaysumval
         , hisval code
         , hisgrp grp
         , fromnum
         , tonum
         , ino_in
         , nvl(ino_out, hrm_elm.EndOfPeriod) ino_out
         , t.hrm_control_list_id as listId
      from hrm_tmp_rep_period t
         , hrm_history_detail d
         , hrm_control_elements e
     where d.hrm_employee_id = t.hrm_employee_id
       and d.his_pay_num between t.fromnum and t.tonum
       and e.hrm_control_elements_id = d.hrm_elements_id
       and e.hrm_control_list_id = t.hrm_control_list_id
  group by t.hrm_control_list_id
         , t.hrm_employee_id
         , coe_box
         , fromnum
         , tonum
         , hisval
         , hisgrp
         , ino_in
         , ino_out
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_IJM_SUM" ("LISTID", "INSURANCEID", "EMPID", "CODE", "GRP", "DATEIN", "DATEOUT", "BASESUBAMCAMOUNT", "SALARYAMCAMOUNT", "ISRETRO") AS
  select   i.HRM_CONTROL_LIST_ID ListId
         , i.HRM_INSURANCE_ID InsuranceId
         , V.EMPID
         , V.CODE
         , V.GRP
         , V.INO_IN DateIn
         , V.INO_OUT DateOut
         , sum(case
                 when(V.COE_BOX = 'COL01') then V.HisPaySumVal
               end) BaseSubAMCAmount
         , sum(case
                 when(    V.GRP = 1
                      and V.COE_BOX = 'COL02')
                  or (    V.GRP = 2
                      and V.COE_BOX = 'COL03') then V.HisPaySumVal
               end) SalaryAMCAmount
         , case
             when ino_out < hrm_elm.beginofperiod then 1
             else 0
           end as IsRetro
      from V_HRM_ELM_BASE V
         , HRM_CONTROL_LIST C
         , hrm_insurance i
     where C.C_CONTROL_LIST_TYPE = '114'
       and V.LISTID = C.HRM_CONTROL_LIST_ID
       and v.listid = i.hrm_control_list_id
       and V.CODE not in('0', 'N/A')
  group by i.HRM_CONTROL_LIST_ID
         , i.HRM_INSURANCE_ID
         , V.EMPID
         , V.INO_IN
         , V.INO_OUT
         , V.CODE
         , V.GRP
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_INSURANCE" ("INSTITUTIONID", "INSURANCE", "REFERENCE", "PAYROLLUNIT", "COMPANYNAME", "PARTNERID", "CCNAME", "CCCOMPLADDR", "CCSTREET", "CCPOSTBOX", "CCZIP", "CCCITY", "CUSTOMERNUMBER", "CUSTOMERSUBNUMBER", "CONTRACTNUMBER", "LISTID") AS
  select InstitutionID
       , Insurance
       , reference
       , PayrollUnit
       , CompanyName
       , PartnerId
       , CCName
       , case
           when CCLineAddr2 is not null
            or CCLineAddr3 is not null then CCLineAddr1
         end as CCComplAddr
       , case
           when CCLineAddr2 is null
           and CCLineAddr3 is null then CCLineAddr1
           else CCLineAddr2
         end CCStreet
       , CCLineAddr3 as PostBox
       , CCZip
       , CCCity
       , CustomerNumber
       , CustomerSubNumber
       , ContractNumber
       , hrm_control_list_id
    from (select HRM_INSURANCE_ID as InstitutionID
               , C_HRM_INSURANCE as Insurance
               , INS_REFERENCE as reference
               , INS_NAME as CompanyName
               , INS_PAYROLLUNIT as payrollunit
               , INS_BROKER_NR as PartnerId
               , INS_BROKER_NAME as CCName
               , pcs.ExtractLine(INS_BROKER_ADDRESS, 1) as CCLineAddr1
               , pcs.ExtractLine(INS_BROKER_ADDRESS, 2) as CCLineAddr2
               , pcs.ExtractLine(INS_BROKER_ADDRESS, 3) as CCLineAddr3
               , INS_BROKER_ZIPCODE as CCZip
               , INS_BROKER_CITY as CCCity
               , INS_MEMBER_NR as CustomerNumber
               , INS_SECONDARY_NR as CustomerSubNumber
               , INS_CONTRACT_NR as ContractNumber
               , hrm_control_list_id
            from HRM_INSURANCE)
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_LAAC_SUM" ("LISTID", "INSURANCEID", "EMPID", "CODE", "GRP", "DATEIN", "DATEOUT", "BASESUBLAAAMOUNT", "SALARYLAAAMOUNT", "ISRETRO") AS
  select   i.HRM_CONTROL_LIST_ID LISTID
         , i.HRM_INSURANCE_ID INSURANCEID
         , V.EMPID
         , V.CODE
         , V.GRP
         , V.INO_IN DateIn
         , V.INO_OUT DateOut
         , sum(case
                 when(V.COE_BOX = 'COL01') then V.HisPaySumVal
               end) BaseSubLAAAmount
         , sum(case
                 when(    V.GRP = 1
                      and V.COE_BOX = 'COL02')
                  or (    V.GRP = 2
                      and V.COE_BOX = 'COL03') then V.HisPaySumVal
               end) SalaryLAAAmount
         , case
             when ino_out < hrm_elm.beginofperiod then 1
             else 0
           end as IsRetro
      from V_HRM_ELM_BASE V
         , HRM_CONTROL_LIST C
         , hrm_insurance i
     where C.C_CONTROL_LIST_TYPE = '113'
       and V.LISTID = C.HRM_CONTROL_LIST_ID
       and v.listid = i.hrm_control_list_id
       and V.CODE not in('0', 'N/A')
  group by i.HRM_CONTROL_LIST_ID
         , i.HRM_INSURANCE_ID
         , V.EMPID
         , V.INO_IN
         , V.INO_OUT
         , V.CODE
         , V.GRP
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_LAA_SUM" ("LISTID", "INSURANCEID", "EMPID", "CODE", "DATEIN", "DATEOUT", "GROSSAMOUNT", "BASESUBLAAAMOUNT", "SALARYLAAAMOUNT", "ISRETRO") AS
  select   i.HRM_CONTROL_LIST_ID LISTID
         , i.HRM_INSURANCE_ID INSURANCEID
         , EMPID
         , CODE
         , INO_IN DATEIN
         , INO_OUT DATEOUT
         , sum(case
                 when V.COE_BOX = 'COL01' then V.HisPaySumVal
               end) as GrossAmount
         , sum(case
                 when V.COE_BOX = 'COL02' then V.HisPaySumVal
               end) as BaseSubLAAAmount
         , sum(case
                 when V.COE_BOX = 'COL03' then V.HisPaySumVal
               end) as SalaryLAAAmount
         , case
             when ino_out < hrm_elm.beginofperiod then 1
             else 0
           end as IsRetro
      from V_HRM_ELM_BASE V
         , HRM_CONTROL_LIST C
         , hrm_insurance i
     where C.C_CONTROL_LIST_TYPE = '103'
       and V.LISTID = C.HRM_CONTROL_LIST_ID
       and v.listid = i.hrm_control_list_id
       and V.CODE not in('0', 'N/A')
  group by i.HRM_CONTROL_LIST_ID
         , i.HRM_INSURANCE_ID
         , V.EMPID
         , V.INO_IN
         , V.INO_OUT
         , V.CODE
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_LPP_SUM" ("LISTID", "INSURANCEID", "EMPID", "CODE", "DATEIN", "DATEOUT", "SALARYLPPAMOUNT") AS
  select   C.HRM_CONTROL_LIST_ID LISTID
         , C.HRM_INSURANCE_ID INSURANCEID
         , V.EMPID
         , V.CODE
         , V.INO_IN DateIn
         , V.INO_OUT DateOut
         , sum(case
                 when V.COE_BOX = 'COL01' then V.HisPaySumVal
               end) SalaryLPPAmount
      from V_HRM_ELM_BASE V
         , HRM_CONTROL_LIST C
     where C.C_CONTROL_LIST_TYPE = '006'
       and V.LISTID = C.HRM_CONTROL_LIST_ID
  group by C.HRM_CONTROL_LIST_ID
         , C.HRM_INSURANCE_ID
         , V.EMPID
         , V.INO_IN
         , V.INO_OUT
         , V.CODE
           with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_PERSON" ("EMPID", "FIRST_NAME", "LAST_NAME", "SEARCH_NAME", "MATRICULE", "SECUNO", "SECUNO2", "SEX", "BIRTH", "NATIONALITY", "CIVIL_STATUS", "SINGLE_PARENT", "ACTIVITY_RATE", "CANTON_WORK", "STREET", "POSTALCODE", "CITY", "STATE", "COUNTRY", "PER_TAXSTREET", "PER_TAXPOSTALCODE", "PER_TAXCITY", "PER_TAXCOUNTRY", "PER_TAXSTATE", "PER_HOMESTREET", "PER_HOMEPOSTALCODE", "PER_HOMECITY", "PER_HOMECOUNTRY", "PER_HOMESTATE", "OFS", "APPRENTICE", "LANGID", "PER_HOME_PHONE", "PER_EMAIL", "EMP_CIVIL_STATUS_SINCE") AS
  select HRM_PERSON_ID EMPID
       , PER_FIRST_NAME FIRST_NAME
       , PER_LAST_NAME LAST_NAME
       , PER_SEARCH_NAME SEARCH_NAME
       , EMP_NUMBER MATRICULE
       , EMP_SOCIAL_SECURITYNO SECUNO
       , EMP_SOCIAL_SECURITYNO2 SECUNO2
       , PER_GENDER SEX
       , PER_BIRTH_DATE BIRTH_DATE
       , DIC_NATIONALITY_ID NATIONALITY
       ,   -- Forcment renseign (cf. Hrm_frmPerson)
         C_CIVIL_STATUS CIVIL_STATUS
       , EMP_SINGLE_PARENT SINGLE_PARENT
       , PER_ACTIVITY_RATE ACTIVITY_RATE
       , DIC_CANTON_WORK_ID CANTON_WORK
       ,   -- Forcment renseign (cf. Hrm_frmPerson)
         --(cf. Hrm_frmPerson, seul Tax et Home sont vrifie)
         nvl2(PER_TAXPOSTALCODE, PER_TAXSTREET, PER_HOMESTREET) STREET
       , nvl2(PER_TAXPOSTALCODE, PER_TAXPOSTALCODE, PER_HOMEPOSTALCODE) POSTALCODE
       , nvl2(PER_TAXPOSTALCODE, PER_TAXCITY, PER_HOMECITY) CITY
       , case
           when is_CH_resident = 1 then nvl2(PER_TAXPOSTALCODE, PER_TAXSTATE, PER_HOMESTATE)
           else 'EX'
         end STATE
       , case
           when is_CH_resident = 0 then nvl2(PER_TAXPOSTALCODE, PER_TAXCOUNTRY, PER_HOMECOUNTRY)
         end COUNTRY
       , per_taxstreet
       , per_taxpostalcode
       , per_taxcity
       , case
           when instr(upper('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz'), upper(PER_TAXCOUNTRY) ) = 0 then per_taxcountry
         end per_taxcountry
       , per_taxstate
       , per_homestreet
       , per_homepostalcode
       , per_homecity
       , case
           when instr(upper('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz'), upper(PER_HOMECOUNTRY) ) = 0 then per_homecountry
         end per_homecountry
       , per_homestate
       , EMP_OFS_INCLUDED OFS
       , EMP_CON_APPRENTICE APPRENTICE
       , PC_LANG_ID
       , per_home_phone
       , per_email
       , emp_civil_status_since
    from (select case
                   when PER_TAXCOUNTRY is null
                   and PER_HOMECOUNTRY is null then 1
                   when instr(upper('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz'), upper(nvl2(PER_TAXPOSTALCODE, PER_TAXCOUNTRY, PER_HOMECOUNTRY) ) ) >
                                                                                                                                                               0 then 1
                   else 0
                 end is_CH_resident
               , P.*
            from HRM_PERSON P)
         with read only


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_TAXSOURCE_CORRECTION" ("HRM_PERSON_ID", "C_HRM_CANTON", "ELM_TAX_PER_END", "MUTATIONS", "NEW_TAXABLE_EARNING", "NEW_ASCERTAIN_TAXABLE_EARNING", "NEW_TAXSOURCE", "OLD_CANTON", "OLD_TAXABLE_EARNING", "OLD_ASCERTAIN_TAXABLE_EARNING", "OLD_TAXSOURCE") AS
  select new.hrm_person_id
       , new.c_hrm_canton
       , new.elm_tax_per_end
       , mutations
       , new_soum as new_taxable_earning
       , new_det as new_ascertain_taxable_earning
       , new_ded as new_taxsource
       , old_canton
       , old_soum as old_taxable_earning
       , old_det as old_ascertain_taxable_earning
       , old_ded as old_taxsource
    from (select   l.hrm_person_id
                 , l.c_hrm_canton
                 , l.elm_tax_per_end
                 , XMLAgg
                     (case
                        when l.hrm_taxsource_ledger_ext_id is not null
                        /* Correction non extourne */
                        and not exists(select 1
                                         from hrm_taxsource_ledger
                                        where hrm_taxsource_ledger_ext_id = reversed.hrm_taxsource_ledger_id)
                        and (   l.c_hrm_tax_in is not null
                             or l.c_hrm_tax_in2 is not null
                             or (    l.c_hrm_tax_out is not null
                                 and l.c_hrm_tax_out < '50') )
                        and   /* Prise en compte uniquement si l'vnement est dans une priode d'entre/sortie
                                pour exclure les paiements de bonus p.ex. qui doivent tre affects  une priode fictive */
                            exists(
                              select 1
                                from hrm_in_out io
                               where io.hrm_employee_id = l.hrm_person_id
                                 and c_in_out_category = '3'
                                 and nvl(l.elm_tax_out_date, l.elm_tax_in_date) >= trunc(ino_in, 'month')
                                 and (   nvl(l.elm_tax_out_date, l.elm_tax_in_date) <= ino_out
                                      or ino_out is null) ) then hrm_elm_taxsource_xml.get_tax_mutation(l.c_hrm_tax_in
                                                                                                      , l.c_hrm_tax_in2
                                                                                                      , l.c_hrm_tax_in3
                                                                                                      , l.c_hrm_tax_in4
                                                                                                      , l.elm_tax_in_date
                                                                                                      , l.c_hrm_tax_out
                                                                                                      , l.elm_tax_out_date
                                                                                                       )
                        /* En cas de changement de canton */
                      when reversed.hrm_taxsource_ledger_ext_id is not null
                      and reversed.c_hrm_canton <> l.c_hrm_canton
                      /* Correction non extourne */
                      and not exists(select 1
                                       from hrm_taxsource_ledger
                                      where hrm_taxsource_ledger_ext_id = reversed.hrm_taxsource_ledger_id) then hrm_elm_taxsource_xml.get_tax_mutation
                                                                                                                                     (null
                                                                                                                                    , null
                                                                                                                                    , null
                                                                                                                                    , null
                                                                                                                                    , null
                                                                                                                                    , '05'
                                                                                                                                    , reversed.elm_tax_in_date -
                                                                                                                                      1
                                                                                                                                     )
                      end
                     ) mutations
                 , sum(l.elm_tax_earning) new_soum
                 , sum(l.elm_tax_ascertain_earning) new_det
                 , sum(l.elm_tax_source) new_ded
              from hrm_taxsource_ledger l
                 , (select *
                      from hrm_taxsource_ledger
                     where c_elm_tax_type = '01') reversed
             where   /* Lignes du journal relatives  des priodes antrieures */
                   l.elm_tax_per_end < hrm_elm.endofperiod
               and trunc(l.elm_tax_per_end, 'year') = trunc(hrm_elm.endofperiod, 'year')
               and l.hrm_taxsource_ledger_id = reversed.hrm_taxsource_ledger_ext_id(+)
               /*  dont il existe une saisie non dclare au moins pour l'employ */
               and exists(
                     select 1
                       from hrm_taxsource_ledger
                          , hrm_elm_recipient r
                      where hrm_elm_recipient_conf_id = r.hrm_elm_recipient_id
                        and r.hrm_elm_transmission_id = hrm_elm.get_transmissionid
                        and l.hrm_person_id = hrm_person_id
                        and elm_tax_per_end = l.elm_tax_per_end
                        -- de type autre que confirmation de correction
                        and c_elm_tax_type <> '03')
          group by l.hrm_person_id
                 , l.c_hrm_canton
                 , l.elm_tax_per_end) new
       , (   -- Valeurs historiques
          /*
          Elments figurant dans des dclarations antrieures
          */
          select   hrm_person_id
                 , c_hrm_canton old_canton
                 , elm_tax_per_end
                 , sum(elm_tax_earning) old_soum
                 , sum(elm_tax_ascertain_earning) old_det
                 , sum(elm_tax_source) old_ded
              from hrm_taxsource_ledger l
                 , hrm_elm_recipient r
                 , hrm_elm_transmission t
             where elm_tax_per_end < hrm_elm.endofperiod
               and l.hrm_elm_recipient_conf_id = r.hrm_elm_recipient_id
               and r.hrm_elm_transmission_id = t.hrm_elm_transmission_id
               and t.elm_valid_as_of < hrm_elm.endofperiod
          group by hrm_person_id
                 , c_hrm_canton
                 , elm_tax_per_end) histo
   where new.c_hrm_canton = histo.old_canton(+)
     and new.elm_tax_per_end = histo.elm_tax_per_end(+)
     and new.hrm_person_id = histo.hrm_person_id(+)
     and (   mutations is not null
          or nvl(new_soum, 0) <> nvl(old_soum, 0)
          or nvl(new_det, 0) <> nvl(old_det, 0)
          or nvl(new_ded, 0) <> nvl(old_ded, 0) )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ELM_TAXSOURCE_CORR_TOTAL" ("HRM_PERSON_ID", "C_HRM_CANTON", "ELM_TAX_PER_END", "MUTATIONS", "NEW_TAXABLE_EARNING", "NEW_ASCERTAIN_TAXABLE_EARNING", "NEW_TAXSOURCE", "OLD_CANTON", "OLD_TAXABLE_EARNING", "OLD_ASCERTAIN_TAXABLE_EARNING", "OLD_TAXSOURCE") AS
  SELECT new.hrm_person_id,
          new.c_hrm_canton,
          new.elm_tax_per_end,
          mutations,
          new_soum AS new_taxable_earning,
          new_det AS new_ascertain_taxable_earning,
          new_ded AS new_taxsource,
          old_canton,
          old_soum AS old_taxable_earning,
          old_det AS old_ascertain_taxable_earning,
          old_ded AS old_taxsource
     FROM (  SELECT l.hrm_person_id,
                    l.c_hrm_canton,
                    l.elm_tax_per_end,
                    XMLAGG (
                       CASE
                          WHEN     (   l.c_hrm_tax_in IS NOT NULL
                                    OR l.c_hrm_tax_in2 IS NOT NULL
                                    OR l.c_hrm_tax_out IS NOT NULL)
                               AND /* Prise en compte uniquement si l'vnement est dans une priode d'entre/sortie
                                     pour exclure les paiements de bonus p.ex. qui doivent tre affects  une priode fictive */
                                  EXISTS
                                      (SELECT 1
                                         FROM hrm_in_out io
                                        WHERE     io.hrm_employee_id = l.hrm_person_id
                                              AND c_in_out_category = '3'
                                              AND NVL (l.elm_tax_out_date, l.elm_tax_in_date) >=
                                                     TRUNC (ino_in, 'month')
                                              AND (   NVL (l.elm_tax_out_date, l.elm_tax_in_date) <=
                                                         ino_out
                                                   OR ino_out IS NULL)) THEN
                             hrm_elm_taxsource_xml.get_tax_mutation (l.c_hrm_tax_in,
                                                                     l.c_hrm_tax_in2,
                                                                     l.c_hrm_tax_in3,
                                                                     l.c_hrm_tax_in4,
                                                                     l.elm_tax_in_date,
                                                                     l.c_hrm_tax_out,
                                                                     l.elm_tax_out_date)
                          /* En cas de changement de canton */
                          WHEN l2.c_hrm_canton <> l.c_hrm_canton THEN
                             hrm_elm_taxsource_xml.get_tax_mutation (NULL,
                                                                     NULL,
                                                                     NULL,
                                                                     NULL,
                                                                     NULL,
                                                                     '05',
                                                                     l2.elm_tax_in_date - 1)
                       END)
                       mutations,
                    SUM (l.elm_tax_earning) new_soum,
                    SUM (l.elm_tax_ascertain_earning) new_det,
                    SUM (l.elm_tax_source) new_ded
               FROM hrm_taxsource_ledger l,
                    (SELECT *
                       FROM hrm_taxsource_ledger
                      WHERE c_elm_tax_type = '01') l2
              WHERE                     /* Lignes du journal relatives  des priodes antrieures */
                   l    .elm_tax_per_end < hrm_elm.endofperiod
                and trunc(l.elm_tax_per_end,'year')=trunc(hrm_elm.endofperiod,'year')
                    AND l.hrm_taxsource_ledger_id = l2.hrm_taxsource_ledger_ext_id(+)
                    /*  dont il existe une saisie non dclare au moins pour l'employ */
                    AND EXISTS
                           (SELECT 1
                              FROM hrm_taxsource_ledger, hrm_elm_recipient r
                             WHERE     hrm_elm_recipient_conf_id = r.hrm_elm_recipient_id
                                   AND r.hrm_elm_transmission_id = hrm_elm.get_transmissionid
                                   AND l.hrm_person_id = hrm_person_id
                                   AND elm_tax_per_end = l.elm_tax_per_end -- de type autre que confirmation de correction
                                                                        --AND c_elm_tax_type <> '03'
                        )
           GROUP BY l.hrm_person_id, l.c_hrm_canton, l.elm_tax_per_end) new,
          (                                                                   -- Valeurs historiques
           SELECT   hrm_person_id,
                    c_hrm_canton old_canton,
                    elm_tax_per_end,
                    SUM (elm_tax_earning) old_soum,
                    SUM (elm_tax_ascertain_earning) old_det,
                    SUM (elm_tax_source) old_ded
               FROM hrm_taxsource_ledger l, hrm_elm_recipient r, hrm_elm_transmission t
              WHERE     elm_tax_per_end < hrm_elm.endofperiod
                    AND l.hrm_elm_recipient_conf_id = r.hrm_elm_recipient_id
                    AND r.hrm_elm_transmission_id = t.hrm_elm_transmission_id
                    AND t.elm_valid_as_of < hrm_elm.endofperiod
           GROUP BY hrm_person_id, c_hrm_canton, elm_tax_per_end) histo
    WHERE     new.c_hrm_canton = histo.old_canton(+)
          AND new.elm_tax_per_end = histo.elm_tax_per_end(+)
          AND new.hrm_person_id = histo.hrm_person_id(+)
          AND (   mutations IS NOT NULL
               OR NVL (new_soum, 0) <> NVL (old_soum, 0)
               OR NVL (new_det, 0) <> NVL (old_det, 0)
               OR NVL (new_ded, 0) <> NVL (old_ded, 0))


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPLOYEE_BREAK" ("SOURCE", "HRM_EMPLOYEE_ID", "RATE", "HEB_DEPARTMENT_ID", "HEB_DIV_NUMBER", "HEB_CDA_NUMBER", "HEB_PJ_NUMBER", "HEB_PF_NUMBER", "HEB_SHIFT") AS
  SELECT
  b.hrm_employee_break_id source,
  b.hrm_employee_id,
  b.heb_ratio / s.tot RATE,
  b.heb_department_id,
  b.heb_div_number,
  b.heb_cda_number,
  b.heb_pj_number,
  b.heb_pf_number,
  b.heb_shift
FROM
  (SELECT sum(heb_ratio) tot, hrm_employee_id
   FROM hrm_employee_break
   WHERE heb_default_flag = 1
   GROUP BY hrm_employee_id) s,
  hrm_employee_break b
WHERE
  s.hrm_employee_id = b.hrm_employee_id and
  b.heb_default_flag = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPLOYEE_CONSTANTS" ("HRM_CONSTANT_ID", "HRM_EMPLOYEE_ID", "EMC_VALUE", "EMC_NUM_VALUE", "EMC_VALUE_FROM", "EMC_VALUE_TO", "EMC_ACTIVE", "C_HRM_SAL_CONST_TYPE", "HRM_CODE_DIC_ID", "CON_DESCR", "PC_LANG_ID", "COD_CODE", "COD_DESCR", "STATCODE", "HRM_EMPLOYEE_CONST_ID", "BASEAMOUNT", "RATE", "PERRATE", "RATIOGRP", "UPPERDESCR", "CONSTGROUP", "TEXT", "OVERRIDE", "PRECISION") AS
  SELECT
  ec.hrm_constants_id,
  ec.hrm_employee_id,
  nvl2(ec.hrm_code_table_id, ct.cod_code||' '||cd.cod_descr, ec.emc_value) emc_value,
  ec.emc_num_value,
  ec.emc_value_from,
  ec.emc_value_to,
  ec.emc_active,
  r.c_hrm_sal_const_type,
  r.hrm_code_dic_id,
  rd.erd_descr,
  rd.pc_lang_id,
  ct.cod_code,
  cd.cod_descr,
  r.elr_root_code,
  ec.hrm_employee_const_id,
  ec.emc_base_amount,
  ec.emc_rate,
  ec.emc_per_rate,
  ec.emc_ratio_group,
  upper(rd.erd_descr),
  r.elr_root_code||to_char(ec.hrm_constants_id),
  ec.emc_text,
  ec.emc_override,
  r.elr_input_precision
FROM
  hrm_code_descr cd,
  hrm_code_table ct,
  hrm_elements_root_descr rd,
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_employee_const ec
WHERE
  (cd.pc_lang_id is null or cd.pc_lang_id = rd.pc_lang_id) and
  cd.hrm_code_table_id(+) = ct.hrm_code_table_id and
  ct.hrm_code_table_id(+) = ec.hrm_code_table_id and
  rd.hrm_elements_root_id = r.hrm_elements_root_id and
  r.elr_is_active = 1 and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = ec.hrm_constants_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPLOYEE_GLOBAL" ("PAC_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_COMMENT", "PER_ACTIVITY", "PC_CNTRY_ID", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "DIC_ADDRESS_TYPE_ID", "COM_EXT_NUMBER", "COM_BITMAP_ID", "C_SEX", "PER_BIRTH_DATE", "C_HRM_EMP_STATUS", "DIC_DEPARTMENT_ID", "DIC_WORKPLACE_ID", "DIC_WORKREGION_ID", "EMP_PC_LANG_ID", "EMP_OTHER_FIRSTNAME", "EMP_SECONDARY_KEY", "EMP_INITIALS", "EMP_BIRTH_PLACE", "EMP_NUMBER", "EMP_MAIDEN_NAME", "EMP_SOCIAL_SECURITYNO", "EMP_SOCIAL_SECURITYNO2", "EMP_NATIVE_OF", "DIC_NATIONALITY_ID", "DIC_FAMILY_STATUS_ID", "HRM_JOB_ID", "EMPNAME", "CARRIER_FREE", "MEATS_COST_SHARE", "CANTEEN", "STOCK_OPTIONS", "EMP_BIRTH_COUNTRY", "IS_EMPLOYEE", "UPPERNAME", "SEARCHNAME", "EMPGROUP", "COMPANY_CAR", "SEASON_TICKET", "DIC_CONFESSION_ID", "DIC_CANTON_WORK_ID", "EMP_GROUP_ENTRY", "DIC_RESPONSABILITY_ID", "EMP_HOBBIES", "EMP_LAST_INTERVIEW", "DIC_NATIONALITY2_ID", "DIC_NATIONALITY3_ID", "EMP_DRIVING_LICENCE", "PER_ACTIVITY_RATE", "EMP_CERTIF_OBSERVATION", "DIC_HRM_EMP_TYPE_ID", "EMP_CIVIL_STATUS_SINCE", "EMP_MARRIAGE_PLACE", "EMP_SINGLE_PARENT", "EMP_LPP_CONTRIBUTOR") AS
  SELECT
  per.hrm_person_id,
  per_title,
  per_last_name,
  per_first_name,
  per_comment,
  dic_job_activity_id,
  case
    when per_taxpostalcode is null then
      case per_mail_add_selector
        when 0 then per_businesscountry
        when 1 then per_homecountry
        when 2 then per_othercountry
      end
    else per_taxcountry
  end,
  case
    when per_taxpostalcode is null then
      case per_mail_add_selector
        when 0 then per_businessstreet
        when 1 then per_homestreet
        when 2 then per_otherstreet
      end
    else per_taxstreet
  end,
  case
    when per_taxpostalcode is null then
      case per_mail_add_selector
        when 0 then per_businesspostalcode
        when 1 then per_homepostalcode
        when 2 then per_otherpostalcode
      end
    else per_taxpostalcode
  end,
  case
    when per_taxpostalcode is null then
      case per_mail_add_selector
        when 0 then per_businesscity
        when 1 then per_homecity
        when 2 then per_othercity
      end
    else per_taxcity
  end,
  case
    when per_taxpostalcode is null then
      case per_mail_add_selector
        when 0 then per_businessstate
        when 1 then per_homestate
        when 2 then per_otherstate
      end
    else per_taxstate
  end,
  case
    when per_taxpostalcode is null then
      case per_mail_add_selector
        when 0 then 'bus'
        when 1 then 'hom'
        when 2 then 'oth'
      end
    else 'tax'
  end,
  per_home_phone,
  com_bitmap_id,
  per_gender,
  per_birth_date,
  emp_status,
  dic_department_id,
  dic_workplace_id,
  dic_workregion_id,
  pc_lang_id,
  emp_other_firstname,
  emp_secondary_key,
  per_initials,
  emp_birth_place,
  emp_number,
  emp_maiden_name,
  emp_social_securityno,
  emp_social_securityno2,
  emp_native_of,
  dic_nationality_id,
  c_civil_status,
  hrm_job_id,
  per_last_name||' '||per_first_name,
  emp_carrier_free,
  emp_meats_cost_share,
  emp_canteen,
  emp_stock_options,
  emp_birth_country,
  per_is_employee,
  upper(per_last_name||' '||per_first_name),
  per_search_name,
  per_search_name||to_number(per.hrm_person_id),
  emp_company_car,
  emp_season_ticket,
  dic_confession_id,
  dic_canton_work_id,
  emp_group_entry,
  dic_responsability_id,
  emp_hobbies,
  emp_last_interview,
  dic_nationality2_id,
  dic_nationality3_id,
  emp_driving_licence,
  per_activity_rate,
  emp_certif_observation,
  dic_hrm_emp_type_id,
  emp_civil_status_since,
  emp_marriage_place,
  emp_single_parent,
  emp_lpp_contributor
FROM
  hrm_person per,
  (select *
     from hrm_person_tax
    where emp_tax_year = to_char(hrm_date.beginofyear, 'yyyy') ) tax
WHERE tax.hrm_person_id(+) = per.hrm_person_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPLOYEE_SHORT" ("EMPID", "NAME", "SEX", "BIRTHDATE", "EMPNUMBER", "NOAVS", "NOAVS2", "PERNAME", "EMPSTATUS", "SEARCHNAME", "UPPERNAME", "EMPGROUP") AS
  SELECT
  a.hrm_person_id,
  a.per_last_name||' '||a.per_first_name,
  a.per_gender,
  a.per_birth_date,
  a.emp_number,
  a.emp_social_securityno,
  a.emp_social_securityno2,
  a.per_last_name,
  a.emp_status,
  a.per_search_name,
  upper(a.per_last_name||' '||a.per_first_name),
  a.per_search_name||to_char(a.hrm_person_id)
FROM
  hrm_person a
WHERE
  a.per_is_employee=1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPL_BREAK" ("HRM_EMPLOYEE_BREAK_ID", "HEB_DEFAULT_FLAG", "HRM_EMPLOYEE_ID", "HEB_RATIO", "HEB_DEPARTMENT_ID", "HEB_DIV_NUMBER", "HEB_CDA_NUMBER", "HEB_CPN_NUMBER", "HEB_PF_NUMBER", "HEB_PJ_NUMBER", "HEB_SHIFT", "RCO_TITLE") AS
  SELECT
  hrm_employee_break_id,
  heb_default_flag,
  hrm_employee_id,
  heb_ratio,
  heb_department_id,
  heb_div_number,
  heb_cda_number,
  heb_cpn_number,
  heb_pf_number,
  heb_pj_number,
  heb_shift,
  heb_rco_title
FROM HRM_EMPLOYEE_BREAK
WHERE heb_default_flag = 0
UNION ALL
SELECT
  hrm_employee_break_id,
  heb_default_flag,
  hrm_employee_id,
  heb_ratio,
  heb_department_id,
  heb_div_number,
  heb_cda_number,
  heb_cpn_number,
  heb_pf_number,
  heb_pj_number,
  heb_shift,
  heb_rco_title
FROM hrm_employee_break b
WHERE heb_default_flag = 1 AND
      NOT EXISTS (SELECT 1
                  FROM hrm_employee_break b2
                  WHERE b2.hrm_employee_id = b.hrm_employee_id AND
                        heb_default_flag = 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPTOPAY" ("EMPID", "LASTPAYNUM") AS
  SELECT
  a.empId,
  nvl(b.lastPayNum+1, 0)
FROM
  v_hrm_emptopay_Num a,
  v_hrm_last_pay_num b
WHERE
  a.empid=b.empid(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPTOPAY_NUM" ("EMPID") AS
  select
  HRM_PERSON_ID
from (
  select
    HRM_PERSON_ID,
    hrm_date.IsEmployeePayable(HRM_PERSON_ID) IS_PAYABLE
  from HRM_PERSON
  where PER_IS_EMPLOYEE = 1 and EMP_CALCULATION = 1
) P
where
  IS_PAYABLE = 1
minus
select
  HRM_EMPLOYEE_ID
from (
  select
    HRM_EMPLOYEE_ID,
    HRM_SALARY_SHEET_ID,
    HIT_PAY_NUM,
    hrm_date.ValidForActivePeriod2(HIT_PAY_PERIOD) IS_VALID,
    case HIT_REVERSAL
      when 1 then hrm_var.IsBreakDowned(HRM_EMPLOYEE_ID, HRM_SALARY_SHEET_ID, HIT_PAY_NUM)
      when 0 then 0
    end IS_BREAK_DOWNED,
    hrm_var.get_paySelected SALARY_SHEET_SELECTED
  from HRM_HISTORY
) H
where
  HRM_SALARY_SHEET_ID = SALARY_SHEET_SELECTED and
  HIT_PAY_NUM = (select Max(HIT_PAY_NUM) from HRM_HISTORY
                 where HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
                   HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID) and
  IS_VALID = 1 and IS_BREAK_DOWNED = 0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMPTOPAY_RETRO" ("EMPID") AS
  select
  HRM_PERSON_ID
from (
  select
    HRM_PERSON_ID,
    hrm_date.IsEmployeePayable(HRM_PERSON_ID) IS_PAYABLE
  from HRM_PERSON
  where PER_IS_EMPLOYEE = 1 and EMP_CALCULATION = 1
) P
where
  -- Quitt l'anne prcdente
  Exists(select 1 from HRM_IN_OUT
          where HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and C_IN_OUT_CATEGORY = '3' and
            Trunc(INO_OUT, 'Y') = Trunc(hrm_date.BeginOfYear-1, 'Y')) and
  -- Pas prsent cette anne
  IS_PAYABLE = 0
minus
select
  HRM_EMPLOYEE_ID
from (
  select
    HRM_EMPLOYEE_ID,
    HRM_SALARY_SHEET_ID,
    HIT_PAY_NUM,
    hrm_date.ValidForActivePeriod2(HIT_PAY_PERIOD) IS_VALID,
    case HIT_REVERSAL
      when 1 then hrm_var.IsBreakDowned(HRM_EMPLOYEE_ID, HRM_SALARY_SHEET_ID, HIT_PAY_NUM)
      when 0 then 0
    end IS_BREAK_DOWNED,
    hrm_var.get_paySelected SALARY_SHEET_SELECTED
  from HRM_HISTORY
) H
where
  HRM_SALARY_SHEET_ID = SALARY_SHEET_SELECTED and
  HIT_PAY_NUM = (select Max(HIT_PAY_NUM) from HRM_HISTORY
                 where HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
                   HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID) and
  IS_VALID = 1 and IS_BREAK_DOWNED = 0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_ADDR_COMM" ("HRM_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_COMMENT", "PER_ACTIVITY", "PER_SHORT_NAME", "PAC_ADDRESS_ID", "PC_CNTRY_ID", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "PC_LANG_ID", "ADD_COMMENT", "DIC_ADDRESS_TYPE_ID", "PAC_COMMUNICATION_ID", "DIC_COMMUNICATION_TYPE_ID", "COM_EXT_NUMBER", "COM_INT_NUMBER", "COM_AREA_CODE", "COM_COMMENT", "COM_BITMAP_ID", "C_SEX", "PER_BIRTH_DATE", "C_HRM_EMP_STATUS", "DIC_DEPARTMENT_ID", "DIC_WORKPLACE_ID", "DIC_WORKREGION_ID", "EMP_PC_CNTRY_ID", "EMP_PC_LANG_ID", "EMP_OTHER_FIRSTNAME", "EMP_SECONDARY_KEY", "EMP_INITIALS", "EMP_BIRTH_PLACE", "EMP_NUMBER", "EMP_MAIDEN_NAME", "EMP_SOCIAL_SECURITYNO", "EMP_NATIVE_OF", "EMP_COMMENTS", "EMP_COMPANY_PREFIX", "EMPNAME", "SEARCHNAME", "UPPERNAME", "EMPGROUP") AS
  SELECT
  hrm_person_id,
  per_title DIC_PERSON_POLITNESS_ID,
  per_last_name PER_NAME,
  per_first_name PER_FORENAME,
  per_comment PER_COMMENT,
  DIC_JOB_ACTIVITY_ID PER_ACTIVITY,
  per_initials PER_SHORT_NAME,
  0 PAC_ADDRESS_ID,
  0 PC_CNTRY_ID,
  per_homestreet ADD_ADDRESS1,
  per_homepostalcode ADD_ZIPCODE,
  per_homecity ADD_CITY,
  per_homestate ADD_STATE,
  0 PC_LANG_ID,
  '' ADD_COMMENT,
  'Dom'DIC_ADDRESS_TYPE_ID,
  0 PAC_COMMUNICATION_ID,
  'Tl-d' DIC_COMMUNICATION_TYPE_ID,
  per_home_phone COM_EXT_NUMBER,
  null COM_INT_NUMBER,
  null COM_AREA_CODE,
  null COM_COMMENT,
  0 COM_BITMAP_ID,
  per_gender C_SEX,
  per_birth_date PER_BIRTH_DATE,
  emp_status C_HRM_EMP_STATUS,
  DIC_DEPARTMENT_ID,
  DIC_WORKPLACE_ID,
  DIC_WORKREGION_ID,
  emp_birth_country EMP_PC_CNTRY_ID,
  PC_LANG_ID EMP_PC_LANG_ID,
  '' EMP_OTHER_FIRSTNAME,
  EMP_SECONDARY_KEY,
  per_initials EMP_INITIALS,
  EMP_BIRTH_PLACE,
  EMP_NUMBER,
  '' EMP_MAIDEN_NAME,
  EMP_SOCIAL_SECURITYNO,
  '' EMP_NATIVE_OF,
  '' EMP_COMMENTS,
  '' EMP_COMPANY_PREFIX,
  per_last_name||' '||per_first_name empname,
  per_search_name searchname,
  upper(per_last_name||' '||per_first_name) uppername,
  per_search_name||to_char(hrm_person_id) empgroup
FROM
  hrm_person
WHERE
  per_is_employee = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_ALL_ELEMENTS" ("ISVAR", "EMPELEMID", "ORIGINID", "EMPID", "CODE", "FREEVAL", "BASEAMOUNT", "RATE", "PERRATE", "ELEMVALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "ELEMFORMAT", "ELEPRECISION", "ELEROUND", "BEGINDATE", "ENDDATE", "BEGINVALUEDATE", "ENDVALUEDATE", "ACTIVE", "CONSTTYPE", "CONSTCATEG", "MULTICURRENCY", "CURRENCY") AS
  SELECT
  1,
  a.hrm_employee_elements_id,
  a.hrm_elements_id,
  a.hrm_employee_id,
  b.ele_code,
  1,
  a.emp_base_amount,
  a.emp_rate,
  a.emp_per_rate,
  a.emp_value,
  a.emp_text,
  a.emp_override,
  a.emp_foreign_value,
  a.emp_ref_value,
  a.emp_ZL,
  b.ele_format,
  b.ele_Precision,
  b.ele_Round,
  a.emp_from,
  a.emp_to,
  a.emp_value_from,
  a.emp_value_to,
  a.Emp_Active,
  null,
  0,
  hrm_utils.BoolToStr(b.ele_multi_currency),
  b.acs_financial_currency_id
FROM
  hrm_employee_elements a,
  hrm_elements b
WHERE
  b.HRM_ELEMENTS_ID = a.hrm_elements_id
UNION
SELECT
  0,
  a.hrm_employee_const_id,
  a.hrm_constants_id,
  a.hrm_employee_id,
  b.con_code,
  a.hrm_code_Table_id,
  a.emc_base_amount,
  a.emc_rate,
  a.emc_per_rate,
  nvl(a.emc_value, nvl(c.cod_code,'0')),
  a.emc_text,
  a.emc_override,
  a.emc_foreign_value,
  a.emc_ref_value,
  a.emc_ZL,
  b.con_format,
  b.con_Precision,
  b.con_Round,
  a.emc_from,
  a.emc_to,
  a.emc_value_from,
  a.emc_value_to,
  a.Emc_Active,
  b.c_hrm_sal_const_type,
  c.hrm_code_dic_id,
  hrm_utils.BoolToStr(b.con_multi_currency),
  b.acs_financial_currency_id
FROM
  hrm_employee_const a,
  hrm_constants b,
  hrm_code_table c
WHERE
  b.HRM_constants_ID = a.hrm_constants_id and
  c.HRM_Code_Table_id (+) = a.hrm_code_Table_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_ALL_ELEM_TRANSFER" ("ISVAR", "DOCID", "IMPORTID", "EMPELEMID", "EMPID", "ORIGINID", "ELEMVALUE", "OLDVALUE", "BEGINDATE", "ENDDATE", "VALUEFROM", "OLDVALUEFROM", "VALUETO", "OLDVALUETO", "TRANSFERMODE", "STRUCTID") AS
  SELECT
  1 isVar,
  b.hrm_import_doc_id,
  b.hrm_import_log_id,
  d.hrm_employee_elements_id,
  b.hrm_employee_id,
  b.hrm_elements_id,
  to_char(b.iml_value),
  d.emp_value,
  c.ele_valid_from,
  c.ele_valid_to,
  b.iml_value_from,
  d.emp_value_from,
  b.iml_value_to,
  d.emp_value_to,
  b.iml_transfer_code,
  b.pc_import_data_id
FROM
  hrm_import_log b,
  hrm_elements c,
  hrm_employee_elements d
WHERE
  b.iml_transferred=0 AND
  b.iml_imp_error_code is null AND
  b.hrm_elements_id=c.hrm_elements_id AND
  (d.hrm_employee_id(+) = b.hrm_employee_id AND
   d.hrm_elements_id(+) = b.hrm_elements_id) AND
  (b.iml_value_from <= d.emp_value_to(+) AND
   b.iml_value_to >= d.emp_value_from(+))
UNION
SELECT
  0 IsVar,
  b.hrm_import_doc_id,
  b.hrm_import_log_id,
  d.hrm_employee_const_id,
  b.hrm_employee_id,
  b.hrm_elements_id,
  to_char(b.iml_value),
  d.emc_value,
  c.con_from,
  c.con_to,
  b.iml_value_from,
  d.emc_value_from,
  b.iml_value_to,
  d.emc_value_to,
  b.iml_transfer_code,
  b.pc_import_data_id
FROM
  hrm_import_log b,
  hrm_constants c,
  hrm_employee_const d
WHERE
  b.iml_transferred = 0 AND
  b.iml_imp_error_code is null AND
  b.hrm_elements_id = c.hrm_constants_id AND
  (d.hrm_employee_id(+) = b.hrm_employee_id AND
   d.hrm_constants_id(+) = b.hrm_elements_id) AND
  (b.iml_value_from <= d.emc_value_to(+) AND
   b.iml_value_to >=d.emc_value_from(+))


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_CONSTANTS" ("CONSTID", "SHEETID", "EMPID", "BASEAMOUNT", "RATE", "PERRATE", "CONSTNUMVAL", "CONSTVALUE", "CONSTFOREIGNVALUE", "BEGINVALUEDATE", "ENDVALUEDATE", "ACTIVE", "CONSTRATE") AS
  SELECT
  ec.hrm_constants_id,
  ss.hrm_salary_sheet_id,
  ec.hrm_employee_id,
  ec.emc_base_amount,
  ec.emc_rate,
  ec.emc_per_rate,
  to_char(ec.emc_num_value) emc_num_value,
  nvl(ec.emc_value,
      case
        when r.c_hrm_sal_const_type <> '3' then
          nvl2(c.cod_code, c.cod_code, '0')
      end
  ) emc_value,
  ec.emc_foreign_value,
  ec.emc_value_from,
  ec.emc_value_to,
  hrm_utils.BoolToStr(ec.emc_active),
  ec.emc_ex_rate
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_code_table c,
  hrm_salary_sheet_elements ss,
  hrm_employee_const ec
WHERE
  ss.hrm_elements_id = ec.hrm_constants_id and
  c.hrm_code_table_id(+) = ec.hrm_code_table_id and
  f.hrm_elements_id = ec.hrm_constants_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  r.elr_from <= hrm_date.activeperiodenddate and
  r.elr_to >= hrm_date.activeperiod


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_CUST_SALARY" ("ELEMID", "EMPID", "BASEAMOUNT", "RATE", "PERRATE", "NUMVAL", "VALUE", "FOREIGNVALUE", "BEGINVALUEDATE", "ENDVALUEDATE", "EXRATE") AS
  select
  EC.HRM_ELEMENTS_ID ELEMID,
  EC.HRM_EMPLOYEE_ID EMPID,
  EC.HEE_BASE_AMOUNT,
  EC.HEE_RATE,
  EC.HEE_PER_RATE,
  case
    when Nvl(R.C_HRM_SAL_CONST_TYPE, R.ELR_FORMAT+2) = '3' then
      to_char(EC.HEE_NUM_VALUE)
  end NUMVAL,
  case
    when Nvl(R.C_HRM_SAL_CONST_TYPE, R.ELR_FORMAT+2) <> '3' then
      EC.HEE_VALUE
  end VALUE,
  EC.HEE_FOREIGN_VALUE,
  EC.HEE_BEGIN_DATE,
  EC.HEE_END_DATE,
  EC.HEE_EX_RATE
from
  HRM_ELEMENTS_ROOT R,
  HRM_ELEMENTS_FAMILY F,
  HRM_EMPL_ELEM_CALC EC
where
  F.HRM_ELEMENTS_ID = EC.HRM_ELEMENTS_ID and
  R.HRM_ELEMENTS_ROOT_ID = F.HRM_ELEMENTS_ROOT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_CUST_SAL_ELEM_LINK" ("MAIN_ID", "MAIN_CODE", "LINK2_ID", "EMPID", "BASEAMOUNT", "RATE", "PERRATE", "VALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "CURRENCY", "EXRATE") AS
  select
  D.ELEMID MAIN_ID,
  D.CODE MAIN_CODE,
  EC.HRM_ELEMENTS_ID LINK2_ID,
  EC.HRM_EMPLOYEE_ID EMPID,
  EC.HEE_BASE_AMOUNT,
  EC.HEE_RATE,
  EC.HEE_PER_RATE,
  EC.HEE_VALUE,
  EC.HEE_TEXT,
  EC.HEE_OVERRIDE,
  EC.HEE_FOREIGN_VALUE,
  EC.HEE_REF_VALUE,
  EC.HEE_ZL,
  EC.HEE_CURRENCY,
  EC.HEE_EX_RATE
from
  V_HRM_ELEMENTS_SHORT D,
  HRM_ELEMENTS_FAMILY C,
  HRM_ELEMENTS_FAMILY B,
  HRM_EMPL_ELEM_CALC EC
where
  B.HRM_ELEMENTS_ID = EC.HRM_ELEMENTS_ID and
  C.HRM_ELEMENTS_ROOT_ID = B.HRM_ELEMENTS_ROOT_ID and
  C.ELF_IS_REFERENCE = 1 and
  D.ELEMID = C.HRM_ELEMENTS_ID and
  B.HRM_ELEMENTS_PREFIXES_ID = 'EM'
union all
select
  D.ELEMID MAIN_ID,
  D.CODE MAIN_CODE,
  EC.HRM_ELEMENTS_ID LINK2_ID,
  EC.HRM_EMPLOYEE_ID EMPID,
  EC.HEE_BASE_AMOUNT,
  EC.HEE_RATE,
  EC.HEE_PER_RATE,
  EC.HEE_VALUE,
  EC.HEE_TEXT,
  EC.HEE_OVERRIDE,
  EC.HEE_FOREIGN_VALUE,
  EC.HEE_REF_VALUE,
  EC.HEE_ZL,
  EC.HEE_CURRENCY,
  EC.HEE_EX_RATE
from
  V_HRM_ELEMENTS_SHORT D,
  HRM_ELEMENTS_FAMILY C,
  HRM_ELEMENTS_FAMILY B,
  HRM_EMPL_ELEM_CALC EC
where
  B.HRM_ELEMENTS_ID = EC.HRM_ELEMENTS_ID and
  C.HRM_ELEMENTS_ROOT_ID = B.HRM_ELEMENTS_ROOT_ID and
  C.ELF_IS_REFERENCE = 1 and
  D.ELEMID = C.HRM_ELEMENTS_ID and
  b.hrm_elements_prefixes_id = 'CONEM' and
  not Exists(select 1 from hrm_empl_elem_calc c2, hrm_elements_family f
             where c2.hrm_employee_id = ec.hrm_employee_id and
               b.hrm_elements_root_id = f.hrm_elements_root_id and
               f.hrm_elements_prefixes_id = 'EM' and
               c2.hrm_elements_id = f.hrm_elements_id)
union all
select
  D.ELEMID MAIN_ID,
  D.CODE MAIN_CODE,
  EC.HRM_ELEMENTS_ID LINK2_ID,
  EC.HRM_EMPLOYEE_ID EMPID,
  EC.HEE_BASE_AMOUNT,
  EC.HEE_RATE,
  EC.HEE_PER_RATE,
  EC.HEE_VALUE,
  EC.HEE_TEXT,
  EC.HEE_OVERRIDE,
  EC.HEE_FOREIGN_VALUE,
  EC.HEE_REF_VALUE,
  EC.HEE_ZL,
  EC.HEE_CURRENCY,
  EC.HEE_EX_RATE
from
  V_HRM_ELEMENTS_SHORT D,
  HRM_ELEMENTS_FAMILY C,
  HRM_ELEMENTS_FAMILY B,
  HRM_EMPL_ELEM_CALC EC
where
  B.HRM_ELEMENTS_ID = EC.HRM_ELEMENTS_ID and
  C.HRM_ELEMENTS_ROOT_ID = B.HRM_ELEMENTS_ROOT_ID and
  C.ELF_IS_REFERENCE = 1 and
  D.ELEMID = C.HRM_ELEMENTS_ID and
  B.HRM_ELEMENTS_ROOT_ID not in (
      select D.HRM_ELEMENTS_ROOT_ID
      from HRM_EMPL_ELEM_CALC C, HRM_ELEMENTS_FAMILY D
      where C.HRM_EMPLOYEE_ID = EC.HRM_EMPLOYEE_ID and
        D.HRM_ELEMENTS_ID = C.HRM_ELEMENTS_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_ELEMENTS" ("ELEMENTID", "SHEETID", "ORIGINID", "EMPID", "CODE", "BASEAMOUNT", "RATE", "PERRATE", "ELEMNUMVAL", "ELEMVALUE", "ELEMFOREIGNVALUE", "ELEMFORMAT", "ELEPRECISION", "ELEROUND", "BEGINDATE", "ENDDATE", "BEGINVALUEDATE", "ENDVALUEDATE", "ACTIVE", "ELEMRATE") AS
  SELECT
  ee.hrm_employee_elements_id empid,
  ss.hrm_salary_sheet_id sheetid,
  ee.hrm_elements_id,
  ee.hrm_employee_id,
  e.ele_code,
  ee.emp_base_amount,
  ee.emp_rate,
  ee.emp_per_rate,
  case
    when nvl(r.c_hrm_sal_const_type,e.ele_format+2) = '3' then
      to_char(ee.emp_num_value)
  end emp_num_value,
  case
    when nvl(r.c_hrm_sal_const_type,e.ele_format+2) <> '3' then
      ee.emp_value
  end emp_value,
  ee.emp_foreign_value,
  e.ele_format,
  e.ele_Precision,
  e.ele_Round,
  r.elr_from,
  r.elr_to,
  ee.emp_value_from,
  ee.emp_value_to,
  hrm_utils.BoolToStr(ee.emp_active) active,
  ee.emp_ex_rate
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_elements e,
  hrm_salary_sheet_elements ss,
  hrm_employee_elements ee
WHERE
  e.hrm_elements_id = ee.hrm_elements_id and
  ss.hrm_elements_id = ee.hrm_elements_id and
  f.hrm_elements_id = ee.hrm_elements_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  r.elr_from <= hrm_date.ActivePeriodEndDate and
  r.elr_to >= hrm_date.ActivePeriod


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_ELEMENTS_LINK" ("MAIN_ID", "MAIN_CODE", "LINK2_ID", "EMPID", "EMPELEMID", "BASEAMOUNT", "RATE", "PERRATE", "VALUE", "TEXT", "OVERRIDE", "EXVALUE", "REFVALUE", "ZL", "EMP_ACTIVE", "CURRENCY", "EXRATE", "SHEET_ID") AS
  SELECT
  EE.MAIN_ID,
  EE.MAIN_CODE,
  EE.LINK1_ID,
  EE.EMPID,
  EE.EMPELEMID,
  EE.BASEAMOUNT,
  EE.RATE,
  EE.PERRATE,
  EE.VALUE,
  EE.TEXT,
  EE.OVERRIDE,
  EE.EXVALUE,
  EE.REFVALUE,
  EE.ZL,
  EE.ACTIVE,
  EE.CURRENCY,
  EE.EXRATE,
  SE.HRM_SALARY_SHEET_ID
from
  HRM_SALARY_SHEET_ELEMENTS SE,
  (select
    MAIN_ID,
    MAIN_CODE,
    LINK1_ID,
    EMPID,
    EMPELEMID,
    BASEAMOUNT,
    RATE,
    PERRATE,
    EMP_VALUE VALUE,
    TEXT,
    OVERRIDE,
    EXVALUE,
    REFVALUE,
    ZL,
    EMP_ACTIVE ACTIVE,
    CURRENCY,
    EXRATE
  from V_HRM_ELEMENTS_NEW_LINK1
  union all
  select
    MAIN_ID,
    MAIN_CODE,
    LINK2_ID,
    EMPID,
    EMPELEMID,
    BASEAMOUNT,
    RATE,
    PERRATE,
    EMP_VALUE VALUE,
    TEXT,
    OVERRIDE,
    EXVALUE,
    REFVALUE,
    ZL,
    EMP_ACTIVE ACTIVE,
    CURRENCY,
    EXRATE
  from V_HRM_ELEMENTS_NEW_LINK2) EE
where
  SE.HRM_ELEMENTS_ID = EE.LINK1_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_EXCHANGE_RATE" ("EMPID", "CODE", "CURCODE", "DAILY_RATE", "EVAL_RATE", "INV_RATE", "CLOS_RATE") AS
  SELECT
  a.hrm_employee_id,
  substr(b.con_code, 1, 15),
  substr(c.cod_code, 1, 5),
  d.Daily_rate,
  d.Eval_rate,
  d.Inv_rate,
  d.Clos_rate
FROM
  hrm_employee_const a,
  hrm_constants b,
  hrm_code_table c,
  v_hrm_exchange_rates d
WHERE
  b.hrm_constants_id = a.hrm_constants_id and
  b.con_code = 'ConEmMonnaie' and
  c.HRM_Code_Table_id (+) = a.hrm_code_Table_id and
  d.curcode = c.cod_code


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_HISTORY" ("EMPID", "PAYNUM", "SHEET", "PERIOD", "SUM_VAL", "VALUE", "CODE", "HDS_CODE", "TEXT", "OVERRIDE", "BASE_AMOUNT", "RATE", "PER_RATE", "CURRENCY", "CURRENCY_VALUE", "REF_VALUE", "ZL") AS
  SELECT
  H.HRM_EMPLOYEE_ID,
  H.HIS_PAY_NUM,
  H.HRM_SALARY_SHEET_ID,
  H.HIS_PAY_PERIOD,
  to_char(H.HIS_PAY_SUM_VAL) SUM_VAL,
  case H.HIS_PAY_SUM_VAL
    when 0 then H.HIS_PAY_VALUE
  end VALUE,
  V.CODE,
  S.HDS_CODE,
  S.HDS_TEXT,
  S.HDS_OVERRIDE,
  S.HDS_BASE_AMOUNT,
  S.HDS_RATE,
  S.HDS_PER_RATE,
  Coalesce(
    S.HDS_CURRENCY,
    (select CURRENCY from V_ACS_FINANCIAL_CURRENCY
     where ACS_FINANCIAL_CURRENCY_ID = H.ACS_FINANCIAL_CURRENCY_ID)) CURRENCY,
  H.HIS_CURRENCY_VALUE,
  H.HIS_REF_VALUE,
  H.HIS_ZL
FROM
  V_HRM_ELEMENTS_SHORT V,
  HRM_HISTORY_DETAIL_SUP S,
  HRM_HISTORY_DETAIL H
WHERE
  V.ELEMID = H.HRM_ELEMENTS_ID and
  S.HRM_HISTORY_DETAIL_ID(+) = H.HRM_HISTORY_DETAIL_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_HISTORY_BUDGET" ("HEADER_ID", "SUM_VAL", "VALUE", "CODE") AS
  SELECT
  h.hrm_budget_header_id,
  to_char(h.hbu_pay_sum_val) sum_val,
  case h.hbu_pay_sum_val
    when 0 then h.hbu_pay_val
  end value,
  nvl(e.ele_code, c.con_code)
FROM
  hrm_constants c,
  hrm_elements e,
  hrm_budget_detail h
WHERE
  e.hrm_elements_id(+) = h.hrm_elements_id AND
  c.hrm_constants_id(+) = h.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_HISTORY_DADS" ("INOUT_ID", "PAY_YEAR", "ELEM_ID", "SUM_VAL", "VALUE") AS
  SELECT
  v.inoutid,
  v.payyear,
  f.hrm_elements_id,
  to_char(
    case
      when r.elr_format = 1 then
           case f.elf_agreg
             when 0 then sum(h.his_pay_sum_val)
             else max(h.his_pay_sum_val)
           end
    end) his_num_value,
  CASE
    when r.elr_format <> 1 then
         case f.elf_agreg
           when 1 then max(h.his_pay_value)
         end
  end his_value
FROM
  hrm_history_detail h,
  v_hrm_dads_empl_pay v,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  h.hrm_employee_id = v.empid AND
  h.his_pay_num = v.pay AND
  h.hrm_elements_id = f.hrm_elements_id AND
  r.elr_is_active = 1 AND
  r.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_prefixes_id in ('CONEM','EM','CEM','DIV','GM')
GROUP BY
  v.inoutid,
  v.payyear,
  f.hrm_elements_id,
  f.elf_agreg,
  r.elr_format




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_HISTORY_REVERSAL" ("EMPID", "PAYNUM", "SHEET", "PERIOD", "ELEMID", "SUM_VAL", "VALUE") AS
  SELECT
  -- Montants (EM, CONEM, GM, GT)
  hd.hrm_employee_id,
  hd.his_pay_num,
  hd.hrm_salary_sheet_id,
  hd.his_pay_period,
  hd.hrm_elements_id,
  to_char(case when (elr_root_rate = 0) and
                    ((f.hrm_elements_prefixes_id <> 'CONEM') or
                     (r.c_hrm_sal_const_type in ('0', '3'))) then
            -1 * hd.his_pay_sum_val
          else
            hd.his_pay_sum_val
          end) his_pay_sum_val,
  '' his_pay_value
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_history_detail hd
WHERE hrm_var.isnumber (hd.his_pay_value) = 1 AND
  f.hrm_elements_id = hd.hrm_elements_id AND
  f.hrm_elements_prefixes_id in ('EM', 'CONEM', 'GM', 'GT') AND
  NOT EXISTS (SELECT 1 FROM hrm_elements
              WHERE ele_correlated_id = f.hrm_elements_id) AND
  r.hrm_elements_root_id = f.hrm_elements_root_id
UNION ALL
SELECT
  -- Textes (EM, CONEM, GM, GT)
  hd.hrm_employee_id,
  hd.his_pay_num,
  hd.hrm_salary_sheet_id,
  hd.his_pay_period,
  hd.hrm_elements_id,
  '0' his_pay_sum_val,
  hd.his_pay_value
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_history_detail hd
WHERE hrm_var.isnumber (hd.his_pay_value) = 0 AND
  f.hrm_elements_id = hd.hrm_elements_id AND
  f.hrm_elements_prefixes_id in ('EM', 'CONEM', 'GM', 'GT') AND
  r.hrm_elements_root_id = f.hrm_elements_root_id
UNION ALL
SELECT
  -- Montants/Textes (DIV)
  hd.hrm_employee_id,
  hd.his_pay_num,
  hd.hrm_salary_sheet_id,
  hd.his_pay_period,
  hd.hrm_elements_id,
  to_char(case INSTR (r.elr_root_name, 'Taux')
            when 0 then -1 * hd.his_pay_sum_val
            else hd.his_pay_sum_val
          end) his_pay_sum_val,
  case
    when hrm_var.isnumber(hd.his_pay_value) <> 1 then
      hd.his_pay_value
  end his_pay_value
FROM
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_history_detail hd
WHERE f.hrm_elements_id = hd.hrm_elements_id AND
  f.hrm_elements_prefixes_id in ('DIV') AND
  r.hrm_elements_root_id = f.hrm_elements_root_id
UNION ALL
SELECT
  -- Montants OUTCUMCEM / OUTCONEM
  hd.hrm_employee_id,
  hd.his_pay_num,
  hd.hrm_salary_sheet_id,
  hd.his_pay_period,
  cum.ele_correlated_id hrm_elements_id,
  to_char(hd.his_pay_sum_val),
  '' his_pay_value
FROM
  hrm_elements cum,
  hrm_elements_family f,
  hrm_history_detail hd
WHERE
  hrm_var.isnumber (hd.his_pay_value) = 1 AND
  f.hrm_elements_id = hd.hrm_elements_id AND
  f.hrm_elements_prefixes_id in('OUTCUMCEM', 'OUTCONEM') AND
  (f.hrm_elements_suffixes_id is null or f.hrm_elements_suffixes_id = 'NONE') AND
  cum.hrm_elements_id = f.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_SUM" ("CONSTID", "EMPID", "SHEETID", "BASEAMOUNT", "RATE", "PERRATE", "CONSTNUMVAL", "CONSTVALUE", "CONSTFOREIGNVALUE", "BEGINVALUEDATE", "ENDVALUEDATE", "ACTIVE", "CONSTRATE") AS
  select
  C.ELE_CORRELATED_ID,
  P.HRM_PERSON_ID,
  H.HRM_SALARY_SHEET_ID,
  0,
  0,
  0,
  to_char(H.HIS_PAY_SUM_VAL),
  '',
  0,
  hrm_date.BeginOfYear,
  hrm_date.EndOfYear,
  hrm_utils.get_TrueBoolStr, --'True',
  0.0
from
  HRM_PERSON P,
  HRM_ELEMENTS C,
  HRM_HISTORY_DETAIL H
where
  -- Mise  0 des cumuls si 1er dcompte de l'anne <> calcul rtroactif
  ((Trunc(p.EMP_LAST_PAY_DATE, 'Y') = hrm_date.BeginOfYear and
    (select S.SAL_IS_RETRO from HRM_SALARY_SHEET S where S.HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID)= 0) or
   hrm_date.Get_CalcRetro = 1) and
  H.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  H.HIS_PAY_NUM = P.EMP_LAST_PAY_NUM and
  H.HIS_PAY_SUM_VAL <> 0 and
  C.HRM_ELEMENTS_ID = H.HRM_ELEMENTS_ID and
  Exists(select 1 from HRM_ELEMENTS E
         where E.HRM_ELEMENTS_ID = C.ELE_CORRELATED_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_SUM_CUST_SALARY" ("ELEMID", "EMPID", "BASEAMOUNT", "RATE", "PERRATE", "NUMVAL", "VALUE", "FOREIGNVALUE", "BEGINVALUEDATE", "ENDVALUEDATE", "EXRATE") AS
  select
  C.ELE_CORRELATED_ID ELEMID,
  H.HRM_EMPLOYEE_ID EMPID,
  0.0 BASEAMOUNT,
  0.0 RATE,
  0.0 PERRATE,
  to_char(H.HIS_PAY_SUM_VAL) NUMVAL,
  '' VALUE,
  0.0 FOREIGNVALUE,
  hrm_date.BeginOfYear BEGINVALUEDATE,
  hrm_date.EndOfYear ENDVALUEDATE,
  0.0 EXRATE
from
  HRM_ELEMENTS C,
  HRM_HISTORY_DETAIL H
where
  H.HIS_PAY_NUM = (select Max(HIT_PAY_NUM) from HRM_HISTORY
                   where HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
                     HIT_PAY_PERIOD >= hrm_date.BeginOfYear) and
  H.HIS_PAY_SUM_VAL <> 0 and
  C.HRM_ELEMENTS_ID = H.HRM_ELEMENTS_ID and
  Exists(select 1 from HRM_ELEMENTS E
         where E.HRM_ELEMENTS_ID = C.ELE_CORRELATED_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EMP_VALUES_BUDGET" ("EMPID", "SHEET", "CONSTID", "NUMVAL", "VAL") AS
  SELECT
  c.hrm_employee_id,
  s.hrm_salary_sheet_id,
  c.hrm_constants_id,
  to_char(
    round (sum (emc_num_value *
                hrm_date.days_between (greatest (trunc (emc_value_from,'Month'),hrm_date.activeperiod),
                                       least (last_day (emc_value_to),hrm_date.activeperiodenddate)))  /
           sum (hrm_date.days_between (greatest (trunc (emc_value_from,'Month'),hrm_date.activeperiod),
                                       least (last_day (emc_value_to), hrm_date.activeperiodenddate))) *
           decode (elr_root_rate,1,1, least (hrm_date.ac_days_sincebeginofyear (hrm_employee_id),
                                             sum (hrm_date.days_between (greatest (trunc (emc_value_from,'Month'), hrm_date.activeperiod),
                                                                         least (last_day (emc_value_to), hrm_date.activeperiodenddate) ) ) ) /30),
           r.elr_input_precision)) numval,
  '' val
FROM
  hrm_elements_family f,
  hrm_elements_root r,
  hrm_salary_sheet_elements s,
  hrm_employee_const c
WHERE
  s.hrm_elements_id = c.hrm_constants_id AND
  f.hrm_elements_id = c.hrm_constants_id AND
  r.hrm_elements_root_id = f.hrm_elements_root_id AND
  r.c_hrm_sal_const_type = 3 AND
  hrm_date.validforactiveperiod (c.emc_value_from,c.emc_value_to) = 1
GROUP BY
  c.hrm_employee_id,
  c.hrm_constants_id,
  s.hrm_salary_sheet_id,
  elr_root_rate,
  elr_input_precision
UNION ALL
-- Variable numriques
SELECT
  e.hrm_employee_id,
  s.hrm_salary_sheet_id,
  e.hrm_elements_id,
  to_char(
    round (sum (emp_num_value *
                hrm_date.days_between (greatest (trunc (emp_value_from,'Month'), hrm_date.activeperiod),
                                       least (last_day (emp_value_to), hrm_date.activeperiodenddate))) /
           sum (hrm_date.days_between (greatest (trunc (emp_value_from,'Month'),hrm_date.activeperiod),
                                       least (last_day (emp_value_to), hrm_date.activeperiodenddate)))  *
           decode (elr_root_rate,1,1,least (hrm_date.ac_days_sincebeginofyear (hrm_employee_id),
                                            sum (hrm_date.days_between (greatest (trunc (emp_value_from,'Month'), hrm_date.activeperiod),
                                                                        least (last_day (emp_value_to),hrm_date.activeperiodenddate) ) ) ) /30),
           r.elr_input_precision)) numval,
  '' val
FROM
  hrm_elements_family f,
  hrm_elements_root r,
  hrm_salary_sheet_elements s,
  hrm_employee_elements e
WHERE
  s.hrm_elements_id = e.hrm_elements_id AND
  f.hrm_elements_id = e.hrm_elements_id AND
  r.hrm_elements_root_id = f.hrm_elements_root_id AND
  nvl (r.c_hrm_sal_const_type,r.elr_format+2) = 3 AND
  hrm_date.validforactiveperiod (emp_value_from,emp_value_to) = 1
GROUP BY
  e.hrm_employee_id,
  e.hrm_elements_id,
  s.hrm_salary_sheet_id,
  elr_root_rate,
  elr_input_precision
UNION ALL
-- Codes soumission et Codes avec tabelles
SELECT
  c.hrm_employee_id,
  s.hrm_salary_sheet_id,
  c.hrm_constants_id,
  '0' numval,
  ct.cod_code val
FROM
  hrm_elements_family f,
  hrm_elements_root r,
  hrm_code_table ct,
  hrm_salary_sheet_elements s,
  hrm_employee_const c
WHERE
  ct.hrm_code_table_id = c.hrm_code_table_id AND
  s.hrm_elements_id = c.hrm_constants_id AND
  f.hrm_elements_id = c.hrm_constants_id AND
  r.hrm_elements_root_id = f.hrm_elements_root_id AND
  r.c_hrm_sal_const_type IN (2,1) AND
  emc_value_from = (SELECT max (emc_value_from)
                    FROM hrm_employee_const c2
                    WHERE c2.hrm_employee_id = c.hrm_employee_id AND
                          c2.hrm_constants_id = c.hrm_constants_id AND
                          hrm_date.validforactiveperiod (c2.emc_value_from,c2.emc_value_to) = 1)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ERRORS_ACCOUNT" ("HRM_BREAK_ID", "MGS", "HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID") AS
  SELECT
  hrm_break_id,
  'Compte CG inconnu :'||HDB_ACCOUNT_NAME MGS,
  HRM_EMPLOYEE_ID,
  HRM_ELEMENTS_ID
FROM
  hrm_break_detail
WHERE
  DIC_ACCOUNT_TYPE_ID = 'CG' and
  HDB_ACCOUNT_NAME not in (SELECT acc_number
                           FROM acs_financial_account, acs_account
                           WHERE ACS_FINANCIAL_ACCOUNT_ID = ACS_ACCOUNT_ID)
UNION
SELECT
  hrm_break_id,
  'Compte DIV inconnu :'||HDB_ACCOUNT_NAME MGS,
  HRM_EMPLOYEE_ID,
  HRM_ELEMENTS_ID
FROM
  hrm_break_detail
WHERE
  DIC_ACCOUNT_TYPE_ID = 'DIV' and
  HDB_ACCOUNT_NAME not in (SELECT acc_number
                           FROM acs_division_account, acs_account
                           WHERE ACS_DIVISION_ACCOUNT_ID = ACS_ACCOUNT_ID)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_ERRORS_LOG" ("NAME", "EMP_NUMBER", "C_HRM_SAL_CONST_TYPE", "HRM_ELEMENTS_ID", "ELO_MESSAGE", "ELO_DATE", "ELE_CODE", "ELO_TYPE", "ELE_DESCR") AS
  SELECT
  p.per_last_name||' '||p.per_first_name name,
  p.emp_number,
  vc.gcdtext1 c_hrm_sal_const_type,
  err.hrm_elements_id,
  err.elo_message,
  err.elo_date,
  nvl(e.ele_code, c.con_code) ele_code,
  err.elo_type,
  d.erd_descr ele_descr
FROM
  pcs.v_pc_descodes vc,
  hrm_elements_root_descr d,
  hrm_constants c,
  hrm_elements e,
  hrm_elements_family f,
  hrm_person p,
  hrm_errors_log err
WHERE
  vc.gcgname (+) = 'C_HRM_SAL_CONST_TYPE' and
  vc.gclcode (+) = c.C_HRM_SAL_CONST_TYPE and
  vc.pc_lang_id (+) = pcs.PC_I_LIB_SESSION.GetUserLangId and
  d.pc_lang_id (+) = pcs.PC_I_LIB_SESSION.GetUserLangId and
  d.hrm_elements_root_id (+) = f.hrm_elements_root_id and
  c.hrm_constants_id (+) = f.hrm_elements_id and
  e.hrm_elements_id (+) = f.hrm_elements_id and
  f.hrm_elements_id (+) = err.hrm_elements_id and
  p.hrm_person_id (+) = err.hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EVAL_PERSON_GOAL_ALL" ("HRM_EVAL_PERSON_ID", "HRM_PERSON_ID", "HRM_EVAL_GOAL_ID", "DIC_GOAL_TYPE_ID", "EVG_COMMENT", "EPG_FROM", "EPG_TO", "EPG_WEIGHT", "ANSWER", "ANSWER_DESCR", "ANSWER_COMMENT", "POINTS", "EVC_SUBJECT", "EVC_COMMENT", "HRM_EVAL_NOTATION_ID", "C_HRM_CHAPTER_TYPE", "EVC_FUNCTION", "EVC_PRN_NOTATION") AS
  SELECT hrm_eval_person_id, hrm_person_id, hrm_eval_goal_id,
          dic_goal_type_id, evg_comment, evg_from, evg_to, evg_weight,
          NULL answer, NULL answer_descr, NULL answer_comment, evg_points,
          evc_subject, evc_comment, hrm_eval_notation_id,
          '03' c_hrm_chapter_type, evc_function, evc_prn_notation
     FROM v_hrm_eval_person_goal_soc
   UNION ALL
   SELECT hrm_eval_person_id, hrm_person_id, hrm_eval_goal_id,
          dic_goal_type_id, evg_comment, evg_from, evg_to, evg_weight,
          NULL answer, NULL answer_descr, NULL answer_comment, evg_points,
          evc_subject, evc_comment, hrm_eval_notation_id,
          '03' c_hrm_chapter_type, evc_function, evc_prn_notation
     FROM v_hrm_eval_person_goal_group
   UNION ALL
   SELECT hrm_eval_person_id, hrm_person_id, hrm_eval_goal_id,
          dic_goal_type_id, evg_comment, epg_from, epg_to, epg_weight,
          evp_answer, evd_descr, evd_comment, evp_points, evc_subject,
          evc_comment, hrm_eval_notation_id, c_hrm_chapter_type, evc_function,
          evc_prn_notation
     FROM v_hrm_eval_person_goal_ind


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EVAL_PERSON_GOAL_GROUP" ("ANSWER", "HRM_EVAL_ANSWER_ID", "HRM_EVAL_PERSON_ID", "HRM_PERSON_ID", "HRM_EVAL_GOAL_ID", "DIC_GOAL_TYPE_ID", "EVG_COMMENT", "EVG_FROM", "EPG_FROM", "EVG_TO", "EPG_TO", "EVG_WEIGHT", "EPG_WEIGHT", "EVG_POINTS", "EPG_POINTS", "EVC_SUBJECT", "EVC_COMMENT", "HRM_EVAL_NOTATION_ID", "EVC_FUNCTION", "EVC_PRN_NOTATION", "HRM_EVAL_GOAL_ID1", "GOAL_CODE", "HRM_EVAL_NOTATION_DETAIL_ID") AS
  SELECT NULL answer, NULL hrm_eval_answer_id, ep.hrm_eval_person_id,
          ep.hrm_person_id, eg.hrm_eval_goal_id, eg.dic_goal_type_id,
          evg_comment, evg_from, evg_from epg_from, evg_to, evg_to epg_to,
          evg_weight, evg_weight epg_weight, evg_points,
          evg_points epg_points, evc_subject, evc_comment,
          ec.hrm_eval_notation_id, evc_function, evc_prn_notation,
          eg.hrm_eval_goal_id hrm_eval_goal_id1,
          eg.dic_goal_type_id goal_code,
          (SELECT hrm_eval_notation_detail_id
             FROM hrm_eval_notation_detail nd
            WHERE hrm_eval_notation_id = ec.hrm_eval_notation_id
              AND nd.evd_points = eg.evg_points) hrm_eval_notation_detail_id
     FROM hrm_eval_goal eg,
          hrm_person_goal pg,
          hrm_eval_person ep,
          (SELECT *
             FROM hrm_eval_chapter
            WHERE c_hrm_chapter_type = '03') ec,
          hrm_eval_prog_chap epc
    WHERE eg.hrm_eval_goal_id = pg.hrm_eval_goal_id
      AND epc.hrm_eval_program_id = ep.hrm_eval_program_id
      AND epc.hrm_eval_chapter_id = ec.hrm_eval_chapter_id
      AND eg.dic_goal_type_id = 'GROUPE'
      AND pg.hrm_person_id = ep.hrm_person_id
      AND (   evg_from BETWEEN ep.evp_from AND ep.evp_to
           OR evg_to BETWEEN ep.evp_from AND ep.evp_to
          )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EVAL_PERSON_GOAL_IND" ("HRM_EVAL_PERSON_ID", "HRM_PERSON_ID", "HRM_EVAL_GOAL_ID", "DIC_GOAL_TYPE_ID", "EVG_COMMENT", "EPG_FROM", "EPG_TO", "EPG_WEIGHT", "EVP_ANSWER", "EVD_DESCR", "EVD_COMMENT", "EVP_POINTS", "EVC_SUBJECT", "EVC_COMMENT", "HRM_EVAL_NOTATION_ID", "C_HRM_CHAPTER_TYPE", "EVC_FUNCTION", "EVC_PRN_NOTATION") AS
  SELECT ep.hrm_eval_person_id, ep.hrm_person_id, eg.hrm_eval_goal_id,
          eg.dic_goal_type_id, evg_comment, epg_from, epg_to, epg_weight,
          evp_answer, evd_descr, evd_comment, evp_points, evc_subject,
          evc_comment, ec.hrm_eval_notation_id, c_hrm_chapter_type,
          evc_function, evc_prn_notation
     FROM hrm_eval_goal eg,
          hrm_person_goal pg,
          hrm_eval_person ep,
          hrm_eval_chapter ec,
          hrm_eval_answer ea,
          hrm_eval_notation_detail nd
    WHERE eg.hrm_eval_goal_id = pg.hrm_eval_goal_id
      AND eg.dic_goal_type_id = 'IND'
      AND eg.hrm_eval_chapter_id = ec.hrm_eval_chapter_id(+)
      AND ep.hrm_eval_person_id = pg.hrm_eval_person_eval_id
      AND eg.hrm_eval_goal_id = ea.hrm_eval_goal_id
      AND ea.hrm_eval_notation_detail_id = nd.hrm_eval_notation_detail_id(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EVAL_PERSON_GOAL_SOC" ("ANSWER", "HRM_EVAL_ANSWER_ID", "HRM_EVAL_PERSON_ID", "HRM_PERSON_ID", "HRM_EVAL_GOAL_ID", "DIC_GOAL_TYPE_ID", "EVG_COMMENT", "EVG_FROM", "EPG_FROM", "EVG_TO", "EPG_TO", "EVG_WEIGHT", "EPG_WEIGHT", "EVG_POINTS", "EPG_POINTS", "EVC_SUBJECT", "EVC_COMMENT", "HRM_EVAL_NOTATION_ID", "EVC_FUNCTION", "EVC_PRN_NOTATION", "HRM_EVAL_GOAL_ID1", "GOAL_CODE", "HRM_EVAL_NOTATION_DETAIL_ID") AS
  SELECT NULL answer, NULL hrm_eval_answer_id, ep.hrm_eval_person_id,
          ep.hrm_person_id, eg.hrm_eval_goal_id, eg.dic_goal_type_id,
          evg_comment, evg_from, evg_from epg_from, evg_to, evg_to epg_to,
          evg_weight, evg_weight epg_weight, evg_points,
          evg_points epg_points, evc_subject, evc_comment,
          hrm_eval_notation_id, evc_function, evc_prn_notation,
          eg.hrm_eval_goal_id hrm_eval_goal_id1,
          eg.dic_goal_type_id goal_code, NULL hrm_eval_notation_detail_id
     FROM hrm_eval_goal eg,
          hrm_person_goal pg,
          hrm_eval_person ep,
          (SELECT *
             FROM hrm_eval_chapter
            WHERE c_hrm_chapter_type = '03') ec,
          hrm_eval_prog_chap epc
    WHERE eg.hrm_eval_goal_id = pg.hrm_eval_goal_id
      AND eg.dic_goal_type_id = 'SOC'
      AND epc.hrm_eval_program_id = ep.hrm_eval_program_id
      AND epc.hrm_eval_chapter_id = ec.hrm_eval_chapter_id
      AND pg.hrm_person_id = ep.hrm_person_id
      AND (   evg_from BETWEEN ep.evp_from AND ep.evp_to
           OR evg_to BETWEEN ep.evp_from AND ep.evp_to
          )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EXCHANGE_NAMES" ("CURID", "CURCODE", "CURNAME", "ACC", "HRM") AS
  SELECT
  a.acs_financial_currency_id,
  b.currency,
  b.currname,
  hrm_utils.BoolToStr(a.fin_local_currency),
  hrm_utils.BoolToStr(a.fin_hrm_currency)
FROM
  pcs.pc_curr b,
  acs_financial_currency a
WHERE
  a.pc_curr_id = b.pc_curr_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_EXCHANGE_RATES" ("CURID", "CURCODE", "CURNAME", "DAILY_RATE", "EVAL_RATE", "INV_RATE", "CLOS_RATE", "VALIDFROM", "ACC", "HRM", "CHANGETOBASE") AS
  SELECT
  v.acs_between_curr_id,
  b.currency,
  b.currname,
  c.pcu_dayly_price/c.pcu_base_price,
  c.pcu_valuation_price/c.pcu_base_price,
  c.pcu_inventory_price/c.pcu_base_price,
  c.pcu_closing_price/c.pcu_base_price,
  v.pcu_start_validity,
  hrm_utils.BoolToStr(a.fin_local_currency),
  hrm_utils.BoolToStr(a.fin_hrm_currency),
  hrm_utils.get_TrueBoolStr
FROM
  acs_price_currency c,
  pcs.pc_curr b,
  acs_financial_currency a,
  (SELECT max(pcu_start_validity) pcu_start_validity,
          acs_between_curr_id, acs_and_curr_id
   FROM acs_price_currency
   WHERE acs_and_curr_id = acs_function.getlocalcurrencyid and
     pcu_start_validity <= sysdate
   GROUP BY acs_and_curr_id, acs_between_curr_id) v
WHERE
  b.pc_curr_id = a.pc_curr_id and
  c.acs_and_curr_id = v.acs_and_curr_id and
  c.acs_between_curr_id = v.acs_between_curr_id and
  c.pcu_start_validity = v.pcu_start_validity and
  a.acs_financial_currency_id = v.acs_between_curr_id
UNION ALL
SELECT
  a.acs_financial_currency_id CurId,
  b.Currency CurCode,
  b.Currname CurName,
  1,
  1,
  1,
  1,
  trunc(sysdate,'year'),
  hrm_utils.get_TrueBoolStr,
  hrm_utils.get_FalseBoolStr,
  hrm_utils.get_TrueBoolStr
FROM
  pcs.pc_Curr b,
  acs_Financial_currency a
WHERE
  a.Fin_local_currency = 1 and
  b.pc_Curr_id = a.pc_Curr_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_HISTORY_DETAIL" ("HISID", "ELEMID", "EMPID", "SALARYSHEETID", "HISPERIOD", "HISPERIODYYYY", "HISPERIODMM", "HISPERIODYYYYMM", "HISVALUE", "HISSUMVALUE", "HISDEF", "HISCURVAL", "ELEMCODE", "ELEMREPORTING", "ELEMDESCR", "STATCODE", "SIGN") AS
  SELECT
  a.hrm_history_detail_id,
  a.hrm_elements_id,
  a.hrm_employee_id,
  a.hrm_salary_sheet_id,
  a.his_pay_period,
  to_char(a.his_pay_period, 'YYYY'),
  to_char(a.his_pay_period, 'MM'),
  to_char(a.his_pay_period, 'YYYYMM'),
  a.his_pay_value,
  a.his_pay_sum_val,
  to_char(a.his_definitive),
  a.his_currency_value,
  b.code,
  b.is_reporting,
  b.descr,
  b.statcode,
  b.sign
FROM
  hrm_history_detail a,
  v_hrm_defined_names b
WHERE
  a.hrm_elements_id = b.id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_HISTORY_DETAIL_TO_BREAK" ("HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "HRM_SALARY_SHEET_ID", "HIS_PAY_NUM", "HIS_PAY_PERIOD", "HIS_PAY_VALUE", "HIS_PAY_SUM_VAL", "ACS_FINANCIAL_CURRENCY_ID", "HIS_CURRENCY_VALUE", "HIS_REF_VALUE", "HIS_DEFINITIVE", "HIS_ACCOUNTED", "HIS_PAID", "HIS_DATE", "HIS_ZL") AS
  SELECT
  a.HRM_HISTORY_DETAIL_ID,
  a.HRM_ELEMENTS_ID,
  a.HRM_EMPLOYEE_ID,
  a.HRM_SALARY_SHEET_ID,
  a.HIS_PAY_NUM,
  a.HIS_PAY_PERIOD,
  a.HIS_PAY_VALUE,
  a.HIS_PAY_SUM_VAL,
  a.ACS_FINANCIAL_CURRENCY_ID,
  a.HIS_CURRENCY_VALUE,
  a.HIS_REF_VALUE,
  a.HIS_DEFINITIVE,
  a.HIS_ACCOUNTED,
  a.HIS_PAID,
  a.HIS_DATE,
  a.HIS_ZL
FROM
  hrm_history_detail a,
  hrm_history b
WHERE
  his_accounted in (0,2) and
  hit_pay_num = his_pay_num and
  a.hrm_employee_id = b.hrm_employee_id and
  a.hrm_salary_sheet_id = b.hrm_salary_sheet_id and
  hit_accounted = 3


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_HIS_CUM_PERIOD" ("ELEMID", "PERIOD", "VALUE", "DEFINITIVE", "HISDEF", "STATCODE", "DESCR", "CODE", "LANGID", "STATGROUP") AS
  SELECT
  h.hrm_elements_id elemid,
  To_Char(h.his_pay_period, 'YYYYMM') period,
  sum(h.his_pay_sum_val) value,
  h.his_definitive definitive,
  to_char(h.his_definitive) hisdef,
  r.elr_root_code,
  rd.erd_descr,
  r.elr_root_name,
  rd.pc_lang_id,
  r.elr_root_code statgroup
FROM
  hrm_elements_root_descr rd,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  rd.hrm_elements_root_id = r.hrm_elements_root_id and
  h.hrm_elements_id = f.hrm_elements_id and
  f.elf_is_reference = 1 and
  f.hrm_elements_root_id = r.hrm_elements_root_id and
  r.elr_is_active = 1 and
  r.elr_reporting = 1
GROUP BY
  h.hrm_elements_id,
  r.elr_root_code,
  r.elr_root_name,
  rd.erd_descr,
  h.his_pay_period,
  h.his_definitive,
  rd.pc_lang_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_HOLIDAYS" ("DEPARTMENT", "EMPNAME", "VALUE", "CODE", "EMPSTATUS", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "LISTID", "COE_BOX", "EMPID") AS
  SELECT
  p.dic_department_id,
  p.per_last_name||' '||p.per_first_name,
  nvl(c.emc_value, to_char(c.emc_num_value)),
  e.coe_code,
  p.emp_status,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name),
  p.per_search_name||to_char(p.hrm_person_id),
  e.hrm_control_list_id,
  e.coe_box,
  p.hrm_person_id
FROM
  hrm_person p,
  hrm_employee_const c,
  hrm_control_elements e
WHERE
  p.hrm_person_id = c.hrm_employee_id and
  c.hrm_constants_id = e.hrm_control_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_INPUT_ELEMENTS" ("ELEM_CONST_ID", "CONST_TYPE", "GROUP_ORDER", "CODE", "DESCR", "LANID", "ACTIVE", "STATCODE", "SIGN") AS
  SELECT
  f.hrm_elements_id,
  decode(f.hrm_elements_prefixes_id, 'CONEM', r.c_hrm_sal_const_type, null),
  decode(f.hrm_elements_prefixes_id,
             'CONEM', '1.'||r.c_hrm_sal_const_type,
             'EM', '0.0', '2.0'),
  r.elr_root_name,
  rd.erd_descr,
  rd.pc_lang_id,
  r.elr_is_active,
  r.elr_root_code,
  r.elr_sign
FROM
  hrm_elements_root_descr rd,
  hrm_elements_root r,
  hrm_elements_family f
WHERE
  rd.hrm_elements_root_id = f.hrm_elements_root_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_prefixes_id in ('EM', 'CONEM', 'GM', 'GT')
  and r.elr_is_active = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_JOB_DESCR" ("HRM_JOB_ID", "JOB_CODE", "JOB_TITLE", "JOB_DESCR") AS
  SELECT
  hrm_job_id,
  job_code,
  job_title,
  job_descr
FROM
  hrm_job


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_LAA" ("EMPID", "MATRICULE", "SEX", "EMPNAME", "DATEIN", "DATEOUT", "ELEMCODE", "HISVAL", "HISVALTXT", "HISPERIOD", "HISPERIODYYYY", "CODELAA", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "LISTID", "COE_BOX", "IS_RETRO") AS
  select
  H.HRM_EMPLOYEE_ID EMPID,
  P.EMP_NUMBER MATRICULE,
  P.PER_GENDER SEX,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME EMPNAME,
  I.INO_IN DATEIN,
  I.INO_OUT DATEOUT,
  C.COE_CODE ELEMCODE,
  HD.HIS_PAY_SUM_VAL HISVAL,
  HD.HIS_PAY_VALUE HISVALTXT,
  H.HIT_PAY_PERIOD HISPERIOD,
  to_char(H.HIT_PAY_PERIOD,'YYYY') HISPERIODYYYY,
  hrm_laa_code(H.HRM_EMPLOYEE_ID, H.HIT_PAY_NUM) CODELAA,
  P.PER_SEARCH_NAME SEARCHNAME,
  Upper(P.PER_LAST_NAME||' '||P.PER_FIRST_NAME) UPPERNAME,
  P.PER_SEARCH_NAME||to_char(P.HRM_PERSON_ID) EMPGROUP,
  C.HRM_CONTROL_LIST_ID LISTID,
  C.COE_BOX,
  S.SAL_IS_RETRO
from
  HRM_SALARY_SHEET S,
  HRM_IN_OUT I,
  HRM_HISTORY_DETAIL HD,
  HRM_HISTORY H,
  HRM_PERSON P,
  HRM_CONTROL_ELEMENTS C
where
  S.HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
  HD.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
  HD.HIS_PAY_NUM = H.HIT_PAY_NUM and
  HD.HRM_ELEMENTS_ID = C.HRM_CONTROL_ELEMENTS_ID and
  P.HRM_PERSON_ID = H.HRM_EMPLOYEE_ID and
  I.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
  I.C_IN_OUT_CATEGORY = '3' and
  H.HIT_PAY_PERIOD between I.INO_IN and hrm_date.nextInOutInDate(I.INO_OUT, I.HRM_EMPLOYEE_ID) and
  H.HIT_DEFINITIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_LAA_CODE" ("EMPID", "PAYNUM", "CODELAA") AS
  SELECT
  a.hrm_employee_id,
  his_pay_num,
  his_pay_value
FROM
  hrm_history_detail a,
  hrm_constants b
WHERE
  b.con_code = 'ConEmLAA' and
  a.hrm_elements_id = b.hrm_constants_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_LAST_DEF_PAY_NUM" ("EMPID", "PAYNUM") AS
  SELECT
  hrm_employee_id,
  max(hit_pay_num)
FROM
  hrm_history
WHERE
  hit_definitive = 1
GROUP BY
  hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_LAST_ENTRY" ("EMPID", "ENTRY", "EXIT", "INO_IN_LPP", "INO_OUT_LPP") AS
  select
  P.HRM_PERSON_ID,
  IO.INO_IN,
  IO.INO_OUT,
  IO.INO_IN_LPP,
  IO.INO_OUT_LPP
from
  HRM_IN_OUT IO,
  HRM_PERSON P,
  (select HRM_EMPLOYEE_ID, Max(INO_IN) LAST_ENTRY
   from HRM_IN_OUT
   where C_IN_OUT_CATEGORY = '3'
   group by HRM_EMPLOYEE_ID) B
where
  P.HRM_PERSON_ID = B.HRM_EMPLOYEE_ID and
  P.PER_IS_EMPLOYEE = 1 and
  IO.HRM_EMPLOYEE_ID = B.HRM_EMPLOYEE_ID and
  IO.INO_IN = B.LAST_ENTRY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_LAST_PAY_NUM" ("EMPID", "LASTPAYNUM") AS
  SELECT
  p.hrm_person_id,
  nvl(p.emp_last_pay_num,0)
FROM
  hrm_person p


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_LPP" ("ELEMCODE", "BOX", "LISTID", "EMPID", "NOAVS", "EMPNAME", "VALUE", "HISPERIODYYYYMM", "CODE", "ENTRY", "EXIT", "SEARCHNAME", "UPPERNAME", "EMPGROUP") AS
  SELECT
  c.coe_code,
  c.coe_box,
  to_char(c.hrm_control_list_id),
  p.hrm_person_id empid,
  nvl(p.emp_social_securityno2, p.emp_social_securityno) noavs,
  p.per_last_name||' '||p.per_first_name empname,
  decode(c.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val*-1) value,
  to_char(h.his_pay_period,'yyyymm') hisperiodyyyymm,
  c.coe_code,
  i.entry entry,
  i.exit exit,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name),
  p.per_search_name||to_number(p.hrm_person_id)
FROM
  v_hrm_last_entry i,
  hrm_person p,
  hrm_history_detail h,
  hrm_control_elements c
WHERE
  i.empid = p.hrm_person_id AND
  p.hrm_person_id = h.hrm_employee_id AND
  h.his_definitive = 1 AND
  h.hrm_elements_id = c.hrm_control_elements_id AND
  c.hrm_control_list_id = (SELECT hrm_control_list_id
                           FROM hrm_control_list WHERE c_control_list_type = '006')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAYROLL" ("IS_ELEMENT", "ELEM_CONST_ID", "ELE_CODE", "ELE_IS_SQL", "ELE_SQL", "HRM_CODE_DIC_ID", "ELE_EXPRESSION", "FORMAT", "PRECISION", "ROUND", "ELE_VALID_FROM", "ELE_VALID_TO", "ELE_VARIABLE", "ELE_ACTIVE", "CON_MANDATORY", "ELE_CORRELATED_ID", "ELE_REPORTING", "ELE_MULTI_CURRENCY", "ACS_FINANCIAL_CURRENY_ID", "C_HRM_SAL_CONST_TYPE", "ELE_STAT_CODE", "ELE_SIGN", "DIC_GROUP1_ID", "DIC_GROUP2_ID", "DIC_GROUP3_ID", "DIC_GROUP4_ID", "ELE_TYPE", "ELE_IS_INDIV", "ELE_INPUT_MODE", "ELE_BREAK_INPUT_MODE", "ELE_USE_RATIO_GROUP", "ELE_IS_BREAK", "ELE_IS_BASE") AS
  SELECT
  1,
  a.hrm_elements_id,
  a.ele_code,
  a.ele_is_sql,
  a.ele_sql,
  0,
  a.ele_expression,
  a.ele_format,
  a.ele_precision,
  a.ele_round,
  a.ele_valid_from,
  a.ele_valid_to,
  a.ele_variable,
  a.ele_active,
  0,
  a.ele_correlated_id,
  a.ele_reporting,
  a.ele_multi_currency,
  a.acs_financial_currency_id,
  '',
  a.ele_stat_code,
  a.ele_sign,
  a.Dic_group1_id,
  a.Dic_group2_id,
  a.Dic_group3_id,
  a.Dic_group4_id,
  a.ele_type,
  a.ele_Is_Indiv,
  a.ele_input_Mode,
  a.ele_Break_Input_Mode,
  a.ele_Use_Ratio_Group,
  a.ele_Is_Break,
  a.ele_is_base
FROM
  hrm_elements a
UNION ALL
SELECT
  0,
  a.hrm_constants_id,
  a.con_code,
  0,
  '',
  a.hrm_code_dic_id,
  to_clob(a.con_expression),
  a.con_format,
  a.con_precision,
  a.con_round,
  a.con_from,
  a.con_to,
  0,
  a.con_active,
  a.con_mandatory,
  a.con_correlated_id,
  a.con_reporting,
  a.con_multi_currency,
  a.acs_financial_currency_id,
  a.c_hrm_sal_const_type,
  a.con_stat_code,
  a.con_sign,
  a.Dic_group1_id,
  a.Dic_group2_id,
  a.Dic_group3_id,
  a.Dic_group4_id,
  a.con_type,
  a.con_Is_Indiv,
  null,
  null,
  null,
  0,
  0
FROM
  hrm_constants a


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAYROLL_CALC" ("ELEM_CONST_ID", "ELE_CODE", "ELE_IS_DLL", "ELE_IS_SUM", "ELE_IS_COMPCONST", "ELE_IS_SQL", "ELE_SQL", "ELE_EXPRESSION", "ELE_DEFAULT_VALUE", "ELE_STAT_CODE", "ELE_FORMAT", "ELE_VALID_FROM", "ELE_VALID_TO", "ELE_VARIABLE", "ELE_CONST", "ELE_ACTIVE", "ELE_IS_BREAK", "ELE_IS_BUDGETED", "ELE_IS_CALCULATED") AS
  select
  F.HRM_ELEMENTS_ID,
  D.ELE_CODE,
  case when F.ELF_SQL is not null then 1 else 0 end ELE_IS_DLL,
  case F.HRM_ELEMENTS_PREFIXES_ID when 'CUMCEM' then 1 else 0 end ELE_IS_SUM,
  case F.HRM_ELEMENTS_PREFIXES_ID when 'GM' then 1 when 'GT' then 1 else 0 end ELE_IS_COMPCONST,
  0 ELE_IS_SQL,
  F.ELF_SQL,
  F.ELF_EXPRESSION,
  D.ELE_DEFAULT_VALUE,
  D.ELE_STAT_CODE,
  D.ELE_FORMAT,
  D.ELE_VALID_FROM,
  D.ELE_VALID_TO,
  D.ELE_VARIABLE,
  D.ELE_CONST,
  D.ELE_ACTIVE,
  D.ELE_IS_BREAK,
  R.ELR_IS_BUDGETED,
  case when (F.ELF_IS_REFERENCE = 1 and R.C_ROOT_TYPE = 'Calculated') or HRM_ELEMENTS_PREFIXES_ID = 'CEM' then 1 else 0 end ELE_IS_CALCULATED
from
  (select
     HRM_ELEMENTS_ID,
     ELE_CODE,
     ELE_DEFAULT_VALUE,
     ELE_STAT_CODE,
     ELE_FORMAT,
     ELE_VALID_FROM,
     ELE_VALID_TO,
     ELE_VARIABLE,
     0 ELE_CONST,
     ELE_ACTIVE,
     ELE_IS_BREAK
   from
     HRM_ELEMENTS
   union all
   select
     HRM_CONSTANTS_ID HRM_ELEMENTS_ID,
     CON_CODE,
     CON_DEFAULT_VALUE,
     CON_STAT_CODE,
     CON_FORMAT,
     CON_FROM,
     CON_TO,
     0 ELE_VARIABLE,
     1 ELE_CONST,
     CON_ACTIVE,
     0 ELE_IS_BREAK
   from
     HRM_CONSTANTS
  ) D,
  HRM_ELEMENTS_ROOT R,
  HRM_ELEMENTS_FAMILY F
where
  R.HRM_ELEMENTS_ROOT_ID = F.HRM_ELEMENTS_ROOT_ID and
  D.HRM_ELEMENTS_ID = F.HRM_ELEMENTS_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAYROLL_DESCR" ("IS_ELEMENT", "ELEM_CONST_ID", "PC_LANG_ID", "ELE_DESCR", "ELE_SUBST_CODE", "ELE_COMMENT") AS
  SELECT
  decode(p.elp_is_const, 0, 1, 0) IS_ELEMENT,
  f.hrm_elements_id ELEM_CONST_ID,
  d.pc_lang_id,
  d.erd_descr ELE_DESCR,
  d.erd_subst_code ELE_SUBST_CODE,
  d.erd_comment ELE_COMMENT
FROM
  hrm_elements_prefixes p,
  hrm_elements_root_descr d,
  hrm_elements_family f
WHERE
  d.hrm_elements_root_id = f.hrm_elements_root_id and
  p.hrm_elements_prefixes_id = f.hrm_elements_prefixes_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_ALL1" ("HRM_EMPLOYEE_ID", "INO_IN", "INO_OUT", "ID", "FPAY") AS
  select
  H.HRM_EMPLOYEE_ID,
  Min(I.INO_IN) INO_IN,
  Min(I.INO_OUT) INO_OUT,
  I.HRM_IN_OUT_ID ID,
  Min(H.HIT_PAY_NUM) FPAY
from
  HRM_HISTORY H,
  HRM_IN_OUT I
where
  I.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
  I.C_IN_OUT_CATEGORY = '3' and
  H.HIT_PAY_PERIOD > I.INO_IN
GROUP BY
  H.HRM_EMPLOYEE_ID,
  I.HRM_IN_OUT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_ALL2" ("EMPID", "FPAY", "LPAY") AS
  select
  H.HRM_EMPLOYEE_ID EMPID,
  Min(H.HIT_PAY_NUM) FPAY,
  Max(H.HIT_PAY_NUM) LPAY
from
  HRM_HISTORY H,
  HRM_IN_OUT I
where
  I.HRM_EMPLOYEE_ID(+) = H.HRM_EMPLOYEE_ID and
  I.C_IN_OUT_CATEGORY(+) = '3' and
  H.HIT_PAY_PERIOD <= I.INO_IN(+)
group by
  H.HRM_EMPLOYEE_ID,
  I.HRM_IN_OUT_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_ALLOTMENT" ("HRM_EMPLOYEE_ID", "INO_IN", "INO_OUT", "FIRSTPAY", "LASTPAY") AS
  SELECT
  H.HRM_EMPLOYEE_ID,
  I.INO_IN,
  I.INO_OUT,
  Min(H.HIT_PAY_NUM),
  Max(H.HIT_PAY_NUM)
from
  HRM_HISTORY H,
  HRM_IN_OUT I
where
  I.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID and
  I.C_IN_OUT_CATEGORY(+) = '3' and
  H.HIT_PAY_PERIOD between I.INO_IN and hrm_date.NextInOutInDate(I.INO_OUT, I.HRM_EMPLOYEE_ID)
group by
  H.HRM_EMPLOYEE_ID,
  I.INO_IN,
  I.INO_OUT


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_LIST" ("NAME", "EMP_NUMBER", "HRM_EMPLOYEE_ID", "PAY_NUM", "EMP_STATUS", "HRM_PERIOD_ID", "PAY_PERIOD", "DPO_DESCR", "SEX", "D_TOPAY", "D_BYEAR", "ND_TOPAY", "ND_BYEAR", "ADR1", "ADR2", "ADR3", "CITY1", "CITY2") AS
  select
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.EMP_NUMBER,
  V.EMPID,
  Nvl(P.EMP_LAST_PAY_NUM+1, 0),
  P.EMP_STATUS,
  hrm_date.ActivePeriodEndDate,
  hrm_date.ActivePeriodEndDate,
  P.PER_TITLE,
  Decode(P.PER_GENDER, 'M', 1, 0),
  hrm_date.days_SinceBPeriod(v.empid, hrm_date.ActivePeriod),
  hrm_date.days_SinceBYear(v.empid, hrm_date.ActivePeriod),
  hrm_date.Ndays_SinceBPeriod(v.empid, hrm_date.ActivePeriod),
  hrm_date.Ndays_SinceBYear(v.empid, hrm_date.ActivePeriod),
  -- address ie street
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else P.PER_TAXSTREET
    end
  ) ADR1,
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else P.PER_TAXSTREET
    end,
    2) ADR2,
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else PER_TAXSTREET
    end,
    3) ADR3,
  -- postalcode, should have country code, and city
  case
    when P.PER_TAXPOSTALCODE is null then
      case per_mail_add_selector
        when 0 then P.PER_BUSINESSPOSTALCODE||' '||P.PER_BUSINESSCITY
        when 1 then P.PER_HOMEPOSTALCODE||' '||P.PER_HOMECITY
        when 2 then P.PER_OTHERPOSTALCODE||' '||P.PER_OTHERCITY
      end
    else P.PER_TAXPOSTALCODE||' '||P.PER_TAXCITY
  end CITY1,
  '' CITY2
from
  HRM_PERSON P,
  V_HRM_EMPTOPAY_NUM V
where
  P.HRM_PERSON_ID = V.EMPID and
  P.EMP_STATUS in ('ACT','SUS')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_LIST2" ("NAME", "EMP_NUMBER", "PAY_PERIOD", "HRM_EMPLOYEE_ID", "HRM_SALARY_SHEET_ID", "STATUS", "PAY_NUM", "PAY_PERIOD_NUM", "PAY_YEAR", "ACCOUNTED", "REVERSAL", "REVERSED", "PAID", "IS_PDF_GENERATED") AS
  select
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME NAME,
  P.EMP_NUMBER,
  H.HIT_PAY_PERIOD PAY_PERIOD,
  H.HRM_EMPLOYEE_ID,
  H.HRM_SALARY_SHEET_ID,
  H.HIT_DEFINITIVE STATUS,
  H.HIT_PAY_NUM PAY_NUM,
  to_number(to_char(H.HIT_PAY_PERIOD, 'MM')) PAY_PERIOD_NUM,
  to_number(to_char(H.HIT_PAY_PERIOD, 'YYYY')) PAY_YEAR,
  H.HIT_ACCOUNTED ACCOUNTED,
  H.HIT_REVERSAL REVERSAL,
  H.HIT_REVERSED REVERSED,
  hrm_var.IsPaid(H.HRM_EMPLOYEE_ID, H.HRM_SALARY_SHEET_ID, H.HIT_PAY_NUM) PAID,
  hrm_var.IsPdfExported(H.HRM_EMPLOYEE_ID, H.HIT_PAY_NUM) IS_PDF_GENERATED
from
  HRM_PERSON P,
  HRM_HISTORY H
where
  H.HRM_SALARY_SHEET_ID = hrm_var.get_PaySelected and
  P.HRM_PERSON_ID = H.HRM_EMPLOYEE_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_LOG" ("EMP_NUMBER", "PAY_NAME", "PAY_ADDRESS", "PAY_CITY", "PAY_ACC_NUM", "PAY_AMOUNT", "PAY_AMOUNT_EURO", "C_FINANCIAL_REF_TYPE", "PAY_PERIOD", "BAN_NAME1", "BAN_ADR", "BAN_GUICH", "BAN_ETAB", "BAN_CLEAR", "BAN_SWIFT", "PAY_SELECTED", "HRM_EMPLOYEE_ID", "HRM_PAY_DOC_ID", "HRM_SALARY_SHEET_ID", "PC_BANK_ID", "PAY_SALARY_SHEET_NUM", "PAY_DONE", "PAY_MODE", "ACS_FINANCIAL_CURRENCY_ID", "DEFINITIVE", "CURRENCY", "PAY_COMMENT", "PC_CNTRY_ID") AS
  SELECT
  p.emp_number,
  pl.pay_name,
  pl.pay_address,
  pl.Pay_City,
  pl.pay_acc_num,
  pl.pay_amount,
  pl.pay_amount_euro,
  pl.pay_mode,
  pl.pay_Period,
  nvl2(pl.pc_bank_id, b.ban_name1, pl.pay_ban_name),
  nvl2(pl.pc_bank_id,
       case
        when b.ban_adr is not null then b.ban_adr||' / '
       end || b.ban_zip||' '||b.ban_city,
       pl.pay_ban_city),
  pl.pay_ban_guich,
  pl.pay_ban_etab,
  b.ban_clear,
  pl.pay_swift,
  pl.pay_selected,
  p.hrm_person_id,
  pl.hrm_pay_doc_id,
  pl.hrm_salary_sheet_id,
  pl.pc_bank_id,
  pl.pay_salary_sheet_num,
  pl.pay_done,
  pl.Pay_Mode,
  pl.acs_financial_currency_id,
  pl.Pay_Definitive,
  curr.currency,
  pl.pay_comment,
  pl.pc_cntry_id
FROM
  pcs.pc_curr curr,
  acs_financial_currency FinCurr,
  pcs.pc_bank b,
  hrm_pay_log pl,
  hrm_person p
WHERE
  pl.hrm_employee_id = p.hrm_person_id and
  b.pc_bank_id(+) = pl.pc_bank_id and
  FinCurr.acs_financial_currency_id = pl.acs_financial_currency_id and
  curr.pc_curr_id = FinCurr.pc_curr_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_AC" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('RECAP BAS AC','RECAP EXO AC','RECAP SA AC','RECAP BAS ACC','RECAP EXO ACC','RECAP SA ACC')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_AC_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('RECAP BAS AC','RECAP EXO AC','RECAP SA AC','RECAP BAS ACC','RECAP EXO ACC','RECAP SA ACC')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_AC_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('RECAP BAS AC','RECAP EXO AC','RECAP SA AC','RECAP BAS ACC','RECAP EXO ACC','RECAP SA ACC')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_AVS" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('RECAP BAS AVS','RECAP EXO AVS','RECAP SA AVS')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_AVS_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('RECAP BAS AVS','RECAP EXO AVS','RECAP SA AVS')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_AVS_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('RECAP BAS AVS','RECAP EXO AVS','RECAP SA AVS')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SABRUT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SABRUT_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SABRUT_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SABRUT_PM" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT+-') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SABRUT_PM_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT+-') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SABRUT_PM_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT+-') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SADED" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SADED') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SADED_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SADED') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SADED_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SADED') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAHORS" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  -h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAHORSCOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAHORS_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*decode(h.hrm_elements_id, 10, his_pay_sum_val, -his_pay_sum_val),
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAHORSCOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAHORS_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  -h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAHORSCOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAPAYE" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAPAYE','SAPAYECOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAPAYE_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAPAYE','SAPAYECOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAPAYE_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAPAYE','SAPAYECOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAPROV" ("HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAPROV','SAPROVBRUT','SAPROVCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAPROV_DEPT" ("HRM_ELEMENTS_ID", "ELE_DESCR", "DEPT", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  d.erd_descr,
  b.heb_department_id,
  b.rate*h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAPROV','SAPROVBRUT','SAPROVCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_SAPROV_EMP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "ELE_DESCR", "HIS_PAY_SUM_VAL", "HIS_PAY_PERIOD", "ELE_TYPE", "ELE_STAT_CODE", "DIC_GROUP2_ID", "YEAR", "LANGID") AS
  SELECT
  h.hrm_employee_id,
  f.hrm_elements_id,
  d.erd_descr,
  h.his_pay_sum_val,
  h.his_pay_period,
  r.elr_type,
  r.elr_root_code,
  r.dic_group2_id,
  to_char(h.his_pay_period,'YYYY'),
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SAPROV','SAPROVBRUT','SAPROVCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_TOTAUX" ("SUM_TOT_EMPLOYEE", "SUM_TOT_NET", "SUM_TOT_EMPLOYEUR", "HIT_PAY_PERIOD", "YEAR", "MONTH") AS
  SELECT
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employee,
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_net,
  sum(decode(elr_type,2,-his_pay_sum_val,3,-his_pay_sum_val,0)) sum_tot_employeur,
  his_pay_period,
  to_char(his_pay_period,'yyyy') year,
  to_char(his_pay_period,'mm') month
FROM
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT','SADED','SAPROVCOMPTA','SAHORSCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0
GROUP BY
  his_pay_period




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_TOTAUX_CUM" ("SUM_TOT_EMPLOYEE", "SUM_TOT_NET", "SUM_TOT_EMPLOYEUR", "YEAR") AS
  SELECT
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employee,
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_net,
  sum(decode(elr_type,2,-his_pay_sum_val,3,-his_pay_sum_val,0)) sum_tot_employeur,
  to_char(his_pay_period,'yyyy') year
FROM
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT','SADED','SAPROVCOMPTA','SAHORSCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0
GROUP BY
  to_char(his_pay_period, 'yyyy')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_TOTAUX_DEPT" ("SUM_TOT_EMPLOYEE", "SUM_TOT_NET", "SUM_TOT_EMPLOYEUR", "HIT_PAY_PERIOD", "YEAR", "MONTH", "DEPT", "DPT_DESCR", "LANGID") AS
  SELECT
  sum(b.rate*decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employee,
  sum(b.rate*decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_net,
  sum(b.rate*decode(elr_type,2,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employeur,
  his_pay_period,
  to_char(his_pay_period,'yyyy') year,
  to_char(his_pay_period,'mm') month,
  b.heb_department_id,
  nvl(d.dit_descr, heb_department_id),
  d.pc_lang_id
FROM
  dico_description d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.dit_table (+) = 'DIC_DEPARTMENT' AND
  d.dit_code (+) = b.heb_department_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT','SADED','SAPROVCOMPTA','SAHORSCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0
GROUP BY
  h.his_pay_period,
  b.heb_department_id,
  d.dit_descr,
  d.pc_lang_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_TOTAUX_DEPTCUM" ("SUM_TOT_EMPLOYEE", "SUM_TOT_NET", "SUM_TOT_EMPLOYEUR", "YEAR", "DEPT", "DPT_DESCR", "LANGID") AS
  SELECT
  sum(b.rate*decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employee,
  sum(b.rate*decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_net,
  sum(b.rate*decode(elr_type,2,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employeur,
  to_char(his_pay_period,'yyyy') year,
  b.heb_department_id,
  nvl(d.dit_descr, heb_department_id),
  d.pc_lang_id
FROM
  dico_description d,
  v_hrm_employee_break b,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.dit_table (+) = 'DIC_DEPARTMENT' AND
  d.dit_code (+) = b.heb_department_id AND
  b.hrm_employee_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT','SADED','SAPROVCOMPTA','SAHORSCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0
GROUP BY
  to_char(his_pay_period,'yyyy'),
  b.heb_department_id,
  d.dit_descr,
  d.pc_lang_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_TOTAUX_EMP" ("HRM_EMPLOYEE_ID", "PER_LAST_NAME", "PER_FULLNAME", "SUM_TOT_EMPLOYEE", "SUM_TOT_NET", "SUM_TOT_EMPLOYEUR", "HIT_PAY_PERIOD", "YEAR", "MONTH", "SEARCHNAME", "UPPERNAME") AS
  SELECT
  h.hrm_employee_id,
  p.per_last_name,
  p.per_fullname,
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employee,
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_net,
  sum(decode(elr_type,2,-his_pay_sum_val,3,-his_pay_sum_val,0)) sum_tot_employeur,
  his_pay_period,
  to_char(his_pay_period,'yyyy') year,
  to_char(his_pay_period,'mm') month,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name)
FROM
  hrm_person p,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  p.hrm_person_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT','SADED','SAPROVCOMPTA','SAHORSCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0
GROUP BY
  h.hrm_employee_id,
  p.per_last_name,
  p.per_first_name,
  p.per_fullname,
  p.per_search_name,
  h.his_pay_period




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PAY_RECAP_TOTAUX_EMPCUM" ("HRM_EMPLOYEE_ID", "PER_LAST_NAME", "PER_FULLNAME", "SUM_TOT_EMPLOYEE", "SUM_TOT_NET", "SUM_TOT_EMPLOYEUR", "YEAR", "SEARCHNAME") AS
  SELECT
  h.hrm_employee_id,
  p.per_last_name,
  p.per_fullname,
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_employee,
  sum(decode(elr_type,1,his_pay_sum_val,3,his_pay_sum_val,0)) sum_tot_net,
  sum(decode(elr_type,2,-his_pay_sum_val,3,-his_pay_sum_val,0)) sum_tot_employeur,
  to_char(his_pay_period,'yyyy') year,
  p.per_search_name
FROM
  hrm_person p,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  p.hrm_person_id = h.hrm_employee_id AND
  h.hrm_elements_id = f.hrm_elements_id AND
  f.elf_is_reference = 1 AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.dic_group2_id in ('SABRUT','SAPROVBRUT','SADED','SAPROVCOMPTA','SAHORSCOMPTA','SAPROVBRUTCOMPTA') AND
  r.elr_type > 0
GROUP BY
  h.hrm_employee_id,
  p.per_last_name,
  p.per_fullname,
  p.per_search_name,
  to_char(his_pay_period,'yyyy')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PERSON" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_TITLE", "PER_FIRST_NAME", "PER_LAST_NAME", "PER_INITIALS", "PER_GENDER", "PER_BIRTH_DATE", "PER_COMMENT", "PER_ASSISTANT_PHONE", "PER_BUSINESS_PHONE", "PER_BUSINESS2_PHONE", "PER_HOME_PHONE", "PER_HOME2_PHONE", "PER_MOBILE_PHONE", "PER_OTHER_PHONE", "PER_FAX_PHONE", "PER_FAX2_PHONE", "PER_PHONE_SELECTOR", "PER_EMAIL", "PER_EMAIL2", "PER_EMAIL3", "PER_EMAIL_SELECTOR", "PER_BUSINESSSTREET", "PER_BUSINESSCITY", "PER_BUSINESSSTATE", "PER_BUSINESSPOSTALCODE", "PER_BUSINESSCOUNTRY", "PER_HOMESTREET", "PER_HOMECITY", "PER_HOMESTATE", "PER_HOMEPOSTALCODE", "PER_HOMECOUNTRY", "PER_OTHERSTREET", "PER_OTHERCITY", "PER_OTHERSTATE", "PER_OTHERPOSTALCODE", "PER_OTHERCOUNTRY", "PER_ADDRESS_SELECTOR", "PER_ADDRESS_SELECTED", "PER_MAIL_ADD_SELECTOR", "PER_MAIL_ADD_SELECTED", "PER_WEB_PAGE", "PER_IS_EMPLOYEE", "EMP_NUMBER", "EMP_SECONDARY_KEY", "EMP_SOCIAL_SECURITYNO", "EMP_LAST_INTERVIEW", "EMP_WORKINGAREA", "EMP_NATIVE_OF", "EMP_BIRTH_COUNTRY", "EMP_BIRTH_PLACE", "EMP_CALCULATION", "EMP_CHILD_NB", "DIC_NATIONALITY_ID", "DIC_NATIONALITY2_ID", "DIC_WORKPLACE_ID", "DIC_DEPARTMENT_ID", "C_CIVIL_STATUS", "EMP_STATUS", "COM_BITMAP_ID", "PC_LANG_ID", "LANGUAGE", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS") AS
  SELECT
  a.HRM_PERSON_ID, a.PER_FULLNAME, a.PER_TITLE, a.PER_FIRST_NAME, a.PER_LAST_NAME,
  a.PER_INITIALS, a.PER_GENDER, a.PER_BIRTH_DATE, null PER_COMMENT, a.PER_ASSISTANT_PHONE, a.PER_BUSINESS_PHONE,
  a.PER_BUSINESS2_PHONE, a.PER_HOME_PHONE, a.PER_HOME2_PHONE, a.PER_MOBILE_PHONE, a.PER_OTHER_PHONE,
  a.PER_FAX_PHONE, a.PER_FAX2_PHONE, a.PER_PHONE_SELECTOR,
  a.PER_EMAIL, a.PER_EMAIL2, a.PER_EMAIL3, a.PER_EMAIL_SELECTOR, a.PER_BUSINESSSTREET, a.PER_BUSINESSCITY,
  a.PER_BUSINESSSTATE, a.PER_BUSINESSPOSTALCODE, a.PER_BUSINESSCOUNTRY, a.PER_HOMESTREET, a.PER_HOMECITY,
  a.PER_HOMESTATE, a.PER_HOMEPOSTALCODE, a.PER_HOMECOUNTRY, a.PER_OTHERSTREET, a.PER_OTHERCITY, a.PER_OTHERSTATE,
  a.PER_OTHERPOSTALCODE, a.PER_OTHERCOUNTRY, a.PER_ADDRESS_SELECTOR, a.PER_ADDRESS_SELECTED,
  a.PER_MAIL_ADD_SELECTOR, a.PER_MAIL_ADD_SELECTED,
  a.PER_WEB_PAGE, a.PER_IS_EMPLOYEE, a.EMP_NUMBER, a.EMP_SECONDARY_KEY, a.EMP_SOCIAL_SECURITYNO,
  a.EMP_LAST_INTERVIEW, a.EMP_WORKINGAREA, a.EMP_NATIVE_OF, a.Emp_BIRTH_COUNTRY, a.EMP_BIRTH_PLACE,
  a.EMP_CALCULATION, a.EMP_CHILD_NB, a.DIC_NATIONALITY_ID, a.DIC_NATIONALITY2_ID, a.DIC_WORKPLACE_ID,
  a.DIC_DEPARTMENT_ID, a.C_CIVIL_STATUS, a.EMP_STATUS, a.COM_BITMAP_ID, a.PC_LANG_ID, b.lanid LANGUAGE,
  a.A_DATECRE, a.A_DATEMOD, a.A_IDCRE, a.A_IDMOD,
  a.A_RECLEVEL, a.A_RECSTATUS
FROM
  HRM_PERSON a,
  pcs.PC_lang b
WHERE
  a.pc_lang_id = b.pc_lang_id(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PERSON_XML" ("PERSON_ID", "TAGLEVEL", "NODELEVEL", "ID", "PARENT_ID", "TAG", "VALUE", "TYPE") AS
  SELECT
  hrm_person_id person_id,
  LPAD(' ',2*(LEVEL-1))||xml_tag Taglevel,
  level nodeLevel,
  xml_seq_id id,
  xml_parent_id parent_id,
  xml_tag tag,
  xml_value value,
  xml_type type
FROM
  hrm_person_xml
START WITH
  xml_parent_id is null
CONNECT BY
  PRIOR hrm_person_id = hrm_person_id AND PRIOR xml_seq_id = xml_parent_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PERSON_XML_WITHVALUES" ("PERSON_ID", "TAGLEVEL", "VALUE", "HASCHILDREN") AS
  SELECT
  HRM_PERSON_ID,
  LPAD(' ',2*(LEVEL-1))||xml_tag Taglevel,
  xml_value value,
  hrm_xml.hasChildrenWithValues(hrm_person_id, xml_seq_id) hasChildren
FROM
  hrm_person_xml
WHERE
  hrm_xml.hasChildrenWithValues(hrm_person_id, xml_seq_id) = 1
START WITH
  hrm_person_id = HRM_PERSON_id and xml_seq_id = 1
CONNECT BY
  PRIOR hrm_person_id=hrm_person_id AND prior xml_seq_id = xml_parent_id
  AND hrm_xml.hasChildrenWithValues(hrm_person_id, xml_seq_id) = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PF_ACCOUNT" ("ACS_PF_ACCOUNT_ID", "ACS_PF_NUMBER") AS
  SELECT
  b.acs_pf_account_id,
  a.acc_number
FROM
  acs_account a,
  acs_pf_account b
WHERE
  a.acs_account_id = b.acs_pf_account_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_PJ_ACCOUNT" ("ACS_PJ_ACCOUNT_ID", "ACS_PJ_NUMBER") AS
  SELECT
  b.acs_pj_account_id,
  a.acc_number
FROM
  acs_account a,
  acs_pj_account b
WHERE
  a.acs_account_id = b.acs_pj_account_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_ADDR_COMM_ALL" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_TITLE", "PER_FIRST_NAME", "PER_LAST_NAME", "PER_ASSISTANT_PHONE", "PER_BUSINESS_PHONE", "PER_BUSINESS2_PHONE", "PER_HOME_PHONE", "PER_HOME2_PHONE", "PER_MOBILE_PHONE", "PER_OTHER_PHONE", "PER_FAX_PHONE", "PER_FAX2_PHONE", "PER_PHONE_SELECTOR", "PER_EMAIL", "PER_EMAIL2", "PER_EMAIL3", "PER_EMAIL_SELECTOR", "PER_BUSINESSSTREET", "PER_BUSINESSCITY", "PER_BUSINESSSTATE", "PER_BUSINESSPOSTALCODE", "PER_BUSINESSCOUNTRY", "PER_HOMESTREET", "PER_HOMECITY", "PER_HOMESTATE", "PER_HOMEPOSTALCODE", "PER_HOMECOUNTRY", "PER_OTHERSTREET", "PER_OTHERCITY", "PER_OTHERSTATE", "PER_OTHERPOSTALCODE", "PER_OTHERCOUNTRY", "PER_TAXSTREET", "PER_TAXCITY", "PER_TAXSTATE", "PER_TAXPOSTALCODE", "PER_TAXCOUNTRY", "PER_ADDRESS_SELECTOR", "PER_ADDRESS_SELECTED", "PER_MAIL_ADD_SELECTOR", "PER_MAIL_ADD_SELECTED", "PER_WEB_PAGE", "PER_IS_CONTACT", "PER_IS_EMPLOYEE", "PER_IS_DEPENDENT", "PER_IS_CANDIDAT", "EMP_STATUS", "EMP_NUMBER", "EMPNAME", "SEARCHNAME", "UPPERNAME") AS
  SELECT
  a.hrm_person_id,
  a.per_fullname,
  a.per_title,
  a.per_first_name,
  a.per_last_name,
  a.per_assistant_phone,
  a.per_business_phone,
  a.per_business2_phone,
  a.per_home_phone,
  a.per_home2_phone,
  a.per_mobile_phone,
  a.per_other_phone,
  a.per_fax_phone,
  a.per_fax2_phone,
  a.per_phone_selector,
  a.per_email,
  a.per_email2,
  a.per_email3,
  a.per_email_selector,
  a.per_businessstreet,
  a.per_businesscity,
  a.per_businessstate,
  a.per_businesspostalcode,
  a.per_businesscountry,
  a.per_homestreet,
  a.per_homecity,
  a.per_homestate,
  a.per_homepostalcode,
  a.per_homecountry,
  a.per_otherstreet,
  a.per_othercity,
  a.per_otherstate,
  a.per_otherpostalcode,
  a.per_othercountry,
  a.per_taxstreet,
  a.per_taxcity,
  a.per_taxstate,
  a.per_taxpostalcode,
  a.per_taxcountry,
  a.per_address_selector,
  a.per_address_selected,
  a.per_mail_add_selector,
  a.per_mail_add_selected,
  a.per_web_page,
  a.per_is_contact,
  a.per_is_employee,
  a.per_is_dependent,
  a.per_is_candidat,
  a.emp_status,
  a.emp_number,
  a.per_last_name||' '||a.per_first_name,
  a.per_search_name,
  upper(a.per_last_name||' '||a.per_first_name)
FROM
  hrm_person a




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_ALLOCATION" ("ALL_CODE", "ALL_DESCR", "DIC_ACCOUNT_TYPE_ID", "ALD_ACC_NAME", "BRS_CODE", "ALD_RATE", "HRM_ALLOCATION_DETAIL_ID") AS
  SELECT
  a.ALL_CODE,
  a.ALL_DESCR,
  b.DIC_ACCOUNT_TYPE_ID,
  b.ALD_ACC_NAME,
  c.BRS_CODE,
  b.ALD_RATE,
  b.hrm_allocation_detail_id
FROM
  hrm_allocation a,
  hrm_allocation_detail b,
  hrm_break_shift c
WHERE
  a.hrm_allocation_id = b.hrm_allocation_id AND
  b.hrm_break_shift_id = c.hrm_break_shift_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_AN" ("CPN_NUMBER", "CPN_DESCR", "CDA_NUMBER", "CDA_DESCR", "PF_NUMBER", "PF_DESCR", "PJ_NUMBER", "PJ_DESCR", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "AMOUNT1", "AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SOURCE", "HRM_BREAK_ID", "CURRENCY", "ELE_CODE", "ELE_STATCODE", "ELE_DESCR", "ELE_GROUP", "PERNAME", "SEARCHNAME", "BRK_DESCRIPTION", "BRK_VALUE_DATE", "ELE_LANGID") AS
  SELECT
  cpn_number,
  decode(cpn_number, null, '',
      hrm_break_fct.get_account_descr(
          acs_function.getcpnaccountid(cpn_number), pc_lang_id)),
  cda_number,
  decode(cda_number, null, '',
      hrm_break_fct.get_account_descr(
          acs_function.getcdaaccountid(cda_number), pc_lang_id)),
  pf_number,
  decode(pf_number, null, '',
      hrm_break_fct.get_account_descr(
          acs_function.getpfaccountid(pf_number), pc_lang_id)),
  pj_number,
  decode(pj_number, null, '',
      hrm_break_fct.get_account_descr(
          acs_function.getpjaccountid(pj_number), pc_lang_id)),
  debit_amount,
  credit_amount,
  amount1,
  amount_type,
  acs_financial_currency_id,
  sab_pay_date,
  hrm_history_detail_id,
  source,
  hrm_break_id,
  currency,
  ele_code,
  ele_statcode,
  erd_descr,
  erd_descr||to_char(f.hrm_elements_id) ele_group,
  pername,
  searchname,
  brk_description,
  brk_value_date,
  pc_lang_id
from
  hrm_elements_root_descr d,
  hrm_elements_family f,
  v_hrm_break_an b
where
  d.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = b.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_CGDIV" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "ACS_CPN_ACCOUNT_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "ELE_GROUP", "ACC_DESCR", "PER_FULLNAME", "PER_LAST_NAME", "ACS_LANGID", "ELE_LANGID") AS
  SELECT
  hrm_history_detail_id,
  hrm_break_id,
  b.hrm_elements_id,
  v_hbc_acc_num,
  v_hbc_acc_name,
  v_hbc_div_num,
  v_hbc_div_name,
  v_hbc_amount,
  v_hbc_debit_amount,
  v_hbc_credit_amount,
  v_hbc_amount_type,
  sab_pay_date,
  sab_ref_value,
  sab_zl,
  currency,
  acs_cpn_account_id,
  rd.erd_descr,
  brk_description,
  b.ele_code,
  b.ele_stat_code,
  rd.erd_descr||to_char(f.hrm_elements_id) ele_group,
  ad.des_description_summary,
  per_last_name||' '||per_first_name as per_fullname,
  per_last_name,
  ad.pc_lang_id,
  rd.pc_lang_id
FROM
  acs_description ad,
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  hrm_person p,
  v_hrm_break_cgdiv b
WHERE
  ad.acs_account_id = b.acs_account_id AND
  rd.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = b.hrm_elements_id AND
  p.hrm_person_id = b.hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_CGDIV2" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "ACC_NUMBER", "V_HBC_DIV_NUM", "DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "ACS_CPN_ACCOUNT_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "ELE_GROUP", "ACC_DESCR", "PER_FULLNAME", "PER_LAST_NAME", "ELE_LANGID", "VALUE_DATE", "BREAK_DATE") AS
  SELECT
  hrm_history_detail_id,
  hrm_break_id,
  b.hrm_elements_id,
  v_hbc_acc_num,
  v_hbc_acc_name,
  v_hbc_div_num,
  v_hbc_div_name,
  v_hbc_amount,
  v_hbc_debit_amount,
  v_hbc_credit_amount,
  v_hbc_amount_type,
  sab_pay_date,
  sab_ref_value,
  sab_zl,
  currency,
  null acs_cpn_account_id,
  rd.erd_descr,
  brk_description,
  b.ele_code,
  b.ele_stat_code,
  rd.erd_descr||to_char(f.hrm_elements_id) ele_group,
  v_hbc_acc_name acc_descr,
  per_last_name||' '||per_first_name as per_fullname,
  per_last_name,
  rd.pc_lang_id,
  value_date,
  break_date
FROM
  hrm_person p,
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  v_hrm_break_cgdiv2 b
WHERE
  p.hrm_person_id=b.hrm_employee_id and
  rd.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = b.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_CG_DIV" ("DESCR", "ELEGROUP", "PER_FULLNAME", "SEARCHNAME", "EMPGROUP", "HRM_BREAK_ID", "HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "HDB_SOURCE", "HDB_AMOUNT_TYPE", "CG", "DIV", "HDB_AMOUNT", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "LANGID") AS
  SELECT
  d.erd_descr,
  d.erd_descr||to_char(f.hrm_elements_id) elegroup,
  p.per_last_name||' '||p.per_first_name per_fullname,
  p.per_search_name,
  p.per_search_name||to_char(p.hrm_person_id) empgroup,
  b.hrm_break_id,
  b.hrm_employee_id,
  b.hrm_elements_id,
  b.hdb_source,
  b.hdb_amount_type,
  b.cg,
  b.div,
  b.hdb_amount,
  b.debit_amount,
  b.credit_amount,
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_elements_family f,
  hrm_person p,
  v_hrm_break_cg_div b
WHERE
  d.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = b.hrm_elements_id AND
  p.hrm_person_id = b.hrm_employee_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_CTRL_IVS" ("HRM_BREAK_ID", "HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "HDB_SOURCE", "HDB_AMOUNT_TYPE", "CG", "DIV", "HDB_AMOUNT", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "PER_LASTNAME", "PER_FULLNAME", "ELE_DESCR", "BRK_DESCR") AS
  SELECT
  a.hrm_break_id,
  a.hrm_employee_id,
  a.hrm_elements_id,
  a.hdb_source,
  a.hdb_amount_type,
  a.hdb_account_name CG,
  b.hdb_account_name DIV,
  a.hdb_amount,
  decode(a.HDB_AMOUNT_TYPE,'D',a.HDB_AMOUNT,0) debit_amount,
  decode(a.HDB_AMOUNT_TYPE,'C',a.HDB_AMOUNT,0) credit_amount,
  PER_LAST_NAME,
  PER_FULLNAME,
  ELE_DESCR,
  BRK_DESCRIPTION
FROM
  hrm_break_detail a,
  hrm_break_detail b,
  hrm_elements c,
  hrm_elements_descr cc,
  hrm_person d,
  hrm_break e
WHERE
  a.hrm_break_id=e.hrm_break_id and
  cc.hrm_elements_id=c.hrm_elements_id and
  cc.pc_lang_id=1 and
  a.hrm_employee_id=d.hrm_person_id and
  a.hrm_elements_id=c.hrm_elements_id and
  a.hrm_break_id = b.hrm_break_id and
  a.hrm_history_detail_id = b.hrm_history_detail_id and
  a.hdb_source = b.hdb_source and
  a.hdb_amount_type=b.hdb_amount_type and
  c.DIC_GROUP4_ID in ('3','4','5') and
  a.DIC_ACCOUNT_TYPE_ID = 'CG' and
  b.DIC_ACCOUNT_TYPE_ID = 'DIV'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_ELEM_ALLOC" ("ALL_CODE", "ALL_DESCR", "BRE_ITEM_NAME", "ELE_DESCR", "ELE_STAT_CODE", "LANGID") AS
  SELECT
  a.all_code,
  a.all_descr,
  b.bre_item_name,
  rd.erd_descr,
  e.ele_stat_code,
  rd.pc_lang_id
FROM
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  hrm_elements e,
  hrm_break_structure b,
  hrm_allocation a
WHERE
  rd.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = e.hrm_elements_id AND
  e.hrm_elements_id = b.bre_item_id AND
  b.hrm_allocation_id = a.hrm_allocation_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_EMP_ELT" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "ACC_NUMBER", "CG_DESCR", "V_HBC_DIV_NUM", "DIV_NAME", "DIV_DESCR", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "EMPID", "EMPNAME", "SEARCHNAME", "EMPGROUP", "ELE_CODE", "ELE_STAT_CODE", "ELE_DESCR", "ELE_GROUP", "BRK_DESCRIPTION", "ELE_LANGID") AS
  SELECT
  b.hrm_history_detail_id,
  b.hrm_break_id,
  b.hrm_elements_id,
  b.v_hbc_acc_num,
  b.v_hbc_acc_name,
  hrm_break_fct.get_account_descr(b.v_hbc_acc_num, d.pc_lang_id),
  b.v_hbc_div_num,
  b.v_hbc_div_name,
  hrm_break_fct.get_account_descr(b.v_hbc_div_num, d.pc_lang_id),
  b.v_hbc_amount,
  b.v_hbc_debit_amount,
  b.v_hbc_credit_amount,
  b.v_hbc_amount_type,
  b.sab_pay_date,
  b.sab_ref_value,
  b.sab_zl,
  b.currency,
  b.hrm_employee_id,
  p.per_last_name||' '||p.per_first_name empname,
  p.per_search_name,
  p.per_search_name||to_char(p.hrm_person_id),
  b.ele_code,
  b.ele_stat_code,
  d.erd_descr,
  d.erd_descr||to_char(f.hrm_elements_id),
  b.brk_description,
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_elements_family f,
  hrm_person p,
  v_hrm_break_cgdiv2 b
WHERE
  d.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = b.hrm_elements_id and
  p.hrm_person_id = b.hrm_employee_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_SHIFTVAL" ("SHIFT", "SOURCE_FIELD", "IS_ACTIVE", "SOURCE_VALUE", "VALUE") AS
  SELECT
  a.bsv_code shift,
  a.bsv_source_field source_field,
  a.bsv_is_active is_active,
  a.bsv_source_val source_value,
  a.bsv_value value
FROM
  hrm_break_shift_val a




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_STRUCTURE" ("ELEMENTS", "COMPTECREDIT", "COMPTEDEBIT", "LANGID") AS
  SELECT
  rd.erd_descr||' ('||a.bre_item_name||')',
  ccg.ald_acc_name||decode(cdiv.ald_acc_name,'','','(DIV)')||decode(ccg.hrm_break_shift_id,0,'','','','  +['||cs.brs_code||']'),
  dcg.ald_acc_name||decode(ddiv.ald_acc_name,'','','(DIV)')||decode(dcg.hrm_break_shift_id,0,'','','','  +['||ds.brs_code||']'),
  rd.pc_lang_id
FROM
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  hrm_allocation_detail cdiv,
  hrm_allocation_detail ddiv,
  hrm_break_shift cs,
  hrm_allocation_detail ccg,
  hrm_break_shift ds,
  hrm_allocation_detail dcg,
  hrm_break_structure a
WHERE
  -- Elment
  rd.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = a.bre_item_id AND
  -- DIV Crdit
  cdiv.DIC_ACCOUNT_TYPE_ID(+) = 'DIV' AND
  cdiv.ald_rate(+) = -1 AND
  cdiv.hrm_allocation_id(+) = a.hrm_allocation_id AND
  -- DIV Dbit
  ddiv.DIC_ACCOUNT_TYPE_ID(+) = 'DIV' AND
  ddiv.ald_rate(+) = 1 AND
  ddiv.hrm_allocation_id(+) = a.hrm_allocation_id AND
  -- CG Crdit
  cs.hrm_break_shift_id(+) = ccg.hrm_break_shift_id AND
  ccg.DIC_ACCOUNT_TYPE_ID(+) = 'CG' AND
  ccg.ald_rate(+) = -1 AND
  ccg.hrm_allocation_id(+) = a.hrm_allocation_id AND
  -- CG Dbit
  ds.hrm_break_shift_id(+) = dcg.hrm_break_shift_id AND
  dcg.DIC_ACCOUNT_TYPE_ID(+) = 'CG' AND
  dcg.ald_rate(+) = 1 AND
  dcg.hrm_allocation_id(+) = a.hrm_allocation_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_BREAK_STRUCTURE2" ("DESCR", "ELE_CODE", "ELE_STAT_CODE", "LANGID", "ELE_SWAP_DC", "ELE_IS_BREAK_INVERSE", "ELE_USE_RATIO_GROUP", "ELE_IS_BREAK_DEBIT", "ELE_D_CGBASE", "ELE_D_IS_BREAK_DIV", "ELE_D_DIVBASE", "D_SHIFT", "ELE_IS_BREAK_CREDIT", "ELE_C_CGBASE", "ELE_C_IS_BREAK_DIV", "ELE_C_DIVBASE", "C_SHIFT", "DIC_GROUP2_ID", "DIC_GROUP3_ID", "DIC_GROUP1_ID", "DIC_GROUP4_ID") AS
  SELECT
  d.erd_descr descr,
  r.elr_root_name,
  r.elr_root_code,
  d.pc_lang_id langid,
  r.elr_swap_dc,
  r.elr_is_break_inverse,
  r.elr_use_ratio_group,
  r.elr_is_break_debit,
  r.elr_d_cgbase,
  r.elr_d_is_break_div,
  r.elr_d_divbase,
  sd.brs_code d_shift,
  r.elr_is_break_credit,
  r.elr_c_cgbase,
  r.elr_c_is_break_div,
  r.elr_c_divbase,
  sc.brs_code c_shift,
  r.dic_group2_id,
  r.dic_group3_id,
  r.dic_group1_id,
  r.dic_group4_id
FROM
  hrm_break_shift sd,
  hrm_break_shift sc,
  hrm_elements_root_descr d,
  hrm_elements_root r
WHERE
  sd.hrm_break_shift_id(+) = r.elr_d_cg_shift_id and
  sc.hrm_break_shift_id(+) = r.elr_c_cg_shift_id and
  d.hrm_elements_root_id = r.hrm_elements_root_id and
  r.elr_is_break = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CAMPAIGN_STAT" ("HRM_CAMPAIGN_ID", "JOB_ACTIVITY", "DAO_DESCR", "HRM_POSTULATION_ID", "IS_ACCEPTED") AS
  SELECT
  jo.HRM_CAMPAIGN_ID,
  j.DIC_JOB_ACTIVITY_ID,
  o.DAO_DESCR,
  pos.HRM_POSTULATION_ID,
  p.PER_IS_EMPLOYEE IS_ACCEPTED
FROM
  HRM_PERSON p,
  HRM_JOB j,
  HRM_APPLICATION_ORIGIN o,
  HRM_POSTULATION pos,
  HRM_JOB_OFFER jo
WHERE
  j.HRM_JOB_ID = jo.HRM_JOB_ID AND
  o.HRM_APPLICATION_ORIGIN_ID = jo.HRM_APPLICATION_ORIGIN_ID AND
  pos.HRM_JOB_OFFER_ID = jo.HRM_JOB_OFFER_ID AND
  p.HRM_PERSON_ID = pos.HRM_CANDIDATE_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CHOM_PART" ("EMPID", "NOAVS", "EMPNAME", "ELEMCODE", "HISVAL", "HISPERIOD", "HISPERIODYYYYMM") AS
  SELECT
  d.hrm_person_id empid,
  d.emp_social_securityno noAVS,
  d.per_last_name||' '||d.per_first_name empname,
  c.code elemcode,
  b.his_pay_sum_val hisval,
  b.his_pay_period hisperiod,
  to_char(b.his_pay_period, 'YYYYMM') hisperiodyyyymm
FROM
  hrm_history_detail b,
  v_hrm_elements_short c,
  hrm_person d
WHERE
  b.his_definitive = 1    and
  b.hrm_employee_id = d.hrm_person_id and
  b.hrm_elements_id = c.elemid    and
  lower(c.code) in ('cemtauxhor','gmhsemaine','gmhmois','cemhprsence','cemhvacances','cemsoldehrs','cemhmois','cemhchme','gmtauxchmage','cemchprest','cemchdd')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_AFFECTATION" ("ERD_DESCR", "ELR_ROOT_CODE", "PER_FULLNAME", "PER_NAME", "EMP_NUMBER", "SEARCHNAME", "HRM_ELEMENTS_ROOT_ID", "ELR_ROOT_NAME", "PC_LANG_ID") AS
  SELECT
  d.erd_descr,
  r.elr_root_code,
  p.per_fullname,
  p.per_last_name||' '||p.per_first_name,
  p.emp_number,
  p.per_search_name,
  r.hrm_elements_root_id,
  r.elr_root_name,
  d.pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_constants m,
  v_hrm_emptopay_num v,
  hrm_person p
WHERE
  v.empid = p.hrm_person_id and
  m.con_mandatory = 1 and
  f.hrm_elements_id = m.hrm_constants_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  d.hrm_elements_root_id = f.hrm_elements_root_id and
  p.per_is_employee = 1 and
  p.emp_calculation = 1 and
  NOT EXISTS(SELECT hrm_employee_const_id
             FROM hrm_employee_const C
             WHERE c.hrm_employee_id = p.hrm_person_id and
               c.hrm_constants_id = m.hrm_constants_id and
               c.emc_active = 1 and
               hrm_date.activeperiod between emc_value_from and emc_value_to)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_AVS" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_NAME", "SEARCHNAME", "EMP_NUMBER", "PER_BIRTH_DATE", "EMP_AGE", "AVS_VALUE", "AVS_CODE_VALUE", "AVS_NEW_VALUE", "AVS_CODE_NEW_VALUE") AS
  SELECT
  p.hrm_person_id,
  p.per_fullname,
  p.per_last_name||' '||p.per_first_name,
  p.per_search_name,
  p.emp_number,
  p.per_birth_date,
  hrm_functions.ageinperiod(p.per_birth_date) emp_age,
  decode(t.cod_code,
      '1', 'Soumis avec dduction',
      '3', 'Non soumis',
      '4', 'Retrait soumis avec dduction') avs_value,
  t.cod_code avs_code_value,
  decode(hrm_functions.avscode(p.per_birth_date,p.per_gender),
      '1', 'Soumis avec dduction',
      '0', 'Non soumis',
      '2', 'Retrait soumis avec dduction') avs_new_value,
  hrm_functions.avscode(p.per_birth_date,p.per_gender) avs_code_new_value
FROM
  hrm_code_table t,
  hrm_person p,
  hrm_employee_const c,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  r.elr_root_name = 'AVS' and
  f.hrm_elements_root_id = r.hrm_elements_root_id and
  f.elf_is_reference = 1 and
  c.hrm_constants_id = f.hrm_elements_id and
  hrm_date.activeperiod between c.emc_value_from and c.emc_value_to and
  p.hrm_person_id = c.hrm_employee_id and
  p.per_is_employee = 1 and
  p.emp_calculation = 1 and
  c.hrm_employee_id = p.hrm_person_id and
  c.emc_active = 1 and
  t.hrm_code_table_id = c.hrm_code_table_id and
  t.hrm_code_dic_id = 1 and
  ((hrm_functions.avscode(p.per_birth_date,p.per_gender) = '0' and t.cod_code <> '3') or
   (hrm_functions.avscode(p.per_birth_date,p.per_gender) = '1' and t.cod_code <> '1') or
   (hrm_functions.avscode(p.per_birth_date,p.per_gender) = '2' and t.cod_code <> '4'))




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_CALCULATED" ("EMP_CALCULATION", "PER_FULLNAME", "PER_NAME", "SEARCHNAME", "EMP_NUMBER", "INO_IN", "INO_OUT", "INO_FINAL_PAYMENT") AS
  select
  P.EMP_CALCULATION,
  P.PER_FULLNAME,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.PER_SEARCH_NAME,
  P.EMP_NUMBER,
  IO.INO_IN,
  IO.INO_OUT,
  IO.INO_FINAL_PAYMENT
from
  HRM_PERSON P,
  HRM_IN_OUT IO
where
  P.PER_IS_EMPLOYEE = 1 and
  P.EMP_CALCULATION = 1 and
  IO.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  IO.C_IN_OUT_CATEGORY = '3' and IO.C_IN_OUT_STATUS = 'ACT' and
  IO.INO_FINAL_PAYMENT = 1 and
  (IO.INO_OUT is null or IO.INO_OUT <= hrm_date.ActivePeriodEndDate)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_CALC_HIS" ("PER_NAME", "SEARCHNAME", "EMP_NUMBER", "INO_IN", "INO_OUT", "EMP_STATUS", "EMP_CALCULATION", "HRM_PERSON_ID") AS
  select
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME PER_NAME,
  P.PER_SEARCH_NAME,
  P.EMP_NUMBER,
  IO.INO_IN,
  IO.INO_OUT,
  P.EMP_STATUS,
  P.EMP_CALCULATION,
  P.HRM_PERSON_ID
from
  HRM_IN_OUT IO,
  HRM_PERSON P
where
  IO.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  IO.C_IN_OUT_CATEGORY = '3' and
  IO.INO_IN <= hrm_date.ActivePeriodEndDate and
  (IO.INO_OUT is null or IO.INO_OUT >= hrm_date.ActivePeriod) and
  not Exists(select 1 from HRM_HISTORY
             where HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
               HIT_PAY_PERIOD = hrm_date.ActivePeriodEndDate and
               HIT_REVERSED = 0 and HIT_REVERSAL = 0)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_INOUT_ACT" ("PER_NAME", "SEARCHNAME", "EMP_NUMBER", "IN_ACT", "OUT_ACT", "INOUT_STATUS_ACT", "IN_INA", "OUT_INA", "INOUT_STATUS_INA") AS
  select
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME PER_NAME,
  P.PER_SEARCH_NAME,
  P.EMP_NUMBER,
  IO2.INO_IN IN_ACT,
  IO2.INO_OUT OUT_ACT,
  IO2.C_IN_OUT_STATUS INOUT_STATUS_ACT,
  IO.INO_IN IN_INA,
  IO.INO_OUT OUT_INA,
  IO.C_IN_OUT_STATUS INOUT_STATUS_INA
from
  HRM_IN_OUT IO2,
  HRM_IN_OUT IO,
  HRM_PERSON P
where
  IO.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  IO2.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  IO.C_IN_OUT_CATEGORY = '3' and
  IO2.C_IN_OUT_CATEGORY = '3' and
  (((IO.C_IN_OUT_STATUS = 'INA') and (IO.INO_IN <= hrm_date.ActivePeriodEndDate) and
    (Nvl(IO.INO_OUT, hrm_date.ActivePeriodEndDate) >= hrm_date.ActivePeriod)) and
   ((IO2.C_IN_OUT_STATUS = 'ACT') and ((IO2.INO_IN > hrm_date.ActivePeriodEndDate) or
    (Nvl(IO2.INO_OUT, hrm_date.ActivePeriodEndDate) < hrm_date.ActivePeriod))))


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_OUTCALC" ("PER_FULLNAME", "PER_NAME", "SEARCHNAME", "EMP_NUMBER", "CON_BEGIN", "CON_END", "INO_IN", "INO_OUT") AS
  select
  P.PER_FULLNAME,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.PER_SEARCH_NAME,
  P.EMP_NUMBER,
  C.CON_BEGIN,
  C.CON_END,
  IO.INO_IN,
  IO.INO_OUT
from
  HRM_IN_OUT IO,
  HRM_CONTRACT C,
  HRM_PERSON P
where
  P.PER_IS_EMPLOYEE = 1 and
  P.EMP_CALCULATION = 1 and
  IO.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  IO.INO_OUT <= hrm_date.ActivePeriodEndDate and
  IO.C_IN_OUT_STATUS = 'ACT' and
  IO.C_IN_OUT_CATEGORY = '3' and
  IO.INO_FINAL_PAYMENT = 0 and
  C.HRM_IN_OUT_ID(+) = IO.HRM_IN_OUT_ID and
  C.C_CONTRACT_STATUS(+) = 'ACT'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_SUBMISSION" ("PER_FULLNAME", "PER_NAME", "EMP_NUMBER", "SEARCHNAME", "ERD_DESCR", "OLD_VALUE", "NEW_VALUE", "PC_LANG_ID") AS
  SELECT
  p.per_fullname,
  p.per_last_name||' '||p.per_first_name,
  p.emp_number,
  p.per_search_name,
  d.erd_descr,
  replace(h.his_pay_value, '"', '') old_value,
  t.cod_code new_value,
  d.pc_lang_id
FROM
  hrm_history_detail h,
  hrm_code_table t,
  hrm_person p,
  hrm_employee_const c,
  hrm_elements_family f,
  hrm_elements_root_descr d,
  hrm_elements_root r
WHERE
  r.elr_root_name = 'LAA' and
  d.hrm_elements_root_id = r.hrm_elements_root_id and
  f.hrm_elements_root_id = r.hrm_elements_root_id and
  f.elf_is_reference = 1 and
  c.hrm_constants_id = f.hrm_elements_id and
  c.emc_active = 1 and
  hrm_date.activeperiod between emc_value_from and emc_value_to and
  hrm_date.activeperiod <> hrm_date.beginofyear and
  p.hrm_person_id = c.hrm_employee_id and
  t.hrm_code_table_id = c.hrm_code_table_id and
  h.hrm_elements_id = c.hrm_constants_id and
  h.hrm_employee_id = c.hrm_employee_id and
  h.his_pay_period between trunc(trunc(hrm_date.activeperiod, 'month')-1, 'month') and trunc(hrm_date.activeperiod,'month')-1 and
  replace(h.his_pay_value, '"', '') <> t.cod_code




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_CONTROL_VALIDITY" ("ELO_TYPE", "PER_FULLNAME", "PER_NAME", "SEARCHNAME", "EMP_NUMBER", "ERD_DESCR", "ELR_ROOT_CODE", "ELR_FROM", "ELR_TO", "EMC_VALUE", "EMC_NUM_VALUE", "IS_NUMERIC", "INPUT_PRECISION", "PC_LANG_ID") AS
  SELECT
  elo_type,
  per_fullname,
  per_name,
  per_search_name,
  emp_number,
  erd_descr,
  elr_root_code,
  valid_from elr_from,
  valid_to elr_to,
  emc_value,
  emc_num_value,
  decode(nvl(r.c_hrm_sal_const_type, r.elr_format+2), 3, 1, 0) is_numeric,
  elr_input_precision,
  pc_lang_id
FROM
  hrm_elements_root_descr d,
  hrm_elements_root r,
  hrm_elements_family f,
  (SELECT
    'Constante employ' elo_type,
    c.hrm_constants_id hrm_elements_id,
    p.per_fullname,
    p.per_last_name||' '||p.per_first_name per_name,
    p.per_search_name,
    p.emp_number,
    c.emc_value_from valid_from,
    c.emc_value_to valid_to,
    decode(c.emc_value, null, decode(t.cod_code, null, '0', t.cod_code), c.emc_value) emc_value,
    c.emc_num_value
  FROM
    hrm_code_table t,
    hrm_person p,
    hrm_employee_const c
  WHERE
    c.emc_active = 1 and
    c.emc_value_to < hrm_date.activeperiod and
    p.hrm_person_id = c.hrm_employee_id and
    t.hrm_code_table_id (+) = c.hrm_code_table_id
  UNION ALL
  SELECT
    'Variable mensuelle' elo_type,
    e.hrm_elements_id,
    p.per_fullname,
    p.per_last_name||' '||p.per_first_name,
    p.per_search_name,
    p.emp_number,
    e.emp_value_from,
    e.emp_value_to,
    e.emp_value,
    e.emp_num_value
  FROM
    hrm_person p,
    hrm_employee_elements e
  WHERE
    e.emp_active = 1 and
    e.emp_value_to < hrm_date.activeperiod and
    p.hrm_person_id = e.hrm_employee_id
  UNION ALL
  SELECT
    'Constante entreprise' elo_type,
    c.hrm_elements_id,
    '',
    '',
    '',
    '',
    c.com_from,
    c.com_to,
    c.com_amount,
    c.com_num_amount
  FROM
    hrm_company_elements c
  WHERE
    c.com_active = 1 and
    c.com_to < hrm_date.activeperiod) v
WHERE
  f.hrm_elements_id = v.hrm_elements_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  d.hrm_elements_root_id = f.hrm_elements_root_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_DADS_CTRL" ("HRM_DADS_HEADER_ID", "DAH_REFERENCE", "DAH_EXERCICE", "DAF_STRUCTURE", "DAF_NAME", "DAF_DESCRIPTION", "DAF_NUM_VALUE", "DAF_VALUE", "EMPNAME", "EST_NAME", "INO_IN", "INO_OUT", "FEES_NAME", "MAINGROUP", "EMPGROUP", "SEARCHNAME", "ENTRYGROUP", "ESTABGROUP", "FEESGROUP", "DAF_EXPORT") AS
  select
  H.HRM_DADS_HEADER_ID,
  H.DAH_REFERENCE,
  H.DAH_EXERCICE,
  F.DAF_STRUCTURE,
  F.DAF_NAME,
  F.DAF_DESCRIPTION,
  D.DAF_NUM_VALUE,
  D.DAF_VALUE,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME EMPNAME,
  E.EST_NAME,
  I.INO_IN,
  I.INO_OUT,
  Nvl(DF.DAF_COMPANY, DF.DAF_LAST_NAME||' '||DF.DAF_FIRST_NAME) FEES_NAME,
  Decode(DAF_MAIN_GROUP, '40', '30', DAF_MAIN_GROUP) MAINGROUP,
  P.PER_SEARCH_NAME||to_char(P.HRM_PERSON_ID) EMPGROUP,
  P.PER_SEARCH_NAME,
  Nvl(to_char(INO_IN, 'YYYYMMDD'),'0') ENTRYGROUP,
  Decode(DAF_MAIN_GROUP, '80', EST_NAME||to_char(E.HRM_ESTABLISHMENT_ID), '0') ESTABGROUP,
  Decode(DAF_MAIN_GROUP, '70', Nvl(DF.DAF_COMPANY, DF.DAF_LAST_NAME||' '||DF.DAF_FIRST_NAME)||to_char(D.HRM_DADS_FEES_ID), '0') FEESGROUP,
  F.DAF_EXPORT
from
  HRM_DADS_FEES DF,
  HRM_ESTABLISHMENT E,
  HRM_IN_OUT I,
  HRM_PERSON P,
  HRM_DADS_FIELD F,
  HRM_DADS_DETAIL D,
  HRM_DADS_HEADER H
where
  D.HRM_DADS_HEADER_ID = H.HRM_DADS_HEADER_ID and
  F.HRM_DADS_FIELD_ID = D.HRM_DADS_FIELD_ID and
  E.HRM_ESTABLISHMENT_ID(+) = D.HRM_ESTABLISHMENT_ID and
  I.HRM_IN_OUT_ID(+) = D.HRM_IN_OUT_ID and
  I.C_IN_OUT_CATEGORY = '3' and
  P.HRM_PERSON_ID(+) = D.HRM_PERSON_ID and
  DF.HRM_DADS_FEES_ID(+) = D.HRM_DADS_FEES_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_DEPARTMENT" ("CODE", "DEPARTMENT", "LANGID") AS
  SELECT
  a.dic_department_id CODE,
  b.dit_descr DEPARTMENT,
  b.pc_lang_id
FROM
  dic_department a,
  dico_description b
WHERE
  a.dic_department_id = b.DIT_CODE  and
  b.DIT_TABLE = 'DIC_DEPARTMENT'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_DIFF_PERIODE" ("ELEMID", "CODE", "DESCR", "HISVALUE", "HISPERIODYYYYMM", "NAME", "EMPNUMBER") AS
  SELECT
  a.id,
  a.code,
  a.descr,
  b.his_pay_value,
  to_char(b.his_pay_period,'yyyymm'),
  c.name,
  c.empnumber
FROM
  hrm_history_detail b,
  v_hrm_defined_names a,
  v_hrm_employee_short c
WHERE
  a.id = b.hrm_elements_id and
  b.hrm_employee_id = c.empid




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_ELEMENTS_ROOT_BASE" ("STATCODE", "CODE", "DESCR", "SIGN", "BASE_DESCR", "BASE_COL", "LISTID", "STATGROUP", "ROOT_COMMENT", "LANGID", "LPP", "CAF", "TAX_CERTIF", "OFS", "ALL_CODE", "IS_DETAIL") AS
  select r.elr_root_code
       , r.elr_root_name
       , d.erd_descr
       , r.elr_sign
       , b.coe_descr
       , b.coe_box
       , b.hrm_control_list_id
       , r.elr_root_code || ' ' || r.elr_root_name
       , d.erd_comment
       , d.pc_lang_id
       , ct.coe_box lpp
       , ca.coe_box caf
       , t.coe_box tax_certif
       , o.coe_box ofs
       , a.all_code
       , isd.coe_box is_detail
    from   -- Comptabilit
         (select all_code
               , bre_item_id
            from hrm_allocation a
               , hrm_break_structure b
           where a.hrm_allocation_id = b.hrm_allocation_id) a
       ,
         -- OFS
         (select te.hrm_control_elements_id
               , te.coe_box
            from hrm_control_elements te
               , hrm_control_list tl
           where te.hrm_control_list_id = tl.hrm_control_list_id
             and tl.c_control_list_type = '011') o
       ,
         -- LPP
         (select te.hrm_control_elements_id
               , te.coe_box
            from hrm_control_elements te
               , hrm_control_list tl
           where te.hrm_control_list_id = tl.hrm_control_list_id
             and tl.c_control_list_type = '116') ct
       ,
         --CAF
         (select te.coe_box
               , te.hrm_control_elements_id
            from hrm_control_elements te
               , hrm_control_list tl
           where te.hrm_control_list_id = tl.hrm_control_list_id
             and tl.c_control_list_type = '112') ca
       ,
         -- TaxCertif
         (select te.hrm_control_elements_id
               , te.coe_box
            from hrm_control_elements te
               , hrm_control_list tl
           where te.hrm_control_list_id = tl.hrm_control_list_id
             and tl.c_control_list_type = '110') t
       ,
         -- IS dtail
         (select te.hrm_control_elements_id
               , te.coe_box
            from hrm_control_elements te
               , hrm_control_list tl
           where te.hrm_control_list_id = tl.hrm_control_list_id
             and tl.c_control_list_type = '111') isd
       ,
         -- Bases
         (select bl.hrm_control_list_id
               , be.coe_box
               , be.coe_descr
               , fs.related_id
            from hrm_formulas_structure fs
               , hrm_control_elements be
               , hrm_control_list bl
           where fs.main_id = be.hrm_control_elements_id
             and be.hrm_control_list_id = bl.hrm_control_list_id
             and bl.c_control_list_type = '101') b
       , hrm_elements_root_descr d
       , hrm_elements_family f
       , hrm_elements_root r
   where r.elr_reporting = 1
     and r.elr_is_active = 1
     and d.hrm_elements_root_id = r.hrm_elements_root_id
     and f.hrm_elements_root_id = r.hrm_elements_root_id
     and b.related_id(+) = f.hrm_elements_id
     and t.hrm_control_elements_id(+) = f.hrm_elements_id
     and ct.hrm_control_elements_id(+) = f.hrm_elements_id
     and ca.hrm_control_elements_id(+) = f.hrm_elements_id
     and o.hrm_control_elements_id(+) = f.hrm_elements_id
     and isd.hrm_control_elements_id(+) = f.hrm_elements_id
     and a.bre_item_id(+) = f.hrm_elements_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_ELEM_CLASSIF" ("ROOTID", "CODE", "STATCODE", "GR1", "GR2", "GR3", "GR4", "INDIV", "TYPE", "DESCR", "LANGID") AS
  SELECT
  r.hrm_elements_root_id,
  r.elr_root_name,
  r.elr_root_code,
  r.dic_group1_id,
  r.dic_group2_id,
  r.dic_group3_id,
  r.dic_group4_id,
  r.elr_is_indiv,
  r.elr_type,
  rd.erd_descr,
  rd.pc_lang_id
FROM
  hrm_elements_root_descr rd,
  hrm_elements_root r
WHERE
  rd.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.elr_is_active = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EMPLOYEE_BREAK" ("HEB_DEFAULT_FLAG", "HEB_AN_FLAG", "HEB_DEPARTMENT_FLAG", "HRM_EMPLOYEE_ID", "HEB_RATIO", "HEB_DEPARTMENT_ID", "HEB_DIV_NUMBER", "HEB_CDA_NUMBER", "HEB_CPN_NUMBER", "HEB_PF_NUMBER", "HEB_PJ_NUMBER", "HEB_SHIFT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "HRM_EMPLOYEE_BREAK_ID", "EMPNAME", "SEARCHNAME", "EMPGROUP", "EMPSTATUS") AS
  SELECT
  b.heb_default_flag,
  b.heb_an_flag,
  b.heb_department_flag,
  b.hrm_employee_id,
  b.heb_ratio,
  b.heb_department_id,
  b.heb_div_number,
  b.heb_cda_number,
  b.heb_cpn_number,
  b.heb_pf_number,
  b.heb_pj_number,
  b.heb_shift,
  b.a_datecre,
  b.a_datemod,
  b.a_idcre,
  b.a_idmod,
  b.hrm_employee_break_id,
  p.per_last_name||' '||p.per_first_name empname,
  p.per_search_name searchname,
  p.per_search_name||to_char(p.hrm_person_id),
  p.emp_status empstatus
FROM
  hrm_employee_break b,
  hrm_person p
WHERE
  b.hrm_employee_id = p.hrm_person_id AND
  p.emp_calculation = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EMPLOYEE_ELEMENTS" ("HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "EMP_VALUE", "EMP_NUM_VALUE", "EMP_VALUE_FROM", "EMP_VALUE_TO", "EMP_ACTIVE", "ELE_DESCR", "PC_LANG_ID", "STATCODE", "HRM_EMPLOYEE_ELEMENTS_ID", "BASEAMOUNT", "RATE", "PERRATE", "RATIOGRP", "UPPERDESCR", "ELE_GROUP", "TEXT", "OVERRIDE", "PRECISION") AS
  SELECT
  ee.hrm_elements_id,
  ee.hrm_employee_id,
  decode(ee.emp_num_value, null, ee.emp_value, null),
  ee.emp_num_value,
  ee.emp_value_from,
  ee.emp_value_to,
  ee.emp_active,
  rd.erd_descr,
  rd.pc_lang_id,
  r.elr_root_code,
  ee.hrm_employee_elements_id,
  ee.emp_base_amount,
  ee.emp_rate,
  ee.emp_per_rate,
  ee.emp_ratio_group,
  upper(rd.erd_descr),
  r.elr_root_code||to_char(ee.hrm_elements_id) ele_group,
  ee.emp_text,
  ee.emp_override,
  r.elr_input_precision
FROM
  hrm_elements_root_descr rd,
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_employee_elements ee
WHERE
  rd.hrm_elements_root_id = f.hrm_elements_root_id AND
  r.elr_is_active = 1 AND
  r.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = ee.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EMPLOYEE_OCCYEAR" ("HRM_PERSON_ID", "EMPNAME", "PER_FULLNAME", "PER_BIRTH_DATE", "YEAR") AS
  SELECT DISTINCT
  hrm_person_id,
  per_first_name||' '||per_last_name EMPNAME,
  per_fullname,
  per_birth_date,
  to_char(hit_pay_period,'yyyy') year
FROM
  hrm_person,
  hrm_history
WHERE
  hrm_person_id = hrm_employee_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EMP_LABEL" ("HRM_EMPLOYEE_ID", "EMPNAME", "EMP_NUMBER", "EMP_STATUS", "DIC_DEPARTMENT", "TITLE", "ADDR", "CITY", "SEARCHNAME", "UPPERNAME") AS
  SELECT
  a.hrm_person_id hrm_employee_id,
  a.per_last_name||' '||a.per_first_name empname,
  a.emp_number emp_number,
  a.emp_status emp_status,
  a.dic_department_id dic_department_id,
  a.per_title title,
  decode(a.per_mail_add_selector,0,a.per_businessstreet,1,a.per_homestreet,2,a.per_otherstreet,
                              a.per_taxstreet) addr,
  decode(per_mail_add_selector, 0,per_businesspostalcode,1,per_homepostalcode,2,per_otherpostalcode,
         per_taxpostalcode)
  ||' '||
  decode(per_mail_add_selector, 0,per_businesscity,1,per_homecity,2,per_othercity,
         per_taxcity) city,
  a.per_search_name,
  upper(a.per_last_name||' '||a.per_first_name)
FROM
  hrm_person a
WHERE
  a.per_is_employee = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EMP_STAT" ("EMPID", "NATIONALITY", "GENDER", "BOX", "LISTID", "ELEMID", "HISVAL", "HISVALTXT", "HISPERIODYYYYMM", "HISDEF") AS
  select
  P.HRM_PERSON_ID,
  P.DIC_NATIONALITY_ID,
  P.PER_GENDER,
  C.COE_BOX,
  C.HRM_CONTROL_LIST_ID,
  C.HRM_CONTROL_ELEMENTS_ID,
  H.HIS_PAY_SUM_VAL,
  H.HIS_PAY_VALUE,
  to_char(H.HIS_PAY_PERIOD,'YYYYMM'),
  H.HIS_DEFINITIVE
from
  HRM_SALARY_SHEET S,
  HRM_HISTORY_DETAIL H,
  HRM_CONTROL_ELEMENTS C,
  HRM_PERSON P
where
  hrm_functions.AgeInYear(P.PER_BIRTH_DATE) >= 18 and
  H.HRM_EMPLOYEE_ID = P.HRM_PERSON_ID and
  C.HRM_CONTROL_ELEMENTS_ID = H.HRM_ELEMENTS_ID and
  S.HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
  S.SAL_DEFAULT = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EVAL_STRUCTURE" ("HRM_EVAL_PROGRAM_ID", "EVP_DESCR", "EVP_COMMENT", "EVP_FROM", "EVP_TO", "HRM_EVAL_CHAPTER_ID", "EVC_SEQUENCE", "C_HRM_CHAPTER_TYPE", "EVC_SUBJECT", "EVC_COMMENT", "HRM_EVAL_NOTATION_ID", "EVN_DESCR", "EVC_WEIGHT", "HRM_EVAL_QUESTION_ID", "EVQ_SEQUENCE", "EVQ_QUESTION", "EVQ_COMMENT", "EVQ_POINTS", "EVQ_WEIGHT", "GRP_PROGRAM", "GRP_CHAPTER", "GRP_QUESTION") AS
  SELECT
  p.hrm_eval_program_id,
  p.evp_descr,
  p.evp_comment,
  p.evp_from,
  p.evp_to,
  c.hrm_eval_chapter_id,
  pc.evc_sequence,
  c.c_hrm_chapter_type,
  c.evc_subject,
  c.evc_comment,
  n.hrm_eval_notation_id,
  n.evn_descr,
  pc.evc_weight,
  q.hrm_eval_question_id,
  q.evq_sequence,
  q.evq_question,
  q.evq_comment,
  q.evq_points,
  q.evq_weight,
  p.evp_descr||to_number(p.hrm_eval_program_id) grp_program,
  lpad(to_char(evc_sequence), 3, '0')||' '||to_char(pc.hrm_eval_chapter_id) grp_chapter,
  lpad(to_char(evq_sequence), 3, '0')||' '||to_char(q.hrm_eval_question_id) grp_question
FROM
  hrm_eval_question q,
  hrm_eval_notation n,
  hrm_eval_chapter c,
  hrm_eval_prog_chap pc,
  hrm_eval_program p
WHERE
  pc.hrm_eval_program_id (+) = p.hrm_eval_program_id and
  c.hrm_eval_chapter_id (+) = pc.hrm_eval_chapter_id and
  q.hrm_eval_chapter_id (+) = c.hrm_eval_chapter_id and
  n.hrm_eval_notation_id (+) = c.hrm_eval_notation_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EVOL" ("ELEMID", "ELEMCODE", "ELEMDESCR", "STATCODE", "HISPERIODYYYY", "HISPERIODMM", "HISPERIODYYYYMM", "HISSUMVALUE", "HISDEF", "EMPID", "NAME", "EMPNUMBER", "NOAVS", "PERNAME", "STATGROUP", "BIRTHDATE", "SEARCHNAME", "UPPERNAME", "LANGID", "EMPGROUP") AS
  SELECT
  f.hrm_elements_id,
  r.elr_root_name,
  d.erd_descr,
  r.elr_root_code,
  to_char(h.his_pay_period, 'YYYY'),
  to_char(h.his_pay_period, 'MM'),
  to_char(h.his_pay_period, 'YYYYMM'),
  h.his_pay_sum_val,
  to_char(h.his_definitive),
  e.empid,
  e.name,
  e.empnumber,
  nvl(e.noavs2, e.noavs),
  e.pername,
  r.elr_root_code statgroup,
  e.birthdate,
  e.searchname,
  e.uppername,
  d.pc_lang_id,
  e.searchname||' '||to_char(e.empid)
FROM
  hrm_elements_root_descr d,
  v_hrm_employee_short e,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id and
  e.empid = h.hrm_employee_id and
  h.hrm_elements_id = f.hrm_elements_id and
  f.hrm_elements_root_id = r.hrm_elements_root_id and
  f.elf_is_reference = 1 and
  r.elr_reporting = 1 and
  r.elr_is_active = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_EVOL_DEV" ("ELEMID", "ELEMCODE", "ELEMDESCR", "STATCODE", "HISPERIODYYYY", "HISPERIODMM", "HISPERIODYYYYMM", "HISSUMVALUE", "HISDEF", "EMPID", "NAME", "EMPNUMBER", "NOAVS", "PERNAME", "STATGROUP", "BIRTHDATE", "UPPERNAME", "LANGID", "EMPGROUP", "DEVISE", "DEVISE_RATE") AS
  SELECT
  a.id,
  a.code,
  a.descr,
  a.statcode,
  to_char(b.his_pay_period, 'YYYY'),
  to_char(b.his_pay_period, 'MM'),
  to_char(b.his_pay_period, 'YYYYMM'),
  ROUND(b.his_pay_sum_val/hrm_itx.get_pers_rate(b.hrm_employee_id,b.his_pay_period),2),
  to_char(b.his_definitive),
  c.empid,
  c.name,
  c.empnumber,
  c.noavs,
  c.pername,
  a.statcode||' '||a.code statgroup,
  c.birthdate,
  upper(c.name),
  a.langid,
  c.name||' '||to_char(c.empid),
  hrm_itx.get_pers_curr(b.hrm_employee_id,b.his_pay_period) DEVISE,
  hrm_itx.get_pers_rate(b.hrm_employee_id,b.his_pay_period) DEVISE_RATE
FROM
 v_hrm_defined_names a,
 hrm_history_detail b,
 v_hrm_employee_short c
WHERE
 b.hrm_employee_id = c.empid and
 a.id=b.hrm_elements_id and
 a.is_reporting = 'True'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_FREECODE" ("HRM_OBJECT_ID", "FORMAT", "DIC", "PC_LANG_ID", "DICODESCR", "VALUETXT", "VALUE") AS
  SELECT
  hrm_object_id, 0, dic_hrm_bool_code_typ_id, pc_lang_id, dit_descr,
  decode(boo_code,1,'TRUE','FALSE'), 0
FROM
  dico_description d, hrm_boolean_code f
WHERE
  d.dit_code = f.dic_hrm_bool_code_typ_id and
  d.dit_table = 'DIC_HRM_BOOL_CODE_TYP'
UNION ALL
SELECT
  hrm_object_id, 1, dic_hrm_num_code_typ_id, pc_lang_id, dit_descr,
  '', num_code
FROM
  dico_description d, hrm_number_code f
WHERE
  d.dit_code = f.dic_hrm_num_code_typ_id and
  d.dit_table = 'DIC_HRM_NUM_CODE_TYP'
UNION ALL
SELECT
  hrm_object_id, 2, dic_hrm_date_code_typ_id, pc_lang_id, dit_descr,
  to_char(dat_code,'dd-mm-yyyy'), 0
FROM
  dico_description d, hrm_date_code f
WHERE
  d.dit_code = f.dic_hrm_date_code_typ_id and
  d.dit_table = 'DIC_HRM_DATE_CODE_TYP'
UNION ALL
SELECT
  hrm_object_id, 3, dic_hrm_char_code_typ_id, pc_lang_id, dit_descr,
  cha_code, 0
FROM
  dico_description d, hrm_char_code f
WHERE
  d.dit_code = f.dic_hrm_char_code_typ_id and
  d.dit_table = 'DIC_HRM_CHAR_CODE_TYP'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_HIS_CUM_CUST" ("LISTID", "ELEMCODE", "ELEMDESCR", "STATCODE", "STATGROUP", "HISPERIODYYYYMM", "HISPERIODYYYY", "HISPERIODMM", "HISSUMVALUE", "HISDEF", "LANGID") AS
  SELECT
  c.hrm_control_list_id,
  c.coe_code,
  rd.erd_descr,
  r.elr_root_code,
  r.elr_root_code||' '||c.coe_code,
  to_char(h.his_pay_period, 'YYYYMM'),
  to_char(h.his_pay_period, 'YYYY'),
  to_char(h.his_pay_period, 'MM'),
  decode(c.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val*-1),
  to_char(h.his_definitive),
  rd.pc_lang_id
FROM
  hrm_elements_root_descr rd,
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_history_detail h,
  hrm_control_elements c
WHERE
  rd.hrm_elements_root_id = f.hrm_elements_root_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = h.hrm_elements_id and
  h.hrm_elements_id = c.hrm_control_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_HIS_EVOL_CUST" ("LISTID", "ELEMCODE", "ELEMDESCR", "STATCODE", "STATGROUP", "HISPERIODYYYY", "HISPERIODMM", "HISSUMVALUE", "HISDEF", "EMPID", "NAME", "EMPNUMBER", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "LANGID") AS
  SELECT
  c.hrm_control_list_id,
  c.coe_code,
  d.erd_descr,
  r.elr_root_code,
  r.elr_root_code||' '||c.coe_code statgroup,
  to_char(h.his_pay_period, 'YYYY'),
  to_char(h.his_pay_period, 'MM'),
  decode(c.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val*-1),
  to_char(h.his_definitive),
  p.hrm_person_id empid,
  p.per_last_name||' '||p.per_first_name name,
  p.emp_number empnumber,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name),
  p.per_search_name||to_char(hrm_employee_id),
  d.pc_lang_id langid
FROM
  hrm_elements_root_descr d,
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_person p,
  hrm_history_detail h,
  hrm_control_elements c
WHERE
  d.hrm_elements_root_id = r.hrm_elements_root_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = h.hrm_elements_id and
  p.hrm_person_id = h.hrm_employee_id and
  h.hrm_elements_id = c.hrm_control_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_HIS_EVOL_CUST_DEV" ("LISTID", "ELEMCODE", "ELEMDESCR", "STATCODE", "STATGROUP", "HISPERIODYYYY", "HISPERIODMM", "HISSUMVALUE", "HISDEF", "EMPID", "NAME", "EMPNUMBER", "UPPERNAME", "LANGID", "DEVISE", "DEVISE_RATE") AS
  SELECT
  a.hrm_control_list_id,
  b.code,
  b.descr,
  b.statcode,
  b.statcode||' '||b.code statgroup,
  to_char(c.his_pay_period, 'YYYY'),
  to_char(c.his_pay_period, 'MM'),
  Decode(a.coe_inverse, 0, round(c.his_pay_sum_val/hrm_itx.get_pers_rate(d.hrm_person_id,c.his_pay_period),2), round(c.his_pay_sum_val/hrm_itx.get_pers_rate(d.hrm_person_id,c.his_pay_period),2)*-1),
  to_char(c.his_definitive),
  d.hrm_person_id empid,
  d.per_last_name||' '||d.per_first_name name,
  d.emp_number empnumber,
  upper(d.per_last_name||' '||d.per_first_name),
  b.langid,
  hrm_itx.get_pers_curr(d.hrm_person_id,c.his_pay_period) DEVISE,
  hrm_itx.get_pers_rate(d.hrm_person_id,c.his_pay_period) DEVISE_RATE
FROM
  hrm_history_detail c,
  v_hrm_defined_names b,
  hrm_person d,
  hrm_control_elements a
WHERE
  a.hrm_control_elements_id = b.id and
  a.hrm_control_elements_id = c.hrm_elements_id and
  c.hrm_employee_id = d.hrm_person_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_HIS_PARAM" ("EMPID", "NAME", "EMPNUMBER", "BOX", "LISTID", "NLISTID", "HISVAL", "HISPERIODYYYYMM", "HISDEF", "GROUPEMP", "SEARCHNAME", "UPPERNAME") AS
  SELECT
  e.empid,
  e.name,
  e.empnumber,
  c.coe_box,
  to_char(c.hrm_control_list_id),
  c.hrm_control_list_id,
  decode(c.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val*-1),
  to_char(h.his_pay_period,'yyyymm'),
  to_char(h.his_definitive),
  searchname||to_char(e.empid),
  searchname,
  uppername
FROM
  v_hrm_employee_short e,
  hrm_history_detail h,
  hrm_control_elements c
WHERE
  e.empid = h.hrm_employee_id AND
  h.hrm_elements_id = c.hrm_control_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_HIS_PARAM_DEV" ("EMPID", "NAME", "EMPNUMBER", "BOX", "LISTID", "HISVAL", "HISPERIODYYYYMM", "HISDEF", "GROUPEMP", "UPPERNAME", "DEVISE", "DEVISE_RATE") AS
  SELECT
  c.empid,
  c.name,
  c.empnumber,
  a.coe_box,
  to_char(a.hrm_control_list_id),
  decode(a.coe_inverse, 0, round(b.his_pay_sum_val/hrm_itx.get_pers_rate(b.hrm_employee_id,b.his_pay_period),2), round(b.his_pay_sum_val/hrm_itx.get_pers_rate(b.hrm_employee_id,b.his_pay_period),2)*-1),
  to_char(b.his_pay_period,'yyyymm'),
  to_char(b.his_definitive),
  c.name||to_char(c.empid),
  upper(c.name),
  hrm_itx.get_pers_curr(b.hrm_employee_id,b.his_pay_period) DEVISE,
  hrm_itx.get_pers_rate(b.hrm_employee_id,b.his_pay_period) DEVISE_RATE
FROM
  hrm_control_elements a,
  hrm_history_detail b,
  v_hrm_employee_short c
WHERE
  a.hrm_control_elements_id = b.hrm_elements_id and
  b.hrm_employee_id = c.empid




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_HIS_PERIOD_CUM" ("ELEMID", "STATCODE", "CODE", "DESCR", "VALUE", "PERIOD", "DEFINITIVE", "STATGROUP", "LANGID") AS
  SELECT
  f.hrm_elements_id,
  c.elr_root_code,
  c.elr_root_name,
  e.erd_descr,
  b.his_pay_sum_val,
  to_char(b.his_pay_period, 'YYYYMM'),
  to_char(b.his_definitive),
  c.elr_root_code||' '||c.elr_root_name,
  e.pc_lang_id
FROM
  hrm_history_detail b,
  hrm_elements_family f,
  hrm_elements_root_descr e,
  hrm_elements_root c
WHERE
  c.elr_reporting = 1 AND
  c.elr_is_active = 1 AND
  e.hrm_elements_root_id = c.hrm_elements_root_id AND
  f.hrm_elements_root_id = c.hrm_elements_root_id AND
  f.elf_is_reference = 1 AND
  b.hrm_elements_id = f.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_IS_CERTIF_FR" ("EMPID", "EMPNAME", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "PER_BIRTH_DATE", "C_CIVIL_STATUS", "NOAVS", "DIC_DEPARTMENT_ID", "DIC_CONFESSION_ID", "DIC_CANTON_WORK_ID", "ADDRESS", "ADD_CITY", "COE_BOX", "LISTID", "HISVAL", "HISSUMVAL", "HISPERIODBEGIN", "HISPERIODEND", "HISYEARPERIOD", "ACTIVITY", "INO_IN", "INO_OUT") AS
  SELECT
  P.HRM_PERSON_ID,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.PER_SEARCH_NAME,
  Upper(P.PER_LAST_NAME||' '||P.PER_FIRST_NAME),
  P.PER_SEARCH_NAME||to_char(P.HRM_PERSON_ID),
  P.PER_BIRTH_DATE,
  P.C_CIVIL_STATUS,
  Nvl(P.EMP_SOCIAL_SECURITYNO2, P.EMP_SOCIAL_SECURITYNO),
  P.DIC_DEPARTMENT_ID,
  P.DIC_CONFESSION_ID,
  P.DIC_CANTON_WORK_ID,
  Decode(P.PER_TAXPOSTALCODE,'', Decode(P.PER_MAIL_ADD_SELECTOR,0,P.PER_BUSINESSSTREET,1,P.PER_HOMESTREET,2,P.PER_OTHERSTREET), P.PER_TAXSTREET),
  Decode(P.PER_TAXPOSTALCODE,'', Decode(P.PER_MAIL_ADD_SELECTOR,0,P.PER_BUSINESSPOSTALCODE,1,P.PER_HOMEPOSTALCODE,2,P.PER_OTHERPOSTALCODE), P.per_taxpostalcode)||' '||
  Decode(P.PER_TAXPOSTALCODE,'', Decode(P.PER_MAIL_ADD_SELECTOR,0,P.PER_BUSINESSCITY,1,P.PER_HOMECITY,2,P.PER_OTHERCITY),P.PER_TAXCITY),
  L.COE_BOX,
  LC.HRM_CONTROL_LIST_ID,
  H.HIS_PAY_VALUE,
  Decode(L.COE_INVERSE, 0, H.HIS_PAY_SUM_VAL, H.HIS_PAY_SUM_VAL*-1),
  Trunc(HC.HIS_PAY_PERIOD,'Month'),
  HC.HIS_PAY_PERIOD,
  to_char(HC.HIS_PAY_PERIOD,'YYYY'),
  to_number(hrm_xml.xmlvalue(P.HRM_PERSON_ID,'activite_taetigkeit')),
  I.INO_IN,
  I.INO_OUT
FROM
  HRM_IN_OUT I,
  HRM_PERSON P,
  HRM_HISTORY_DETAIL H,
  HRM_CONTROL_ELEMENTS L,
  HRM_HISTORY_DETAIL HC, -- historique du CodeIs
  HRM_CONTROL_ELEMENTS LC -- lment corresp. au CodeIs
WHERE
  I.HRM_EMPLOYEE_ID = HC.HRM_EMPLOYEE_ID and
  I.C_IN_OUT_CATEGORY = '3' and
  HC.HIS_PAY_PERIOD between I.INO_IN and hrm_date.NextInOutInDate(I.INO_IN, I.HRM_EMPLOYEE_ID) and
  P.HRM_PERSON_ID = HC.HRM_EMPLOYEE_ID and
  H.HIS_PAY_NUM = HC.HIS_PAY_NUM and
  H.HRM_EMPLOYEE_ID = HC.HRM_EMPLOYEE_ID and
  H.HRM_ELEMENTS_ID = L.HRM_CONTROL_ELEMENTS_ID and
  L.HRM_CONTROL_LIST_ID = LC.HRM_CONTROL_LIST_ID and
  HC.HRM_ELEMENTS_ID = LC.HRM_CONTROL_ELEMENTS_ID and
  LC.COE_BOX = 'COL03' and Instr(Replace(HC.HIS_PAY_VALUE,'"'),'FR') = 1 and
  HC.HIS_DEFINITIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_IS_CERTIF_GE" ("EMPID", "EMPNAME", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "DIC_DEPARTMENT_ID", "NOAVS", "ADDRESS", "ADD_CITY", "ADD_CNTRY", "WORK_CITY", "WORK_CANTON", "TAXPAYER", "PER_BIRTH_DATE", "C_CIVIL_STATUS", "CONFESSION", "REL_FULLNAME", "REL_WORK_CH", "COE_BOX", "LISTID", "NLISTID", "HISVAL", "HISSUMVAL", "HISPERIOD", "HISYEARPERIOD", "COPYTYPE") AS
  SELECT
  p.hrm_person_id,
  p.per_last_name||' '||p.per_first_name,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name),
  p.per_search_name||to_char(p.hrm_person_id),
  p.dic_department_id,
  nvl(p.emp_social_securityno2, p.emp_social_securityno),
  nvl2(per_taxpostalcode, per_taxstreet, per_homestreet) ADDRESS,
  nvl(per_taxpostalcode, per_homepostalcode)||' '||
    nvl2(per_taxpostalcode, per_taxcity, per_homecity) ADD_CITY,
  -- Pays si <> de suisse
  case
    when Instr(hrm_country_fct.GetCountryCode('CH'),  Nvl2(per_taxpostalcode, per_taxcountry, per_homecountry)) = 0 then
      Nvl2(per_taxpostalcode, per_taxcountry, per_homecountry)
  end,
  p.c_hrm_ge_workcity,
  p.dic_canton_work_id,
  p.c_hrm_ge_taxpayer,
  p.per_birth_date,
  p.c_civil_status,
  p.c_hrm_ge_religion,
  r.rel_name||' '||r.rel_first_name rel_fullname,
  case when r.dic_canton_work_id in ('AG','AI','AR','BE','BL','BS','FR','GL','GE','GR','JU','LU','NE','NW','OW','SG','SH','SO','SZ','TG','TI','UR','VD','VS','ZG','ZH' ) then 1 else 0 end rel_work_ch,
  l.coe_box,
  to_char(l.hrm_control_list_id),
  l.hrm_control_list_id,
  h.his_pay_value,
  decode(l.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val*-1),
  h.his_pay_period,
  to_char(h.his_pay_period,'YYYY'),
  d.CopyType
FROM
  hrm_person p,
  hrm_related_to r,
  hrm_history_detail h,
  hrm_control_elements l,
  (select '1' copytype from dual union all
   select '2' copytype from dual union all
   select '3' copytype from dual) d
WHERE
  r.hrm_employee_id(+) = p.hrm_person_id and
  r.c_related_to_type(+) = 1 and
  p.hrm_person_id = h.hrm_employee_id and
  h.hrm_elements_id = l.hrm_control_elements_id and
  h.his_definitive = 1 and
    exists (select 1 from hrm_employee_taxsource ht
            where ht.emt_canton = 'GE' and
              trunc(h.his_pay_period, 'Y') between trunc(ht.emt_from,'Y') and nvl(ht.emt_to, h.his_pay_period) and
              ht.hrm_person_id = h.hrm_employee_id)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_IS_CERTIF_VD" ("EMPID", "EMPNAME", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_BIRTH_DATE", "NOAVS", "ADDRESS", "ADD_CITY", "COE_BOX", "COE_DESCR", "LISTID", "HISVAL", "HISSUMVAL", "HISPERIODBEGIN", "HISPERIODEND", "HISYEARPERIOD", "INO_IN", "INO_OUT", "COPYTYPE", "EMT_VALUE") AS
  select P.HRM_PERSON_ID
       , P.PER_LAST_NAME || ' ' || P.PER_FIRST_NAME
       , P.PER_SEARCH_NAME
       , upper(P.PER_LAST_NAME || ' ' || P.PER_FIRST_NAME)
       , P.PER_SEARCH_NAME || to_char(P.HRM_PERSON_ID)
       , P.PER_LAST_NAME
       , P.PER_FIRST_NAME
       , P.PER_BIRTH_DATE
       , nvl(P.EMP_SOCIAL_SECURITYNO2, P.EMP_SOCIAL_SECURITYNO)
       , decode(P.PER_TAXPOSTALCODE, '', decode(P.PER_MAIL_ADD_SELECTOR, 0, P.PER_BUSINESSSTREET, 1, P.PER_HOMESTREET, 2, P.PER_OTHERSTREET), P.PER_TAXSTREET)
       , decode(P.PER_TAXPOSTALCODE
              , '', decode(P.PER_MAIL_ADD_SELECTOR, 0, P.PER_BUSINESSPOSTALCODE, 1, P.PER_HOMEPOSTALCODE, 2, P.PER_OTHERPOSTALCODE)
              , P.PER_TAXPOSTALCODE
               ) ||
         ' ' ||
         decode(P.PER_TAXPOSTALCODE, '', decode(P.PER_MAIL_ADD_SELECTOR, 0, P.PER_BUSINESSCITY, 1, P.PER_HOMECITY, 2, P.PER_OTHERCITY), P.PER_TAXCITY)
       , L.COE_BOX
       , L.COE_DESCR
       , L.HRM_CONTROL_LIST_ID
       , H.HIS_PAY_VALUE
       , decode(L.COE_INVERSE, 0, H.HIS_PAY_SUM_VAL, H.HIS_PAY_SUM_VAL * -1)
       , trunc(H.HIS_PAY_PERIOD, 'Month')
       , H.HIS_PAY_PERIOD
       , to_char(H.HIS_PAY_PERIOD, 'YYYY')
       , I.INO_IN
       , I.INO_OUT
       , D.COPYTYPE
       , emt_value
    from HRM_IN_OUT I
       , HRM_PERSON P
       , HRM_HISTORY_DETAIL H
       , HRM_CONTROL_ELEMENTS L
       , HRM_EMPLOYEE_TAXSOURCE TAX
       , hrm_history hi
       ,   -- lment corresp. au CodeIs
         (select '1' COPYTYPE
            from dual
          union all
          select '2' COPYTYPE
            from dual
          union all
          select '3' COPYTYPE
            from dual) D
   where I.HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID
     and I.C_IN_OUT_CATEGORY = '3'
     and Hi.HIt_PAY_PERIOD between I.INO_IN and hrm_date.NextInOutInDate(I.INO_OUT, I.HRM_EMPLOYEE_ID)
     and h.hrm_employee_id = hi.hrm_employee_id
     and his_pay_num = hit_pay_num
     and P.HRM_PERSON_ID = H.HRM_EMPLOYEE_ID
     and H.HRM_ELEMENTS_ID = L.HRM_CONTROL_ELEMENTS_ID
     and emt_canton = 'VD'
     and (   hi.hit_pay_period between emt_from
                                   and(case
                                         when EMT_TO = INO_OUT then HRM_IS_VD_EMPACI.NEXTEMPTAXINDATE(emt_to, tax.hrm_person_id)
                                         else last_day(nvl(emt_to, to_date('31.12.2050', 'DD.MM.YYYY') ) )
                                       end
                                      )
          or (    coe_box = '1F'
              and hi.hit_pay_period between emt_from and HRM_IS_VD_EMPACI.NEXTEMPTAXINDATE(emt_to, tax.hrm_person_id) )
         )
     and p.hrm_person_id = tax.hrm_person_id
     and H.HIS_DEFINITIVE = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_IS_RECAP_GE" ("EMPID", "EMPNAME", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "NOAVS", "COE_BOX", "LISTID", "NLISTID", "HISVAL", "HISSUMVAL", "HISPERIOD", "HISYEARPERIOD", "CODE_COMMUNE") AS
  SELECT
  p.hrm_person_id,
  p.per_last_name||' '||p.per_first_name,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name),
  p.per_search_name||to_char(p.hrm_person_id),
  nvl(p.emp_social_securityno2, p.emp_social_securityno),
  l.coe_box,
  to_char(lc.hrm_control_list_id),
  lc.hrm_control_list_id,
  h.his_pay_value,
  decode(l.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val*-1),
  hc.his_pay_period,
  to_char(hc.his_pay_period,'YYYY'),
  p.per_homepostalcode
FROM
  hrm_person p,
  hrm_history_detail h,
  hrm_control_elements l,
  hrm_history_detail hc, -- historique du CodeIs
  hrm_control_elements lc -- lment corresp. au CodeIs
WHERE
  p.hrm_person_id = hc.hrm_employee_id and
  h.his_pay_num = hc.his_pay_num and
  h.hrm_employee_id = hc.hrm_employee_id and
  h.hrm_elements_id = l.hrm_control_elements_id and
  l.hrm_control_list_id = lc.hrm_control_list_id and
  hc.hrm_elements_id = lc.hrm_control_elements_id and
  lc.coe_box = 'TAX_CODE' and instr(replace(hc.his_pay_value, '"'), 'GE') = 1 and
  hc.his_definitive = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_JOB_COMP_SEARCH" ("HRM_JOB_ID", "JOB_CODE", "JOB_DESCR", "JOB_TITLE", "WISH_LEVEL", "WISH_INTEREST", "WISH_WEIGHTED", "HRM_PERSON_ID", "NAME", "PER_LEVEL", "USER_WEIGHTED", "PER_EXPERIENCE", "PER_LASTUSED", "PER_SOURCE", "PER_COMMENT", "PC_LANG_ID", "COD_DESCR") AS
  SELECT
  wish.hrm_job_id,
  wish.job_code,
  wish.job_descr,
  wish.job_title,
  to_number(nvl(wish.c_comp_level_scale,0)),
  to_number(nvl(wish.c_comp_interest_scale,0)),
  nvl(wish.c_comp_level_scale,0) * nvl(wish.c_comp_interest_scale,0),
  wish.hrm_person_id,
  wish.name,
  to_number(nvl(cl.c_comp_level_scale, 0)),
  nvl(cl.c_comp_level_scale,0) * nvl(wish.c_comp_interest_scale,0),
  cl.col_years_of_experience,
  cl.col_year_last_used,
  cl.col_source,
  cl.col_comment,
  cd.pc_lang_id,
  cd.cod_descr
FROM
  hrm_competence_descr cd,
  hrm_competence_link cl,
  (SELECT
     job.hrm_job_id,
     job.job_code,
     job.job_descr,
     job.job_title,
     p.hrm_person_id,
     p.per_last_name||' '||p.per_first_name name,
     cljob.hrm_competence_id,
     cljob.c_comp_level_scale,
     cljob.c_comp_interest_scale,
     cljob.col_comment,
     cljob.col_years_of_experience
   FROM
     hrm_person p,
     hrm_competence_link cljob,
     hrm_job job
   WHERE
     cljob.hrm_job_id = job.hrm_job_id) wish
WHERE
  wish.hrm_competence_id = cl.hrm_competence_id (+) and
  wish.hrm_person_id = cl.hrm_person_id (+) and
  wish.hrm_competence_id = cd.hrm_competence_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_LASTBREAK_EMP_ELT" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_FOREIGN_AMOUNT", "V_HBC_DEBIT_FOREIGN_AMOUNT", "V_HBC_CREDIT_FOREIGN_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "HRM_EMPLOYEE_ID", "EMPNAME", "ELE_CODE", "ELE_DESCR", "ELE_LANGID") AS
  SELECT
  a.HRM_HISTORY_DETAIL_ID,
  a.HRM_BREAK_ID,
  a.HRM_ELEMENTS_ID,
  a.V_HBC_ACC_NUM,
  a.V_HBC_ACC_NAME,
  a.V_HBC_DIV_NUM,
  a.V_HBC_DIV_NAME,
  a.V_HBC_AMOUNT,
  a.V_HBC_DEBIT_AMOUNT,
  a.V_HBC_CREDIT_AMOUNT,
  a.V_HBC_FOREIGN_AMOUNT,
  a.V_HBC_DEBIT_FOREIGN_AMOUNT,
  a.V_HBC_CREDIT_FOREIGN_AMOUNT,
  a.V_HBC_AMOUNT_TYPE,
  a.SAB_PAY_DATE,
  a.SAB_REF_VALUE,
  a.SAB_ZL,
  a.CURRENCY,
  a.HRM_EMPLOYEE_ID,
  b.per_first_name||' '||b.per_last_name empname,
  ele_code,
  c.ele_descr,
  c.pc_lang_id
FROM
  hrm_elements_descr c,
  hrm_person b,
  v_hrm_break_cgdiv2 a
WHERE
  a.hrm_employee_id = b.hrm_person_id and
  a.hrm_elements_id = c.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_PERSON_JOB" ("EMPID", "EMPNAME", "SEARCHNAME", "EMPGROUP", "ACTIVITY_RATE", "PEJ_FROM", "PEJ_TO", "PEJ_AFFECT_RATE", "JOBID", "JOB_DESCR", "JOB_CODE", "JOB_TITLE", "JOB_ACTIVITY", "JOB_ACTIVITY_N", "EMPSTATUS") AS
  SELECT
  p.hrm_person_id,
  p.per_last_name||' '||p.per_first_name,
  p.per_search_name,
  p.per_search_name||to_char(p.hrm_person_id),
  p.per_activity_rate,
  pj.pej_from,
  pj.pej_to,
  pj.pej_affect_rate,
  j.hrm_job_id,
  j.job_descr,
  j.job_code,
  j.job_title,
  j.job_activity,
  j.job_activity_n,
  p.emp_status
FROM
  hrm_person p,
  hrm_job j,
  hrm_person_job pj
WHERE
  p.hrm_person_id = pj.hrm_person_id and
  j.hrm_job_id = pj.hrm_job_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_PERSON_TRAINING" ("HRM_PERSON_ID", "PERNAME", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "EMPNUMBER", "SUBSCRIPTION", "SUBGROUP", "BEGIN_DATE", "END_DATE", "SESSION_STATE", "COST_TYPE", "COST_DESCR", "COST_AMOUNT", "TITLE") AS
  SELECT
  p.hrm_person_id,
  p.per_last_name||' '||p.per_first_name,
  p.per_search_name,
  upper(p.per_last_name||' '||p.per_first_name),
  p.per_search_name||to_char(p.hrm_person_id) empgroup,
  p.emp_number,
  sub.hrm_subscription_id,
  to_char(ses_begin_date,'yyyymmdd')||to_char(sub.hrm_subscription_id) subgroup,
  s.ses_begin_date,
  s.ses_end_date,
  s.c_training_state,
  c.dic_cost_type_id,
  c.trc_descr,
  nvl(c.trc_amount,0),
  t.tra_title
FROM
  hrm_training t,
  hrm_training_cost c,
  hrm_session s,
  hrm_subscription sub,
  hrm_person p
WHERE
  t.hrm_training_id = s.hrm_training_id and
  s.hrm_session_id = sub.hrm_session_id and
  c.hrm_session_id(+) = sub.hrm_session_id and
  c.hrm_person_id(+) = sub.hrm_person_id and
  sub.hrm_person_id = p.hrm_person_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_PERSON_WITHXML" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_TITLE", "PER_FIRST_NAME", "PER_LAST_NAME", "PER_INITIALS", "PER_GENDER", "PER_BIRTH_DATE", "PER_COMMENT", "PER_ASSISTANT_PHONE", "PER_BUSINESS_PHONE", "PER_BUSINESS2_PHONE", "PER_HOME_PHONE", "PER_HOME2_PHONE", "PER_MOBILE_PHONE", "PER_OTHER_PHONE", "PER_FAX_PHONE", "PER_FAX2_PHONE", "PER_PHONE_SELECTOR", "PER_EMAIL", "PER_EMAIL2", "PER_EMAIL3", "PER_EMAIL_SELECTOR", "PER_BUSINESSSTREET", "PER_BUSINESSCITY", "PER_BUSINESSSTATE", "PER_BUSINESSPOSTALCODE", "PER_BUSINESSCOUNTRY", "PER_HOMESTREET", "PER_HOMECITY", "PER_HOMESTATE", "PER_HOMEPOSTALCODE", "PER_HOMECOUNTRY", "PER_OTHERSTREET", "PER_OTHERCITY", "PER_OTHERSTATE", "PER_OTHERPOSTALCODE", "PER_OTHERCOUNTRY", "PER_ADDRESS_SELECTOR", "PER_ADDRESS_SELECTED", "PER_MAIL_ADD_SELECTOR", "PER_MAIL_ADD_SELECTED", "PER_WEB_PAGE", "PER_IS_EMPLOYEE", "EMP_NUMBER", "EMP_SECONDARY_KEY", "EMP_SOCIAL_SECURITYNO", "EMP_LAST_INTERVIEW", "EMP_WORKINGAREA", "EMP_NATIVE_OF", "EMP_BIRTH_COUNTRY", "EMP_BIRTH_PLACE", "EMP_CALCULATION", "EMP_CHILD_NB", "DIC_NATIONALITY_ID", "DIC_NATIONALITY2_ID", "DIC_WORKPLACE_ID", "DIC_DEPARTMENT_ID", "C_CIVIL_STATUS", "EMP_STATUS", "COM_BITMAP_ID", "PC_LANG_ID", "LANGUAGE", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS") AS
  SELECT
  A.HRM_PERSON_ID,
  PER_FULLNAME, PER_TITLE, PER_FIRST_NAME, PER_LAST_NAME,
  PER_INITIALS, PER_GENDER, PER_BIRTH_DATE, PER_COMMENT,
  PER_ASSISTANT_PHONE, PER_BUSINESS_PHONE, PER_BUSINESS2_PHONE, PER_HOME_PHONE,
  PER_HOME2_PHONE, PER_MOBILE_PHONE, PER_OTHER_PHONE, PER_FAX_PHONE,
  PER_FAX2_PHONE, PER_PHONE_SELECTOR, PER_EMAIL, PER_EMAIL2,
  PER_EMAIL3, PER_EMAIL_SELECTOR, PER_BUSINESSSTREET, PER_BUSINESSCITY,
  PER_BUSINESSSTATE, PER_BUSINESSPOSTALCODE, PER_BUSINESSCOUNTRY, PER_HOMESTREET,
  PER_HOMECITY, PER_HOMESTATE, PER_HOMEPOSTALCODE, PER_HOMECOUNTRY,
  PER_OTHERSTREET, PER_OTHERCITY, PER_OTHERSTATE, PER_OTHERPOSTALCODE,
  PER_OTHERCOUNTRY, PER_ADDRESS_SELECTOR, PER_ADDRESS_SELECTED, PER_MAIL_ADD_SELECTOR,
  PER_MAIL_ADD_SELECTED, PER_WEB_PAGE, PER_IS_EMPLOYEE, EMP_NUMBER,
  EMP_SECONDARY_KEY, EMP_SOCIAL_SECURITYNO, EMP_LAST_INTERVIEW, EMP_WORKINGAREA,
  EMP_NATIVE_OF, EMP_BIRTH_COUNTRY, EMP_BIRTH_PLACE, EMP_CALCULATION,
  EMP_CHILD_NB, DIC_NATIONALITY_ID, DIC_NATIONALITY2_ID, DIC_WORKPLACE_ID,
  DIC_DEPARTMENT_ID, C_CIVIL_STATUS, EMP_STATUS, COM_BITMAP_ID,
  PC_LANG_ID, LANGUAGE, A_DATECRE, A_DATEMOD,
  A_IDCRE, A_IDMOD, A_RECLEVEL, A_RECSTATUS
FROM
  V_HRM_PERSON a
WHERE
  a.HRM_PERSON_ID IN (SELECT HRM_PERSON_ID
                      FROM HRM_PERSON_XML
                      WHERE XML_VALUE IS NOT NULL)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_PROFILE" ("HRM_PROFILE_ID", "PRO_CODE", "PRO_DESCRIPTION", "WISH_LEVEL", "WISH_INTEREST", "WISH_WEIGHTED", "HRM_PERSON_ID", "NAME", "PER_LEVEL", "USER_WEIGHTED", "PER_EXPERIENCE", "PER_LASTUSED", "PER_SOURCE", "PER_COMMENT", "PC_LANG_ID", "COD_DESCR") AS
  SELECT
  wish.hrm_profile_id,
  wish.pro_code,
  wish.pro_description,
  to_number(nvl(wish.c_comp_level_scale,0)),
  to_number(nvl(wish.c_comp_interest_scale,0)),
  nvl(wish.c_comp_level_scale,0) * nvl(wish.c_comp_interest_scale,0),
  wish.hrm_person_id,
  wish.name,
  to_number(nvl(cl.c_comp_level_scale, 0)),
  nvl(cl.c_comp_level_scale,0) * nvl(wish.c_comp_interest_scale,0),
  cl.col_years_of_experience,
  cl.col_year_last_used,
  cl.col_source,
  cl.col_comment,
  cd.pc_lang_id,
  cd.cod_descr
FROM
  hrm_competence_descr cd,
  hrm_competence_link cl,
  (SELECT
     pro.hrm_profile_id,
     pro.pro_code,
     pro.pro_description,
     p.hrm_person_id,
     p.per_last_name||' '||p.per_first_name name,
     clpro.hrm_competence_id,
     clpro.c_comp_level_scale,
     clpro.c_comp_interest_scale,
     clpro.col_comment,
     clpro.col_years_of_experience
   FROM
     hrm_person p,
     hrm_competence_link clpro,
     hrm_profile pro
   WHERE
     clpro.hrm_profile_id = pro.hrm_profile_id) wish
WHERE
  wish.hrm_competence_id = cl.hrm_competence_id (+) and
  wish.hrm_person_id = cl.hrm_person_id (+) and
  wish.hrm_competence_id = cd.hrm_competence_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_PROPEMP_1" ("HRM_EMPLOYEE_ID", "EEB_RATIO_GROUP", "EEB_TIME_RATIO", "CG", "HIT_PAY_PERIOD", "YEAR") AS
  SELECT
  a.hrm_employee_id,
  c.eeb_ratio_group,
  sum(c.eeb_time_ratio) eeb_time_ratio,
  dic_department_id||job_code CG,
  hit_pay_period,
  to_char(hit_pay_period,'yyyy') year
FROM
  hrm_history_detail_break c,
  hrm_history_detail b,
  hrm_history a
WHERE
  a.hrm_employee_id = b.hrm_employee_id and
  a.hit_pay_num = b.his_pay_num and
  b.hrm_history_detail_id = c.hrm_history_detail_id
GROUP by
  a.hrm_employee_id,
  c.eeb_ratio_group,
  dic_department_id||job_code,
  hit_pay_period,
  to_char(hit_pay_period,'yyyy')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_RECAP_DEC_FR" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ROOT_ID", "ELR_ROOT_CODE", "ERD_DESCR", "ELR_ROOT_NAME", "HIS_PAY_NUM", "HIS_PAY_PERIOD", "C1", "C2", "C3", "C4", "C6", "C7") AS
  SELECT
  hrm_employee_id,
  r.hrm_elements_root_id,
  r.elr_root_code,
  des.erd_descr,
  r.elr_root_name,
  c.his_pay_num,
  to_char(c.his_pay_period, 'YYYYMM'),
  c1, c2, c3, c4, c6, c7
FROM
  hrm_elements_root r,
  hrm_elements_root_descr des,
  (SELECT
     hrm_employee_id,
     rd.hrm_elements_root_id,
     his_pay_num,
     his_pay_period,
     SUM (DECODE (c_column_type, '01', his_pay_sum_val, 0)) c1,
     SUM (DECODE (c_column_type, '02', his_pay_sum_val, 0)) c2,
     SUM (DECODE (c_column_type, '03', his_pay_sum_val, 0)) c3,
     SUM (DECODE (c_column_type, '04', his_pay_sum_val, 0)) c4,
     SUM (DECODE (c_column_type, '05', his_pay_sum_val, 0)) c5,
     SUM (DECODE (c_column_type, '06', his_pay_sum_val, 0)) c6,
     SUM (DECODE (c_column_type, '07', his_pay_sum_val, 0)) c7
     FROM
       v_hrm_payroll e,
       hrm_elements_root_display rd,
       hrm_history_detail d
     WHERE UPPER (decode(nvl(instr(replace(eld_condition,'*','/'),'/'),0),0,eld_condition,substr(eld_condition,1,instr(replace(eld_condition,'*','/'),'/')-1))) = upper(ele_code) AND
       d.hrm_elements_id = e.elem_const_id
     GROUP BY
       rd.hrm_elements_root_id,
       hrm_employee_id,
       his_pay_num,
       his_pay_period) c
WHERE
  r.hrm_elements_root_id = c.hrm_elements_root_id AND
  r.hrm_elements_root_id = des.hrm_elements_root_id AND
  des.pc_lang_id = 1 AND
  elr_root_code BETWEEN '200000' AND '341000'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_ROOT_DISPLAY" ("HRM_ELEMENTS_ROOT_ID", "C_COLUMN_TYPE", "ELD_CONDITION", "GCDTEXT1", "PC_LANG_ID") AS
  SELECT
  t.hrm_elements_root_id,
  d.c_column_type,
  d.eld_condition,
  t.gcdtext1,
  t.pc_lang_id
FROM
  (SELECT
    r.hrm_elements_root_id,
    c.gcdtext1,
    c.gclcode,
    c.pc_lang_id
   FROM
    hrm_elements_root r,
    pcs.pc_gcodes c
   WHERE
    lower(c.gcgname) = 'c_column_type' and
    r.elr_is_print = 1 and
    lower(r.c_root_variant) <> 'text') t,
  hrm_elements_root_display d
WHERE
   d.hrm_elements_root_id(+) = t.hrm_elements_root_id and
   d.c_column_type(+) = t.gclcode




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_SALARY_BREAKDOWN" ("BRK_DESCRIPTION", "BRK_VALUE_DATE", "PER_FULLNAME", "PER_SEARCH_NAME", "ELE_DESCR", "DIC_ACCOUNT_TYPE_ID", "SAB_ACCOUNT_NAME", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "LANGID") AS
  SELECT
  b.brk_description,
  b.brk_value_date,
  p.per_last_name||' '||p.per_first_name per_fullname,
  p.per_search_name,
  rd.erd_descr,
  sb.dic_account_type_id,
  sb.sab_account_name,
  nvl(decode(sb.sab_amount_type,'D',sb.sab_amount), 0) debit_amount,
  nvl(decode(sb.sab_amount_type,'C',sb.sab_amount), 0) credit_amount,
  rd.pc_lang_id
FROM
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  hrm_person p,
  hrm_salary_breakdown sb,
  hrm_break b
WHERE
  rd.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = sb.hrm_elements_id and
  p.hrm_person_id = sb.hrm_employee_id and
  sb.hrm_break_id = b.hrm_break_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_SALARY_BYAGE" ("EMPID", "CATEG_AGE", "SEX", "VALUE", "HISPERIODYYYYMM", "LISTID") AS
  SELECT
  p.hrm_person_id,
  trunc((hrm_functions.ageingivenperiod(h.his_pay_period, p.per_birth_date)-1)/10)*10 + 10,
  p.per_gender,
  h.his_pay_sum_val,
  to_char(h.his_pay_period, 'yyyymm'),
  c.hrm_control_list_id
FROM
  hrm_person p,
  hrm_history h2,
  hrm_history_detail h,
  hrm_control_elements c
WHERE
  h.hrm_elements_id = c.hrm_control_elements_id and
  p.hrm_person_id = h.hrm_employee_id and
  h2.hrm_employee_id = h.hrm_employee_id and
  h2.hit_pay_num = h.his_pay_num and
  h2.hrm_salary_sheet_id = h.hrm_salary_sheet_id and
  h2.hit_reversal = 0 and h2.hit_reversed = 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_SALARY_EVOLUTION" ("ORA_SESSION", "XLABEL", "XVALUE", "SERIE_LABEL", "SERIE_ID", "SERIE_YVALUE") AS
  SELECT
  sev_ora_session_id,
  sev_xlabel,
  sev_xvalue,
  sev_serie_label,
  sev_serie_label||to_char(sev_serie_id) serie_id,
  sev_serie_yvalue
FROM
  hrm_salary_evolution




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_SALARY_SHEET_ROOT" ("ROOTID", "NAME", "STATCODE", "DESCR", "UPPERDESCR", "LANGID", "ELEMID", "SHEETID", "SHEET_DESCR", "SHEET_LANGID", "IS_VARIABLE", "PRINT_CHECK") AS
  SELECT
  r.hrm_elements_root_id,
  r.elr_root_name,
  r.elr_root_code,
  rd.erd_descr,
  upper(rd.erd_descr),
  rd.pc_lang_id,
  f.hrm_elements_id,
  se.hrm_salary_sheet_id,
  nvl(sd.ssd_descr, s.sal_code),
  sd.pc_lang_id,
  decode (f.hrm_elements_prefixes_id, 'EM', 'TRUE', 'FALSE'),
  'X'
FROM
  hrm_salary_description sd,
  hrm_salary_sheet s,
  hrm_elements_root_descr rd,
  hrm_elements_root r,
  hrm_elements_family f,
  hrm_salary_sheet_elements se
WHERE
  f.hrm_elements_id = se.hrm_elements_id
  and r.hrm_elements_root_id = f.hrm_elements_root_id
  and rd.hrm_elements_root_id = r.hrm_elements_root_id
  and s.hrm_salary_sheet_id = se.hrm_salary_sheet_id
  and sd.hrm_salary_sheet_id (+) = s.hrm_salary_sheet_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_SALARY_STAT" ("HRM_PERSON_ID", "PERNAME", "BIRTH_YEAR", "SEX", "CIVIL_STATE", "NATIONALITY", "WRK_POSTAL_CODE", "TRAINING", "QUALIF", "PROF_POSITION", "ACTIVITY", "SALARY_CONTRACT", "SALARY_TYPE", "LISTID", "ELEMID", "CODE", "BOX", "HISSUMVAL", "HISTXTVAL", "HISPERIOD", "HISPERIODYYYY", "HISPERIODMM", "PAYNUM", "EMPGROUP", "SEARCHNAME") AS
  SELECT
  p.hrm_person_id,
  per_last_name||' '||per_first_name,
  nvl(to_char(per_birth_date, 'yyyy'), '0000') birthyear,
  decode(upper(per_gender), 'M', '1', '2') sex,
  decode(upper(c_civil_status),'CEL', '1', 'MAR', '2', '3') civil_state,
  decode(upper(dic_nationality_id), 'CH', '1',
      decode(upper(wp.dic_work_permit_id), 'A', '2', 'B', '3', 'C', '4', 'G', '5', 'L', '2', '6')) nationality,
  p.per_businesspostalcode wrk_postal_code,
  nvl(c_ofs_training, '0') training,
  nvl(c_ofs_job_qualif, '0') qualif,
  nvl(c_ofs_responsability, '0') prof_position,
  nvl(c_ofs_activity, '00') activity,
  nvl(c_ofs_salary_contract, '0') salary_contract,
  nvl(c_ofs_salary_type, '0') salary_type,
  ce.hrm_control_list_id,
  ce.hrm_control_elements_id,
  ce.coe_code,
  ce.coe_box,
  decode(ce.coe_inverse, 0, h.his_pay_sum_val, h.his_pay_sum_val * -1),
  h.his_pay_value,
  h.his_pay_period,
  to_char(h.his_pay_period, 'yyyy'),
  to_char(h.his_pay_period, 'mm'),
  h.his_pay_num,
  per_search_name||to_char(p.hrm_person_id),
  p.per_search_name
FROM
  (SELECT hrm_person_id, dic_work_permit_id, wop_valid_from, nvl(wop_valid_to, hrm_date.activeperiodenddate) wop_valid_to
   FROM hrm_employee_wk_permit) wp,
  hrm_person p,
  hrm_history_detail h,
  hrm_control_elements ce
WHERE
  p.hrm_person_id = h.hrm_employee_id AND
  h.hrm_elements_id = ce.hrm_control_elements_id AND
  h.hrm_employee_id = wp.hrm_person_id(+) AND
  h.his_pay_period >= wp.wop_valid_from(+) AND
  h.his_pay_period <= wp.wop_valid_to(+) AND
  p.emp_ofs_included = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_TAUX_OCC" ("EMPID", "EMPNAME", "TAUX") AS
  SELECT
  a.hrm_person_id empid,
  a.per_fullname empname,
  nvl(b.emc_value,100) taux
FROM
  hrm_person a,
  hrm_employee_const b
WHERE
  a.hrm_person_id=b.hrm_employee_id(+) and
  b.hrm_constants_id(+)=959 --ConEmTauxOcc




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_TRAINING_CATEG" ("CATEG1_ID", "CATEG1_DESCR", "CATEG1_LANGID", "CATEG2_ID", "CATEG2_DESCR", "CATEG2_LANGID") AS
  SELECT
  a.dic_training_categ1_id CATEG1_ID,
  aa.dit_descr CATEG1_DESCR,
  aa.pc_lang_id CATEG1_LANGID,
  b.dic_training_categ2_id CATEG2_ID,
  bb.dit_descr CATEG2_DESCR,
  bb.pc_lang_id CATEG2_LANGID
FROM
  dic_training_categ1 a,
  dico_description aa,
  dic_training_categ2 b,
  dico_description bb
WHERE
  a.dic_training_categ1_id=b.dic_training_categ1_id(+) AND
  aa.DIT_TABLE = 'DIC_TRAINING_CATEG1' AND
  aa.DIT_CODE = a.DIC_TRAINING_CATEG1_ID AND
  bb.DIT_TABLE(+) = 'DIC_TRAINING_CATEG2' AND
  bb.DIT_CODE(+) = b.DIC_TRAINING_CATEG2_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_TRAINING_PUBLIC" ("TYPE_ID", "TYPE_DESCR", "LANGID") AS
  SELECT
  a.dic_training_public_id PUBLIC_ID,
  b.dit_descr PUBLIC_DESCR,
  b.pc_lang_id
FROM
  dic_training_public a,
  dico_description b
WHERE
  a.dic_training_public_id = b.DIT_CODE AND
  b.DIT_TABLE = 'DIC_TRAINING_PUBLIC'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_TRAINING_TYPE" ("TYPE_ID", "TYPE_DESCR", "LANGID") AS
  SELECT
  a.dic_training_type_id TYPE_ID,
  b.dit_descr TYPE_DESCR,
  b.pc_lang_id
FROM
  dic_training_type a,
  dico_description b
WHERE
  a.dic_training_type_id = b.DIT_CODE AND
  b.DIT_TABLE = 'DIC_TRAINING_TYPE'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_REP_VAR_HISTO" ("HRM_ELEMENTS_ID", "HRM_EMPLOYEE_ID", "SUM_VAL", "VALUE", "HISPERIODYYYYMM", "ERD_DESCR", "PC_LANG_ID", "STATCODE", "UPPERDESCR", "ELE_GROUP", "PRECISION") AS
  SELECT
  h.hrm_elements_id,
  h.hrm_employee_id,
  case when r.elr_format = 1 then h.his_pay_sum_val end sum_val,
  case when r.elr_format <> 1 then h.his_pay_value end value,
  to_char(his_pay_period, 'YYYYMM'),
  rd.erd_descr,
  rd.pc_lang_id,
  r.elr_root_code,
  upper(rd.erd_descr),
  r.elr_root_code||to_char(h.hrm_elements_id) ele_group,
  r.elr_input_precision
FROM
  hrm_elements_root_descr rd,
  hrm_history_detail h,
  hrm_elements_family f,
  hrm_elements_root r
WHERE
  rd.hrm_elements_root_id = f.hrm_elements_root_id AND
  h.hrm_elements_id(+) = f.hrm_elements_id AND
  f.hrm_elements_prefixes_id = 'EM' AND
  f.hrm_elements_root_id = r.hrm_elements_root_id AND
  r.c_root_variant in ('VarConst','Var') AND
  lower(r.elr_root_name) <> 'mois'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_TAX_CERTIF" ("ELEMCODE", "BOX", "LISTID", "NLISTID", "HISVAL", "HISVALTXT", "HISPERIOD", "SECUNO", "WORKPLACE", "DEPARTMENT", "EMPID", "EMPNAME", "ACTIVITY", "ADDRESS", "ADDCITY", "HISYEARPERIOD", "CARRIER_FREE", "MEATS_COST_SHARE", "CANTEEN", "STOCK_OPTIONS", "COPYTYPE", "TITLE", "SEARCHNAME", "UPPERNAME", "EMPGROUP", "COMPANY_CAR", "SEASON_TICKET") AS
  select
  C.COE_CODE,
  C.COE_BOX,
  to_char(C.HRM_CONTROL_LIST_ID),
  C.HRM_CONTROL_LIST_ID,
  H.HIS_PAY_SUM_VAL,
  H.HIS_PAY_VALUE,
  H.HIS_PAY_PERIOD,
  Nvl(P.EMP_SOCIAL_SECURITYNO2, P.EMP_SOCIAL_SECURITYNO),
  P.DIC_WORKPLACE_ID,
  P.DIC_DEPARTMENT_ID,
  H.HRM_EMPLOYEE_ID,
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.DIC_JOB_ACTIVITY_ID,
  case
    when PER_TAXPOSTALCODE is null then
      case PER_MAIL_ADD_SELECTOR
        when 0 then PER_BUSINESSSTREET
        when 1 then PER_HOMESTREET
        when 2 then PER_OTHERSTREET
      end
    else PER_TAXSTREET
  end,
  case
    when PER_TAXPOSTALCODE is null then
      case PER_MAIL_ADD_SELECTOR
        when 0 then PER_BUSINESSPOSTALCODE||' '||PER_BUSINESSCITY
        when 1 then PER_HOMEPOSTALCODE||' '||PER_HOMECITY
        when 2 then PER_OTHERPOSTALCODE||' '||PER_OTHERCITY
      end
    else PER_TAXPOSTALCODE||' '||PER_TAXCITY
  end,
  to_char(H.HIS_PAY_PERIOD, 'YYYY'),
  TAX.EMP_CARRIER_FREE,
  P.EMP_MEATS_COST_SHARE,
  TAX.EMP_CANTEEN,
  P.EMP_STOCK_OPTIONS,
  D.COPYTYPE,
  P.PER_TITLE,
  P.PER_SEARCH_NAME,
  Upper(P.PER_LAST_NAME||' '||P.PER_FIRST_NAME),
  P.PER_SEARCH_NAME||to_char(P.HRM_PERSON_ID),
  P.EMP_COMPANY_CAR,
  P.EMP_SEASON_TICKET
from
  HRM_PERSON P,
  (    select max(HRM_PERSON_ID) HRM_PERSON_ID
            , EMP_CARRIER_FREE
            , EMP_CANTEEN
            , EMP_CERTIF_OBSERVATION
         from HRM_PERSON_TAX
     group by HRM_PERSON_ID, EMP_CARRIER_FREE, EMP_CANTEEN, EMP_CERTIF_OBSERVATION) TAX,
  HRM_HISTORY_DETAIL H,
  HRM_CONTROL_ELEMENTS C,
  (select '1' COPYTYPE from DUAL union all
   select '2' COPYTYPE from DUAL union all
   select '3' COPYTYPE from DUAL) D
where
  P.HRM_PERSON_ID = H.HRM_EMPLOYEE_ID and
  TAX.HRM_PERSON_ID = P.HRM_PERSON_ID and
  H.HIS_DEFINITIVE = 1 and
  H.HRM_ELEMENTS_ID = C.HRM_CONTROL_ELEMENTS_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_TAX_PERSON" ("PER_FULLNAME", "PER_TITLE", "PER_SEARCH_NAME", "EMP_SOCIAL_SECURITYNO", "EMP_SOCIAL_SECURITYNO2", "PC_LANG_ID", "LANG", "EMP_TAX_FEES_DATE", "EMP_TAX_CAR_DATE", "HRM_PERSON_ID", "PER_BIRTH_DATE", "C_HRM_TAX_CERTIF_TYPE", "C_HRM_CANTON_TAX_CAR", "EMP_TAX_FULLFILLED", "C_HRM_CANTON_TAX_SHARE", "EMP_TAX_SHARE_DATE", "DIC_HRM_TAX_SHARE_REASON_ID", "EMP_TAX_EXPAT_EXPENSES", "EMP_TAX_OTHER_BENEFITS", "C_HRM_CANTON_TAX_FEES", "EMP_TAX_THIRD_SHARE", "EMP_TAX_THIRD_SHARE_NAME", "EMP_TAX_CHILD_ALLOW_PERAVS", "EMP_TAX_RELOCATION_COSTS", "EMP_TAX_CAR_CHECK", "DIC_HRM_TAX_SHARE_REASON2_ID", "EMP_TAX_IS_EXPATRIATE", "CONTACT_NAME", "CONTACT_PHONE", "CONTACT_EMAIL", "EMP_TAX_CONTACT_ZIP", "EMP_TAX_CONTACT_CITY", "EMP_TAX_CAR_MIN_PART", "EMP_CARRIER_FREE", "EMP_CANTEEN", "EMP_TAX_REMARKS", "HRM_PERSON_TAX_ID", "PER_MAIL_ADD_SELECTED", "BAREME") AS
  select per_last_name || ' ' || per_first_name per_fullname
       , per_title
       , per_search_name
       , emp_social_securityno
       , emp_social_securityno2
       , pc_lang_id
       , hrm_lib_elm.decode_lang(p.pc_lang_id) lang
       , case
           when emp_tax_fees_date is not null
           and c_hrm_canton_tax_fees is not null then emp_tax_fees_date
         end EMP_TAX_FEES_DATE
       , case
           when emp_tax_car_date is not null
           and c_hrm_canton_tax_car is not null then emp_tax_car_date
         end EMP_TAX_CAR_DATE
       , t.HRM_PERSON_ID
       , per_birth_date
       , C_HRM_TAX_CERTIF_TYPE
       , C_HRM_CANTON_TAX_CAR
       , EMP_TAX_FULLFILLED
       , C_HRM_CANTON_TAX_SHARE
       , EMP_TAX_SHARE_DATE
       , DIC_HRM_TAX_SHARE_REASON_ID
       , EMP_TAX_EXPAT_EXPENSES
       , EMP_TAX_OTHER_BENEFITS
       , C_HRM_CANTON_TAX_FEES
       , EMP_TAX_THIRD_SHARE
       , EMP_TAX_THIRD_SHARE_NAME
       , EMP_TAX_CHILD_ALLOW_PERAVS
       , EMP_TAX_RELOCATION_COSTS
       , EMP_TAX_CAR_CHECK
       , DIC_HRM_TAX_SHARE_REASON2_ID
       , EMP_TAX_IS_EXPATRIATE
       , EMP_TAX_CONTACT_NAME contact_name
       , EMP_TAX_CONTACT_PHONE contact_phone
       , EMP_TAX_CONTACT_EMAIL contact_email
       , EMP_TAX_CONTACT_ZIP
       , EMP_TAX_CONTACT_CITY
       , EMP_TAX_CAR_MIN_PART
       , EMP_CARRIER_FREE
       , EMP_CANTEEN
       , trim(both ';' from nvl2(EMP_CERTIF_OBSERVATION, emp_certif_observation || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE01, EMP_TAX_REMARK_LINE01 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE02, EMP_TAX_REMARK_LINE02 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE03, EMP_TAX_REMARK_LINE03 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE04, EMP_TAX_REMARK_LINE04 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE05, EMP_TAX_REMARK_LINE05 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE06, EMP_TAX_REMARK_LINE06 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE07, EMP_TAX_REMARK_LINE07 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE08, EMP_TAX_REMARK_LINE08 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE09, EMP_TAX_REMARK_LINE09 || ';', '') ||
                            nvl2(EMP_TAX_REMARK_LINE10, EMP_TAX_REMARK_LINE10 || ';', '')
             ) emp_tax_remarks
       , HRM_PERSON_TAX_Id
       , case
           when p.per_taxpostalcode is null then case p.per_mail_add_selector
                                                  when 0 then case
                                                                when p.per_businessstreet is not null then p.per_businessstreet || chr(10)
                                                              end ||
                                                              p.per_businesspostalcode ||
                                                              ' ' ||
                                                              p.per_businesscity ||
                                                              case
                                                                when p.per_businesscountry is not null
                                                                and instr('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz'
                                                                        , '|' || upper(p.per_businesscountry) || '|'
                                                                         ) = 0 then chr(10) || p.per_businesscountry
                                                              end
                                                  when 1 then case
                                                                when p.per_homestreet is not null then p.per_homestreet || chr(10)
                                                              end ||
                                                              p.per_homepostalcode ||
                                                              ' ' ||
                                                              p.per_homecity ||
                                                              case
                                                                when p.per_homecountry is not null
                                                                and instr('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz'
                                                                        , '|' || upper(p.per_homecountry) || '|'
                                                                         ) = 0 then chr(10) || p.per_homecountry
                                                              end
                                                  when 2 then case
                                                                when p.per_otherstreet is not null then p.per_otherstreet || chr(10)
                                                              end ||
                                                              p.per_otherpostalcode ||
                                                              ' ' ||
                                                              p.per_othercity ||
                                                              case
                                                                when p.per_othercountry is not null
                                                                and instr('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz'
                                                                        , '|' || upper(p.per_othercountry) || '|'
                                                                         ) = 0 then chr(10) || p.per_othercountry
                                                              end
                                                end
           else case
                  when p.per_taxstreet is not null then p.per_taxstreet || chr(10)
                end ||
                p.per_taxpostalcode ||
                ' ' ||
                p.per_taxcity ||
                case
                  when p.per_taxcountry is not null
                  and instr('Suisse|Switzerland|Suiza|Sveits|Sviss|Svizzera|Schweiz', '|' || upper(p.per_taxcountry) || '|') = 0 then chr(10)
                                                                                                                                      || p.per_taxcountry
                end
         end per_mail_add_selected
       , hrm_prc_rep_list.get_last_taxcode(p.hrm_person_id) bareme
    from hrm_person_tax t
       , hrm_person p
   where emp_tax_year = HRM_ELM.GET_PERIOD
     and t.hrm_person_id = p.hrm_person_id


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_HRM_TO_PAY_LIST" ("EMP_ID", "SALARY_SHEET", "PAY_NUM", "PERIOD", "VAL") AS
  SELECT
  a.hrm_employee_id,
  a.hrm_salary_sheet_id,
  a.his_pay_num,
  a.his_pay_period,
  a.his_pay_sum_val
FROM
  hrm_history_detail a,
  hrm_elements b
WHERE
  b.hrm_elements_id = a.hrm_elements_id and
  lower(b.ele_code) like 'cemmontantpaye' and
  a.his_paid=0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_ACT_FINANCIAL_IMPUTATION" ("ACT_FINANCIAL_IMPUTATION_ID", "ACS_PERIOD_ID", "ACT_DOCUMENT_ID", "ACS_FINANCIAL_ACCOUNT_ID", "IMF_ACS_DIVISION_ACCOUNT_ID", "DOC_RECORD_ID", "ACC_NUMBER", "DIC_FIN_ACC_CODE_6_ID", "ACC_DESCR", "ACC_DESCR_EN", "DIV_NUMBER", "DIV_DESCR", "RCO_TITLE", "RCO_DESCRIPTION", "IMF_TYPE", "IMF_PRIMARY", "DOC_NUMBER", "JOU_NUMBER", "JOU_DESCRIPTION", "IMF_DESCRIPTION", "MB", "IMF_AMOUNT_LC_D", "IMF_AMOUNT_LC_C", "IMF_EXCHANGE_RATE", "ME", "IMF_AMOUNT_FC_D", "IMF_AMOUNT_FC_C", "IMF_AMOUNT_EUR_D", "IMF_AMOUNT_EUR_C", "IMF_VALUE_DATE", "ACS_TAX_CODE_ID", "IMF_TRANSACTION_DATE", "ACS_FINANCIAL_CURRENCY_ID", "C_GENRE_TRANSACTION", "A_CONFIRM", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "ACS_AUXILIARY_ACCOUNT_ID", "ACT_DET_PAYMENT_ID", "ACS_ACS_FINANCIAL_CURRENCY_ID", "IMF_GENRE", "IMF_BASE_PRICE", "ACT_PART_IMPUTATION_ID", "OFFSET_ENTRY_ACC_NUM", "IMF_TEXT1", "IMF_TEXT2", "IMF_TEXT3", "IMF_TEXT4", "IMF_TEXT5", "IMF_NUMBER", "IMF_NUMBER2", "IMF_NUMBER3", "IMF_NUMBER4", "IMF_NUMBER5", "DIC_IMP_FREE1_ID", "DIC_IMP_FREE2_ID", "DIC_IMP_FREE3_ID", "DIC_IMP_FREE4_ID", "DIC_IMP_FREE5_ID", "GCO_GOOD_ID", "HRM_PERSON_ID", "FAM_FIXED_ASSETS_ID", "C_FAM_TRANSACTION_TYP", "IMP_PAC_PERSON_ID", "ACS_DIVISION_ACCOUNT_ID", "PAC_PERSON_ID", "PER_SHORT_NAME", "PER_NAME", "FINANCIAL_IMPUTATION_ID", "IMF_COMPARE_DATE", "ACT_JOURNAL_ID", "PER_NO_PERIOD", "FYE_NO_EXERCICE", "ACS_FINANCIAL_YEAR_ID", "C_TYPE_CUMUL_ACC", "C_TYPE_CUMUL_REC", "C_TYPE_CUMUL_PAY", "C_TYPE_CATALOGUE", "CAT_DESCRIPTION") AS
  SELECT IMP.ACT_FINANCIAL_IMPUTATION_ID,
       IMP.ACS_PERIOD_ID,
       IMP.ACT_DOCUMENT_ID,
       IMP.ACS_FINANCIAL_ACCOUNT_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID,
       IMP.DOC_RECORD_ID,
       (select acc_number from acs_account a where a.acs_account_id=IMP.ACS_FINANCIAL_ACCOUNT_ID) acc_number,
       (select DIC_FIN_ACC_CODE_6_ID from acs_financial_account a where a.acs_financial_account_id=IMP.ACS_FINANCIAL_ACCOUNT_ID) DIC_FIN_ACC_CODE_6_ID,
       (select des_description_summary from acs_description des where imp.acs_financial_account_id=des.acs_account_id and des.pc_lang_id=1) acc_descr,
       (select des_description_summary from acs_description des where imp.acs_financial_account_id=des.acs_account_id and des.pc_lang_id=3) acc_descr_en,
       ACC.ACC_NUMBER DIV_NUMBER,
       (select des_description_summary from acs_description des where IMP.IMF_ACS_DIVISION_ACCOUNT_ID=des.acs_account_id and des.pc_lang_id=1) div_descr,
       (select rco_title from doc_record rec where rec.doc_record_id=IMP.DOC_RECORD_ID) rco_title,
       (select rco_description from doc_record rec where rec.doc_record_id=IMP.DOC_RECORD_ID) rco_description,
       IMP.IMF_TYPE,
       IMP.IMF_PRIMARY,
       DOC.DOC_NUMBER,
       (SELECT JOU.JOU_NUMBER FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_NUMBER,
(SELECT JOU.JOU_DESCRIPTION FROM ACT_JOURNAL JOU WHERE JOU.ACT_JOURNAL_ID = DOC.ACT_JOURNAL_ID) JOU_DESCRIPTION,
       IMP.IMF_DESCRIPTION,
       (select currency
        from acs_financial_currency fcur, pcs.pc_curr cur
        where imp.acs_acs_financial_currency_id=fcur.acs_financial_currency_id
        and fcur.pc_curr_id=cur.pc_curr_id) MB,
       IMP.IMF_AMOUNT_LC_D,
       IMP.IMF_AMOUNT_LC_C,
       IMP.IMF_EXCHANGE_RATE,
       (select currency
        from acs_financial_currency fcur, pcs.pc_curr cur
        where imp.acs_financial_currency_id=fcur.acs_financial_currency_id
        and fcur.pc_curr_id=cur.pc_curr_id) ME,
       IMP.IMF_AMOUNT_FC_D,
       IMP.IMF_AMOUNT_FC_C,
       IMP.IMF_AMOUNT_EUR_D,
       IMP.IMF_AMOUNT_EUR_C,
       IMP.IMF_VALUE_DATE,
       IMP.ACS_TAX_CODE_ID,
       IMP.IMF_TRANSACTION_DATE,
       IMP.ACS_FINANCIAL_CURRENCY_ID,
       IMP.C_GENRE_TRANSACTION,
       IMP.A_CONFIRM,
       IMP.A_DATECRE,
       IMP.A_DATEMOD,
       IMP.A_IDCRE,
       IMP.A_IDMOD,
       IMP.A_RECLEVEL,
       IMP.A_RECSTATUS,
       nvl(nvl(CUST.ACS_AUXILIARY_ACCOUNT_ID,SUPP.ACS_AUXILIARY_ACCOUNT_ID),IMP.ACS_AUXILIARY_ACCOUNT_ID) AS ACS_AUXILIARY_ACCOUNT_ID,
       IMP.ACT_DET_PAYMENT_ID,
       IMP.ACS_ACS_FINANCIAL_CURRENCY_ID,
       IMP.IMF_GENRE,
       IMP.IMF_BASE_PRICE,
       IMP.ACT_PART_IMPUTATION_ID,
       (select acc.acc_number
        from act_financial_imputation imp2, acs_account acc
        where ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID)=imp2.act_financial_imputation_id
        and imp2.acs_financial_account_id=acc.acs_account_id) OFFSET_ENTRY_ACC_NUM,
       IMP.IMF_TEXT1,
       IMP.IMF_TEXT2,
       IMP.IMF_TEXT3,
       IMP.IMF_TEXT4,
       IMP.IMF_TEXT5,
       IMP.IMF_NUMBER,
       IMP.IMF_NUMBER2,
       IMP.IMF_NUMBER3,
       IMP.IMF_NUMBER4,
       IMP.IMF_NUMBER5,
       IMP.DIC_IMP_FREE1_ID,
       IMP.DIC_IMP_FREE2_ID,
       IMP.DIC_IMP_FREE3_ID,
       IMP.DIC_IMP_FREE4_ID,
       IMP.DIC_IMP_FREE5_ID,
       IMP.GCO_GOOD_ID,
       IMP.HRM_PERSON_ID,
       IMP.FAM_FIXED_ASSETS_ID,
       IMP.C_FAM_TRANSACTION_TYP,
       IMP.PAC_PERSON_ID IMP_PAC_PERSON_ID,
       IMP.IMF_ACS_DIVISION_ACCOUNT_ID ACS_DIVISION_ACCOUNT_ID,
       nvl(CUST.PAC_CUSTOM_PARTNER_ID,SUPP.PAC_SUPPLIER_PARTNER_ID) AS PAC_PERSON_ID,
       (select per_short_name
        from pac_person p
        where p.pac_person_id=nvl(CUST.PAC_CUSTOM_PARTNER_ID,SUPP.PAC_SUPPLIER_PARTNER_ID)) per_short_name,
       (select per_name
        from pac_person p
        where p.pac_person_id=nvl(CUST.PAC_CUSTOM_PARTNER_ID,SUPP.PAC_SUPPLIER_PARTNER_ID)) per_name,
       ACR_FUNCTIONS.GetFinancialImputationId(IMP.ACT_FINANCIAL_IMPUTATION_ID) FINANCIAL_IMPUTATION_ID,
       IMP.IMF_COMPARE_DATE,
       DOC.ACT_JOURNAL_ID,
       PER.PER_NO_PERIOD,
       YEA.FYE_NO_EXERCICE,
       PER.ACS_FINANCIAL_YEAR_ID,
       (SELECT C_TYPE_CUMUL FROM ACJ_SUB_SET_CAT SUB WHERE SUB.C_SUB_SET = 'ACC' AND SUB.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID) C_TYPE_CUMUL_ACC,
       (SELECT C_TYPE_CUMUL FROM ACJ_SUB_SET_CAT SUB WHERE SUB.C_SUB_SET = 'REC' AND SUB.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID) C_TYPE_CUMUL_REC,
       (SELECT C_TYPE_CUMUL FROM ACJ_SUB_SET_CAT SUB WHERE SUB.C_SUB_SET = 'PAY' AND SUB.ACJ_CATALOGUE_DOCUMENT_ID = CAT.ACJ_CATALOGUE_DOCUMENT_ID) C_TYPE_CUMUL_PAY,
       CAT.C_TYPE_CATALOGUE,
       CAT.CAT_DESCrIPTION
from PAC_SUPPLIER_PARTNER SUPP,
     PAC_CUSTOM_PARTNER CUST,
     ACT_PART_IMPUTATION PART,
     ACT_DOCUMENT DOC,
     ACS_ACCOUNT ACC,
     ACJ_CATALOGUE_DOCUMENT CAT,
     ACS_PERIOD PER,
     ACT_FINANCIAL_IMPUTATION IMP,
     ACS_FINANCIAL_YEAR YEA
 where PART.PAC_CUSTOM_PARTNER_ID      = CUST.PAC_CUSTOM_PARTNER_ID(+)
   and PART.PAC_SUPPLIER_PARTNER_ID    = SUPP.PAC_SUPPLIER_PARTNER_ID(+)
   and IMP.ACT_PART_IMPUTATION_ID      = PART.ACT_PART_IMPUTATION_ID(+)
   and IMP.IMF_ACS_DIVISION_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID(+)
   and IMP.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
   and IMP.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID
   and DOC.ACJ_CATALOGUE_DOCUMENT_ID   = CAT.ACJ_CATALOGUE_DOCUMENT_ID
   and per.ACS_FINANCIAL_YEAR_ID       = YEA.ACS_FINANCIAL_YEAR_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_DOC_CTRL_RECAP" ("C_ADMIN_DOMAIN", "DOC_NUMBER", "IMF_TRANSACTION_DATE", "PERIOD", "JOU_DESCRIPTION", "DIV_NUMBER", "DIV_DESCR", "RCO_TITLE", "RCO_DESCRIPTION", "ACC_NUMBER", "ACC_DESCR", "AMOUNT_MB", "ME", "AMOUNT_ME") AS
  select
'1' C_ADMIN_DOMAIN,
DOC.DOC_NUMBER,
IMF_TRANSACTION_DATE,
YEA.FYE_NO_EXERCICE||lpad(PER.PER_NO_PERIOD,2,'0') period,
(select jou_description from act_journal jou where doc.act_journal_id=jou.act_journal_id) jou_description,
(SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = IMP.IMF_ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
(select des_description_summary from acs_description des where IMP.IMF_ACS_DIVISION_ACCOUNT_ID=des.acs_account_id and des.pc_lang_id=1) div_descr,
(select rco_title from doc_record rec where rec.doc_record_id=imp.doc_record_id) rco_title,
(select rco_description from doc_record rec where rec.doc_record_id=imp.doc_record_id) rco_description,
FIN.ACC_NUMBER,
(select des_description_summary from acs_description des where imp.acs_financial_account_id=des.acs_account_id and des.pc_lang_id=1) acc_descr,
/*(select currency
 from acs_financial_currency fcur, pcs.pc_curr cur
 where imp.acs_acs_financial_currency_id=fcur.acs_financial_currency_id
 and fcur.pc_curr_id=cur.pc_curr_id) MB,*/
IMF_AMOUNT_LC_D - IMF_AMOUNT_LC_C AMOUNT_MB,
(select currency
 from acs_financial_currency fcur, pcs.pc_curr cur
 where imp.acs_financial_currency_id=fcur.acs_financial_currency_id
 and fcur.pc_curr_id=cur.pc_curr_id) ME,
IMF_AMOUNT_FC_D - IMF_AMOUNT_FC_C AMOUNT_ME
from
ACS_PERIOD                 PER,
ACT_FINANCIAL_IMPUTATION   IMP,
ACS_ACCOUNT                FIN,
ACS_SUB_SET                SUB,
ACS_FINANCIAL_YEAR         YEA,
ACT_DOCUMENT               DOC
where
SUB.ACS_SUB_SET_ID              = FIN.ACS_SUB_SET_ID
and SUB.C_SUB_SET                   = 'ACC'
and (FIN.ACC_NUMBER  like '64%'
    or (FIN.ACC_NUMBER  like '47%'
       and not exists (select 1
                       from acj_catalogue_document cat
                       where doc.acj_catalogue_document_id=cat.acj_catalogue_document_id
                       and cat.cat_description in ('DE - Facture dbiteur (interface)','DE - Note de crdit dbiteur (interface)'))
       )
    )
--and YEA.FYE_NO_EXERCICE||lpad(PER.PER_NO_PERIOD,2,'0')>=:PERIOD_FROM
--and YEA.FYE_NO_EXERCICE||lpad(PER.PER_NO_PERIOD,2,'0')<=:PERIOD_TO
and FIN.ACS_ACCOUNT_ID              = IMP.ACS_FINANCIAL_ACCOUNT_ID
and IMP.ACS_PERIOD_ID               = PER.ACS_PERIOD_ID
and per.ACS_FINANCIAL_YEAR_ID       = YEA.ACS_FINANCIAL_YEAR_ID
AND IMP.ACT_DOCUMENT_ID             = DOC.ACT_DOCUMENT_ID
and not exists (select 1
                from acs_division_account div
                where IMP.IMF_ACS_DIVISION_ACCOUNT_ID=div.acs_division_account_id
                and div.DIC_DIV_ACC_CODE_1_ID='02')
UNION ALL
select
'2' C_ADMIN_DOMAIN,
dmt.dmt_number,
dmt.dmt_date_document,
to_char(dmt.dmt_date_document,'YYYYMM') period,
(select gau_describe from doc_gauge gau where gau.doc_gauge_id=dmt.doc_gauge_id) gau_describe,
(SELECT DIV.ACC_NUMBER FROM ACS_ACCOUNT DIV WHERE DIV.ACS_ACCOUNT_ID = POS.ACS_DIVISION_ACCOUNT_ID) DIV_NUMBER,
(select des_description_summary from acs_description des where POS.ACS_DIVISION_ACCOUNT_ID=des.acs_account_id and des.pc_lang_id=1) div_descr,
(select rco_title from doc_record rec where rec.doc_record_id=nvl(dmt.doc_record_id,pos.doc_record_id)) rco_title,
(select rco_description from doc_record rec where rec.doc_record_id=nvl(dmt.doc_record_id,pos.doc_record_id)) rco_description,
(select goo_major_reference from gco_good goo where goo.gco_good_id=pos.gco_good_id) goo_major_reference,
(select DES_LONG_DESCRIPTION from GCO_DESCRIPTION gcd where gcd.gco_good_id=pos.gco_good_id and gcd.pc_lang_id=1) DES_LONG_DESCRIPTION,
DECODE (DGS.C_GAUGE_TITLE,'9',POS_NET_VALUE_EXCL,'8',(POS_NET_VALUE_EXCL * -1),'30',(POS_NET_VALUE_EXCL * -1),0) POS_NET_VALUE_EXCL,
(select currency
 from acs_financial_currency fcur, pcs.pc_curr cur
 where dmt.acs_financial_currency_id=fcur.acs_financial_currency_id
 and fcur.pc_curr_id=cur.pc_curr_id) ME,
DECODE (DGS.C_GAUGE_TITLE,'9',POS_NET_VALUE_EXCL_E,'8',(POS_NET_VALUE_EXCL_E * -1),'30',(POS_NET_VALUE_EXCL_E * -1),0) POS_NET_VALUE_EXCL_E
from
doc_document dmt,
doc_position pos,
doc_gauge_structured dgs
where
dmt.doc_document_id=pos.doc_document_id
and dmt.doc_gauge_id=dgs.doc_gauge_id
--and to_char(dmt.dmt_date_document,'YYYYMM')>=:PERIOD_FROM
--and to_char(dmt.dmt_date_document,'YYYYMM')<=:PERIOD_TO




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_ACC_REGROUP" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ROOT_ID", "HRM_ELEMENTS_ID", "EMP_NUMBER", "PER_SEARCH_NAME", "PER_LAST_NAME", "PER_FIRST_NAME", "SAB_PAY_DATE", "PERIODYYYYMM", "SAB_ACCOUNT_NAME", "BSV_VALUE", "ELR_ROOT_CODE", "ERD_DESCR", "SAB_AMOUNT", "CURRENCY", "RATE", "SAB_AMOUNT_DEV") AS
  select
bd.hrm_employee_id,
r.hrm_elements_root_id,
r.hrm_elements_id,
emp_number,
per_search_name,
per_last_name,
per_first_name,
sab_pay_date,
to_char(sab_pay_date,'YYYYMM') periodyyyymm,
sab_account_name,
bsv.BSV_VALUE,
elr_root_code,
erd_descr,
case
 when sab_amount_type='C' then sab_amount*(-1)
 else sab_amount
end sab_amount,
nvl(hrm_itx.GET_PERS_CURR(bd.hrm_employee_id,bd.sab_pay_date),acs_function.GetLocalCurrencyName) currency,
NVL(hrm_itx.GET_PERS_RATE(bd.hrm_employee_id,bd.sab_pay_date),1) rate,
round(case
       when sab_amount_type='C' then sab_amount*(-1)
       else sab_amount
      end/nvl(hrm_itx.GET_PERS_RATE(bd.hrm_employee_id,bd.sab_pay_date),1),2) sab_amount_dev
from
hrm_salary_breakdown bd,
hrm_elements_root r,
hrm_elements_root_descr rd,
hrm_person per,
hrm_break_shift_val bsv,
hrm_break_shift bs
where
bd.hrm_elements_id=r.hrm_elements_id
and r.hrm_elements_root_id=rd.hrm_elements_root_id
and bd.hrm_employee_id=per.hrm_person_id
and sab_account_name between bsv.BSV_SOURCE_VAL and bsv.BSV_SOURCE_VAL_TO
and bsv.hrm_break_shift_id=bs.hrm_break_shift_id
and bs.BRS_CODE='RegroupAccFact'
and rd.pc_lang_id=1
and dic_account_type_id='CG'
UNION ALL
select
h.hrm_employee_id,
null hrm_elements_root_id,
null hrm_elements_id,
emp_number,
per_search_name,
per_last_name,
per_first_name,
h.hit_pay_period sab_pay_date,
to_char(h.hit_pay_period,'YYYYMM') periodyyyymm,
null sab_account_name,
bsv2.BSV_VALUE,
null elr_root_code,
null erd_descr,
0 sab_amount,
nvl(hrm_itx.GET_PERS_CURR(h.hrm_employee_id,h.hit_pay_period),acs_function.GetLocalCurrencyName) currency,
null rate,
0 sab_amount_dev
from
hrm_break_shift_val bsv2,
hrm_break_shift bs2,
hrm_history h,
hrm_person per2
where
bsv2.hrm_break_shift_id=bs2.hrm_break_shift_id
and h.hrm_employee_id=per2.hrm_person_id
and bs2.BRS_CODE='RegroupAccFact'
and not exists (select 1
			   from hrm_salary_breakdown bd,
               hrm_person per,
               hrm_break_shift_val bsv,
               hrm_break_shift bs
               where
               bd.hrm_employee_id=per.hrm_person_id
               and sab_account_name between bsv.BSV_SOURCE_VAL and bsv.BSV_SOURCE_VAL_TO
               and bsv.hrm_break_shift_id=bs.hrm_break_shift_id
               and bs.BRS_CODE='RegroupAccFact'
               and dic_account_type_id='CG'
			   and h.hrm_employee_id=bd.hrm_employee_id
			   and h.hit_pay_period=bd.sab_pay_date
			   and bsv2.BSV_VALUE=bsv.BSV_VALUE)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_ACC_REGROUP_NEW" ("HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ROOT_ID", "HRM_ELEMENTS_ID", "EMP_NUMBER", "PER_SEARCH_NAME", "PER_LAST_NAME", "PER_FIRST_NAME", "SAB_PAY_DATE", "PERIODYYYYMM", "SAB_ACCOUNT_NAME", "BSV_VALUE", "ELR_ROOT_CODE", "ERD_DESCR", "SAB_AMOUNT", "CURRENCY", "RATE", "SAB_AMOUNT_DEV") AS
  select
bd.hrm_employee_id,
r.hrm_elements_root_id,
r.hrm_elements_id,
emp_number,
per_search_name,
per_last_name,
per_first_name,
sab_pay_date,
to_char(sab_pay_date,'YYYYMM') periodyyyymm,
sab_account_name,
bsv.BSV_VALUE,
elr_root_code,
erd_descr,
case
 when sab_amount_type='C' then sab_amount*(-1)
 else sab_amount
end sab_amount,
nvl(bd.CURRENCY2,acs_function.GetLocalCurrencyName) currency,
bd.rate2 rate,
case
  when sab_amount_type='C' then sab_amount2*(-1)
  else sab_amount2
end  sab_amount_dev
from
hrm_salary_breakdown bd,
hrm_elements_root r,
hrm_elements_root_descr rd,
hrm_person per,
hrm_break_shift_val bsv,
hrm_break_shift bs
where
bd.hrm_elements_id=r.hrm_elements_id
and r.hrm_elements_root_id=rd.hrm_elements_root_id
and bd.hrm_employee_id=per.hrm_person_id
and sab_account_name between bsv.BSV_SOURCE_VAL and bsv.BSV_SOURCE_VAL_TO
and bsv.hrm_break_shift_id=bs.hrm_break_shift_id
and bs.BRS_CODE='RegroupAccFact'
and rd.pc_lang_id=1
and dic_account_type_id='CG'
UNION ALL
select
h.hrm_employee_id,
null hrm_elements_root_id,
null hrm_elements_id,
emp_number,
per_search_name,
per_last_name,
per_first_name,
h.hit_pay_period sab_pay_date,
to_char(h.hit_pay_period,'YYYYMM') periodyyyymm,
null sab_account_name,
bsv2.BSV_VALUE,
null elr_root_code,
null erd_descr,
0 sab_amount,
nvl(hrm_itx.GET_PERS_CURR(h.hrm_employee_id,h.hit_pay_period),acs_function.GetLocalCurrencyName) currency,
null rate,
0 sab_amount_dev
from
hrm_break_shift_val bsv2,
hrm_break_shift bs2,
hrm_history h,
hrm_person per2
where
bsv2.hrm_break_shift_id=bs2.hrm_break_shift_id
and h.hrm_employee_id=per2.hrm_person_id
and bs2.BRS_CODE='RegroupAccFact'
and not exists (select 1
			   from hrm_salary_breakdown bd,
               hrm_person per,
               hrm_break_shift_val bsv,
               hrm_break_shift bs
               where
               bd.hrm_employee_id=per.hrm_person_id
               and sab_account_name between bsv.BSV_SOURCE_VAL and bsv.BSV_SOURCE_VAL_TO
               and bsv.hrm_break_shift_id=bs.hrm_break_shift_id
               and bs.BRS_CODE='RegroupAccFact'
               and dic_account_type_id='CG'
			   and h.hrm_employee_id=bd.hrm_employee_id
			   and h.hit_pay_period=bd.sab_pay_date
			   and bsv2.BSV_VALUE=bsv.BSV_VALUE)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_AUGMENTATION" ("HRM_PERSON_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_FULL_NAME", "EMP_NUMBER", "DIC_DEPARTMENT_ID", "C_OFS_TRAINING", "EMP_GROUP_ENTRY", "SENIORITY", "HIT_PAY_PERIOD", "PERIOD", "CURRENCY", "SAL_MENS", "TAUX_OCC", "TAUX_HOR") AS
  select
b.hrm_person_id,
per_last_name,
per_first_name,
per_last_name||' '||per_first_name per_full_name,
emp_number,
dic_department_id,
c_ofs_training,
emp_group_entry,
hrm_functions.EmplYearMonthsInGroupWDate(b.hrm_person_id,to_char(hit_pay_period,'yyyy-mm-dd')) seniority,
hit_pay_period,
to_char(hit_pay_period,'YYYYMM') period,
hrm_itx.GET_PERS_CURR(a.hrm_employee_id,hit_pay_period) currency,
round(
  -- Salaire de base
 (nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemBasSal',hit_pay_period,hit_pay_period),0)+
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemBasSalEUR',hit_pay_period,hit_pay_period),0)+
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemBasSalUSD',hit_pay_period,hit_pay_period),0)+
  -- Salaire forfaitaire
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemSalForfait',hit_pay_period,hit_pay_period),0)+
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemSalForfaitEUR',hit_pay_period,hit_pay_period),0)+
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemSalForfaitUSD',hit_pay_period,hit_pay_period),0)+
  -- LEMS GEX
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemSalBase',hit_pay_period,hit_pay_period),0)+
  nvl(hrm_functions.sumelem(a.hrm_employee_id,'CemSalBaseForfait',hit_pay_period,hit_pay_period),0)
  )/
  nvl(hrm_itx.GET_PERS_RATE(a.hrm_employee_id,hit_pay_period),1)
 ,2) Sal_Mens,
-- Taux d'occupation: il vaut peut-tre mieux utiliser une fonction individualise sumelembydec (pour viter des 200%)
hrm_functions.sumelem(a.hrm_employee_id,'ConEmTauxOcc',hit_pay_period,hit_pay_period) Taux_Occ,
hrm_functions.sumelem(a.hrm_employee_id,'ConEmTauxHorH',hit_pay_period,hit_pay_period) Taux_hor
from
hrm_history a,
hrm_person b
where
a.hrm_employee_id=b.hrm_person_id
and emp_status='ACT'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_CGAN" ("SAB_ACCOUNT_NAME", "DIV_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "NUMBER1", "NUMBER2", "NUMBER3", "NUMBER4", "TEXT1", "TEXT2", "TEXT3", "TEXT4", "RCO_TITLE", "DIC_DEPARTMENT_ID", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "FOREIGN_DEBIT_AMOUNT", "FOREIGN_CREDIT_AMOUNT", "AMOUNT1", "CURRENCY2", "ACS_FINANCIAL_CURRENCY_ID2", "RATE2", "AMOUNT2", "DEBIT_AMOUNT_DEV", "CREDIT_AMOUNT_DEV", "SAB_AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SAB_SOURCE", "HRM_BREAK_ID", "CURRENCY", "ELE_CODE", "ELR_ROOT_CODE", "ELE_DESCR", "PERNAME", "BRK_DESCRIPTION", "HRM_ELEMENTS_ID", "HRM_PERSON_ID", "EMP_NUMBER") AS
  SELECT
  sb.sab_account_name,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'DIV') div_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'CPN') cpn_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'CDA') cda_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PF') pf_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'PJ') pj_number,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER1') number1,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER2') number2,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER3') number3,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'NUMBER4') number4,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT1') text1,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT2') text2,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT3') text3,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'TEXT4') text4,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'DOC_RECORD') rco_title,
  hrm_break_fct.get_account_number(sb.hrm_history_detail_id,sb.sab_source,sb.sab_amount_type,'FREE') dic_department_id,
  decode(sb.sab_amount_type, 'D', sb.sab_amount, 0) debit_amount,
  decode(sb.sab_amount_type, 'C', sb.sab_amount, 0) credit_amount,
  decode(sb.sab_amount_type, 'D', sb.sab_foreign_amount, 0) foreign_debit_amount,
  decode(sb.sab_amount_type, 'C', sb.sab_foreign_amount, 0) foreign_credit_amount,
  nvl(sb.sab_amount,0) amount1,
  sb.currency2,
  sb.acs_financial_currency_id2,
  sb.rate2,
  nvl(sb.sab_amount2,0) amount2,
  decode(sb.sab_amount_type, 'D', sb.sab_amount2, 0) debit_amount_dev,
  decode(sb.sab_amount_type, 'C', sb.sab_amount2, 0) credit_amount_dev,
  sb.sab_amount_type,
  sb.acs_financial_currency_id,
  sb.sab_pay_date,
  sb.hrm_history_detail_id,
  sb.sab_source,
  sb.hrm_break_id,
  c.currency,
  e.ele_code,
  r.elr_root_code,
  rd.erd_descr ele_descr,
  p.per_last_name||' '||p.per_first_name pername,
  b.brk_description,
  sb.hrm_elements_id,
  p.hrm_person_id,
  p.emp_number
from
  pcs.pc_curr c,
  acs_financial_currency fc,
  hrm_person p,
  hrm_elements e,
  hrm_elements_family f,
  hrm_elements_root r,
  hrm_salary_breakdown sb,
  hrm_break b,
  hrm_elements_root_descr rd
where
  sb.dic_account_type_id = 'CG' and
  b.hrm_break_id = sb.hrm_break_id and
  f.hrm_elements_id = sb.hrm_elements_id and
  r.hrm_elements_root_id = f.hrm_elements_root_id and
  ((lower(r.c_root_function) <> 'hours') or r.c_root_function is null) and
  e.hrm_elements_id = f.hrm_elements_id and
  p.hrm_person_id = sb.hrm_employee_id and
  fc.acs_financial_currency_id = sb.acs_financial_currency_id and
  c.pc_curr_id = fc.pc_curr_id
  and r.hrm_elements_root_id=rd.hrm_elements_root_id
  and rd.pc_lang_id=1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_CGAN_GRP" ("HRM_BREAK_ID", "BRK_DESCRIPTION", "SAB_PAY_DATE", "CG_NUMBER", "DIV_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "NUMBER1", "NUMBER2", "NUMBER3", "NUMBER4", "TEXT1", "TEXT2", "TEXT3", "TEXT4", "RCO_TITLE", "DIC_DEPARTMENT_ID", "CURRENCY2", "ACS_FINANCIAL_CURRENCY_ID2", "RATE2", "ELE_DESCR", "LDEBIT_AMOUNT", "LCREDIT_AMOUNT", "FDEBIT_AMOUNT", "FCREDIT_AMOUNT") AS
  select
hrm_break_id,
brk_description,
sab_pay_date,
SAB_ACCOUNT_NAME cg_number,
div_number,
cpn_number,
cda_number,
pf_number,
pj_number,
number1,
number2,
number3,
number4,
text1,
text2,
text3,
text4,
rco_title,
DIC_DEPARTMENT_ID,
currency2,
acs_financial_currency_id2,
rate2,
ele_descr,
sum(debit_amount) ldebit_amount,
sum(credit_amount) lcredit_amount,
sum(debit_amount_dev) fdebit_amount,
sum(credit_amount_dev) fcredit_amount
from
v_ind_hrm_break_cgan_regroup
group by hrm_break_id,
brk_description,
sab_pay_date,
SAB_ACCOUNT_NAME,
div_number,
cpn_number,
cda_number,
pf_number,
pj_number,
number1,
number2,
number3,
number4,
text1,
text2,
text3,
text4,
rco_title,
DIC_DEPARTMENT_ID,
currency2,
acs_financial_currency_id2,
rate2,
ele_descr,
sab_amount_type




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_CGAN_REGROUP" ("SAB_ACCOUNT_NAME", "DIV_NUMBER", "CPN_NUMBER", "CDA_NUMBER", "PF_NUMBER", "PJ_NUMBER", "NUMBER1", "NUMBER2", "NUMBER3", "NUMBER4", "TEXT1", "TEXT2", "TEXT3", "TEXT4", "RCO_TITLE", "DIC_DEPARTMENT_ID", "DEBIT_AMOUNT", "CREDIT_AMOUNT", "FOREIGN_DEBIT_AMOUNT", "FOREIGN_CREDIT_AMOUNT", "AMOUNT1", "CURRENCY2", "ACS_FINANCIAL_CURRENCY_ID2", "RATE2", "AMOUNT2", "DEBIT_AMOUNT_DEV", "CREDIT_AMOUNT_DEV", "SAB_AMOUNT_TYPE", "ACS_FINANCIAL_CURRENCY_ID", "SAB_PAY_DATE", "HRM_HISTORY_DETAIL_ID", "SAB_SOURCE", "HRM_BREAK_ID", "CURRENCY", "ELE_CODE", "ELR_ROOT_CODE", "ELE_DESCR", "PERNAME", "BRK_DESCRIPTION", "HRM_ELEMENTS_ID", "HRM_PERSON_ID", "EMP_NUMBER") AS
  select
a.SAB_ACCOUNT_NAME,
a.DIV_NUMBER,
a.CPN_NUMBER,
a.CDA_NUMBER,
a.PF_NUMBER,
a.PJ_NUMBER,
a.NUMBER1,
a.NUMBER2,
a.NUMBER3,
a.NUMBER4,
a.TEXT1,
a.TEXT2,
a.TEXT3,
a.TEXT4,
a.RCO_TITLE,
A.DIC_DEPARTMENT_ID,
a.DEBIT_AMOUNT,
a.CREDIT_AMOUNT,
a.FOREIGN_DEBIT_AMOUNT,
a.FOREIGN_CREDIT_AMOUNT,
a.AMOUNT1,
a.CURRENCY2,
a.ACS_FINANCIAL_CURRENCY_ID2,
a.RATE2,
a.AMOUNT2,
a.DEBIT_AMOUNT_DEV,
a.CREDIT_AMOUNT_DEV,
a.SAB_AMOUNT_TYPE,
a.ACS_FINANCIAL_CURRENCY_ID,
a.SAB_PAY_DATE,
a.HRM_HISTORY_DETAIL_ID,
a.SAB_SOURCE,
a.HRM_BREAK_ID,
a.CURRENCY,
a.ELE_CODE,
CASE
  WHEN INSTR (c.compte_detail, a.SAB_ACCOUNT_NAME) > 0 OR UPPER (c.compte_detail) = 'TOUS'
  THEN a.ELR_ROOT_CODE
   ELSE '000000'
END ELR_ROOT_CODE,
CASE
  WHEN INSTR (c.compte_detail, a.SAB_ACCOUNT_NAME) > 0 OR UPPER (c.compte_detail) = 'TOUS'
  THEN a.ele_descr
   ELSE    TO_CHAR (a.sab_pay_date, 'MM.YYYY')
        || ' '
        || b.emp_number
        || ' '
        || b.per_last_name
        || ' '
        || b.per_first_name
END ELE_DESCR,
a.PERNAME,
a.BRK_DESCRIPTION,
a.HRM_ELEMENTS_ID,
a.HRM_PERSON_ID,
a.EMP_NUMBER
from
V_IND_HRM_BREAK_CGAN a,
hrm_person b,
(SELECT MAX (compte_detail) compte_detail
 FROM ind_hrm_break_param_det) c
where
a.hrm_person_id=b.hrm_person_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_CGDIV2" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_FOREIGN_AMOUNT", "V_HBC_DEBIT_FOREIGN_AMOUNT", "V_HBC_CREDIT_FOREIGN_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "HRM_EMPLOYEE_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "SOURCE", "VALUE_DATE", "BREAK_DATE", "CURRENCY2", "ACS_FINANCIAL_CURRENCY_ID2", "V_HBC_AMOUNT_ME", "V_HBC_DEBIT_AMOUNT_ME", "V_HBC_CREDIT_AMOUNT_ME") AS
  SELECT
  t1.hrm_history_detail_id,
  t1.hrm_break_id,
  t1.hrm_elements_id,
  t1.sab_account_id v_hbc_ACC_NUM,
  t1.sab_account_name v_hbc_ACC_NAME,
  t2.sab_account_id v_hbc_DIV_NUM,
  t2.sab_account_name v_hbc_DIV_NAME,
  nvl(t2.sab_amount, t1.sab_amount) v_hbc_AMOUNT,
  decode(t1.sab_amount_type, 'D', nvl(t2.sab_amount, t1.sab_amount), 'C', 0) v_hbc_Debit_amount,
  decode(t1.sab_amount_type, 'C', nvl(t2.sab_amount, t1.sab_amount), 'D', 0) v_hbc_Credit_amount,
  nvl(t2.sab_foreign_amount, t1.sab_foreign_amount) v_hbc_foreign_AMOUNT,
  decode(t1.sab_amount_type, 'D', nvl(t2.sab_foreign_amount, t1.sab_foreign_amount), 'C', 0) V_HBC_DEBIT_FOREIGN_AMOUNT,
  decode(t1.sab_amount_type, 'C', nvl(t2.sab_foreign_amount, t1.sab_foreign_amount), 'D', 0) V_HBC_CREDIT_FOREIGN_AMOUNT,
  t1.sab_amount_type v_hbc_AMOUNT_TYPE,
  t1.sab_pay_date,
  t1.sab_ref_value,
  t1.sab_zl,
  p.currency,
  t1.HRM_EMPLOYEE_ID,
  ele_code,
  brk_description,
  ele_code,
  ele_stat_code,
  t1.sab_source,
  b.brk_value_date,
  b.brk_break_date,
  t1.currency2,
  t1.acs_financial_currency_id2,
  nvl(t2.sab_amount2, t1.sab_amount2) v_hbc_AMOUNT_ME,
  decode(t1.sab_amount_type, 'D', nvl(t2.sab_amount2, t1.sab_amount2), 'C', 0) v_hbc_Debit_amount_me,
  decode(t1.sab_amount_type, 'C', nvl(t2.sab_amount2, t1.sab_amount2), 'D', 0) v_hbc_Credit_amount_me
FROM
  hrm_break B,
  hrm_elements c,
  hrm_salary_breakdown t1,
  hrm_salary_breakdown t2,
  ACS_Financial_currency t3,
  PCS.PC_CURR p
WHERE
  B.HRM_BREAK_ID = t1.hrm_break_id AND
  C.HRM_ELEMENTS_ID = t1.hrm_elements_id AND
  t1.hrm_break_id = t2.hrm_break_id(+) AND
  t1.dic_account_type_id = 'CG' AND
  t2.dic_account_type_id(+) = 'DIV' AND
  t1.ACS_FINANCIAL_CURRENCY_ID = t3.ACS_FINANCIAL_CURRENCY_ID AND
  t3.pc_curr_id = p.pc_curr_id AND
  t2.sab_amount_type(+) = t1.sab_amount_type AND
  t2.sab_source(+) = t1.sab_source AND
  t1.hrm_history_detail_id = t2.hrm_history_detail_id(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_CTRL_TOT" ("CPV_NAME", "CPD_TEXT1", "ACC_NUMBER", "SAB_PAY_DATE", "PERIOD_YYYYMM", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "DIFFERENCE") AS
  SELECT
acc.cpv_name,
acc.cpd_text1,
acc.acc_number,
sab_pay_date,
TO_CHAR (sab_pay_date, 'YYYYMM') period_yyyymm,
v_hbc_debit_amount,
v_hbc_credit_amount,
v_hbc_credit_amount - v_hbc_debit_amount difference
FROM
(select b.cpv_name, c.cpd_text1, '421' || b.cpv_name acc_number
 from com_cpy_codes a, com_cpy_codes_value b,com_cpy_codes_value_descr c
 where a.com_cpy_codes_id = b.com_cpy_codes_id
 AND b.com_cpy_codes_value_id = c.com_cpy_codes_value_id
 AND a.cpc_name = 'DEV_SHIFT'
 AND c.pc_lang_id = 1
 UNION ALL
 select '299',null,'421299'
 from dual) acc,
(SELECT   v_hbc_acc_name, sab_pay_date,
        SUM (v_hbc_debit_amount) v_hbc_debit_amount,
        SUM (v_hbc_credit_amount) v_hbc_credit_amount,
        SUM (v_hbc_debit_amount_dev) v_hbc_debit_amount_dev,
        SUM (v_hbc_credit_amount_dev) v_hbc_credit_amount_dev
   FROM v_ind_hrm_break_transfert
  GROUP BY v_hbc_acc_name, sab_pay_date) amo
WHERE
acc.acc_number = amo.v_hbc_acc_name




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_CTRL_TOT_NEW" ("CPV_NAME", "CPD_TEXT1", "ACC_NUMBER", "SAB_PAY_DATE", "PERIOD_YYYYMM", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "DIFFERENCE", "CURRENCY", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV", "DIFFERENCE_DEV") AS
  SELECT
acc.cpv_name,
acc.cpd_text1,
acc.acc_number,
sab_pay_date,
TO_CHAR (sab_pay_date, 'YYYYMM') period_yyyymm,
v_hbc_debit_amount,
v_hbc_credit_amount,
v_hbc_credit_amount - v_hbc_debit_amount difference,
currency2 currency,
v_hbc_debit_amount_dev,
v_hbc_credit_amount_dev,
v_hbc_credit_amount_dev - v_hbc_debit_amount_dev difference_dev
FROM
(select b.cpv_name, c.cpd_text1, '421' || b.cpv_name acc_number
 from com_cpy_codes a, com_cpy_codes_value b,com_cpy_codes_value_descr c
 where a.com_cpy_codes_id = b.com_cpy_codes_id
 AND b.com_cpy_codes_value_id = c.com_cpy_codes_value_id
 AND a.cpc_name = 'DEV_SHIFT'
 AND c.pc_lang_id = 1
 UNION ALL
 select '299',null,'421299'
 from dual) acc,
(SELECT   SAB_ACCOUNT_NAME, sab_pay_date,CURRENCY2,
        SUM (DEBIT_AMOUNT) v_hbc_debit_amount,
        SUM (CREDIT_AMOUNT) v_hbc_credit_amount,
        SUM (DEBIT_AMOUNT_dev) v_hbc_debit_amount_dev,
        SUM (CREDIT_AMOUNT_dev) v_hbc_credit_amount_dev
   FROM V_IND_HRM_BREAK_CGAN
  GROUP BY SAB_ACCOUNT_NAME, sab_pay_date,CURRENCY2) amo
WHERE
acc.acc_number = amo.SAB_ACCOUNT_NAME




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_DETAIL" ("EMP_NUMBER", "HEB_DIV_NUMBER", "RCO_TITLE", "DIC_DEPARTMENT_ID", "HRM_BREAK_ID", "HRM_HISTORY_DETAIL_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NAME", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "HRM_EMPLOYEE_ID", "BREAK_DATE", "VALUE_DATE", "CURRENCY", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT") AS
  SELECT
    (SELECT emp_number
    FROM hrm_person p
    WHERE p.hrm_person_id=sb.hrm_employee_id
    ) emp_number,
    hrm_break_fct.get_account_number (sb.hrm_history_detail_id, sb.SOURCE, sb.v_hbc_amount_type, 'DIV' ) HEB_DIV_NUMBER,
    hrm_break_fct.get_account_number (sb.hrm_history_detail_id, sb.SOURCE, sb.v_hbc_amount_type, 'DOC_RECORD' ) rco_title,
    com_dic_functions.GetDicoDescr('DIC_DEPARTMENT',hrm_break_fct.get_account_number (sb.hrm_history_detail_id, sb.SOURCE, sb.v_hbc_amount_type, 'FREE' ),1) dic_department_id,
    hrm_break_id,
    hrm_history_detail_id,
    hrm_elements_id,
    v_hbc_acc_name,
    V_HBC_AMOUNT_TYPE,
    SAB_PAY_DATE,
    HRM_EMPLOYEE_ID,
    BREAK_DATE,
    VALUE_DATE,
    DECODE (
    (SELECT MAX(dic_group3_id) FROM hrm_elements_root r WHERE r.hrm_elements_id=sb.hrm_elements_id
    ), NULL,
    (SELECT MAX (currency)
    FROM --ind_hrm_history ind,
         hrm_history ind,
         hrm_history_detail det
    WHERE sb.hrm_employee_id     = ind.hrm_employee_id
    AND sb.hrm_history_detail_id = det.hrm_history_detail_id
    AND det.hrm_employee_id      = ind.hrm_employee_id
    AND ind.hit_pay_num          = det.his_pay_num
    ),
    (SELECT MAX(dic_group3_id)
    FROM hrm_elements_root r
    WHERE r.hrm_elements_id=sb.hrm_elements_id
    ) )currency,
    v_hbc_debit_amount V_HBC_DEBIT_AMOUNT_DEV,
    v_hbc_credit_amount V_HBC_CREDIT_AMOUNT_DEV,
    DECODE(V_HBC_AMOUNT_TYPE,'D',SAB_REF_VALUE,0) V_HBC_DEBIT_AMOUNT,
    DECODE(V_HBC_AMOUNT_TYPE,'C',SAB_REF_VALUE,0) V_HBC_CREDIT_AMOUNT
  FROM v_hrm_break_cgdiv2 sb


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_FACT" ("TYP", "DEVISE", "DIC_GROUP_ID", "PER_FULLNAME", "EMP_NUMBER", "PERIOD", "ERD_DESCR", "V_HBC_AMOUNT_CHF", "V_HBC_AMOUNT_DEV", "HIS_PAY_SUM_VAL_CHF", "HIS_PAY_SUM_VAL_DEV") AS
  SELECT
  'Comptabilit' typ,
  A.DEVISE,
  B.DIC_GROUP_ID,
  A.PER_FULLNAME,
  A.EMP_NUMBER,
  TO_CHAR (A.SAB_PAY_DATE,'YYYYMM') PERIOD,
  A.ELE_STAT_CODE||' '||A.ELE_DESCR ERD_DESCR,
  sum(A.V_HBC_DEBIT_AMOUNT-A.V_HBC_CREDIT_AMOUNT) V_HBC_AMOUNT_chf,
  sum(A.V_HBC_DEBIT_AMOUNT_dev-A.V_HBC_CREDIT_AMOUNT_dev) V_HBC_AMOUNT_dev,
  0 his_pay_sum_val_chf,
  0 his_pay_sum_val_dev
FROM
  V_IND_HRM_BREAK_TRANSFERT A,
  IND_HRM_BREAK_FACT_LINK B,
  IND_HRM_BREAK_FACT C
WHERE
  A.V_HBC_ACC_NAME=B.ACC_NUMBER AND
  B.DIC_GROUP_ID=C.DIC_GROUP_ID
  group by 'Comptabilit' ,
  A.DEVISE,
  B.DIC_GROUP_ID,
  A.PER_FULLNAME,
  A.EMP_NUMBER,
  TO_CHAR (A.SAB_PAY_DATE,'YYYYMM') ,
  A.ELE_STAT_CODE||' '||A.ELE_DESCR
UNION ALL
  select
  'Facturation' typ,
  currency,
  dic_group1_id,
  per_fullname,
  emp_number,
  period_yyyymm,
  elr_root_code||' '||erd_descr,
  0 V_HBC_AMOUNT_chf,
  0 V_HBC_AMOUNT_Dev,
  sum(his_pay_sum_val_chf) his_pay_sum_val_chf,
  sum(his_pay_sum_val_dev) his_pay_sum_val_dev
  from
  v_ind_hrm_facturation_sal
  group by 'Facturation',
  currency,
  dic_group1_id,
  per_fullname,
  emp_number,
  period_yyyymm,
  elr_root_code||' '||erd_descr



  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_PAY" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_SEARCH_NAME", "EMP_NUMBER", "V_HBC_ACC_NAME", "CURRENCY", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "SAB_PAY_DATE", "PERIOD_YYYYMM", "ELE_DESCR", "PAY_AMOUNT", "PAY_AMOUNT_CHF") AS
  SELECT hrm_person_id,
    per_fullname,
    per_search_name,
    emp_number,
    v_hbc_acc_name,
    acc.currency,
    v_hbc_debit_amount,
    v_hbc_credit_amount,
    sab_pay_date,
    TO_CHAR(sab_pay_date,'YYYYMM') period_yyyymm,
    ele_stat_code
    ||' '
    ||ele_descr ele_descr,
    (SELECT SUM(PAY_AMOUNT)
    FROM v_ind_hrm_pay_done_prov pay
    WHERE tr.hrm_person_id=pay.hrm_employee_id
    AND tr.sab_pay_date   =pay.pay_period
    AND acc.currency      =pay.currency
    ) PAY_AMOUNT,
    ROUND(
    (SELECT SUM(PAY_AMOUNT_CHF)
    FROM v_ind_hrm_pay_done_prov pay
    WHERE tr.hrm_person_id=pay.hrm_employee_id
    AND tr.sab_pay_date   =pay.pay_period
    AND acc.currency      =pay.currency
    ),2) PAY_AMOUNT_CHF
  FROM v_ind_hrm_break_transfert tr,
  /*
    (SELECT '421'
      ||cpv_name acc_number,
      CPD_TEXT1 currency
    FROM com_cpy_codes a,
      com_cpy_codes_value b,
      com_cpy_codes_value_descr c
    WHERE a.com_cpy_codes_id     = b.com_cpy_codes_id
    AND b.com_cpy_codes_value_id = c.com_cpy_codes_value_id
    AND a.cpc_name               = 'DEV_SHIFT'
    AND c.pc_lang_id             = 1
    ) acc
  */
  -- 25.08.2016 : Adaptation pour pointer sur le Net  Payer CHF uniquement
  (SELECT '421100' acc_number,
          'CHF' currency
    FROM dual
    ) acc
  WHERE tr.v_hbc_acc_name=acc.acc_number


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_PAYE" ("EMP_NUMBER", "PER_FULLNAME", "HRM_EMPLOYEE_ID", "BRK_DESCRIPTION", "HRM_BREAK_ID", "SAB_PAY_DATE", "HRM_SALARY_SHEET_ID", "COMPTABILISE", "PAYE") AS
  SELECT   p.emp_number,
            p.per_last_name || ' ' || p.per_first_name per_fullname,
            v.hrm_employee_id, b.brk_description, v.hrm_break_id,
            v.sab_pay_date, b.hrm_salary_sheet_id,
            SUM (v.v_hbc_credit_amount - v.v_hbc_debit_amount) comptabilise,
            hrm_itx.sumelembydec (v.hrm_employee_id,
                                  'CemMontantPaye',
                                  v.sab_pay_date,
                                  v.sab_pay_date,
                                  b.hrm_salary_sheet_id
                                 ) paye
       FROM v_hrm_break_cgdiv2 v, hrm_break b, hrm_person p
      WHERE v.hrm_break_id = b.hrm_break_id
        AND v.hrm_employee_id = p.hrm_person_id
        AND v_hbc_acc_name IN ('421210', '421212', '421214','421215','421226')
   GROUP BY p.emp_number,
            p.per_last_name,
            p.per_first_name,
            v.hrm_employee_id,
            b.brk_description,
            v.hrm_break_id,
            v.sab_pay_date,
            b.hrm_salary_sheet_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_PAY_COMPARE" ("CATEG", "HRM_PERSON_ID", "PER_SEARCH_NAME", "EMP_NUMBER", "PERIOD", "HIT_PAY_NUM", "CURRENCY", "AMOUNT_MP", "CURR_PAY", "PAY_AMOUNT", "HIT_DEFINITIVE") AS
  SELECT '01-BRE' categ,
    per.hrm_person_id,
    per.per_search_name,
    per.emp_number,
    TO_CHAR(sab.sab_pay_date,'YYYYMM') period,
    NULL hit_pay_num,
    sab.currency,
    V_HBC_CREDIT_AMOUNT_DEV-V_HBC_DEBIT_AMOUNT_DEV amount_mp,
    NULL curr_pay,
    0 pay_amount,
    (SELECT MAX(HIT_DEFINITIVE)
    FROM HRM_HISTORY_DETAIL HIS,
      HRM_HISTORY HIT
    WHERE SAB.HRM_HISTORY_DETAIL_ID=HIS.HRM_HISTORY_DETAIL_ID
    AND HIS.HRM_EMPLOYEE_ID        =HIT.HRM_EMPLOYEE_ID
    AND HIS.HIS_PAY_NUM            =HIT.HIT_PAY_NUM
    ) hit_definitive
  FROM V_IND_HRM_BREAK_DETAIL sab,
    hrm_person per,
    /*
    (SELECT '421'
      ||cpv_name acc_number,
      CPD_TEXT1 currency
    FROM com_cpy_codes a,
      com_cpy_codes_value b,
      com_cpy_codes_value_descr c
    WHERE a.com_cpy_codes_id     = b.com_cpy_codes_id
    AND b.com_cpy_codes_value_id = c.com_cpy_codes_value_id
    AND a.cpc_name               = 'DEV_SHIFT'
    AND c.pc_lang_id             = 1
    ) acc
    */
    -- 25.08.2016 : Adaptation pour pointer sur le Net  Payer CHF uniquement
    (
    SELECT '421100' acc_number,
      'CHF' currency
    FROM dual
    ) acc
  WHERE sab.hrm_employee_id=per.hrm_person_id
  AND sab.V_HBC_ACC_NAME   =acc.acc_number
  UNION ALL
  SELECT '02-PAY' categ,
    per.hrm_person_id,
    per.per_search_name,
    per.emp_number,
    TO_CHAR(pay.pay_period,'YYYYMM') period,
    ihi.hit_pay_num,
    --ihi.currency,
    acs_function.getcurrencyname(pay.acs_financial_currency_id),
    /*CASE
    WHEN hrm_ind_functions.getcurrencyid(ihi.currency)=pay.acs_financial_currency_id
    THEN pay_amount
    ELSE ROUND(pay_amount * (acs_function.getexchangerate(pay.pay_period,pay.acs_financial_currency_id,1)/acs_function.getbaseprice(pay.pay_period,pay.acs_financial_currency_id)) / (acs_function.getexchangerate(pay.pay_period,hrm_ind_functions.getcurrencyid(ihi.currency),1)/acs_function.getbaseprice(pay.pay_period,hrm_ind_functions.getcurrencyid(ihi.currency))) ,2)
    END amount_mp,*/
    pay_amount,
    acs_function.getcurrencyname(pay.acs_financial_currency_id) curr_pay,
    pay_amount,
    (SELECT MAX(HIT_DEFINITIVE)
    FROM HRM_HISTORY HIT
    WHERE IHI.HRM_EMPLOYEE_ID=HIT.HRM_EMPLOYEE_ID
    AND ihi.HIT_PAY_NUM      =HIT.HIT_PAY_NUM
    ) hit_definitive
  FROM hrm_pay_log pay,
    hrm_person per,
    --ind_hrm_history ihi
    -- 25.08.2016 : Adaptation pour point sur hrm_history au lieu de ind_hrm_history
    hrm_history ihi
  WHERE pay.hrm_employee_id   =per.hrm_person_id
  AND PAY.HRM_EMPLOYEE_ID     =IHI.HRM_EMPLOYEE_ID
  AND pay.PAY_SALARY_SHEET_NUM=ihi.hit_pay_num


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_PAY_NEW" ("HRM_PERSON_ID", "PER_FULLNAME", "PER_SEARCH_NAME", "EMP_NUMBER", "SAB_ACCOUNT_NAME", "CURRENCY", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "CURRENCY_BREAK", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV", "SAB_PAY_DATE", "PERIOD_YYYYMM", "ELE_DESCR", "PAY_AMOUNT", "PAY_AMOUNT_CHF") AS
  select
hrm_person_id,
pername per_fullname,
pername per_search_name,
emp_number,
SAB_ACCOUNT_NAME,
acc.currency,
DEBIT_AMOUNT v_hbc_debit_amount,
CREDIT_AMOUNT v_hbc_credit_amount,
currency2 currency_break,
DEBIT_AMOUNT_DEV v_hbc_debit_amount_dev,
CREDIT_AMOUNT_DEV v_hbc_credit_amount_dev,
sab_pay_date,
to_char(sab_pay_date,'YYYYMM') period_yyyymm,
elr_root_code||' '||ele_descr ele_descr,
(select sum(PAY_AMOUNT)
 from v_ind_hrm_pay_done_prov pay
 where tr.hrm_person_id=pay.hrm_employee_id
 and tr.sab_pay_date=pay.pay_period
 and tr.currency2=pay.currency) PAY_AMOUNT,
round((select sum(PAY_AMOUNT_CHF)
 from v_ind_hrm_pay_done_prov pay
 where tr.hrm_person_id=pay.hrm_employee_id
 and tr.sab_pay_date=pay.pay_period
 and tr.currency2=pay.currency),2) PAY_AMOUNT_CHF
from
V_IND_HRM_BREAK_CGAN tr,
(select '421'||cpv_name acc_number, CPD_TEXT1 currency
 FROM com_cpy_codes a,
 com_cpy_codes_value b,
 com_cpy_codes_value_descr c
 WHERE a.com_cpy_codes_id = b.com_cpy_codes_id
 AND b.com_cpy_codes_value_id = c.com_cpy_codes_value_id
 AND a.cpc_name = 'DEV_SHIFT'
 AND c.pc_lang_id = 1) acc
where
tr.SAB_ACCOUNT_NAME=acc.acc_number




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_TRANSFERT" ("HRM_PERSON_ID", "PER_SEARCH_NAME", "HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "ACS_CPN_ACCOUNT_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "ACC_DESCR", "PER_FULLNAME", "EMP_NUMBER", "PC_LANG_ID", "VALUE_DATE", "BREAK_DATE", "DEVISE", "DEV_RATE", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV", "LINE_TRANSERT") AS
  SELECT hrm_person_id, per_search_name, hrm_history_detail_id, hrm_break_id,
          b.hrm_elements_id, v_hbc_acc_num, v_hbc_acc_name, v_hbc_div_num,
          v_hbc_div_name, v_hbc_amount, v_hbc_debit_amount,
          v_hbc_credit_amount, v_hbc_amount_type, sab_pay_date, sab_ref_value,
          sab_zl, currency, NULL acs_cpn_account_id, erd.erd_descr ele_descr,
          brk_description, ele_code, ele_stat_code, v_hbc_acc_name acc_descr,
          per_last_name || ' ' || per_first_name per_fullname, emp_number,
          erd.pc_lang_id, value_date, break_date,
          hrm_itx.get_pers_curr (p.hrm_person_id, sab_pay_date) devise,
          hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date) dev_rate,
          ROUND
             (  v_hbc_debit_amount
              / hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date),
              2
             ) v_hbc_debit_amount_dev,
          ROUND
             (  v_hbc_credit_amount
              / hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date),
              2
             ) v_hbc_credit_amount_dev,
             (   emp_number
              || ';'
              || TO_CHAR (sab_pay_date, 'DD.MM.YYYY')
              || ';'
              || v_hbc_acc_name
              || ';'
              || v_hbc_div_name
              || ';'
              || erd.erd_descr
              || ';'
              || currency
              || ';'
              || v_hbc_debit_amount
              || ';'
              || v_hbc_credit_amount
              || ';'
              || hrm_itx.get_pers_curr (p.hrm_person_id, sab_pay_date)
              || ';'
              || ROUND (  v_hbc_debit_amount
                        / hrm_itx.get_pers_rate (p.hrm_person_id,
                                                 sab_pay_date),
                        2
                       )
             )
          || ';'
          || TO_CHAR (ROUND (  v_hbc_credit_amount
                             / hrm_itx.get_pers_rate (p.hrm_person_id,
                                                      sab_pay_date
                                                     ),
                             2
                            )
                     ) line_transert
     FROM hrm_person p, v_hrm_break_cgdiv2 b,
          hrm_elements_family fam, hrm_elements_root elr, hrm_elements_root_descr erd
    WHERE p.hrm_person_id = b.hrm_employee_id
      AND b.hrm_elements_id=fam.hrm_elements_id
      and fam.hrm_elements_root_id=elr.hrm_elements_root_id
      and elr.hrm_elements_root_id=erd.hrm_elements_root_id
      AND erd.pc_lang_id = 1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_TRANSFERT_DET" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "V_HBC_ACC_NAME", "V_HBC_DIV_NUM", "V_HBC_DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "ACS_CPN_ACCOUNT_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "ACC_DESCR", "PER_FULLNAME", "EMP_NUMBER", "PC_LANG_ID", "VALUE_DATE", "BREAK_DATE", "DEVISE", "DEV_RATE", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV", "LINE_TRANSERT") AS
  SELECT
  HRM_HISTORY_DETAIL_ID,
  HRM_BREAK_ID,
  b.HRM_ELEMENTS_ID,
  V_HBC_ACC_NUM,
  V_HBC_ACC_NAME,
  V_HBC_DIV_NUM,
  V_HBC_DIV_NAME,
  V_HBC_AMOUNT,
  V_HBC_DEBIT_AMOUNT,
  V_HBC_CREDIT_AMOUNT,
  V_HBC_AMOUNT_TYPE,
  SAB_PAY_DATE,
  SAB_REF_VALUE,
  SAB_ZL,
  CURRENCY,
  null ACS_CPN_ACCOUNT_ID,
  ed.ELE_DESCR,
  BRK_DESCRIPTION,
  ELE_CODE,
  ELE_STAT_CODE,
  V_HBC_ACC_NAME ACC_DESCR,
  per_last_name||' '||per_first_name PER_FULLNAME,
  emp_number,
  ed.pc_lang_id,
  VALUE_DATE,
  BREAK_DATE,
  hrm_itx.GET_PERS_CURR(p.hrm_person_id,sab_pay_date) DEVISE,
  hrm_itx.GET_PERS_RATE(p.hrm_person_id,sab_pay_date) DEV_RATE,
  round(V_HBC_DEBIT_AMOUNT/hrm_itx.GET_PERS_RATE(p.hrm_person_id,sab_pay_date),2) V_HBC_DEBIT_AMOUNT_DEV,
  round(V_HBC_CREDIT_AMOUNT/hrm_itx.GET_PERS_RATE(p.hrm_person_id,sab_pay_date),2) V_HBC_CREDIT_AMOUNT_DEV,
  (emp_number
  ||';'||to_char(sab_pay_date,'DD.MM.YYYY')
  ||';'||V_HBC_ACC_NAME
  ||';'||V_HBC_DIV_NAME
  ||';'||ed.ele_descr
  ||';'||currency
  ||';'||V_HBC_DEBIT_AMOUNT
  ||';'||V_HBC_CREDIT_AMOUNT
  ||';'||hrm_itx.GET_PERS_CURR(p.hrm_person_id,sab_pay_date)
  ||';'||round(V_HBC_DEBIT_AMOUNT/hrm_itx.GET_PERS_RATE(p.hrm_person_id,sab_pay_date),2))
  ||';'||to_char(round(V_HBC_CREDIT_AMOUNT/hrm_itx.GET_PERS_RATE(p.hrm_person_id,sab_pay_date),2))
  line_transert
FROM
  hrm_elements_descr ed,
  hrm_person p,
  v_hrm_break_cgdiv2 b
WHERE
  p.hrm_person_id=b.HRM_EMPLOYEE_ID and
  ed.hrm_elements_id = b.hrm_elements_id
  and ed.pc_lang_id=1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_TRANSFERT_FILE" ("HRM_BREAK_ID", "V_HBC_ACC_NAME", "V_HBC_DIV_NAME", "SAB_PAY_DATE", "CURRENCY", "ELE_DESCR", "BRK_DESCRIPTION", "ACC_DESCR", "PER_FULLNAME", "EMP_NUMBER", "PC_LANG_ID", "VALUE_DATE", "BREAK_DATE", "DEVISE", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV", "LINE_TRANSERT") AS
  select
hrm_break_id,
V_HBC_ACC_NAME,
V_HBC_DIV_NAME,
SAB_PAY_DATE,
CURRENCY,
ELE_DESCR,
BRK_DESCRIPTION,
ACC_DESCR,
PER_FULLNAME,
EMP_NUMBER,
PC_LANG_ID,
VALUE_DATE,
BREAK_DATE,
DEVISE,
V_HBC_DEBIT_AMOUNT,
V_HBC_CREDIT_AMOUNT,
V_HBC_DEBIT_AMOUNT_DEV,
V_HBC_CREDIT_AMOUNT_DEV,
emp_number
  ||';'||to_char(sab_pay_date,'DD.MM.YYYY')
  ||';'||V_HBC_ACC_NAME
  ||';'||V_HBC_DIV_NAME
  ||';'||ele_descr
  ||';'||currency
  ||';'||to_char(V_HBC_DEBIT_AMOUNT)
  ||';'||to_char(V_HBC_CREDIT_AMOUNT)
  ||';'||DEVISE
  ||';'||to_char(V_HBC_DEBIT_AMOUNT_DEV)
  ||';'||to_char(V_HBC_CREDIT_AMOUNT_DEV)
  line_transert
from
V_IND_HRM_BREAK_TRANSFERT_GRP




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_BREAK_TRANSFERT_GRP" ("HRM_BREAK_ID", "V_HBC_ACC_NAME", "V_HBC_DIV_NAME", "SAB_PAY_DATE", "CURRENCY", "ELE_DESCR", "BRK_DESCRIPTION", "ACC_DESCR", "PER_FULLNAME", "EMP_NUMBER", "PC_LANG_ID", "VALUE_DATE", "BREAK_DATE", "DEVISE", "DEV_RATE", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_DEBIT_AMOUNT_DEV", "V_HBC_CREDIT_AMOUNT_DEV") AS
  SELECT   hrm_break_id, v_hbc_acc_name, v_hbc_div_name, sab_pay_date,
            currency,
            CASE
               WHEN INSTR (compte_detail, v_hbc_acc_name) > 0
                OR UPPER (compte_detail) = 'TOUS'
                  THEN erd.erd_descr
               ELSE    TO_CHAR (value_date, 'MM.YYYY')
                    || ' '
                    || emp_number
                    || ' '
                    || per_last_name
                    || ' '
                    || per_first_name
            END ele_descr,
            brk_description, v_hbc_acc_name acc_descr,
            per_last_name || ' ' || per_first_name per_fullname, emp_number,
            erd.pc_lang_id, value_date, break_date,
            hrm_itx.get_pers_curr (p.hrm_person_id, sab_pay_date) devise,
            hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date) dev_rate,
            SUM (v_hbc_debit_amount) v_hbc_debit_amount,
            SUM (v_hbc_credit_amount) v_hbc_credit_amount,
            SUM
               (ROUND (  v_hbc_debit_amount
                       / hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date),
                       2
                      )
               ) v_hbc_debit_amount_dev,
            SUM
               (ROUND (  v_hbc_credit_amount
                       / hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date),
                       2
                      )
               ) v_hbc_credit_amount_dev
       FROM hrm_person p,
            v_hrm_break_cgdiv2 b,
            (SELECT MAX (compte_detail) compte_detail
               FROM ind_hrm_break_param_det) c,
             hrm_elements_family fam,
             hrm_elements_root elr,
             hrm_elements_root_descr erd
      WHERE p.hrm_person_id = b.hrm_employee_id
        AND b.hrm_elements_id=fam.hrm_elements_id
        and fam.hrm_elements_root_id=elr.hrm_elements_root_id
        and elr.hrm_elements_root_id=erd.hrm_elements_root_id
        AND erd.pc_lang_id = 1
   GROUP BY hrm_break_id,
            v_hbc_acc_name,
            v_hbc_div_name,
            sab_pay_date,
            currency,
            CASE
               WHEN INSTR (compte_detail, v_hbc_acc_name) > 0
                OR UPPER (compte_detail) = 'TOUS'
                  THEN erd.erd_descr
               ELSE    TO_CHAR (value_date, 'MM.YYYY')
                    || ' '
                    || emp_number
                    || ' '
                    || per_last_name
                    || ' '
                    || per_first_name
            END,
            brk_description,
            v_hbc_acc_name,
            per_last_name || ' ' || per_first_name,
            emp_number,
            erd.pc_lang_id,
            value_date,
            break_date,
            hrm_itx.get_pers_curr (p.hrm_person_id, sab_pay_date),
            hrm_itx.get_pers_rate (p.hrm_person_id, sab_pay_date)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_CHECK_ROUND" ("HRM_EMPLOYEE_ID", "MAIN_ID", "RELATED_ID", "MAIN_CODE", "RELATED_CODE", "PER_SEARCH_NAME", "HIS_PAY_PERIOD", "PERIOD_YYYYMM", "MAIN_ROOT_CODE", "MAIN_ROOT_DESCR", "ELR_ROOT_CODE", "ERD_DESCR", "HIS_PAY_SUM_VAL", "CURRENCY", "RATE", "HIS_PAY_SUM_VAL_DEV", "MAIN_VALUE", "MAIN_VALUE_DEV", "MONTANT_PAYE", "MONTANT_PAYE_DEV") AS
  select
d.hrm_employee_id,
a.main_id,
a.related_id,
a.main_code,
a.related_code,
e.per_search_name,
d.his_pay_period,
to_char(d.his_pay_period,'YYYYMM') period_yyyymm,
(select elr_root_code
 from hrm_elements_root r1, hrm_elements e1
 where r1.hrm_elements_id=e1.hrm_elements_id
 and e1.ele_code=replace(replace(a.main_code,'2',''),'3','')) main_root_code,
(select erd_descr
 from hrm_elements_root r1, hrm_elements_root_descr r2, hrm_elements e1
 where r1.hrm_elements_id=e1.hrm_elements_id
 and r1.hrm_elements_root_id=r2.hrm_elements_root_id
 and e1.ele_code=replace(replace(a.main_code,'2',''),'3','')
 and r2.pc_lang_id=c.pc_lang_id) main_root_descr,
b.elr_root_code,
c.erd_descr,
d.his_pay_sum_val,
hrm_itx.get_pers_curr(d.hrm_employee_id,d.his_pay_period) currency,
hrm_itx.get_pers_rate(d.hrm_employee_id,d.his_pay_period) rate,
round(d.his_pay_sum_val/hrm_itx.get_pers_rate(d.hrm_employee_id,d.his_pay_period),2) his_pay_sum_val_dev,
hrm_functions.SUMELEM(d.hrm_employee_id,a.main_code,d.his_pay_period,d.his_pay_period) main_value,
round(hrm_functions.SUMELEM(d.hrm_employee_id,a.main_code,d.his_pay_period,d.his_pay_period)/hrm_itx.get_pers_rate(d.hrm_employee_id,d.his_pay_period),2) main_value_dev,
hrm_functions.SUMELEM(d.hrm_employee_id,'CemMontantPaye',d.his_pay_period,d.his_pay_period) montant_paye,
round(hrm_functions.SUMELEM(d.hrm_employee_id,'CemMontantPaye',d.his_pay_period,d.his_pay_period)/hrm_itx.get_pers_rate(d.hrm_employee_id,d.his_pay_period),2) montant_paye_dev
from
hrm_formulas_structure a,
hrm_elements_root b,
hrm_elements_root_descr c,
hrm_history_detail d,
hrm_person e
where
a.related_id=b.hrm_elements_id
and b.hrm_elements_root_id=c.hrm_elements_root_id
and a.related_id=d.hrm_elements_id
and d.hrm_employee_id=e.hrm_person_id
and c.pc_lang_id=1
and main_code in ('CemSalBrut','CemSalBrut2','CemSalBrut3','CemTotDd','CemTotDd2','CemTotDd3','CemTotHSal','CemTotHSal2','CemTotHSal3')
and related_code not in ('CemSalBrut2','CemSalBrut3','CemTotDd2','CemTotDd3','CemTotHSal2','CemTotHSal3')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_CPTE_SAL_CUB" ("PER_FULLNAME", "PER_SEARCH_NAME", "ELR_ROOT_CODE", "ERD_DESCR", "COE_DESCR", "HIS_PAY_PERIOD", "EMP_NUMBER", "PC_LANG_ID", "LANID", "HIS_PAY_SUM_VAL", "HRM_EMPLOYEE_ID") AS
  SELECT
        HRM_UTILS.CONVERTTOSEARCHTEXT(per_last_name)
         ||  ' '
         ||  per_first_name per_fullname,
        per_search_name,
        root.elr_root_code,
        rdescr.erd_descr,
        root.elr_root_code
         ||  ' '
         ||  rdescr.erd_descr coe_descr,
        TO_CHAR(hrm_history_detail3.his_pay_period,'YYYYMM') his_pay_period,
        emp_number,
        rdescr.pc_lang_id,
        lang.lanid,
        his_pay_sum_val,
        hrm_history_detail3.hrm_employee_id
    FROM
        hrm_elements_root root,
        hrm_elements_root_descr rdescr,
        hrm_history_detail hrm_history_detail3,
        hrm_person hrm_person4,
        pcs.pc_lang lang
    WHERE
        root.hrm_elements_root_id = rdescr.hrm_elements_root_id
    AND
        root.hrm_elements_id = hrm_history_detail3.hrm_elements_id
    AND
        hrm_history_detail3.hrm_employee_id = hrm_person4.hrm_person_id
    AND
        rdescr.pc_lang_id = lang.pc_lang_id
    AND
        root.elr_reporting = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_CPTE_SAL_CUB_DEV" ("PER_FULLNAME", "PER_SEARCH_NAME", "ELR_ROOT_CODE", "ERD_DESCR", "COE_DESCR", "HIS_PAY_PERIOD", "EMP_NUMBER", "PC_LANG_ID", "LANID", "HIS_PAY_SUM_VAL", "CURRENCY", "RATE", "HIS_PAY_SUM_VAL_DEV", "HRM_EMPLOYEE_ID") AS
  SELECT
        HRM_UTILS.CONVERTTOSEARCHTEXT(per_last_name)
         ||  ' '
         ||  per_first_name per_fullname,
        per_search_name,
        root.elr_root_code,
        rdescr.erd_descr,
        root.elr_root_code
         ||  ' '
         ||  rdescr.erd_descr coe_descr,
        TO_CHAR(hrm_history_detail3.his_pay_period,'YYYYMM') his_pay_period,
        emp_number,
        rdescr.pc_lang_id,
        lang.lanid,
        his_pay_sum_val,
        hrm_itx.get_pers_curr(hrm_person_id,his_pay_period) currency,
        hrm_itx.get_pers_rate(hrm_person_id,his_pay_period) rate,
        round(his_pay_sum_val / hrm_itx.get_pers_rate(hrm_person_id,his_pay_period),3) his_pay_sum_val_dev,
        hrm_history_detail3.hrm_employee_id
    FROM
        hrm_elements_root root,
        hrm_elements_root_descr rdescr,
        hrm_history_detail hrm_history_detail3,
        hrm_person hrm_person4,
        pcs.pc_lang lang
    WHERE
        root.hrm_elements_root_id = rdescr.hrm_elements_root_id
    AND
        root.hrm_elements_id = hrm_history_detail3.hrm_elements_id
    AND
        hrm_history_detail3.hrm_employee_id = hrm_person4.hrm_person_id
    AND
        rdescr.pc_lang_id = lang.pc_lang_id
    AND
        root.elr_reporting = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_CTRL_CUB" ("COL_NAME", "PER_FULLNAME", "HIS_PAY_PERIOD", "COE_DESCR", "EMP_NUMBER", "CURRENCY", "RATE", "HIS_PAY_SUM_VAL", "HIS_PAY_SUM_VAL_DEV") AS
  SELECT
  COL_NAME,
  PER_LAST_NAME||' '||PER_FIRST_NAME PER_FULLNAME,
  TO_CHAR (HRM_HISTORY_DETAIL3.HIS_PAY_PERIOD,'YYYYMM') HIS_PAY_PERIOD,
  HRM_CONTROL_ELEMENTS1.COE_DESCR,
  EMP_NUMBER,
  hrm_itx.get_pers_curr(hrm_person_id,his_pay_period) currency,
  hrm_itx.get_pers_rate(hrm_person_id,his_pay_period) rate,
  DECODE(COE_INVERSE,0,HIS_PAY_SUM_VAL,1,HIS_PAY_SUM_VAL*(-1)) HIS_PAY_SUM_VAL,
  round(DECODE(COE_INVERSE,0,HIS_PAY_SUM_VAL,1,HIS_PAY_SUM_VAL*(-1)) /hrm_itx.get_pers_rate(hrm_person_id,his_pay_period),3) his_pay_sum_val_dev
FROM
  HRM_CONTROL_ELEMENTS HRM_CONTROL_ELEMENTS1,
  HRM_CONTROL_LIST HRM_CONTROL_LIST2,
  HRM_HISTORY_DETAIL HRM_HISTORY_DETAIL3,
  HRM_PERSON HRM_PERSON4
WHERE
  HRM_CONTROL_ELEMENTS1.HRM_CONTROL_LIST_ID = HRM_CONTROL_LIST2.HRM_CONTROL_LIST_ID AND
  HRM_CONTROL_ELEMENTS1.HRM_CONTROL_ELEMENTS_ID = HRM_HISTORY_DETAIL3.HRM_ELEMENTS_ID AND
  HRM_HISTORY_DETAIL3.HRM_EMPLOYEE_ID = HRM_PERSON4.HRM_PERSON_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_CUB_LIST" ("HRM_EMPLOYEE_ID", "HRM_HISTORY_DETAIL_ID", "HRM_SALARY_SHEET_ID", "HRM_ELEMENTS_ID", "HRM_ELEMENTS_ROOT_ID", "HRM_CONTROL_LIST_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_FULLNAME", "PER_SEARCH_NAME", "EMP_NUMBER", "EMP_SECONDARY_KEY", "EMP_SOCIAL_SECURITYNO", "EMP_SOCIAL_SECURITYNO2", "PER_TITLE", "PER_GENDER", "PER_BIRTH_DATE", "C_CIVIL_STATUS", "DIC_NATIONALITY_ID", "EMP_STATUS", "INO_IN", "INO_OUT", "CON_BEGIN", "CON_END", "DIC_SALARY_NUMBER_ID", "JOB_TITLE", "HEB_DIV_NUMBER", "JOB_DIV_NUMBER", "HIS_PAY_PERIOD", "PERIOD", "ELR_ROOT_CODE", "ERD_DESCR", "PC_LANG_ID", "HIS_PAY_VALUE", "HIS_PAY_SUM_VAL_CHF", "CURRENCY", "RATE", "HIS_PAY_SUM_VAL_DEV", "RATE_EUR", "HIS_PAY_SUM_VAL_EUR", "RATE_USD", "HIS_PAY_SUM_VAL_USD", "COL_NAME", "COE_BOX", "COE_DESCR", "COE_INVERSE", "COE_CODE") AS
  SELECT f.hrm_employee_id, f.hrm_history_detail_id, f.hrm_salary_sheet_id,
          f.hrm_elements_id, d.hrm_elements_root_id, a.hrm_control_list_id,
          per_last_name, per_first_name,
          per_last_name || ' ' || per_first_name per_fullname,
          per_search_name, emp_number, emp_secondary_key,
          emp_social_securityno, emp_social_securityno2, per_title,
          per_gender, per_birth_date, c_civil_status, dic_nationality_id,
          emp_status,
          (SELECT MIN (ino_in)
             FROM hrm_in_out ino
            WHERE f.hrm_employee_id = ino.hrm_employee_id
              AND ino_in <= f.his_pay_period
              AND (ino_out >= TRUNC (f.his_pay_period, 'MM')
                   OR ino_out IS NULL
                  )) ino_in,
          (SELECT MAX (ino_out)
             FROM hrm_in_out ino
            WHERE f.hrm_employee_id = ino.hrm_employee_id
              AND ino_in <= f.his_pay_period
              AND (ino_out >= TRUNC (f.his_pay_period, 'MM')
                   OR ino_out IS NULL
                  )) ino_out,
          (SELECT MIN (con_begin)
             FROM hrm_contract con
            WHERE f.hrm_employee_id = con.hrm_employee_id
              AND con_begin <= f.his_pay_period
              AND (con_end >= TRUNC (f.his_pay_period, 'MM')
                   OR con_end IS NULL
                  )) con_begin,
          (SELECT MAX (con_end)
             FROM hrm_contract con
            WHERE f.hrm_employee_id = con.hrm_employee_id
              AND con_begin <= f.his_pay_period
              AND (con_end >= TRUNC (f.his_pay_period, 'MM')
                   OR con_end IS NULL
                  )) con_end,
          (SELECT MAX
                     (com_dic_functions.getdicodescr ('DIC_SALARY_NUMBER',
                                                      dic_salary_number_id,
                                                      e.pc_lang_id
                                                     )
                     )
             FROM hrm_contract con
            WHERE f.hrm_employee_id = con.hrm_employee_id
              AND con_begin <= f.his_pay_period
              AND (con_end >= TRUNC (f.his_pay_period, 'MM')
                   OR con_end IS NULL
                  )) dic_salary_number_id,
          (SELECT MAX (job_descr)
             FROM hrm_person_job pj, hrm_job job
            WHERE pj.hrm_job_id = job.hrm_job_id
              AND f.hrm_employee_id = pj.hrm_person_id
              AND pej_from <= f.his_pay_period
              AND (pej_to >= TRUNC (f.his_pay_period, 'MM') OR pej_to IS NULL
                  )) job_title,
          hrm_itx.get_pers_division_prin (f.hrm_employee_id) heb_div_number,
          hrm_itx.get_div_descr
             (hrm_itx.get_pers_division_prin (f.hrm_employee_id)
             ) job_div_number,
          his_pay_period, TO_CHAR (his_pay_period, 'YYYYMM') period,
          elr_root_code, erd_descr, e.pc_lang_id,
          his_pay_value,
          CASE
             WHEN coe_inverse = 1
                THEN his_pay_sum_val * (-1)
             ELSE his_pay_sum_val
          END his_pay_sum_val_chf,
          hrm_itx.get_pers_curr (f.hrm_employee_id,
                                 f.his_pay_period) currency,
          hrm_itx.get_pers_rate (f.hrm_employee_id, f.his_pay_period) rate,
          CASE
             WHEN coe_inverse = 1
                THEN   ROUND
                          (  his_pay_sum_val
                           / hrm_itx.get_pers_rate (f.hrm_employee_id,
                                                    f.his_pay_period
                                                   ),
                           2
                          )
                     * (-1)
             ELSE ROUND (  his_pay_sum_val
                         / hrm_itx.get_pers_rate (f.hrm_employee_id,
                                                  f.his_pay_period
                                                 ),
                         2
                        )
          END his_pay_sum_val_dev,
          (SELECT his_pay_sum_val
             FROM hrm_history_detail his, hrm_elements ele
            WHERE his.hrm_elements_id = ele.hrm_elements_id
              AND f.his_pay_num = his.his_pay_num
              AND f.hrm_employee_id = his.hrm_employee_id
              AND ele.ele_code = 'DivEURTaux') rate_eur,
          CASE
             WHEN coe_inverse = 1
                THEN   ROUND
                          (  his_pay_sum_val
                           / (SELECT his_pay_sum_val
                                FROM hrm_history_detail his, hrm_elements ele
                               WHERE his.hrm_elements_id = ele.hrm_elements_id
                                 AND f.his_pay_num = his.his_pay_num
                                 AND f.hrm_employee_id = his.hrm_employee_id
                                 AND ele.ele_code = 'DivEURTaux'),
                           2
                          )
                     * (-1)
             ELSE ROUND (  his_pay_sum_val
                         / (SELECT his_pay_sum_val
                              FROM hrm_history_detail his, hrm_elements ele
                             WHERE his.hrm_elements_id = ele.hrm_elements_id
                               AND f.his_pay_num = his.his_pay_num
                               AND f.hrm_employee_id = his.hrm_employee_id
                               AND ele.ele_code = 'DivEURTaux'),
                         2
                        )
          END his_pay_sum_val_eur,
          (SELECT his_pay_sum_val
             FROM hrm_history_detail his, hrm_elements ele
            WHERE his.hrm_elements_id = ele.hrm_elements_id
              AND f.his_pay_num = his.his_pay_num
              AND f.hrm_employee_id = his.hrm_employee_id
              AND ele.ele_code = 'DivUSDTaux') rate_usd,
          CASE
             WHEN coe_inverse = 1
                THEN   ROUND
                          (  his_pay_sum_val
                           / (SELECT his_pay_sum_val
                                FROM hrm_history_detail his, hrm_elements ele
                               WHERE his.hrm_elements_id = ele.hrm_elements_id
                                 AND f.his_pay_num = his.his_pay_num
                                 AND f.hrm_employee_id = his.hrm_employee_id
                                 AND ele.ele_code = 'DivUSDTaux'),
                           2
                          )
                     * (-1)
             ELSE ROUND (  his_pay_sum_val
                         / (SELECT his_pay_sum_val
                              FROM hrm_history_detail his, hrm_elements ele
                             WHERE his.hrm_elements_id = ele.hrm_elements_id
                               AND f.his_pay_num = his.his_pay_num
                               AND f.hrm_employee_id = his.hrm_employee_id
                               AND ele.ele_code = 'DivUSDTaux'),
                         2
                        )
          END his_pay_sum_val_usd,
          col_name, coe_box, coe_descr, coe_inverse, coe_code
     FROM hrm_control_list a,
          hrm_control_elements b,
          hrm_elements_family c,
          hrm_elements_root d,
          hrm_elements_root_descr e,
          hrm_history_detail f,
          hrm_person g
    WHERE a.hrm_control_list_id = b.hrm_control_list_id
      AND b.hrm_control_elements_id = c.hrm_elements_id
      AND c.hrm_elements_root_id = d.hrm_elements_root_id
      AND d.hrm_elements_root_id = e.hrm_elements_root_id
      AND b.hrm_control_elements_id = f.hrm_elements_id
      AND f.hrm_employee_id = g.hrm_person_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_ELEMENTS_ROOT_BASE" ("HRM_ELEMENTS_ROOT_ID", "HRM_ELEMENTS_ID", "ELR_ROOT_CODE", "ERD_DESCR", "ERD_COMMENT", "ELR_ROOT_NAME", "ELR_SIGN", "COE_BOX", "COE_DESCR", "ACCOUNT_DEBIT", "ACCOUNT_CREDIT", "DIC_GROUP1_ID", "FACTURATION") AS
  SELECT
r.hrm_elements_root_id,
r.hrm_elements_id,
r.elr_root_code,
d.erd_descr,
d.erd_comment,
r.elr_root_name,
r.elr_sign,
b.coe_box,
b.coe_descr,
(select max(ald.ald_acc_name)
 from hrm_break_structure brs,
 hrm_allocation_detail ald
 where brs.hrm_allocation_id=ald.hrm_allocation_id
 and ald.dic_account_type_id='CG'
 and ald.ald_rate=1
 and bre_item_id=r.hrm_elements_id) ACCOUNT_DEBIT,
(select max(ald.ald_acc_name)
 from hrm_break_structure brs,
 hrm_allocation_detail ald
 where brs.hrm_allocation_id=ald.hrm_allocation_id
 and ald.dic_account_type_id='CG'
 and ald.ald_rate=-1
 and bre_item_id=r.hrm_elements_id) ACCOUNT_CREDIT,
r.dic_group1_id,
r.dic_group1_id||' '||com_dic_functions.getdicodescr('DIC_GROUP1',r.dic_group1_id,1) facturation
FROM
(SELECT
 bl.hrm_control_list_id, be.coe_box, be.coe_descr, fs.related_id
 FROM
 hrm_formulas_structure fs,
 hrm_control_elements be,
 hrm_control_list bl
 WHERE
 fs.main_id = be.hrm_control_elements_id AND
 be.hrm_control_list_id = bl.hrm_control_list_id AND
 bl.c_control_list_type = '101') b,
hrm_elements_root_descr d,
hrm_elements_family f,
hrm_elements_root r
WHERE
r.elr_reporting = 1 AND
r.elr_is_active = 1 AND
d.pc_lang_id=1 AND
d.hrm_elements_root_id = r.hrm_elements_root_id AND
f.hrm_elements_root_id = r.hrm_elements_root_id AND
b.related_id(+) = f.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_EMPTOPAY_NUM" ("EMPID") AS
  SELECT HRM_PERSON_ID "EMPID"
     FROM (SELECT HRM_PERSON_ID,
                  hrm_date.IsEmployeePayable (HRM_PERSON_ID) IS_PAYABLE
             FROM HRM_PERSON
            WHERE PER_IS_EMPLOYEE = 1 AND EMP_CALCULATION = 1) P
    WHERE IS_PAYABLE = 1
   MINUS
   SELECT HRM_EMPLOYEE_ID
     FROM (SELECT HRM_EMPLOYEE_ID,
                  HRM_SALARY_SHEET_ID,
                  HIT_PAY_NUM,
                  hrm_date.ValidForActivePeriod2 (HIT_PAY_PERIOD) IS_VALID,
                  CASE HIT_REVERSAL
                     WHEN 1
                     THEN
                        hrm_var.IsBreakDowned (HRM_EMPLOYEE_ID,
                                               HRM_SALARY_SHEET_ID,
                                               HIT_PAY_NUM)
                     WHEN 0
                     THEN
                        0
                  END
                     IS_BREAK_DOWNED,
                  hrm_var.get_paySelected SALARY_SHEET_SELECTED
             FROM HRM_HISTORY) H
    WHERE     HRM_SALARY_SHEET_ID = SALARY_SHEET_SELECTED
          AND HIT_PAY_NUM =
                 (SELECT MAX (HIT_PAY_NUM)
                    FROM HRM_HISTORY
                   WHERE     HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID
                         AND HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID)
          AND IS_VALID = 1
          AND IS_BREAK_DOWNED = 0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_EMPTOPAY_NUM_ALL" ("EMPID") AS
  select
  HRM_PERSON_ID
from (
  select
    HRM_PERSON_ID,
    ind_hrm_fct.IsEmployeePayableAll(HRM_PERSON_ID) IS_PAYABLE
  from HRM_PERSON
  where PER_IS_EMPLOYEE = 1 and EMP_CALCULATION = 1
) P
where
  IS_PAYABLE = 1
minus
select
  HRM_EMPLOYEE_ID
from (
  select
    HRM_EMPLOYEE_ID,
    HRM_SALARY_SHEET_ID,
    HIT_PAY_NUM,
    hrm_date.ValidForActivePeriod2(HIT_PAY_PERIOD) IS_VALID,
    case HIT_REVERSAL
      when 1 then hrm_var.IsBreakDowned(HRM_EMPLOYEE_ID, HRM_SALARY_SHEET_ID, HIT_PAY_NUM)
      when 0 then 0
    end IS_BREAK_DOWNED,
    hrm_var.get_paySelected SALARY_SHEET_SELECTED
  from HRM_HISTORY
) H
where
  HRM_SALARY_SHEET_ID = SALARY_SHEET_SELECTED and
  HIT_PAY_NUM = (select Max(HIT_PAY_NUM) from HRM_HISTORY
                 where HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
                   HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID) and
  IS_VALID = 1 and IS_BREAK_DOWNED = 0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_EMPTOPAY_NUM_LY" ("EMPID") AS
  select
  HRM_PERSON_ID
from (
  select
    HRM_PERSON_ID,
    ind_hrm_fct.IsEmployeePayableLastYear(HRM_PERSON_ID) IS_PAYABLE
  from HRM_PERSON
  where PER_IS_EMPLOYEE = 1 and EMP_CALCULATION = 1
) P
where
  IS_PAYABLE = 1
minus
select
  HRM_EMPLOYEE_ID
from (
  select
    HRM_EMPLOYEE_ID,
    HRM_SALARY_SHEET_ID,
    HIT_PAY_NUM,
    hrm_date.ValidForActivePeriod2(HIT_PAY_PERIOD) IS_VALID,
    case HIT_REVERSAL
      when 1 then hrm_var.IsBreakDowned(HRM_EMPLOYEE_ID, HRM_SALARY_SHEET_ID, HIT_PAY_NUM)
      when 0 then 0
    end IS_BREAK_DOWNED,
    hrm_var.get_paySelected SALARY_SHEET_SELECTED
  from HRM_HISTORY
) H
where
  HRM_SALARY_SHEET_ID = SALARY_SHEET_SELECTED and
  HIT_PAY_NUM = (select Max(HIT_PAY_NUM) from HRM_HISTORY
                 where HRM_SALARY_SHEET_ID = H.HRM_SALARY_SHEET_ID and
                   HRM_EMPLOYEE_ID = H.HRM_EMPLOYEE_ID) and
  IS_VALID = 1 and IS_BREAK_DOWNED = 0


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_EXTRACT_PERSON" ("PER_LAST_NAME", "PER_FIRST_NAME", "PER_SEARCH_NAME", "PER_TITLE", "PER_BIRTH_DATE", "PER_GENDER", "PER_HOMESTREET", "PER_HOMEPOSTALCODE", "PER_HOMECITY", "PER_HOMECOUNTRY", "PER_HOME_PHONE", "PER_HOME2_PHONE", "PER_MOBILE_PHONE", "PER_EMAIL", "EMP_CALCULATION", "EMP_NUMBER", "EMP_SOCIAL_SECURITYNO", "EMP_SOCIAL_SECURITYNO2", "EMP_STATUS", "DIC_HRM_EMP_TYPE_ID", "C_CIVIL_STATUS", "EMP_CIVIL_STATUS_SINCE", "DIC_NATIONALITY_ID", "DNA_DESCR", "EMP_NATIVE_OF", "PC_LANG_ID", "EMP_GROUP_ENTRY", "INO_IN", "DIC_IN_TYPE_ID", "INO_OUT", "DIC_OUT_TYPE_ID", "INO_FINAL_PAYMENT", "INO_COMMENTS", "CON_BEGIN", "CON_END", "C_CONTRACT_TYPE", "DIC_CONTRACT_CATEGORY_ID", "DIC_SALARY_NUMBER_ID", "C_FINANCIAL_REF_TYPE", "FIN_SEQUENCE", "CURRENCY", "BAN_NAME1", "FIN_NAME", "FIN_ACCOUNT_NUMBER", "FIN_BAN_ETAB", "FIN_BAN_GUICH", "FIN_ACCOUNT_CONTROL", "FIN_BAN_NAME", "FIN_BAN_CITY", "FIN_SWIFT", "C_CHARGES_MANAGEMENT", "FIN_COMMENTS", "C_FINANCIAL_REF_TYPE_2", "FIN_SEQUENCE_2", "CURRENCY_2", "BAN_NAME1_2", "FIN_NAME_2", "FIN_ACCOUNT_NUMBER_2", "FIN_BAN_ETAB_2", "FIN_BAN_GUICH_2", "FIN_ACCOUNT_CONTROL_2", "FIN_BAN_NAME_2", "FIN_BAN_CITY_2", "FIN_SWIFT_2", "C_CHARGES_MANAGEMENT_2", "FIN_COMMENTS_2", "C_FINANCIAL_REF_TYPE_3", "FIN_SEQUENCE_3", "CURRENCY_3", "BAN_NAME1_3", "FIN_NAME_3", "FIN_ACCOUNT_NUMBER_3", "FIN_BAN_ETAB_3", "FIN_BAN_GUICH_3", "FIN_ACCOUNT_CONTROL_3", "FIN_BAN_NAME_3", "FIN_BAN_CITY_3", "FIN_SWIFT_3", "C_CHARGES_MANAGEMENT_3", "FIN_COMMENTS_3", "CONJOINT", "EMP_CHILD_NB", "REL_NAME_1", "REL_BIRTH_DATE_1", "REL_NAME_2", "REL_BIRTH_DATE_2", "REL_NAME_3", "REL_BIRTH_DATE_3", "REL_NAME_4", "REL_BIRTH_DATE_4", "REL_NAME_5", "REL_BIRTH_DATE_5", "JOB_TITLE", "HEB_DIV_NUMBER", "JOB_DIV_NUMBER", "RCO_TITLE", "RCO_DESCRIPTION") AS
  SELECT   per_last_name, per_first_name,per_search_name, per_title, per_birth_date,
            per_gender, per_homestreet, per_homepostalcode, per_homecity,
            per_homecountry, per_home_phone, per_home2_phone,
            per_mobile_phone, per_email, emp_calculation, emp_number,
            emp_social_securityno, emp_social_securityno2, emp_status,
            com_dic_functions.getdicodescr
                                    ('DIC_HRM_EMP_TYPE',
                                     dic_hrm_emp_type_id,
                                     1
                                    ) dic_hrm_emp_type_id,
            c_civil_status, emp_civil_status_since, dic_nationality_id,
            com_dic_functions.getdicodescr ('DIC_NATIONALITY',
                                            dic_nationality_id,
                                            1
                                           ) dna_descr,
            emp_native_of, per.pc_lang_id, per.emp_group_entry, ino.ino_in,
            com_dic_functions.getdicodescr ('DIC_IN_TYPE',
                                            dic_in_type_id,
                                            1
                                           ) dic_in_type_id,
            ino.ino_out,
            com_dic_functions.getdicodescr ('DIC_OUT_TYPE',
                                            dic_out_type_id,
                                            1
                                           ) dic_out_type_id,
            ino.ino_final_payment, ino.ino_comments, con.con_begin,
            con.con_end, con.c_contract_type,
            com_dic_functions.getdicodescr
                          ('DIC_CONTRACT_CATEGORY',
                           dic_contract_category_id,
                           1
                          ) dic_contract_category_id,
            com_dic_functions.getdicodescr
                                  ('DIC_SALARY_NUMBER',
                                   dic_salary_number_id,
                                   1
                                  ) dic_salary_number_id,
r1.C_FINANCIAL_REF_TYPE,
r1.FIN_SEQUENCE,
(select currency
 from ACS_FINANCIAL_CURRENCY acs, pcs.pc_curr cur
 where acs.pc_curr_id=cur.pc_curr_id
 and acs.ACS_FINANCIAL_CURRENCY_ID=r1.ACS_FINANCIAL_CURRENCY_ID) currency,
(select ban_name1
 from pcs.pc_bank ban
 where r1.pc_bank_id=ban.pc_bank_id) ban_name1,
r1.FIN_NAME,
r1.FIN_ACCOUNT_NUMBER,
r1.FIN_BAN_ETAB,
r1.FIN_BAN_GUICH,
r1.FIN_ACCOUNT_CONTROL,
r1.FIN_BAN_NAME,
r1.FIN_BAN_CITY,
r1.FIN_SWIFT,
r1.C_CHARGES_MANAGEMENT,
r1.FIN_COMMENTS,
r2.C_FINANCIAL_REF_TYPE C_FINANCIAL_REF_TYPE_2,
r2.FIN_SEQUENCE FIN_SEQUENCE_2,
(select currency
 from ACS_FINANCIAL_CURRENCY acs, pcs.pc_curr cur
 where acs.pc_curr_id=cur.pc_curr_id
 and acs.ACS_FINANCIAL_CURRENCY_ID=r2.ACS_FINANCIAL_CURRENCY_ID) currency_2,
(select ban_name1
 from pcs.pc_bank ban
 where r2.pc_bank_id=ban.pc_bank_id) ban_name1_2,
r2.FIN_NAME FIN_NAME_2,
r2.FIN_ACCOUNT_NUMBER FIN_ACCOUNT_NUMBER_2,
r2.FIN_BAN_ETAB FIN_BAN_ETAB_2,
r2.FIN_BAN_GUICH FIN_BAN_GUICH_2,
r2.FIN_ACCOUNT_CONTROL FIN_ACCOUNT_CONTROL_2,
r2.FIN_BAN_NAME FIN_BAN_NAME_2,
r2.FIN_BAN_CITY FIN_BAN_CITY_2,
r2.FIN_SWIFT FIN_SWIFT_2,
r2.C_CHARGES_MANAGEMENT C_CHARGES_MANAGEMENT_2,
r2.FIN_COMMENTS FIN_COMMENTS_2,
r3.C_FINANCIAL_REF_TYPE C_FINANCIAL_REF_TYPE_3,
r3.FIN_SEQUENCE FIN_SEQUENCE_3,
(select currency
 from ACS_FINANCIAL_CURRENCY acs, pcs.pc_curr cur
 where acs.pc_curr_id=cur.pc_curr_id
 and acs.ACS_FINANCIAL_CURRENCY_ID=r3.ACS_FINANCIAL_CURRENCY_ID) currency_3,
(select ban_name1
 from pcs.pc_bank ban
 where r3.pc_bank_id=ban.pc_bank_id) ban_name1_3,
r3.FIN_NAME FIN_NAME_3,
r3.FIN_ACCOUNT_NUMBER FIN_ACCOUNT_NUMBER_3,
r3.FIN_BAN_ETAB FIN_BAN_ETAB_3,
r3.FIN_BAN_GUICH FIN_BAN_GUICH_3,
r3.FIN_ACCOUNT_CONTROL FIN_ACCOUNT_CONTROL_3,
r3.FIN_BAN_NAME FIN_BAN_NAME_3,
r3.FIN_BAN_CITY FIN_BAN_CITY_3,
r3.FIN_SWIFT FIN_SWIFT_3,
r3.C_CHARGES_MANAGEMENT C_CHARGES_MANAGEMENT_3,
r3.FIN_COMMENTS FIN_COMMENTS_3,
            (select rel_name||' '||nvl(rel_first_name,'')
             from hrm_related_to rel
             where c_related_to_type=1
            and rel.hrm_employee_id=per.hrm_person_id) conjoint,
            hrm_itx.get_pers_nbr_child(per.hrm_person_id) EMP_CHILD_NB,
            hrm_itx.get_pers_child_name(per.hrm_person_id,1) rel_name_1,
            hrm_itx.get_pers_child_date(per.hrm_person_id,1) rel_birth_date_1,
            hrm_itx.get_pers_child_name(per.hrm_person_id,2) rel_name_2,
            hrm_itx.get_pers_child_date(per.hrm_person_id,2) rel_birth_date_2,
            hrm_itx.get_pers_child_name(per.hrm_person_id,3) rel_name_3,
            hrm_itx.get_pers_child_date(per.hrm_person_id,3) rel_birth_date_3,
            hrm_itx.get_pers_child_name(per.hrm_person_id,4) rel_name_4,
            hrm_itx.get_pers_child_date(per.hrm_person_id,4) rel_birth_date_4,
            hrm_itx.get_pers_child_name(per.hrm_person_id,5) rel_name_5,
            hrm_itx.get_pers_child_date(per.hrm_person_id,5) rel_birth_date_5,
            hrm_itx.get_pers_last_job (per.hrm_person_id) job_title,
            hrm_itx.get_pers_division_prin (per.hrm_person_id) heb_div_number,
            hrm_itx.get_div_descr
               (hrm_itx.get_pers_division_prin (per.hrm_person_id)
               ) job_div_number,
            hrm_itx.get_pers_dossier_prin (per.hrm_person_id)  rco_title,
            (select max(rco_description)
             from doc_record rec
             where rec.rco_title=hrm_itx.get_pers_dossier_prin (per.hrm_person_id)) rco_description
       FROM hrm_person per,
            v_hrm_last_entry len,
            hrm_in_out ino,
            (SELECT   hrm_employee_id, MAX (con_begin) con_begin
                 FROM hrm_contract
             GROUP BY hrm_employee_id) c1,
            hrm_contract con,
            hrm_financial_ref r1,
            hrm_financial_ref r2,
            hrm_financial_ref r3
      WHERE per.hrm_person_id = len.empid(+)
        AND len.empid = ino.hrm_employee_id(+)
        AND len.entry = ino.ino_in(+)
        AND per.hrm_person_id = c1.hrm_employee_id(+)
        AND c1.hrm_employee_id = con.hrm_employee_id(+)
        AND c1.con_begin = con.con_begin(+)
        and r1.HRM_FINANCIAL_REF_ID(+)=hrm_itx.GETFINREFID(per.hrm_person_id,1)
        and r2.HRM_FINANCIAL_REF_ID(+)=hrm_itx.GETFINREFID(per.hrm_person_id,2)
        and r3.HRM_FINANCIAL_REF_ID(+)=hrm_itx.GETFINREFID(per.hrm_person_id,3)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_FACTURATION" ("HRM_EMPLOYEE_ID", "EMP_NUMBER", "HEB_DIV_NUMBER", "DIC_GROUP1_ID", "DIC_DESCR", "CURRENCY", "HIS_PAY_SUM_VAL_DEV", "HIS_PAY_SUM_VAL_CHF", "EMC_VALUE_FROM", "EMC_VALUE_TO") AS
  SELECT   hrm_employee_id, emp_number, heb_div_number, dic_group1_id, dic_descr, currency,
            SUM (his_pay_sum_val_dev) his_pay_sum_val_dev,
            SUM (his_pay_sum_val_chf) his_pay_sum_val_chf,
            ADD_MONTHS (his_pay_period + 1, -1) emc_value_from,
            his_pay_period emc_value_to
       FROM v_ind_hrm_facturation_sal sal
   GROUP BY emp_number,
            per_fullname,
            heb_div_number,
            dic_group1_id,
            dic_descr,
            currency,
            his_pay_period,
            hrm_employee_id
   ORDER BY emp_number, dic_group1_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_FACTURATION_DET" ("PER_FULLNAME", "EMP_NUMBER", "PERIOD_YYYYMM", "DIC_GROUP1_ID", "DIC_DESCR", "ELR_ROOT_CODE", "ERD_DESCR", "CURRENCY", "HIS_PAY_SUM_VAL_DEV") AS
  select
per_fullname,
emp_number,
period_yyyymm,
dic_group1_id,
dic_descr,
elr_root_code,
erd_descr,
currency,
his_pay_sum_val_dev
from
v_ind_hrm_facturation_sal
where
dic_group1_id <>'400'
UNION ALL
select
per_last_name||' '||per_first_name per_fullname,
emp_number,
to_char(his_pay_period,'YYYYMM') period_yyyymm,
'400' dic_group1_id,
'Charges patronales' dic_descr,
b.elr_root_code,
c.erd_descr,
hrm_itx.GET_PERS_CURR(d.hrm_employee_id,his_pay_period) currency,
round(his_pay_sum_val/hrm_itx.GET_PERS_RATE(d.hrm_employee_id,his_pay_period),2) his_pay_sum_val_dev
from
hrm_formulas_structure a,
hrm_elements_root b,
hrm_elements_root_descr c,
hrm_history_detail d,
hrm_person e
where
a.related_id=b.hrm_elements_id
and b.hrm_elements_root_id=c.hrm_elements_root_id
and a.related_id=d.hrm_elements_id
and d.hrm_employee_id=e.hrm_person_id
and a.main_code in ('CemTotChPa','CemTotChPa2','CemTotChPa3')
and related_code not in ('CemTotChPa','CemTotChPa2','CemTotChPa3')
and c.pc_lang_id=1




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_FACTURATION_SAL" ("EMP_NUMBER", "PER_FULLNAME", "DIC_GROUP1_ID", "DIC_DESCR", "ELR_ROOT_CODE", "ERD_DESCR", "HIS_PAY_SUM_VAL_CHF", "CURRENCY", "RATE", "HIS_PAY_SUM_VAL_DEV", "HIS_PAY_PERIOD", "HRM_EMPLOYEE_ID", "PERIOD_YYYYMM", "PERIOD_YYYY", "PER_LAST_NAME", "PER_FIRST_NAME", "UPPER_FULLNAME", "HEB_DIV_NUMBER") AS
  SELECT d.emp_number,
          d.per_last_name || ' ' || d.per_first_name per_fullname,
          b.dic_group1_id,
          com_dic_functions.getdicodescr ('DIC_GROUP1',
                                          b.dic_group1_id,
                                          1
                                         ) dic_descr,
          b.elr_root_code, c.erd_descr, a.his_pay_sum_val his_pay_sum_val_chf,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.his_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id, a.his_pay_period) rate,
          ROUND
              (  a.his_pay_sum_val
               / hrm_itx.get_pers_rate (a.hrm_employee_id, a.his_pay_period),
               2
              ) his_pay_sum_val_dev,
          a.his_pay_period, a.hrm_employee_id,
          TO_CHAR (a.his_pay_period, 'YYYYMM') period_yyyymm,
          TO_CHAR (a.his_pay_period, 'YYYY') period_yyyy, d.per_last_name,
          d.per_first_name,
          UPPER (d.per_last_name || ' ' || d.per_first_name) upper_fullname,
          hrm_ind_spec_arkema.GETDOSSIERGROUP1(a.hrm_employee_id,b.dic_group1_id)  heb_div_number
     FROM hrm_history_detail a,
          hrm_elements_root b,
          hrm_elements_root_descr c,
          hrm_person d
    WHERE a.hrm_elements_id = b.hrm_elements_id
      AND b.hrm_elements_root_id = c.hrm_elements_root_id
      AND a.hrm_employee_id = d.hrm_person_id
      AND c.pc_lang_id = 1
--and b.dic_group1_id <> '999'
      AND b.dic_group1_id IS NOT NULL
      and  exists (select 1
               from v_ind_hrm_facturation_status stat
               where stat.hit_pay_period=a.his_pay_period
               and stat.hrm_employee_id=a.hrm_employee_id
               and stat.status='IN')



  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_FACTURATION_SAL_OLD" ("EMP_NUMBER", "PER_FULLNAME", "DIC_GROUP1_ID", "DIC_DESCR", "ELR_ROOT_CODE", "ERD_DESCR", "HIS_PAY_SUM_VAL_CHF", "CURRENCY", "RATE", "HIS_PAY_SUM_VAL_DEV", "HIS_PAY_PERIOD", "HRM_EMPLOYEE_ID", "PERIOD_YYYYMM", "PERIOD_YYYY", "PER_LAST_NAME", "PER_FIRST_NAME", "UPPER_FULLNAME", "HEB_DIV_NUMBER") AS
  SELECT d.emp_number,
          d.per_last_name || ' ' || d.per_first_name per_fullname,
          b.dic_group1_id,
          com_dic_functions.getdicodescr ('DIC_GROUP1',
                                          b.dic_group1_id,
                                          1
                                         ) dic_descr,
          b.elr_root_code, c.erd_descr, a.his_pay_sum_val his_pay_sum_val_chf,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.his_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id, a.his_pay_period) rate,
          ROUND
              (  a.his_pay_sum_val
               / hrm_itx.get_pers_rate (a.hrm_employee_id, a.his_pay_period),
               2
              ) his_pay_sum_val_dev,
          a.his_pay_period, a.hrm_employee_id,
          TO_CHAR (a.his_pay_period, 'YYYYMM') period_yyyymm,
          TO_CHAR (a.his_pay_period, 'YYYY') period_yyyy, d.per_last_name,
          d.per_first_name,
          UPPER (d.per_last_name || ' ' || d.per_first_name) upper_fullname,
          hrm_ind_spec_arkema.GETDIVGROUP1(a.hrm_employee_id,b.dic_group1_id) heb_div_number
     FROM hrm_history_detail a,
          hrm_elements_root b,
          hrm_elements_root_descr c,
          hrm_person d
    WHERE a.hrm_elements_id = b.hrm_elements_id
      AND b.hrm_elements_root_id = c.hrm_elements_root_id
      AND a.hrm_employee_id = d.hrm_person_id
      AND c.pc_lang_id = 1
      AND b.dic_group1_id IS NOT NULL
	        and  exists (select 1
               from v_ind_hrm_facturation_status stat
               where stat.hit_pay_period=a.his_pay_period
               and stat.hrm_employee_id=a.hrm_employee_id
               and stat.status='IN')
	 	  and exists (select 1
	  	  		 from hrm_history_detail his,hrm_elements_root elr
				 where his.hrm_elements_id=elr.hrm_elements_id
				 and a.hrm_employee_id=his.hrm_employee_id
				 and a.his_pay_num=his.his_pay_num
				 and elr.dic_group1_id<>0
				 and elr.dic_group1_id IS NOT NULL)



  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_FACTURATION_STATUS" ("HRM_EMPLOYEE_ID", "HIT_PAY_PERIOD", "FAC_TYPE", "INO_OUT", "STATUS") AS
  SELECT hrm_employee_id, hit_pay_period, fac_type,
          (SELECT MAX (ino_out)
             FROM hrm_in_out ino
            WHERE hit.hrm_employee_id = ino.hrm_employee_id
              AND TRUNC (hit.hit_pay_period, 'MM') = TRUNC (ino.ino_out, 'MM'))
                                                                      ino_out,
          --CASE
          --   WHEN fac_type = 'Trimestriel'
          --   AND (SELECT MAX (ino_out)
          --          FROM hrm_in_out ino
          --        WHERE hit.hrm_employee_id = ino.hrm_employee_id
          --           AND TRUNC (hit.hit_pay_period, 'MM') =
          --                                           TRUNC (ino.ino_out, 'MM')) IS NOT NULL
          --      THEN 'OUT'
          --   ELSE 'IN'
          --END status
          'IN' status
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) hit,
          (SELECT MAX (fac_type) fac_type
             FROM v_ind_hrm_facturation_typ) v




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_FREE_CODE" ("HRM_OBJECT_ID", "DIC_TYPE", "DIC_TYPE_DESCR", "DIC_CODE", "DIC_DESCR", "BOO_CODE", "NUM_CODE", "DAT_CODE", "CHA_CODE") AS
  select
hrm_object_id,
'BOO' dic_type,
'Boolen' dic_type_descr,
DIC_HRM_BOOL_CODE_TYP_ID dic_code,
com_dic_functions.GETDICODESCR('DIC_HRM_BOOL_CODE_TYP',DIC_HRM_BOOL_CODE_TYP_ID,1) dic_descr,
boo_code,
null num_code,
null dat_code,
null cha_code
from
HRM_BOOLEAN_CODE
UNION ALL
select
hrm_object_id,
'NUM' dic_type,
'Numrique' dic_type_descr,
DIC_HRM_NUM_CODE_TYP_ID dic_code,
com_dic_functions.GETDICODESCR('DIC_HRM_NUM_CODE_TYP',DIC_HRM_NUM_CODE_TYP_ID,1) dic_descr,
null boo_code,
num_code,
null dat_code,
null cha_code
from
HRM_NUMBER_CODE
UNION ALL
select
hrm_object_id,
'DATE' dic_type,
'Date' dic_type_descr,
DIC_HRM_DATE_CODE_TYP_ID dic_code,
com_dic_functions.GETDICODESCR('DIC_HRM_DATE_CODE_TYP',DIC_HRM_DATE_CODE_TYP_ID,1) dic_descr,
null boo_code,
null num_code,
dat_code,
null cha_code
from
HRM_DATE_CODE
UNION ALL
select
hrm_object_id,
'CHAR' dic_type,
'Caractre' dic_type_descr,
DIC_HRM_CHAR_CODE_TYP_ID dic_code,
com_dic_functions.GETDICODESCR('DIC_HRM_CHAR_CODE_TYP',DIC_HRM_CHAR_CODE_TYP_ID,1) dic_descr,
null boo_code,
null num_code,
null dat_code,
cha_code
from
HRM_CHAR_CODE




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_LPP" ("HRM_EMPLOYEE_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_FULLNAME", "EMP_NUMBER", "PER_BIRTH_DATE", "HIT_PAY_PERIOD", "PERIOD", "CURRENCY", "EMP_RATE", "CURR_RATE", "EMPLOYE", "PATRONAL", "BASE", "PLAN") AS
  SELECT a.hrm_employee_id, b.per_last_name, b.per_first_name,
          b.per_last_name || ' ' || b.per_first_name per_fullname,
          b.emp_number, b.per_birth_date, a.hit_pay_period,
          TO_CHAR (a.hit_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.hit_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.hit_pay_period) emp_rate, 1 curr_rate,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSL',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionComp',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBase',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) employe,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLPa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompPa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBasePa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompMPa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegPaCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) patronal,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemBasPensionSL',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) base,
          'CHF' PLAN
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) a,
          hrm_person b
    WHERE a.hrm_employee_id = b.hrm_person_id
      AND EXISTS (
             SELECT 1
               FROM hrm_history_detail his, hrm_elements ele
              WHERE his.hrm_elements_id = ele.hrm_elements_id
                AND a.hit_pay_period = his.his_pay_period
                AND a.hrm_employee_id = his.hrm_employee_id
                AND ele.ele_code IN
                       ('CemDdPensionSL', 'CemDdPensionSLPa',
                        'CemDdPensionComp', 'CemDdPensionCompPa',
                        'CemDdPensionBase', 'CemDdPensionBasePa',
                        'CemDdPensionCompMPa', 'CemDdPensionCHFRegCHF',
                        'CemDdPensionCHFRegEUR', 'CemDdPensionCHFRegUSD',
                        'CemDdPensionCHFRegPaCHF',
                        'CemDdPensionCHFRegPaEUR',
                        'CemDdPensionCHFRegPaUSD'))
   UNION ALL
   SELECT a.hrm_employee_id, b.per_last_name, b.per_first_name,
          b.per_last_name || ' ' || b.per_first_name per_fullname,
          b.emp_number, b.per_birth_date, a.hit_pay_period,
          TO_CHAR (a.hit_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.hit_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.hit_pay_period) emp_rate,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'DivEURTaux',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) curr_rate,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBaseEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) employe,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBasePaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompMPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegPaCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) patronal,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemBasPensionSL',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) base,
          'EUR' PLAN
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) a,
          hrm_person b
    WHERE a.hrm_employee_id = b.hrm_person_id
      AND EXISTS (
             SELECT 1
               FROM hrm_history_detail his, hrm_elements ele
              WHERE his.hrm_elements_id = ele.hrm_elements_id
                AND a.hit_pay_period = his.his_pay_period
                AND a.hrm_employee_id = his.hrm_employee_id
                AND ele.ele_code IN
                       ('CemDdPensionSLEUR', 'CemDdPensionSLPaEUR',
                        'CemDdPensionCompEUR', 'CemDdPensionCompPaEUR',
                        'CemDdPensionBaseEUR', 'CemDdPensionBasePaEUR',
                        'CemDdPensionCompMPaEUR', 'CemDdPensionEURRegCHF',
                        'CemDdPensionEURRegEUR', 'CemDdPensionEURRegUSD',
                        'CemDdPensionEURRegPaCHF',
                        'CemDdPensionEURRegPaEUR',
                        'CemDdPensionEURRegPaUSD'))
   UNION ALL
   SELECT a.hrm_employee_id, b.per_last_name, b.per_first_name,
          b.per_last_name || ' ' || b.per_first_name per_fullname,
          b.emp_number, b.per_birth_date, a.hit_pay_period,
          TO_CHAR (a.hit_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.hit_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.hit_pay_period) emp_rate,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'DivUSDTaux',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) curr_rate,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBaseUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) employe,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBasePaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompMPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegPaCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) patronal,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemBasPensionSL',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) base,
          'USD' PLAN
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) a,
          hrm_person b
    WHERE a.hrm_employee_id = b.hrm_person_id
      AND EXISTS (
             SELECT 1
               FROM hrm_history_detail his, hrm_elements ele
              WHERE his.hrm_elements_id = ele.hrm_elements_id
                AND a.hit_pay_period = his.his_pay_period
                AND a.hrm_employee_id = his.hrm_employee_id
                AND ele.ele_code IN
                       ('CemDdPensionSLUSD', 'CemDdPensionSLPaUSD',
                        'CemDdPensionCompUSD', 'CemDdPensionCompPaUSD',
                        'CemDdPensionBaseUSD', 'CemDdPensionBasePaUSD',
                        'CemDdPensionCompMPaUSD', 'CemDdPensionUSDRegCHF',
                        'CemDdPensionUSDRegEUR', 'CemDdPensionUSDRegUSD',
                        'CemDdPensionUSDRegPaCHF',
                        'CemDdPensionUSDRegPaEUR',
                        'CemDdPensionUSDRegPaUSD'))




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_LPP_DETAIL" ("HRM_EMPLOYEE_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_FULLNAME", "EMP_NUMBER", "PER_BIRTH_DATE", "HIT_PAY_PERIOD", "PERIOD", "CURRENCY", "EMP_RATE", "CURR_RATE", "EMPLOYE", "EMPLOYE_VOLONT", "PATRONAL", "BASE", "PLAN") AS
  SELECT a.hrm_employee_id, b.per_last_name, b.per_first_name,
          b.per_last_name || ' ' || b.per_first_name per_fullname,
          b.emp_number, b.per_birth_date, a.hit_pay_period,
          TO_CHAR (a.hit_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.hit_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.hit_pay_period) emp_rate, 1 curr_rate,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSL',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBase',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) employe,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemDdPensionComp',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) employe_volont,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLPa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompPa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBasePa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompMPa',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegPaCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCHFRegPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) patronal,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemBasPensionSL',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) base,
          'CHF' PLAN
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) a,
          hrm_person b
    WHERE a.hrm_employee_id = b.hrm_person_id
      AND EXISTS (
             SELECT 1
               FROM hrm_history_detail his, hrm_elements ele
              WHERE his.hrm_elements_id = ele.hrm_elements_id
                AND a.hit_pay_period = his.his_pay_period
                AND a.hrm_employee_id = his.hrm_employee_id
                AND ele.ele_code IN
                       ('CemDdPensionSL', 'CemDdPensionSLPa',
                        'CemDdPensionComp', 'CemDdPensionCompPa',
                        'CemDdPensionBase', 'CemDdPensionBasePa',
                        'CemDdPensionCompMPa', 'CemDdPensionCHFRegCHF',
                        'CemDdPensionCHFRegEUR', 'CemDdPensionCHFRegUSD',
                        'CemDdPensionCHFRegPaCHF',
                        'CemDdPensionCHFRegPaEUR',
                        'CemDdPensionCHFRegPaUSD'))
   UNION ALL
   SELECT a.hrm_employee_id, b.per_last_name, b.per_first_name,
          b.per_last_name || ' ' || b.per_first_name per_fullname,
          b.emp_number, b.per_birth_date, a.hit_pay_period,
          TO_CHAR (a.hit_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.hit_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.hit_pay_period) emp_rate,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'DivEURTaux',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) curr_rate,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBaseEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) employe,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemDdPensionCompEUR',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) employe_volont,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBasePaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompMPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegPaCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionEURRegPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) patronal,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemBasPensionSL',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) base,
          'EUR' PLAN
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) a,
          hrm_person b
    WHERE a.hrm_employee_id = b.hrm_person_id
      AND EXISTS (
             SELECT 1
               FROM hrm_history_detail his, hrm_elements ele
              WHERE his.hrm_elements_id = ele.hrm_elements_id
                AND a.hit_pay_period = his.his_pay_period
                AND a.hrm_employee_id = his.hrm_employee_id
                AND ele.ele_code IN
                       ('CemDdPensionSLEUR', 'CemDdPensionSLPaEUR',
                        'CemDdPensionCompEUR', 'CemDdPensionCompPaEUR',
                        'CemDdPensionBaseEUR', 'CemDdPensionBasePaEUR',
                        'CemDdPensionCompMPaEUR', 'CemDdPensionEURRegCHF',
                        'CemDdPensionEURRegEUR', 'CemDdPensionEURRegUSD',
                        'CemDdPensionEURRegPaCHF',
                        'CemDdPensionEURRegPaEUR',
                        'CemDdPensionEURRegPaUSD'))
   UNION ALL
   SELECT a.hrm_employee_id, b.per_last_name, b.per_first_name,
          b.per_last_name || ' ' || b.per_first_name per_fullname,
          b.emp_number, b.per_birth_date, a.hit_pay_period,
          TO_CHAR (a.hit_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.hit_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.hit_pay_period) emp_rate,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'DivUSDTaux',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) curr_rate,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBaseUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) employe,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemDdPensionCompUSD',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) employe_volont,
            nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionSLPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionBasePaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionCompMPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegPaCHF',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegPaEUR',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0)
          + nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                   'CemDdPensionUSDRegPaUSD',
                                   a.hit_pay_period,
                                   a.hit_pay_period
                                  ),0) patronal,
          nvl(hrm_functions.sumelem (a.hrm_employee_id,
                                 'CemBasPensionSL',
                                 a.hit_pay_period,
                                 a.hit_pay_period
                                ),0) base,
          'USD' PLAN
     FROM (SELECT DISTINCT hrm_employee_id, hit_pay_period
                      FROM hrm_history) a,
          hrm_person b
    WHERE a.hrm_employee_id = b.hrm_person_id
      AND EXISTS (
             SELECT 1
               FROM hrm_history_detail his, hrm_elements ele
              WHERE his.hrm_elements_id = ele.hrm_elements_id
                AND a.hit_pay_period = his.his_pay_period
                AND a.hrm_employee_id = his.hrm_employee_id
                AND ele.ele_code IN
                       ('CemDdPensionSLUSD', 'CemDdPensionSLPaUSD',
                        'CemDdPensionCompUSD', 'CemDdPensionCompPaUSD',
                        'CemDdPensionBaseUSD', 'CemDdPensionBasePaUSD',
                        'CemDdPensionCompMPaUSD', 'CemDdPensionUSDRegCHF',
                        'CemDdPensionUSDRegEUR', 'CemDdPensionUSDRegUSD',
                        'CemDdPensionUSDRegPaCHF',
                        'CemDdPensionUSDRegPaEUR',
                        'CemDdPensionUSDRegPaUSD'))




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_BREAK" ("HRM_EMPLOYEE_ID", "PER_SEARCH_NAME", "PER_FULLNAME", "EMP_NUMBER", "PAY_PERIOD", "PAY_PERIOD_YYYYMM", "CURRENCY", "PAY_AMOUNT", "CHF", "PAY_AMOUNT_CHF", "BREAK_AMOUNT_CHF") AS
  select
a.hrm_employee_id,
a.per_search_name,
a.per_fullname,
a.emp_number,
a.pay_period,
a.pay_period_yyyymm,
a.currency,
sum(a.pay_amount) pay_amount,
a.chf,
sum(a.pay_amount_chf) pay_amount_chf,
(select sum(V_HBC_CREDIT_AMOUNT-V_HBC_DEBIT_AMOUNT)
 from  v_ind_hrm_break_pay b
 where a.pay_period=b.sab_pay_date
 and a.hrm_employee_id=b.hrm_person_id
 and a.currency=b.currency) break_amount_chf
from
V_IND_HRM_PAY_DONE_PROV a
group by a.hrm_employee_id,
a.per_search_name,
a.per_fullname,
a.emp_number,
a.pay_period,
a.pay_period_yyyymm,
a.currency,
a.chf




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_BREAK_NEW" ("HRM_EMPLOYEE_ID", "PER_SEARCH_NAME", "PER_FULLNAME", "EMP_NUMBER", "PAY_PERIOD", "PAY_PERIOD_YYYYMM", "CURRENCY", "PAY_AMOUNT", "CHF", "PAY_AMOUNT_CHF", "BREAK_AMOUNT_CHF") AS
  select
a.hrm_employee_id,
a.per_search_name,
a.per_fullname,
a.emp_number,
a.pay_period,
a.pay_period_yyyymm,
a.currency,
sum(a.pay_amount) pay_amount,
a.chf,
sum(a.pay_amount_chf) pay_amount_chf,
(select sum(V_HBC_CREDIT_AMOUNT-V_HBC_DEBIT_AMOUNT)
 from  v_ind_hrm_break_pay_NEW b
 where a.pay_period=b.sab_pay_date
 and a.hrm_employee_id=b.hrm_person_id
 and a.currency=b.currency) break_amount_chf
from
V_IND_HRM_PAY_DONE_PROV a
group by a.hrm_employee_id,
a.per_search_name,
a.per_fullname,
a.emp_number,
a.pay_period,
a.pay_period_yyyymm,
a.currency,
a.chf




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_DONE" ("HRM_EMPLOYEE_ID", "PER_FULLNAME", "PER_SEARCH_NAME", "EMP_NUMBER", "BAN_NAME1", "PC_CNTRY_ID", "CNTNAME", "PAY_ACC_NUM", "PAY_NAME", "CURRENCY", "PAY_AMOUNT", "CHF", "PAY_AMOUNT_CHF", "RATE", "PAY_PERIOD", "PAY_PERIOD_YYYYMM", "HRM_SALARY_SHEET_ID", "PAY_SALARY_SHEET_NUM", "PC_BANK_ID", "PAY_MODE", "PAY_SELECTED", "PAY_DONE", "HRM_PAY_DOC_ID", "ACS_FINANCIAL_CURRENCY_ID", "PAY_DEFINITIVE", "PAD_DESCR", "PAD_ESTABLISHMENT_DATE", "PAD_EXEC_DATE") AS
  SELECT LOG.hrm_employee_id,
per_last_name || ' ' || per_first_name per_fullname,
per_search_name,
emp_number,
ban_name1,
ban.pc_cntry_id,
(select max(cntname)
 from pcs.pc_cntry cnt
 where ban.pc_cntry_id=cnt.pc_cntry_id) cntname,
pay_acc_num,
pay_name,
cur.currency,
pay_amount,
acs_function.getlocalcurrencyname chf,
pay_amount * CASE
     WHEN cur.currency = acs_function.getlocalcurrencyname
        THEN 1
     ELSE hrm_itx.sumelembydec (LOG.hrm_employee_id,
                                'Div' || cur.currency || 'Taux',
                                LOG.pay_period,
                                LOG.pay_period,
                                hrm_salary_sheet_id
                               )
  END pay_amount_chf,
CASE
   WHEN cur.currency = acs_function.getlocalcurrencyname
      THEN 1
   ELSE hrm_itx.sumelembydec (LOG.hrm_employee_id,
                              'Div' || cur.currency || 'Taux',
                              LOG.pay_period,
                              LOG.pay_period,
                              hrm_salary_sheet_id
                             )
END rate,
LOG.pay_period,
TO_CHAR (LOG.pay_period,'YYYYMM') pay_period_yyyymm,
hrm_salary_sheet_id,
pay_salary_sheet_num,
LOG.pc_bank_id,
pay_mode,
pay_selected,
pay_done,
LOG.hrm_pay_doc_id,
LOG.acs_financial_currency_id,
pay_definitive,
pad_descr,
pad_establishment_date,
pad_exec_date
FROM hrm_pay_log LOG,
hrm_person per,
acs_financial_currency fcur,
pcs.pc_curr cur,
pcs.pc_bank ban,
hrm_pay_doc doc
WHERE LOG.hrm_employee_id = per.hrm_person_id
AND LOG.acs_financial_currency_id = fcur.acs_financial_currency_id
AND fcur.pc_curr_id = cur.pc_curr_id
AND LOG.pc_bank_id = ban.pc_bank_id(+)
AND LOG.hrm_pay_doc_id = doc.hrm_pay_doc_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_DONE_PROV" ("HRM_EMPLOYEE_ID", "PER_FULLNAME", "PER_SEARCH_NAME", "EMP_NUMBER", "BAN_NAME1", "PAY_ACC_NUM", "PAY_NAME", "PAY_ACC_CONTROL", "PAY_BAN_CITY", "PAY_BAN_ETAB", "PAY_BAN_GUICH", "PAY_BAN_NAME", "PC_CNTRY_ID", "CNTNAME", "CURRENCY", "PAY_AMOUNT", "CHF", "PAY_AMOUNT_CHF", "RATE", "PAY_PERIOD", "PAY_PERIOD_YYYYMM", "HRM_SALARY_SHEET_ID", "PAY_SALARY_SHEET_NUM", "PC_BANK_ID", "PAY_MODE", "PAY_SELECTED", "PAY_DONE", "HRM_PAY_DOC_ID", "ACS_FINANCIAL_CURRENCY_ID", "PAY_DEFINITIVE") AS
  SELECT LOG.hrm_employee_id,
          per_last_name || ' ' || per_first_name per_fullname,
          per_search_name, emp_number,
          ban_name1, pay_acc_num, pay_name,
          log.PAY_ACC_CONTROL,
          log.PAY_BAN_CITY,
          log.PAY_BAN_ETAB,
          log.PAY_BAN_GUICH,
          log.PAY_BAN_NAME,
ban.pc_cntry_id,
(select max(cntname)
 from pcs.pc_cntry cnt
 where ban.pc_cntry_id=cnt.pc_cntry_id) cntname,
           cur.currency, pay_amount,
          acs_function.getlocalcurrencyname chf,
            pay_amount
          * CASE
               WHEN cur.currency = acs_function.getlocalcurrencyname
                  THEN 1
               ELSE hrm_itx.sumelembydec (LOG.hrm_employee_id,
                                          'Div' || cur.currency || 'Taux',
                                          LOG.pay_period,
                                          LOG.pay_period,
                                          hrm_salary_sheet_id
                                         )
            END pay_amount_chf,
          CASE
             WHEN cur.currency = acs_function.getlocalcurrencyname
                THEN 1
             ELSE hrm_itx.sumelembydec (LOG.hrm_employee_id,
                                        'Div' || cur.currency || 'Taux',
                                        LOG.pay_period,
                                        LOG.pay_period,
                                        hrm_salary_sheet_id
                                       )
          END rate,
          LOG.pay_period, TO_CHAR (LOG.pay_period,
                                   'YYYYMM') pay_period_yyyymm,
          hrm_salary_sheet_id, pay_salary_sheet_num, LOG.pc_bank_id, pay_mode,
          pay_selected, pay_done, LOG.hrm_pay_doc_id,
          LOG.acs_financial_currency_id, pay_definitive
     FROM hrm_pay_log LOG,
          hrm_person per,
          acs_financial_currency fcur,
          pcs.pc_curr cur,
          pcs.pc_bank ban
    WHERE LOG.hrm_employee_id = per.hrm_person_id
      AND LOG.acs_financial_currency_id = fcur.acs_financial_currency_id
      AND fcur.pc_curr_id = cur.pc_curr_id
      AND LOG.pc_bank_id = ban.pc_bank_id(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_LIST" ("NAME", "EMP_NUMBER", "HRM_EMPLOYEE_ID", "PAY_NUM", "EMP_STATUS", "HRM_PERIOD_ID", "PAY_PERIOD", "DPO_DESCR", "SEX", "D_TOPAY", "D_BYEAR", "ND_TOPAY", "ND_BYEAR", "ADR1", "ADR2", "ADR3", "CITY1", "CITY2") AS
  SELECT P.PER_LAST_NAME || ' ' || P.PER_FIRST_NAME,
          P.EMP_NUMBER,
          V.EMPID,
          NVL (P.EMP_LAST_PAY_NUM + 1, 0),
          P.EMP_STATUS,
          hrm_date.ActivePeriodEndDate,
          hrm_date.ActivePeriodEndDate,
          P.PER_TITLE,
          DECODE (P.PER_GENDER, 'M', 1, 0),
          hrm_date.days_SinceBPeriod (v.empid, hrm_date.ActivePeriod),
          hrm_date.days_SinceBYear (v.empid, hrm_date.ActivePeriod),
          hrm_date.Ndays_SinceBPeriod (v.empid, hrm_date.ActivePeriod),
          hrm_date.Ndays_SinceBYear (v.empid, hrm_date.ActivePeriod),
          -- address ie street
          hrm_var.hrm_MemoLine (
             CASE
                WHEN P.PER_TAXPOSTALCODE IS NULL
                THEN
                   CASE P.PER_MAIL_ADD_SELECTOR
                      WHEN 0 THEN P.PER_BUSINESSSTREET
                      WHEN 1 THEN P.PER_HOMESTREET
                      WHEN 2 THEN P.PER_OTHERSTREET
                   END
                ELSE
                   P.PER_TAXSTREET
             END)
             ADR1,
          hrm_var.hrm_MemoLine (
             CASE
                WHEN P.PER_TAXPOSTALCODE IS NULL
                THEN
                   CASE P.PER_MAIL_ADD_SELECTOR
                      WHEN 0 THEN P.PER_BUSINESSSTREET
                      WHEN 1 THEN P.PER_HOMESTREET
                      WHEN 2 THEN P.PER_OTHERSTREET
                   END
                ELSE
                   P.PER_TAXSTREET
             END,
             2)
             ADR2,
          hrm_var.hrm_MemoLine (
             CASE
                WHEN P.PER_TAXPOSTALCODE IS NULL
                THEN
                   CASE P.PER_MAIL_ADD_SELECTOR
                      WHEN 0 THEN P.PER_BUSINESSSTREET
                      WHEN 1 THEN P.PER_HOMESTREET
                      WHEN 2 THEN P.PER_OTHERSTREET
                   END
                ELSE
                   PER_TAXSTREET
             END,
             3)
             ADR3,
          -- postalcode, should have country code, and city
          CASE
             WHEN P.PER_TAXPOSTALCODE IS NULL
             THEN
                CASE per_mail_add_selector
                   WHEN 0
                   THEN
                      P.PER_BUSINESSPOSTALCODE || ' ' || P.PER_BUSINESSCITY
                   WHEN 1
                   THEN
                      P.PER_HOMEPOSTALCODE || ' ' || P.PER_HOMECITY
                   WHEN 2
                   THEN
                      P.PER_OTHERPOSTALCODE || ' ' || P.PER_OTHERCITY
                END
             ELSE
                P.PER_TAXPOSTALCODE || ' ' || P.PER_TAXCITY
          END
             CITY1,
          '' CITY2
     FROM HRM_PERSON P, V_IND_HRM_EMPTOPAY_NUM V
    WHERE P.HRM_PERSON_ID = V.EMPID AND P.EMP_STATUS IN ('ACT', 'SUS')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_LIST_ALL" ("NAME", "EMP_NUMBER", "HRM_EMPLOYEE_ID", "PAY_NUM", "EMP_STATUS", "HRM_PERIOD_ID", "PAY_PERIOD", "DPO_DESCR", "SEX", "D_TOPAY", "D_BYEAR", "ND_TOPAY", "ND_BYEAR", "ADR1", "ADR2", "ADR3", "CITY1", "CITY2") AS
  select
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.EMP_NUMBER,
  V.EMPID,
  Nvl(P.EMP_LAST_PAY_NUM+1, 0),
  P.EMP_STATUS,
  hrm_date.ActivePeriodEndDate,
  hrm_date.ActivePeriodEndDate,
  P.PER_TITLE,
  Decode(P.PER_GENDER, 'M', 1, 0),
  hrm_date.days_SinceBPeriod(v.empid, hrm_date.ActivePeriod),
  hrm_date.days_SinceBYear(v.empid, hrm_date.ActivePeriod),
  hrm_date.Ndays_SinceBPeriod(v.empid, hrm_date.ActivePeriod),
  hrm_date.Ndays_SinceBYear(v.empid, hrm_date.ActivePeriod),
  -- address ie street
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else P.PER_TAXSTREET
    end
  ) ADR1,
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else P.PER_TAXSTREET
    end,
    2) ADR2,
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else PER_TAXSTREET
    end,
    3) ADR3,
  -- postalcode, should have country code, and city
  case
    when P.PER_TAXPOSTALCODE is null then
      case per_mail_add_selector
        when 0 then P.PER_BUSINESSPOSTALCODE||' '||P.PER_BUSINESSCITY
        when 1 then P.PER_HOMEPOSTALCODE||' '||P.PER_HOMECITY
        when 2 then P.PER_OTHERPOSTALCODE||' '||P.PER_OTHERCITY
      end
    else P.PER_TAXPOSTALCODE||' '||P.PER_TAXCITY
  end CITY1,
  '' CITY2
from
  HRM_PERSON P,
  V_IND_HRM_EMPTOPAY_NUM_ALL V
where
  P.HRM_PERSON_ID = V.EMPID and
  P.EMP_STATUS in ('ACT','SUS')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PAY_LIST_LY" ("NAME", "EMP_NUMBER", "HRM_EMPLOYEE_ID", "PAY_NUM", "EMP_STATUS", "HRM_PERIOD_ID", "PAY_PERIOD", "DPO_DESCR", "SEX", "D_TOPAY", "D_BYEAR", "ND_TOPAY", "ND_BYEAR", "ADR1", "ADR2", "ADR3", "CITY1", "CITY2") AS
  select
  P.PER_LAST_NAME||' '||P.PER_FIRST_NAME,
  P.EMP_NUMBER,
  V.EMPID,
  Nvl(P.EMP_LAST_PAY_NUM+1, 0),
  P.EMP_STATUS,
  hrm_date.ActivePeriodEndDate,
  hrm_date.ActivePeriodEndDate,
  P.PER_TITLE,
  Decode(P.PER_GENDER, 'M', 1, 0),
  hrm_date.days_SinceBPeriod(v.empid, hrm_date.ActivePeriod),
  hrm_date.days_SinceBYear(v.empid, hrm_date.ActivePeriod),
  hrm_date.Ndays_SinceBPeriod(v.empid, hrm_date.ActivePeriod),
  hrm_date.Ndays_SinceBYear(v.empid, hrm_date.ActivePeriod),
  -- address ie street
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else P.PER_TAXSTREET
    end
  ) ADR1,
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else P.PER_TAXSTREET
    end,
    2) ADR2,
  hrm_var.hrm_MemoLine(
    case
      when P.PER_TAXPOSTALCODE is null then
        case P.PER_MAIL_ADD_SELECTOR
          when 0 then P.PER_BUSINESSSTREET
          when 1 then P.PER_HOMESTREET
          when 2 then P.PER_OTHERSTREET
        end
      else PER_TAXSTREET
    end,
    3) ADR3,
  -- postalcode, should have country code, and city
  case
    when P.PER_TAXPOSTALCODE is null then
      case per_mail_add_selector
        when 0 then P.PER_BUSINESSPOSTALCODE||' '||P.PER_BUSINESSCITY
        when 1 then P.PER_HOMEPOSTALCODE||' '||P.PER_HOMECITY
        when 2 then P.PER_OTHERPOSTALCODE||' '||P.PER_OTHERCITY
      end
    else P.PER_TAXPOSTALCODE||' '||P.PER_TAXCITY
  end CITY1,
  '' CITY2
from
  HRM_PERSON P,
  V_IND_HRM_EMPTOPAY_NUM_LY V
where
  P.HRM_PERSON_ID = V.EMPID and
  P.EMP_STATUS in ('ACT','SUS')


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_PLP" ("CAISSE", "HRM_EMPLOYEE_ID", "HRM_ELEMENTS_ID", "HRM_ELEMENTS_ROOT_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_FULLNAME", "EMP_NUMBER", "PER_BIRTH_DATE", "HIS_PAY_PERIOD", "PERIOD", "CURRENCY", "EMP_RATE", "ELR_ROOT_CODE", "ERD_DESCR", "HIS_PAY_SUM_VAL", "CURR_RATE", "CURR_PLAN", "COTI_TYPE", "COTI_BREAK") AS
  SELECT
  CASE
             WHEN UPPER (c.col_name) = 'LISTE PLAN DE PENSION SWI'
                THEN 'SWI'
             WHEN UPPER (c.col_name) = 'LISTE PLAN DE PENSION AIG'
                THEN 'AIG'
            WHEN UPPER (c.col_name) = 'LISTE PLAN DE PENSION ALI'
                THEN 'ALI'
          END caisse,
          a.hrm_employee_id, e.hrm_elements_id, e.hrm_elements_root_id,d.per_last_name, d.per_first_name,
          d.per_last_name || ' ' || d.per_first_name per_fullname,
          d.emp_number, d.per_birth_date, a.his_pay_period,
          TO_CHAR (a.his_pay_period, 'YYYYMM') period,
          hrm_itx.get_pers_curr (a.hrm_employee_id,
                                 a.his_pay_period) currency,
          hrm_itx.get_pers_rate (a.hrm_employee_id,
                                 a.his_pay_period) emp_rate, e.elr_root_code,
          f.erd_descr,
          CASE
             WHEN b.coe_inverse = 1
                THEN his_pay_sum_val * (-1)
             ELSE his_pay_sum_val
          END his_pay_sum_val,
          CASE
             WHEN pcs.extractline (b.coe_box, 1, '_') = 'CHF'
                THEN case
                      when hrm_itx.SUMELEMBYDEC(a.hrm_employee_id,'CemCHFTauxBloquPLP',a.his_pay_period,a.his_pay_period,a.hrm_salary_sheet_id)=0 OR pcs.extractline(b.coe_box, 2, '_')='BLOQ'
                      then 1
                      else hrm_itx.SUMELEMBYDEC(a.hrm_employee_id,'CemCHFTauxBloquPLP',a.his_pay_period,a.his_pay_period,a.hrm_salary_sheet_id)
                     end
             WHEN pcs.extractline (b.coe_box, 1, '_') = 'EUR'
                THEN case
                      when hrm_itx.SUMELEMBYDEC(a.hrm_employee_id,'CemEURTauxBloquPLP',a.his_pay_period,a.his_pay_period,a.hrm_salary_sheet_id)=0 OR pcs.extractline(b.coe_box, 2, '_')='BLOQ'
                      then hrm_functions.sumelem (a.hrm_employee_id,'DivEURTaux',a.his_pay_period,a.his_pay_period)
                      else hrm_itx.SUMELEMBYDEC(a.hrm_employee_id,'CemEURTauxBloquPLP',a.his_pay_period,a.his_pay_period,a.hrm_salary_sheet_id)
                     end
             WHEN pcs.extractline (b.coe_box, 1, '_') = 'USD'
                THEN case
                      when hrm_itx.SUMELEMBYDEC(a.hrm_employee_id,'CemUSDTauxBloquPLP',a.his_pay_period,a.his_pay_period,a.hrm_salary_sheet_id)=0 OR pcs.extractline(b.coe_box, 2, '_')='BLOQ'
                      then hrm_functions.sumelem (a.hrm_employee_id,'DivUSDTaux',a.his_pay_period,a.his_pay_period)
                      else hrm_itx.SUMELEMBYDEC(a.hrm_employee_id,'CemUSDTauxBloquPLP',a.his_pay_period,a.his_pay_period,a.hrm_salary_sheet_id)
                     end
          END curr_rate,
          pcs.extractline (b.coe_box, 1, '_') curr_plan,
          pcs.extractline (b.coe_box, 2, '_') coti_type,
          pcs.extractline (b.coe_box, 3, '_') coti_break
     FROM hrm_history_detail a,
          hrm_control_elements b,
          hrm_control_list c,
          hrm_person d,
          hrm_elements_root e,
          hrm_elements_root_descr f
    WHERE a.hrm_elements_id = b.hrm_control_elements_id
      AND b.hrm_control_list_id = c.hrm_control_list_id
      AND a.hrm_employee_id = d.hrm_person_id
      AND a.hrm_elements_id = e.hrm_elements_id
      AND e.hrm_elements_root_id = f.hrm_elements_root_id
      AND f.pc_lang_id = 1
      AND UPPER (c.col_name) IN
                   ('LISTE PLAN DE PENSION SWI', 'LISTE PLAN DE PENSION AIG', 'LISTE PLAN DE PENSION ALI')



  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_REP_BREAK_CGDIV2" ("HRM_HISTORY_DETAIL_ID", "HRM_BREAK_ID", "HRM_ELEMENTS_ID", "V_HBC_ACC_NUM", "ACC_NUMBER", "V_HBC_DIV_NUM", "DIV_NAME", "V_HBC_AMOUNT", "V_HBC_DEBIT_AMOUNT", "V_HBC_CREDIT_AMOUNT", "V_HBC_AMOUNT_TYPE", "SAB_PAY_DATE", "SAB_REF_VALUE", "SAB_ZL", "CURRENCY", "ACS_CPN_ACCOUNT_ID", "ELE_DESCR", "BRK_DESCRIPTION", "ELE_CODE", "ELE_STAT_CODE", "ELE_GROUP", "ACC_DESCR", "PER_FULLNAME", "PER_LAST_NAME", "ELE_LANGID", "VALUE_DATE", "BREAK_DATE", "CURRENCY2", "ACS_FINANCIAL_CURRENCY_ID2", "V_HBC_AMOUNT_ME", "V_HBC_DEBIT_AMOUNT_ME", "V_HBC_CREDIT_AMOUNT_ME") AS
  SELECT
  hrm_history_detail_id,
  hrm_break_id,
  b.hrm_elements_id,
  v_hbc_acc_num,
  v_hbc_acc_name,
  v_hbc_div_num,
  v_hbc_div_name,
  v_hbc_amount,
  v_hbc_debit_amount,
  v_hbc_credit_amount,
  v_hbc_amount_type,
  sab_pay_date,
  sab_ref_value,
  sab_zl,
  currency,
  null acs_cpn_account_id,
  rd.erd_descr,
  brk_description,
  b.ele_code,
  b.ele_stat_code,
  rd.erd_descr||to_char(f.hrm_elements_id) ele_group,
  v_hbc_acc_name acc_descr,
  per_fullname,
  per_last_name,
  rd.pc_lang_id,
  value_date,
  break_date,
  currency2,
  acs_financial_currency_id2,
  v_hbc_amount_me,
  v_hbc_debit_amount_me,
  v_hbc_credit_amount_me
FROM
  hrm_person p,
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  v_ind_hrm_break_cgdiv2 b
WHERE
  p.hrm_person_id=b.hrm_employee_id and
  rd.hrm_elements_root_id = f.hrm_elements_root_id and
  f.hrm_elements_id = b.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_REP_BREAK_STRUCTURE" ("HRM_ELEMENTS_ROOT_ID", "HRM_ELEMENTS_ID", "ELR_ROOT_CODE", "ELEMENTS", "COMPTECREDIT", "COMPTEDEBIT", "COMPTECREDIT_SHORT", "COMPTEDEBIT_SHORT", "LANGID") AS
  SELECT
  r.hrm_elements_root_id,
  f.hrm_elements_id,
  r.elr_root_code,
  rd.erd_descr||' ('||a.bre_item_name||')' ELEMENTS,
  ccg.ald_acc_name||decode(cdiv.ald_acc_name,'','','(DIV)')||decode(ccg.hrm_break_shift_id,0,'','','','  +['||cs.brs_code||']') COMPTECREDIT,
  dcg.ald_acc_name||decode(ddiv.ald_acc_name,'','','(DIV)')||decode(dcg.hrm_break_shift_id,0,'','','','  +['||ds.brs_code||']') COMPTEDEBIT,
  ccg.ald_acc_name||decode(cdiv.ald_acc_name,'','','(DIV)')||decode(ccg.hrm_break_shift_id,0,'','','','  +[Dpl.]') COMPTECREDIT_SHORT,
  dcg.ald_acc_name||decode(ddiv.ald_acc_name,'','','(DIV)')||decode(dcg.hrm_break_shift_id,0,'','','','  +[Dpl.]') COMPTEDEBIT_SHORT,
  rd.pc_lang_id LANGID
FROM
  hrm_elements_root_descr rd,
  hrm_elements_family f,
  hrm_allocation_detail cdiv,
  hrm_allocation_detail ddiv,
  hrm_break_shift cs,
  hrm_allocation_detail ccg,
  hrm_break_shift ds,
  hrm_allocation_detail dcg,
  hrm_break_structure a,
  hrm_elements_root r
WHERE
  -- Elment
  rd.hrm_elements_root_id = f.hrm_elements_root_id AND
  f.hrm_elements_id = a.bre_item_id AND
  f.hrm_elements_root_id=r.hrm_elements_root_id AND
  -- DIV Crdit
  cdiv.DIC_ACCOUNT_TYPE_ID(+) = 'DIV' AND
  cdiv.ald_rate(+) = -1 AND
  cdiv.hrm_allocation_id(+) = a.hrm_allocation_id AND
  -- DIV Dbit
  ddiv.DIC_ACCOUNT_TYPE_ID(+) = 'DIV' AND
  ddiv.ald_rate(+) = 1 AND
  ddiv.hrm_allocation_id(+) = a.hrm_allocation_id AND
  -- CG Crdit
  cs.hrm_break_shift_id(+) = ccg.hrm_break_shift_id AND
  ccg.DIC_ACCOUNT_TYPE_ID(+) = 'CG' AND
  ccg.ald_rate(+) = -1 AND
  ccg.hrm_allocation_id(+) = a.hrm_allocation_id AND
  -- CG Dbit
  ds.hrm_break_shift_id(+) = dcg.hrm_break_shift_id AND
  dcg.DIC_ACCOUNT_TYPE_ID(+) = 'CG' AND
  dcg.ald_rate(+) = 1 AND
  dcg.hrm_allocation_id(+) = a.hrm_allocation_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_REP_CONTROL_ACCESS" ("HRM_PERSON_ID", "SEARCHNAME", "EMP_STATUS", "EMP_NUMBER", "DIC_NATIONALITY_ID", "EMP_GROUP_ENTRY", "DIC_HRM_EMP_TYPE_ID", "HEB_DEPARTMENT_ID") AS
  SELECT
  per.hrm_person_id,
  upper(per_title||' '||per_last_name||' '||per_first_name) SEARCHNAME,
  emp_status,
  emp_number,
  dic_nationality_id,
  emp_group_entry,
  dic_hrm_emp_type_id,
  heb_department_id
FROM
  hrm_person per,
  (select *
     from hrm_person_tax
    where emp_tax_year = to_char(hrm_date.beginofyear, 'yyyy') ) tax,
    HRM_EMPLOYEE_BREAK heb
WHERE tax.hrm_person_id(+) = heb.hrm_employee_id and
per.hrm_person_id = heb.hrm_employee_id and
emp_status = 'ACT'
group by
  per.hrm_person_id,upper(per_title||' '||per_last_name||' '||per_first_name),
  emp_status,
  emp_number,
  dic_nationality_id,
  emp_group_entry,
  dic_hrm_emp_type_id,
  heb_Department_id
Order by
  heb_Department_id,
  dic_hrm_emp_type_id,
  emp_number


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_SPLIT_FACT" ("HRM_EMPLOYEE_ID", "PER_FULLNAME", "EMP_NUMBER", "EMP_STATUS", "HEB_DIV_NUMBER") AS
  select
hrm_person_id hrm_employee_id,
PER_LAST_NAME||' '||PER_FIRST_NAME PER_FULLNAME,
EMP_NUMBER,
emp_status,
(select max(heb_rco_title)
 from hrm_employee_break bre
 where bre.hrm_employee_id=a.hrm_person_id) heb_div_number
from
hrm_person a
where
exists (select count(*), hrm_employee_id
            from (select distinct rco_title, hrm_employee_id
                  from ind_hrm_group1_affect) g
            where a.hrm_person_id=g.hrm_employee_id
            group by hrm_employee_id
            having count(*)>1)



  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_TO_PAY" ("HRM_EMPLOYEE_ID", "HRM_HISTORY_DETAIL_ID", "HRM_SALARY_SHEET_ID", "PER_FULLNAME", "PER_SEARCH_NAME", "EMP_NUMBER", "HIS_PAY_NUM", "HIS_PAY_PERIOD", "PERIOD_YYYYMM", "HIS_PAY_SUM_VAL", "CURRENCY", "HIS_PAY_SUM_VAL_DEV", "RATE", "HIS_DEFINITIVE") AS
  select
a.hrm_employee_id,
hrm_history_detail_id,
hrm_salary_sheet_id,
per_last_name||' '||per_first_name per_fullname,
per_search_name,
emp_number,
his_pay_num,
his_pay_period,
to_char(his_pay_period,'YYYYMM') period_yyyymm,
his_pay_sum_val his_pay_sum_val,
hrm_itx.get_pers_curr(a.hrm_employee_id,his_pay_period) currency,
round(his_pay_sum_val/hrm_itx.get_pers_rate(a.hrm_employee_id,his_pay_period),2) his_pay_sum_val_dev,
hrm_itx.get_pers_rate(a.hrm_employee_id,his_pay_period) rate,
his_definitive
from
hrm_history_detail a,
hrm_person b,
(select hrm_elements_id
 from hrm_elements
 where ele_code='CemMontantPaye') c
where
a.hrm_employee_id=b.hrm_person_id
and a.hrm_elements_id=c.hrm_elements_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_HRM_VIE" ("HRM_EMPLOYEE_ID", "PER_LAST_NAME", "PER_FIRST_NAME", "PER_FULLNAME", "EMP_NUMBER", "PER_GENDER", "C_CIVIL_STATUS", "NB_CHILD", "PER_BIRTH_DATE", "PAYS_AFFECT", "HIS_PAY_PERIOD", "PERIOD", "CURRENCY", "EMP_RATE", "ELR_ROOT_CODE", "ERD_DESCR", "COE_BOX", "HIS_PAY_SUM_VAL") AS
  select
a.hrm_employee_id,
d.per_last_name,
d.per_first_name,
d.per_last_name||' '||d.per_first_name per_fullname,
d.emp_number,
d.per_gender,
d.c_civil_status,
(select count(*)
 from hrm_related_to rel
 where a.hrm_employee_id=rel.hrm_employee_id
 and c_related_to_type=2) nb_child,
d.per_birth_date,
hrm_itx.GetPaysAffectPeriod(a.hrm_employee_id,to_char(a.his_pay_period,'YYYYMM')) pays_affect,
a.his_pay_period,
to_char(a.his_pay_period,'YYYYMM') period,
hrm_itx.GET_PERS_CURR(a.hrm_employee_id,a.his_pay_period) currency,
hrm_itx.GET_PERS_RATE(a.hrm_employee_id,a.his_pay_period) emp_rate,
e.elr_root_code,
f.erd_descr,
b.coe_box,
case
 when b.coe_inverse=1 then his_pay_sum_val*(-1)
 else his_pay_sum_val
end his_pay_sum_val
from
hrm_history_detail a,
hrm_control_elements b,
hrm_control_list c,
hrm_person d,
hrm_elements_root e,
hrm_elements_root_descr f
where
a.hrm_elements_id=b.hrm_control_elements_id
and b.hrm_control_list_id=c.hrm_control_list_id
and a.hrm_employee_id=d.hrm_person_id
and a.hrm_elements_id=e.hrm_elements_id
and e.hrm_elements_root_id=f.hrm_elements_root_id
and f.pc_lang_id=1
and upper(c.col_name) in ('LISTE ASSURANCE VIE')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_LAST_HRM_CONTRACT" ("HRM_CONTRACT_ID", "HRM_EMPLOYEE_ID", "DIC_SALARY_NUMBER_ID", "DIC_CONTRACT_CATEGORY_ID", "COM_OLE_ID", "DIC_NOTICE_TYPE_ID", "C_CONTRACT_TYPE", "C_CONTRACT_STATUS", "CON_DESCR", "CON_COMMENTS", "CON_BEGIN", "CON_END", "CON_TRYPERIOD_BEGIN", "CON_TRYPERIOD_END", "CON_NOTICE_MONTH", "CON_NOTICE_DONE", "HRM_IN_OUT_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS") AS
  select
a."HRM_CONTRACT_ID",a."HRM_EMPLOYEE_ID",a."DIC_SALARY_NUMBER_ID",a."DIC_CONTRACT_CATEGORY_ID",a."COM_OLE_ID",a."DIC_NOTICE_TYPE_ID",a."C_CONTRACT_TYPE",a."C_CONTRACT_STATUS",a."CON_DESCR",a."CON_COMMENTS",a."CON_BEGIN",a."CON_END",a."CON_TRYPERIOD_BEGIN",a."CON_TRYPERIOD_END",a."CON_NOTICE_MONTH",a."CON_NOTICE_DONE",a."HRM_IN_OUT_ID",a."A_DATECRE",a."A_DATEMOD",a."A_IDCRE",a."A_IDMOD",a."A_RECLEVEL",a."A_RECSTATUS"
from
hrm_contract a,
(select
 max(hrm_contract_id) hrm_contract_id, hrm_employee_id
 from
 (select
  c1.hrm_contract_id, c1.hrm_employee_id
  from
  hrm_contract c1,
  (select max(con_begin) con_begin, hrm_employee_id from hrm_contract group by hrm_employee_id) c2
  where
  c1.hrm_employee_id= c2.hrm_employee_id
  and c1.con_begin=c2.con_begin)
 group by hrm_employee_id) b
where
a.hrm_contract_id=b.hrm_contract_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_LAST_HRM_IN_OUT" ("HRM_IN_OUT_ID", "HRM_EMPLOYEE_ID", "DIC_IN_TYPE_ID", "DIC_OUT_TYPE_ID", "C_IN_OUT_STATUS", "C_IN_OUT_CATEGORY", "INO_IN", "INO_OUT", "INO_COMMENTS", "INO_FINAL_PAYMENT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "HRM_ESTABLISHMENT_ID") AS
  select
i1."HRM_IN_OUT_ID",i1."HRM_EMPLOYEE_ID",i1."DIC_IN_TYPE_ID",i1."DIC_OUT_TYPE_ID",i1."C_IN_OUT_STATUS",i1."C_IN_OUT_CATEGORY",i1."INO_IN",i1."INO_OUT",i1."INO_COMMENTS",i1."INO_FINAL_PAYMENT",i1."A_DATECRE",i1."A_DATEMOD",i1."A_IDCRE",i1."A_IDMOD",i1."A_RECLEVEL",i1."A_RECSTATUS",i1."HRM_ESTABLISHMENT_ID"
from
hrm_in_out i1,
(select max(ino_in) ino_in, hrm_employee_id from hrm_in_out group by hrm_employee_id) i2
where
i1.hrm_employee_id= i2.hrm_employee_id
and i1.ino_in=i2.ino_in




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_IND_LAST_HRM_PERSON_JOB" ("HRM_PERSON_JOB_ID", "HRM_JOB_ID", "HRM_IN_OUT_ID", "HRM_PERSON_ID", "PEJ_FROM", "PEJ_TO", "PEJ_AFFECT_RATE", "PEJ_MAIN_JOB", "PEJ_ANNUAL_SALARY", "PEJ_CLASSIFICATION", "PEJ_FREE_01", "PEJ_FREE_02", "PEJ_FREE_03", "PEJ_FREE_04", "PEJ_FREE_05", "PEJ_FREE_06", "PEJ_FREE_07", "PEJ_FREE_08", "PEJ_FREE_09", "PEJ_FREE_10") AS
  select
a."HRM_PERSON_JOB_ID",a."HRM_JOB_ID",a."HRM_IN_OUT_ID",a."HRM_PERSON_ID",a."PEJ_FROM",a."PEJ_TO",a."PEJ_AFFECT_RATE",a."PEJ_MAIN_JOB",a."PEJ_ANNUAL_SALARY",a."PEJ_CLASSIFICATION",a."PEJ_FREE_01",a."PEJ_FREE_02",a."PEJ_FREE_03",a."PEJ_FREE_04",a."PEJ_FREE_05",a."PEJ_FREE_06",a."PEJ_FREE_07",a."PEJ_FREE_08",a."PEJ_FREE_09",a."PEJ_FREE_10"
from
hrm_person_job a,
(select
 max(pj1.hrm_person_job_id) hrm_person_job_id, pj1.hrm_person_id
 from
 hrm_person_job pj1,
 (select max(pej_from) pej_from, hrm_person_id from hrm_person_job group by hrm_person_id) pj2
  where
  pj1.hrm_person_id= pj2.hrm_person_id
  and pj1.pej_from=pj2.pej_from
 group by pj1.hrm_person_id) b
where
a.hrm_person_job_id=b.hrm_person_job_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_LPM_CATALOG_RIGHTS" ("LPM_EVENT_CATALOG_ID", "CAT_HEALTH_INFOS", "HRM_PERSON_ID") AS
  SELECT DISTINCT
          cat.lpm_event_catalog_ID, cat.cat_health_infos, emp.hrm_person_id
     FROM lpm_event_catalog cat,
          lpm_matrix_notification mat,
          lpm_job ljo,
          lpm_allocation alo,
          lpm_employee emp
    WHERE     cat.lpm_event_catalog_ID = mat.Lpm_event_catalog_ID
          AND mat.mat_read_rights = 1
          AND mat.DIC_RESPONSABILITY_ID = ljo.dic_responsability_id
          AND ljo.hrm_job_id = alo.hrm_job_id
          AND alo.hrm_person_id = emp.hrm_person_id
          AND TRUNC (SYSDATE) BETWEEN alo.pej_from
                                  AND NVL (alo.pej_to, TRUNC (SYSDATE))


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_LPM_HEALTH_INFO_STATUS" ("LPM_HEALTH_INFO_ID", "HIN_COMPLETE_STATUS") AS
  SELECT hin.lpm_health_info_id, 1
     FROM lpm_health_info hin
    WHERE     hin.hin_Status <> 999
          AND TRUNC (SYSDATE) BETWEEN TRUNC (HIN.HIN_START_DATE)
                                  AND NVL (TRUNC (hin_end_date),
                                           TRUNC (SYSDATE))
   UNION
   -- Infos sant Futures
   SELECT hin.lpm_health_info_id, 2
     FROM lpm_health_info hin
    WHERE     hin.hin_Status <> 999
          AND TRUNC (SYSDATE) < TRUNC (HIN.HIN_START_DATE)
   UNION
   -- Infos sant Echues
   SELECT hin.lpm_health_info_id, 3
     FROM lpm_health_info hin
    WHERE hin.hin_Status <> 999 AND TRUNC (hin_end_date) < TRUNC (SYSDATE)
   UNION
   -- Infos sant Archives
   SELECT hin.lpm_health_info_id, 4
     FROM lpm_health_info hin,
          (  SELECT MAX (arch.lpm_health_info_id) lpm_health_info_id,
                    bat.lpm_event_batch_id
               FROM lpm_health_info arch, lpm_event eve, lpm_event_batch bat
              WHERE     ARCH.hin_status = 999
                    AND ARCH.LPM_EVENT_ID = EVE.LPM_EVENT_ID
                    AND eve.lpm_event_batch_id = BAT.LPM_EVENT_BATCH_ID
           GROUP BY bat.lpm_event_batch_id) hin_arch
    WHERE     hin.hin_Status = 999
          AND hin.lpm_health_info_id = hin_arch.lpm_health_info_id
          AND NOT EXISTS
                     (SELECT 1
                        FROM lpm_health_info hin2, lpm_event eve2
                       WHERE     hin2.lpm_event_id = eve2.lpm_event_id
                             AND eve2.lpm_event_batch_id =
                                    hin_arch.lpm_event_batch_id
                             AND hin2.hin_status <> 999)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_LTM_HISTO_DATA" ("LTM_ROWNUM", "LTM_LEVEL", "LTM_HISTO_DATA_ID", "LTM_HISTO_DATA_PARENT_ID", "LHD_DATE", "LHD_USER", "LHD_REC_ID", "LHD_TABLE_ID", "LHD_TABLE", "LHD_FIELD", "LHD_VALUE", "LHD_MODE", "LHD_TYPE") AS
  select
  ROWNUM,
  LEVEL,
  LTM_HISTO_DATA_ID,
  LTM_HISTO_DATA_PARENT_ID,
  LHD_DATE,
  LHD_USER,
  LHD_REC_ID,
  LHD_TABLE_ID,
  LHD_TABLE,
  LHD_FIELD,
  LHD_VALUE,
  LHD_MODE,
  LHD_TYPE
from
  LTM_HISTO_DATA
start with
  LTM_HISTO_DATA_PARENT_ID is null
connect by prior
  LTM_HISTO_DATA_ID = LTM_HISTO_DATA_PARENT_ID
order siblings by
  LHD_DATE desc, LTM_HISTO_DATA_PARENT_ID, LTM_HISTO_DATA_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_LTM_HISTO_DATA_LIST" ("LTM_ROWNUM", "LTM_LEVEL", "LTM_HISTO_DATA_ID", "LTM_HISTO_DATA_PARENT_ID", "LHD_REC_ID", "LHD_DATE", "LHD_USER", "LHD_TABLE", "TDE_DESCR", "LHD_FIELD", "FDILABEL", "LHD_VALUE", "LHD_MODE", "PREC_VALUE", "PC_LANG_ID") AS
  select
  V.LTM_ROWNUM,
  V.LTM_LEVEL,
  V.LTM_HISTO_DATA_ID,
  V.LTM_HISTO_DATA_PARENT_ID,
  V.LHD_REC_ID,
  V.LHD_DATE,
  V.LHD_USER,
  V.LHD_TABLE,
  Nvl((select TDE_DESCR from PCS.PC_TABLE_DESCR
       where PC_LANG_ID = L.PC_LANG_ID and
         PC_TABLE_ID = (select PC_TABLE_ID from PCS.PC_TABLE
                        where TABNAME = V.LHD_TABLE)),
      V.LHD_TABLE) TDE_DESCR,
  V.LHD_FIELD,
  Nvl((select FDILABEL from PCS.PC_FDICO
       where PC_LANG_ID = L.PC_LANG_ID and
         PC_FLDSC_ID = (select PC_FLDSC_ID from PCS.PC_FLDSC
                        where FLDNAME = V.LHD_FIELD and FLDVISIBLE = 1 and PC_OBJECT_ID is null)),
      V.LHD_FIELD) FDILABEL,
  case
    when V.LHD_MODE != 'DELETE' then V.LHD_VALUE
  end LHD_VALUE,
  V.LHD_MODE,
  case when V.LHD_MODE in ('UPDATE','DELETE') then
    Lead(LHD_VALUE) over (partition by LHD_TABLE_ID, LHD_FIELD order by LHD_DATE desc)
  end PREC_VALUE,
  L.PC_LANG_ID
from
  PCS.PC_LANG L,
  V_LTM_HISTO_DATA V
where
  V.LHD_TYPE = 'FIELD' and V.LHD_TABLE_ID != 0 and
  V.LHD_FIELD not in ('A_DATECRE','A_DATEMOD','A_IDCRE','A_IDMOD') and
  L.LANUSED = 1
order by
  V.LHD_DATE desc, V.LTM_HISTO_DATA_PARENT_ID nulls first, V.LTM_LEVEL


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_MGM_TOT_AND_BUDGET" ("TYP", "FYE_NO_EXERCICE", "PER_NO_PERIOD", "BUD_DESCR", "VER_NUMBER", "VER_DEFAULT", "VER_MULTI_CURRENCY", "PER_CURRENCY_RATE", "ACS_CPN_ACCOUNT_ID", "ACS_CDA_ACCOUNT_ID", "ACS_PF_ACCOUNT_ID", "ACS_PJ_ACCOUNT_ID", "LC_CURRENCY_ID", "BUD_AMOUNT_LC_D", "BUD_AMOUNT_LC_C", "AMOUNT_LC_D", "AMOUNT_LC_C", "FC_CURRENCY_ID", "BUD_AMOUNT_FC_D", "BUD_AMOUNT_FC_C", "AMOUNT_FC_D", "AMOUNT_FC_C", "C_TYPE_CUMUL") AS
  select 'EFF' TYP
       , (select YEA.FYE_NO_EXERCICE
            from ACS_PERIOD PER
               , ACS_FINANCIAL_YEAR YEA
           where TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
             and PER.ACS_FINANCIAL_YEAR_ID = YEA.ACS_FINANCIAL_YEAR_ID) FYE_NO_EXERCICE
       , (select PER.PER_NO_PERIOD
            from ACS_PERIOD PER
           where TOT.ACS_PERIOD_ID = PER.ACS_PERIOD_ID) PER_NO_PERIOD
       , PCS.PC_FUNCTIONS.TranslateWord('Montants effectifs') BUD_DESCR
       , PCS.PC_FUNCTIONS.TranslateWord('Montants effectifs') VER_NUMBER
       , null VER_DEFAULT
       , null VER_MULTI_CURRENCY
       , null PER_CURRENCY_RATE
       , TOT.ACS_CPN_ACCOUNT_ID
       , TOT.ACS_CDA_ACCOUNT_ID
       , TOT.ACS_PF_ACCOUNT_ID
       , TOT.ACS_PJ_ACCOUNT_ID
       , TOT.ACS_ACS_FINANCIAL_CURRENCY_ID LC_CURRENCY_ID
       , 0 BUD_AMOUNT_LC_D
       , 0 BUD_AMOUNT_LC_C
       , TOT.MTO_DEBIT_LC
       , TOT.MTO_CREDIT_LC
       , TOT.ACS_FINANCIAL_CURRENCY_ID FC_CURRENCY_ID
       , 0 BUD_AMOUNT_FC_D
       , 0 BUD_AMOUNT_FC_C
       , TOT.MTO_DEBIT_FC
       , TOT.MTO_CREDIT_FC
       , TOT.C_TYPE_CUMUL
    from ACT_MGM_TOT_BY_PERIOD TOT
  union all
  select 'BUD' TYP
       , FYE.FYE_NO_EXERCICE
       , PER.PER_NO_PERIOD
       , BUD.BUD_DESCR
       , BUD.VER_NUMBER
       , BUD.VER_DEFAULT
       , BUD.VER_MULTI_CURRENCY
       , RAT.PER_CURRENCY_RATE
       , BUD.ACS_CPN_ACCOUNT_ID
       , BUD.ACS_CDA_ACCOUNT_ID
       , BUD.ACS_PF_ACCOUNT_ID
       , BUD.ACS_PJ_ACCOUNT_ID
       , BUD.ACS_ACS_FINANCIAL_CURRENCY_ID LC_CURRENCY_ID
       , BUD.PER_AMOUNT_D BUD_AMOUNT_LC_D
       , BUD.PER_AMOUNT_C BUD_AMOUNT_LC_C
       , 0 MTO_DEBIT_LC
       , 0 MTO_CREDIT_LC
       , BUD.ACS_FINANCIAL_CURRENCY_ID FC_CURRENCY_ID
       , BUD.PER_AMOUNT_FC_D BUD_AMOUNT_FC_D
       , BUD.PER_AMOUNT_FC_C BUD_AMOUNT_FC_C
       , 0 MTO_DEBIT_FC
       , 0 MTO_CREDIT_FC
       , '' C_TYPE_CUMUL
    from V_ACB_REP_BUDGET BUD
       , ACB_PERIOD_RATE RAT
       , ACB_CURRENCY BCU
       , ACS_PERIOD PER
       , ACS_FINANCIAL_YEAR FYE
   where BUD.ACS_PERIOD_ID = PER.ACS_PERIOD_ID
     and BUD.ACS_PERIOD_ID = RAT.ACS_PERIOD_ID
     and BUD.ACS_FINANCIAL_CURRENCY_ID = BCU.ACS_FINANCIAL_CURRENCY_ID(+)
     and BCU.ACB_CURRENCY_ID = RAT.ACB_CURRENCY_ID
     and BUD.ACB_BUDGET_VERSION_ID = BCU.ACB_BUDGET_VERSION_ID(+)
     and PER.ACS_FINANCIAL_YEAR_ID = FYE.ACS_FINANCIAL_YEAR_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_CAMPAIGN_MAILING_SAMPLE" ("PER_NAME", "CONTACT_NAME", "ADDRESS", "PER_FORMULA1", "PER_FORMULA2", "PER_FORMULA3", "PER_FORMULA4", "CON_FORMULA1", "CON_FORMULA2", "CON_FORMULA3", "CON_FORMULA4", "EMAIL", "NFAX", "PAC_PERSON_ID", "PAC_PAC_PERSON_ID", "PAC_CAMPAIGN_EVENT_ID", "EVE_PRIVATE", "EVE_DATE", "EVE_ENDED", "EVE_NUMBER", "EVE_SUBJECT", "EVE_ENDDATE", "GCO_GOOD_ID", "DOC_DOCUMENT_ID", "CML_POSITION_ID", "EVE_PERCENT_COMPLETE", "EVE_DATE_COMPLETED", "EVE_ENTRY_ID", "DIC_EVE_INCIDENT_ORIGIN_ID", "EVE_TEXT") AS
  select PER_NAME
       , CON_NAME CONTACT_NAME
       , case
           when PAC_ADDRESS_FORMAT_ID is not null then pac_macro.formatAddress(PAC_PERSON_ID, PAC_PAC_PERSON_ID, PAC_ADDRESS_FORMAT_ID, DIC_ADDRESS_TYPE_ID)
         end ADDRESS
       , pac_macro.getPolitnessFormula(PER_POLITNESS_ID, per_lang_id, 1) per_formula1
       , pac_macro.getPolitnessFormula(PER_POLITNESS_ID, per_lang_id, 2) per_formula2
       , pac_macro.getPolitnessFormula(PER_POLITNESS_ID, per_lang_id, 3) per_formula3
       , pac_macro.getPolitnessFormula(PER_POLITNESS_ID, per_lang_id, 4) per_formula4
       , pac_macro.getPolitnessFormula(CON_POLITNESS_ID, con_lang_id, 1) con_formula1
       , pac_macro.getPolitnessFormula(CON_POLITNESS_ID, con_lang_id, 2) con_formula2
       , pac_macro.getPolitnessFormula(CON_POLITNESS_ID, con_lang_id, 3) con_formula3
       , pac_macro.getPolitnessFormula(CON_POLITNESS_ID, con_lang_id, 4) con_formula4
       , -- Utilis pour envoyer par email
         case TO_COMPANY
           when 1 then nvl(PAC_FUNCTIONS.GetPartnerMail(PAC_PERSON_ID), PAC_FUNCTIONS.GetPartnerMail(PAC_PAC_PERSON_ID))
           else nvl(PAC_FUNCTIONS.GetPartnerMail(PAC_PAC_PERSON_ID), PAC_FUNCTIONS.GetPartnerMail(PAC_PERSON_ID))
         end EMAIL
       , -- Utilis pour envoyer par fax
         case TO_COMPANY
           when 1 then nvl(PAC_FUNCTIONS.GetPartnerFax(PAC_PERSON_ID), PAC_FUNCTIONS.GetPartnerFax(PAC_PAC_PERSON_ID))
           else nvl(PAC_FUNCTIONS.GetPartnerFax(PAC_PAC_PERSON_ID), PAC_FUNCTIONS.GetPartnerFax(PAC_PERSON_ID))
         end NFAX
       , PAC_PERSON_ID
       , PAC_PAC_PERSON_ID
       , PAC_CAMPAIGN_EVENT_ID
       , -- Event data
         EVE_PRIVATE
       , EVE_DATE
       , EVE_ENDED
       , EVE_NUMBER
       , EVE_SUBJECT
       , EVE_ENDDATE
       , GCO_GOOD_ID
       , DOC_DOCUMENT_ID
       , CML_POSITION_ID
       , EVE_PERCENT_COMPLETE
       , EVE_DATE_COMPLETED
       , EVE_ENTRY_ID
       , DIC_EVE_INCIDENT_ORIGIN_ID
       , EVE_TEXT
    from (select P.PAC_PERSON_ID
               , P.PER_NAME
               , P.DIC_PERSON_POLITNESS_ID PER_POLITNESS_ID
               , (select PC_LANG_ID
                    from PAC_ADDRESS
                   where PAC_ADDRESS_ID = PAC_MACRO.getMinAddressId(P.PAC_PERSON_ID, CE.DIC_ADDRESS_TYPE_ID)) PER_LANG_ID
               , C.PAC_PERSON_ID PAC_PAC_PERSON_ID
               , C.PER_NAME CON_NAME
               , C.DIC_PERSON_POLITNESS_ID CON_POLITNESS_ID
               , case
                   when C.PAC_PERSON_ID is not null then
                     (select A.PC_LANG_ID
                        from PAC_ADDRESS A
                       where A.PAC_ADDRESS_ID = PAC_MACRO.getMinAddressId(C.PAC_PERSON_ID, CE.DIC_ADDRESS_TYPE_ID))
                 end CON_LANG_ID
               , CE.PAC_CAMPAIGN_EVENT_ID
               , CE.DIC_ADDRESS_TYPE_ID
               , case when CE.C_ADDRESSING_TYP in ('3', '4') then 1 else 0 end TO_COMPANY
               , CE.PAC_ADDRESS_FORMAT_ID
               , -- Event data
                 EVE_PRIVATE
               , EVE_DATE
               , EVE_ENDED
               , EVE_NUMBER
               , EVE_SUBJECT
               , EVE_ENDDATE
               , GCO_GOOD_ID
               , DOC_DOCUMENT_ID
               , CML_POSITION_ID
               , EVE_PERCENT_COMPLETE
               , EVE_DATE_COMPLETED
               , EVE_ENTRY_ID
               , EVE_REMDATE
               , EVE_CAPTURE_DATE
               , EVE_CONTACT_NAME
               , EVE_CONTACT_FORENAME
               , DIC_EVE_END_TYPE_ID
               , DIC_EVE_INCIDENT_ID
               , EVE_VERSION
               , DIC_EVE_INCIDENT_ORIGIN_ID
               , EVE_TEXT
            from PAC_PERSON C
               , PAC_PERSON P
               , PAC_PERSON_ASSOCIATION A
               , PAC_EVENT E
               , PAC_CAMPAIGN_EVENT CE
           where E.PAC_CAMPAIGN_EVENT_ID = CE.PAC_CAMPAIGN_EVENT_ID
             and P.PAC_PERSON_ID = E.PAC_PERSON_ID
             and A.PAC_PERSON_ASSOCIATION_ID(+) = E.PAC_ASSOCIATION_ID
             and C.PAC_PERSON_ID(+) = A.PAC_PAC_PERSON_ID
             and E.EVE_ENDED = 0) V


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_CUSTOM_ISAG" ("PAC_PERSON_ID", "PER_KEY1", "PER_KEY2", "PAC_CUSTOM_PARTNER_ID", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT
PER.PAC_PERSON_ID,
PER.PER_KEY1,
PER.PER_KEY2,
CUS.PAC_CUSTOM_PARTNER_ID,
CUS.ACS_AUXILIARY_ACCOUNT_ID,
AUX.ACC_NUMBER,
CUS.A_DATECRE,
CUS.A_IDCRE,
CUS.A_DATEMOD,
CUS.A_IDMOD
FROM
ACS_ACCOUNT AUX,
PAC_PERSON PER,
PAC_CUSTOM_PARTNER CUS
WHERE
    PER.PAC_PERSON_ID = CUS.PAC_CUSTOM_PARTNER_ID
AND CUS.ACS_AUXILIARY_ACCOUNT_ID = AUX.ACS_ACCOUNT_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_CUSTOM_PARTNER" ("DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PER_SHORT_NAME", "THI_NO_TVA", "THI_NO_INTRA", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_FORMAT", "THI_NO_SIREN", "THI_NO_SIRET", "PAC_ADDRESS_ID", "PAC_PERSON_ID", "PC_CNTRY_ID", "CNTID", "CNTNAME", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "PC_LANG_ID", "LANID", "LANNAME", "ADD_COMMENT", "DIC_ADDRESS_TYPE_ID", "ADD_SINCE", "ADD_FORMAT", "ADD_PRINCIPAL", "DAD_DESCR", "DAD_DEFAULT", "PAC_CUSTOM_PARTNER_ID", "DIC_TYPE_SUBMISSION_ID", "DIC_STATISTIC_1_ID", "DIC_TYPE_PARTNER_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "PAC_REMAINDER_CATEGORY_ID", "PAC_PAYMENT_CONDITION_ID", "ACS_AUXILIARY_ACCOUNT_ID", "C_REMAINDER_LAUNCHING", "CUS_COMMENT", "DIC_TARIFF_ID", "ACS_VAT_DET_ACCOUNT_ID", "C_TARIFFICATION_MODE", "C_PARTNER_CATEGORY", "PAC_REPRESENTATIVE_ID", "PAC_SENDING_CONDITION_ID", "PAC_CALENDAR_TYPE_ID", "C_TYPE_EDI", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "CUS_WITHOUT_REMIND_DATE", "DIC_COMPLEMENTARY_DATA_ID") AS
  select
  PAC_PERSON.DIC_PERSON_POLITNESS_ID, PAC_PERSON.PER_NAME, PAC_PERSON.PER_FORENAME,
  PAC_PERSON.PER_ACTIVITY, PAC_PERSON.PER_COMMENT, PAC_PERSON.PER_KEY1,
  PAC_PERSON.PER_KEY2, PAC_PERSON.DIC_FREE_CODE1_ID, PAC_PERSON.DIC_FREE_CODE2_ID,
  PAC_PERSON.DIC_FREE_CODE3_ID, PAC_PERSON.DIC_FREE_CODE4_ID, PAC_PERSON.DIC_FREE_CODE5_ID,
  PAC_PERSON.DIC_FREE_CODE6_ID, PAC_PERSON.DIC_FREE_CODE7_ID, PAC_PERSON.DIC_FREE_CODE8_ID,
  PAC_PERSON.DIC_FREE_CODE9_ID, PAC_PERSON.DIC_FREE_CODE10_ID, PAC_PERSON.PER_SHORT_NAME,
  PAC_THIRD.THI_NO_TVA, PAC_THIRD.THI_NO_INTRA, PAC_THIRD.DIC_THIRD_ACTIVITY_ID,
  PAC_THIRD.DIC_THIRD_AREA_ID, PAC_THIRD.THI_NO_FORMAT, PAC_THIRD.THI_NO_SIREN,
  PAC_THIRD.THI_NO_SIRET, PAC_ADDRESS.PAC_ADDRESS_ID, PAC_ADDRESS.PAC_PERSON_ID,
  PAC_ADDRESS.PC_CNTRY_ID, PC_CNTRY.CNTID, PC_CNTRY.CNTNAME, PAC_ADDRESS.ADD_ADDRESS1, PAC_ADDRESS.ADD_ZIPCODE,
  PAC_ADDRESS.ADD_CITY, PAC_ADDRESS.ADD_STATE, PAC_ADDRESS.PC_LANG_ID, PC_LANG.LANID, PC_LANG.LANNAME,
  PAC_ADDRESS.ADD_COMMENT, PAC_ADDRESS.DIC_ADDRESS_TYPE_ID, PAC_ADDRESS.ADD_SINCE,
  PAC_ADDRESS.ADD_FORMAT, PAC_ADDRESS.ADD_PRINCIPAL, DIC_ADDRESS_TYPE.DAD_DESCR,
  DIC_ADDRESS_TYPE.DAD_DEFAULT, PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID,
  PAC_CUSTOM_PARTNER.DIC_TYPE_SUBMISSION_ID, PAC_CUSTOM_PARTNER.DIC_STATISTIC_1_ID, PAC_CUSTOM_PARTNER.DIC_TYPE_PARTNER_ID,
  PAC_CUSTOM_PARTNER.DIC_STATISTIC_2_ID, PAC_CUSTOM_PARTNER.DIC_STATISTIC_3_ID, PAC_CUSTOM_PARTNER.DIC_STATISTIC_4_ID,
  PAC_CUSTOM_PARTNER.DIC_STATISTIC_5_ID, PAC_CUSTOM_PARTNER.PAC_REMAINDER_CATEGORY_ID, PAC_CUSTOM_PARTNER.PAC_PAYMENT_CONDITION_ID,
  PAC_CUSTOM_PARTNER.ACS_AUXILIARY_ACCOUNT_ID, PAC_CUSTOM_PARTNER.C_REMAINDER_LAUNCHING,
  PAC_CUSTOM_PARTNER.CUS_COMMENT, PAC_CUSTOM_PARTNER.DIC_TARIFF_ID, PAC_CUSTOM_PARTNER.ACS_VAT_DET_ACCOUNT_ID,
  PAC_CUSTOM_PARTNER.C_TARIFFICATION_MODE, PAC_CUSTOM_PARTNER.C_PARTNER_CATEGORY, PAC_CUSTOM_PARTNER.PAC_REPRESENTATIVE_ID,
  PAC_CUSTOM_PARTNER.PAC_SENDING_CONDITION_ID, PAC_CUSTOM_PARTNER.PAC_CALENDAR_TYPE_ID, PAC_CUSTOM_PARTNER.C_TYPE_EDI,
  PAC_CUSTOM_PARTNER.CUS_FREE_ZONE1, PAC_CUSTOM_PARTNER.CUS_FREE_ZONE2, PAC_CUSTOM_PARTNER.CUS_FREE_ZONE3,
  PAC_CUSTOM_PARTNER.CUS_FREE_ZONE4, PAC_CUSTOM_PARTNER.CUS_FREE_ZONE5, PAC_CUSTOM_PARTNER.CUS_WITHOUT_REMIND_DATE,
  PAC_CUSTOM_PARTNER.DIC_COMPLEMENTARY_DATA_ID
from
  PAC_PERSON PAC_PERSON,
  PAC_THIRD PAC_THIRD,
  PAC_ADDRESS PAC_ADDRESS,
  DIC_ADDRESS_TYPE DIC_ADDRESS_TYPE,
  PAC_CUSTOM_PARTNER PAC_CUSTOM_PARTNER,
  PCS.PC_CNTRY,
  PCS.PC_LANG
where
( PAC_THIRD.PAC_THIRD_ID=PAC_PERSON.PAC_PERSON_ID ) AND
  ( PAC_ADDRESS.PAC_PERSON_ID=PAC_PERSON.PAC_PERSON_ID ) AND
  ( DIC_ADDRESS_TYPE.DIC_ADDRESS_TYPE_ID=PAC_ADDRESS.DIC_ADDRESS_TYPE_ID ) AND
  ( PAC_CUSTOM_PARTNER.PAC_CUSTOM_PARTNER_ID=PAC_THIRD.PAC_THIRD_ID ) AND
  ( PC_CNTRY.PC_CNTRY_ID = PAC_ADDRESS.PC_CNTRY_ID ) AND
  ( PC_LANG.PC_LANG_ID =  PAC_ADDRESS.PC_LANG_ID ) AND
  ( DIC_ADDRESS_TYPE.DAD_DEFAULT = 1 ) AND
  ( PAC_CUSTOM_PARTNER.C_PARTNER_STATUS = '1' )




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_EVENT_MAILING_SAMPLE" ("PAC_PERSON_ID", "PER_LANG_ID", "PAC_ADDRESS_ID", "PAC_PAC_PERSON_ID", "CON_LANG_ID", "CON_ADDRESS_ID", "PAC_EVENT_ID", "PER_NAME", "PER_POLITNESS_ID", "PER_FORMULA1", "PER_FORMULA2", "PER_FORMULA3", "PER_FORMULA4", "PER_ADDRESS", "PER_ADD_FORMAT", "CON_NAME", "CON_POLITNESS_ID", "CON_FORMULA1", "CON_FORMULA2", "CON_FORMULA3", "CON_FORMULA4", "CON_ADDRESS", "CON_ADD_FORMAT", "EVE_PRIVATE", "EVE_DATE", "EVE_ENDED", "EVE_NUMBER", "EVE_SUBJECT", "EVE_ENDDATE", "GCO_GOOD_ID", "DOC_DOCUMENT_ID", "CML_POSITION_ID", "EVE_PERCENT_COMPLETE", "EVE_DATE_COMPLETED", "EVE_ENTRY_ID", "EVE_REMDATE", "EVE_CAPTURE_DATE", "EVE_CONTACT_NAME", "EVE_CONTACT_FORENAME", "DIC_EVE_END_TYPE_ID", "DIC_EVE_INCIDENT_ID", "EVE_VERSION", "DIC_EVE_INCIDENT_ORIGIN_ID", "EVE_TEXT") AS
  select -- REQUIRED
        P.PAC_PERSON_ID
       , PL.PC_LANG_ID PER_LANG_ID
       , PA.PAC_ADDRESS_ID
       , C.PAC_PERSON_ID PAC_PAC_PERSON_ID
       , CL.PC_LANG_ID CON_LANG_ID
       , CA.PAC_ADDRESS_ID CON_ADDRESS_ID
       , E.PAC_EVENT_ID
       , -- MAILING DATA
         P.PER_NAME
       , P.DIC_PERSON_POLITNESS_ID PER_POLITNESS_ID
       , pac_macro.getPolitnessFormula(P.DIC_PERSON_POLITNESS_ID, pl.pc_lang_id, 1) per_formula1
       , pac_macro.getPolitnessFormula(P.DIC_PERSON_POLITNESS_ID, pl.pc_lang_id, 2) per_formula2
       , pac_macro.getPolitnessFormula(P.DIC_PERSON_POLITNESS_ID, pl.pc_lang_id, 3) per_formula3
       , pac_macro.getPolitnessFormula(P.DIC_PERSON_POLITNESS_ID, pl.pc_lang_id, 4) per_formula4
       , PA.ADD_ADDRESS1 PER_ADDRESS
       , PA.ADD_FORMAT PER_ADD_FORMAT
       , C.PER_NAME CON_NAME
       , C.DIC_PERSON_POLITNESS_ID CON_POLITNESS_ID
       , pac_macro.getPolitnessFormula(C.DIC_PERSON_POLITNESS_ID, cl.pc_lang_id, 1) con_formula1
       , pac_macro.getPolitnessFormula(C.DIC_PERSON_POLITNESS_ID, cl.pc_lang_id, 2) con_formula2
       , pac_macro.getPolitnessFormula(C.DIC_PERSON_POLITNESS_ID, cl.pc_lang_id, 3) con_formula3
       , pac_macro.getPolitnessFormula(C.DIC_PERSON_POLITNESS_ID, cl.pc_lang_id, 4) con_formula4
       , CA.ADD_ADDRESS1 CON_ADDRESS
       , CA.ADD_FORMAT CON_ADD_FORMAT
       , E.EVE_PRIVATE
       , E.EVE_DATE
       , E.EVE_ENDED
       , E.EVE_NUMBER
       , E.EVE_SUBJECT
       , E.EVE_ENDDATE
       , E.GCO_GOOD_ID
       , E.DOC_DOCUMENT_ID
       , E.CML_POSITION_ID
       , E.EVE_PERCENT_COMPLETE
       , E.EVE_DATE_COMPLETED
       , E.EVE_ENTRY_ID
       , E.EVE_REMDATE
       , E.EVE_CAPTURE_DATE
       , E.EVE_CONTACT_NAME
       , E.EVE_CONTACT_FORENAME
       , E.DIC_EVE_END_TYPE_ID
       , E.DIC_EVE_INCIDENT_ID
       , E.EVE_VERSION
       , E.DIC_EVE_INCIDENT_ORIGIN_ID
       , E.EVE_TEXT
    from PAC_PERSON C
       , PAC_PERSON P
       , PAC_PERSON_ASSOCIATION A
       , PAC_EVENT E
       , PCS.PC_LANG PL -- Les langues (filt selon modale)
       , PCS.PC_LANG CL -- Les langues (filt selon modale)
       , PAC_ADDRESS PA -- Les addresses de la personnes (filt selon modale)
       , PAC_ADDRESS CA -- Les addresses du contracts (filt selon modale)
   where P.PAC_PERSON_ID = E.PAC_PERSON_ID
     and A.PAC_PERSON_ASSOCIATION_ID(+) = E.PAC_ASSOCIATION_ID
     and C.PAC_PERSON_ID(+) = A.PAC_PAC_PERSON_ID
     and PA.PAC_PERSON_ID(+) = P.PAC_PERSON_ID
     and CA.PAC_PERSON_ID(+) = C.PAC_PERSON_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_FIN_REF_ISAG" ("PAC_FINANCIAL_REFERENCE_ID", "PAC_CUSTOM_PARTNER_ID", "PER_KEY1", "PER_KEY2", "C_PARTNER_STATUS", "C_TYPE_REFERENCE", "GCDTEXT1", "LANID", "C_CHARGES_MANAGEMENT", "FRE_DEFAULT", "FRE_COMMENT", "FRE_ACCOUNT_NUMBER", "FRE_ACCOUNT_CONTROL", "CNTID", "PER_NAME", "PER_FORENAME", "ADD_ADDRESS1", "ADD_FORMAT", "BAN_NAME1", "BAN_NAME2", "BAN_ADR", "BAN_ZIP", "BAN_CITY", "BAN_STATE", "BAN_CLEAR", "FRE_SWIFT", "BAN_BLZ", "FRE_ESTAB", "FRE_POSITION", "FRE_DOM_NAME", "FRE_DOM_CITY", "PC_LANG_ID", "ACS_PAYMENT_METHOD_ID", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD", "DES_PAYMENT_METHOD") AS
  select V."PAC_FINANCIAL_REFERENCE_ID",V."PAC_CUSTOM_PARTNER_ID",V."PER_KEY1",V."PER_KEY2",V."C_PARTNER_STATUS",V."C_TYPE_REFERENCE",V."GCDTEXT1",V."LANID",V."C_CHARGES_MANAGEMENT",V."FRE_DEFAULT",V."FRE_COMMENT",V."FRE_ACCOUNT_NUMBER",V."FRE_ACCOUNT_CONTROL",V."CNTID",V."PER_NAME",V."PER_FORENAME",V."ADD_ADDRESS1",V."ADD_FORMAT",V."BAN_NAME1",V."BAN_NAME2",V."BAN_ADR",V."BAN_ZIP",V."BAN_CITY",V."BAN_STATE",V."BAN_CLEAR",V."FRE_SWIFT",V."BAN_BLZ",V."FRE_ESTAB",V."FRE_POSITION",V."FRE_DOM_NAME",V."FRE_DOM_CITY",V."PC_LANG_ID",V."ACS_PAYMENT_METHOD_ID",V."A_DATECRE",V."A_IDCRE",V."A_DATEMOD",V."A_IDMOD"
       , (select DES.DES_DESCRIPTION_SUMMARY
            from ACS_DESCRIPTION DES
           where DES.ACS_PAYMENT_METHOD_ID = V.ACS_PAYMENT_METHOD_ID
             and DES.PC_LANG_ID = V.PC_LANG_ID) DES_PAYMENT_METHOD
    from (select FRE.PAC_FINANCIAL_REFERENCE_ID
               , FRE.PAC_CUSTOM_PARTNER_ID
               , CUS.PER_KEY1
               , CUS.PER_KEY2
               , FRE.C_PARTNER_STATUS
               , FRE.C_TYPE_REFERENCE
               , GCD.GCDTEXT1
               , GCD.LANID || '' LANID
               , FRE.C_CHARGES_MANAGEMENT
               , FRE.FRE_DEFAULT
               , FRE.FRE_COMMENT
               , FRE.FRE_ACCOUNT_NUMBER
               , FRE.FRE_ACCOUNT_CONTROL
               , nvl(CNB.CNTID, CNT.CNTID) CNTID
               , PER.PER_NAME
               , PER.PER_FORENAME
               , ADR.ADD_ADDRESS1
               , ADR.ADD_FORMAT
               , BAN.BAN_NAME1
               , BAN.BAN_NAME2
               , BAN.BAN_ADR
               , BAN.BAN_ZIP
               , BAN.BAN_CITY
               , BAN.BAN_STATE
               , BAN.BAN_CLEAR
               , nvl(BAN.BAN_SWIFT, FRE.FRE_SWIFT) FRE_SWIFT
               , BAN.BAN_BLZ
               , nvl(BAN.BAN_ETAB, FRE.FRE_ESTAB) FRE_ESTAB
               , nvl(BAN.BAN_GUICH, FRE.FRE_POSITION) FRE_POSITION
               , nvl(BAN.BAN_DOMIC, FRE.FRE_DOM_NAME) FRE_DOM_NAME
               , FRE.FRE_DOM_CITY
               , GCD.PC_LANG_ID
               , case
                   when FRE.ACS_PAYMENT_METHOD_ID is not null then FRE.ACS_PAYMENT_METHOD_ID
                   when CU.ACS_FIN_ACC_S_PAYMENT_ID is not null then (select min(FAC.ACS_PAYMENT_METHOD_ID)
                                                                        from ACS_FIN_ACC_S_PAYMENT FAC
                                                                       where FAC.ACS_FIN_ACC_S_PAYMENT_ID =
                                                                                             CU.ACS_FIN_ACC_S_PAYMENT_ID)
                   when (FRE.C_TYPE_REFERENCE = '2') or
                        (FRE.C_TYPE_REFERENCE = '5' and PAC_BANK_ACCOUNT_FCT.IsSwissPostIBAN(FRE.FRE_ACCOUNT_NUMBER) = 1)
                    then (select min(PME.ACS_PAYMENT_METHOD_ID)
                                                           from ACS_PAYMENT_METHOD PME
                                                              , ACS_FIN_ACC_S_PAYMENT FAC
                                                          where FAC.ACS_PAYMENT_METHOD_ID = PME.ACS_PAYMENT_METHOD_ID
                                                            and PME.C_TYPE_SUPPORT = '56'
                                                            and nvl(to_char(FAC.PMM_AVAILABLE_UNTIL, 'YYYYMMDD')
                                                                  , to_char(trunc(sysdate), 'YYYYMMDD')
                                                                   ) >= to_char(trunc(sysdate), 'YYYYMMDD') )
                   else (select min(PME.ACS_PAYMENT_METHOD_ID)
                           from ACS_PAYMENT_METHOD PME
                              , ACS_FIN_ACC_S_PAYMENT FAC
                          where FAC.ACS_PAYMENT_METHOD_ID = PME.ACS_PAYMENT_METHOD_ID
                            and PME.C_TYPE_SUPPORT in('50', '51', '52', '53', '54', '55', '57', '58', '59')
                            and nvl(to_char(FAC.PMM_AVAILABLE_UNTIL, 'YYYYMMDD'), to_char(trunc(sysdate), 'YYYYMMDD') ) >=
                                                                                     to_char(trunc(sysdate), 'YYYYMMDD') )
                 end ACS_PAYMENT_METHOD_ID
               , FRE.A_DATECRE
               , FRE.A_IDCRE
               , FRE.A_DATEMOD
               , FRE.A_IDMOD
            from PCS.V_PC_DESCODES GCD
               , PCS.PC_CNTRY CNB
               , PCS.PC_CNTRY CNT
               , PCS.PC_BANK BAN
               , PAC_PERSON PER
               , PAC_ADDRESS ADR
               , PAC_CUSTOM_PARTNER CU
               , PAC_PERSON CUS
               , PAC_FINANCIAL_REFERENCE FRE
           where FRE.PAC_CUSTOM_PARTNER_ID = CUS.PAC_PERSON_ID
             and CUS.PAC_PERSON_ID = CU.PAC_CUSTOM_PARTNER_ID
             and FRE.PC_CNTRY_ID = CNT.PC_CNTRY_ID(+)
             and FRE.PC_BANK_ID = BAN.PC_BANK_ID(+)
             and BAN.PC_CNTRY_ID = CNB.PC_CNTRY_ID(+)
             and FRE.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID(+)
             and ADR.PAC_PERSON_ID = PER.PAC_PERSON_ID(+)
             and FRE.C_TYPE_REFERENCE = GCD.GCLCODE
             and GCD.GCGNAME = 'C_TYPE_REFERENCE') V


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_PMT_COND_ISAG" ("PAC_PAYMENT_CONDITION_ID", "DIC_CONDITION_TYP_ID", "PCO_DESCR", "PCO_DEFAULT", "A_DATECRE", "A_IDCRE", "A_DATEMOD", "A_IDMOD") AS
  SELECT PCO.PAC_PAYMENT_CONDITION_ID,
         PCO.DIC_CONDITION_TYP_ID,
         PCO.PCO_DESCR,
         PCO.PCO_DEFAULT,
         PCO.A_DATECRE,
         PCO.A_IDCRE,
         PCO.A_DATEMOD,
         PCO.A_IDMOD
  FROM  PAC_PAYMENT_CONDITION PCO




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_REP_CUSTOM" ("PAC_PERSON_ID", "PER_KEY1", "PER_KEY2", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_SHORT_NAME", "PER_ACTIVITY", "PER_COMMENT", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PAC_CUSTOM_PARTNER_ID", "C_PARTNER_CATEGORY", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "ACS_SUB_SET_ID", "PAC_PAYMENT_CONDITION_ID", "C_PARTNER_STATUS", "ACS_PAYMENT_METHOD_ID", "ACS_FIN_ACC_S_PAYMENT_ID", "C_STATUS_SETTLEMENT", "DIC_TYPE_SUBMISSION_ID", "ACS_VAT_DET_ACCOUNT_ID", "THI_NO_TVA", "THI_NO_INTRA", "C_REMAINDER_LAUNCHING", "CUS_WITHOUT_REMIND_DATE", "PAC_REMAINDER_CATEGORY_ID", "DIC_TYPE_PARTNER_ID", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "PAC_PAC_THIRD_1_ID", "PER_NAME_1", "PER_FORENAME_1", "PAC_PAC_THIRD_2_ID", "PER_NAME_2", "PER_FORENAME_2", "PAC_REPRESENTATIVE_ID", "DIC_PTC_THIRD_GROUP_ID", "DIC_TARIFF_ID", "PAC_SENDING_CONDITION_ID", "CUS_RATE_FOR_VALUE", "PAC_CALENDAR_TYPE_ID", "DIC_COMPLEMENTARY_DATA_ID", "DIC_PIC_GROUP_ID", "C_INCOTERMS", "CUS_INCOTERMS_PLACE", "C_RESERVATION_TYP", "CUS_DELIVERY_DELAY", "CUS_PERIODIC_DELIVERY", "C_DELIVERY_TYP", "DIC_DELIVERY_PERIOD_ID", "C_DOC_CREATION", "CUS_PERIODIC_INVOICING", "DIC_INVOICING_PERIOD_ID", "C_DOC_CREATION_INVOICE", "CUS_MIN_INVOICING", "CUS_MIN_INVOICING_DELAY", "C_BVR_GENERATION_METHOD", "C_TYPE_EDI", "CUS_DATA_EXPORT", "CUS_SUPPLIER_NUMBER", "CUS_EAN_NUMBER", "DOC_GAUGE_ID", "DOC_DOC_GAUGE_ID", "CUS_SUP_COPY1", "CUS_SUP_COPY2", "CUS_SUP_COPY3", "CUS_SUP_COPY4", "CUS_SUP_COPY5", "CUS_SUP_COPY6", "CUS_SUP_COPY7", "CUS_SUP_COPY8", "CUS_SUP_COPY9", "CUS_SUP_COPY10", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "DIC_JURIDICAL_STATUS_ID", "DIC_CITI_CODE_ID", "THI_NO_SIREN", "THI_NO_SIRET", "PAC_PAC_PERSON_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "PC_APPLTXT_ID", "PC__PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "PC_3_PC_APPLTXT_ID", "PC_4_PC_APPLTXT_ID", "CUS_LAPSING_MARGE") AS
  SELECT
  PER.PAC_PERSON_ID,
  PER.PER_KEY1,
  PER.PER_KEY2,
  PER.DIC_PERSON_POLITNESS_ID,
  PER.PER_NAME,
  PER.PER_FORENAME,
  PER.PER_SHORT_NAME,
  PER.PER_ACTIVITY,
  PER.PER_COMMENT,
  PER.DIC_FREE_CODE1_ID,
  PER.DIC_FREE_CODE2_ID,
  PER.DIC_FREE_CODE3_ID,
  PER.DIC_FREE_CODE4_ID,
  PER.DIC_FREE_CODE5_ID,
  PER.DIC_FREE_CODE6_ID,
  PER.DIC_FREE_CODE7_ID,
  PER.DIC_FREE_CODE8_ID,
  PER.DIC_FREE_CODE9_ID,
  PER.DIC_FREE_CODE10_ID,
  CUS.PAC_CUSTOM_PARTNER_ID,
  CUS.C_PARTNER_CATEGORY,
  CUS.ACS_AUXILIARY_ACCOUNT_ID,
  ACC.ACC_NUMBER,
  ACC.ACS_SUB_SET_ID,
  CUS.PAC_PAYMENT_CONDITION_ID,
  CUS.C_PARTNER_STATUS,
  PAY.ACS_PAYMENT_METHOD_ID,
  CUS.ACS_FIN_ACC_S_PAYMENT_ID,
  CUS.C_STATUS_SETTLEMENT,
  CUS.DIC_TYPE_SUBMISSION_ID,
  CUS.ACS_VAT_DET_ACCOUNT_ID,
  THI.THI_NO_TVA,
  THI.THI_NO_INTRA,
  CUS.C_REMAINDER_LAUNCHING,
  CUS.CUS_WITHOUT_REMIND_DATE,
  CUS.PAC_REMAINDER_CATEGORY_ID,
  CUS.DIC_TYPE_PARTNER_ID,
  CUS.CUS_FREE_ZONE1,
  CUS.CUS_FREE_ZONE2,
  CUS.CUS_FREE_ZONE3,
  CUS.CUS_FREE_ZONE4,
  CUS.CUS_FREE_ZONE5,
  CUS.DIC_STATISTIC_1_ID,
  CUS.DIC_STATISTIC_2_ID,
  CUS.DIC_STATISTIC_3_ID,
  CUS.DIC_STATISTIC_4_ID,
  CUS.DIC_STATISTIC_5_ID,
  CUS.PAC_PAC_THIRD_1_ID,
  PE1.PER_NAME,
  PE1.PER_FORENAME,
  CUS.PAC_PAC_THIRD_2_ID,
  PE2.PER_NAME,
  PE2.PER_FORENAME,
  CUS.PAC_REPRESENTATIVE_ID,
  CUS.DIC_PTC_THIRD_GROUP_ID,
  CUS.DIC_TARIFF_ID,
  CUS.PAC_SENDING_CONDITION_ID,
  CUS.CUS_RATE_FOR_VALUE,
  CUS.PAC_CALENDAR_TYPE_ID,
  CUS.DIC_COMPLEMENTARY_DATA_ID,
  CUS.DIC_PIC_GROUP_ID,
  CUS.C_INCOTERMS,
  CUS.CUS_INCOTERMS_PLACE,
  CUS.C_RESERVATION_TYP,
  CUS.CUS_DELIVERY_DELAY,
  CUS.CUS_PERIODIC_DELIVERY,
  CUS.C_DELIVERY_TYP,
  CUS.DIC_DELIVERY_PERIOD_ID,
  CUS.C_DOC_CREATION,
  CUS.CUS_PERIODIC_INVOICING,
  CUS.DIC_INVOICING_PERIOD_ID,
  CUS.C_DOC_CREATION_INVOICE,
  CUS.CUS_MIN_INVOICING,
  CUS.CUS_MIN_INVOICING_DELAY,
  CUS.C_BVR_GENERATION_METHOD,
  CUS.C_TYPE_EDI,
  CUS.CUS_DATA_EXPORT,
  CUS.CUS_SUPPLIER_NUMBER,
  CUS.CUS_EAN_NUMBER,
  CUS.DOC_GAUGE_ID,
  CUS.DOC_DOC_GAUGE_ID,
  CUS.CUS_SUP_COPY1,
  CUS.CUS_SUP_COPY2,
  CUS.CUS_SUP_COPY3,
  CUS.CUS_SUP_COPY4,
  CUS.CUS_SUP_COPY5,
  CUS.CUS_SUP_COPY6,
  CUS.CUS_SUP_COPY7,
  CUS.CUS_SUP_COPY8,
  CUS.CUS_SUP_COPY9,
  CUS.CUS_SUP_COPY10,
  THI.DIC_THIRD_ACTIVITY_ID,
  THI.DIC_THIRD_AREA_ID,
  THI.DIC_JURIDICAL_STATUS_ID,
  THI.DIC_CITI_CODE_ID,
  THI.THI_NO_SIREN,
  THI.THI_NO_SIRET,
  THI.PAC_PAC_PERSON_ID,
  CUS.A_DATECRE,
  CUS.A_DATEMOD,
  CUS.A_IDCRE,
  CUS.A_IDMOD,
  CUS.PC_APPLTXT_ID,
  CUS.PC__PC_APPLTXT_ID,
  CUS.PC_2_PC_APPLTXT_ID,
  CUS.PC_3_PC_APPLTXT_ID,
  CUS.PC_4_PC_APPLTXT_ID,
  CUS.CUS_LAPSING_MARGE
FROM
  PAC_PERSON PE2,
  PAC_PERSON PE1,
  PAC_THIRD THI,
  ACS_FIN_ACC_S_PAYMENT PAY,
  ACS_ACCOUNT ACC,
  PAC_PERSON PER,
  PAC_CUSTOM_PARTNER CUS
WHERE
  PER.PAC_PERSON_ID= CUS.PAC_CUSTOM_PARTNER_ID AND
  CUS.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID(+) AND
  CUS.ACS_FIN_ACC_S_PAYMENT_ID = PAY.ACS_FIN_ACC_S_PAYMENT_ID (+) AND
  CUS.PAC_CUSTOM_PARTNER_ID = THI.PAC_THIRD_ID AND
  CUS.PAC_PAC_THIRD_1_ID = PE1.PAC_PERSON_ID (+) AND
  CUS.PAC_PAC_THIRD_2_ID = PE2.PAC_PERSON_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_REP_PERSON" ("PAC_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_SHORT_NAME", "PER_CONTACT", "PER_COMMENT", "PER_ACTIVITY", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "DIC_JURIDICAL_STATUS_ID", "DIC_CITI_CODE_ID", "THI_NO_SIREN", "THI_NO_SIRET", "THI_NO_TVA", "THI_NO_INTRA", "THI_CUSTOM_NUMBER", "PAC_PAC_PERSON_ID") AS
  SELECT
  PER.PAC_PERSON_ID,
  PER.DIC_PERSON_POLITNESS_ID,
  PER.PER_NAME,
  PER.PER_FORENAME,
  PER.PER_SHORT_NAME,
  PER.PER_CONTACT,
  PER.PER_COMMENT,
  PER.PER_ACTIVITY,
  PER.PER_KEY1,
  PER.PER_KEY2,
  PER.DIC_FREE_CODE1_ID,
  PER.DIC_FREE_CODE2_ID,
  PER.DIC_FREE_CODE3_ID,
  PER.DIC_FREE_CODE4_ID,
  PER.DIC_FREE_CODE5_ID,
  PER.DIC_FREE_CODE6_ID,
  PER.DIC_FREE_CODE7_ID,
  PER.DIC_FREE_CODE8_ID,
  PER.DIC_FREE_CODE9_ID,
  PER.DIC_FREE_CODE10_ID,
  PER.A_DATECRE,
  PER.A_DATEMOD,
  PER.A_IDCRE,
  PER.A_IDMOD,
  THI.DIC_THIRD_ACTIVITY_ID,
  THI.DIC_THIRD_AREA_ID,
  THI.DIC_JURIDICAL_STATUS_ID,
  THI.DIC_CITI_CODE_ID,
  THI.THI_NO_SIREN,
  THI.THI_NO_SIRET,
  THI.THI_NO_TVA,
  THI.THI_NO_INTRA,
  THI.THI_CUSTOM_NUMBER,
  THI.PAC_PAC_PERSON_ID
FROM
   PAC_THIRD THI,
   PAC_PERSON PER
WHERE
   PER.PAC_PERSON_ID = THI.PAC_THIRD_ID(+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_REP_PERSON_ADDRESS" ("PAC_PERSON_ID", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_SHORT_NAME", "PER_ACTIVITY", "PER_KEY1", "PER_KEY2", "ADD_PRINCIPAL", "DIC_ADDRESS_TYPE_ID", "ADD_ADDRESS1", "CNTID", "CNTNAME", "PAC_ADDRESS_ID", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "ADD_FORMAT", "PC_LANG_ID", "C_PARTNER_STATUS") AS
  SELECT
  PER.PAC_PERSON_ID,
  PER.DIC_PERSON_POLITNESS_ID,
  PER.PER_NAME,
  PER.PER_FORENAME,
  PER.PER_SHORT_NAME,
  PER.PER_ACTIVITY,
  PER.PER_KEY1,
  PER.PER_KEY2,
  ADR.ADD_PRINCIPAL,
  ADR.DIC_ADDRESS_TYPE_ID,
  ADR.ADD_ADDRESS1,
  CTY.CNTID,
  CTY.CNTNAME,
  ADR.PAC_ADDRESS_ID,
  ADR.ADD_ZIPCODE,
  ADR.ADD_CITY,
  ADR.ADD_STATE,
  ADR.ADD_FORMAT,
  ADR.PC_LANG_ID,
  ADR.C_PARTNER_STATUS
FROM
  PCS.PC_CNTRY CTY,
  PAC_ADDRESS ADR,
  PAC_PERSON PER
WHERE
  ADR.PAC_PERSON_ID = PER.PAC_PERSON_ID AND
  CTY.PC_CNTRY_ID = ADR.PC_CNTRY_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_REP_SUPPLIER" ("PAC_PERSON_ID", "PER_KEY1", "PER_KEY2", "DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_SHORT_NAME", "PER_ACTIVITY", "PER_COMMENT", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PAC_SUPPLIER_PARTNER_ID", "C_PARTNER_CATEGORY", "ACS_AUXILIARY_ACCOUNT_ID", "ACC_NUMBER", "ACS_SUB_SET_ID", "PAC_PAYMENT_CONDITION_ID", "C_PARTNER_STATUS", "ACS_PAYMENT_METHOD_ID", "ACS_FIN_ACC_S_PAYMENT_ID", "C_STATUS_SETTLEMENT", "DIC_TYPE_SUBMISSION_ID", "ACS_VAT_DET_ACCOUNT_ID", "THI_NO_TVA", "THI_NO_INTRA", "C_REMAINDER_LAUNCHING", "CRE_WITHOUT_REMIND_DATE", "PAC_REMAINDER_CATEGORY_ID", "DIC_TYPE_PARTNER_F_ID", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "PAC_PAC_THIRD_1_ID", "PER_NAME_1", "PER_FORENAME_1", "PAC_PAC_THIRD_2_ID", "PER_NAME_2", "PER_FORENAME_2", "DIC_PTC_THIRD_GROUP_ID", "DIC_TARIFF_ID", "CRE_REMARK", "PAC_SENDING_CONDITION_ID", "PAC_CALENDAR_TYPE_ID", "DIC_COMPLEMENTARY_DATA_ID", "DIC_PIC_GROUP_ID", "C_INCOTERMS", "CRE_INCOTERMS_PLACE", "CRE_SUPPLY_DELAY", "CRE_MANUFACTURER", "C_DELIVERY_TYP", "C_TYPE_EDI", "CRE_DATA_EXPORT", "CRE_CUSTOMER_NUMBER", "CRE_EAN_NUMBER", "CRE_SUP_COPY1", "CRE_SUP_COPY2", "CRE_SUP_COPY3", "CRE_SUP_COPY4", "CRE_SUP_COPY5", "CRE_SUP_COPY6", "CRE_SUP_COPY7", "CRE_SUP_COPY8", "CRE_SUP_COPY9", "CRE_SUP_COPY10", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "DIC_JURIDICAL_STATUS_ID", "DIC_CITI_CODE_ID", "THI_NO_SIREN", "THI_NO_SIRET", "PAC_PAC_PERSON_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "DIC_PRIORITY_PAYMENT_ID", "DIC_CENTER_PAYMENT_ID", "DIC_LEVEL_PRIORITY_ID", "CRE_BLOCKED", "PC_APPLTXT_ID", "PC__PC_APPLTXT_ID", "PC_2_PC_APPLTXT_ID", "PC_3_PC_APPLTXT_ID", "PC_4_PC_APPLTXT_ID", "CRE_DAY_CAPACITY") AS
  SELECT
  PER.PAC_PERSON_ID,
  PER.PER_KEY1,
  PER.PER_KEY2,
  PER.DIC_PERSON_POLITNESS_ID,
  PER.PER_NAME,
  PER.PER_FORENAME,
  PER.PER_SHORT_NAME,
  PER.PER_ACTIVITY,
  PER.PER_COMMENT,
  PER.DIC_FREE_CODE1_ID,
  PER.DIC_FREE_CODE2_ID,
  PER.DIC_FREE_CODE3_ID,
  PER.DIC_FREE_CODE4_ID,
  PER.DIC_FREE_CODE5_ID,
  PER.DIC_FREE_CODE6_ID,
  PER.DIC_FREE_CODE7_ID,
  PER.DIC_FREE_CODE8_ID,
  PER.DIC_FREE_CODE9_ID,
  PER.DIC_FREE_CODE10_ID,
  SUP.PAC_SUPPLIER_PARTNER_ID,
  SUP.C_PARTNER_CATEGORY,
  SUP.ACS_AUXILIARY_ACCOUNT_ID,
  ACC.ACC_NUMBER,
  ACC.ACS_SUB_SET_ID,
  SUP.PAC_PAYMENT_CONDITION_ID,
  SUP.C_PARTNER_STATUS,
  PAY.ACS_PAYMENT_METHOD_ID,
  SUP.ACS_FIN_ACC_S_PAYMENT_ID,
  SUP.C_STATUS_SETTLEMENT,
  SUP.DIC_TYPE_SUBMISSION_ID,
  SUP.ACS_VAT_DET_ACCOUNT_ID,
  THI.THI_NO_TVA,
  THI.THI_NO_INTRA,
  SUP.C_REMAINDER_LAUNCHING,
  SUP.CRE_WITHOUT_REMIND_DATE,
  SUP.PAC_REMAINDER_CATEGORY_ID,
  SUP.DIC_TYPE_PARTNER_F_ID,
  SUP.CRE_FREE_ZONE1,
  SUP.CRE_FREE_ZONE2,
  SUP.CRE_FREE_ZONE3,
  SUP.CRE_FREE_ZONE4,
  SUP.CRE_FREE_ZONE5,
  SUP.DIC_STATISTIC_F1_ID,
  SUP.DIC_STATISTIC_F2_ID,
  SUP.DIC_STATISTIC_F3_ID,
  SUP.DIC_STATISTIC_F4_ID,
  SUP.DIC_STATISTIC_F5_ID,
  SUP.PAC_PAC_THIRD_1_ID,
  PE1.PER_NAME,
  PE1.PER_FORENAME,
  SUP.PAC_PAC_THIRD_2_ID,
  PE2.PER_NAME,
  PE2.PER_FORENAME,
  SUP.DIC_PTC_THIRD_GROUP_ID,
  SUP.DIC_TARIFF_ID,
  SUP.CRE_REMARK,
  SUP.PAC_SENDING_CONDITION_ID,
  SUP.PAC_CALENDAR_TYPE_ID,
  SUP.DIC_COMPLEMENTARY_DATA_ID,
  SUP.DIC_PIC_GROUP_ID,
  SUP.C_INCOTERMS,
  SUP.CRE_INCOTERMS_PLACE,
  SUP.CRE_SUPPLY_DELAY,
  SUP.CRE_MANUFACTURER,
  SUP.C_DELIVERY_TYP,
  SUP.C_TYPE_EDI,
  SUP.CRE_DATA_EXPORT,
  SUP.CRE_CUSTOMER_NUMBER,
  SUP.CRE_EAN_NUMBER,
  SUP.CRE_SUP_COPY1,
  SUP.CRE_SUP_COPY2,
  SUP.CRE_SUP_COPY3,
  SUP.CRE_SUP_COPY4,
  SUP.CRE_SUP_COPY5,
  SUP.CRE_SUP_COPY6,
  SUP.CRE_SUP_COPY7,
  SUP.CRE_SUP_COPY8,
  SUP.CRE_SUP_COPY9,
  SUP.CRE_SUP_COPY10,
  THI.DIC_THIRD_ACTIVITY_ID,
  THI.DIC_THIRD_AREA_ID,
  THI.DIC_JURIDICAL_STATUS_ID,
  THI.DIC_CITI_CODE_ID,
  THI.THI_NO_SIREN,
  THI.THI_NO_SIRET,
  THI.PAC_PAC_PERSON_ID,
  SUP.A_DATECRE,
  SUP.A_DATEMOD,
  SUP.A_IDCRE,
  SUP.A_IDMOD,
  SUP.DIC_PRIORITY_PAYMENT_ID,
  SUP.DIC_CENTER_PAYMENT_ID,
  SUP.DIC_LEVEL_PRIORITY_ID,
  SUP.CRE_BLOCKED,
  SUP.PC_APPLTXT_ID,
  SUP.PC__PC_APPLTXT_ID,
  SUP.PC_2_PC_APPLTXT_ID,
  SUP.PC_3_PC_APPLTXT_ID,
  SUP.PC_4_PC_APPLTXT_ID,
  SUP.CRE_DAY_CAPACITY
FROM
  PAC_PERSON PE2,
  PAC_PERSON PE1,
  PAC_THIRD THI,
  ACS_FIN_ACC_S_PAYMENT PAY,
  ACS_ACCOUNT ACC,
  PAC_PERSON PER,
  PAC_SUPPLIER_PARTNER SUP
WHERE
  PER.PAC_PERSON_ID = SUP.PAC_SUPPLIER_PARTNER_ID AND
  SUP.ACS_AUXILIARY_ACCOUNT_ID = ACC.ACS_ACCOUNT_ID AND
  SUP.ACS_FIN_ACC_S_PAYMENT_ID = PAY.ACS_FIN_ACC_S_PAYMENT_ID (+) AND
  SUP.PAC_SUPPLIER_PARTNER_ID = THI.PAC_THIRD_ID AND
  SUP.PAC_PAC_THIRD_1_ID = PE1.PAC_PERSON_ID (+) AND
  SUP.PAC_PAC_THIRD_2_ID = PE2.PAC_PERSON_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_SOC_BREAKDOWN" ("PAC_PERSON_ID", "PER_FILE_NUMBER", "PER_SOC_STAT_1", "PER_SOC_STAT_2", "PER_SOC_STAT_3", "PER_SOC_STAT_4", "PER_SOC_STAT_5", "PER_SOC_STAT_6", "PER_SOC_STAT_7", "PER_SOC_STAT_8", "PER_SOC_STAT_9", "PER_SOC_STAT_10") AS
  select
  PER.PAC_PERSON_ID,
  nvl(PER_FILE_NUMBER, PER_KEY1) PER_FILE_NUMBER,
  PER_SOC_STAT_1,
  PER_SOC_STAT_2,
  PER_SOC_STAT_3,
  PER_SOC_STAT_4,
  PER_SOC_STAT_5,
  PER_SOC_STAT_6,
  PER_SOC_STAT_7,
  PER_SOC_STAT_8,
  PER_SOC_STAT_9,
  PER_SOC_STAT_10
from
  PAC_PERSON PER
where
  PER.PER_SOC_BREAKDOWN = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PAC_SUPPLIER_PARTNER" ("DIC_PERSON_POLITNESS_ID", "PER_NAME", "PER_FORENAME", "PER_ACTIVITY", "PER_COMMENT", "PER_KEY1", "PER_KEY2", "DIC_FREE_CODE1_ID", "DIC_FREE_CODE2_ID", "DIC_FREE_CODE3_ID", "DIC_FREE_CODE4_ID", "DIC_FREE_CODE5_ID", "DIC_FREE_CODE6_ID", "DIC_FREE_CODE7_ID", "DIC_FREE_CODE8_ID", "DIC_FREE_CODE9_ID", "DIC_FREE_CODE10_ID", "PER_SHORT_NAME", "THI_NO_TVA", "THI_NO_INTRA", "DIC_THIRD_ACTIVITY_ID", "DIC_THIRD_AREA_ID", "THI_NO_FORMAT", "THI_NO_SIREN", "THI_NO_SIRET", "PAC_SUPPLIER_PARTNER_ID", "DIC_TYPE_SUBMISSION_ID", "DIC_PRIORITY_PAYMENT_ID", "DIC_CENTER_PAYMENT_ID", "DIC_LEVEL_PRIORITY_ID", "PAC_REMAINDER_CATEGORY_ID", "PAC_PAYMENT_CONDITION_ID", "CRE_BLOCKED", "CRE_REMARK", "ACS_AUXILIARY_ACCOUNT_ID", "C_REMAINDER_LAUNCHING", "DIC_TARIFF_ID", "DIC_TYPE_PARTNER_F_ID", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "ACS_VAT_DET_ACCOUNT_ID", "C_TARIFFICATION_MODE", "C_PARTNER_CATEGORY", "PAC_SENDING_CONDITION_ID", "PAC_CALENDAR_TYPE_ID", "C_TYPE_EDI", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "CRE_WITHOUT_REMIND_DATE", "DIC_COMPLEMENTARY_DATA_ID", "PAC_ADDRESS_ID", "PAC_PERSON_ID", "PC_CNTRY_ID", "CNTID", "CNTNAME", "ADD_ADDRESS1", "ADD_ZIPCODE", "ADD_CITY", "ADD_STATE", "PC_LANG_ID", "LANID", "LANNAME", "ADD_COMMENT", "DIC_ADDRESS_TYPE_ID", "ADD_SINCE", "ADD_FORMAT", "ADD_PRINCIPAL", "DAD_DESCR", "DAD_DEFAULT") AS
  select
  PAC_PERSON.DIC_PERSON_POLITNESS_ID, PAC_PERSON.PER_NAME, PAC_PERSON.PER_FORENAME,
  PAC_PERSON.PER_ACTIVITY, PAC_PERSON.PER_COMMENT, PAC_PERSON.PER_KEY1,
  PAC_PERSON.PER_KEY2, PAC_PERSON.DIC_FREE_CODE1_ID, PAC_PERSON.DIC_FREE_CODE2_ID,
  PAC_PERSON.DIC_FREE_CODE3_ID, PAC_PERSON.DIC_FREE_CODE4_ID, PAC_PERSON.DIC_FREE_CODE5_ID,
  PAC_PERSON.DIC_FREE_CODE6_ID, PAC_PERSON.DIC_FREE_CODE7_ID, PAC_PERSON.DIC_FREE_CODE8_ID,
  PAC_PERSON.DIC_FREE_CODE9_ID, PAC_PERSON.DIC_FREE_CODE10_ID, PAC_PERSON.PER_SHORT_NAME,
  PAC_THIRD.THI_NO_TVA, PAC_THIRD.THI_NO_INTRA, PAC_THIRD.DIC_THIRD_ACTIVITY_ID,
  PAC_THIRD.DIC_THIRD_AREA_ID, PAC_THIRD.THI_NO_FORMAT, PAC_THIRD.THI_NO_SIREN,
  PAC_THIRD.THI_NO_SIRET, PAC_SUPPLIER_PARTNER.PAC_SUPPLIER_PARTNER_ID, PAC_SUPPLIER_PARTNER.DIC_TYPE_SUBMISSION_ID,
  PAC_SUPPLIER_PARTNER.DIC_PRIORITY_PAYMENT_ID, PAC_SUPPLIER_PARTNER.DIC_CENTER_PAYMENT_ID, PAC_SUPPLIER_PARTNER.DIC_LEVEL_PRIORITY_ID,
  PAC_SUPPLIER_PARTNER.PAC_REMAINDER_CATEGORY_ID, PAC_SUPPLIER_PARTNER.PAC_PAYMENT_CONDITION_ID, PAC_SUPPLIER_PARTNER.CRE_BLOCKED,
  PAC_SUPPLIER_PARTNER.CRE_REMARK, PAC_SUPPLIER_PARTNER.ACS_AUXILIARY_ACCOUNT_ID, PAC_SUPPLIER_PARTNER.C_REMAINDER_LAUNCHING,
  PAC_SUPPLIER_PARTNER.DIC_TARIFF_ID, PAC_SUPPLIER_PARTNER.DIC_TYPE_PARTNER_F_ID,
  PAC_SUPPLIER_PARTNER.DIC_STATISTIC_F1_ID, PAC_SUPPLIER_PARTNER.DIC_STATISTIC_F2_ID, PAC_SUPPLIER_PARTNER.DIC_STATISTIC_F3_ID,
  PAC_SUPPLIER_PARTNER.DIC_STATISTIC_F4_ID, PAC_SUPPLIER_PARTNER.DIC_STATISTIC_F5_ID, PAC_SUPPLIER_PARTNER.ACS_VAT_DET_ACCOUNT_ID,
  PAC_SUPPLIER_PARTNER.C_TARIFFICATION_MODE, PAC_SUPPLIER_PARTNER.C_PARTNER_CATEGORY, PAC_SUPPLIER_PARTNER.PAC_SENDING_CONDITION_ID,
  PAC_SUPPLIER_PARTNER.PAC_CALENDAR_TYPE_ID, PAC_SUPPLIER_PARTNER.C_TYPE_EDI, PAC_SUPPLIER_PARTNER.CRE_FREE_ZONE1,
  PAC_SUPPLIER_PARTNER.CRE_FREE_ZONE2, PAC_SUPPLIER_PARTNER.CRE_FREE_ZONE3, PAC_SUPPLIER_PARTNER.CRE_FREE_ZONE4,
  PAC_SUPPLIER_PARTNER.CRE_FREE_ZONE5, PAC_SUPPLIER_PARTNER.CRE_WITHOUT_REMIND_DATE, PAC_SUPPLIER_PARTNER.DIC_COMPLEMENTARY_DATA_ID,
  PAC_ADDRESS.PAC_ADDRESS_ID, PAC_ADDRESS.PAC_PERSON_ID, PAC_ADDRESS.PC_CNTRY_ID, PC_CNTRY.CNTID, PC_CNTRY.CNTNAME,
  PAC_ADDRESS.ADD_ADDRESS1, PAC_ADDRESS.ADD_ZIPCODE, PAC_ADDRESS.ADD_CITY,
  PAC_ADDRESS.ADD_STATE, PAC_ADDRESS.PC_LANG_ID, PC_LANG.LANID, PC_LANG.LANNAME, PAC_ADDRESS.ADD_COMMENT,
  PAC_ADDRESS.DIC_ADDRESS_TYPE_ID, PAC_ADDRESS.ADD_SINCE, PAC_ADDRESS.ADD_FORMAT,
  PAC_ADDRESS.ADD_PRINCIPAL, DIC_ADDRESS_TYPE.DAD_DESCR, DIC_ADDRESS_TYPE.DAD_DEFAULT
from
  PAC_PERSON PAC_PERSON,
  PAC_THIRD PAC_THIRD,
  PAC_SUPPLIER_PARTNER PAC_SUPPLIER_PARTNER,
  PAC_ADDRESS PAC_ADDRESS,
  DIC_ADDRESS_TYPE DIC_ADDRESS_TYPE,
  PCS.PC_CNTRY,
  PCS.PC_LANG
where
  ( PAC_THIRD.PAC_THIRD_ID=PAC_PERSON.PAC_PERSON_ID ) AND
  ( PAC_SUPPLIER_PARTNER.PAC_SUPPLIER_PARTNER_ID=PAC_THIRD.PAC_THIRD_ID ) AND
  ( PAC_ADDRESS.PAC_PERSON_ID=PAC_PERSON.PAC_PERSON_ID ) AND
  ( DIC_ADDRESS_TYPE.DIC_ADDRESS_TYPE_ID=PAC_ADDRESS.DIC_ADDRESS_TYPE_ID )  AND
  ( PC_CNTRY.PC_CNTRY_ID = PAC_ADDRESS.PC_CNTRY_ID ) AND
  ( PC_LANG.PC_LANG_ID =  PAC_ADDRESS.PC_LANG_ID ) AND
  ( DIC_ADDRESS_TYPE.DAD_DEFAULT = 1 ) AND
  ( PAC_SUPPLIER_PARTNER.C_PARTNER_STATUS = '1' )




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_INTERRO_NOM" ("PPS_NOM_BOND_ID", "COM_SEQ", "PPS_PPS_NOMENCLATURE_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "PC_LANG_ID", "DES_SHORT_DESCRIPTION", "COMPOSANT", "COM_TEXT", "COM_RES_TEXT", "C_TYPE_NOM", "COMPOSE", "NOM_DEFAULT", "NOM_VERSION", "PPS_NOMENCLATURE_ID") AS
  SELECT
  PPS_NOM_BOND.PPS_NOM_BOND_ID,
  PPS_NOM_BOND.COM_SEQ,
  PPS_NOM_BOND.PPS_PPS_NOMENCLATURE_ID,
  GCO_GOOD.GOO_MAJOR_REFERENCE,
  GCO_GOOD.GOO_SECONDARY_REFERENCE,
  GCO_DESCRIPTION.PC_LANG_ID,
  GCO_DESCRIPTION.DES_SHORT_DESCRIPTION,
  PPS_NOM_BOND.GCO_GOOD_ID COMPOSANT,
  PPS_NOM_BOND.COM_TEXT,
  PPS_NOM_BOND.COM_RES_TEXT,
  PPS_NOMENCLATURE.C_TYPE_NOM,
  PPS_NOMENCLATURE.GCO_GOOD_ID AS COMPOSE,
  PPS_NOMENCLATURE.NOM_DEFAULT,
  PPS_NOMENCLATURE.NOM_VERSION,
  PPS_NOMENCLATURE.PPS_NOMENCLATURE_ID
FROM
  PPS_NOMENCLATURE,
  PPS_NOM_BOND,
  GCO_GOOD,
  GCO_DESCRIPTION
WHERE
  PPS_NOMENCLATURE.PPS_NOMENCLATURE_ID = PPS_NOM_BOND.PPS_NOMENCLATURE_ID  and
  PPS_NOM_BOND.GCO_GOOD_ID = GCO_GOOD.GCO_GOOD_ID (+) and
  GCO_GOOD.GCO_GOOD_ID = GCO_DESCRIPTION.GCO_GOOD_ID (+) and
  GCO_DESCRIPTION.C_DESCRIPTION_TYPE (+) = '01'
  with check option


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOMENCLATURE_INTERRO" ("QUERY_ID_SEQ", "QUERY_NOM_ID", "LEVEL_NOM", "PPS_NOM_BOND_ID", "PPS_NOMENCLATURE_ID", "PPS_RANGE_OPERATION_ID", "STM_LOCATION_ID", "GCO_GOOD_ID", "C_REMPLACEMENT_NOM", "C_TYPE_COM", "C_DISCHARGE_COM", "C_KIND_COM", "COM_SEQ", "COM_TEXT", "COM_RES_TEXT", "COM_RES_NUM", "COM_VAL", "COM_SUBSTITUT", "COM_POS", "COM_UTIL_COEFF", "COM_REF_QTY", "COM_PDIR_COEFF", "COM_REC_PCENT", "COM_INTERVAL", "COM_BEG_VALID", "COM_END_VALID", "COM_REMPLACEMENT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "STM_STOCK_ID", "FAL_SCHEDULE_STEP_ID", "PPS_PPS_NOMENCLATURE_ID") AS
  select     rownum QUERY_ID_SEQ
           , COM.PPS_NOMENCLATURE_ID QUERY_NOM_ID
           , level LEVEL_NOM
           , COM.PPS_NOM_BOND_ID
           , COM.PPS_NOMENCLATURE_ID
           , COM.PPS_RANGE_OPERATION_ID
           , COM.STM_LOCATION_ID
           , COM.GCO_GOOD_ID
           , COM.C_REMPLACEMENT_NOM
           , COM.C_TYPE_COM
           , COM.C_DISCHARGE_COM
           , COM.C_KIND_COM
           , COM.COM_SEQ
           , COM.COM_TEXT
           , COM.COM_RES_TEXT
           , COM.COM_RES_NUM
           , COM.COM_VAL
           , COM.COM_SUBSTITUT
           , COM.COM_POS
           , COM.COM_UTIL_COEFF
           , COM.COM_REF_QTY
           , COM.COM_PDIR_COEFF
           , COM.COM_REC_PCENT
           , COM.COM_INTERVAL
           , COM.COM_BEG_VALID
           , COM.COM_END_VALID
           , COM.COM_REMPLACEMENT
           , COM.A_DATECRE
           , COM.A_DATEMOD
           , COM.A_IDCRE
           , COM.A_IDMOD
           , COM.A_RECLEVEL
           , COM.A_RECSTATUS
           , COM.STM_STOCK_ID
           , COM.FAL_SCHEDULE_STEP_ID
           , COM.PPS_PPS_NOMENCLATURE_ID
        from PPS_NOM_BOND COM
           , GCO_GOOD GCO
       where COM.GCO_GOOD_ID = GCO.GCO_GOOD_ID (+)
  start with COM.PPS_NOMENCLATURE_ID = PPS_INIT.GetNomID
         and (COM.GCO_GOOD_ID is null or GCO.C_GOOD_STATUS in ('2', '5', decode(PPS_INIT.GetInactive, 1, '1', null), decode(PPS_INIT.GetSuspended, 1, '3', null)))
  connect by prior COM.PPS_PPS_NOMENCLATURE_ID = COM.PPS_NOMENCLATURE_ID
    order siblings by COM.PPS_NOMENCLATURE_ID
            , COM.COM_SEQ


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOM_BOND" ("PPS_NOM_BOND_ID", "NB") AS
  select PPS_NOM_BOND.PPS_NOM_BOND_ID,
NVL(SUM(PPS_NOM_BON_S_PPS_VAR_VAL.PPS_NB_VAR),0) NB
from PPS_NOM_BOND, PPS_NOM_BON_S_PPS_VAR_VAL
where PPS_NOM_BOND.PPS_NOM_BOND_ID = PPS_NOM_BON_S_PPS_VAR_VAL.PPS_NOM_BOND_ID (+)
group by PPS_NOM_BOND.PPS_NOM_BOND_ID
with check option




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOM_BOND_DIFF_COLS" ("DIFF_COL", "DIFF_TAG", "DIFF_DESCR", "DIFF_ORDER") AS
  select 'GCO_GOOD_ID' DIFF_COL
       , 'A' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('GCO_GOOD_ID', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 1 DIFF_ORDER
    from dual
  union all
  select 'PPS_PPS_NOMENCLATURE_ID' DIFF_COL
       , 'B' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('PPS_PPS_NOMENCLATURE_ID', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 2 DIFF_ORDER
    from dual
  union all
  select 'STM_STOCK_ID' DIFF_COL
       , 'C' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('STM_STOCK_ID', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 3 DIFF_ORDER
    from dual
  union all
  select 'STM_LOCATION_ID' DIFF_COL
       , 'D' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('STM_LOCATION_ID', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 4 DIFF_ORDER
    from dual
  union all
  select 'C_TYPE_COM' DIFF_COL
       , 'E' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('C_TYPE_COM', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 5 DIFF_ORDER
    from dual
  union all
  select 'C_KIND_COM' DIFF_COL
       , 'F' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('C_KIND_COM', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 6 DIFF_ORDER
    from dual
  union all
  select 'C_DISCHARGE_COM' DIFF_COL
       , 'G' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('C_DISCHARGE_COM', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 7 DIFF_ORDER
    from dual
  union all
  select 'C_REMPLACEMENT_NOM' DIFF_COL
       , 'H' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('C_REMPLACEMENT_NOM', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 8 DIFF_ORDER
    from dual
  union all
  select 'COM_SEQ' DIFF_COL
       , 'I' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_SEQ', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 9 DIFF_ORDER
    from dual
  union all
  select 'COM_TEXT' DIFF_COL
       , 'J' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_TEXT', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 10 DIFF_ORDER
    from dual
  union all
  select 'COM_UTIL_COEFF' DIFF_COL
       , 'K' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_UTIL_COEFF', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 11 DIFF_ORDER
    from dual
  union all
  select 'COM_NOM_VERSION' DIFF_COL
       , 'L' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_NOM_VERSION', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 12 DIFF_ORDER
    from dual
  union all
  select 'COM_PDIR_COEFF' DIFF_COL
       , 'M' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_PDIR_COEFF', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 13 DIFF_ORDER
    from dual
  union all
  select 'COM_PERCENT_WASTE' DIFF_COL
       , 'N' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_PERCENT_WASTE', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 14 DIFF_ORDER
    from dual
  union all
  select 'COM_FIXED_QUANTITY_WASTE' DIFF_COL
       , 'O' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_FIXED_QUANTITY_WASTE', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 15 DIFF_ORDER
    from dual
  union all
  select 'COM_QTY_REFERENCE_LOSS' DIFF_COL
       , 'P' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_QTY_REFERENCE_LOSS', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 16 DIFF_ORDER
    from dual
  union all
  select 'COM_POS' DIFF_COL
       , 'Q' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_POS', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 17 DIFF_ORDER
    from dual
  union all
  select 'COM_END_VALID' DIFF_COL
       , 'R' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_END_VALID', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 18 DIFF_ORDER
    from dual
  union all
  select 'COM_SUBSTITUT' DIFF_COL
       , 'S' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_SUBSTITUT', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 19 DIFF_ORDER
    from dual
  union all
  select 'COM_RES_TEXT' DIFF_COL
       , 'T' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_RES_TEXT', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 20 DIFF_ORDER
    from dual
  union all
  select 'COM_RES_NUM' DIFF_COL
       , 'U' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_RES_NUM', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 21 DIFF_ORDER
    from dual
  union all
  select 'COM_MARK_TOPO' DIFF_COL
       , 'V' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_MARK_TOPO', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 22 DIFF_ORDER
    from dual
  union all
  select 'COM_REF_QTY' DIFF_COL
       , 'W' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_REF_QTY', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 23 DIFF_ORDER
    from dual
  union all
  select 'COM_REMPLACEMENT' DIFF_COL
       , 'X' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('COM_REMPLACEMENT', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 24 DIFF_ORDER
    from dual
  union all
  select 'FAL_SCHEDULE_STEP_ID' DIFF_COL
       , 'Y' DIFF_TAG
       , PCS.PC_FUNCTIONS.GetColumnInformation('FAL_SCHEDULE_STEP_ID', 1, PCS.PC_I_LIB_SESSION.GetUserLangId) DIFF_DESCR
       , 25 DIFF_ORDER
    from dual


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOM_BOND_INTERRO" ("QUERY_ID_SEQ", "QUERY_GOOD_ID", "LEVEL_NOM", "PPS_NOM_BOND_ID", "PPS_NOMENCLATURE_ID", "PPS_RANGE_OPERATION_ID", "STM_LOCATION_ID", "GCO_GOOD_ID", "C_REMPLACEMENT_NOM", "C_TYPE_COM", "C_DISCHARGE_COM", "C_KIND_COM", "COM_SEQ", "COM_TEXT", "COM_RES_TEXT", "COM_RES_NUM", "COM_VAL", "COM_SUBSTITUT", "COM_POS", "COM_UTIL_COEFF", "COM_REF_QTY", "COM_PDIR_COEFF", "COM_REC_PCENT", "COM_INTERVAL", "COM_BEG_VALID", "COM_END_VALID", "COM_REMPLACEMENT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "STM_STOCK_ID", "FAL_SCHEDULE_STEP_ID", "PPS_PPS_NOMENCLATURE_ID") AS
  select     rownum QUERY_ID_SEQ
           , GCO_GOOD_ID QUERY_GOOD_ID
           , level LEVEL_NOM
           , PPS_NOM_BOND_ID
           , PPS_NOMENCLATURE_ID
           , PPS_RANGE_OPERATION_ID
           , STM_LOCATION_ID
           , GCO_GOOD_ID
           , C_REMPLACEMENT_NOM
           , C_TYPE_COM
           , C_DISCHARGE_COM
           , C_KIND_COM
           , COM_SEQ
           , COM_TEXT
           , COM_RES_TEXT
           , COM_RES_NUM
           , COM_VAL
           , COM_SUBSTITUT
           , COM_POS
           , COM_UTIL_COEFF
           , COM_REF_QTY
           , COM_PDIR_COEFF
           , COM_REC_PCENT
           , COM_INTERVAL
           , COM_BEG_VALID
           , COM_END_VALID
           , COM_REMPLACEMENT
           , A_DATECRE
           , A_DATEMOD
           , A_IDCRE
           , A_IDMOD
           , A_RECLEVEL
           , A_RECSTATUS
           , STM_STOCK_ID
           , FAL_SCHEDULE_STEP_ID
           , PPS_PPS_NOMENCLATURE_ID
        from PPS_NOM_BOND
  start with GCO_GOOD_ID = PPS_INIT.GetGoodID
  connect by prior PPS_NOMENCLATURE_ID = PPS_PPS_NOMENCLATURE_ID
    order siblings by PPS_PPS_NOMENCLATURE_ID
            , COM_SEQ




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOM_BOND_INTERRO2" ("QUERY_ID_SEQ", "QUERY_GOOD_ID", "LEVEL_NOM", "PPS_NOM_BOND_ID", "PPS_NOMENCLATURE_ID", "PPS_RANGE_OPERATION_ID", "STM_LOCATION_ID", "GCO_GOOD_ID", "C_REMPLACEMENT_NOM", "C_TYPE_COM", "C_DISCHARGE_COM", "C_KIND_COM", "COM_SEQ", "COM_TEXT", "COM_RES_TEXT", "COM_RES_NUM", "COM_VAL", "COM_SUBSTITUT", "COM_POS", "COM_UTIL_COEFF", "COM_REF_QTY", "COM_PDIR_COEFF", "COM_REC_PCENT", "COM_INTERVAL", "COM_BEG_VALID", "COM_END_VALID", "COM_REMPLACEMENT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "STM_STOCK_ID", "FAL_SCHEDULE_STEP_ID", "PPS_PPS_NOMENCLATURE_ID") AS
  select     rownum QUERY_ID_SEQ
           , PPS_INIT.GetGoodID QUERY_GOOD_ID
           , level LEVEL_NOM
           , PPS_NOM_BOND_ID
           , PPS_NOMENCLATURE_ID
           , PPS_RANGE_OPERATION_ID
           , STM_LOCATION_ID
           , GCO_GOOD_ID
           , C_REMPLACEMENT_NOM
           , C_TYPE_COM
           , C_DISCHARGE_COM
           , C_KIND_COM
           , COM_SEQ
           , COM_TEXT
           , COM_RES_TEXT
           , COM_RES_NUM
           , COM_VAL
           , COM_SUBSTITUT
           , COM_POS
           , COM_UTIL_COEFF
           , COM_REF_QTY
           , COM_PDIR_COEFF
           , COM_REC_PCENT
           , COM_INTERVAL
           , COM_BEG_VALID
           , COM_END_VALID
           , COM_REMPLACEMENT
           , A_DATECRE
           , A_DATEMOD
           , A_IDCRE
           , A_IDMOD
           , A_RECLEVEL
           , A_RECSTATUS
           , STM_STOCK_ID
           , FAL_SCHEDULE_STEP_ID
           , PPS_PPS_NOMENCLATURE_ID
        from PPS_NOM_BOND
  start with PPS_PPS_NOMENCLATURE_ID = PPS_INIT.GetNomID
  connect by prior PPS_NOMENCLATURE_ID = PPS_PPS_NOMENCLATURE_ID
    order siblings by PPS_PPS_NOMENCLATURE_ID
            , COM_SEQ




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOM_BOND_NOLINK_INTERRO" ("QUERY_ID_SEQ", "QUERY_GOOD_ID", "LEVEL_NOM", "PPS_NOM_BOND_ID", "PPS_NOMENCLATURE_ID", "PPS_RANGE_OPERATION_ID", "STM_LOCATION_ID", "GCO_GOOD_ID", "C_REMPLACEMENT_NOM", "C_TYPE_COM", "C_DISCHARGE_COM", "C_KIND_COM", "COM_SEQ", "COM_TEXT", "COM_RES_TEXT", "COM_RES_NUM", "COM_VAL", "COM_SUBSTITUT", "COM_POS", "COM_UTIL_COEFF", "COM_REF_QTY", "COM_PDIR_COEFF", "COM_REC_PCENT", "COM_INTERVAL", "COM_BEG_VALID", "COM_END_VALID", "COM_REMPLACEMENT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "STM_STOCK_ID", "FAL_SCHEDULE_STEP_ID", "PPS_PPS_NOMENCLATURE_ID") AS
  select     PPS_INIT.GetSeqNextval QUERY_ID_SEQ
           , GCO_GOOD_ID QUERY_GOOD_ID
           , level LEVEL_NOM
           , PPS_NOM_BOND_ID
           , PPS_NOMENCLATURE_ID
           , PPS_RANGE_OPERATION_ID
           , STM_LOCATION_ID
           , GCO_GOOD_ID
           , C_REMPLACEMENT_NOM
           , C_TYPE_COM
           , C_DISCHARGE_COM
           , C_KIND_COM
           , COM_SEQ
           , COM_TEXT
           , COM_RES_TEXT
           , COM_RES_NUM
           , COM_VAL
           , COM_SUBSTITUT
           , COM_POS
           , COM_UTIL_COEFF
           , COM_REF_QTY
           , COM_PDIR_COEFF
           , COM_REC_PCENT
           , COM_INTERVAL
           , COM_BEG_VALID
           , COM_END_VALID
           , COM_REMPLACEMENT
           , A_DATECRE
           , A_DATEMOD
           , A_IDCRE
           , A_IDMOD
           , A_RECLEVEL
           , A_RECSTATUS
           , STM_STOCK_ID
           , FAL_SCHEDULE_STEP_ID
           , PPS_PPS_NOMENCLATURE_ID
        from PPS_NOM_BOND
  start with GCO_GOOD_ID = PPS_INIT.GetGoodID
         and PPS_PPS_NOMENCLATURE_ID is null
  connect by prior PPS_NOMENCLATURE_ID = PPS_PPS_NOMENCLATURE_ID
    order siblings by PPS_PPS_NOMENCLATURE_ID
            , COM_SEQ




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PPS_NOM_VAR_VAL" ("PPS_NOM_BOND_ID", "NB") AS
  select PPS_NOM_BOND_ID, COUNT(PPS_NOM_BOND_ID) NB
from PPS_NOM_BON_S_PPS_VAR_VAL
group by PPS_NOM_BOND_ID
with check option




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PTC_FIXED_COSTPRICE" ("PTC_FIXED_COSTPRICE_ID", "C_COSTPRICE_STATUS", "GCO_GOOD_ID", "PAC_THIRD_ID", "CPR_DESCR", "CPR_TEXT", "CPR_PRICE", "CPR_DEFAULT", "FCP_START_DATE", "FCP_END_DATE", "DIC_FIXED_COSTPRICE_DESCR_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "PTC_RECALC_JOB_ID", "CPR_PRICE_BEFORE_RECALC", "FCP_OPTIONS", "CPR_HISTORY_ID", "FAL_ADV_STRUCT_CALC_ID", "FAL_SCHEDULE_PLAN_ID", "PPS_NOMENCLATURE_ID", "GCO_COMPL_DATA_MANUFACTURE_ID", "GCO_COMPL_DATA_PURCHASE_ID", "CPR_MANUFACTURE_ACCOUNTING", "CPR_CALCUL_DATE", "GCO_COMPL_DATA_SUBCONTRACT_ID", "LOT_REFCOMPL") AS
  select "PTC_FIXED_COSTPRICE_ID","C_COSTPRICE_STATUS","GCO_GOOD_ID","PAC_THIRD_ID","CPR_DESCR","CPR_TEXT","CPR_PRICE","CPR_DEFAULT","FCP_START_DATE","FCP_END_DATE","DIC_FIXED_COSTPRICE_DESCR_ID","A_DATECRE","A_DATEMOD","A_IDCRE","A_IDMOD","A_RECLEVEL","A_RECSTATUS","PTC_RECALC_JOB_ID","CPR_PRICE_BEFORE_RECALC","FCP_OPTIONS","CPR_HISTORY_ID","FAL_ADV_STRUCT_CALC_ID","FAL_SCHEDULE_PLAN_ID","PPS_NOMENCLATURE_ID","GCO_COMPL_DATA_MANUFACTURE_ID","GCO_COMPL_DATA_PURCHASE_ID","CPR_MANUFACTURE_ACCOUNTING","CPR_CALCUL_DATE","GCO_COMPL_DATA_SUBCONTRACT_ID","LOT_REFCOMPL"
    from PTC_FIXED_COSTPRICE
   where C_COSTPRICE_STATUS = 'ACT'
     and CPR_DEFAULT = 1


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PTC_TARIFF_TABLE" ("PTC_TARIFF_TABLE_ID", "PTC_TARIFF_ID", "TTA_FROM_QUANTITY", "TTA_TO_QUANTITY", "TTA_PRICE", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "TTA_FLAT_RATE") AS
  select "PTC_TARIFF_TABLE_ID","PTC_TARIFF_ID","TTA_FROM_QUANTITY","TTA_TO_QUANTITY","TTA_PRICE","A_DATECRE","A_DATEMOD","A_IDCRE","A_IDMOD","A_RECLEVEL","A_RECSTATUS","TTA_FLAT_RATE"
    from PTC_TARIFF_TABLE


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PTC_WIZARD_CALC_CP" ("PTC_CALC_COSTPRICE_ID", "GCO_GOOD_ID", "C_COSTPRICE_STATUS", "CPR_DEFAULT", "CPR_DESCR", "CPR_PRICE", "CPR_TEXT", "DIC_CALC_COSTPRICE_DESCR_ID", "PAC_THIRD_ID", "CCP_ADDED_QUANTITY", "CCP_ADDED_VALUE", "CCP_TOTAL_UPDATE", "PER_SHORT_NAME", "PER_FORENAME", "PER_NAME", "PER_KEY1", "PER_KEY2") AS
  SELECT PCC.PTC_CALC_COSTPRICE_ID
     , PCC.GCO_GOOD_ID
     , PCC.C_COSTPRICE_STATUS
     , PCC.CPR_DEFAULT
     , PCC.CPR_DESCR
     , PCC.CPR_PRICE
     , PCC.CPR_TEXT
     , PCC.DIC_CALC_COSTPRICE_DESCR_ID
     , PCC.PAC_THIRD_ID
     , PCC.CCP_ADDED_QUANTITY
     , PCC.CCP_ADDED_VALUE
     , PCC.CCP_TOTAL_UPDATE
     , PER.PER_SHORT_NAME
     , PER.PER_FORENAME
     , PER.PER_NAME
     , PER.PER_KEY1
     , PER.PER_KEY2
  FROM PTC_CALC_COSTPRICE PCC
     , PAC_PERSON PER
     , GCO_GOOD GOO
 WHERE PCC.GCO_GOOD_ID = GOO.GCO_GOOD_ID
   AND PCC.PAC_THIRD_ID = PER.PAC_PERSON_ID (+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PTC_WIZARD_FIXED_CP" ("PTC_FIXED_COSTPRICE_ID", "GCO_GOOD_ID", "C_COSTPRICE_STATUS", "CPR_DEFAULT", "CPR_DESCR", "CPR_PRICE", "CPR_PRICE_BEFORE_RECALC", "CPR_TEXT", "DIC_FIXED_COSTPRICE_DESCR_ID", "FCP_START_DATE", "FCP_END_DATE", "PAC_THIRD_ID", "PER_SHORT_NAME", "PER_FORENAME", "PER_NAME", "PER_KEY1", "PER_KEY2") AS
  SELECT PFC.PTC_FIXED_COSTPRICE_ID
     , PFC.GCO_GOOD_ID
     , PFC.C_COSTPRICE_STATUS
     , PFC.CPR_DEFAULT
     , PFC.CPR_DESCR
     , PFC.CPR_PRICE
     , PFC.CPR_PRICE_BEFORE_RECALC
     , PFC.CPR_TEXT
     , PFC.DIC_FIXED_COSTPRICE_DESCR_ID
     , PFC.FCP_START_DATE
     , PFC.FCP_END_DATE
     , PFC.PAC_THIRD_ID
     , PER.PER_SHORT_NAME
     , PER.PER_FORENAME
     , PER.PER_NAME
     , PER.PER_KEY1
     , PER.PER_KEY2
  FROM PTC_FIXED_COSTPRICE PFC
     , PAC_PERSON PER
     , GCO_GOOD GOO
 WHERE PFC.GCO_GOOD_ID = GOO.GCO_GOOD_ID
   AND PFC.PAC_THIRD_ID = PER.PAC_PERSON_ID (+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PTC_WIZARD_TARIFF_PURCHASE" ("GCO_GOOD_ID", "TRF_DESCR", "DIC_TARIFF_ID", "ACS_FINANCIAL_CURRENCY_ID", "TRF_STARTING_DATE", "TRF_ENDING_DATE", "TRF_NET_TARIFF", "TRF_SPECIAL_TARIFF", "TRF_UNIT", "DIC_FIXED_COSTPRICE_DESCR_ID", "DIC_CALC_COSTPRICE_DESCR_ID", "PER_NAME", "PER_FORENAME", "PER_SHORT_NAME", "PER_KEY1", "PER_KEY2", "PER_ACTIVITY", "DIC_THIRD_AREA_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_TYPE_PARTNER_F_ID", "CRE_FREE_ZONE1", "CRE_FREE_ZONE2", "CRE_FREE_ZONE3", "CRE_FREE_ZONE4", "CRE_FREE_ZONE5", "DIC_STATISTIC_F1_ID", "DIC_STATISTIC_F2_ID", "DIC_STATISTIC_F3_ID", "DIC_STATISTIC_F4_ID", "DIC_STATISTIC_F5_ID", "PTC_TARIFF_ID", "CPU_DEFAULT_SUPPLIER") AS
  select PTC.GCO_GOOD_ID
       , PTC.TRF_DESCR
       , PTC.DIC_TARIFF_ID
       , PTC.ACS_FINANCIAL_CURRENCY_ID
       , PTC.TRF_STARTING_DATE
       , PTC.TRF_ENDING_DATE
       , PTC.TRF_NET_TARIFF
       , PTC.TRF_SPECIAL_TARIFF
       , PTC.TRF_UNIT
       , PFC.DIC_FIXED_COSTPRICE_DESCR_ID
       , PCC.DIC_CALC_COSTPRICE_DESCR_ID
       , PER.PER_NAME
       , PER.PER_FORENAME
       , PER.PER_SHORT_NAME
       , PER.PER_KEY1
       , PER.PER_KEY2
       , PER.PER_ACTIVITY
       , THI.DIC_THIRD_AREA_ID
       , THI.DIC_THIRD_ACTIVITY_ID
       , SUP.DIC_TYPE_PARTNER_F_ID
       , SUP.CRE_FREE_ZONE1
       , SUP.CRE_FREE_ZONE2
       , SUP.CRE_FREE_ZONE3
       , SUP.CRE_FREE_ZONE4
       , SUP.CRE_FREE_ZONE5
       , SUP.DIC_STATISTIC_F1_ID
       , SUP.DIC_STATISTIC_F2_ID
       , SUP.DIC_STATISTIC_F3_ID
       , SUP.DIC_STATISTIC_F4_ID
       , SUP.DIC_STATISTIC_F5_ID
       , PTC.PTC_TARIFF_ID
       , (select count(*) from gco_compl_data_purchase gcp where gcp.cpu_default_supplier = 1 and gcp.gco_good_id = ptc.gco_good_id and gcp.pac_supplier_partner_id = ptc.pac_third_id) cpu_default_supplier
    from PTC_TARIFF PTC
       , PAC_SUPPLIER_PARTNER SUP
       , PAC_PERSON PER
       , PAC_THIRD THI
       , PTC_FIXED_COSTPRICE PFC
       , PTC_CALC_COSTPRICE PCC
   where PTC.C_TARIFF_TYPE = 'A_PAYER'
     and PTC.PAC_THIRD_ID = SUP.PAC_SUPPLIER_PARTNER_ID(+)
     and SUP.PAC_SUPPLIER_PARTNER_ID = PER.PAC_PERSON_ID(+)
     and PTC.PAC_THIRD_ID = THI.PAC_THIRD_ID(+)
     and PTC.PTC_FIXED_COSTPRICE_ID = PFC.PTC_FIXED_COSTPRICE_ID(+)
     and PTC.PTC_CALC_COSTPRICE_ID = PCC.PTC_CALC_COSTPRICE_ID(+)
     and not exists(
           select PTC_TARIFF_ID
             from PTC_TARIFF SUB
            where PTC.GCO_GOOD_ID = SUB.GCO_GOOD_ID
              and nvl(PTC.DIC_PUR_TARIFF_STRUCT_ID, ' ') = nvl(SUB.DIC_PUR_TARIFF_STRUCT_ID, ' ')
              and nvl(PTC.DIC_SALE_TARIFF_STRUCT_ID, ' ') = nvl(SUB.DIC_SALE_TARIFF_STRUCT_ID, ' ')
              and nvl(PTC.DIC_TARIFF_ID, ' ') = nvl(SUB.DIC_TARIFF_ID, ' ')
              and nvl(PTC.PAC_THIRD_ID, 0) = nvl(SUB.PAC_THIRD_ID, 0)
              and nvl(PTC.ACS_FINANCIAL_CURRENCY_ID, 0) = nvl(SUB.ACS_FINANCIAL_CURRENCY_ID, 0)
              and nvl(PTC.TRF_SQL_CONDITIONAL, ' ') = nvl(SUB.TRF_SQL_CONDITIONAL, ' ')
              and nvl(PTC.C_TARIFFICATION_MODE, ' ') = nvl(SUB.C_TARIFFICATION_MODE, ' ')
              and nvl(PTC.C_TARIFF_TYPE, ' ') = nvl(SUB.C_TARIFF_TYPE, ' ')
              and SUB.PTC_TARIFF_ID != PTC.PTC_TARIFF_ID
              and (trunc(sysdate) between nvl(TRF_STARTING_DATE, to_date('01.01.0001', 'DD.MM.YYYY') )
                                      and nvl(TRF_ENDING_DATE, to_date('31.12.2999', 'DD.MM.YYYY') )
                  )
              and nvl(SUB.TRF_STARTING_DATE, to_date('01.01.0001', 'DD.MM.YYYY') ) >
                                                        nvl(PTC.TRF_STARTING_DATE, to_date('01.01.0001', 'DD.MM.YYYY') ) )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_PTC_WIZARD_TARIFF_SALE" ("GCO_GOOD_ID", "TRF_DESCR", "DIC_TARIFF_ID", "ACS_FINANCIAL_CURRENCY_ID", "TRF_STARTING_DATE", "TRF_ENDING_DATE", "TRF_NET_TARIFF", "TRF_SPECIAL_TARIFF", "TRF_UNIT", "DIC_FIXED_COSTPRICE_DESCR_ID", "DIC_CALC_COSTPRICE_DESCR_ID", "PER_NAME", "PER_FORENAME", "PER_SHORT_NAME", "PER_KEY1", "PER_KEY2", "PER_ACTIVITY", "DIC_THIRD_AREA_ID", "DIC_THIRD_ACTIVITY_ID", "DIC_TYPE_PARTNER_ID", "CUS_FREE_ZONE1", "CUS_FREE_ZONE2", "CUS_FREE_ZONE3", "CUS_FREE_ZONE4", "CUS_FREE_ZONE5", "DIC_STATISTIC_1_ID", "DIC_STATISTIC_2_ID", "DIC_STATISTIC_3_ID", "DIC_STATISTIC_4_ID", "DIC_STATISTIC_5_ID", "STE_KEY", "STE_DESCRIPTION", "PDC_KEY", "PDC_DESCRIPTION", "PTC_TARIFF_ID") AS
  select PTC.GCO_GOOD_ID
       , PTC.TRF_DESCR
       , PTC.DIC_TARIFF_ID
       , PTC.ACS_FINANCIAL_CURRENCY_ID
       , PTC.TRF_STARTING_DATE
       , PTC.TRF_ENDING_DATE
       , PTC.TRF_NET_TARIFF
       , PTC.TRF_SPECIAL_TARIFF
       , PTC.TRF_UNIT
       , PFC.DIC_FIXED_COSTPRICE_DESCR_ID
       , PCC.DIC_CALC_COSTPRICE_DESCR_ID
       , PER.PER_NAME
       , PER.PER_FORENAME
       , PER.PER_SHORT_NAME
       , PER.PER_KEY1
       , PER.PER_KEY2
       , PER.PER_ACTIVITY
       , THI.DIC_THIRD_AREA_ID
       , THI.DIC_THIRD_ACTIVITY_ID
       , CUS.DIC_TYPE_PARTNER_ID
       , CUS.CUS_FREE_ZONE1
       , CUS.CUS_FREE_ZONE2
       , CUS.CUS_FREE_ZONE3
       , CUS.CUS_FREE_ZONE4
       , CUS.CUS_FREE_ZONE5
       , CUS.DIC_STATISTIC_1_ID
       , CUS.DIC_STATISTIC_2_ID
       , CUS.DIC_STATISTIC_3_ID
       , CUS.DIC_STATISTIC_4_ID
       , CUS.DIC_STATISTIC_5_ID
       , PST.STE_KEY
       , PST.STE_DESCRIPTION
       , PDC.PDC_KEY
       , PDC.PDC_DESCRIPTION
       , PTC.PTC_TARIFF_ID
    from PTC_TARIFF PTC
       , PAC_CUSTOM_PARTNER CUS
       , PAC_PERSON PER
       , PAC_THIRD THI
       , PTC_FIXED_COSTPRICE PFC
       , PTC_CALC_COSTPRICE PCC
       , PAC_SALE_TERRITORY PST
       , PAC_DISTRIBUTION_CHANNEL PDC
   where PTC.C_TARIFF_TYPE = 'A_FACTURER'
     and PTC.PAC_THIRD_ID = CUS.PAC_CUSTOM_PARTNER_ID(+)
     and CUS.PAC_CUSTOM_PARTNER_ID = PER.PAC_PERSON_ID(+)
     and PTC.PAC_THIRD_ID = THI.PAC_THIRD_ID(+)
     and PTC.PTC_FIXED_COSTPRICE_ID = PFC.PTC_FIXED_COSTPRICE_ID(+)
     and PTC.PTC_CALC_COSTPRICE_ID = PCC.PTC_CALC_COSTPRICE_ID(+)
     and CUS.PAC_SALE_TERRITORY_ID = PST.PAC_SALE_TERRITORY_ID(+)
     and CUS.PAC_DISTRIBUTION_CHANNEL_ID = PDC.PAC_DISTRIBUTION_CHANNEL_ID(+)
     and not exists(
           select PTC_TARIFF_ID
             from PTC_TARIFF SUB
            where PTC.GCO_GOOD_ID = SUB.GCO_GOOD_ID
              and nvl(PTC.DIC_PUR_TARIFF_STRUCT_ID, ' ') = nvl(SUB.DIC_PUR_TARIFF_STRUCT_ID, ' ')
              and nvl(PTC.DIC_SALE_TARIFF_STRUCT_ID, ' ') = nvl(SUB.DIC_SALE_TARIFF_STRUCT_ID, ' ')
              and nvl(PTC.DIC_TARIFF_ID, ' ') = nvl(SUB.DIC_TARIFF_ID, ' ')
              and nvl(PTC.PAC_THIRD_ID, 0) = nvl(SUB.PAC_THIRD_ID, 0)
              and nvl(PTC.ACS_FINANCIAL_CURRENCY_ID, 0) = nvl(SUB.ACS_FINANCIAL_CURRENCY_ID, 0)
              and nvl(PTC.TRF_SQL_CONDITIONAL, ' ') = nvl(SUB.TRF_SQL_CONDITIONAL, ' ')
              and nvl(PTC.C_TARIFFICATION_MODE, ' ') = nvl(SUB.C_TARIFFICATION_MODE, ' ')
              and nvl(PTC.C_TARIFF_TYPE, ' ') = nvl(SUB.C_TARIFF_TYPE, ' ')
              and SUB.PTC_TARIFF_ID != PTC.PTC_TARIFF_ID
              and (trunc(sysdate) between nvl(TRF_STARTING_DATE, to_date('01.01.0001', 'DD.MM.YYYY') )
                                      and nvl(TRF_ENDING_DATE, to_date('31.12.2999', 'DD.MM.YYYY') )
                  )
              and nvl(SUB.TRF_STARTING_DATE, to_date('01.01.0001', 'DD.MM.YYYY') ) >
                                                        nvl(PTC.TRF_STARTING_DATE, to_date('01.01.0001', 'DD.MM.YYYY') ) )


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_REP_DOC_INTERFACE_SHOP" ("DOC_INTERFACE_ID", "DOI_NUMBER", "DOI_PER_NAME", "DOI_DOCUMENT_DATE", "DOI_ADDRESS1", "DOI_ZIPCODE1", "DOI_TOWN1", "DOI_TEXT_1", "DOP_POS_NUMBER", "DOP_MAJOR_REFERENCE", "DOP_QTY", "DOP_RCO_TITLE", "DIC_POS_FREE_TABLE_1_ID", "DOP_POS_TEXT_1", "DOP_SHORT_DESCRIPTION", "DOP_LONG_DESCRIPTION", "DOP_FREE_DESCRIPTION", "DOP_BODY_TEXT", "DIC_UNIT_OF_MEASURE_ID", "GAU_DESCRIBE", "GOO_SECONDARY_REFERENCE", "DOP_GROSS_UNIT_VALUE", "DOP_GROSS_VALUE", "DOI_CURRENCY", "DOI_ADDRESS2", "DOI_ZIPCODE2", "DOI_TOWN2", "DOP_CHARACTERIZATION_VALUE_1", "DOP_CHARACTERIZATION_VALUE_2", "DOP_CHARACTERIZATION_VALUE_3", "DOP_CHARACTERIZATION_VALUE_4", "DOP_CHARACTERIZATION_VALUE_5") AS
  SELECT
    a.doc_interface_id,
    a.doi_number,
    a.doi_per_name,
    a.doi_document_date,
    a.DOI_ADDRESS1,
    a.doi_zipcode1,
    a.doi_town1,
    a.doi_text_1,
    b.dop_pos_number,
    b.dop_major_reference,
    b.dop_qty,
    b.dop_rco_title,
    b.dic_pos_free_table_1_id,
    b.dop_pos_text_1,
    b.dop_short_description,
    b.dop_long_description,
    b.dop_free_description,
    B.DOP_BODY_TEXT,
    d.DIC_UNIT_OF_MEASURE_ID,
	b.gau_describe,
	d.GOO_SECONDARY_REFERENCE,
	b.DOP_GROSS_UNIT_VALUE,
	b.DOP_GROSS_VALUE,
    a.DOI_CURRENCY,
	a.doi_address2,
	a.DOI_ZIPCODE2,
	a.DOI_TOWN2,
	b.DOP_CHARACTERIZATION_VALUE_1,
	b.DOP_CHARACTERIZATION_VALUE_2,
	b.DOP_CHARACTERIZATION_VALUE_3,
	b.DOP_CHARACTERIZATION_VALUE_4,
    b.DOP_CHARACTERIZATION_VALUE_5
FROM
  doc_interface a,
  gco_good d,
  doc_interface_position b
WHERE
  b.GCO_GOOD_ID = d.gco_good_id(+) and
  a.doc_interface_id=b.doc_interface_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_REP_FIELD_INFO" ("TABLE_NAME", "COLUMN_NAME", "MAIN", "DATA_TYPE", "NULLABLE", "POSITION", "USAGE", "REPLICABLE") AS
  SELECT
  table_name,
  column_name,
  case main_field when 0 then 'N' when 1 then 'Y' else '?' end MAIN,
  data_type|| case when data_type != 'DATE' then
    '('||nvl2(data_precision, data_precision||case when data_scale > 0 then ','||to_char(data_scale) end, data_length)||')'
  end DATA_TYPE,
  nullable,
  column_id POSITION,
  case
    when Substr(column_name,1,2)='C_' then 'DESCODE'
    when Substr(column_name,-3)='_ID' then
      case when Substr(column_name,1,4)='DIC_' then 'DICTIONARY' else 'LINK' end
    else 'FIELD'
  end USAGE,
  'Y' REPLICABLE
FROM
  (SELECT column_id,
    case when column_name = table_name||'_ID' then 1 else 0 end MAIN_FIELD,
    case when Substr(column_name, 1, 2) = 'A_' then 1 else 0 end A_FIELD,
    table_name, column_name, data_type, data_precision, data_scale, data_length, nullable
   FROM sys.user_tab_columns)
WHERE
  a_field = 0
WITH READ ONLY


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_REP_PKG_DEPENDENCIES" ("PACKAGE_NAME", "TABLE_NAME") AS
  SELECT
  distinct name AS PACKAGE_NAME,
  referenced_name AS TABLE_NAME
FROM
  (SELECT
     case when type IN ('PACKAGE','PACKAGE BODY') then 1 else 0 end AS is_pkg,
     name, referenced_name
   FROM user_dependencies
   WHERE referenced_owner = SYS_CONTEXT('userenv','CURRENT_SCHEMA') AND
     referenced_type = 'TABLE' AND referenced_name != 'DUAL')
WHERE
  is_pkg = 1
WITH READ ONLY




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_SCH_ECOLAGE_AMOUNT" ("ECO_SHORT_DESCR", "ECO_LONG_DESCR", "CAT_SHORT_DESCR", "CAT_LONG_DESCR", "SCH_ECOLAGE_CATEGORY_ID", "CAT_CONTRACTUAL_AMOUNT", "DEP_EDUCATION_DEGREE", "DEG_MIN_YEAR", "DEG_NAME", "STA_NAME", "AGE_DEP") AS
  SELECT
  ECO.ECO_SHORT_DESCR,
  ECO.ECO_LONG_DESCR,
  CAT.CAT_SHORT_DESCR,
  CAT.CAT_LONG_DESCR,
  CAT.SCH_ECOLAGE_CATEGORY_ID,
	CAT.CAT_CONTRACTUAL_AMOUNT,
  DEP.DEP_EDUCATION_DEGREE,
	DEG.DEG_MIN_YEAR,
  NVL(DEG.DEG_NAME,'Tous degr') DEG_NAME,
  NVL(STA.STA_NAME,'Tous status') STA_NAME,
  DECODE(DEP.DEP_NEW_TERM_AGE,1,TO_CHAR(DEP.DEP_MIN_YEAR_VAL) || ' - ' || TO_CHAR(DEP.DEP_MAX_YEAR_VAL) || ' ans',
    DECODE(DEP.DEP_NEW_YEAR_AGE,1,TO_CHAR(DEP.DEP_MIN_YEAR_VAL) || ' - ' || TO_CHAR(DEP.DEP_MAX_YEAR_VAL) || ' ans','Tous ge')
  ) AGE_DEP
FROM
  SCH_ECOLAGE ECO,
  SCH_ECOLAGE_CATEGORY CAT,
  SCH_GROUP_DEPENDENCY GRD,
  SCH_DEPENDENCY DEP,
  SCH_FREE_DEPENDENCY SFD,
  SCH_EDUCATION_DEGREE DEG,
  SCH_STUDENT_STATUS STA
WHERE
  ECO.SCH_ECOLAGE_ID = CAT.SCH_ECOLAGE_ID AND
  CAT.SCH_ECOLAGE_CATEGORY_ID = GRD.SCH_ECOLAGE_CATEGORY_ID AND
  GRD.SCH_GROUP_DEPENDENCY_ID = DEP.SCH_GROUP_DEPENDENCY_ID (+) AND
  GRD.SCH_GROUP_DEPENDENCY_ID = SFD.SCH_GROUP_DEPENDENCY_ID (+) AND
  DEP.SCH_EDUCATION_DEGREE_ID = DEG.SCH_EDUCATION_DEGREE_ID (+) AND
  DEP.SCH_STUDENT_STATUS_ID   = STA.SCH_STUDENT_STATUS_ID (+) AND
  ((ECO.ECO_MAJOR_REFERENCE = '5-WPM' AND GRD.GRD_SHORT_DESCR <> 'Prefect')
   or ECO.ECO_MAJOR_REFERENCE <> '5-WPM')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_SCH_STUDENT_CV" ("SCH_STUDENT_ID", "CV", "CV_ONLY") AS
  SELECT
  STU.SCH_STUDENT_ID,
  NVL(CV.CV,0) CV,
  NVL(CV_ONLY.CV_ONLY,0) CV_ONLY
FROM
  SCH_STUDENT STU,
  (SELECT STU2.SCH_STUDENT_ID,
          1 as CV
    FROM SCH_FREE_CHARACTERISTIC FRC,
	     SCH_FREE_CHARACT_TYPE CHA,
		 SCH_STUDENT STU2
   WHERE STU2.SCH_STUDENT_ID = FRC.SCH_STUDENT_ID AND
         FRC.SCH_FREE_CHARACT_TYPE_ID = CHA.SCH_FREE_CHARACT_TYPE_ID AND
		 CHA.CHT_SHORT_DESCR = PCS.PC_CONFIG.GETCONFIG('SCH_HOLIDAY_CHARACT') AND
		 FRC.FRC_BOOLEAN_VAL = 1) CV,
  (SELECT STU3.SCH_STUDENT_ID,
          1 AS CV_ONLY
    FROM SCH_FREE_CHARACTERISTIC FRC,
	     SCH_FREE_CHARACT_TYPE CHA,
		 SCH_STUDENT STU3
   WHERE STU3.SCH_STUDENT_ID = FRC.SCH_STUDENT_ID AND
         FRC.SCH_FREE_CHARACT_TYPE_ID = CHA.SCH_FREE_CHARACT_TYPE_ID AND
		 CHA.CHT_SHORT_DESCR = PCS.PC_CONFIG.GETCONFIG('SCH_ONLY_HOLIDAY') AND
		 FRC.FRC_BOOLEAN_VAL = 1) CV_ONLY
where
 STU.SCH_STUDENT_ID = CV.SCH_STUDENT_ID (+) AND
 STU.SCH_STUDENT_ID = CV_ONLY.SCH_STUDENT_ID (+)




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_SQM_ANC_PRNT" ("SQM_ANC_ID", "PC_ANC_USER1_ID", "PC_ANC_USER2_ID", "PC_ANC_USER3_ID", "PC_ANC_USER4_ID", "ANC_USER_CREATION", "ANC_USER_VALIDATION", "ANC_USER_ALLOCATION", "ANC_RESPONSIBLE", "DIC_ANC_CODE_ID", "DOC_RECORD_ID", "PC_LANG_ID", "PAC_ADDRESS_ID", "PAC_PERSON_ASSOCIATION_ID", "FAL_LOT_ID", "DOC_DOCUMENT_ID", "PAC_SUPPLIER_PARTNER_ID", "PAC_CUSTOM_PARTNER_ID", "C_ANC_STATUS", "C_ANC_TYPE", "ANC_NUMBER", "ANC_SHORT_DESCRIPTION", "ANC_LONG_DESCRIPTION", "ANC_PARTNER_NUMBER", "ANC_PARTNER_REF", "ANC_PARTNER_DATE", "ANC_DATE", "ANC_PRINT_RECEPT_DATE", "ANC_VALIDATION_DATE", "ANC_ALLOCATION_DATE", "ANC_CLOSING_DATE", "ANC_VALIDATION_DURATION", "ANC_REPLY_DURATION", "ANC_ALLOCATION_DURATION", "ANC_PROCESSING_DURATION", "ANC_TOTAL_DURATION", "ANC_DIRECT_COST", "ANC_PREVENTIVE_COST", "ANC_FIXED_COST", "ANC_TOTAL_COST", "DIC_ANC_FREE1_ID", "DIC_ANC_FREE2_ID", "DIC_ANC_FREE3_ID", "DIC_ANC_FREE4_ID", "DIC_ANC_FREE5_ID", "ANC_FREE_TEXT1", "ANC_FREE_TEXT2", "ANC_FREE_TEXT3", "ANC_FREE_TEXT4", "ANC_FREE_TEXT5", "ANC_FREE_DATE1", "ANC_FREE_DATE2", "ANC_FREE_DATE3", "ANC_FREE_DATE4", "ANC_FREE_DATE5", "ANC_FREE_NUMBER1", "ANC_FREE_NUMBER2", "ANC_FREE_NUMBER3", "ANC_FREE_NUMBER4", "ANC_FREE_NUMBER5", "ANC_FREE_COMMENT1", "ANC_FREE_COMMENT2", "SQM_ANC_POSITION_ID", "GCO_GOOD_ID", "PC_SAP_USER1_ID", "PC_SAP_USER2_ID", "DIC_SAP_CTRL_ID", "DIC_SAP_CDEF_ID", "DIC_SAP_NDEF_ID", "DIC_SAP_DECISION_ID", "DIC_SAP_RESP_ID", "DOC_DOCUMENT2_ID", "C_ANC_POS_STATUS", "DIC_SAP_FREE1_ID", "DIC_SAP_FREE2_ID", "DIC_SAP_FREE3_ID", "DIC_SAP_FREE4_ID", "DIC_SAP_FREE5_ID", "SAP_NUMBER", "SAP_SECOND_REF", "SAP_PARTNER_REF", "SAP_COMMENT", "SAP_QTY_ACCEPT", "SAP_QTY_DEFECTIVE", "SAP_ACTUAL_VALUE", "SAP_REQUIRE_VALUE", "SAP_VALIDATION_DATE", "SAP_CLOSING_DATE", "SAP_VALIDATION_DURATION", "SAP_PROCESSING_DURATION", "SAP_TOTAL_DURATION", "SAP_RETURN", "SAP_TITLE", "SAP_DIRECT_COST", "SAP_PREVENTIVE_COST", "SAP_TOTAL_COST", "SAP_FREE_TEXT1", "SAP_FREE_TEXT2", "SAP_FREE_TEXT3", "SAP_FREE_TEXT4", "SAP_FREE_TEXT5", "SAP_FREE_DATE1", "SAP_FREE_DATE2", "SAP_FREE_DATE3", "SAP_FREE_DATE4", "SAP_FREE_DATE5", "SAP_FREE_NUMBER1", "SAP_FREE_NUMBER2", "SAP_FREE_NUMBER3", "SAP_FREE_NUMBER4", "SAP_FREE_NUMBER5", "SAP_FREE_COMMENT1", "SAP_FREE_COMMENT2", "PC_SAP_USER3_ID", "SAP_CREATION_DATE", "SAP_VALIDATION_USER", "SAP_CREATION_USER", "SQM_ANC_CAUSE_ID", "DIC_SAC_FREE5_ID", "DIC_SAC_FREE4_ID", "DIC_SAC_FREE3_ID", "DIC_SAC_FREE2_ID", "DIC_SAC_FREE1_ID", "DIC_SAC_TYPE_ID", "SAC_COMMENT", "SAC_FREE_TEXT1", "SAC_FREE_TEXT2", "SAC_FREE_TEXT3", "SAC_FREE_TEXT4", "SAC_FREE_TEXT5", "SAC_FREE_DATE1", "SAC_FREE_DATE2", "SAC_FREE_DATE3", "SAC_FREE_DATE4", "SAC_FREE_DATE5", "SAC_FREE_NUMBER1", "SAC_FREE_NUMBER2", "SAC_FREE_NUMBER3", "SAC_FREE_NUMBER4", "SAC_FREE_NUMBER5", "SAC_FREE_COMMENT1", "SAC_FREE_COMMENT2", "SQM_ANC_DIRECT_ACTION_ID", "PC_SDA_USER1_ID", "PC_SDA_USER2_ID", "SDA_DIC_DELAY_TYPE_ID", "C_SDA_STATUS", "DIC_SDA_TYPE_ID", "DIC_SDA_FREE1_ID", "DIC_SDA_FREE2_ID", "DIC_SDA_FREE3_ID", "DIC_SDA_FREE4_ID", "DIC_SDA_FREE5_ID", "SDA_COMMENT", "SDA_DELAY", "SDA_DURATION", "SDA_COST", "SDA_END_DATE", "SDA_FREE_TEXT1", "SDA_FREE_TEXT2", "SDA_FREE_TEXT3", "SDA_FREE_TEXT4", "SDA_FREE_TEXT5", "SDA_FREE_DATE1", "SDA_FREE_DATE2", "SDA_FREE_DATE3", "SDA_FREE_DATE4", "SDA_FREE_DATE5", "SDA_FREE_NUMBER1", "SDA_FREE_NUMBER2", "SDA_FREE_NUMBER3", "SDA_FREE_NUMBER4", "SDA_FREE_NUMBER5", "SDA_FREE_COMMENT1", "SDA_FREE_COMMENT2", "PC_SDA_USER3_ID", "SDA_CREATION_DATE", "SDA_RESPONSIBLE", "SDA_END_USER", "SDA_CREATION_USER", "SQM_ANC_PREVENTIVE_ACTION_ID", "PC_SPA_USER1_ID", "PC_SPA_USER2_ID", "DIC_DELAY_TYPE_ID", "C_SPA_STATUS", "DIC_SPA_TYPE_ID", "DIC_SPA_FREE1_ID", "DIC_SPA_FREE2_ID", "DIC_SPA_FREE3_ID", "DIC_SPA_FREE4_ID", "DIC_SPA_FREE5_ID", "SPA_COMMENT", "SPA_DELAY", "SPA_DURATION", "SPA_COST", "SPA_END_DATE", "SPA_FREE_TEXT1", "SPA_FREE_TEXT2", "SPA_FREE_TEXT3", "SPA_FREE_TEXT4", "SPA_FREE_TEXT5", "SPA_FREE_DATE1", "SPA_FREE_DATE2", "SPA_FREE_DATE3", "SPA_FREE_DATE4", "SPA_FREE_DATE5", "SPA_FREE_NUMBER1", "SPA_FREE_NUMBER2", "SPA_FREE_NUMBER3", "SPA_FREE_NUMBER4", "SPA_FREE_NUMBER5", "SPA_FREE_COMMENT1", "SPA_FREE_COMMENT2", "PC_SPA_USER3_ID", "SPA_CREATION_DATE", "SPA_RESPONSIBLE", "SPA_END_USER", "SPA_CREATION_USER", "ADD_ADDRESS1", "ADD_FORMAT", "ADD_CITY", "CUS_DIC_PERSON_POLITNESS_ID", "CUS_PER_NAME", "CUS_PER_FORENAME", "CUS_PER_ACTIVITY", "CUS_PER_COMMENT", "CUS_PER_KEY1", "CUS_PER_KEY2", "CUS_PER_SHORT_NAME", "SUP_DIC_PERSON_POLITNESS_ID", "SUP_PER_NAME", "SUP_PER_FORENAME", "SUP_PER_ACTIVITY", "SUP_PER_COMMENT", "SUP_PER_KEY1", "SUP_PER_KEY2", "SUP_PER_SHORT_NAME", "ASO_DIC_PERSON_POLITNESS_ID", "ASO_PER_NAME", "ASO_PER_FORENAME", "ASO_PER_ACTIVITY", "ASO_PER_COMMENT", "ASO_PER_KEY1", "ASO_PER_KEY2", "ASO_PER_SHORT_NAME", "LANID", "ANC_DMT_NUMBER", "POS_DMT_NUMBER", "POS_BACK_DMT_NUMBER", "POS_NUMBER", "ANC_LOT_REFCOMPL", "POS_LOT_REFCOMPL", "SCS_STEP_NUMBER", "SCS_STEP_SHORT_DESCR", "GOO_MAJOR_REFERENCE", "CHARACTERIZATION1", "CHARACTERIZATION2", "TYPE_CHARACT1", "TYPE_CHARACT2", "FAD_PIECE", "FAD_LOT_CHARACTERIZATION", "PDE_PIECE", "PDE_LOT", "POS_DOC_DOCUMENT_ID", "POS_DOC_POSITION_DETAIL_ID", "POS_FAL_LOT_ID", "POS_FAL_LOT_DETAIL_ID", "POS_FAL_SCHEDULE_STEP2_ID", "POS_SQM_ANC_LINK_ID") AS
  SELECT
          -- Entte avis non conformit
          anc.sqm_anc_id, anc.pc_anc_user1_id, anc.pc_anc_user2_id,
          anc.pc_anc_user3_id, anc.pc_anc_user4_id,
          anc_use1.use_name anc_user_creation,
          anc_use2.use_name anc_user_validation,
          anc_use3.use_name anc_user_allocation,
          anc_use4.use_name anc_reponsible, anc.dic_anc_code_id,
          anc.doc_record_id, anc.pc_lang_id, anc.pac_address_id,
          anc.pac_person_association_id, anc.fal_lot_id,
          anc.doc_document_id, anc.pac_supplier_partner_id,
          anc.pac_custom_partner_id, anc.c_anc_status, anc.c_anc_type,
          anc.anc_number, anc.anc_short_description, anc.anc_long_description,
          anc.anc_partner_number, anc.anc_partner_ref, anc.anc_partner_date,
          anc_date, anc.anc_print_recept_date, anc.anc_validation_date,
          anc.anc_allocation_date, anc.anc_closing_date,
          anc.anc_validation_duration, anc.anc_reply_duration,
          anc.anc_allocation_duration, anc.anc_processing_duration,
          anc.anc_total_duration, anc.anc_direct_cost,
          anc.anc_preventive_cost, anc.anc_fixed_cost, anc.anc_total_cost,
          anc.dic_anc_free1_id, anc.dic_anc_free2_id, anc.dic_anc_free3_id,
          anc.dic_anc_free4_id, anc.dic_anc_free5_id, anc.anc_free_text1,
          anc.anc_free_text2, anc.anc_free_text3, anc.anc_free_text4,
          anc.anc_free_text5, anc.anc_free_date1, anc.anc_free_date2,
          anc.anc_free_date3, anc.anc_free_date4, anc.anc_free_date5,
          anc.anc_free_number1, anc.anc_free_number2, anc.anc_free_number3,
          anc.anc_free_number4, anc.anc_free_number5, anc.anc_free_comment1,
          anc.anc_free_comment2,
                                -- Positions
                                sap.sqm_anc_position_id, sap.gco_good_id,
          sap.pc_sap_user1_id, sap.pc_sap_user2_id, sap.dic_sap_ctrl_id,
          sap.dic_sap_cdef_id, sap.dic_sap_ndef_id, sap.dic_sap_decision_id,
          sap.dic_sap_resp_id, sap.doc_document2_id, sap.c_anc_pos_status,
          sap.dic_sap_free1_id, sap.dic_sap_free2_id, sap.dic_sap_free3_id,
          sap.dic_sap_free4_id, sap.dic_sap_free5_id, sap.sap_number,
          sap.sap_second_ref, sap.sap_partner_ref, sap.sap_comment,
          sap.sap_qty_accept, sap.sap_qty_defective, sap.sap_actual_value,
          sap.sap_require_value, sap.sap_validation_date,
          sap.sap_closing_date, sap.sap_validation_duration,
          sap.sap_processing_duration, sap.sap_total_duration, sap.sap_return,
          sap.sap_title, sap.sap_direct_cost, sap.sap_preventive_cost,
          sap.sap_total_cost, sap.sap_free_text1, sap.sap_free_text2,
          sap.sap_free_text3, sap.sap_free_text4, sap.sap_free_text5,
          sap.sap_free_date1, sap.sap_free_date2, sap.sap_free_date3,
          sap.sap_free_date4, sap.sap_free_date5, sap.sap_free_number1,
          sap.sap_free_number2, sap.sap_free_number3, sap.sap_free_number4,
          sap.sap_free_number5, sap.sap_free_comment1, sap.sap_free_comment2,
          sap.pc_sap_user3_id, sap.sap_creation_date,
          sap_use1.use_name sap_validation_user,
          sap_use3.use_name sap_creation_user,
                                              -- Causes
                                              sac.sqm_anc_cause_id,
          sac.dic_sac_free5_id, sac.dic_sac_free4_id, sac.dic_sac_free3_id,
          sac.dic_sac_free2_id, sac.dic_sac_free1_id, sac.dic_sac_type_id,
          sac.sac_comment, sac.sac_free_text1, sac.sac_free_text2,
          sac.sac_free_text3, sac.sac_free_text4, sac.sac_free_text5,
          sac.sac_free_date1, sac.sac_free_date2, sac.sac_free_date3,
          sac.sac_free_date4, sac.sac_free_date5, sac.sac_free_number1,
          sac.sac_free_number2, sac.sac_free_number3, sac.sac_free_number4,
          sac.sac_free_number5, sac.sac_free_comment1, sac.sac_free_comment2,
          -- Mesures immdiates
          sda.sqm_anc_direct_action_id, sda.pc_sda_user1_id,
          sda.pc_sda_user2_id, sda.dic_delay_type_id, sda.c_sda_status,
          sda.dic_sda_type_id, sda.dic_sda_free1_id, sda.dic_sda_free2_id,
          sda.dic_sda_free3_id, sda.dic_sda_free4_id, sda.dic_sda_free5_id,
          sda.sda_comment, sda.sda_delay, sda.sda_duration, sda.sda_cost,
          sda.sda_end_date, sda.sda_free_text1, sda.sda_free_text2,
          sda.sda_free_text3, sda.sda_free_text4, sda.sda_free_text5,
          sda.sda_free_date1, sda.sda_free_date2, sda.sda_free_date3,
          sda.sda_free_date4, sda.sda_free_date5, sda.sda_free_number1,
          sda.sda_free_number2, sda.sda_free_number3, sda.sda_free_number4,
          sda.sda_free_number5, sda.sda_free_comment1, sda.sda_free_comment2,
          sda.pc_sda_user3_id, sda_creation_date,
          sda_use1.use_name sda_responsible, sda_use2.use_name sda_end_user,
          sda_use3.use_name sda_creation_user,
          -- Mesures prventives
          spa.sqm_anc_preventive_action_id, spa.pc_spa_user1_id,
          spa.pc_spa_user2_id, spa.dic_delay_type_id, spa.c_spa_status,
          spa.dic_spa_type_id, spa.dic_spa_free1_id, spa.dic_spa_free2_id,
          spa.dic_spa_free3_id, spa.dic_spa_free4_id, spa.dic_spa_free5_id,
          spa.spa_comment, spa.spa_delay, spa.spa_duration, spa.spa_cost,
          spa.spa_end_date, spa.spa_free_text1, spa.spa_free_text2,
          spa.spa_free_text3, spa.spa_free_text4, spa.spa_free_text5,
          spa.spa_free_date1, spa.spa_free_date2, spa.spa_free_date3,
          spa.spa_free_date4, spa.spa_free_date5, spa.spa_free_number1,
          spa.spa_free_number2, spa.spa_free_number3, spa.spa_free_number4,
          spa.spa_free_number5, spa.spa_free_comment1, spa.spa_free_comment2,
          spa.pc_spa_user3_id, spa.spa_creation_date,
          spa_use1.use_name spa_responsible, spa_use2.use_name spa_end_user,
          spa_use2.use_name spa_creation_user,
          -- Address
          adr.add_address1,adr.add_format, adr.add_city,
          -- Customer
          per1.dic_person_politness_id cus_dic_person_politness_id,
          per1.per_name cus_per_name, per1.per_forename cus_per_forename,
          per1.per_activity cus_per_activity,
          per1.per_comment cus_per_comment, per1.per_key1 cus_per_key1,
          per1.per_key2 cus_per_key2, per1.per_short_name cus_per_short_name,
          -- Supplier
          per2.dic_person_politness_id sup_dic_person_politness_id,
          per2.per_name sup_per_name, per2.per_forename sup_per_forename,
          per2.per_activity sup_per_activity,
          per2.per_comment sup_per_comment, per2.per_key1 sup_per_key1,
          per2.per_key2 sup_per_key2, per2.per_short_name sup_per_short_name,
          -- Contact
          per3.dic_person_politness_id aso_dic_person_politness_id,
          per3.per_name aso_per_name, per3.per_forename aso_per_forename,
          per3.per_activity aso_per_activity,
          per3.per_comment aso_per_comment, per3.per_key1 aso_per_key1,
          per3.per_key2 aso_per_key2, per3.per_short_name aso_per_short_name,
          -- langue
          lan.lanid,
          -- Documents, dtails position
          anc_doc.dmt_number, pos_doc.dmt_number pos_dmt_number,
          pos_back_doc.dmt_number pos_back_dmt_number, pos.pos_number,
          -- Lots, Lots hist, opration
          NVL (lot_anc.lot_refcompl, loth_anc.lot_refcompl) anc_lot_refcompl,
          NVL (lot_pos.lot_refcompl, loth_pos.lot_refcompl) pos_lot_refcompl,
          NVL (tal.scs_step_number, talh.scs_step_number) scs_step_number,
          NVL (tal.scs_short_descr, talh.scs_short_descr) scs_short_descr,
          -- Autres
          gco.goo_major_reference,
          -- Caractrisations
          charact1.sem_value characterization1,
          charact2.sem_value characterization2,
          charact1.c_element_type type_charact1,
          charact2.c_element_type type_charact2,
          NVL (fad.fad_piece, fadh.fad_piece) fad_piece,
          NVL (fad.fad_lot_characterization,
               fadh.fad_lot_characterization
              ) fad_lot_characterization,
          sqm_anc_functions.getpiececharacterization
                              (pde.doc_position_detail_id)
                                                          v_anc_piece_charact,
          sqm_anc_functions.getlotcharacterization
                                (pde.doc_position_detail_id)
                                                            v_anc_lot_charact,
          -- Liens position d'ANC
          poslink.doc_document_id, poslink.doc_position_detail_id,
          poslink.fal_lot_id,
          poslink.fal_lot_detail_id,
          poslink.fal_schedule_step2_id,
          poslink.sqm_anc_link_id pos_sqm_anc_id
     FROM sqm_anc anc,
          sqm_anc_position sap,
          sqm_anc_cause sac,
          sqm_anc_direct_action sda,
          sqm_anc_preventive_action spa,
          pac_address adr,
          pac_person per1,
          pac_person per2,
          pac_person per3,
          pac_person_association aso,
          pcs.pc_lang lan,
          pcs.pc_user anc_use1,
          pcs.pc_user anc_use2,
          pcs.pc_user anc_use3,
          pcs.pc_user anc_use4,
          doc_document anc_doc,
          doc_document pos_back_doc,
          fal_lot lot_anc,
          fal_lot_hist loth_anc,
          pcs.pc_user sap_use1,
          pcs.pc_user sap_use3,
          pcs.pc_user sda_use1,
          pcs.pc_user sda_use2,
          pcs.pc_user sda_use3,
          pcs.pc_user spa_use1,
          pcs.pc_user spa_use2,
          pcs.pc_user spa_use3,
          gco_good gco,
          sqm_anc_link poslink,
          doc_document pos_doc,
          doc_position pos,
          doc_position_detail pde,
          fal_lot lot_pos,
          fal_lot_hist loth_pos,
          fal_task_link tal,
          fal_task_link_hist talh,
          stm_element_number charact1,
          stm_element_number charact2,
          fal_lot_detail fad,
          fal_lot_detail_hist fadh
    WHERE anc.sqm_anc_id = sap.sqm_anc_id(+)
      AND sap.sqm_anc_position_id = poslink.sqm_anc_position_id(+)
--      AND poslink.sqm_anc_direct_action_id IS NULL
      AND sap.sqm_anc_position_id = sda.sqm_anc_position_id(+)
      AND sap.sqm_anc_position_id = sac.sqm_anc_position_id(+)
      AND poslink.stm_element_number1_id = charact1.stm_element_number_id(+)
      AND poslink.stm_element_number2_id = charact2.stm_element_number_id(+)
      AND sac.sqm_anc_cause_id = spa.sqm_anc_cause_id(+)
      AND anc.pac_custom_partner_id = per1.pac_person_id(+)
      AND anc.pac_supplier_partner_id = per2.pac_person_id(+)
      AND anc.pac_person_association_id = aso.pac_person_association_id(+)
      AND aso.pac_pac_person_id = per3.pac_person_id(+)
      AND anc.pac_address_id = adr.pac_address_id(+)
      AND anc.pc_lang_id = lan.pc_lang_id(+)
      AND anc.pc_anc_user1_id = anc_use1.pc_user_id(+)
      AND anc.pc_anc_user2_id = anc_use2.pc_user_id(+)
      AND anc.pc_anc_user3_id = anc_use3.pc_user_id(+)
      AND anc.pc_anc_user4_id = anc_use4.pc_user_id(+)
      AND anc.doc_document_id = anc_doc.doc_document_id(+)
      AND poslink.doc_document_id = pos_doc.doc_document_id(+)
      AND poslink.doc_position_detail_id = pde.doc_position_detail_id(+)
      AND sap.gco_good_id = gco.gco_good_id(+)
      AND pde.doc_position_id = pos.doc_position_id(+)
      AND sap.doc_document2_id = pos_back_doc.doc_document_id(+)
      AND anc.fal_lot_id = lot_anc.fal_lot_id(+)
      AND anc.fal_lot_id = loth_anc.fal_lot_hist_id(+)
      AND poslink.fal_lot_id = lot_pos.fal_lot_id(+)
      AND poslink.fal_lot_detail_id = fad.fal_lot_detail_id(+)
      AND poslink.fal_lot_detail_id = fadh.fal_lot_detail_hist_id(+)
      AND poslink.fal_lot_id = loth_pos.fal_lot_hist_id(+)
      AND poslink.fal_schedule_step2_id = tal.fal_schedule_step_id(+)
      AND poslink.fal_schedule_step2_id = talh.fal_schedule_step_id(+)
      AND sap.pc_sap_user1_id = sap_use1.pc_user_id(+)
      AND sap.pc_sap_user3_id = sap_use3.pc_user_id(+)
      AND sda.pc_sda_user1_id = sda_use1.pc_user_id(+)
      AND sda.pc_sda_user2_id = sda_use2.pc_user_id(+)
      AND sda.pc_sda_user3_id = sda_use3.pc_user_id(+)
      AND spa.pc_spa_user1_id = spa_use1.pc_user_id(+)
      AND spa.pc_spa_user2_id = spa_use2.pc_user_id(+)
      AND spa.pc_spa_user3_id = spa_use3.pc_user_id(+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_SQM_ANC_SHORT_PRNT" ("SQM_ANC_ID", "PC_ANC_USER1_ID", "PC_ANC_USER2_ID", "PC_ANC_USER3_ID", "PC_ANC_USER4_ID", "ANC_USER_CREATION", "ANC_USER_VALIDATION", "ANC_USER_ALLOCATION", "ANC_RESPONSIBLE", "DIC_ANC_CODE_ID", "DOC_RECORD_ID", "PC_LANG_ID", "PAC_ADDRESS_ID", "PAC_PERSON_ASSOCIATION_ID", "FAL_LOT_ID", "DOC_DOCUMENT_ID", "PAC_SUPPLIER_PARTNER_ID", "PAC_CUSTOM_PARTNER_ID", "C_ANC_STATUS", "C_ANC_TYPE", "ANC_NUMBER", "ANC_SHORT_DESCRIPTION", "ANC_LONG_DESCRIPTION", "ANC_PARTNER_NUMBER", "ANC_PARTNER_REF", "ANC_PARTNER_DATE", "ANC_DATE", "ANC_PRINT_RECEPT_DATE", "ANC_VALIDATION_DATE", "ANC_ALLOCATION_DATE", "ANC_CLOSING_DATE", "ANC_VALIDATION_DURATION", "ANC_REPLY_DURATION", "ANC_ALLOCATION_DURATION", "ANC_PROCESSING_DURATION", "ANC_TOTAL_DURATION", "ANC_DIRECT_COST", "ANC_PREVENTIVE_COST", "ANC_FIXED_COST", "ANC_TOTAL_COST", "DIC_ANC_FREE1_ID", "DIC_ANC_FREE2_ID", "DIC_ANC_FREE3_ID", "DIC_ANC_FREE4_ID", "DIC_ANC_FREE5_ID", "ANC_FREE_TEXT1", "ANC_FREE_TEXT2", "ANC_FREE_TEXT3", "ANC_FREE_TEXT4", "ANC_FREE_TEXT5", "ANC_FREE_DATE1", "ANC_FREE_DATE2", "ANC_FREE_DATE3", "ANC_FREE_DATE4", "ANC_FREE_DATE5", "ANC_FREE_NUMBER1", "ANC_FREE_NUMBER2", "ANC_FREE_NUMBER3", "ANC_FREE_NUMBER4", "ANC_FREE_NUMBER5", "ANC_FREE_COMMENT1", "ANC_FREE_COMMENT2", "SQM_ANC_POSITION_ID", "GCO_GOOD_ID", "PC_SAP_USER1_ID", "PC_SAP_USER2_ID", "DIC_SAP_CTRL_ID", "DIC_SAP_CDEF_ID", "DIC_SAP_NDEF_ID", "DIC_SAP_DECISION_ID", "DIC_SAP_RESP_ID", "DOC_DOCUMENT2_ID", "C_ANC_POS_STATUS", "DIC_SAP_FREE1_ID", "DIC_SAP_FREE2_ID", "DIC_SAP_FREE3_ID", "DIC_SAP_FREE4_ID", "DIC_SAP_FREE5_ID", "SAP_NUMBER", "SAP_SECOND_REF", "SAP_PARTNER_REF", "SAP_COMMENT", "SAP_QTY_ACCEPT", "SAP_QTY_DEFECTIVE", "SAP_ACTUAL_VALUE", "SAP_REQUIRE_VALUE", "SAP_VALIDATION_DATE", "SAP_CLOSING_DATE", "SAP_VALIDATION_DURATION", "SAP_PROCESSING_DURATION", "SAP_TOTAL_DURATION", "SAP_RETURN", "SAP_TITLE", "SAP_DIRECT_COST", "SAP_PREVENTIVE_COST", "SAP_TOTAL_COST", "SAP_FREE_TEXT1", "SAP_FREE_TEXT2", "SAP_FREE_TEXT3", "SAP_FREE_TEXT4", "SAP_FREE_TEXT5", "SAP_FREE_DATE1", "SAP_FREE_DATE2", "SAP_FREE_DATE3", "SAP_FREE_DATE4", "SAP_FREE_DATE5", "SAP_FREE_NUMBER1", "SAP_FREE_NUMBER2", "SAP_FREE_NUMBER3", "SAP_FREE_NUMBER4", "SAP_FREE_NUMBER5", "SAP_FREE_COMMENT1", "SAP_FREE_COMMENT2", "PC_SAP_USER3_ID", "SAP_CREATION_DATE", "SAP_VALIDATION_USER", "SAP_CREATION_USER", "ADD_ADDRESS1", "ADD_FORMAT", "ADD_CITY", "CUS_DIC_PERSON_POLITNESS_ID", "CUS_PER_NAME", "CUS_PER_FORENAME", "CUS_PER_ACTIVITY", "CUS_PER_COMMENT", "CUS_PER_KEY1", "CUS_PER_KEY2", "CUS_PER_SHORT_NAME", "SUP_DIC_PERSON_POLITNESS_ID", "SUP_PER_NAME", "SUP_PER_FORENAME", "SUP_PER_ACTIVITY", "SUP_PER_COMMENT", "SUP_PER_KEY1", "SUP_PER_KEY2", "SUP_PER_SHORT_NAME", "ASO_DIC_PERSON_POLITNESS_ID", "ASO_PER_NAME", "ASO_PER_FORENAME", "ASO_PER_ACTIVITY", "ASO_PER_COMMENT", "ASO_PER_KEY1", "ASO_PER_KEY2", "ASO_PER_SHORT_NAME", "LANID", "ANC_DMT_NUMBER", "POS_BACK_DMT_NUMBER", "ANC_LOT_REFCOMPL", "GOO_MAJOR_REFERENCE") AS
  SELECT
       -- Entte avis non conformit
       ANC.SQM_ANC_ID,
	   ANC.PC_ANC_USER1_ID,
	   ANC.PC_ANC_USER2_ID,
	   ANC.PC_ANC_USER3_ID,
	   ANC.PC_ANC_USER4_ID,
	   ANC_USE1.USE_NAME ANC_USER_CREATION,
	   ANC_USE2.USE_NAME ANC_USER_VALIDATION,
	   ANC_USE3.USE_NAME ANC_USER_ALLOCATION,
	   ANC_USE4.USE_NAME ANC_REPONSIBLE,
	   ANC.DIC_ANC_CODE_ID,
	   ANC.DOC_RECORD_ID,
	   ANC.PC_LANG_ID,
	   ANC.PAC_ADDRESS_ID,
	   ANC.PAC_PERSON_ASSOCIATION_ID,
	   ANC.FAL_LOT_ID,
	   ANC.DOC_DOCUMENT_ID,
	   ANC.PAC_SUPPLIER_PARTNER_ID,
	   ANC.PAC_CUSTOM_PARTNER_ID,
	   ANC.C_ANC_STATUS,
	   ANC.C_ANC_TYPE,
	   ANC.ANC_NUMBER,
	   ANC.ANC_SHORT_DESCRIPTION,
	   ANC.ANC_LONG_DESCRIPTION,
	   ANC.ANC_PARTNER_NUMBER,
	   ANC.ANC_PARTNER_REF,
	   ANC.ANC_PARTNER_DATE, ANC_DATE,
	   ANC.ANC_PRINT_RECEPT_DATE,
	   ANC.ANC_VALIDATION_DATE,
	   ANC.ANC_ALLOCATION_DATE,
	   ANC.ANC_CLOSING_DATE,
	   ANC.ANC_VALIDATION_DURATION,
	   ANC.ANC_REPLY_DURATION,
	   ANC.ANC_ALLOCATION_DURATION,
	   ANC.ANC_PROCESSING_DURATION,
	   ANC.ANC_TOTAL_DURATION,
	   ANC.ANC_DIRECT_COST,
	   ANC.ANC_PREVENTIVE_COST,
	   ANC.ANC_FIXED_COST,
	   ANC.ANC_TOTAL_COST,
	   ANC.DIC_ANC_FREE1_ID,
	   ANC.DIC_ANC_FREE2_ID,
	   ANC.DIC_ANC_FREE3_ID,
	   ANC.DIC_ANC_FREE4_ID,
	   ANC.DIC_ANC_FREE5_ID,
	   ANC.ANC_FREE_TEXT1,
	   ANC.ANC_FREE_TEXT2,
	   ANC.ANC_FREE_TEXT3,
	   ANC.ANC_FREE_TEXT4,
	   ANC.ANC_FREE_TEXT5,
	   ANC.ANC_FREE_DATE1,
	   ANC.ANC_FREE_DATE2,
	   ANC.ANC_FREE_DATE3,
	   ANC.ANC_FREE_DATE4,
	   ANC.ANC_FREE_DATE5,
	   ANC.ANC_FREE_NUMBER1,
	   ANC.ANC_FREE_NUMBER2,
	   ANC.ANC_FREE_NUMBER3,
	   ANC.ANC_FREE_NUMBER4,
	   ANC.ANC_FREE_NUMBER5,
	   ANC.ANC_FREE_COMMENT1,
	   ANC.ANC_FREE_COMMENT2,
	   -- Positions
	   SAP.SQM_ANC_POSITION_ID,
	   SAP.GCO_GOOD_ID,
	   SAP.PC_SAP_USER1_ID,
	   SAP.PC_SAP_USER2_ID,
	   SAP.DIC_SAP_CTRL_ID,
	   SAP.DIC_SAP_CDEF_ID,
	   SAP.DIC_SAP_NDEF_ID,
	   SAP.DIC_SAP_DECISION_ID,
	   SAP.DIC_SAP_RESP_ID,
	   SAP.DOC_DOCUMENT2_ID,
	   SAP.C_ANC_POS_STATUS,
	   SAP.DIC_SAP_FREE1_ID,
	   SAP.DIC_SAP_FREE2_ID,
	   SAP.DIC_SAP_FREE3_ID,
	   SAP.DIC_SAP_FREE4_ID,
	   SAP.DIC_SAP_FREE5_ID,
	   SAP.SAP_NUMBER,
	   SAP.SAP_SECOND_REF,
	   SAP.SAP_PARTNER_REF,
	   SAP.SAP_COMMENT,
	   SAP.SAP_QTY_ACCEPT,
	   SAP.SAP_QTY_DEFECTIVE,
	   SAP.SAP_ACTUAL_VALUE,
	   SAP.SAP_REQUIRE_VALUE,
	   SAP.SAP_VALIDATION_DATE,
	   SAP.SAP_CLOSING_DATE,
	   SAP.SAP_VALIDATION_DURATION,
	   SAP.SAP_PROCESSING_DURATION,
	   SAP.SAP_TOTAL_DURATION,
	   SAP.SAP_RETURN,
	   SAP.SAP_TITLE,
	   SAP.SAP_DIRECT_COST,
	   SAP.SAP_PREVENTIVE_COST,
	   SAP.SAP_TOTAL_COST,
	   SAP.SAP_FREE_TEXT1,
	   SAP.SAP_FREE_TEXT2,
	   SAP.SAP_FREE_TEXT3,
	   SAP.SAP_FREE_TEXT4,
	   SAP.SAP_FREE_TEXT5,
	   SAP.SAP_FREE_DATE1,
	   SAP.SAP_FREE_DATE2,
	   SAP.SAP_FREE_DATE3,
	   SAP.SAP_FREE_DATE4,
	   SAP.SAP_FREE_DATE5,
	   SAP.SAP_FREE_NUMBER1,
	   SAP.SAP_FREE_NUMBER2,
	   SAP.SAP_FREE_NUMBER3,
	   SAP.SAP_FREE_NUMBER4,
	   SAP.SAP_FREE_NUMBER5,
	   SAP.SAP_FREE_COMMENT1,
	   SAP.SAP_FREE_COMMENT2,
	   SAP.PC_SAP_USER3_ID,
	   SAP.SAP_CREATION_DATE,
	   SAP_USE1.USE_NAME SAP_VALIDATION_USER,
	   SAP_USE3.USE_NAME SAP_CREATION_USER,
	   -- Address
	   ADR.ADD_ADDRESS1,
           ADR.ADD_FORMAT,
	   ADR.ADD_CITY,
	   -- Customer
       PER1.DIC_PERSON_POLITNESS_ID CUS_DIC_PERSON_POLITNESS_ID,
	   PER1.PER_NAME CUS_PER_NAME,
	   PER1.PER_FORENAME CUS_PER_FORENAME,
	   PER1.PER_ACTIVITY CUS_PER_ACTIVITY,
	   PER1.PER_COMMENT CUS_PER_COMMENT,
	   PER1.PER_KEY1 CUS_PER_KEY1,
	   PER1.PER_KEY2 CUS_PER_KEY2,
	   PER1.PER_SHORT_NAME CUS_PER_SHORT_NAME,
	   -- Supplier
       PER2.DIC_PERSON_POLITNESS_ID SUP_DIC_PERSON_POLITNESS_ID,
	   PER2.PER_NAME SUP_PER_NAME,
	   PER2.PER_FORENAME SUP_PER_FORENAME,
	   PER2.PER_ACTIVITY SUP_PER_ACTIVITY,
	   PER2.PER_COMMENT SUP_PER_COMMENT,
	   PER2.PER_KEY1 SUP_PER_KEY1,
	   PER2.PER_KEY2 SUP_PER_KEY2,
	   PER2.PER_SHORT_NAME SUP_PER_SHORT_NAME,
	   -- Contact
       PER3.DIC_PERSON_POLITNESS_ID ASO_DIC_PERSON_POLITNESS_ID,
	   PER3.PER_NAME ASO_PER_NAME,
	   PER3.PER_FORENAME ASO_PER_FORENAME,
	   PER3.PER_ACTIVITY ASO_PER_ACTIVITY,
	   PER3.PER_COMMENT ASO_PER_COMMENT,
	   PER3.PER_KEY1 ASO_PER_KEY1,
	   PER3.PER_KEY2 ASO_PER_KEY2,
	   PER3.PER_SHORT_NAME ASO_PER_SHORT_NAME,
	   -- langue
	   LAN.LANID,
	   -- Documents, dtails position
	   ANC_DOC.DMT_NUMBER,
	   POS_BACK_DOC.DMT_NUMBER POS_BACK_DMT_NUMBER,
	   -- Lots, Lots hist, opration
	   NVL(LOT_ANC.LOT_REFCOMPL, LOTH_ANC.LOT_REFCOMPL) ANC_LOT_REFCOMPL,
	   -- Autres
	   GCO.GOO_MAJOR_REFERENCE
    FROM SQM_ANC ANC
  	  ,SQM_ANC_POSITION SAP
          ,PAC_ADDRESS ADR
	  ,PAC_PERSON PER1
	  ,PAC_PERSON PER2
	  ,PAC_PERSON PER3
	  ,PAC_PERSON_ASSOCIATION ASO
	  ,PCS.PC_LANG LAN
	  ,PCS.PC_USER ANC_USE1
	  ,PCS.PC_USER ANC_USE2
	  ,PCS.PC_USER ANC_USE3
	  ,PCS.PC_USER ANC_USE4
	  ,DOC_DOCUMENT ANC_DOC
	  ,DOC_DOCUMENT POS_BACK_DOC
	  ,FAL_LOT LOT_ANC
	  ,FAL_LOT_HIST LOTH_ANC
	  ,PCS.PC_USER SAP_USE1
	  ,PCS.PC_USER SAP_USE3
	  ,GCO_GOOD GCO
	  ,SQM_ANC_LINK POSLINK
 WHERE ANC.SQM_ANC_ID = SAP.SQM_ANC_ID (+)
   AND SAP.SQM_ANC_POSITION_ID = POSLINK.SQM_ANC_POSITION_ID (+)
   AND POSLINK.SQM_ANC_DIRECT_ACTION_ID IS NULL
   AND ANC.PAC_CUSTOM_PARTNER_ID = PER1.PAC_PERSON_ID (+)
   AND ANC.PAC_SUPPLIER_PARTNER_ID = PER2.PAC_PERSON_ID (+)
   AND ANC.PAC_PERSON_ASSOCIATION_ID = ASO.PAC_PERSON_ASSOCIATION_ID (+)
   AND ASO.PAC_PAC_PERSON_ID = PER3.PAC_PERSON_ID (+)
   AND ANC.PAC_ADDRESS_ID = ADR.PAC_ADDRESS_ID (+)
   AND ANC.PC_LANG_ID = LAN.PC_LANG_ID (+)
   AND ANC.PC_ANC_USER1_ID = ANC_USE1.PC_USER_ID (+)
   AND ANC.PC_ANC_USER2_ID = ANC_USE2.PC_USER_ID (+)
   AND ANC.PC_ANC_USER3_ID = ANC_USE3.PC_USER_ID (+)
   AND ANC.PC_ANC_USER4_ID = ANC_USE4.PC_USER_ID (+)
   AND ANC.DOC_DOCUMENT_ID = ANC_DOC.DOC_DOCUMENT_ID (+)
   AND SAP.GCO_GOOD_ID = GCO.GCO_GOOD_ID (+)
   AND ANC.FAL_LOT_ID = LOT_ANC.FAL_LOT_ID (+)
   AND ANC.FAL_LOT_ID = LOTH_ANC.FAL_LOT_HIST_ID (+)
   AND SAP.DOC_DOCUMENT2_ID = POS_BACK_DOC.DOC_DOCUMENT_ID (+)
   AND SAP.PC_SAP_USER1_ID = SAP_USE1.PC_USER_ID  (+)
   AND SAP.PC_SAP_USER3_ID = SAP_USE3.PC_USER_ID  (+)


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_SQM_AUDIT_MODEL_PRNT" ("SQM_AUDIT_MODEL_ID", "AUM_DESCRIPTION", "AUM_VERSION", "AUM_COMMENT", "CSM_SEQUENCE", "SQM_AUDIT_CHAPTER_ID", "ACH_TITLE", "ACH_COMMENT", "SQM_AUDIT_QUESTION_ID", "AQU_DESCRIPTION", "AQU_COMMENT", "AQU_SEQ", "SQM_AXIS_ID", "C_AXIS_TYPE", "SQM_AXIS_VALUE_ID", "AXV_VALUE", "AXV_DESCRIPTION", "STA_PENALTY") AS
  SELECT MO.SQM_AUDIT_MODEL_ID,
	   MO.AUM_DESCRIPTION,
	   MO.AUM_VERSION,
	   MO.AUM_COMMENT,
	   CM.CSM_SEQUENCE,
	   CH.SQM_AUDIT_CHAPTER_ID,
	   CH.ACH_TITLE,
	   CH.ACH_COMMENT,
	   QU.SQM_AUDIT_QUESTION_ID,
	   QU.AQU_DESCRIPTION,
	   QU.AQU_COMMENT,
	   QU.AQU_SEQ,
	   AX.SQM_AXIS_ID,
	   AX.C_AXIS_TYPE,
	   AV.SQM_AXIS_VALUE_ID,
	   AV.AXV_VALUE,
	   AV.AXV_DESCRIPTION,
	   ST.STA_PENALTY
FROM   SQM_AUDIT_MODEL MO,
	   SQM_AUDIT_CHAP_S_MODEL CM,
	   SQM_AUDIT_CHAPTER CH,
	   SQM_AUDIT_QUESTION QU,
	   SQM_AXIS AX,
	   SQM_AXIS_VALUE AV,
	   SQM_SCALE_TABLE ST
WHERE  MO.SQM_AUDIT_MODEL_ID=CM.SQM_AUDIT_MODEL_ID AND
	   CM.SQM_AUDIT_CHAPTER_ID=CH.SQM_AUDIT_CHAPTER_ID AND
	   CM.SQM_AUDIT_CHAPTER_ID=QU.SQM_AUDIT_CHAPTER_ID (+) AND
	   QU.SQM_AXIS_ID = AX.SQM_AXIS_ID (+) AND
	   AX.SQM_AXIS_ID = AV.SQM_AXIS_ID (+) AND
	   AV.SQM_AXIS_VALUE_ID = ST.SQM_AXIS_VALUE_ID (+)
ORDER BY CM.CSM_SEQUENCE, QU.AQU_SEQ




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_SQM_AUDIT_PRNT" ("SQM_AUDIT_ID", "AUD_DATE", "AUD_EXPIRY_DATE", "DIC_AUD_CAMPAIGN_ID", "AUD_RESULT", "PER_NAME", "USE_NAME", "SQM_AUDIT_MODEL_ID", "AUM_DESCRIPTION", "AUM_VERSION", "AUM_COMMENT", "CSM_SEQUENCE", "SQM_AUDIT_CHAPTER_ID", "ACH_TITLE", "ACH_COMMENT", "SQM_AUDIT_QUESTION_ID", "AQU_DESCRIPTION", "AQU_COMMENT", "AQU_SEQ", "SQM_AXIS_ID", "C_AXIS_TYPE", "SQM_AXIS_VALUE_ID", "AXV_VALUE", "AXV_DESCRIPTION", "STA_PENALTY") AS
  SELECT AU.SQM_AUDIT_ID,
	   AU.AUD_DATE,
       AU.AUD_EXPIRY_DATE,
	   AU.DIC_AUD_CAMPAIGN_ID,
	   AU.AUD_RESULT,
       PE.PER_NAME,
	   US.USE_NAME,
       MO.SQM_AUDIT_MODEL_ID,
	   MO.AUM_DESCRIPTION,
	   MO.AUM_VERSION,
	   MO.AUM_COMMENT,
	   CM.CSM_SEQUENCE,
	   CH.SQM_AUDIT_CHAPTER_ID,
	   CH.ACH_TITLE,
	   CH.ACH_COMMENT,
	   QU.SQM_AUDIT_QUESTION_ID,
	   QU.AQU_DESCRIPTION,
	   QU.AQU_COMMENT,
	   QU.AQU_SEQ,
	   AX.SQM_AXIS_ID,
	   AX.C_AXIS_TYPE,
	   AV.SQM_AXIS_VALUE_ID,
	   AV.AXV_VALUE,
	   AV.AXV_DESCRIPTION,
	   ST.STA_PENALTY
FROM   SQM_AUDIT AU,
       SQM_AUDIT_MODEL MO,
	   SQM_AUDIT_CHAP_S_MODEL CM,
	   SQM_AUDIT_CHAPTER CH,
	   SQM_AUDIT_QUESTION QU,
	   SQM_AXIS AX,
	   SQM_AXIS_VALUE AV,
	   SQM_SCALE_TABLE ST,
	   PAC_PERSON PE,
	   PCS.PC_USER US
WHERE  AU.SQM_AUDIT_MODEL_ID = MO.SQM_AUDIT_MODEL_ID AND
	   MO.SQM_AUDIT_MODEL_ID=CM.SQM_AUDIT_MODEL_ID (+) AND
	   CM.SQM_AUDIT_CHAPTER_ID=CH.SQM_AUDIT_CHAPTER_ID AND
	   CM.SQM_AUDIT_CHAPTER_ID=QU.SQM_AUDIT_CHAPTER_ID (+) AND
	   QU.SQM_AXIS_ID = AX.SQM_AXIS_ID (+) AND
	   AX.SQM_AXIS_ID = AV.SQM_AXIS_ID (+) AND
	   AV.SQM_AXIS_VALUE_ID = ST.SQM_AXIS_VALUE_ID (+) AND
	   AU.PAC_THIRD_ID = PE.PAC_PERSON_ID (+) AND
	   AU.PC_USER_ID = US.PC_USER_ID (+)
ORDER BY CM.CSM_SEQUENCE, QU.AQU_SEQ




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_ANNUAL_EVOLUTION" ("STM_ANNUAL_EVOLUTION_ID", "GCO_GOOD_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SAE_CHARACTERIZATION_VALUE_1", "SAE_CHARACTERIZATION_VALUE_2", "SAE_CHARACTERIZATION_VALUE_3", "SAE_CHARACTERIZATION_VALUE_4", "SAE_CHARACTERIZATION_VALUE_5", "STM_STOCK_ID", "SAE_YEAR", "SAE_MONTH", "SAE_INPUT_QUANTITY", "SAE_INPUT_VALUE", "SAE_OUTPUT_QUANTITY", "SAE_OUTPUT_VALUE", "SOLDE_QTY_START", "SOLDE_VALUE_START", "A_DATECRE", "A_IDCRE") AS
  select STM_ANNUAL_EVOLUTION_ID
       , GCO_GOOD_ID
       , GCO_CHARACTERIZATION_ID
       , GCO_GCO_CHARACTERIZATION_ID
       , GCO2_GCO_CHARACTERIZATION_ID
       , GCO3_GCO_CHARACTERIZATION_ID
       , GCO4_GCO_CHARACTERIZATION_ID
       , SAE_CHARACTERIZATION_VALUE_1
       , SAE_CHARACTERIZATION_VALUE_2
       , SAE_CHARACTERIZATION_VALUE_3
       , SAE_CHARACTERIZATION_VALUE_4
       , SAE_CHARACTERIZATION_VALUE_5
       , STM_STOCK_ID
       , sae_year
       , sae_month
       , SAE_INPUT_QUANTITY
       , SAE_INPUT_VALUE
       , SAE_OUTPUT_QUANTITY
       , SAE_OUTPUT_VALUE
       , STM_ANNUALEVOL.GetMonthBalanceQty_Char(GCO_GOOD_ID
                                              , STM_STOCK_ID
                                              , SAE_YEAR
                                              , SAE_MONTH
                                              , GCO_CHARACTERIZATION_ID
                                              , GCO_GCO_CHARACTERIZATION_ID
                                              , GCO2_GCO_CHARACTERIZATION_ID
                                              , GCO3_GCO_CHARACTERIZATION_ID
                                              , GCO4_GCO_CHARACTERIZATION_ID
                                              , SAE_CHARACTERIZATION_VALUE_1
                                              , SAE_CHARACTERIZATION_VALUE_2
                                              , SAE_CHARACTERIZATION_VALUE_3
                                              , SAE_CHARACTERIZATION_VALUE_4
                                              , SAE_CHARACTERIZATION_VALUE_5
                                              , 1
                                               ) SOLDE_qty_start
       , STM_ANNUALEVOL.GetMonthBalanceValue_Char(GCO_GOOD_ID
                                                , STM_STOCK_ID
                                                , SAE_YEAR
                                                , SAE_MONTH
                                                , GCO_CHARACTERIZATION_ID
                                                , GCO_GCO_CHARACTERIZATION_ID
                                                , GCO2_GCO_CHARACTERIZATION_ID
                                                , GCO3_GCO_CHARACTERIZATION_ID
                                                , GCO4_GCO_CHARACTERIZATION_ID
                                                , SAE_CHARACTERIZATION_VALUE_1
                                                , SAE_CHARACTERIZATION_VALUE_2
                                                , SAE_CHARACTERIZATION_VALUE_3
                                                , SAE_CHARACTERIZATION_VALUE_4
                                                , SAE_CHARACTERIZATION_VALUE_5
                                                , 1
                                                 ) SOLDE_value_start
       , A_DATECRE
       , A_IDCRE
    from stm_annual_evolution


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_COMPARE_MVT_POS" ("UPDATEMODE", "GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPO_CHARACTERIZATION_VALUE_1", "SPO_CHARACTERIZATION_VALUE_2", "SPO_CHARACTERIZATION_VALUE_3", "SPO_CHARACTERIZATION_VALUE_4", "SPO_CHARACTERIZATION_VALUE_5", "SPO_SHOULD_STOCK_QUANTITY", "SPO_IS_STOCK_QUANTITY", "SPO_DELTA_QUANTITY") AS
  select updatemode
       , gco_good_id
       , stm_stock_id
       , stm_location_id
       , gco_characterization_id
       , gco_gco_characterization_id
       , gco2_gco_characterization_id
       , gco3_gco_characterization_id
       , gco4_gco_characterization_id
       , spo_characterization_value_1
       , spo_characterization_value_2
       , spo_characterization_value_3
       , spo_characterization_value_4
       , spo_characterization_value_5
       , spo_should_stock_quantity
       , spo_is_stock_quantity
       , spo_delta_quantity
from (
  select updatemode
       , gco_good_id
       , stm_stock_id
       , stm_location_id
       , gco_characterization_id
       , gco_gco_characterization_id
       , gco2_gco_characterization_id
       , gco3_gco_characterization_id
       , gco4_gco_characterization_id
       , spo_characterization_value_1
       , spo_characterization_value_2
       , spo_characterization_value_3
       , spo_characterization_value_4
       , spo_characterization_value_5
       , spo_should_stock_quantity
       , spo_is_stock_quantity
       , spo_delta_quantity
from v_stm_stk_pos_to_delete
union
  select updatemode
       , gco_good_id
       , stm_stock_id
       , stm_location_id
       , gco_characterization_id
       , gco_gco_characterization_id
       , gco2_gco_characterization_id
       , gco3_gco_characterization_id
       , gco4_gco_characterization_id
       , spo_characterization_value_1
       , spo_characterization_value_2
       , spo_characterization_value_3
       , spo_characterization_value_4
       , spo_characterization_value_5
       , spo_should_stock_quantity
       , spo_is_stock_quantity
       , spo_delta_quantity
from v_stm_stk_pos_to_update
union
  select updatemode
       , gco_good_id
       , stm_stock_id
       , stm_location_id
       , gco_characterization_id
       , gco_gco_characterization_id
       , gco2_gco_characterization_id
       , gco3_gco_characterization_id
       , gco4_gco_characterization_id
       , spo_characterization_value_1
       , spo_characterization_value_2
       , spo_characterization_value_3
       , spo_characterization_value_4
       , spo_characterization_value_5
       , spo_should_stock_quantity
       , spo_is_stock_quantity
       , spo_delta_quantity
from v_stm_stk_pos_to_insert)
order by 1,2,3,4,10,11,12,13,14




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_ELEMENT_NUMBER" ("STM_ELEMENT_NUMBER_ID", "GCO_GOOD_ID", "C_ELE_NUM_STATUS", "C_ELEMENT_TYPE", "SEM_VALUE", "SEM_PIECE", "SEM_SET", "SEM_VERSION", "SEM_COMMENT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM") AS
  select STM_ELEMENT_NUMBER_ID
       , GCO_GOOD_ID
       , C_ELE_NUM_STATUS
       , C_ELEMENT_TYPE
       , SEM_VALUE
       , decode(C_ELEMENT_TYPE, '02', SEM_VALUE) SEM_PIECE
       , decode(C_ELEMENT_TYPE, '01', SEM_VALUE) SEM_SET
       , decode(C_ELEMENT_TYPE, '03', SEM_VALUE) SEM_VERSION
       , SEM_COMMENT
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
       , A_CONFIRM
    from STM_ELEMENT_NUMBER A


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_GCO_GOOD_QTY" ("GCO_GOOD_ID", "SPO_AVAILABLE_QUANTITY", "SPO_STOCK_QUANTITY", "SPO_ASSIGN_QUANTITY", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT", "SPO_THEORETICAL_QUANTITY", "SPO_ALTERNATIV_QUANTITY_1", "SPO_ALTERNATIV_QUANTITY_2", "SPO_ALTERNATIV_QUANTITY_3") AS
  select   A.GCO_GOOD_ID
         , sum(A.SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(A.SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(A.SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(A.SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(A.SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(A.SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(A.SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(A.SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(A.SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION A
         , STM_STOCK B
     where A.STM_STOCK_ID = B.STM_STOCK_ID
       and B.STO_NEED_CALCULATION = 1
  group by A.GCO_GOOD_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_GCO_GOOD_QTY_BY_LOCATION" ("GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "SPO_AVAILABLE_QUANTITY", "SPO_STOCK_QUANTITY", "SPO_ASSIGN_QUANTITY", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT", "SPO_THEORETICAL_QUANTITY", "SPO_ALTERNATIV_QUANTITY_1", "SPO_ALTERNATIV_QUANTITY_2", "SPO_ALTERNATIV_QUANTITY_3") AS
  select   A.GCO_GOOD_ID
         , A.STM_STOCK_ID
         , A.STM_LOCATION_ID
         , sum(A.SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(A.SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(A.SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(A.SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(A.SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(A.SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(A.SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(A.SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(A.SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION A
         , STM_STOCK B
     where A.STM_STOCK_ID = B.STM_STOCK_ID
       and B.STO_NEED_CALCULATION = 1
  group by A.GCO_GOOD_ID
         , A.STM_STOCK_ID
         , A.STM_LOCATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_GCO_GOOD_QTY_BY_STOCK" ("GCO_GOOD_ID", "STM_STOCK_ID", "SPO_AVAILABLE_QUANTITY", "SPO_STOCK_QUANTITY", "SPO_ASSIGN_QUANTITY", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT", "SPO_THEORETICAL_QUANTITY", "SPO_ALTERNATIV_QUANTITY_1", "SPO_ALTERNATIV_QUANTITY_2", "SPO_ALTERNATIV_QUANTITY_3") AS
  select   A.GCO_GOOD_ID
         , A.STM_STOCK_ID
         , sum(A.SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(A.SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(A.SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(A.SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(A.SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(A.SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(A.SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(A.SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(A.SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION A
         , STM_STOCK B
     where A.STM_STOCK_ID = B.STM_STOCK_ID
       and B.STO_NEED_CALCULATION = 1
  group by A.GCO_GOOD_ID
         , A.STM_STOCK_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_INVENTORY_PRINT_IJO" ("C_INVENTORY_TYPE", "EXE_DESCRIPTION", "STM_EXERCISE_ID", "PER_DESCRIPTION", "STM_PERIOD_ID", "INV_DESCRIPTION", "ILI_DESCRIPTION", "ILI_REMARK", "GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_ADDED_QTY_COST_PRICE", "GOO_ADDED_VALUE_COST_PRICE", "GOO_BASE_COST_PRICE", "GOO_EAN_CODE", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "GOO_NUMBER_OF_DECIMAL", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_10_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GOO_WEB_CATEG1_ID", "DIC_GOO_WEB_CATEG2_ID", "DIC_GOO_WEB_CATEG3_ID", "DIC_GOO_WEB_CATEG4_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_GROUP_ID", "DIC_GOOD_LINE_ID", "DIC_GOOD_MODEL_ID", "DIC_UNIT_OF_MEASURE_ID", "C_GOOD_STATUS", "C_MANAGEMENT_MODE", "STM_STOCK_ID", "STO_DESCRIPTION", "STM_LOCATION_ID", "LOC_DESCRIPTION", "IJO_JOB_DESCRIPTION", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "IJD_CHARACTERIZATION_VALUE_1", "IJD_CHARACTERIZATION_VALUE_2", "IJD_CHARACTERIZATION_VALUE_3", "IJD_CHARACTERIZATION_VALUE_4", "IJD_CHARACTERIZATION_VALUE_5", "IJD_QUANTITY", "IJD_VALUE", "IJD_UNIT_PRICE", "IJD_ALTERNATIV_QTY_1", "IJD_ALTERNATIV_QTY_2", "IJD_ALTERNATIV_QTY_3", "IJD_FREE_TEXT1", "IJD_FREE_TEXT2", "IJD_FREE_TEXT3", "IJD_FREE_TEXT4", "IJD_FREE_TEXT5", "IJD_FREE_NUMBER1", "IJD_FREE_NUMBER2", "IJD_FREE_NUMBER3", "IJD_FREE_NUMBER4", "IJD_FREE_NUMBER5", "IJD_FREE_DATE1", "IJD_FREE_DATE2", "IJD_FREE_DATE3", "IJD_FREE_DATE4", "IJD_FREE_DATE5", "IJD_RETEST_DATE", "STM_INVENTORY_TASK_ID", "STM_INVENTORY_LIST_ID", "STM_INVENTORY_JOB_ID", "STM_INVENTORY_JOB_DETAIL_ID", "IPT_PRINT_SESSION") AS
  select INV.C_INVENTORY_TYPE
       , EXE.EXE_DESCRIPTION
       , EXE.STM_EXERCISE_ID
       , PER.PER_DESCRIPTION
       , PER.STM_PERIOD_ID
       , INV.INV_DESCRIPTION
       , ILI.ILI_DESCRIPTION
       , ILI.ILI_REMARK
       , GOO.GCO_GOOD_ID
       , GOO.GOO_MAJOR_REFERENCE
       , GOO.GOO_SECONDARY_REFERENCE
       , GCD.GOO_ADDED_QTY_COST_PRICE
       , GCD.GOO_ADDED_VALUE_COST_PRICE
       , GCD.GOO_BASE_COST_PRICE
       , GOO.GOO_EAN_CODE
       , GOO.GOO_HIBC_PRIMARY_CODE
       , GOO.GOO_HIBC_REFERENCE
       , GOO.GOO_EAN_UCC14_CODE
       , GOO.GOO_NUMBER_OF_DECIMAL
       , GOO.DIC_ACCOUNTABLE_GROUP_ID
       , GOO.DIC_GCO_STATISTIC_1_ID
       , GOO.DIC_GCO_STATISTIC_10_ID
       , GOO.DIC_GCO_STATISTIC_2_ID
       , GOO.DIC_GCO_STATISTIC_3_ID
       , GOO.DIC_GCO_STATISTIC_4_ID
       , GOO.DIC_GCO_STATISTIC_5_ID
       , GOO.DIC_GCO_STATISTIC_6_ID
       , GOO.DIC_GCO_STATISTIC_7_ID
       , GOO.DIC_GCO_STATISTIC_8_ID
       , GOO.DIC_GCO_STATISTIC_9_ID
       , GOO.DIC_GOO_WEB_CATEG1_ID
       , GOO.DIC_GOO_WEB_CATEG2_ID
       , GOO.DIC_GOO_WEB_CATEG3_ID
       , GOO.DIC_GOO_WEB_CATEG4_ID
       , GOO.DIC_GOOD_FAMILY_ID
       , GOO.DIC_GOOD_GROUP_ID
       , GOO.DIC_GOOD_LINE_ID
       , GOO.DIC_GOOD_MODEL_ID
       , GOO.DIC_UNIT_OF_MEASURE_ID
       , GOO.C_GOOD_STATUS
       , GOO.C_MANAGEMENT_MODE
       , STO.STM_STOCK_ID
       , STO.STO_DESCRIPTION
       , LOC.STM_LOCATION_ID
       , LOC.LOC_DESCRIPTION
       , IJO.IJO_JOB_DESCRIPTION
       , IJD.GCO_CHARACTERIZATION_ID
       , IJD.GCO_GCO_CHARACTERIZATION_ID
       , IJD.GCO2_GCO_CHARACTERIZATION_ID
       , IJD.GCO3_GCO_CHARACTERIZATION_ID
       , IJD.GCO4_GCO_CHARACTERIZATION_ID
       , IJD.IJD_CHARACTERIZATION_VALUE_1
       , IJD.IJD_CHARACTERIZATION_VALUE_2
       , IJD.IJD_CHARACTERIZATION_VALUE_3
       , IJD.IJD_CHARACTERIZATION_VALUE_4
       , IJD.IJD_CHARACTERIZATION_VALUE_5
       , IJD.IJD_QUANTITY
       , IJD.IJD_VALUE
       , IJD.IJD_UNIT_PRICE
       , IJD.IJD_ALTERNATIV_QTY_1
       , IJD.IJD_ALTERNATIV_QTY_2
       , IJD.IJD_ALTERNATIV_QTY_3
       , IJD_FREE_TEXT1
       , IJD_FREE_TEXT2
       , IJD_FREE_TEXT3
       , IJD_FREE_TEXT4
       , IJD_FREE_TEXT5
       , IJD_RETEST_DATE
       , IJD_FREE_NUMBER1
       , IJD_FREE_NUMBER2
       , IJD_FREE_NUMBER3
       , IJD_FREE_NUMBER4
       , IJD_FREE_NUMBER5
       , IJD_FREE_DATE1
       , IJD_FREE_DATE2
       , IJD_FREE_DATE3
       , IJD_FREE_DATE4
       , IJD_FREE_DATE5
       , INV.STM_INVENTORY_TASK_ID
       , ILI.STM_INVENTORY_LIST_ID
       , IJO.STM_INVENTORY_JOB_ID
       , IJD.STM_INVENTORY_JOB_DETAIL_ID
       , IPT.IPT_PRINT_SESSION
    from STM_INVENTORY_TASK INV
       , STM_INVENTORY_PRINT IPT
       , STM_INVENTORY_LIST ILI
       , STM_INVENTORY_JOB IJO
       , STM_INVENTORY_JOB_DETAIL IJD
       , STM_STOCK STO
       , STM_LOCATION LOC
       , STM_PERIOD PER
       , STM_EXERCISE EXE
       , GCO_GOOD GOO
       , GCO_GOOD_CALC_DATA GCD
   where INV.STM_INVENTORY_TASK_ID = IJO.STM_INVENTORY_TASK_ID
     and INV.STM_PERIOD_ID = PER.STM_PERIOD_ID
     and PER.STM_EXERCISE_ID = EXE.STM_EXERCISE_ID
     and IPT.STM_INVENTORY_JOB_ID = IJO.STM_INVENTORY_JOB_ID
     and IJO.STM_INVENTORY_JOB_ID = IJD.STM_INVENTORY_JOB_ID
     and IJO.STM_INVENTORY_LIST_ID = ILI.STM_INVENTORY_LIST_ID
     and IJD.STM_STOCK_ID = STO.STM_STOCK_ID
     and IJD.GCO_GOOD_ID = GOO.GCO_GOOD_ID
     and IJD.STM_LOCATION_ID = LOC.STM_LOCATION_ID
     and GOO.GCO_GOOD_ID = GCD.GCO_GOOD_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_INVENTORY_PRINT_ILP" ("C_INVENTORY_TYPE", "EXE_DESCRIPTION", "STM_EXERCISE_ID", "PER_DESCRIPTION", "STM_PERIOD_ID", "INV_DESCRIPTION", "ILI_DESCRIPTION", "ILI_REMARK", "GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE", "GOO_ADDED_QTY_COST_PRICE", "GOO_ADDED_VALUE_COST_PRICE", "GOO_BASE_COST_PRICE", "GOO_EAN_CODE", "GOO_HIBC_PRIMARY_CODE", "GOO_HIBC_REFERENCE", "GOO_EAN_UCC14_CODE", "GOO_NUMBER_OF_DECIMAL", "DIC_ACCOUNTABLE_GROUP_ID", "DIC_GCO_STATISTIC_1_ID", "DIC_GCO_STATISTIC_10_ID", "DIC_GCO_STATISTIC_2_ID", "DIC_GCO_STATISTIC_3_ID", "DIC_GCO_STATISTIC_4_ID", "DIC_GCO_STATISTIC_5_ID", "DIC_GCO_STATISTIC_6_ID", "DIC_GCO_STATISTIC_7_ID", "DIC_GCO_STATISTIC_8_ID", "DIC_GCO_STATISTIC_9_ID", "DIC_GOO_WEB_CATEG1_ID", "DIC_GOO_WEB_CATEG2_ID", "DIC_GOO_WEB_CATEG3_ID", "DIC_GOO_WEB_CATEG4_ID", "DIC_GOOD_FAMILY_ID", "DIC_GOOD_GROUP_ID", "DIC_GOOD_LINE_ID", "DIC_GOOD_MODEL_ID", "DIC_UNIT_OF_MEASURE_ID", "C_GOOD_STATUS", "C_MANAGEMENT_MODE", "STM_STOCK_ID", "STO_DESCRIPTION", "STM_LOCATION_ID", "LOC_DESCRIPTION", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "ILP_CHARACTERIZATION_VALUE_1", "ILP_CHARACTERIZATION_VALUE_2", "ILP_CHARACTERIZATION_VALUE_3", "ILP_CHARACTERIZATION_VALUE_4", "ILP_CHARACTERIZATION_VALUE_5", "ILP_IS_ORIGINAL_POS", "ILP_IS_VALIDATED", "ILP_SYSTEM_VALUE", "ILP_SYSTEM_QUANTITY", "ILP_SYSTEM_UNIT_PRICE", "ILP_INVENTORY_VALUE", "ILP_INVENTORY_QUANTITY", "ILP_INVENTORY_UNIT_PRICE", "ILP_INVENTORY_DATE", "ILP_SYS_ALTERNATIV_QTY_1", "ILP_SYS_ALTERNATIV_QTY_2", "ILP_SYS_ALTERNATIV_QTY_3", "ILP_INV_ALTERNATIV_QTY_1", "ILP_INV_ALTERNATIV_QTY_2", "ILP_INV_ALTERNATIV_QTY_3", "C_INVENTORY_ERROR_STATUS", "IPT_PRINT_SESSION", "STM_INVENTORY_TASK_ID", "STM_INVENTORY_LIST_ID", "STM_INVENTORY_EXTERNAL_ID", "STM_INVENTORY_LIST_POS_ID") AS
  select INV.C_INVENTORY_TYPE
       , EXE.EXE_DESCRIPTION
       , EXE.STM_EXERCISE_ID
       , PER.PER_DESCRIPTION
       , PER.STM_PERIOD_ID
       , INV.INV_DESCRIPTION
       , ILI.ILI_DESCRIPTION
       , ILI.ILI_REMARK
       , GOO.GCO_GOOD_ID
       , GOO.GOO_MAJOR_REFERENCE
       , GOO.GOO_SECONDARY_REFERENCE
       , GCD.GOO_ADDED_QTY_COST_PRICE
       , GCD.GOO_ADDED_VALUE_COST_PRICE
       , GCD.GOO_BASE_COST_PRICE
       , GOO.GOO_EAN_CODE
       , GOO.GOO_HIBC_PRIMARY_CODE
       , GOO.GOO_HIBC_REFERENCE
       , GOO.GOO_EAN_UCC14_CODE
       , GOO.GOO_NUMBER_OF_DECIMAL
       , GOO.DIC_ACCOUNTABLE_GROUP_ID
       , GOO.DIC_GCO_STATISTIC_1_ID
       , GOO.DIC_GCO_STATISTIC_10_ID
       , GOO.DIC_GCO_STATISTIC_2_ID
       , GOO.DIC_GCO_STATISTIC_3_ID
       , GOO.DIC_GCO_STATISTIC_4_ID
       , GOO.DIC_GCO_STATISTIC_5_ID
       , GOO.DIC_GCO_STATISTIC_6_ID
       , GOO.DIC_GCO_STATISTIC_7_ID
       , GOO.DIC_GCO_STATISTIC_8_ID
       , GOO.DIC_GCO_STATISTIC_9_ID
       , GOO.DIC_GOO_WEB_CATEG1_ID
       , GOO.DIC_GOO_WEB_CATEG2_ID
       , GOO.DIC_GOO_WEB_CATEG3_ID
       , GOO.DIC_GOO_WEB_CATEG4_ID
       , GOO.DIC_GOOD_FAMILY_ID
       , GOO.DIC_GOOD_GROUP_ID
       , GOO.DIC_GOOD_LINE_ID
       , GOO.DIC_GOOD_MODEL_ID
       , GOO.DIC_UNIT_OF_MEASURE_ID
       , GOO.C_GOOD_STATUS
       , GOO.C_MANAGEMENT_MODE
       , STO.STM_STOCK_ID
       , STO.STO_DESCRIPTION
       , LOC.STM_LOCATION_ID
       , LOC.LOC_DESCRIPTION
       , ILP.GCO_CHARACTERIZATION_ID
       , ILP.GCO_GCO_CHARACTERIZATION_ID
       , ILP.GCO2_GCO_CHARACTERIZATION_ID
       , ILP.GCO3_GCO_CHARACTERIZATION_ID
       , ILP.GCO4_GCO_CHARACTERIZATION_ID
       , ILP.ILP_CHARACTERIZATION_VALUE_1
       , ILP.ILP_CHARACTERIZATION_VALUE_2
       , ILP.ILP_CHARACTERIZATION_VALUE_3
       , ILP.ILP_CHARACTERIZATION_VALUE_4
       , ILP.ILP_CHARACTERIZATION_VALUE_5
       , ILP.ILP_IS_ORIGINAL_POS
       , ILP.ILP_IS_VALIDATED
       , ILP.ILP_SYSTEM_VALUE
       , ILP.ILP_SYSTEM_QUANTITY
       , ILP.ILP_SYSTEM_UNIT_PRICE
       , ILP.ILP_INVENTORY_VALUE
       , ILP.ILP_INVENTORY_QUANTITY
       , ILP.ILP_INVENTORY_UNIT_PRICE
       , ILP.ILP_INVENTORY_DATE
       , ILP.ILP_SYS_ALTERNATIV_QTY_1
       , ILP.ILP_SYS_ALTERNATIV_QTY_2
       , ILP.ILP_SYS_ALTERNATIV_QTY_3
       , ILP.ILP_INV_ALTERNATIV_QTY_1
       , ILP.ILP_INV_ALTERNATIV_QTY_2
       , ILP.ILP_INV_ALTERNATIV_QTY_3
       , ILP.C_INVENTORY_ERROR_STATUS
       , IPT.IPT_PRINT_SESSION
       , INV.STM_INVENTORY_TASK_ID
       , ILI.STM_INVENTORY_LIST_ID
       , ILI.STM_INVENTORY_EXTERNAL_ID
       , ILP.STM_INVENTORY_LIST_POS_ID
    from STM_INVENTORY_TASK INV
       , STM_INVENTORY_PRINT IPT
       , STM_INVENTORY_LIST ILI
       , STM_INVENTORY_LIST_POS ILP
       , STM_STOCK STO
       , STM_LOCATION LOC
       , STM_PERIOD PER
       , STM_EXERCISE EXE
       , GCO_GOOD GOO
       , GCO_GOOD_CALC_DATA GCD
   where INV.STM_INVENTORY_TASK_ID = ILP.STM_INVENTORY_TASK_ID
     and INV.STM_PERIOD_ID = PER.STM_PERIOD_ID
     and PER.STM_EXERCISE_ID = EXE.STM_EXERCISE_ID
     and IPT.STM_INVENTORY_LIST_ID = ILI.STM_INVENTORY_LIST_ID
     and ILI.STM_INVENTORY_LIST_ID = ILP.STM_INVENTORY_LIST_ID
     and ILP.STM_STOCK_ID = STO.STM_STOCK_ID
     and ILP.GCO_GOOD_ID = GOO.GCO_GOOD_ID
     and ILP.STM_LOCATION_ID = LOC.STM_LOCATION_ID
     and GOO.GCO_GOOD_ID = GCD.GCO_GOOD_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_INVENTORY_PRINT_ILP_CUM" ("IPT_PRINT_SESSION", "STM_INVENTORY_TASK_ID", "INV_DESCRIPTION", "STM_INVENTORY_LIST_ID", "ILI_DESCRIPTION", "STM_STOCK_ID", "STO_DESCRIPTION", "STM_LOCATION_ID", "LOC_DESCRIPTION", "ILP_SYSTEM_VALUE_CUM", "ILP_SYSTEM_QUANTITY_CUM", "ILP_INVENTORY_VALUE_CUM", "ILP_INVENTORY_QUANTITY_CUM", "ILP_INVENTORY_DIFF_VALUE_CUM", "ILP_INVENTORY_DIFF_QTY_CUM") AS
  SELECT
  IPT.IPT_PRINT_SESSION,
  INV.STM_INVENTORY_TASK_ID,
  INV.INV_DESCRIPTION,
  ILI.STM_INVENTORY_LIST_ID,
  ILI.ILI_DESCRIPTION,
  STO.STM_STOCK_ID,
  STO.STO_DESCRIPTION,
  LOC.STM_LOCATION_ID,
  LOC.LOC_DESCRIPTION,
  SUM(ILP.ILP_SYSTEM_VALUE) ILP_SYSTEM_VALUE_CUM,
  SUM(ILP.ILP_SYSTEM_QUANTITY) ILP_SYSTEM_QUANTITY_CUM,
  SUM(ILP.ILP_INVENTORY_VALUE) ILP_INVENTORY_VALUE_CUM,
  SUM(ILP.ILP_INVENTORY_QUANTITY) ILP_INVENTORY_QUANTITY_CUM,
  SUM(ILP.ILP_INVENTORY_VALUE - ILP.ILP_SYSTEM_VALUE) ILP_INVENTORY_DIFF_VALUE_CUM,
  SUM(ILP.ILP_INVENTORY_QUANTITY - ILP.ILP_SYSTEM_QUANTITY) ILP_INVENTORY_DIFF_QTY_CUM
FROM
  STM_INVENTORY_TASK INV,
  STM_INVENTORY_PRINT IPT,
  STM_INVENTORY_LIST ILI,
  STM_INVENTORY_LIST_POS ILP,
  STM_STOCK STO,
  STM_LOCATION LOC
WHERE
  INV.STM_INVENTORY_TASK_ID = ILP.STM_INVENTORY_TASK_ID AND
  IPT.STM_INVENTORY_LIST_ID = ILI.STM_INVENTORY_LIST_ID AND
  ILI.STM_INVENTORY_LIST_ID = ILP.STM_INVENTORY_LIST_ID AND
  ILP.STM_STOCK_ID = STO.STM_STOCK_ID AND
  ILP.STM_LOCATION_ID = LOC.STM_LOCATION_ID
GROUP BY
   IPT.IPT_PRINT_SESSION
  ,INV.STM_INVENTORY_TASK_ID
  ,INV.INV_DESCRIPTION
  ,ILI.STM_INVENTORY_LIST_ID
  ,ILI.ILI_DESCRIPTION
  ,STO.STM_STOCK_ID
  ,STO.STO_DESCRIPTION
  ,LOC.STM_LOCATION_ID
  ,LOC.LOC_DESCRIPTION




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_POS_ANNUAL_DIFFERENCES" ("GCO_GOOD_ID", "STM_STOCK_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SAE_CHARACTERIZATION_VALUE_1", "SAE_CHARACTERIZATION_VALUE_2", "SAE_CHARACTERIZATION_VALUE_3", "SAE_CHARACTERIZATION_VALUE_4", "SAE_CHARACTERIZATION_VALUE_5", "SPO_STOCK_QUANTITY", "SAE_STOCK_QUANTITY") AS
  select  B.GCO_GOOD_ID
        , B.STM_STOCK_ID
        , B.GCO_CHARACTERIZATION_ID
        , B.GCO_GCO_CHARACTERIZATION_ID
        , B.GCO2_GCO_CHARACTERIZATION_ID
        , B.GCO3_GCO_CHARACTERIZATION_ID
        , B.GCO4_GCO_CHARACTERIZATION_ID
        , B.SAE_CHARACTERIZATION_VALUE_1
        , B.SAE_CHARACTERIZATION_VALUE_2
        , B.SAE_CHARACTERIZATION_VALUE_3
        , B.SAE_CHARACTERIZATION_VALUE_4
        , B.SAE_CHARACTERIZATION_VALUE_5
        , A.SPO_STOCK_QUANTITY
        , B.SAE_STOCK_QUANTITY
    from (select   GCO_GOOD_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SPO_CHARACTERIZATION_VALUE_1
                 , SPO_CHARACTERIZATION_VALUE_2
                 , SPO_CHARACTERIZATION_VALUE_3
                 , SPO_CHARACTERIZATION_VALUE_4
                 , SPO_CHARACTERIZATION_VALUE_5
                 , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
              from STM_STOCK_POSITION SPO
          group by GCO_GOOD_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SPO_CHARACTERIZATION_VALUE_1
                 , SPO_CHARACTERIZATION_VALUE_2
                 , SPO_CHARACTERIZATION_VALUE_3
                 , SPO_CHARACTERIZATION_VALUE_4
                 , SPO_CHARACTERIZATION_VALUE_5) a
       , (select   GCO_GOOD_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SAE_CHARACTERIZATION_VALUE_1
                 , SAE_CHARACTERIZATION_VALUE_2
                 , SAE_CHARACTERIZATION_VALUE_3
                 , SAE_CHARACTERIZATION_VALUE_4
                 , SAE_CHARACTERIZATION_VALUE_5
                 , sum(SAE_START_QUANTITY) - sum(SAE_OUTPUT_QUANTITY) + sum(SAE_INPUT_QUANTITY) SAE_STOCK_QUANTITY
              from STM_ANNUAL_EVOLUTION SAE
             where SAE.SAE_YEAR = to_char(sysdate,'YYYY')
          group by GCO_GOOD_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SAE_CHARACTERIZATION_VALUE_1
                 , SAE_CHARACTERIZATION_VALUE_2
                 , SAE_CHARACTERIZATION_VALUE_3
                 , SAE_CHARACTERIZATION_VALUE_4
                 , SAE_CHARACTERIZATION_VALUE_5) b
   where a.GCO_GOOD_ID = b.GCO_GOOD_ID
     and a.STM_STOCK_ID = b.STM_STOCK_ID
     and nvl(a.GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO_GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO2_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO2_GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO3_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO3_GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO4_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO4_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SAE_CHARACTERIZATION_VALUE_1, 0) = nvl(SPO_CHARACTERIZATION_VALUE_1, 0)
     and nvl(SAE_CHARACTERIZATION_VALUE_2, 0) = nvl(SPO_CHARACTERIZATION_VALUE_2, 0)
     and nvl(SAE_CHARACTERIZATION_VALUE_3, 0) = nvl(SPO_CHARACTERIZATION_VALUE_3, 0)
     and nvl(SAE_CHARACTERIZATION_VALUE_4, 0) = nvl(SPO_CHARACTERIZATION_VALUE_4, 0)
     and nvl(SAE_CHARACTERIZATION_VALUE_5, 0) = nvl(SPO_CHARACTERIZATION_VALUE_5, 0)
     and a.SPO_STOCK_QUANTITY <> b.SAE_STOCK_QUANTITY




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_POS_EXERCISE_DIFFERENCES" ("GCO_GOOD_ID", "STM_STOCK_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPE_CHARACTERIZATION_VALUE_1", "SPE_CHARACTERIZATION_VALUE_2", "SPE_CHARACTERIZATION_VALUE_3", "SPE_CHARACTERIZATION_VALUE_4", "SPE_CHARACTERIZATION_VALUE_5", "SPO_STOCK_QUANTITY", "SPE_STOCK_QUANTITY") AS
  select  B.GCO_GOOD_ID
        , B.STM_STOCK_ID
        , B.GCO_CHARACTERIZATION_ID
        , B.GCO_GCO_CHARACTERIZATION_ID
        , B.GCO2_GCO_CHARACTERIZATION_ID
        , B.GCO3_GCO_CHARACTERIZATION_ID
        , B.GCO4_GCO_CHARACTERIZATION_ID
        , B.SPE_CHARACTERIZATION_VALUE_1
        , B.SPE_CHARACTERIZATION_VALUE_2
        , B.SPE_CHARACTERIZATION_VALUE_3
        , B.SPE_CHARACTERIZATION_VALUE_4
        , B.SPE_CHARACTERIZATION_VALUE_5
        , A.SPO_STOCK_QUANTITY
        , B.SPE_STOCK_QUANTITY
    from (select   GCO_GOOD_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SPO_CHARACTERIZATION_VALUE_1
                 , SPO_CHARACTERIZATION_VALUE_2
                 , SPO_CHARACTERIZATION_VALUE_3
                 , SPO_CHARACTERIZATION_VALUE_4
                 , SPO_CHARACTERIZATION_VALUE_5
                 , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
              from STM_STOCK_POSITION SPO
          group by GCO_GOOD_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SPO_CHARACTERIZATION_VALUE_1
                 , SPO_CHARACTERIZATION_VALUE_2
                 , SPO_CHARACTERIZATION_VALUE_3
                 , SPO_CHARACTERIZATION_VALUE_4
                 , SPO_CHARACTERIZATION_VALUE_5) a
       , (select   GCO_GOOD_ID
                 , SEV.STM_EXERCISE_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SPE_CHARACTERIZATION_VALUE_1
                 , SPE_CHARACTERIZATION_VALUE_2
                 , SPE_CHARACTERIZATION_VALUE_3
                 , SPE_CHARACTERIZATION_VALUE_4
                 , SPE_CHARACTERIZATION_VALUE_5
                 , sum(SPE_START_QUANTITY) - sum(SPE_OUTPUT_QUANTITY) + sum(SPE_INPUT_QUANTITY) SPE_STOCK_QUANTITY
              from STM_EXERCISE_EVOLUTION SEV
                 , STM_EXERCISE EXE
             where SEV.STM_EXERCISE_ID = EXE.STM_EXERCISE_ID
               and C_EXERCISE_STATUS = '02'
          group by GCO_GOOD_ID
                 , sev.STM_EXERCISE_ID
                 , STM_STOCK_ID
                 , GCO_CHARACTERIZATION_ID
                 , GCO_GCO_CHARACTERIZATION_ID
                 , GCO2_GCO_CHARACTERIZATION_ID
                 , GCO3_GCO_CHARACTERIZATION_ID
                 , GCO4_GCO_CHARACTERIZATION_ID
                 , SPE_CHARACTERIZATION_VALUE_1
                 , SPE_CHARACTERIZATION_VALUE_2
                 , SPE_CHARACTERIZATION_VALUE_3
                 , SPE_CHARACTERIZATION_VALUE_4
                 , SPE_CHARACTERIZATION_VALUE_5) b
   where a.GCO_GOOD_ID = b.GCO_GOOD_ID
     and a.STM_STOCK_ID = b.STM_STOCK_ID
     and nvl(a.GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO_GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO2_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO2_GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO3_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO3_GCO_CHARACTERIZATION_ID, 0)
     and nvl(a.GCO4_GCO_CHARACTERIZATION_ID, 0) = nvl(b.GCO4_GCO_CHARACTERIZATION_ID, 0)
     and nvl(SPE_CHARACTERIZATION_VALUE_1, 0) = nvl(SPo_CHARACTERIZATION_VALUE_1, 0)
     and nvl(SPE_CHARACTERIZATION_VALUE_2, 0) = nvl(SPo_CHARACTERIZATION_VALUE_2, 0)
     and nvl(SPE_CHARACTERIZATION_VALUE_3, 0) = nvl(SPo_CHARACTERIZATION_VALUE_3, 0)
     and nvl(SPE_CHARACTERIZATION_VALUE_4, 0) = nvl(SPo_CHARACTERIZATION_VALUE_4, 0)
     and nvl(SPE_CHARACTERIZATION_VALUE_5, 0) = nvl(SPo_CHARACTERIZATION_VALUE_5, 0)
     and a.SPO_STOCK_QUANTITY <> b.SPE_STOCK_QUANTITY




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_SITUATION_BY_PRODUCT" ("GCO_GOOD_ID", "DOC_POSITION_DETAIL_ID", "FAL_LOT_ID", "DELAY", "QUANTITY", "TYPE", "DMT_NUMBER", "PER_NAME", "LOT_REF", "ORD_REF", "JOP_REFERENCE") AS
  select DOC_POSITION.GCO_GOOD_ID
       , DOC_POSITION_DETAIL.DOC_POSITION_DETAIL_ID DOC_POSITION_DETAIL_ID
       , 0 FAL_LOT_ID
       , DOC_POSITION_DETAIL.PDE_FINAL_DELAY delay
       , DOC_POSITION_DETAIL.PDE_BALANCE_QUANTITY QUANTITY
       , DOC_GAUGE.C_GAUGE_TYPE type
       , DOC_DOCUMENT.DMT_NUMBER
       , PER_NAME
       , 0 LOT_REF
       , 0 ORD_REF
       , 0 JOP_REFERENCE
    from DOC_POSITION
       , DOC_DOCUMENT
       , DOC_POSITION_DETAIL
       , DOC_GAUGE
       , PAC_PERSON
   where DOC_POSITION."DOC_DOCUMENT_ID" = DOC_DOCUMENT."DOC_DOCUMENT_ID"(+)
     and DOC_POSITION."DOC_POSITION_ID" = DOC_POSITION_DETAIL."DOC_POSITION_ID"(+)
     and DOC_DOCUMENT."DOC_GAUGE_ID" = DOC_GAUGE."DOC_GAUGE_ID"(+)
     and DOC_DOCUMENT."PAC_THIRD_ID" = PAC_PERSON."PAC_PERSON_ID"(+)
     and DOC_POSITION_DETAIL."PDE_BALANCE_QUANTITY" <> 0.
     and (   DOC_GAUGE."C_GAUGE_TYPE" = '2'
          or DOC_GAUGE."C_GAUGE_TYPE" = '1')
  union all
  select FAL_LOT_MATERIAL_LINK.GCO_GOOD_ID
       , 0 DOC_POSITION_DETAIL_ID
       , FAL_LOT.FAL_LOT_ID FAL_LOT_ID
       , FAL_LOT_MATERIAL_LINK.LOM_NEED_DATE
       , FAL_LOT_MATERIAL_LINK.LOM_FULL_REQ_QTY
       , '3'
       , ''
       , ''
       , FAL_LOT.LOT_REF
       , FAL_ORDER.ORD_REF
       , FAL_JOB_PROGRAM.JOP_REFERENCE
    from FAL_LOT_MATERIAL_LINK
       , FAL_LOT
       , FAL_ORDER
       , FAL_JOB_PROGRAM
   where FAL_LOT_MATERIAL_LINK.FAL_LOT_ID = FAL_LOT.FAL_LOT_ID
     and FAL_LOT.FAL_ORDER_ID = FAL_ORDER.FAL_ORDER_ID
     and FAL_ORDER.FAL_JOB_PROGRAM_ID = FAL_JOB_PROGRAM.FAL_JOB_PROGRAM_ID
     and FAL_LOT.C_LOT_STATUS <> 5
  union all
  select FAL_ORDER.GCO_GOOD_ID
       , 0 DOC_POSITION_DETAIL_ID
       , FAL_LOT.FAL_LOT_ID FAL_LOT_ID
       , FAL_LOT.LOT_PLAN_END_DTE
       , FAL_LOT.LOT_TOTAL_QTY
       , '4'
       , ''
       , ''
       , FAL_LOT.LOT_REF
       , FAL_ORDER.ORD_REF
       , FAL_JOB_PROGRAM.JOP_REFERENCE
    from FAL_LOT
       , FAL_ORDER
       , FAL_JOB_PROGRAM
   where FAL_LOT.FAL_ORDER_ID = FAL_ORDER.FAL_ORDER_ID
     and FAL_ORDER.FAL_JOB_PROGRAM_ID = FAL_JOB_PROGRAM.FAL_JOB_PROGRAM_ID
     and FAL_LOT.C_LOT_STATUS <> 5


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STK_POS_TO_DELETE" ("UPDATEMODE", "GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPO_CHARACTERIZATION_VALUE_1", "SPO_CHARACTERIZATION_VALUE_2", "SPO_CHARACTERIZATION_VALUE_3", "SPO_CHARACTERIZATION_VALUE_4", "SPO_CHARACTERIZATION_VALUE_5", "SPO_SHOULD_STOCK_QUANTITY", "SPO_IS_STOCK_QUANTITY", "SPO_DELTA_QUANTITY") AS
  select 'D' updatemode
       , a.gco_good_id
       , a.stm_stock_id
       , a.stm_location_id
       , a.gco_characterization_id
       , a.gco_gco_characterization_id
       , a.gco2_gco_characterization_id
       , a.gco3_gco_characterization_id
       , a.gco4_gco_characterization_id
       , a.spo_characterization_value_1
       , a.spo_characterization_value_2
       , a.spo_characterization_value_3
       , a.spo_characterization_value_4
       , a.spo_characterization_value_5
       , 0 spo_should_stock_quantity
       , b.spo_stock_quantity spo_is_stock_quantity
       , -b.spo_stock_quantity spo_delta_quantity
    from (select gco_good_id
               , stm_stock_id
               , stm_location_id
               , gco_characterization_id
               , gco_gco_characterization_id
               , gco2_gco_characterization_id
               , gco3_gco_characterization_id
               , gco4_gco_characterization_id
               , spo_characterization_value_1
               , spo_characterization_value_2
               , spo_characterization_value_3
               , spo_characterization_value_4
               , spo_characterization_value_5
            from stm_stock_position
           where spo_stock_quantity <> 0
          minus
          select gco_good_id
               , stm_stock_id
               , stm_location_id
               , gco_characterization_id
               , gco_gco_characterization_id
               , gco2_gco_characterization_id
               , gco3_gco_characterization_id
               , gco4_gco_characterization_id
               , spo_characterization_value_1
               , spo_characterization_value_2
               , spo_characterization_value_3
               , spo_characterization_value_4
               , spo_characterization_value_5
            from v_stm_stock_pos_all_mvt) a
       , stm_stock_position b
   where a.gco_good_id = b.gco_good_id
     and a.stm_stock_id = b.stm_stock_id
     and nvl(a.stm_location_id, 0) = nvl(b.stm_location_id, 0)
     and nvl(a.gco_characterization_id, 0) = nvl(b.gco_characterization_id, 0)
     and nvl(a.gco_gco_characterization_id, 0) = nvl(b.gco_gco_characterization_id, 0)
     and nvl(a.gco2_gco_characterization_id, 0) = nvl(b.gco2_gco_characterization_id, 0)
     and nvl(a.gco3_gco_characterization_id, 0) = nvl(b.gco3_gco_characterization_id, 0)
     and nvl(a.gco4_gco_characterization_id, 0) = nvl(b.gco4_gco_characterization_id, 0)
     and nvl(a.spo_characterization_value_1, 'null') = nvl(b.spo_characterization_value_1, 'null')
     and nvl(a.spo_characterization_value_2, 'null') = nvl(b.spo_characterization_value_2, 'null')
     and nvl(a.spo_characterization_value_3, 'null') = nvl(b.spo_characterization_value_3, 'null')
     and nvl(a.spo_characterization_value_4, 'null') = nvl(b.spo_characterization_value_4, 'null')
     and nvl(a.spo_characterization_value_5, 'null') = nvl(b.spo_characterization_value_5, 'null')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STK_POS_TO_INSERT" ("UPDATEMODE", "GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPO_CHARACTERIZATION_VALUE_1", "SPO_CHARACTERIZATION_VALUE_2", "SPO_CHARACTERIZATION_VALUE_3", "SPO_CHARACTERIZATION_VALUE_4", "SPO_CHARACTERIZATION_VALUE_5", "SPO_SHOULD_STOCK_QUANTITY", "SPO_IS_STOCK_QUANTITY", "SPO_DELTA_QUANTITY") AS
  select 'I' updatemode
       , a.gco_good_id
       , a.stm_stock_id
       , a.stm_location_id
       , a.gco_characterization_id
       , a.gco_gco_characterization_id
       , a.gco2_gco_characterization_id
       , a.gco3_gco_characterization_id
       , a.gco4_gco_characterization_id
       , a.spo_characterization_value_1
       , a.spo_characterization_value_2
       , a.spo_characterization_value_3
       , a.spo_characterization_value_4
       , a.spo_characterization_value_5
       , b.spo_stock_quantity spo_should_stock_quantity
       , 0 spo_is_stock_quantity
       , b.spo_stock_quantity spo_delta_quantity
    from (select gco_good_id
               , stm_stock_id
               , stm_location_id
               , gco_characterization_id
               , gco_gco_characterization_id
               , gco2_gco_characterization_id
               , gco3_gco_characterization_id
               , gco4_gco_characterization_id
               , spo_characterization_value_1
               , spo_characterization_value_2
               , spo_characterization_value_3
               , spo_characterization_value_4
               , spo_characterization_value_5
            from v_stm_stock_pos_all_mvt
          minus
          select gco_good_id
               , stm_stock_id
               , stm_location_id
               , gco_characterization_id
               , gco_gco_characterization_id
               , gco2_gco_characterization_id
               , gco3_gco_characterization_id
               , gco4_gco_characterization_id
               , spo_characterization_value_1
               , spo_characterization_value_2
               , spo_characterization_value_3
               , spo_characterization_value_4
               , spo_characterization_value_5
            from stm_stock_position
           where spo_stock_quantity <> 0) a
       , v_stm_stock_pos_all_mvt b
   where a.gco_good_id = b.gco_good_id
     and a.stm_stock_id = b.stm_stock_id
     and nvl(a.stm_location_id, 0) = nvl(b.stm_location_id, 0)
     and nvl(a.gco_characterization_id, 0) = nvl(b.gco_characterization_id, 0)
     and nvl(a.gco_gco_characterization_id, 0) = nvl(b.gco_gco_characterization_id, 0)
     and nvl(a.gco2_gco_characterization_id, 0) = nvl(b.gco2_gco_characterization_id, 0)
     and nvl(a.gco3_gco_characterization_id, 0) = nvl(b.gco3_gco_characterization_id, 0)
     and nvl(a.gco4_gco_characterization_id, 0) = nvl(b.gco4_gco_characterization_id, 0)
     and nvl(a.spo_characterization_value_1, 'null') = nvl(b.spo_characterization_value_1, 'null')
     and nvl(a.spo_characterization_value_2, 'null') = nvl(b.spo_characterization_value_2, 'null')
     and nvl(a.spo_characterization_value_3, 'null') = nvl(b.spo_characterization_value_3, 'null')
     and nvl(a.spo_characterization_value_4, 'null') = nvl(b.spo_characterization_value_4, 'null')
     and nvl(a.spo_characterization_value_5, 'null') = nvl(b.spo_characterization_value_5, 'null')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STK_POS_TO_UPDATE" ("UPDATEMODE", "GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPO_CHARACTERIZATION_VALUE_1", "SPO_CHARACTERIZATION_VALUE_2", "SPO_CHARACTERIZATION_VALUE_3", "SPO_CHARACTERIZATION_VALUE_4", "SPO_CHARACTERIZATION_VALUE_5", "SPO_SHOULD_STOCK_QUANTITY", "SPO_IS_STOCK_QUANTITY", "SPO_DELTA_QUANTITY") AS
  select 'U' updatemode
       , a.gco_good_id
       , a.stm_stock_id
       , a.stm_location_id
       , a.gco_characterization_id
       , a.gco_gco_characterization_id
       , a.gco2_gco_characterization_id
       , a.gco3_gco_characterization_id
       , a.gco4_gco_characterization_id
       , a.spo_characterization_value_1
       , a.spo_characterization_value_2
       , a.spo_characterization_value_3
       , a.spo_characterization_value_4
       , a.spo_characterization_value_5
       , a.spo_stock_quantity spo_should_stock_quantity
       , b.spo_stock_quantity spo_is_stock_quantity
       , a.spo_stock_quantity - b.spo_stock_quantity spo_delta_quantity
    from v_stm_stock_pos_all_mvt a
       , stm_stock_position b
   where a.spo_stock_quantity <> b.spo_stock_quantity
     and a.gco_good_id = b.gco_good_id
     and a.stm_stock_id = b.stm_stock_id
     and nvl(a.stm_location_id, 0) = nvl(b.stm_location_id, 0)
     and nvl(a.gco_characterization_id, 0) = nvl(b.gco_characterization_id, 0)
     and nvl(a.gco_gco_characterization_id, 0) = nvl(b.gco_gco_characterization_id, 0)
     and nvl(a.gco2_gco_characterization_id, 0) = nvl(b.gco2_gco_characterization_id, 0)
     and nvl(a.gco3_gco_characterization_id, 0) = nvl(b.gco3_gco_characterization_id, 0)
     and nvl(a.gco4_gco_characterization_id, 0) = nvl(b.gco4_gco_characterization_id, 0)
     and nvl(a.spo_characterization_value_1, 'null') = nvl(b.spo_characterization_value_1, 'null')
     and nvl(a.spo_characterization_value_2, 'null') = nvl(b.spo_characterization_value_2, 'null')
     and nvl(a.spo_characterization_value_3, 'null') = nvl(b.spo_characterization_value_3, 'null')
     and nvl(a.spo_characterization_value_4, 'null') = nvl(b.spo_characterization_value_4, 'null')
     and nvl(a.spo_characterization_value_5, 'null') = nvl(b.spo_characterization_value_5, 'null')




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STOCK_BY_CHAR" ("GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "SPO_CHARACTERIZATION_VALUE", "SPO_PIECE", "SPO_SET", "SPO_VERSION", "SPO_CHRONOLOGICAL", "SPO_STD_CHAR_1", "SPO_STD_CHAR_2", "SPO_STD_CHAR_3", "SPO_STD_CHAR_4", "SPO_STD_CHAR_5", "SPO_STOCK_QUANTITY", "SPO_ASSIGN_QUANTITY", "SPO_AVAILABLE_QUANTITY", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT", "SPO_THEORETICAL_QUANTITY", "SPO_ALTERNATIV_QUANTITY_1", "SPO_ALTERNATIV_QUANTITY_2", "SPO_ALTERNATIV_QUANTITY_3") AS
  select   GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_1 SPO_CHARACTERIZATION_VALUE
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
         , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION
     where GCO_CHARACTERIZATION_ID is not null
       and not(    SPO_STOCK_QUANTITY = 0
               and SPO_ASSIGN_QUANTITY = 0
               and SPO_PROVISORY_OUTPUT = 0
               and SPO_PROVISORY_INPUT = 0
               and SPO_AVAILABLE_QUANTITY = 0
               and SPO_ALTERNATIV_QUANTITY_1 = 0
               and SPO_ALTERNATIV_QUANTITY_2 = 0
               and SPO_ALTERNATIV_QUANTITY_3 = 0
              )
  group by GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_1
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
  union
  select   GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_2 SPO_CHARACTERIZATION_VALUE
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
         , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION
     where GCO_GCO_CHARACTERIZATION_ID is not null
       and not(    SPO_STOCK_QUANTITY = 0
               and SPO_ASSIGN_QUANTITY = 0
               and SPO_PROVISORY_OUTPUT = 0
               and SPO_PROVISORY_INPUT = 0
               and SPO_AVAILABLE_QUANTITY = 0
               and SPO_ALTERNATIV_QUANTITY_1 = 0
               and SPO_ALTERNATIV_QUANTITY_2 = 0
               and SPO_ALTERNATIV_QUANTITY_3 = 0
              )
  group by GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO_GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_2
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
  union
  select   GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO2_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_3 SPO_CHARACTERIZATION_VALUE
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
         , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION
     where GCO2_GCO_CHARACTERIZATION_ID is not null
       and not(    SPO_STOCK_QUANTITY = 0
               and SPO_ASSIGN_QUANTITY = 0
               and SPO_PROVISORY_OUTPUT = 0
               and SPO_PROVISORY_INPUT = 0
               and SPO_AVAILABLE_QUANTITY = 0
               and SPO_ALTERNATIV_QUANTITY_1 = 0
               and SPO_ALTERNATIV_QUANTITY_2 = 0
               and SPO_ALTERNATIV_QUANTITY_3 = 0
              )
  group by GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO2_GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_3
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
  union
  select   GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO3_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_4 SPO_CHARACTERIZATION_VALUE
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
         , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION
     where GCO3_GCO_CHARACTERIZATION_ID is not null
       and not(    SPO_STOCK_QUANTITY = 0
               and SPO_ASSIGN_QUANTITY = 0
               and SPO_PROVISORY_OUTPUT = 0
               and SPO_PROVISORY_INPUT = 0
               and SPO_AVAILABLE_QUANTITY = 0
               and SPO_ALTERNATIV_QUANTITY_1 = 0
               and SPO_ALTERNATIV_QUANTITY_2 = 0
               and SPO_ALTERNATIV_QUANTITY_3 = 0
              )
  group by GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO3_GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_4
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
  union
  select   GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO4_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_5 SPO_CHARACTERIZATION_VALUE
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5
         , sum(SPO_STOCK_QUANTITY) SPO_STOCK_QUANTITY
         , sum(SPO_ASSIGN_QUANTITY) SPO_ASSIGN_QUANTITY
         , sum(SPO_AVAILABLE_QUANTITY) SPO_AVAILABLE_QUANTITY
         , sum(SPO_PROVISORY_INPUT) SPO_PROVISORY_INPUT
         , sum(SPO_PROVISORY_OUTPUT) SPO_PROVISORY_OUTPUT
         , sum(SPO_THEORETICAL_QUANTITY) SPO_THEORETICAL_QUANTITY
         , sum(SPO_ALTERNATIV_QUANTITY_1) SPO_ALTERNATIV_QUANTITY_1
         , sum(SPO_ALTERNATIV_QUANTITY_2) SPO_ALTERNATIV_QUANTITY_2
         , sum(SPO_ALTERNATIV_QUANTITY_3) SPO_ALTERNATIV_QUANTITY_3
      from STM_STOCK_POSITION
     where GCO3_GCO_CHARACTERIZATION_ID is not null
       and not(    SPO_STOCK_QUANTITY = 0
               and SPO_ASSIGN_QUANTITY = 0
               and SPO_PROVISORY_OUTPUT = 0
               and SPO_PROVISORY_INPUT = 0
               and SPO_AVAILABLE_QUANTITY = 0
               and SPO_ALTERNATIV_QUANTITY_1 = 0
               and SPO_ALTERNATIV_QUANTITY_2 = 0
               and SPO_ALTERNATIV_QUANTITY_3 = 0
              )
  group by GCO_GOOD_ID
         , STM_STOCK_ID
         , STM_LOCATION_ID
         , GCO4_GCO_CHARACTERIZATION_ID
         , SPO_CHARACTERIZATION_VALUE_5
         , SPO_PIECE
         , SPO_SET
         , SPO_VERSION
         , SPO_CHRONOLOGICAL
         , SPO_STD_CHAR_1
         , SPO_STD_CHAR_2
         , SPO_STD_CHAR_3
         , SPO_STD_CHAR_4
         , SPO_STD_CHAR_5


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STOCK_LOCATION" ("STM_STOCK_ID", "STO_DESCRIPTION", "STO_FREE_DESCRIPTION", "STO_CLASSIFICATION", "C_ACCESS_METHOD", "STO_SUBCONTRACT", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "A_CONFIRM", "STM_LOCATION_ID", "LOC_DESCRIPTION", "LOC_FREE_DESCRIPTION", "LOC_CLASSIFICATION", "LOC_LOCATION_MANAGEMENT", "LOC_FULL_LOCATION") AS
  select STM_STOCK.STM_STOCK_ID
       , STM_STOCK.STO_DESCRIPTION
       , STM_STOCK.STO_FREE_DESCRIPTION
       , STM_STOCK.STO_CLASSIFICATION
       , STM_STOCK.C_ACCESS_METHOD
       , STM_STOCK.STO_SUBCONTRACT
       , STM_STOCK.A_DATECRE
       , STM_STOCK.A_DATEMOD
       , STM_STOCK.A_IDCRE
       , STM_STOCK.A_IDMOD
       , STM_STOCK.A_RECLEVEL
       , STM_STOCK.A_RECSTATUS
       , STM_STOCK.A_CONFIRM
       , STM_LOCATION.STM_LOCATION_ID
       , STM_LOCATION.LOC_DESCRIPTION
       , STM_LOCATION.LOC_FREE_DESCRIPTION
       , STM_LOCATION.LOC_CLASSIFICATION
       , STM_LOCATION.LOC_LOCATION_MANAGEMENT
       , STM_LOCATION.LOC_FULL_LOCATION
    from STM_STOCK
       , STM_LOCATION
   where STM_STOCK.STM_STOCK_ID = STM_LOCATION.STM_STOCK_ID
         with check option


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STOCK_POS_ALL_MVT" ("GCO_GOOD_ID", "STM_STOCK_ID", "STM_LOCATION_ID", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPO_CHARACTERIZATION_VALUE_1", "SPO_CHARACTERIZATION_VALUE_2", "SPO_CHARACTERIZATION_VALUE_3", "SPO_CHARACTERIZATION_VALUE_4", "SPO_CHARACTERIZATION_VALUE_5", "SPO_STOCK_QUANTITY") AS
  select   SMO.gco_good_id
         , SMO.stm_stock_id
         , SMO.stm_location_id
         , SMO.GCO_CHARACTERIZATION_ID
         , SMO.GCO_GCO_CHARACTERIZATION_ID
         , SMO.GCO2_GCO_CHARACTERIZATION_ID
         , SMO.GCO3_GCO_CHARACTERIZATION_ID
         , SMO.GCO4_GCO_CHARACTERIZATION_ID
         , SMO.SMO_CHARACTERIZATION_VALUE_1 SPO_CHARACTERIZATION_VALUE_1
         , SMO.SMO_CHARACTERIZATION_VALUE_2 SPO_CHARACTERIZATION_VALUE_2
         , SMO.SMO_CHARACTERIZATION_VALUE_3 SPO_CHARACTERIZATION_VALUE_3
         , SMO.SMO_CHARACTERIZATION_VALUE_4 SPO_CHARACTERIZATION_VALUE_4
         , SMO.SMO_CHARACTERIZATION_VALUE_5 SPO_CHARACTERIZATION_VALUE_5
         , SUM(decode(MOK.C_MOVEMENT_SORT,'ENT',1,'SOR',-1)*SMO_MOVEMENT_QUANTITY) SPO_STOCK_QUANTITY
  from STM_STOCK_MOVEMENT SMO, STM_MOVEMENT_KIND MOK, GCO_PRODUCT PDT
   where SMO.STM_MOVEMENT_KIND_ID = MOK.STM_MOVEMENT_KIND_ID
     and PDT.GCO_GOOD_ID = SMO.GCO_GOOD_ID
     and PDT.PDT_STOCK_MANAGEMENT = 1
     and MOK.C_MOVEMENT_TYPE <> 'EXE'
group by   SMO.gco_good_id
         , SMO.stm_stock_id
         , SMO.stm_location_id
         , SMO.GCO_CHARACTERIZATION_ID
         , SMO.GCO_GCO_CHARACTERIZATION_ID
         , SMO.GCO2_GCO_CHARACTERIZATION_ID
         , SMO.GCO3_GCO_CHARACTERIZATION_ID
         , SMO.GCO4_GCO_CHARACTERIZATION_ID
         , SMO.SMO_CHARACTERIZATION_VALUE_1
         , SMO.SMO_CHARACTERIZATION_VALUE_2
         , SMO.SMO_CHARACTERIZATION_VALUE_3
         , SMO.SMO_CHARACTERIZATION_VALUE_4
         , SMO.SMO_CHARACTERIZATION_VALUE_5
having SUM(decode(MOK.C_MOVEMENT_SORT,'ENT',1,'SOR',-1)*SMO_MOVEMENT_QUANTITY) <> 0




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STOCK_PROV_QTY" ("GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPR_PROVISORY_INPUT", "SPR_PROVISORY_OUTPUT") AS
  select   gco_good_id
         , stm_location_id
         , PDE_CHARACTERIZATION_VALUE_1
         , PDE_CHARACTERIZATION_VALUE_2
         , PDE_CHARACTERIZATION_VALUE_3
         , PDE_CHARACTERIZATION_VALUE_4
         , PDE_CHARACTERIZATION_VALUE_5
         , GCO_CHARACTERIZATION_ID
         , GCO_GCO_CHARACTERIZATION_ID
         , GCO2_GCO_CHARACTERIZATION_ID
         , GCO3_GCO_CHARACTERIZATION_ID
         , GCO4_GCO_CHARACTERIZATION_ID
         , sum(SPO_PROVISORY_INPUT) SPR_PROVISORY_INPUT
         , sum(SPO_PROVISORY_OUTPUT) SPR_PROVISORY_OUTPUT
      from (select pos.gco_good_id
                 , pde.stm_location_id
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_1
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_2
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_3
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_4
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 5
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_5
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 1) GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 2) GCO_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 3) GCO2_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 4) GCO3_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 5) GCO4_GCO_CHARACTERIZATION_ID
                 , decode(C_MOVEMENT_SORT, 'ENT', 1, 0) * pde_movement_quantity SPO_PROVISORY_INPUT
                 , decode(C_MOVEMENT_SORT, 'SOR', 1, 0) * pde_movement_quantity SPO_PROVISORY_OUTPUT
              from doc_position_detail pde
                 , doc_position pos
                 , stm_movement_kind mok
             where pde.doc_position_id = pos.doc_position_id
               and pos.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
               and pos_generate_movement = 0
               and decode(PDE.STM_STM_LOCATION_ID, null, 1, PDE.STM_LOCATION_ID, 0, 1) = 1
            union all
            select pos.gco_good_id
                 , pde.stm_stm_location_id
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_1
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_2
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_3
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_4
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 5
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_5
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 1) GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 2) GCO_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 3) GCO2_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 4) GCO3_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 5) GCO4_GCO_CHARACTERIZATION_ID
                 , decode(mok2.C_MOVEMENT_SORT, 'ENT', 1, 0) * pde_movement_quantity SPO_PROVISORY_INPUT
                 , decode(mok2.C_MOVEMENT_SORT, 'SOR', 1, 0) * pde_movement_quantity SPO_PROVISORY_OUTPUT
              from doc_position_detail pde
                 , doc_position pos
                 , stm_movement_kind mok
                 , stm_movement_kind mok2
             where pde.doc_position_id = pos.doc_position_id
               and pos.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
               and mok2.stm_movement_kind_id = mok.stm_stm_movement_kind_id
               and nvl(mok.stm_stm_movement_kind_id, 0) <> 0
               and pos_generate_movement = 0
               and decode(PDE.STM_STM_LOCATION_ID, null, 1, PDE.STM_LOCATION_ID, 0, 1) = 1
            union all
            select pos.gco_good_id
                 , parent.stm_location_id
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_1
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_2
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_3
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_4
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 5
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_5
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 1) GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 2) GCO_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 3) GCO2_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 4) GCO3_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 5) GCO4_GCO_CHARACTERIZATION_ID
                 , decode(mok.C_MOVEMENT_SORT, 'ENT', -1 *(pde.pde_movement_quantity +(pos.pos_convert_factor * nvl(pde.pde_balance_quantity_parent, 0) ) ), 0)
                                                                                                                                            SPO_PROVISORY_INPUT
                 , decode(mok.C_MOVEMENT_SORT, 'SOR', -1 *(pde.pde_movement_quantity +(pos.pos_convert_factor * nvl(pde.pde_balance_quantity_parent, 0) ) ), 0)
                                                                                                                                           SPO_PROVISORY_OUTPUT
              from doc_position_detail pde
                 , doc_position pos
                 , doc_position pos_parent
                 , stm_movement_kind mok
                 , doc_gauge_receipt gar
                 , doc_position_detail parent
             where pde.doc_position_id = pos.doc_position_id
               and pos.pos_generate_movement = 0
               and gar.doc_gauge_receipt_id = pde.doc_gauge_receipt_id
               and parent.doc_position_detail_id = pde.doc_doc_position_detail_id
               and gar.gar_extourne_mvt = 1
               and pos_parent.pos_generate_movement = 1
               and pos_parent.doc_position_id = parent.doc_position_id
               and pos_parent.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
               and decode(PDE.STM_STM_LOCATION_ID, null, 1, PDE.STM_LOCATION_ID, 0, 1) = 1
            union all
            select pos.gco_good_id
                 , parent.stm_stm_location_id
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_1
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_2
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_3
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_4
                 , gco_functions.getStkCharPosValue(pos.gco_good_id
                                                  , 5
                                                  , pde.PDE_CHARACTERIZATION_VALUE_1
                                                  , pde.PDE_CHARACTERIZATION_VALUE_2
                                                  , pde.PDE_CHARACTERIZATION_VALUE_3
                                                  , pde.PDE_CHARACTERIZATION_VALUE_4
                                                  , pde.PDE_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_5
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 1) GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 2) GCO_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 3) GCO2_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 4) GCO3_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(pos.gco_good_id, 5) GCO4_GCO_CHARACTERIZATION_ID
                 , decode(mok2.C_MOVEMENT_SORT, 'ENT', -1 *(pde.pde_movement_quantity +(pos.pos_convert_factor * nvl(pde.pde_balance_quantity_parent, 0) ) ), 0)
                                                                                                                                            SPO_PROVISORY_INPUT
                 , decode(mok2.C_MOVEMENT_SORT, 'SOR', -1 *(pde.pde_movement_quantity +(pos.pos_convert_factor * nvl(pde.pde_balance_quantity_parent, 0) ) ), 0)
                                                                                                                                           SPO_PROVISORY_OUTPUT
              from doc_position_detail pde
                 , doc_position pos
                 , stm_movement_kind mok
                 , stm_movement_kind mok2
                 , doc_gauge_receipt gar
                 , doc_position_detail parent
                 , doc_position pos_parent
             where pde.doc_position_id = pos.doc_position_id
               and pos.pos_generate_movement = 0
               and gar.doc_gauge_receipt_id = pde.doc_gauge_receipt_id
               and parent.doc_position_detail_id = pde.doc_doc_position_detail_id
               and gar.gar_extourne_mvt = 1
               and pos_parent.pos_generate_movement = 1
               and pos_parent.doc_position_id = parent.doc_position_id
               and pos_parent.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
               and mok2.stm_movement_kind_id = mok.stm_stm_movement_kind_id
               and decode(PDE.STM_STM_LOCATION_ID, null, 1, PDE.STM_LOCATION_ID, 0, 1) = 1
            union all
            select sti.gco_good_id
                 , sti.STM_LOCATION_SRC_ID stm_location_id
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_1
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_2
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_3
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_4
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 5
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_5
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 1) GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 2) GCO_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 3) GCO2_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 4) GCO3_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 5) GCO4_GCO_CHARACTERIZATION_ID
                 , decode(C_MOVEMENT_SORT, 'ENT', 1, 0) * SIS_QUANTITY_TRANSFER SPO_PROVISORY_INPUT
                 , decode(C_MOVEMENT_SORT, 'SOR', 1, 0) * SIS_QUANTITY_TRANSFER SPO_PROVISORY_OUTPUT
              from STM_INTERC_STOCK_TRSF STI
                 , doc_gauge_position GAP
                 , stm_movement_kind mok
             where GAP.DOC_GAUGE_ID = STI.DOC_GAUGE_SRC_ID
               and GAP.STM_MOVEMENT_KIND_ID = MOK.STM_MOVEMENT_KIND_ID
               and GAP.C_GAUGE_TYPE_POS = '1'
               and GAP.GAP_DEFAULT = 1
               and C_TRANSFER_STATUS in('01', '02')
            union all
            select sti.gco_good_id
                 , sti.STM_LOCATION_DST_ID stm_location_id
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_1
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_2
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_3
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_4
                 , gco_functions.getStkCharPosValue(sti.gco_good_id
                                                  , 5
                                                  , sti.SIS_CHARACTERIZATION_VALUE_1
                                                  , sti.SIS_CHARACTERIZATION_VALUE_2
                                                  , sti.SIS_CHARACTERIZATION_VALUE_3
                                                  , sti.SIS_CHARACTERIZATION_VALUE_4
                                                  , sti.SIS_CHARACTERIZATION_VALUE_5
                                                   ) PDE_CHARACTERIZATION_VALUE_5
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 1) GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 2) GCO_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 3) GCO2_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 4) GCO3_GCO_CHARACTERIZATION_ID
                 , gco_functions.getStkCharPosId(sti.gco_good_id, 5) GCO4_GCO_CHARACTERIZATION_ID
                 , decode(MOK2.C_MOVEMENT_SORT, 'ENT', 1, 0) * SIS_QUANTITY_TRANSFER SPO_PROVISORY_INPUT
                 , decode(MOK2.C_MOVEMENT_SORT, 'SOR', 1, 0) * SIS_QUANTITY_TRANSFER SPO_PROVISORY_OUTPUT
              from STM_INTERC_STOCK_TRSF STI
                 , doc_gauge_position GAP
                 , stm_movement_kind mok
                 , stm_movement_kind mok2
             where GAP.DOC_GAUGE_ID = STI.DOC_GAUGE_DST_ID
               and STI.PC_COMP_SRC_ID = STI.PC_COMP_DST_ID
               and GAP.STM_MOVEMENT_KIND_ID = MOK.STM_MOVEMENT_KIND_ID
               and MOK2.STM_MOVEMENT_KIND_ID = MOK.STM_STM_MOVEMENT_KIND_ID
               and GAP.C_GAUGE_TYPE_POS = '1'
               and GAP.GAP_DEFAULT = 1
               and C_TRANSFER_STATUS in('01', '02') )
  group by gco_good_id
         , stm_location_id
         , PDE_CHARACTERIZATION_VALUE_1
         , PDE_CHARACTERIZATION_VALUE_2
         , PDE_CHARACTERIZATION_VALUE_3
         , PDE_CHARACTERIZATION_VALUE_4
         , PDE_CHARACTERIZATION_VALUE_5
         , GCO_CHARACTERIZATION_ID
         , GCO_GCO_CHARACTERIZATION_ID
         , GCO2_GCO_CHARACTERIZATION_ID
         , GCO3_GCO_CHARACTERIZATION_ID
         , GCO4_GCO_CHARACTERIZATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STM_STOCK_PROV_QTY_DET" ("PROV", "GCO_GOOD_ID", "STM_LOCATION_ID", "PDE_CHARACTERIZATION_VALUE_1", "PDE_CHARACTERIZATION_VALUE_2", "PDE_CHARACTERIZATION_VALUE_3", "PDE_CHARACTERIZATION_VALUE_4", "PDE_CHARACTERIZATION_VALUE_5", "GCO_CHARACTERIZATION_ID", "GCO_GCO_CHARACTERIZATION_ID", "GCO2_GCO_CHARACTERIZATION_ID", "GCO3_GCO_CHARACTERIZATION_ID", "GCO4_GCO_CHARACTERIZATION_ID", "SPR_PROVISORY_INPUT", "SPR_PROVISORY_OUTPUT") AS
  select prov,
       gco_good_id,
       stm_location_id,
       PDE_CHARACTERIZATION_VALUE_1,
       PDE_CHARACTERIZATION_VALUE_2,
       PDE_CHARACTERIZATION_VALUE_3,
       PDE_CHARACTERIZATION_VALUE_4,
       PDE_CHARACTERIZATION_VALUE_5,
       GCO_CHARACTERIZATION_ID,
       GCO_GCO_CHARACTERIZATION_ID,
       GCO2_GCO_CHARACTERIZATION_ID,
       GCO3_GCO_CHARACTERIZATION_ID,
       GCO4_GCO_CHARACTERIZATION_ID,
       sum(SPO_PROVISORY_INPUT) SPR_PROVISORY_INPUT,
           sum(SPO_PROVISORY_OUTPUT) SPR_PROVISORY_OUTPUT
from
(
select 1 prov,
       pos.gco_good_id,
       pde.stm_location_id,
         pde.PDE_CHARACTERIZATION_VALUE_1,
         pde.PDE_CHARACTERIZATION_VALUE_2,
         pde.PDE_CHARACTERIZATION_VALUE_3,
         pde.PDE_CHARACTERIZATION_VALUE_4,
         pde.PDE_CHARACTERIZATION_VALUE_5,
         pde.GCO_CHARACTERIZATION_ID,
         pde.GCO_GCO_CHARACTERIZATION_ID,
         pde.GCO2_GCO_CHARACTERIZATION_ID,
         pde.GCO3_GCO_CHARACTERIZATION_ID,
         pde.GCO4_GCO_CHARACTERIZATION_ID,
       decode(C_MOVEMENT_SORT,'ENT',1,0)*pde_movement_quantity SPO_PROVISORY_INPUT,
	   decode(C_MOVEMENT_SORT,'SOR',1,0)*pde_movement_quantity SPO_PROVISORY_OUTPUT
from doc_position_detail pde, doc_position pos, stm_movement_kind mok
where pde.doc_position_id = pos.doc_position_id
  and pos.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
  and (pde.stm_location_id <> nvl(pde.stm_stm_location_id,0) or pos.C_GAUGE_TYPE_POS in ('7','8'))
--  and nvl(mok.stm_stm_movement_kind_id,0) = 0
  and pos_generate_movement = 0
union all
select 2 prov,
       pos.gco_good_id,
       pde.stm_stm_location_id,
         pde.PDE_CHARACTERIZATION_VALUE_1,
         pde.PDE_CHARACTERIZATION_VALUE_2,
         pde.PDE_CHARACTERIZATION_VALUE_3,
         pde.PDE_CHARACTERIZATION_VALUE_4,
         pde.PDE_CHARACTERIZATION_VALUE_5,
         pde.GCO_CHARACTERIZATION_ID,
         pde.GCO_GCO_CHARACTERIZATION_ID,
         pde.GCO2_GCO_CHARACTERIZATION_ID,
         pde.GCO3_GCO_CHARACTERIZATION_ID,
         pde.GCO4_GCO_CHARACTERIZATION_ID,
       decode(mok2.C_MOVEMENT_SORT,'ENT',1,0)*pde_movement_quantity SPO_PROVISORY_INPUT,
	   decode(mok2.C_MOVEMENT_SORT,'SOR',1,0)*pde_movement_quantity SPO_PROVISORY_OUTPUT
from doc_position_detail pde, doc_position pos, stm_movement_kind mok, stm_movement_kind mok2
where pde.doc_position_id = pos.doc_position_id
  and pos.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
  and mok2.stm_movement_kind_id = mok.stm_stm_movement_kind_id
  and (pde.stm_location_id <> nvl(pde.stm_stm_location_id,0) or pos.C_GAUGE_TYPE_POS in ('7','8'))
and nvl(mok.stm_stm_movement_kind_id,0) <> 0
  and pos_generate_movement = 0
union all
select   3 prov,
         pos.gco_good_id,
         parent.stm_location_id,
         pde.PDE_CHARACTERIZATION_VALUE_1,
         pde.PDE_CHARACTERIZATION_VALUE_2,
         pde.PDE_CHARACTERIZATION_VALUE_3,
         pde.PDE_CHARACTERIZATION_VALUE_4,
         pde.PDE_CHARACTERIZATION_VALUE_5,
         pde.GCO_CHARACTERIZATION_ID,
         pde.GCO_GCO_CHARACTERIZATION_ID,
         pde.GCO2_GCO_CHARACTERIZATION_ID,
         pde.GCO3_GCO_CHARACTERIZATION_ID,
         pde.GCO4_GCO_CHARACTERIZATION_ID,
       -1*decode(mok.C_MOVEMENT_SORT,
                  'ENT', (pde.pde_movement_quantity+(pos.pos_convert_factor*nvl(pde.pde_balance_quantity_parent, 0))),
                         0) SPO_PROVISORY_INPUT,
       -1*decode(mok.C_MOVEMENT_SORT,
                  'SOR', (pde.pde_movement_quantity+(pos.pos_convert_factor*nvl(pde.pde_balance_quantity_parent, 0))),
                         0) SPO_PROVISORY_OUTPUT
from doc_position_detail pde, doc_position pos, doc_position pos_parent , stm_movement_kind mok,
     doc_gauge_receipt gar, doc_position_detail parent
where pde.doc_position_id = pos.doc_position_id
  and pos.pos_generate_movement = 0
  and gar.doc_gauge_receipt_id = pde.doc_gauge_receipt_id
  and parent.doc_position_detail_id = pde.doc_doc_position_detail_id
  and gar.gar_extourne_mvt = 1
  and parent.pde_generate_movement = 1
  and pos_parent.doc_position_id = parent.doc_position_id
  and pos_parent.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
  and (parent.stm_location_id <> nvl(parent.stm_stm_location_id,0) or pos.C_GAUGE_TYPE_POS in ('7','8'))
union all
select   4 prov,
         pos.gco_good_id,
         parent.stm_stm_location_id,
         pde.PDE_CHARACTERIZATION_VALUE_1,
         pde.PDE_CHARACTERIZATION_VALUE_2,
         pde.PDE_CHARACTERIZATION_VALUE_3,
         pde.PDE_CHARACTERIZATION_VALUE_4,
         pde.PDE_CHARACTERIZATION_VALUE_5,
         pde.GCO_CHARACTERIZATION_ID,
         pde.GCO_GCO_CHARACTERIZATION_ID,
         pde.GCO2_GCO_CHARACTERIZATION_ID,
         pde.GCO3_GCO_CHARACTERIZATION_ID,
         pde.GCO4_GCO_CHARACTERIZATION_ID,
       -1*decode(mok2.C_MOVEMENT_SORT,
                  'ENT', (pde.pde_movement_quantity+(pos.pos_convert_factor*nvl(pde.pde_balance_quantity_parent, 0))),
                         0) SPO_PROVISORY_INPUT,
       -1*decode(mok2.C_MOVEMENT_SORT,
                  'SOR', (pde.pde_movement_quantity+(pos.pos_convert_factor*nvl(pde.pde_balance_quantity_parent, 0))),
                         0) SPO_PROVISORY_OUTPUT
from doc_position_detail pde, doc_position pos, stm_movement_kind mok,
     stm_movement_kind mok2, doc_gauge_receipt gar, doc_position_detail parent, doc_position pos_parent
where pde.doc_position_id = pos.doc_position_id
  and pos.pos_generate_movement = 0
  and gar.doc_gauge_receipt_id = pde.doc_gauge_receipt_id
  and parent.doc_position_detail_id = pde.doc_doc_position_detail_id
  and 		 gar.gar_extourne_mvt = 1
  and parent.pde_generate_movement = 1
  and pos_parent.doc_position_id = parent.doc_position_id
  and pos_parent.STM_MOVEMENT_KIND_ID = mok.stm_movement_kind_id
  and mok2.stm_movement_kind_id = mok.stm_stm_movement_kind_id
  and (parent.stm_location_id <> nvl(parent.stm_stm_location_id,0) or pos.C_GAUGE_TYPE_POS in ('7','8')))
group by prov,
         gco_good_id,
         stm_location_id,
         PDE_CHARACTERIZATION_VALUE_1,
         PDE_CHARACTERIZATION_VALUE_2,
         PDE_CHARACTERIZATION_VALUE_3,
         PDE_CHARACTERIZATION_VALUE_4,
         PDE_CHARACTERIZATION_VALUE_5,
         GCO_CHARACTERIZATION_ID,
         GCO_GCO_CHARACTERIZATION_ID,
         GCO2_GCO_CHARACTERIZATION_ID,
         GCO3_GCO_CHARACTERIZATION_ID,
         GCO4_GCO_CHARACTERIZATION_ID




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_STOCK_QUANTITY" ("GCO_GOOD_ID", "GOO_MAJOR_REFERENCE", "GOO_NUMBER_OF_DECIMAL", "STM_STOCK_ID", "C_ACCESS_METHOD", "STO_CLASSIFICATION", "STO_DESCRIPTION", "STO_FREE_DESCRIPTION", "STM_LOCATION_ID", "LOC_CLASSIFICATION", "LOC_DESCRIPTION", "LOC_FREE_DESCRIPTION", "GCO_CHARACTERIZATION_ID_1", "CHA_CHAR_DESIGN_1", "SPO_CHARACTERIZATION_VALUE_1", "GCO_CHARACTERIZATION_ID_2", "CHA_CHAR_DESIGN_2", "SPO_CHARACTERIZATION_VALUE_2", "GCO_CHARACTERIZATION_ID_3", "CHA_CHAR_DESIGN_3", "SPO_CHARACTERIZATION_VALUE_3", "GCO_CHARACTERIZATION_ID_4", "CHA_CHAR_DESIGN_4", "SPO_CHARACTERIZATION_VALUE_4", "GCO_CHARACTERIZATION_ID_5", "CHA_CHAR_DESIGN_5", "SPO_CHARACTERIZATION_VALUE_5", "SPO_STOCK_QUANTITY", "SPO_ASSIGN_QUANTITY", "SPO_PROVISORY_INPUT", "SPO_PROVISORY_OUTPUT", "SPO_AVAILABLE_QUANTITY") AS
  select STM_STOCK_POSITION.GCO_GOOD_ID
       , GCO_GOOD.GOO_MAJOR_REFERENCE
       , GCO_GOOD.GOO_NUMBER_OF_DECIMAL
       , STM_STOCK_POSITION.STM_STOCK_ID
       , STM_STOCK.C_ACCESS_METHOD
       , STM_STOCK.STO_CLASSIFICATION
       , STM_STOCK.STO_DESCRIPTION
       , STM_STOCK.STO_FREE_DESCRIPTION
       , STM_STOCK_POSITION.STM_LOCATION_ID
       , STM_LOCATION.LOC_CLASSIFICATION
       , STM_LOCATION.LOC_DESCRIPTION
       , STM_LOCATION.LOC_FREE_DESCRIPTION
       , STM_STOCK_POSITION.GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID_1
       , GCO_CHARACTERIZATION_1.CHA_CHARACTERIZATION_DESIGN CHA_CHAR_DESIGN_1
       , STM_STOCK_POSITION.SPO_CHARACTERIZATION_VALUE_1
       , STM_STOCK_POSITION.GCO_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID_2
       , GCO_CHARACTERIZATION_2.CHA_CHARACTERIZATION_DESIGN CHA_CHAR_DESIGN_2
       , STM_STOCK_POSITION.SPO_CHARACTERIZATION_VALUE_2
       , STM_STOCK_POSITION.GCO2_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID_3
       , GCO_CHARACTERIZATION_3.CHA_CHARACTERIZATION_DESIGN CHA_CHAR_DESIGN_3
       , STM_STOCK_POSITION.SPO_CHARACTERIZATION_VALUE_3
       , STM_STOCK_POSITION.GCO3_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID_4
       , GCO_CHARACTERIZATION_4.CHA_CHARACTERIZATION_DESIGN CHA_CHAR_DESIGN_4
       , STM_STOCK_POSITION.SPO_CHARACTERIZATION_VALUE_4
       , STM_STOCK_POSITION.GCO4_GCO_CHARACTERIZATION_ID GCO_CHARACTERIZATION_ID_5
       , GCO_CHARACTERIZATION_5.CHA_CHARACTERIZATION_DESIGN CHA_CHAR_DESIGN_5
       , STM_STOCK_POSITION.SPO_CHARACTERIZATION_VALUE_5
       , STM_STOCK_POSITION.SPO_STOCK_QUANTITY
       , STM_STOCK_POSITION.SPO_ASSIGN_QUANTITY
       , STM_STOCK_POSITION.SPO_PROVISORY_INPUT
       , STM_STOCK_POSITION.SPO_PROVISORY_OUTPUT
       , STM_STOCK_POSITION.SPO_AVAILABLE_QUANTITY
    from STM_STOCK_POSITION STM_STOCK_POSITION
       , GCO_GOOD GCO_GOOD
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_1
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_2
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_3
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_4
       , GCO_CHARACTERIZATION GCO_CHARACTERIZATION_5
       , STM_STOCK STM_STOCK
       , STM_LOCATION STM_LOCATION
   where STM_STOCK_POSITION.GCO_GOOD_ID = GCO_GOOD.GCO_GOOD_ID
     and STM_STOCK_POSITION.GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_1.GCO_CHARACTERIZATION_ID(+)
     and STM_STOCK_POSITION.GCO_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_2.GCO_CHARACTERIZATION_ID(+)
     and STM_STOCK_POSITION.GCO2_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_3.GCO_CHARACTERIZATION_ID(+)
     and STM_STOCK_POSITION.GCO3_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_4.GCO_CHARACTERIZATION_ID(+)
     and STM_STOCK_POSITION.GCO4_GCO_CHARACTERIZATION_ID = GCO_CHARACTERIZATION_5.GCO_CHARACTERIZATION_ID(+)
     and STM_STOCK_POSITION.STM_STOCK_ID = STM_STOCK.STM_STOCK_ID
     and STM_STOCK_POSITION.STM_LOCATION_ID = STM_LOCATION.STM_LOCATION_ID


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_ASA_AVAIL_ACTIONS" ("ASA_WEB_STATUS_CODE", "ASA_WEB_ACTION_CODE") AS
  select '02' asa_web_status_code, 'ESTIMATE_ACCEPT' asa_web_action_code from dual
union all
select '02' asa_web_status_code, 'ESTIMATE_REF' asa_web_action_code from dual


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_ASA_DATA_PRN" ("COM_SOCIALNAME", "COM_ADR", "COM_ZIP", "COM_CITY", "COM_TELEX", "FAX_TEXT", "DOC_DOCUMENT_ID", "RECORD_ID") AS
  SELECT
COM_SOCIALNAME,
COM_ADR,
COM_ZIP,
COM_CITY,
COM_TELEX,
'Fax' FAX_TEXT,
doc_document_id,
NVL(ASA_FUNCTIONS.GET_RECID_FROM_DOCID(doc_document_id),0) record_id
FROM pcs.pc_comp a, doc_document WHERE a.com_name=COM_CURRENTSCHEMA


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_ASA_RECORD_STATE" ("ASA_RECORD_ID", "ASA_WEB_STATUS_CODE") AS
  select
  asa_record_id, c_asa_rep_status asa_web_status_code
from
  asa_record


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_ASA_STATE_DESCR" ("ASA_WEB_STATUS_CODE", "PC_LANG_ID", "GCDTEXT1", "GCDTEXT2", "GCDTEXT3") AS
  select
  gclcode asa_web_status_code, pc_lang_id, gcdtext1,gcdtext2,gcdtext3
from
  pcs.pc_gcodes
where gcgname='C_ASA_REP_STATUS'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_PUBLISH_FILES" ("OLE_OLE", "DOCTYPE", "IMF_FILE", "COM_OLE_ID", "CK") AS
  select
  ole_ole,
  case
    when (instr(upper(imf_file),'.DOC')<>0)
      then 'application/msword'
    when (instr(upper(imf_file),'.XLS')<>0)
      then 'application/msexcel'
    when (instr(upper(imf_file),'.PDF')<>0)
      then 'application/pdf'
    when (instr(upper(imf_file),'.JPG')<>0)
      then 'image/jpeg'
    when (instr(upper(imf_file),'.JPEG')<>0)
      then 'image/jpeg'
    when (instr(upper(imf_file),'.PNG')<>0)
      then 'image/jpeg'
    when (instr(upper(imf_file),'.GIF')<>0)
      then 'image/gif'
    when (instr(upper(imf_file),'.TXT')<>0)
      then 'text/plain'
    else 'application/octet-stream'
  END doctype,
  imf_file ,
  com.com_ole_id,
  lpad(com.com_ole_id||com_image_files_id,24,'0') CK
from
  com_image_files com,
  com_ole ole
where
  com.com_ole_id=ole.com_ole_id and
  imf_stored_in='DB'


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_REP_CATEG_ARRAY" ("CATEG_ARRAY_ID", "IS_ACTIVE", "ARRAY_LEVEL", "CODE", "LANG", "DESCR", "LONG_DESCR", "URL", "PATH", "HINT", "LINK", "PARENT_LINK", "PARENT_LANG") AS
  SELECT
  a.web_categ_array_id,
  decode(pa.wca_is_active, 0, 0, a.wca_is_active),
  a.wca_level,
  lc.wca_code,
  ld.pc_lang_id,
  ld.wcd_descr,
  nvl(ld.wcd_long_descr, lc.wca_long_descr),
  nvl(ld.wcd_picture_url, lc.wca_picture_url),
  replace(nvl(ld.wcd_picture_url, lc.wca_picture_url), '/', '\'),
  nvl(ld.wcd_picture_hint, lc.wca_picture_hint),
  ld.wcd_descr||to_char(a.web_categ_array_id),
  pd.wcd_descr||to_char(a.parent_link_id),
  pd.pc_lang_id
FROM
  web_categ_array pa,
  web_categ_descr pd,
  web_categ pc,
  web_categ_descr ld,
  web_categ lc,
  (SELECT web_categ_array_id, wca_is_active, wca_level,
     decode(wca_level, 1, null, 2, web_categ_array_id_parent1, 3, web_categ_array_id_parent2,
       4, web_categ_array_id_parent3, 5, web_categ_array_id_parent4) parent_link_id,
     decode(wca_level, 1, null, 2, web_categ_id_level1, 3, web_categ_id_level2,
       4, web_categ_id_level3, 5, web_categ_id_level4) parent_id,
     decode(wca_level, 1, web_categ_id_level1, 2, web_categ_id_level2,
       3, web_categ_id_level3, 4, web_categ_id_level4, 5, web_categ_id_level5) level_id
   FROM
      web_categ_array) a
WHERE
  lc.web_categ_id = a.level_id and
  ld.web_categ_id(+) = a.level_id and
  pc.web_categ_id(+) = a.parent_id and
  pd.web_categ_id(+) = a.parent_id and
  pa.web_categ_array_id(+) = a.parent_link_id




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_RPT_GCO_PRODUCT" ("REPORT_TITLE", "GCO_GOOD_ID", "DIC_UNIT_OF_MEASURE_TXT", "DIC_UNIT_OF_MEASURE_ID", "GOO_MAJOR_REFERENCE_TXT", "GOO_MAJOR_REFERENCE", "GOO_SECONDARY_REFERENCE_TXT", "GOO_SECONDARY_REFERENCE", "GOO_EAN_CODE_TXT", "GOO_EAN_CODE", "DIC_GOO_WEB_CATEG1_ID_TXT", "DIC_GOO_WEB_CATEG1_ID", "DIC_GOO_WEB_CATEG1_DESCR", "DIC_GOO_WEB_CATEG2_ID_TXT", "DIC_GOO_WEB_CATEG2_ID", "DIC_GOO_WEB_CATEG2_DESCR", "DIC_GOO_WEB_CATEG3_ID_TXT", "DIC_GOO_WEB_CATEG3_ID", "DIC_GOO_WEB_CATEG3_DESCR", "DIC_GOO_WEB_CATEG4_ID_TXT", "DIC_GOO_WEB_CATEG4_ID", "DIC_GOO_WEB_CATEG4_DESCR", "IMG_SMALL_URL", "IMG_LARGE_URL", "DES_SHORT_DESCRIPTION", "DES_SHORT_DESCRIPTION_TXT", "DES_LONG_DESCRIPTION", "DES_LONG_DESCRIPTION_TXT", "DES_FREE_DESCRIPTION", "DES_FREE_DESCRIPTION_TXT", "PC_LANG_ID") AS
  select
'Fiche de prsentation produit' REPORT_TITLE,
g.GCO_GOOD_ID,
pcs.PC_FUNCTIONS.GetColumnInformation('DIC_UNIT_OF_MEASURE_ID',1,L.PC_LANG_ID) DIC_UNIT_OF_MEASURE_TXT,
g.DIC_UNIT_OF_MEASURE_ID,
pcs.PC_FUNCTIONS.GetColumnInformation('GOO_MAJOR_REFERENCE',1,L.PC_LANG_ID) GOO_MAJOR_REFERENCE_TXT,
g.GOO_MAJOR_REFERENCE,
pcs.PC_FUNCTIONS.GetColumnInformation('GOO_SECONDARY_REFERENCE',1,L.PC_LANG_ID) GOO_SECONDARY_REFERENCE_TXT,
g.GOO_SECONDARY_REFERENCE,
pcs.PC_FUNCTIONS.GetColumnInformation('GOO_EAN_CODE',1,L.PC_LANG_ID) GOO_EAN_CODE_TXT,
g.GOO_EAN_CODE,
pcs.PC_FUNCTIONS.GetColumnInformation('DIC_GOO_WEB_CATEG1_ID',1,L.PC_LANG_ID) DIC_GOO_WEB_CATEG1_ID_TXT,
g.DIC_GOO_WEB_CATEG1_ID,hrm_functions.getDicoDescr('DIC_GOO_WEB_CATEG1',DIC_GOO_WEB_CATEG1_ID, l.pc_lang_id) DIC_GOO_WEB_CATEG1_DESCR,
pcs.PC_FUNCTIONS.GetColumnInformation('DIC_GOO_WEB_CATEG2_ID',1,L.PC_LANG_ID) DIC_GOO_WEB_CATEG2_ID_TXT,
g.DIC_GOO_WEB_CATEG2_ID,hrm_functions.getDicoDescr('DIC_GOO_WEB_CATEG2',DIC_GOO_WEB_CATEG2_ID, l.pc_lang_id) DIC_GOO_WEB_CATEG2_DESCR,
pcs.PC_FUNCTIONS.GetColumnInformation('DIC_GOO_WEB_CATEG3_ID',1,L.PC_LANG_ID) DIC_GOO_WEB_CATEG3_ID_TXT,
g.DIC_GOO_WEB_CATEG3_ID,hrm_functions.getDicoDescr('DIC_GOO_WEB_CATEG3',DIC_GOO_WEB_CATEG3_ID, l.pc_lang_id) DIC_GOO_WEB_CATEG3_DESCR,
pcs.PC_FUNCTIONS.GetColumnInformation('DIC_GOO_WEB_CATEG4_ID',1,L.PC_LANG_ID) DIC_GOO_WEB_CATEG4_ID_TXT,
g.DIC_GOO_WEB_CATEG4_ID,hrm_functions.getDicoDescr('DIC_GOO_WEB_CATEG4',DIC_GOO_WEB_CATEG4_ID, l.pc_lang_id) DIC_GOO_WEB_CATEG4_DESCR,
pcs.pc_config.GetConfig('WEB_CATEG_PICTURE_ROOT_HTTP')||web_shop_functions.getLinkedImageName(g.GCO_GOOD_ID,'UrlSmall') IMG_SMALL_URL,
pcs.pc_config.GetConfig('WEB_CATEG_PICTURE_ROOT_HTTP')||web_shop_functions.getLinkedImageName(g.GCO_GOOD_ID,'UrlLarge') IMG_LARGE_URL,
d.des_short_description,
pcs.PC_FUNCTIONS.GetColumnInformation('DES_SHORT_DESCRIPTION',1,L.PC_LANG_ID) DES_SHORT_DESCRIPTION_TXT,
d.des_long_description,
pcs.PC_FUNCTIONS.GetColumnInformation('DES_LONG_DESCRIPTION',1,L.PC_LANG_ID) DES_LONG_DESCRIPTION_TXT,
d.des_free_description,
pcs.PC_FUNCTIONS.GetColumnInformation('DES_FREE_DESCRIPTION',1,L.PC_LANG_ID) DES_FREE_DESCRIPTION_TXT,
l.PC_lANG_ID
from
  gco_good g,
  gco_product p,
  gco_description d,
  pcs.pc_lang l
where
  g.gco_good_id = p.gco_good_id
  and g.gco_good_id = d.gco_good_id
  and g.gco_good_id = d.gco_good_id
  and l.pc_lang_id=d.pc_lang_id
  and d.c_description_type='09'




  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_USER_ACCESS" ("WEB_USER_ID", "WEI_ITEM_NAME", "HAS_RIGHT") AS
  SELECT
  web_user_id,
  wei_item_name,
  web_functions.GetRightForUserToPage(web_user_id,wei_item_name) has_right
FROM
  web_user,
  web_item


  CREATE OR REPLACE FORCE VIEW "C_ITX"."V_WEB_USER_IO" ("WEB_USER_ID", "WEU_LOGIN_NAME", "WEU_PASSWORD_VALUE", "WEU_FIRST_NAME", "WEU_LAST_NAME", "WEU_EMAIL", "WEU_CONFIRM_VALUE", "WEU_LAST_LOGIN", "WEU_DISABLED", "WEU_PASSWORD_CHANGED", "PC_USER_ID", "HRM_PERSON_ID", "PAC_REPRESENTATIVE_ID", "PAC_CUSTOM_PARTNER_ID", "PAC_SUPPLIER_PARTNER_ID", "A_DATECRE", "A_DATEMOD", "A_IDCRE", "A_IDMOD", "A_RECLEVEL", "A_RECSTATUS", "PC_LANG_ID", "PAC_PERSON_ID", "WEU_INI", "USE_ERP", "USE_ECO") AS
  select (select ULI_LINK_RECORD_ID
                  from PCS.PC_USER_LINK ULI
                 where ULI.PC_USER_ID = PC_USER.PC_USER_ID
                   and ULI.PC_COMP_ID = COM_CURRENTCOMPID
                   and ULI.ULI_LINK_CODE = 'WEB_USER') WEB_USER_ID
       , nvl(USE_ACCOUNT_NAME, USE_NAME) WEU_LOGIN_NAME
       , USE_PASSWORD WEU_PASSWORD_VALUE
       , USE_FIRST_NAME WEU_FIRST_NAME
       , USE_LAST_NAME WEU_LAST_NAME
       , USE_EMAIL WEU_EMAIL
       , USE_CONFIRM_VALUE WEU_CONFIRM_VALUE
       , USE_LAST_LOGIN WEU_LAST_LOGIN
       , (select cast(nvl(max(ULI_LINK_RECORD_ID), 0) as number(1) )
            from PCS.PC_USER_LINK ULI
           where ULI.PC_USER_ID = PC_USER.PC_USER_ID
             and ULI.PC_COMP_ID = COM_CURRENTCOMPID
             and ULI.ULI_LINK_CODE = 'WEB_USER.WEU_DISABLED') WEU_DISABLED
       , USE_LAST_PWD_CHANGE WEU_PASSWORD_CHANGED
       , PC_USER_ID PC_USER_ID
       , (select ULI_LINK_RECORD_ID
            from PCS.PC_USER_LINK ULI
           where ULI.PC_USER_ID = PC_USER.PC_USER_ID
             and ULI.PC_COMP_ID = COM_CURRENTCOMPID
             and ULI.ULI_LINK_CODE = 'HRM_PERSON') HRM_PERSON_ID
       , (select ULI_LINK_RECORD_ID
            from PCS.PC_USER_LINK ULI
           where ULI.PC_USER_ID = PC_USER.PC_USER_ID
             and ULI.PC_COMP_ID = COM_CURRENTCOMPID
             and ULI.ULI_LINK_CODE = 'PAC_REPRESENTATIVE') PAC_REPRESENTATIVE_ID
       , (select ULI_LINK_RECORD_ID
            from PCS.PC_USER_LINK ULI
           where ULI.PC_USER_ID = PC_USER.PC_USER_ID
             and ULI.PC_COMP_ID = COM_CURRENTCOMPID
             and ULI.ULI_LINK_CODE = 'PAC_CUSTOM_PARTNER') PAC_CUSTOM_PARTNER_ID
       , (select ULI_LINK_RECORD_ID
            from PCS.PC_USER_LINK ULI
           where ULI.PC_USER_ID = PC_USER.PC_USER_ID
             and ULI.PC_COMP_ID = COM_CURRENTCOMPID
             and ULI.ULI_LINK_CODE = 'PAC_SUPPLIER_PARTNER') PAC_SUPPLIER_PARTNER_ID
       , A_DATECRE
       , A_DATEMOD
       , A_IDCRE
       , A_IDMOD
       , A_RECLEVEL
       , A_RECSTATUS
       , PC_LANG_ID
       , (select ULI_LINK_RECORD_ID
            from PCS.PC_USER_LINK ULI
           where ULI.PC_USER_ID = PC_USER.PC_USER_ID
             and ULI.PC_COMP_ID = COM_CURRENTCOMPID
             and ULI.ULI_LINK_CODE = 'PAC_PERSON') PAC_PERSON_ID
       , USE_INI WEU_INI
       , USE_ERP
       , USE_ECO
    from PCS.PC_USER
   where USE_WEB = 1
     and exists(select ULI_LINK_RECORD_ID
                  from PCS.PC_USER_LINK ULI
                 where ULI.PC_USER_ID = PC_USER.PC_USER_ID
                   and ULI.PC_COMP_ID = COM_CURRENTCOMPID
                   and ULI.ULI_LINK_CODE = 'WEB_USER')

